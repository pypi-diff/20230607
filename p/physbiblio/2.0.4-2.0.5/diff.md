# Comparing `tmp/physbiblio-2.0.4.tar.gz` & `tmp/physbiblio-2.0.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "physbiblio-2.0.4.tar", last modified: Fri Mar 10 13:09:50 2023, max compression
+gzip compressed data, was "physbiblio-2.0.5.tar", last modified: Wed Jun  7 13:07:08 2023, max compression
```

## Comparing `physbiblio-2.0.4.tar` & `physbiblio-2.0.5.tar`

### file list

```diff
@@ -1,132 +1,131 @@
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.260968 physbiblio-2.0.4/
--rw-r--r--   0 steog88   (1000) steog88   (1000)    17763 2023-03-10 13:09:49.000000 physbiblio-2.0.4/CHANGELOG
--rw-rw-r--   0 steog88   (1000) steog88   (1000)    35147 2019-01-09 15:43:08.000000 physbiblio-2.0.4/LICENSE
--rw-r--r--   0 steog88   (1000) steog88   (1000)    17890 2023-03-10 13:09:50.260968 physbiblio-2.0.4/PKG-INFO
--rwxr-xr-x   0 steog88   (1000) steog88   (1000)      697 2020-07-16 14:03:13.000000 physbiblio-2.0.4/PhysBiblio.exe
--rw-r--r--   0 steog88   (1000) steog88   (1000)    16791 2022-06-18 08:22:55.000000 physbiblio-2.0.4/README.md
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.254301 physbiblio-2.0.4/physbiblio/
--rw-r--r--   0 steog88   (1000) steog88   (1000)      556 2020-07-21 09:43:46.000000 physbiblio-2.0.4/physbiblio/__init__.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     9326 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/argParser.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     3588 2022-10-31 20:11:59.000000 physbiblio-2.0.4/physbiblio/bibtexWriter.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     1173 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/cli.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    42285 2022-11-01 14:24:29.000000 physbiblio-2.0.4/physbiblio/config.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)   169953 2023-03-09 22:54:09.000000 physbiblio-2.0.4/physbiblio/database.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    13329 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/databaseCore.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     3562 2022-06-07 22:29:27.000000 physbiblio-2.0.4/physbiblio/errors.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    20604 2022-10-31 20:19:03.000000 physbiblio-2.0.4/physbiblio/export.py
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.254301 physbiblio-2.0.4/physbiblio/gui/
--rw-r--r--   0 steog88   (1000) steog88   (1000)      491 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/gui/__init__.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     6379 2022-11-01 14:38:25.000000 physbiblio-2.0.4/physbiblio/gui/basicDialogs.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)   132344 2023-03-10 11:48:41.000000 physbiblio-2.0.4/physbiblio/gui/bibWindows.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    28716 2023-03-10 10:54:54.000000 physbiblio-2.0.4/physbiblio/gui/catWindows.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    37431 2023-03-10 10:55:07.000000 physbiblio-2.0.4/physbiblio/gui/commonClasses.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    34597 2022-11-01 14:47:55.000000 physbiblio-2.0.4/physbiblio/gui/dialogWindows.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     3338 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/gui/errorManager.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    20051 2023-03-10 11:07:10.000000 physbiblio-2.0.4/physbiblio/gui/expWindows.py
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.257634 physbiblio-2.0.4/physbiblio/gui/images/
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     3017 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/application-exit.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2987 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/application-pdf.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      793 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/arrow-down.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      807 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/arrow-up.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2101 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/delete.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2339 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/dialog-error.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1973 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/dialog-ok-apply.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2312 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/dialog-warning.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     4482 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/download.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     3898 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/edit-clear.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     5150 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/edit-find-replace.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1242 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/edit-node.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      778 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/edit-select-all.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     3505 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/edit-undo.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1007 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/edit-unselect-all.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1970 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/edit.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1573 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/emblem-favorite-symbolic.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      202 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/emblem-important-symbolic.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1224 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/emblem-question.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      414 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/emblem-remove.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2783 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/export-table.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2427 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/export.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2658 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/file-add.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      368 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/file-save.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     3065 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/find.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2742 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/help-about.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2314 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/icon.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1358 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/profiles.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     3743 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/refresh.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      422 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/refresh2.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2073 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/settings.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      204 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/stats.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     2533 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/terminal.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1459 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/unread-new.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1415 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/view-filter.png
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     5776 2019-01-09 15:43:08.000000 physbiblio-2.0.4/physbiblio/gui/images/web-search.png
--rw-r--r--   0 steog88   (1000) steog88   (1000)    10551 2022-10-21 14:19:30.000000 physbiblio-2.0.4/physbiblio/gui/inspireStatsGUI.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    76109 2022-11-01 14:35:21.000000 physbiblio-2.0.4/physbiblio/gui/mainWindow.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     2905 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/gui/marks.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    19467 2022-11-01 14:33:17.000000 physbiblio-2.0.4/physbiblio/gui/profilesManager.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)   243177 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/gui/resourcesPyside6.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     1977 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/gui/setuptests.py
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.257634 physbiblio-2.0.4/physbiblio/gui/tests/
--rw-r--r--   0 steog88   (1000) steog88   (1000)      512 2019-05-07 21:18:56.000000 physbiblio-2.0.4/physbiblio/gui/tests/__init__.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     8605 2022-11-01 15:43:25.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_basicDialogs.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)   362733 2023-03-10 11:32:11.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_bibWindows.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    76111 2023-03-10 11:29:50.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_catWindows.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    66204 2023-03-10 11:24:18.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_commonClasses.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    66156 2022-11-01 15:41:55.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_dialogWindows.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     3539 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_errorManager.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    57969 2023-03-10 11:23:35.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_expWindows.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    77615 2022-11-01 15:40:20.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_inspireStatsGUI.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)   220807 2022-06-18 08:22:55.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_mainWindow.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     3397 2022-11-01 15:39:38.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_marks.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    48747 2022-11-01 15:38:58.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_profilesManager.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    43595 2022-11-01 15:38:43.000000 physbiblio-2.0.4/physbiblio/gui/tests/test_threadElements.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    28629 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/gui/threadElements.py
--rwxr-xr-x   0 steog88   (1000) steog88   (1000)       61 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/gui/update_resources.sh
--rw-r--r--   0 steog88   (1000) steog88   (1000)    22300 2022-10-21 14:23:55.000000 physbiblio-2.0.4/physbiblio/inspireStats.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     2619 2020-07-16 14:12:59.000000 physbiblio-2.0.4/physbiblio/parseAccents.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    18024 2022-10-31 20:14:30.000000 physbiblio-2.0.4/physbiblio/pdf.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     3274 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/setuptests.py
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.257634 physbiblio-2.0.4/physbiblio/strings/
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      292 2020-02-01 04:21:09.000000 physbiblio-2.0.4/physbiblio/strings/__init__.py
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     1084 2020-02-01 04:21:09.000000 physbiblio-2.0.4/physbiblio/strings/common.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    30642 2022-10-21 09:28:08.000000 physbiblio-2.0.4/physbiblio/strings/gui.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    27381 2022-10-14 21:23:25.000000 physbiblio-2.0.4/physbiblio/strings/main.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     2943 2021-07-10 14:34:18.000000 physbiblio-2.0.4/physbiblio/strings/webimport.py
--rw-rw-r--   0 steog88   (1000) steog88   (1000)     3514 2021-07-05 15:58:20.000000 physbiblio-2.0.4/physbiblio/tablesDef.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     1991 2022-10-31 20:14:32.000000 physbiblio-2.0.4/physbiblio/testLoader.py
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.257634 physbiblio-2.0.4/physbiblio/tests/
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      412 2019-08-26 10:19:28.000000 physbiblio-2.0.4/physbiblio/tests/__init__.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    21924 2022-11-01 14:18:01.000000 physbiblio-2.0.4/physbiblio/tests/test_argParser.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     3507 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/tests/test_bibtexWriter.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    92610 2022-11-01 14:18:41.000000 physbiblio-2.0.4/physbiblio/tests/test_config.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)   373509 2022-11-01 14:40:33.000000 physbiblio-2.0.4/physbiblio/tests/test_database.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     7124 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/tests/test_errors.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    27240 2022-11-01 14:24:16.000000 physbiblio-2.0.4/physbiblio/tests/test_export.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     7695 2022-11-01 14:20:17.000000 physbiblio-2.0.4/physbiblio/tests/test_inspireStats.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)      911 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/tests/test_package.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    11877 2022-11-01 14:24:29.000000 physbiblio-2.0.4/physbiblio/tests/test_pdf.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     6485 2022-11-01 14:19:24.000000 physbiblio-2.0.4/physbiblio/tests/test_view.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)      273 2023-03-10 13:09:49.000000 physbiblio-2.0.4/physbiblio/version.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     4057 2020-07-16 14:14:14.000000 physbiblio-2.0.4/physbiblio/view.py
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.260968 physbiblio-2.0.4/physbiblio/webimport/
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      335 2021-06-30 20:44:22.000000 physbiblio-2.0.4/physbiblio/webimport/__init__.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     4392 2022-11-01 14:16:19.000000 physbiblio-2.0.4/physbiblio/webimport/adsnasa.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    14726 2022-11-01 14:16:19.000000 physbiblio-2.0.4/physbiblio/webimport/arxiv.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     1853 2020-07-16 14:10:21.000000 physbiblio-2.0.4/physbiblio/webimport/doi.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    28930 2021-09-10 12:30:00.000000 physbiblio-2.0.4/physbiblio/webimport/inspire.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     1738 2020-07-16 14:10:21.000000 physbiblio-2.0.4/physbiblio/webimport/isbn.py
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.260968 physbiblio-2.0.4/physbiblio/webimport/tests/
--rw-r--r--   0 steog88   (1000) steog88   (1000)      234 2021-06-30 21:45:48.000000 physbiblio-2.0.4/physbiblio/webimport/tests/__init__.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     7132 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/webimport/tests/test_adsnasa.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    29809 2022-10-14 12:39:59.000000 physbiblio-2.0.4/physbiblio/webimport/tests/test_arxiv.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    55482 2022-06-18 07:42:38.000000 physbiblio-2.0.4/physbiblio/webimport/tests/test_inspire.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)    18697 2022-10-14 16:48:52.000000 physbiblio-2.0.4/physbiblio/webimport/tests/test_webimport.py
--rw-r--r--   0 steog88   (1000) steog88   (1000)     6887 2022-11-01 14:16:19.000000 physbiblio-2.0.4/physbiblio/webimport/webInterf.py
-drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-03-10 13:09:50.254301 physbiblio-2.0.4/physbiblio.egg-info/
--rw-r--r--   0 steog88   (1000) steog88   (1000)    17890 2023-03-10 13:09:49.000000 physbiblio-2.0.4/physbiblio.egg-info/PKG-INFO
--rw-r--r--   0 steog88   (1000) steog88   (1000)     3945 2023-03-10 13:09:50.000000 physbiblio-2.0.4/physbiblio.egg-info/SOURCES.txt
--rw-r--r--   0 steog88   (1000) steog88   (1000)        1 2023-03-10 13:09:49.000000 physbiblio-2.0.4/physbiblio.egg-info/dependency_links.txt
--rw-r--r--   0 steog88   (1000) steog88   (1000)      215 2023-03-10 13:09:50.000000 physbiblio-2.0.4/physbiblio.egg-info/requires.txt
--rw-r--r--   0 steog88   (1000) steog88   (1000)       11 2023-03-10 13:09:50.000000 physbiblio-2.0.4/physbiblio.egg-info/top_level.txt
--rw-rw-r--   0 steog88   (1000) steog88   (1000)      102 2023-03-10 13:09:50.260968 physbiblio-2.0.4/setup.cfg
--rw-r--r--   0 steog88   (1000) steog88   (1000)     2372 2023-03-10 11:07:31.000000 physbiblio-2.0.4/setup.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.698506 physbiblio-2.0.5/
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    17884 2023-06-07 13:07:08.000000 physbiblio-2.0.5/CHANGELOG
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)    35147 2019-01-09 15:43:08.000000 physbiblio-2.0.5/LICENSE
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    17813 2023-06-07 13:07:08.698506 physbiblio-2.0.5/PKG-INFO
+-rwxr-xr-x   0 steog88   (1000) steog88   (1000)      697 2020-07-16 14:03:13.000000 physbiblio-2.0.5/PhysBiblio.exe
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    16734 2023-06-07 12:58:11.000000 physbiblio-2.0.5/README.md
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.691839 physbiblio-2.0.5/physbiblio/
+-rw-r--r--   0 steog88   (1000) steog88   (1000)      556 2020-07-21 09:43:46.000000 physbiblio-2.0.5/physbiblio/__init__.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     9326 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/argParser.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     3588 2022-10-31 20:11:59.000000 physbiblio-2.0.5/physbiblio/bibtexWriter.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     1173 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/cli.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    42285 2022-11-01 14:24:29.000000 physbiblio-2.0.5/physbiblio/config.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)   169884 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/database.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    13329 2023-06-07 11:48:49.000000 physbiblio-2.0.5/physbiblio/databaseCore.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     3562 2022-06-07 22:29:27.000000 physbiblio-2.0.5/physbiblio/errors.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    20604 2022-10-31 20:19:03.000000 physbiblio-2.0.5/physbiblio/export.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.691839 physbiblio-2.0.5/physbiblio/gui/
+-rw-r--r--   0 steog88   (1000) steog88   (1000)      491 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/gui/__init__.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     6379 2022-11-01 14:38:25.000000 physbiblio-2.0.5/physbiblio/gui/basicDialogs.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)   134045 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/gui/bibWindows.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    28716 2023-03-10 10:54:54.000000 physbiblio-2.0.5/physbiblio/gui/catWindows.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    37399 2023-06-07 11:49:35.000000 physbiblio-2.0.5/physbiblio/gui/commonClasses.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    34589 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/gui/dialogWindows.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     3338 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/gui/errorManager.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    20051 2023-03-10 11:07:10.000000 physbiblio-2.0.5/physbiblio/gui/expWindows.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.695172 physbiblio-2.0.5/physbiblio/gui/images/
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     3017 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/application-exit.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2987 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/application-pdf.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      793 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/arrow-down.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      807 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/arrow-up.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2101 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/delete.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2339 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/dialog-error.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1973 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/dialog-ok-apply.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2312 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/dialog-warning.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     4482 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/download.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     3898 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/edit-clear.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     5150 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/edit-find-replace.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1242 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/edit-node.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      778 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/edit-select-all.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     3505 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/edit-undo.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1007 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/edit-unselect-all.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1970 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/edit.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1573 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/emblem-favorite-symbolic.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      202 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/emblem-important-symbolic.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1224 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/emblem-question.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      414 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/emblem-remove.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2783 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/export-table.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2427 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/export.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2658 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/file-add.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      368 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/file-save.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     3065 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/find.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2742 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/help-about.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2314 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/icon.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1358 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/profiles.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     3743 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/refresh.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      422 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/refresh2.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2073 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/settings.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      204 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/stats.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     2533 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/terminal.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1459 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/unread-new.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1415 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/view-filter.png
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     5776 2019-01-09 15:43:08.000000 physbiblio-2.0.5/physbiblio/gui/images/web-search.png
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    10551 2022-10-21 14:19:30.000000 physbiblio-2.0.5/physbiblio/gui/inspireStatsGUI.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    76137 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/gui/mainWindow.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     2905 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/gui/marks.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    19467 2022-11-01 14:33:17.000000 physbiblio-2.0.5/physbiblio/gui/profilesManager.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)   243177 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/gui/resourcesPyside6.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     1977 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/gui/setuptests.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.698506 physbiblio-2.0.5/physbiblio/gui/tests/
+-rw-r--r--   0 steog88   (1000) steog88   (1000)      512 2019-05-07 21:18:56.000000 physbiblio-2.0.5/physbiblio/gui/tests/__init__.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     8605 2022-11-01 15:43:25.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_basicDialogs.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)   362496 2023-06-07 11:50:11.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_bibWindows.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    76111 2023-03-10 11:29:50.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_catWindows.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    66204 2023-03-10 11:24:18.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_commonClasses.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    66107 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_dialogWindows.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     3539 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_errorManager.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    57969 2023-03-10 11:23:35.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_expWindows.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    77615 2022-11-01 15:40:20.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_inspireStatsGUI.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)   216486 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_mainWindow.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     3397 2022-11-01 15:39:38.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_marks.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    48747 2022-11-01 15:38:58.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_profilesManager.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    43595 2022-11-01 15:38:43.000000 physbiblio-2.0.5/physbiblio/gui/tests/test_threadElements.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    28629 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/gui/threadElements.py
+-rwxr-xr-x   0 steog88   (1000) steog88   (1000)       61 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/gui/update_resources.sh
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    22300 2022-10-21 14:23:55.000000 physbiblio-2.0.5/physbiblio/inspireStats.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     2619 2020-07-16 14:12:59.000000 physbiblio-2.0.5/physbiblio/parseAccents.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    18024 2023-06-07 09:54:50.000000 physbiblio-2.0.5/physbiblio/pdf.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     3274 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/setuptests.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.698506 physbiblio-2.0.5/physbiblio/strings/
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      292 2020-02-01 04:21:09.000000 physbiblio-2.0.5/physbiblio/strings/__init__.py
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     1084 2020-02-01 04:21:09.000000 physbiblio-2.0.5/physbiblio/strings/common.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    30642 2022-10-21 09:28:08.000000 physbiblio-2.0.5/physbiblio/strings/gui.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    27381 2022-10-14 21:23:25.000000 physbiblio-2.0.5/physbiblio/strings/main.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     2868 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/strings/webimport.py
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)     3514 2021-07-05 15:58:20.000000 physbiblio-2.0.5/physbiblio/tablesDef.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     1991 2022-10-31 20:14:32.000000 physbiblio-2.0.5/physbiblio/testLoader.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.698506 physbiblio-2.0.5/physbiblio/tests/
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      412 2019-08-26 10:19:28.000000 physbiblio-2.0.5/physbiblio/tests/__init__.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    21924 2022-11-01 14:18:01.000000 physbiblio-2.0.5/physbiblio/tests/test_argParser.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     3507 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/tests/test_bibtexWriter.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    92610 2022-11-01 14:18:41.000000 physbiblio-2.0.5/physbiblio/tests/test_config.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)   372791 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/tests/test_database.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     7124 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/tests/test_errors.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    27240 2022-11-01 14:24:16.000000 physbiblio-2.0.5/physbiblio/tests/test_export.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     7695 2022-11-01 14:20:17.000000 physbiblio-2.0.5/physbiblio/tests/test_inspireStats.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)      911 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/tests/test_package.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    11877 2022-11-01 14:24:29.000000 physbiblio-2.0.5/physbiblio/tests/test_pdf.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     6485 2022-11-01 14:19:24.000000 physbiblio-2.0.5/physbiblio/tests/test_view.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)      187 2023-06-07 13:07:08.000000 physbiblio-2.0.5/physbiblio/version.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     4057 2020-07-16 14:14:14.000000 physbiblio-2.0.5/physbiblio/view.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.698506 physbiblio-2.0.5/physbiblio/webimport/
+-rw-r--r--   0 steog88   (1000) steog88   (1000)      323 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/webimport/__init__.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     4392 2022-11-01 14:16:19.000000 physbiblio-2.0.5/physbiblio/webimport/adsnasa.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    14726 2022-11-01 14:16:19.000000 physbiblio-2.0.5/physbiblio/webimport/arxiv.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     1853 2020-07-16 14:10:21.000000 physbiblio-2.0.5/physbiblio/webimport/doi.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    28930 2021-09-10 12:30:00.000000 physbiblio-2.0.5/physbiblio/webimport/inspire.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.698506 physbiblio-2.0.5/physbiblio/webimport/tests/
+-rw-r--r--   0 steog88   (1000) steog88   (1000)      251 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/webimport/tests/__init__.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     7132 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/webimport/tests/test_adsnasa.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    29809 2022-10-14 12:39:59.000000 physbiblio-2.0.5/physbiblio/webimport/tests/test_arxiv.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    55482 2022-06-18 07:42:38.000000 physbiblio-2.0.5/physbiblio/webimport/tests/test_inspire.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    18160 2023-06-07 12:58:11.000000 physbiblio-2.0.5/physbiblio/webimport/tests/test_webimport.py
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     6887 2022-11-01 14:16:19.000000 physbiblio-2.0.5/physbiblio/webimport/webInterf.py
+drwxr-xr-x   0 steog88   (1000) steog88   (1000)        0 2023-06-07 13:07:08.691839 physbiblio-2.0.5/physbiblio.egg-info/
+-rw-r--r--   0 steog88   (1000) steog88   (1000)    17813 2023-06-07 13:07:08.000000 physbiblio-2.0.5/physbiblio.egg-info/PKG-INFO
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     3916 2023-06-07 13:07:08.000000 physbiblio-2.0.5/physbiblio.egg-info/SOURCES.txt
+-rw-r--r--   0 steog88   (1000) steog88   (1000)        1 2023-06-07 13:07:08.000000 physbiblio-2.0.5/physbiblio.egg-info/dependency_links.txt
+-rw-r--r--   0 steog88   (1000) steog88   (1000)      215 2023-06-07 13:07:08.000000 physbiblio-2.0.5/physbiblio.egg-info/requires.txt
+-rw-r--r--   0 steog88   (1000) steog88   (1000)       11 2023-06-07 13:07:08.000000 physbiblio-2.0.5/physbiblio.egg-info/top_level.txt
+-rw-rw-r--   0 steog88   (1000) steog88   (1000)      102 2023-06-07 13:07:08.701839 physbiblio-2.0.5/setup.cfg
+-rw-r--r--   0 steog88   (1000) steog88   (1000)     2372 2023-03-10 11:07:31.000000 physbiblio-2.0.5/setup.py
```

### Comparing `physbiblio-2.0.4/CHANGELOG` & `physbiblio-2.0.5/CHANGELOG`

 * *Files 2% similar despite different names*

```diff
@@ -1,7 +1,11 @@
+2.0.5 (2023-06-07):
+    * fixes for python 3.11
+    * ISBN2bibtex scripts dropped (the webservice is no longer working)
+
 2.0.4 (2023-03-10):
     * deprecation warnings fixed in setup.cfg and setup.py
     * code improvements thanks to refurb
     * PySide6 6.4.0 enum system now compatible with matplotlib >3.6.2
     * bug fixes
 
 2.0.3 (2022-10-21):
```

### Comparing `physbiblio-2.0.4/LICENSE` & `physbiblio-2.0.5/LICENSE`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/PKG-INFO` & `physbiblio-2.0.5/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,17 +1,16 @@
 Metadata-Version: 2.1
 Name: physbiblio
-Version: 2.0.4
+Version: 2.0.5
 Summary: A bibliography manager in Python (using Sqlite and PySide6)
 Home-page: https://github.com/steog88/PhysBiblio
 Author: Stefano Gariazzo
 Author-email: stefano.gariazzo@gmail.com
 License: GPL-3.0
 Keywords: bibliography,hep-ph,high-energy-physics,bibtex
-Platform: UNKNOWN
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: End Users/Desktop
 Classifier: Intended Audience :: Science/Research
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
 Classifier: Natural Language :: English
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python
@@ -168,15 +167,15 @@
 
 ### Profiles
 You may manage different profiles, each with different settings and independent databases.
 It may be useful if you want to maintain separate activities or collections independently one of the other.
 
 ### Import
 The default import interface can fetch and download information from [INSPIRE-HEP](http://inspirehep.net/).
-The advanced import can also work with [ADS](https://ui.adsabs.harvard.edu/), [arXiv](www.arxiv.org), [dx.doi.org](dx.doi.org), [ISBN2bibtex](http://www.ebook.de/de/tools/isbn2bibtex).  
+The advanced import can also work with [ADS](https://ui.adsabs.harvard.edu/), [arXiv](www.arxiv.org), [dx.doi.org](dx.doi.org).  
 If an arXiv identifier is present, you can download the paper abstract from arXiv (there is an option to do this by default).
 
 ### Export
 It is very easy to export some entries into a `.bib` file.
 You can export the entire bibtex database, a selection or let the program export only the entries that you need to compile a given `.tex` file.
 All the functions are available in the `File` menu.
 
@@ -318,9 +317,7 @@
 Please note that changing the configuration **will not move** the existing files into the new locations.
 
 
 ## 5. Acknowledgments
 This software is part of a project that has received funding from the European Union's Horizon 2020 research and innovation programme, under the Marie SkÅ‚odowska-Curie grant agreement No 796941.
 
 Icons adopted in the GUI are mainly from the [Breeze-icons](https://github.com/KDE/breeze-icons) theme, from [KDE](https://www.kde.org/).
-
-
```

### Comparing `physbiblio-2.0.4/PhysBiblio.exe` & `physbiblio-2.0.5/PhysBiblio.exe`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/README.md` & `physbiblio-2.0.5/README.md`

 * *Files 2% similar despite different names*

```diff
@@ -140,15 +140,15 @@
 
 ### Profiles
 You may manage different profiles, each with different settings and independent databases.
 It may be useful if you want to maintain separate activities or collections independently one of the other.
 
 ### Import
 The default import interface can fetch and download information from [INSPIRE-HEP](http://inspirehep.net/).
-The advanced import can also work with [ADS](https://ui.adsabs.harvard.edu/), [arXiv](www.arxiv.org), [dx.doi.org](dx.doi.org), [ISBN2bibtex](http://www.ebook.de/de/tools/isbn2bibtex).  
+The advanced import can also work with [ADS](https://ui.adsabs.harvard.edu/), [arXiv](www.arxiv.org), [dx.doi.org](dx.doi.org).  
 If an arXiv identifier is present, you can download the paper abstract from arXiv (there is an option to do this by default).
 
 ### Export
 It is very easy to export some entries into a `.bib` file.
 You can export the entire bibtex database, a selection or let the program export only the entries that you need to compile a given `.tex` file.
 All the functions are available in the `File` menu.
```

### Comparing `physbiblio-2.0.4/physbiblio/__init__.py` & `physbiblio-2.0.5/physbiblio/__init__.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/argParser.py` & `physbiblio-2.0.5/physbiblio/argParser.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/bibtexWriter.py` & `physbiblio-2.0.5/physbiblio/bibtexWriter.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/cli.py` & `physbiblio-2.0.5/physbiblio/cli.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/config.py` & `physbiblio-2.0.5/physbiblio/config.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/database.py` & `physbiblio-2.0.5/physbiblio/database.py`

 * *Files 0% similar despite different names*

```diff
@@ -3514,16 +3514,14 @@
         try:
             self.mainDB.catBib.insert(pbConfig.params["defaultCategories"], key)
             if method == "inspire":
                 eid = self.updateInspireID(
                     entry, key, number=None if not requireAll else number
                 )
                 self.updateInfoFromOAI(eid)
-            elif method == "isbn":
-                self.setBook(key)
             if "inproceeding" in data["bibtex"].lower():
                 self.setProceeding(key)
             if "phdthesis" in data["bibtex"].lower():
                 self.setPhdThesis(key)
             pBLogger.info(dstr.Bibs.laiInserted)
             self.lastInserted.append(key)
             return e if returnBibtex else True
```

### Comparing `physbiblio-2.0.4/physbiblio/databaseCore.py` & `physbiblio-2.0.5/physbiblio/databaseCore.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/errors.py` & `physbiblio-2.0.5/physbiblio/errors.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/export.py` & `physbiblio-2.0.5/physbiblio/export.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/basicDialogs.py` & `physbiblio-2.0.5/physbiblio/gui/basicDialogs.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/bibWindows.py` & `physbiblio-2.0.5/physbiblio/gui/bibWindows.py`

 * *Files 2% similar despite different names*

```diff
@@ -758,33 +758,51 @@
                 or for a right-click event on a single entry
             arxiv: the arxiv number of the bibtex record
         """
         if selection or (not selection and (arxiv != "" and arxiv is not None)):
             menuA = []
             menuA.extend(
                 (
-                    QAction(bwstr.Acts.arxLoad, self.menu, triggered=self.onAbs),
-                    QAction(bwstr.Acts.arxMore, self.menu, triggered=self.onArx),
+                    QAction(
+                        bwstr.Acts.arxLoad,
+                        self.menu,
+                        triggered=lambda c=False: self.onAbs(),
+                    ),
+                    QAction(
+                        bwstr.Acts.arxMore,
+                        self.menu,
+                        triggered=lambda c=False: self.onArx(),
+                    ),
                 )
             )
             self.menu.possibleActions.append([bwstr.Acts.arxTit, menuA])
 
     def _createMenuCopy(self, selection, initialRecord):
         """Create part of the right click menu,
         concerning the copy to clipboard functions
 
         Parameters:
             selection: if the menu is for a multiple entries selection
                 or for a right-click event on a single entry
             initialRecord: the bibtex record to be used
         """
         menuC = [
-            QAction(bwstr.Acts.cpKey, self.menu, triggered=self.onCopyKeys),
-            QAction(bwstr.Acts.cpCite, self.menu, triggered=self.onCopyCites),
-            QAction(bwstr.Acts.cpBib, self.menu, triggered=self.onCopyBibtexs),
+            QAction(
+                bwstr.Acts.cpKey, self.menu, triggered=lambda c=False: self.onCopyKeys()
+            ),
+            QAction(
+                bwstr.Acts.cpCite,
+                self.menu,
+                triggered=lambda c=False: self.onCopyCites(),
+            ),
+            QAction(
+                bwstr.Acts.cpBib,
+                self.menu,
+                triggered=lambda c=False: self.onCopyBibtexs(),
+            ),
         ]
         subm = []
         latexToText = LatexNodes2Text(math_mode="verbatim", keep_comments=False)
         if not selection:
             for field in (
                 "abstract",
                 "arXiv",
@@ -892,24 +910,30 @@
                     c = (
                         latexToText.latex_to_text(content)
                         if convert_to_latex
                         else content
                     )
                     subm.append(
                         QAction(
-                            field, self.menu, triggered=lambda t=c: copyToClipboard(t)
+                            field,
+                            self.menu,
+                            triggered=lambda c=False, t=c: copyToClipboard(t),
                         )
                     )
         if len(subm) > 0:
             menuC.append(None)
             menuC.extend(subm)
         menuC.extend(
             (
                 None,
-                QAction(bwstr.Acts.cpDir, self.menu, triggered=self.onCopyDir),
+                QAction(
+                    bwstr.Acts.cpDir,
+                    self.menu,
+                    triggered=lambda c=False: self.onCopyDir(),
+                ),
             )
         )
         self.menu.possibleActions.append([bwstr.Acts.cpTit, menuC])
 
     def _createMenuInspire(self, selection, inspireID):
         """Create part of the right click menu,
         concerning the INSPIRE-HEP-related functions
@@ -920,35 +944,41 @@
             inspireID: the inspire ID of the bibtex record
         """
         menuI = []
         menuI.append(
             QAction(
                 bwstr.Acts.insCompl,
                 self.menu,
-                triggered=self.onComplete,
+                triggered=lambda c=False: self.onComplete(),
             )
         )
         if selection or (not selection and inspireID):
             menuI.extend(
                 (
                     QAction(
                         bwstr.Acts.insUpd,
                         self.menu,
-                        triggered=lambda r=True: self.onUpdate(force=r),
+                        triggered=lambda c=False, r=True: self.onUpdate(force=r),
                     ),
                     QAction(
                         bwstr.Acts.insRel,
                         self.menu,
-                        triggered=lambda f=(not selection), r=True: self.onUpdate(
-                            force=f, reloadAll=r
-                        ),
+                        triggered=lambda c=False, f=(
+                            not selection
+                        ), r=True: self.onUpdate(force=f, reloadAll=r),
                     ),
-                    QAction(bwstr.Acts.insCit, self.menu, triggered=self.onCitations),
                     QAction(
-                        bwstr.Acts.insCitCo, self.menu, triggered=self.onCitationCount
+                        bwstr.Acts.insCit,
+                        self.menu,
+                        triggered=lambda c=False: self.onCitations(),
+                    ),
+                    QAction(
+                        bwstr.Acts.insCitCo,
+                        self.menu,
+                        triggered=lambda c=False: self.onCitationCount(),
                     ),
                 )
             )
             self.menu.possibleActions.append([bwstr.Acts.insTit, menuI])
         else:
             menuI[-1].setToolTip(bwstr.Acts.insComplTip)
             self.menu.possibleActions.append(
@@ -967,31 +997,37 @@
         """
         menuL = []
         if arxiv is not None and arxiv != "":
             menuL.append(
                 QAction(
                     bwstr.Acts.lnArx,
                     self.menu,
-                    triggered=lambda l=bibkey, t="arxiv": pBGuiView.openLink(l, t),
+                    triggered=lambda c=False, l=bibkey, t="arxiv": pBGuiView.openLink(
+                        l, t
+                    ),
                 )
             )
         if doi is not None and doi != "":
             menuL.append(
                 QAction(
                     bwstr.Acts.lnDoi,
                     self.menu,
-                    triggered=lambda l=bibkey, t="doi": pBGuiView.openLink(l, t),
+                    triggered=lambda c=False, l=bibkey, t="doi": pBGuiView.openLink(
+                        l, t
+                    ),
                 )
             )
         if inspireID is not None and inspireID != "":
             menuL.append(
                 QAction(
                     bwstr.Acts.lnIns,
                     self.menu,
-                    triggered=lambda l=bibkey, t="inspire": pBGuiView.openLink(l, t),
+                    triggered=lambda c=False, l=bibkey, t="inspire": pBGuiView.openLink(
+                        l, t
+                    ),
                 )
             )
         if len(menuL) > 0:
             self.menu.possibleActions.append([bwstr.Acts.lnTit, menuL])
 
     def _createMenuMarkType(self, initialRecord):
         """Create part of the right click menu,
@@ -1007,24 +1043,24 @@
                     (
                         bwstr.Acts.maRem
                         if m in initialRecord["marks"]
                         else bwstr.Acts.maAdd
                     )
                     % pBMarks.marks[m]["desc"],
                     self.menu,
-                    triggered=lambda x=m: self.onUpdateMark(x),
+                    triggered=lambda c=False, x=m: self.onUpdateMark(x),
                 )
             )
         menuT = []
         for k, v in sorted(convertType.items()):
             menuT.append(
                 QAction(
                     (bwstr.Acts.tyRem if initialRecord[k] else bwstr.Acts.tyAdd) % v,
                     self.menu,
-                    triggered=lambda t=k: self.onUpdateType(t),
+                    triggered=lambda c=False, t=k: self.onUpdateType(t),
                 )
             )
         self.menu.possibleActions.extend(
             ([bwstr.Acts.maTit, menuM], [bwstr.Acts.tyTit, menuT], None)
         )
 
     def _createMenuMarkTypeList(self):
@@ -1034,36 +1070,36 @@
         menuM = []
         for m in sorted(pBMarks.marks.keys()):
             menuM.extend(
                 (
                     QAction(
                         bwstr.Acts.maAddL % pBMarks.marks[m]["desc"],
                         self.menu,
-                        triggered=lambda m=m: self.onUpdateMark(m, force=1),
+                        triggered=lambda c=False, m=m: self.onUpdateMark(m, force=1),
                     ),
                     QAction(
                         bwstr.Acts.maRemL % pBMarks.marks[m]["desc"],
                         self.menu,
-                        triggered=lambda m=m: self.onUpdateMark(m, force=0),
+                        triggered=lambda c=False, m=m: self.onUpdateMark(m, force=0),
                     ),
                 )
             )
         menuT = []
         for k, v in sorted(convertType.items()):
             menuT.extend(
                 (
                     QAction(
                         bwstr.Acts.tyAddL % v,
                         self.menu,
-                        triggered=lambda t=k: self.onUpdateType(t, force=1),
+                        triggered=lambda c=False, t=k: self.onUpdateType(t, force=1),
                     ),
                     QAction(
                         bwstr.Acts.tyRemL % v,
                         self.menu,
-                        triggered=lambda t=k: self.onUpdateType(t, force=0),
+                        triggered=lambda c=False, t=k: self.onUpdateType(t, force=0),
                     ),
                 )
             )
         self.menu.possibleActions.extend(
             ([bwstr.Acts.maTit, menuM], [bwstr.Acts.tyTit, menuT], None)
         )
 
@@ -1087,142 +1123,156 @@
             pdfDir = pBPDF.getFileDir(bibkey)
             shortfiles = {f.replace(pdfDir + os.sep, ""): f for f in files}
             if arxivFile in files:
                 menuP.append(
                     QAction(
                         bwstr.Acts.pdfO % "arXiv",
                         self.menu,
-                        triggered=lambda k=bibkey, t="file", f=arxivFile: pBGuiView.openLink(
+                        triggered=lambda c=False, k=bibkey, t="file", f=arxivFile: pBGuiView.openLink(
                             k, t, fileArg=f
                         ),
                     )
                 )
             if doiFile in files:
                 menuP.append(
                     QAction(
                         bwstr.Acts.pdfO % "DOI",
                         self.menu,
-                        triggered=lambda k=bibkey, t="file", f=doiFile: pBGuiView.openLink(
+                        triggered=lambda c=False, k=bibkey, t="file", f=doiFile: pBGuiView.openLink(
                             k, t, fileArg=f
                         ),
                     )
                 )
             for fn in sorted(shortfiles):
                 f = shortfiles[fn]
                 if f not in (arxivFile, doiFile):
                     menuP.append(
                         QAction(
                             bwstr.Acts.pdfOpen % fn,
                             self.menu,
-                            triggered=lambda k=bibkey, t="file", f=f: pBGuiView.openLink(
+                            triggered=lambda c=False, k=bibkey, t="file", f=f: pBGuiView.openLink(
                                 k, t, fileArg=f
                             ),
                         )
                     )
             if len(menuP) > 0:
                 menuP.append(None)
-            menuP.append(QAction(bwstr.Acts.pdfGen, self.menu, triggered=self.onAddPDF))
+            menuP.append(
+                QAction(
+                    bwstr.Acts.pdfGen,
+                    self.menu,
+                    triggered=lambda c=False: self.onAddPDF(),
+                )
+            )
             if len(files) > 0:
                 menuP.append(None)
             if arxivFile in files:
                 files.remove(arxivFile)
                 tmpM = []
                 tmpM.extend(
                     (
                         QAction(
                             bwstr.Acts.pdfD % "arXiv",
                             self.menu,
-                            triggered=lambda k=bibkey, a="arxiv", t="arxiv PDF": self.onDeletePDFFile(
+                            triggered=lambda c=False, k=bibkey, a="arxiv", t="arxiv PDF": self.onDeletePDFFile(
                                 k, a, t
                             ),
                         ),
                         QAction(
                             bwstr.Acts.pdfC % "arXiv",
                             self.menu,
-                            triggered=lambda k=bibkey, a="arxiv": self.onCopyPDFFile(
+                            triggered=lambda c=False, k=bibkey, a="arxiv": self.onCopyPDFFile(
                                 k, a
                             ),
                         ),
                     )
                 )
                 menuP.append([bwstr.Acts.pdfM % "arXiv", tmpM])
             elif arxiv is not None and arxiv != "":
                 menuP.append(
-                    QAction(bwstr.Acts.pdfArxW, self.menu, triggered=self.onDown)
+                    QAction(
+                        bwstr.Acts.pdfArxW,
+                        self.menu,
+                        triggered=lambda c=False: self.onDown(),
+                    )
                 )
             if doiFile in files:
                 files.remove(doiFile)
                 tmpM = []
                 tmpM.extend(
                     (
                         QAction(
                             bwstr.Acts.pdfD % "DOI",
                             self.menu,
-                            triggered=lambda k=bibkey, a="doi", t="DOI PDF": self.onDeletePDFFile(
+                            triggered=lambda c=False, k=bibkey, a="doi", t="DOI PDF": self.onDeletePDFFile(
                                 k, a, t
                             ),
                         ),
                         QAction(
                             bwstr.Acts.pdfC % "DOI",
                             self.menu,
-                            triggered=lambda k=bibkey, a="doi": self.onCopyPDFFile(
+                            triggered=lambda c=False, k=bibkey, a="doi": self.onCopyPDFFile(
                                 k, a
                             ),
                         ),
                     )
                 )
                 menuP.append([bwstr.Acts.pdfM % "DOI", tmpM])
             elif doi is not None and doi != "":
                 menuP.append(
                     QAction(
                         bwstr.Acts.pdfDOIA,
                         self.menu,
-                        triggered=lambda g="doi": self.onAddPDF(g),
+                        triggered=lambda c=False, g="doi": self.onAddPDF(g),
                     )
                 )
             shortfiles = {f.replace(pdfDir + os.sep, ""): f for f in files}
             for fn in sorted(shortfiles):
                 f = shortfiles[fn]
                 tmpM = []
                 tmpM.extend(
                     (
                         QAction(
                             bwstr.Acts.pdfDel % fn,
                             self.menu,
-                            triggered=lambda k=bibkey, a=fn, t=f: self.onDeletePDFFile(
+                            triggered=lambda c=False, k=bibkey, a=fn, t=f: self.onDeletePDFFile(
                                 k, a, a, t
                             ),
                         ),
                         QAction(
                             bwstr.Acts.pdfCp % fn,
                             self.menu,
-                            triggered=lambda k=bibkey, a=fn, t=f: self.onCopyPDFFile(
+                            triggered=lambda c=False, k=bibkey, a=fn, t=f: self.onCopyPDFFile(
                                 k, a, t
                             ),
                         ),
                     )
                 )
                 menuP.append([bwstr.Acts.pdfMg % fn, tmpM])
             if os.path.exists(pdfDir):
                 menuP.extend(
                     (
                         None,
                         QAction(
                             bwstr.Acts.pdfOpenDir,
                             self.menu,
-                            triggered=lambda k=bibkey, t="file", f=pdfDir: pBGuiView.openLink(
+                            triggered=lambda c=False, k=bibkey, t="file", f=pdfDir: pBGuiView.openLink(
                                 k, t, fileArg=f
                             ),
                         ),
                     )
                 )
             self.menu.possibleActions.append([bwstr.Acts.pdfTit, menuP])
         else:
             self.menu.possibleActions.append(
-                QAction(bwstr.Acts.pdfArxW, self.menu, triggered=self.onDown)
+                QAction(
+                    bwstr.Acts.pdfArxW,
+                    self.menu,
+                    triggered=lambda c=False: self.onDown(),
+                )
             )
 
     def createContextMenu(self, selection=False):
         """Create a context menu event, for one or multiple entries
 
         Parameter:
             selection (default False): if True, the menu is for
@@ -1260,15 +1310,17 @@
                 ("citSelNS", "citations_no_self"),
             ):
                 act = QAction(getattr(bwstr.Acts, strname) % initialRecord[field], menu)
                 act.setDisabled(True)
                 menu.possibleActions.append(act)
             menu.possibleActions.append(None)
             menu.possibleActions.append(
-                QAction(bwstr.Acts.modify, menu, triggered=self.onModify)
+                QAction(
+                    bwstr.Acts.modify, menu, triggered=lambda c=False: self.onModify()
+                )
             )
         else:
             initialRecord = None
             arxiv = None
             inspireID = None
             act = QAction(bwstr.Acts.countSel % len(self.keys), menu)
             act.setDisabled(True)
@@ -1280,22 +1332,24 @@
                 cit = sum([a[field] for a in self.bibs])
                 act = QAction(getattr(bwstr.Acts, strname) % cit, menu)
                 act.setDisabled(True)
                 menu.possibleActions.append(act)
             menu.possibleActions.append(None)
             if len(self.keys) == 2:
                 menu.possibleActions.append(
-                    QAction(bwstr.Acts.merge, menu, triggered=self.onMerge)
+                    QAction(
+                        bwstr.Acts.merge, menu, triggered=lambda c=False: self.onMerge()
+                    )
                 )
 
         menu.possibleActions.append(
-            QAction(bwstr.Acts.clean, menu, triggered=self.onClean)
+            QAction(bwstr.Acts.clean, menu, triggered=lambda c=False: self.onClean())
         )
         menu.possibleActions.append(
-            QAction(bwstr.Acts.delete, menu, triggered=self.onDelete)
+            QAction(bwstr.Acts.delete, menu, triggered=lambda c=False: self.onDelete())
         )
         menu.possibleActions.append(None)
 
         if not selection:
             self._createMenuMarkType(initialRecord)
         else:
             self._createMenuMarkTypeList()
@@ -1304,30 +1358,32 @@
 
         self._createMenuPDF(selection, initialRecord)
         if not selection:
             self._createMenuLinks(bibkey, arxiv, doi, inspireID)
         menu.possibleActions.append(None)
 
         menu.possibleActions.append(
-            QAction(bwstr.Acts.selCat, menu, triggered=self.onCat)
+            QAction(bwstr.Acts.selCat, menu, triggered=lambda c=False: self.onCat())
         )
         menu.possibleActions.append(
-            QAction(bwstr.Acts.selExp, menu, triggered=self.onExp)
+            QAction(bwstr.Acts.selExp, menu, triggered=lambda c=False: self.onExp())
         )
         menu.possibleActions.append(None)
 
         self._createMenuInspire(selection, inspireID)
         self._createMenuArxiv(selection, arxiv)
         menu.possibleActions.append(None)
 
         menu.possibleActions.append(
-            QAction(bwstr.Acts.expBib, menu, triggered=self.onExport)
+            QAction(bwstr.Acts.expBib, menu, triggered=lambda c=False: self.onExport())
         )
         menu.possibleActions.append(
-            QAction(bwstr.Acts.cpAllPdf, menu, triggered=self.onCopyAllPDF)
+            QAction(
+                bwstr.Acts.cpAllPdf, menu, triggered=lambda c=False: self.onCopyAllPDF()
+            )
         )
 
         menu.fillMenu()
         return menu
 
     def onAddPDF(self, ftype="generic"):
         """Ask and copy in the proper folder a new PDF
@@ -1736,15 +1792,15 @@
             return
         for e in self.bibs:
             value = force if force in (0, 1) else (0 if e[type_] else 1)
             pBDB.bibs.updateField(e["bibkey"], type_, value, verbose=0)
         self.parent().reloadMainContent(pBDB.bibs.fetchFromLast().lastFetched)
 
 
-class BibtexListWindow(QFrame, ObjListWindow):
+class BibtexListWindow(ObjListWindow):
     """Class that constructs the main bibtex table"""
 
     def __init__(self, parent=None, bibs=None, askBibs=False, previous=[]):
         """Define some properties and create the table
 
         Parameters:
             parent (default None): the parent widget
@@ -1775,16 +1831,15 @@
         self.selAllAct = None
         self.unselAllAct = None
         self.lastLabel = None
         self.mergeLabel = None
         self.filterInput = None
         self.tableModel = None
 
-        QFrame.__init__(self, parent)
-        ObjListWindow.__init__(self, parent)
+        super(BibtexListWindow, self).__init__(parent)
 
         self.createActions()
         self.createTable()
 
     def getRowBibkey(self, model, index):
         """Use the model index to return the bibkey for the given row
 
@@ -2472,15 +2527,15 @@
             files.remove(arxivFile)
         for f in files:
             fname = f.split(os.sep)[-1]
             self.possibleActions.append(
                 QAction(
                     bwstr.Acts.pdfOpen % fname,
                     self,
-                    triggered=lambda fn=fname: self.onOpenOther(fn),
+                    triggered=lambda c=False, fn=fname: self.onOpenOther(fn),
                 )
             )
         self.fillMenu()
 
     def onOpenArxiv(self):
         """Set the result for opening the arXiv PDF"""
         self.mainWin.statusBarMessage(bwstr.pdfOg % "arXiv")
```

### Comparing `physbiblio-2.0.4/physbiblio/gui/catWindows.py` & `physbiblio-2.0.5/physbiblio/gui/catWindows.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/commonClasses.py` & `physbiblio-2.0.5/physbiblio/gui/commonClasses.py`

 * *Files 0% similar despite different names*

```diff
@@ -191,18 +191,17 @@
         self.tableWidth = None
         self.proxyModel = None
         self.gridLayout = gridLayout
         self.filterInput = None
         self.proxyModel = None
         self.tableview = None
         if gridLayout:
-            self.currLayout = QGridLayout()
+            self.currLayout = QGridLayout(self)
         else:
-            self.currLayout = QVBoxLayout()
-        self.setLayout(self.currLayout)
+            self.currLayout = QVBoxLayout(self)
 
     def triggeredContextMenuEvent(self, row, col, event):
         """Not implemented: requires a subclass"""
         raise NotImplementedError()
 
     def handleItemEntered(self, index):
         """Not implemented: requires a subclass"""
```

### Comparing `physbiblio-2.0.4/physbiblio/gui/dialogWindows.py` & `physbiblio-2.0.5/physbiblio/gui/dialogWindows.py`

 * *Files 0% similar despite different names*

```diff
@@ -590,15 +590,15 @@
         grid.addWidget(PBLabel(dwstr.advImpSearch), 0, 0)
         self.searchStr = QLineEdit("")
         grid.addWidget(self.searchStr, 0, 1)
 
         grid.addWidget(PBLabel(dwstr.advImpMethod), 1, 0)
         self.comboMethod = PBComboBox(
             self,
-            ["INSPIRE-HEP", "ADS-NASA", "arXiv", "DOI", "ISBN"],
+            ["INSPIRE-HEP", "ADS-NASA", "arXiv", "DOI"],
             current="INSPIRE-HEP",
         )
         grid.addWidget(self.comboMethod, 1, 1)
 
         # OK button
         self.acceptButton = QPushButton(dwstr.ok, self)
         self.acceptButton.clicked.connect(self.onOk)
```

### Comparing `physbiblio-2.0.4/physbiblio/gui/errorManager.py` & `physbiblio-2.0.5/physbiblio/gui/errorManager.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/expWindows.py` & `physbiblio-2.0.5/physbiblio/gui/expWindows.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/application-exit.png` & `physbiblio-2.0.5/physbiblio/gui/images/application-exit.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/application-pdf.png` & `physbiblio-2.0.5/physbiblio/gui/images/application-pdf.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/arrow-down.png` & `physbiblio-2.0.5/physbiblio/gui/images/arrow-down.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/arrow-up.png` & `physbiblio-2.0.5/physbiblio/gui/images/arrow-up.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/delete.png` & `physbiblio-2.0.5/physbiblio/gui/images/delete.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/dialog-error.png` & `physbiblio-2.0.5/physbiblio/gui/images/dialog-error.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/dialog-ok-apply.png` & `physbiblio-2.0.5/physbiblio/gui/images/dialog-ok-apply.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/dialog-warning.png` & `physbiblio-2.0.5/physbiblio/gui/images/dialog-warning.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/download.png` & `physbiblio-2.0.5/physbiblio/gui/images/download.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/edit-clear.png` & `physbiblio-2.0.5/physbiblio/gui/images/edit-clear.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/edit-find-replace.png` & `physbiblio-2.0.5/physbiblio/gui/images/edit-find-replace.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/edit-node.png` & `physbiblio-2.0.5/physbiblio/gui/images/edit-node.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/edit-select-all.png` & `physbiblio-2.0.5/physbiblio/gui/images/edit-select-all.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/edit-undo.png` & `physbiblio-2.0.5/physbiblio/gui/images/edit-undo.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/edit-unselect-all.png` & `physbiblio-2.0.5/physbiblio/gui/images/edit-unselect-all.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/edit.png` & `physbiblio-2.0.5/physbiblio/gui/images/edit.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/emblem-favorite-symbolic.png` & `physbiblio-2.0.5/physbiblio/gui/images/emblem-favorite-symbolic.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/emblem-question.png` & `physbiblio-2.0.5/physbiblio/gui/images/emblem-question.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/export-table.png` & `physbiblio-2.0.5/physbiblio/gui/images/export-table.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/export.png` & `physbiblio-2.0.5/physbiblio/gui/images/export.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/file-add.png` & `physbiblio-2.0.5/physbiblio/gui/images/file-add.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/find.png` & `physbiblio-2.0.5/physbiblio/gui/images/find.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/help-about.png` & `physbiblio-2.0.5/physbiblio/gui/images/help-about.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/icon.png` & `physbiblio-2.0.5/physbiblio/gui/images/icon.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/profiles.png` & `physbiblio-2.0.5/physbiblio/gui/images/profiles.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/refresh.png` & `physbiblio-2.0.5/physbiblio/gui/images/refresh.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/settings.png` & `physbiblio-2.0.5/physbiblio/gui/images/settings.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/terminal.png` & `physbiblio-2.0.5/physbiblio/gui/images/terminal.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/unread-new.png` & `physbiblio-2.0.5/physbiblio/gui/images/unread-new.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/view-filter.png` & `physbiblio-2.0.5/physbiblio/gui/images/view-filter.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/images/web-search.png` & `physbiblio-2.0.5/physbiblio/gui/images/web-search.png`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/inspireStatsGUI.py` & `physbiblio-2.0.5/physbiblio/gui/inspireStatsGUI.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/mainWindow.py` & `physbiblio-2.0.5/physbiblio/gui/mainWindow.py`

 * *Files 0% similar despite different names*

```diff
@@ -648,47 +648,49 @@
         if len(freqSearches) > 0:
             self.searchMenu = self.menuBar().addMenu(mwstr.Act.freqSM)
             for fs in freqSearches:
                 self.searchMenu.addAction(
                     QAction(
                         fs["name"],
                         self,
-                        triggered=lambda sD=ast.literal_eval(fs["searchDict"]), l=fs[
-                            "limitNum"
-                        ], o=fs["offsetNum"], n=fs["name"]: self.runSearchBiblio(
+                        triggered=lambda c=False, sD=ast.literal_eval(
+                            fs["searchDict"]
+                        ), l=fs["limitNum"], o=fs["offsetNum"], n=fs[
+                            "name"
+                        ]: self.runSearchBiblio(
                             sD, l, o, newTab=n
                         ),
                     )
                 )
             self.searchMenu.addSeparator()
             for fs in freqSearches:
                 tmp = self.searchMenu.addMenu(mwstr.Act.manage % fs["name"])
                 tmp.addAction(
                     QAction(
                         mwstr.Act.edit % fs["name"],
                         self,
-                        triggered=lambda idS=fs["idS"], n=fs[
+                        triggered=lambda c=False, idS=fs["idS"], n=fs[
                             "name"
                         ]: self.editSearchBiblio(idS, n),
                     )
                 )
                 tmp.addAction(
                     QAction(
                         mwstr.Act.rename % fs["name"],
                         self,
-                        triggered=lambda idS=fs["idS"], n=fs[
+                        triggered=lambda c=False, idS=fs["idS"], n=fs[
                             "name"
                         ]: self.renameSearchBiblio(idS, n),
                     )
                 )
                 tmp.addAction(
                     QAction(
                         mwstr.Act.delete % fs["name"],
                         self,
-                        triggered=lambda idS=fs["idS"], n=fs[
+                        triggered=lambda c=False, idS=fs["idS"], n=fs[
                             "name"
                         ]: self.delSearchBiblio(idS, n),
                     )
                 )
         else:
             self.searchMenu = None
 
@@ -696,15 +698,15 @@
         if len(freqReplaces) > 0:
             self.replaceMenu = self.menuBar().addMenu(mwstr.Act.freqRM)
             for fs in freqReplaces:
                 self.replaceMenu.addAction(
                     QAction(
                         fs["name"],
                         self,
-                        triggered=lambda sD=ast.literal_eval(
+                        triggered=lambda c=False, sD=ast.literal_eval(
                             fs["searchDict"]
                         ), r=ast.literal_eval(fs["replaceFields"]), o=fs[
                             "offsetNum"
                         ], n=fs[
                             "name"
                         ]: self.runSearchReplaceBiblio(
                             sD, r, o, newTab=n
@@ -714,33 +716,33 @@
             self.replaceMenu.addSeparator()
             for fs in freqReplaces:
                 tmp = self.replaceMenu.addMenu(mwstr.Act.manage % fs["name"])
                 tmp.addAction(
                     QAction(
                         mwstr.Act.edit % fs["name"],
                         self,
-                        triggered=lambda idS=fs["idS"], n=fs[
+                        triggered=lambda c=False, idS=fs["idS"], n=fs[
                             "name"
                         ]: self.editSearchBiblio(idS, n),
                     )
                 )
                 tmp.addAction(
                     QAction(
                         mwstr.Act.rename % fs["name"],
                         self,
-                        triggered=lambda idS=fs["idS"], n=fs[
+                        triggered=lambda c=False, idS=fs["idS"], n=fs[
                             "name"
                         ]: self.renameSearchBiblio(idS, n),
                     )
                 )
                 tmp.addAction(
                     QAction(
                         mwstr.Act.delete % fs["name"],
                         self,
-                        triggered=lambda idS=fs["idS"], n=fs[
+                        triggered=lambda c=False, idS=fs["idS"], n=fs[
                             "name"
                         ]: self.delSearchBiblio(idS, n),
                     )
                 )
         else:
             self.replaceMenu = None
 
@@ -1929,16 +1931,14 @@
                     if not pBDB.bibs.insert(data):
                         pBGUILogger.warning(mwstr.elementFailed % key)
                         continue
                     try:
                         if method == "inspire":
                             eid = pBDB.bibs.updateInspireID(key)
                             pBDB.bibs.updateInfoFromOAI(eid)
-                        elif method == "isbn":
-                            pBDB.bibs.setBook(key)
                         pBLogger.info(mwstr.elementInserted % key)
                         inserted.append(key)
                     except Exception:
                         pBLogger.warning(mwstr.failedComplete % key, exc_info=True)
                 self.statusBarMessage(mwstr.elementImported % (inserted))
                 if selImpo.askCats.isChecked():
                     for key in inserted:
```

### Comparing `physbiblio-2.0.4/physbiblio/gui/marks.py` & `physbiblio-2.0.5/physbiblio/gui/marks.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/profilesManager.py` & `physbiblio-2.0.5/physbiblio/gui/profilesManager.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/resourcesPyside6.py` & `physbiblio-2.0.5/physbiblio/gui/resourcesPyside6.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/setuptests.py` & `physbiblio-2.0.5/physbiblio/gui/setuptests.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/__init__.py` & `physbiblio-2.0.5/physbiblio/gui/tests/__init__.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_basicDialogs.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_basicDialogs.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_bibWindows.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_bibWindows.py`

 * *Files 0% similar despite different names*

```diff
@@ -2010,18 +2010,18 @@
             self.assertIsInstance(c.menu.possibleActions[0], list)
             self.assertEqual(c.menu.possibleActions[0][0], "arXiv")
             self.assertIsInstance(c.menu.possibleActions[0][1], list)
             for a in c.menu.possibleActions[0][1]:
                 self.assertIsInstance(a, QAction)
             self.assertEqual(c.menu.possibleActions[0][1][0].text(), "Load abstract")
             c.menu.possibleActions[0][1][0].trigger()
-            _a.assert_called_once_with(c)
+            _a.assert_called_once()
             self.assertEqual(c.menu.possibleActions[0][1][1].text(), "Get more fields")
             c.menu.possibleActions[0][1][1].trigger()
-            _b.assert_called_once_with(c)
+            _b.assert_called_once()
 
         c.menu = PBMenu(self.mainW)
         with patch(
             "physbiblio.gui.bibWindows.CommonBibActions.onAbs", autospec=True
         ) as _a, patch(
             "physbiblio.gui.bibWindows.CommonBibActions.onArx", autospec=True
         ) as _b:
@@ -4811,26 +4811,23 @@
             autospec=True,
         ) as _oi, patch(
             "physbiblio.gui.bibWindows.BibtexListWindow.createActions", autospec=True
         ) as _ca, patch(
             "physbiblio.gui.bibWindows.BibtexListWindow.createTable", autospec=True
         ) as _ct:
             bw = BibtexListWindow(parent=self.mainW, bibs=[])
-            _fi.assert_called_once_with(bw, self.mainW)
-            _oi.assert_called_once_with(bw, self.mainW)
             _ca.assert_called_once_with(bw)
             _ct.assert_called_once_with(bw)
 
         with patch(
             "physbiblio.gui.bibWindows.BibtexListWindow.createActions", autospec=True
         ) as _ca, patch(
             "physbiblio.gui.bibWindows.BibtexListWindow.createTable", autospec=True
         ) as _ct:
             bw = BibtexListWindow(bibs=[])
-            self.assertIsInstance(bw, QFrame)
             self.assertIsInstance(bw, ObjListWindow)
             self.assertEqual(bw.parent(), None)
             self.assertEqual(bw.mainWin, None)
             self.assertEqual(bw.bibs, [])
             self.assertEqual(bw.askBibs, False)
             self.assertEqual(bw.previous, [])
             self.assertEqual(bw.currentAbstractKey, None)
@@ -4847,15 +4844,14 @@
         ) as _ct:
             bw = BibtexListWindow(
                 parent=self.mainW,
                 bibs=[{"bibkey": "abc"}],
                 askBibs=True,
                 previous=["abc"],
             )
-        self.assertIsInstance(bw, QFrame)
         self.assertIsInstance(bw, ObjListWindow)
         self.assertEqual(bw.parent(), self.mainW)
         self.assertEqual(bw.mainWin, self.mainW)
         self.assertEqual(bw.bibs, [{"bibkey": "abc"}])
         self.assertEqual(bw.askBibs, True)
         self.assertEqual(bw.previous, ["abc"])
 
@@ -5069,55 +5065,55 @@
         ]
         self.assertIsInstance(bw.selAct, QAction)
         self.assertEqual(bw.selAct.text(), "&Select entries")
         self.assertEqual(bw.selAct.parent(), bw)
         self.assertEqual(images[0], bw.selAct.icon().pixmap(images[0].size()).toImage())
         self.assertEqual(bw.selAct.statusTip(), "Select entries from the list")
         bw.selAct.trigger()
-        bw.enableSelection.assert_called_once_with()
+        bw.enableSelection.assert_called_once()
 
         self.assertIsInstance(bw.okAct, QAction)
         self.assertEqual(bw.okAct.text(), "Selection &completed")
         self.assertEqual(bw.okAct.parent(), bw)
         self.assertEqual(images[1], bw.okAct.icon().pixmap(images[1].size()).toImage())
         self.assertEqual(bw.okAct.statusTip(), "Selection of elements completed")
         bw.okAct.trigger()
-        bw.onOk.assert_called_once_with()
+        bw.onOk.assert_called_once()
 
         self.assertIsInstance(bw.clearAct, QAction)
         self.assertEqual(bw.clearAct.text(), "&Clear selection")
         self.assertEqual(bw.clearAct.parent(), bw)
         self.assertEqual(
             images[2], bw.clearAct.icon().pixmap(images[2].size()).toImage()
         )
         self.assertEqual(
             bw.clearAct.statusTip(), "Discard the current selection and hide checkboxes"
         )
         bw.clearAct.trigger()
-        bw.clearSelection.assert_called_once_with()
+        bw.clearSelection.assert_called_once()
 
         self.assertIsInstance(bw.selAllAct, QAction)
         self.assertEqual(bw.selAllAct.text(), "&Select all")
         self.assertEqual(bw.selAllAct.parent(), bw)
         self.assertEqual(
             images[3], bw.selAllAct.icon().pixmap(images[3].size()).toImage()
         )
         self.assertEqual(bw.selAllAct.statusTip(), "Select all the elements")
         bw.selAllAct.trigger()
-        bw.selectAll.assert_called_once_with()
+        bw.selectAll.assert_called_once()
 
         self.assertIsInstance(bw.unselAllAct, QAction)
         self.assertEqual(bw.unselAllAct.text(), "&Unselect all")
         self.assertEqual(bw.unselAllAct.parent(), bw)
         self.assertEqual(
             images[4], bw.unselAllAct.icon().pixmap(images[4].size()).toImage()
         )
         self.assertEqual(bw.unselAllAct.statusTip(), "Unselect all the elements")
         bw.unselAllAct.trigger()
-        bw.unselectAll.assert_called_once_with()
+        bw.unselectAll.assert_called_once()
 
     def test_restoreSort(self):
         """test restoreSort"""
         bw = BibtexListWindow(bibs=[])
         cb = bw.columns.index("bibkey")
         cc = bw.proxyModel.sortColumn()
         co = bw.proxyModel.sortOrder()
```

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_catWindows.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_catWindows.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_commonClasses.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_commonClasses.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_dialogWindows.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_dialogWindows.py`

 * *Files 0% similar despite different names*

```diff
@@ -880,21 +880,20 @@
         le = aid.grid.itemAtPosition(0, 1).widget()
         self.assertIsInstance(le, QLineEdit)
         self.assertEqual(le, aid.searchStr)
         self.assertEqual(le.text(), "")
         cm = aid.grid.itemAtPosition(1, 1).widget()
         self.assertIsInstance(cm, PBComboBox)
         self.assertEqual(cm, aid.comboMethod)
-        self.assertEqual(cm.count(), 5)
+        self.assertEqual(cm.count(), 4)
         self.assertEqual(cm.itemText(0), "INSPIRE-HEP")
         self.assertEqual(cm.currentText(), "INSPIRE-HEP")
         self.assertEqual(cm.itemText(1), "ADS-NASA")
         self.assertEqual(cm.itemText(2), "arXiv")
         self.assertEqual(cm.itemText(3), "DOI")
-        self.assertEqual(cm.itemText(4), "ISBN")
 
         self.assertIsInstance(aid.grid.itemAtPosition(2, 0).widget(), QPushButton)
         self.assertEqual(aid.grid.itemAtPosition(2, 0).widget(), aid.acceptButton)
         self.assertEqual(aid.acceptButton.text(), "OK")
         with patch(
             "physbiblio.gui.dialogWindows.AdvancedImportDialog.onOk", autospec=True
         ) as _o:
```

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_errorManager.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_errorManager.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_expWindows.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_expWindows.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_inspireStatsGUI.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_inspireStatsGUI.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_mainWindow.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_mainWindow.py`

 * *Files 2% similar despite different names*

```diff
@@ -309,18 +309,18 @@
             if i is not None:
                 img = QImage(i).convertToFormat(QImage.Format_ARGB32_Premultiplied)
                 self.assertEqual(img, act.icon().pixmap(img.size()).toImage())
             self.assertEqual(act.statusTip(), tip)
             if p is None:
                 with patch("%s.%s" % (self.clsName, trig), autospec=True) as _f:
                     act.trigger()
-                    _f.assert_called_once_with(self.mainW)
+                    _f.assert_called_once()
             else:
                 act.trigger()
-                p.assert_called_once_with()
+                p.assert_called_once()
 
         with patch("PySide6.QtWidgets.QMainWindow.close", autospec=True) as _f:
             mw = MainWindow(testing=True)
             mw.createActions()
             assertAction(
                 mw.exitAct,
                 "E&xit",
@@ -4173,15 +4173,14 @@
             )
             _ace.assert_called_once_with(self.mainW, ["a"])
             _in.assert_called_once_with("Element 'a' successfully inserted.\n")
             _cd.assert_called_once_with(
                 pBDB.catBib, pbConfig.params["defaultCategories"], "a"
             )
 
-        aid.comboMethod.setCurrentText("ISBN")
         aid.exec.reset_mock()
         with patch("logging.Logger.warning") as _w:
             ais = AdvancedImportSelect(
                 {
                     "a": {
                         "exist": True,
                         "bibpars": {
@@ -4205,121 +4204,17 @@
                 },
                 self.mainW,
             )
         ais.exec = MagicMock()
         ais.askCats.setCheckState(Qt.Unchecked)
         ais.selected = {"a": True, "b": True}
         ais.result = True
-        with patch(
-            self.modName + ".AdvancedImportDialog",
-            return_value=aid,
-            autospec=USE_AUTOSPEC_CLASS,
-        ) as _aid, patch(
-            self.modName + ".AdvancedImportSelect",
-            return_value=ais,
-            autospec=USE_AUTOSPEC_CLASS,
-        ) as _ais, patch(
-            "PySide6.QtWidgets.QApplication.setOverrideCursor", autospec=True
-        ) as _sc, patch(
-            "PySide6.QtWidgets.QApplication.restoreOverrideCursor", autospec=True
-        ) as _rc, patch(
-            self.modName + ".infoMessage", autospec=True
-        ) as _im, patch(
-            self.clsName + ".reloadMainContent", autospec=True
-        ) as _rmc, patch(
-            self.clsName + ".statusBarMessage", autospec=True
-        ) as _sbm, patch(
-            "physbiblio.webimport.isbn.WebSearch.retrieveUrlAll",
-            return_value='@article{a,\nauthor="gs",\ntitle="T"\n}\n'
-            + '@article{b,\nauthor="sg",\ntitle="tit"\n,'
-            + 'arxiv="1",\ndoi="2"\n}\n',
-            autospec=True,
-        ) as _ru, patch(
-            self.clsName + ".askCatsForEntries", autospec=True
-        ) as _ace, patch(
-            "logging.Logger.warning"
-        ) as _wa, patch(
-            "logging.Logger.info"
-        ) as _in, patch(
-            "logging.Logger.debug"
-        ) as _deb, patch(
-            "physbiblio.database.Entries.getByBibkey",
-            side_effect=[["a"], ["b"]],
-            autospec=True,
-        ) as _gbb, patch(
-            "physbiblio.database.Entries.getAll",
-            side_effect=[["b"], [], []],
-            autospec=True,
-        ) as _ga, patch(
-            "physbiblio.database.Entries.prepareInsert",
-            side_effect=["data1", "data2"],
-            autospec=True,
-        ) as _pi, patch(
-            "physbiblio.database.Entries.insert",
-            side_effect=[True, True],
-            autospec=True,
-        ) as _bi, patch(
-            "physbiblio.database.Entries.setBook", autospec=True
-        ) as _sb, patch(
-            "physbiblio.database.Entries.updateInspireID", autospec=True
-        ) as _ui, patch(
-            "physbiblio.database.Entries.updateInfoFromOAI", autospec=True
-        ) as _ii, patch(
-            "physbiblio.database.CatsEntries.delete", autospec=True
-        ) as _cd:
-            self.assertFalse(self.mainW.advancedImport())
-            _aid.assert_called_once_with()
-            aid.exec.assert_called_once_with()
-            _im.assert_not_called()
-            _ru.assert_called_once_with(physBiblioWeb.webSearch["isbn"], "test")
-            self.assertEqual(_sc.call_count, 1)
-            self.assertEqual(_rc.call_count, 1)
-            _rmc.assert_called_once_with(self.mainW)
-            _gbb.assert_has_calls(
-                [
-                    call(pBDB.bibs, "a", saveQuery=False),
-                    call(pBDB.bibs, "b", saveQuery=False),
-                ]
-            )
-            _ga.assert_not_called()
-            _pi.assert_has_calls(
-                [
-                    call(
-                        pBDB.bibs,
-                        '@Article{a,\n        author = "gs",'
-                        + '\n         title = "{T}",\n}\n\n',
-                    ),
-                    call(
-                        pBDB.bibs,
-                        '@Article{b,\n        author = "sg",'
-                        + '\n         title = "{tit}",\n           '
-                        + 'doi = "2",\n         arxiv = "1",\n}\n\n',
-                    ),
-                ]
-            )
-            _bi.assert_has_calls([call(pBDB.bibs, "data1"), call(pBDB.bibs, "data2")])
-            _wa.assert_not_called()
-            _sbm.assert_called_once_with(
-                self.mainW, "Entries successfully imported: ['a', 'b']"
-            )
-            _in.assert_has_calls(
-                [
-                    call("Element 'a' successfully inserted.\n"),
-                    call("Element 'b' successfully inserted.\n"),
-                ]
-            )
-            _sb.assert_has_calls([call(pBDB.bibs, "a"), call(pBDB.bibs, "b")])
-            _cd.assert_not_called()
-            _ace.assert_not_called()
-            _ui.assert_not_called()
-            _ii.assert_not_called()
 
         aid.comboMethod.setCurrentText("INSPIRE-HEP")
         aid.exec.reset_mock()
-        ais.exec.reset_mock()
         with patch(
             self.modName + ".AdvancedImportDialog",
             return_value=aid,
             autospec=USE_AUTOSPEC_CLASS,
         ) as _aid, patch(
             self.modName + ".AdvancedImportSelect",
             return_value=ais,
```

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_marks.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_marks.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_profilesManager.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_profilesManager.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/tests/test_threadElements.py` & `physbiblio-2.0.5/physbiblio/gui/tests/test_threadElements.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/gui/threadElements.py` & `physbiblio-2.0.5/physbiblio/gui/threadElements.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/inspireStats.py` & `physbiblio-2.0.5/physbiblio/inspireStats.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/parseAccents.py` & `physbiblio-2.0.5/physbiblio/parseAccents.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/pdf.py` & `physbiblio-2.0.5/physbiblio/pdf.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/setuptests.py` & `physbiblio-2.0.5/physbiblio/setuptests.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/strings/common.py` & `physbiblio-2.0.5/physbiblio/strings/common.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/strings/gui.py` & `physbiblio-2.0.5/physbiblio/strings/gui.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/strings/main.py` & `physbiblio-2.0.5/physbiblio/strings/main.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/strings/webimport.py` & `physbiblio-2.0.5/physbiblio/strings/webimport.py`

 * *Files 3% similar despite different names*

```diff
@@ -58,18 +58,14 @@
     searchIDInfo = "Search ID of %s -> %s"
     searchResultsFrom = "Search info from %s"
     startString = "\nSTARTING INSPIRE API harvester --- %s \n\n"
     warningJournal = "'journal' from OAI is missing or not a string (recid:%s)"
     warningMissingField = "Field '%s' from OAI is missing (recid:%s)"
 
 
-class ISBNStrings(GenericStrings):
-    """Strings for the isbn module"""
-
-
 class WebInterfStrings:
     """Strings for the webInterf module"""
 
     errorBadCodification = "[%s] -> Bad codification, utf-8 decode failed"
     errorImportMethod = "Error importing physbiblio.webimport.%s"
     errorNotFound = "[%s] -> %s not found"
     errorRetrieve = "[%s] -> Error in retrieving data from url"
```

### Comparing `physbiblio-2.0.4/physbiblio/tablesDef.py` & `physbiblio-2.0.5/physbiblio/tablesDef.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/testLoader.py` & `physbiblio-2.0.5/physbiblio/testLoader.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_argParser.py` & `physbiblio-2.0.5/physbiblio/tests/test_argParser.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_bibtexWriter.py` & `physbiblio-2.0.5/physbiblio/tests/test_bibtexWriter.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_config.py` & `physbiblio-2.0.5/physbiblio/tests/test_config.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_database.py` & `physbiblio-2.0.5/physbiblio/tests/test_database.py`

 * *Files 0% similar despite different names*

```diff
@@ -1594,21752 +1594,21707 @@
 00006390: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000063a0: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
 000063b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000063c0: 2020 2020 226f 7264 223a 2030 2c0a 2020      "ord": 0,.  
 000063d0: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
 000063e0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
 000063f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00006400: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00006410: 2873 656c 662e 7042 4442 2e63 6f6d 6d69  (self.pBDB.commi
-00006420: 7428 2929 0a20 2020 2020 2020 2073 656c  t()).        sel
-00006430: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-00006440: 662e 7042 4442 2e75 6e64 6f28 2929 0a20  f.pBDB.undo()). 
-00006450: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00006460: 7274 4571 7561 6c28 6c65 6e28 7365 6c66  rtEqual(len(self
-00006470: 2e70 4244 422e 6361 7473 2e67 6574 416c  .pBDB.cats.getAl
-00006480: 6c28 2929 2c20 3329 0a20 2020 2020 2020  l()), 3).       
-00006490: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-000064a0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-000064b0: 6c66 2e70 4244 422e 636f 6e6e 4578 6563  lf.pBDB.connExec
-000064c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000064d0: 2020 2222 220a 2020 2020 2020 2020 2020    """.          
-000064e0: 2020 494e 5345 5254 2069 6e74 6f20 6361    INSERT into ca
-000064f0: 7465 676f 7269 6573 2028 6e61 6d65 2c20  tegories (name, 
-00006500: 6465 7363 7269 7074 696f 6e2c 2070 6172  description, par
-00006510: 656e 7443 6174 2c20 636f 6d6d 656e 7473  entCat, comments
-00006520: 2c20 6f72 6429 0a20 2020 2020 2020 2020  , ord).         
-00006530: 2020 2020 2020 2076 616c 7565 7320 283a         values (:
-00006540: 6e61 6d65 2c20 3a64 6573 6372 6970 7469  name, :descripti
-00006550: 6f6e 2c20 3a70 6172 656e 7443 6174 2c20  on, :parentCat, 
-00006560: 3a63 6f6d 6d65 6e74 732c 203a 6f72 6429  :comments, :ord)
-00006570: 0a20 2020 2020 2020 2020 2020 2022 2222  .            """
-00006580: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006590: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-000065a0: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-000065b0: 2261 6263 6422 2c0a 2020 2020 2020 2020  "abcd",.        
-000065c0: 2020 2020 2020 2020 2020 2020 2264 6573              "des
-000065d0: 6372 6970 7469 6f6e 223a 2022 6522 2c0a  cription": "e",.
-000065e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000065f0: 2020 2020 2270 6172 656e 7443 6174 223a      "parentCat":
-00006600: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-00006610: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
-00006620: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
-00006630: 2020 2020 2020 2020 2020 2020 226f 7264              "ord
-00006640: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
-00006650: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-00006660: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-00006670: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00006680: 7365 7274 4571 7561 6c28 6c65 6e28 7365  sertEqual(len(se
-00006690: 6c66 2e70 4244 422e 6361 7473 2e67 6574  lf.pBDB.cats.get
-000066a0: 416c 6c28 2929 2c20 3429 0a20 2020 2020  All()), 4).     
-000066b0: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-000066c0: 6c73 6528 7365 6c66 2e70 4244 422e 6375  lse(self.pBDB.cu
-000066d0: 7273 4578 6563 2822 5345 4c45 4354 202a  rsExec("SELECT *
-000066e0: 2066 726f 6d20 6361 7465 676f 7269 6573   from categories
-000066f0: 2077 6865 7265 2022 2929 0a20 2020 2020   where ")).     
-00006700: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00006710: 7561 6c28 6c65 6e28 7365 6c66 2e70 4244  ual(len(self.pBD
-00006720: 422e 6361 7473 2e67 6574 416c 6c28 2929  B.cats.getAll())
-00006730: 2c20 3429 0a20 2020 2020 2020 2073 656c  , 4).        sel
-00006740: 662e 6173 7365 7274 4661 6c73 6528 0a20  f.assertFalse(. 
-00006750: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006760: 7042 4442 2e63 6f6e 6e45 7865 6328 0a20  pBDB.connExec(. 
-00006770: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00006780: 2222 0a20 2020 2020 2020 2020 2020 2049  "".            I
-00006790: 4e53 4552 5420 696e 746f 2063 6174 6567  NSERT into categ
-000067a0: 6f72 6965 7320 286e 616d 652c 2064 6573  ories (name, des
-000067b0: 6372 6970 7469 6f6e 2c20 7061 7265 6e74  cription, parent
-000067c0: 4361 742c 2063 6f6d 6d65 6e74 732c 206f  Cat, comments, o
-000067d0: 7264 290a 2020 2020 2020 2020 2020 2020  rd).            
-000067e0: 2020 2020 7661 6c75 6573 2028 3a6e 616d      values (:nam
-000067f0: 652c 203a 6465 7363 7269 7074 696f 6e2c  e, :description,
-00006800: 203a 7061 7265 6e74 4361 742c 203a 636f   :parentCat, :co
-00006810: 6d6d 656e 7473 2c20 3a6f 7264 290a 2020  mments, :ord).  
-00006820: 2020 2020 2020 2020 2020 2222 222c 0a20            """,. 
-00006830: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00006840: 226e 616d 6522 3a20 2261 6263 6422 2c20  "name": "abcd", 
-00006850: 2264 6573 6372 6970 7469 6f6e 223a 2022  "description": "
-00006860: 6522 2c20 2270 6172 656e 7443 6174 223a  e", "parentCat":
-00006870: 2030 2c20 2263 6f6d 6d65 6e74 7322 3a20   0, "comments": 
-00006880: 2222 7d2c 0a20 2020 2020 2020 2020 2020  ""},.           
-00006890: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
-000068a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000068b0: 4571 7561 6c28 6c65 6e28 7365 6c66 2e70  Equal(len(self.p
-000068c0: 4244 422e 6361 7473 2e67 6574 416c 6c28  BDB.cats.getAll(
-000068d0: 2929 2c20 3429 0a20 2020 2020 2020 2073  )), 4).        s
-000068e0: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
-000068f0: 2841 7474 7269 6275 7465 4572 726f 722c  (AttributeError,
-00006900: 206c 616d 6264 613a 2073 656c 662e 7042   lambda: self.pB
-00006910: 4442 2e73 7461 7473 290a 2020 2020 2020  DB.stats).      
-00006920: 2020 6462 5374 6174 7328 7365 6c66 2e70    dbStats(self.p
-00006930: 4244 4229 0a20 2020 2020 2020 2073 656c  BDB).        sel
-00006940: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00006950: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006960: 7042 4442 2e73 7461 7473 2c0a 2020 2020  pBDB.stats,.    
-00006970: 2020 2020 2020 2020 7b22 6269 6273 223a          {"bibs":
-00006980: 2030 2c20 2263 6174 7322 3a20 342c 2022   0, "cats": 4, "
-00006990: 6578 7073 223a 2030 2c20 2263 6174 4269  exps": 0, "catBi
-000069a0: 6222 3a20 302c 2022 6361 7445 7870 223a  b": 0, "catExp":
-000069b0: 2030 2c20 2262 6962 4578 7022 3a20 307d   0, "bibExp": 0}
-000069c0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-000069d0: 2020 2020 7365 6c66 2e70 4244 422e 6361      self.pBDB.ca
-000069e0: 7473 2e64 656c 6574 6528 5b32 2c20 335d  ts.delete([2, 3]
-000069f0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00006a00: 7373 6572 7445 7175 616c 286c 656e 2873  ssertEqual(len(s
-00006a10: 656c 662e 7042 4442 2e63 6174 732e 6765  elf.pBDB.cats.ge
-00006a20: 7441 6c6c 2829 292c 2032 290a 2020 2020  tAll()), 2).    
-00006a30: 2020 2020 7365 6c66 2e70 4244 422e 636f      self.pBDB.co
-00006a40: 6d6d 6974 2829 0a0a 2020 2020 6465 6620  mmit()..    def 
-00006a50: 7465 7374 5f6c 6974 6572 616c 5f65 7661  test_literal_eva
-00006a60: 6c28 7365 6c66 2c20 2a61 7267 7329 3a0a  l(self, *args):.
-00006a70: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00006a80: 6c69 7465 7261 6c5f 6576 616c 2069 6e20  literal_eval in 
-00006a90: 5068 7973 4269 626c 696f 4442 5375 6222  PhysBiblioDBSub"
-00006aa0: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
-00006ab0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-00006ac0: 2e70 4244 422e 6361 7473 2e6c 6974 6572  .pBDB.cats.liter
-00006ad0: 616c 5f65 7661 6c28 225b 312c 325d 2229  al_eval("[1,2]")
-00006ae0: 2c20 5b31 2c20 325d 290a 2020 2020 2020  , [1, 2]).      
-00006af0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00006b00: 616c 2873 656c 662e 7042 4442 2e63 6174  al(self.pBDB.cat
-00006b10: 732e 6c69 7465 7261 6c5f 6576 616c 2822  s.literal_eval("
-00006b20: 5b27 7465 7374 272c 2761 275d 2229 2c20  ['test','a']"), 
-00006b30: 5b22 7465 7374 222c 2022 6122 5d29 0a20  ["test", "a"]). 
-00006b40: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00006b50: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00006b60: 422e 6361 7473 2e6c 6974 6572 616c 5f65  B.cats.literal_e
-00006b70: 7661 6c28 2227 7465 7374 2062 2722 292c  val("'test b'"),
-00006b80: 2022 2774 6573 7420 6227 2229 0a20 2020   "'test b'").   
-00006b90: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00006ba0: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-00006bb0: 6361 7473 2e6c 6974 6572 616c 5f65 7661  cats.literal_eva
-00006bc0: 6c28 2274 6573 7420 6322 292c 2022 7465  l("test c"), "te
-00006bd0: 7374 2063 2229 0a20 2020 2020 2020 2073  st c").        s
-00006be0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00006bf0: 7365 6c66 2e70 4244 422e 6361 7473 2e6c  self.pBDB.cats.l
-00006c00: 6974 6572 616c 5f65 7661 6c28 2722 7465  iteral_eval('"te
-00006c10: 7374 2064 2227 292c 2027 2274 6573 7420  st d"'), '"test 
-00006c20: 6422 2729 0a20 2020 2020 2020 2073 656c  d"').        sel
-00006c30: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-00006c40: 6c66 2e70 4244 422e 6361 7473 2e6c 6974  lf.pBDB.cats.lit
-00006c50: 6572 616c 5f65 7661 6c28 225b 7465 7374  eral_eval("[test
-00006c60: 2065 2229 2c20 225b 7465 7374 2065 2229   e"), "[test e")
-00006c70: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00006c80: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
-00006c90: 4244 422e 6361 7473 2e6c 6974 6572 616c  BDB.cats.literal
-00006ca0: 5f65 7661 6c28 225b 7465 7374 2066 5d22  _eval("[test f]"
-00006cb0: 292c 204e 6f6e 6529 0a20 2020 2020 2020  ), None).       
-00006cc0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00006cd0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-00006ce0: 656c 662e 7042 4442 2e63 6174 732e 6c69  elf.pBDB.cats.li
-00006cf0: 7465 7261 6c5f 6576 616c 2822 2774 6573  teral_eval("'tes
-00006d00: 7420 6727 2c27 7465 7374 2068 2722 292c  t g','test h'"),
-00006d10: 205b 2274 6573 7420 6722 2c20 2274 6573   ["test g", "tes
-00006d20: 7420 6822 5d0a 2020 2020 2020 2020 290a  t h"].        ).
-00006d30: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-00006d40: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-00006d50: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
-00006d60: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
-00006d70: 6c69 6f44 4243 6f72 652e 7365 6e64 4442  lioDBCore.sendDB
-00006d80: 4973 4c6f 636b 6564 222c 2061 7574 6f73  IsLocked", autos
-00006d90: 7065 633d 5472 7565 0a20 2020 2020 2020  pec=True.       
-00006da0: 2029 2061 7320 5f73 3a0a 2020 2020 2020   ) as _s:.      
-00006db0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00006dc0: 6361 7473 2e6d 6169 6e44 422e 7365 6e64  cats.mainDB.send
-00006dd0: 4442 4973 4c6f 636b 6564 2829 0a20 2020  DBIsLocked().   
-00006de0: 2020 2020 2020 2020 205f 732e 6173 7365           _s.asse
-00006df0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-00006e00: 6974 6828 7365 6c66 2e70 4244 422e 6361  ith(self.pBDB.ca
-00006e10: 7473 2e6d 6169 6e44 4229 0a0a 2020 2020  ts.mainDB)..    
-00006e20: 6465 6620 7465 7374 5f69 6e69 7428 7365  def test_init(se
-00006e30: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
-00006e40: 2020 2020 2222 2274 6573 7420 696e 6974      """test init
-00006e50: 2222 220a 2020 2020 2020 2020 7769 7468  """.        with
-00006e60: 2070 6174 6368 2822 6f73 2e70 6174 682e   patch("os.path.
-00006e70: 6578 6973 7473 222c 2072 6574 7572 6e5f  exists", return_
-00006e80: 7661 6c75 653d 5472 7565 2920 6173 205f  value=True) as _
-00006e90: 652c 2070 6174 6368 280a 2020 2020 2020  e, patch(.      
-00006ea0: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-00006eb0: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
-00006ec0: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
-00006ed0: 6c6f 6164 5375 6243 6c61 7373 6573 222c  loadSubClasses",
-00006ee0: 2061 7574 6f73 7065 633d 5472 7565 0a20   autospec=True. 
-00006ef0: 2020 2020 2020 2029 2061 7320 5f6c 7363         ) as _lsc
-00006f00: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-00006f10: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-00006f20: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
-00006f30: 7973 4269 626c 696f 4442 436f 7265 2e6f  ysBiblioDBCore.o
-00006f40: 7065 6e44 4222 2c20 6175 746f 7370 6563  penDB", autospec
-00006f50: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
-00006f60: 6173 205f 6f3a 0a20 2020 2020 2020 2020  as _o:.         
-00006f70: 2020 2064 6263 203d 2050 6879 7342 6962     dbc = PhysBib
-00006f80: 6c69 6f44 4243 6f72 6528 7465 6d70 4442  lioDBCore(tempDB
-00006f90: 4e61 6d65 2c20 7042 4c6f 6767 6572 2c20  Name, pBLogger, 
-00006fa0: 6e6f 4f70 656e 3d54 7275 652c 2069 6e66  noOpen=True, inf
-00006fb0: 6f3d 4661 6c73 6529 0a20 2020 2020 2020  o=False).       
-00006fc0: 2020 2020 205f 652e 6173 7365 7274 5f63       _e.assert_c
-00006fd0: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00006fe0: 7465 6d70 4442 4e61 6d65 290a 2020 2020  tempDBName).    
-00006ff0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00007000: 6572 7445 7175 616c 285f 6f2e 6361 6c6c  ertEqual(_o.call
-00007010: 5f63 6f75 6e74 2c20 3029 0a20 2020 2020  _count, 0).     
-00007020: 2020 2020 2020 205f 6c73 632e 6173 7365         _lsc.asse
-00007030: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-00007040: 6974 6828 6462 6329 0a20 2020 2020 2020  ith(dbc).       
-00007050: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00007060: 6c28 6462 632e 7461 626c 6546 6965 6c64  l(dbc.tableField
-00007070: 732c 2070 6879 7362 6962 6c69 6f2e 7461  s, physbiblio.ta
-00007080: 626c 6573 4465 662e 7461 626c 6546 6965  blesDef.tableFie
-00007090: 6c64 7329 0a20 2020 2020 2020 2073 656c  lds).        sel
-000070a0: 662e 6173 7365 7274 4571 7561 6c28 6462  f.assertEqual(db
-000070b0: 632e 6465 7363 7269 7074 696f 6e73 2c20  c.descriptions, 
-000070c0: 7068 7973 6269 626c 696f 2e74 6162 6c65  physbiblio.table
-000070d0: 7344 6566 2e66 6965 6c64 7344 6573 6372  sDef.fieldsDescr
-000070e0: 6970 7469 6f6e 7329 0a20 2020 2020 2020  iptions).       
-000070f0: 2073 656c 662e 6173 7365 7274 4973 496e   self.assertIsIn
-00007100: 7374 616e 6365 2864 6263 2e74 6162 6c65  stance(dbc.table
-00007110: 436f 6c73 2c20 6469 6374 290a 2020 2020  Cols, dict).    
-00007120: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00007130: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00007140: 2020 6462 632e 7461 626c 6543 6f6c 732c    dbc.tableCols,
-00007150: 0a20 2020 2020 2020 2020 2020 207b 713a  .            {q:
-00007160: 205b 615b 305d 2066 6f72 2061 2069 6e20   [a[0] for a in 
-00007170: 6462 632e 7461 626c 6546 6965 6c64 735b  dbc.tableFields[
-00007180: 715d 5d20 666f 7220 7120 696e 2064 6263  q]] for q in dbc
-00007190: 2e74 6162 6c65 4669 656c 6473 2e6b 6579  .tableFields.key
-000071a0: 7328 297d 2c0a 2020 2020 2020 2020 290a  s()},.        ).
-000071b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000071c0: 6572 7445 7175 616c 2864 6263 2e64 6243  ertEqual(dbc.dbC
-000071d0: 6861 6e67 6564 2c20 4661 6c73 6529 0a20  hanged, False). 
-000071e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000071f0: 7274 4571 7561 6c28 6462 632e 636f 6e6e  rtEqual(dbc.conn
-00007200: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00007210: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00007220: 2864 6263 2e63 7572 732c 204e 6f6e 6529  (dbc.curs, None)
-00007230: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00007240: 7365 7274 4571 7561 6c28 6462 632e 6f6e  sertEqual(dbc.on
-00007250: 4973 4c6f 636b 6564 2c20 4e6f 6e65 290a  IsLocked, None).
-00007260: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00007270: 6572 7445 7175 616c 2864 6263 2e64 626e  ertEqual(dbc.dbn
-00007280: 616d 652c 2074 656d 7044 424e 616d 6529  ame, tempDBName)
-00007290: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000072a0: 7365 7274 4571 7561 6c28 6462 632e 6c6f  sertEqual(dbc.lo
-000072b0: 6767 6572 2c20 7042 4c6f 6767 6572 290a  gger, pBLogger).
-000072c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000072d0: 6572 7445 7175 616c 2864 6263 2e6c 6173  ertEqual(dbc.las
-000072e0: 7446 6574 6368 6564 2c20 4e6f 6e65 290a  tFetched, None).
-000072f0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00007300: 6572 7445 7175 616c 2864 6263 2e63 6174  ertEqual(dbc.cat
-00007310: 7348 6965 722c 204e 6f6e 6529 0a0a 2020  sHier, None)..  
-00007320: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00007330: 2822 6f73 2e70 6174 682e 6578 6973 7473  ("os.path.exists
-00007340: 222c 2072 6574 7572 6e5f 7661 6c75 653d  ", return_value=
-00007350: 5472 7565 2920 6173 205f 652c 2070 6174  True) as _e, pat
-00007360: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-00007370: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-00007380: 696e 666f 220a 2020 2020 2020 2020 2920  info".        ) 
-00007390: 6173 205f 692c 2070 6174 6368 280a 2020  as _i, patch(.  
-000073a0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-000073b0: 6962 6c69 6f2e 6461 7461 6261 7365 436f  iblio.databaseCo
-000073c0: 7265 2e50 6879 7342 6962 6c69 6f44 4243  re.PhysBiblioDBC
-000073d0: 6f72 652e 6368 6563 6b45 7869 7374 696e  ore.checkExistin
-000073e0: 6754 6162 6c65 7322 2c0a 2020 2020 2020  gTables",.      
-000073f0: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
-00007400: 7565 3d54 7275 652c 0a20 2020 2020 2020  ue=True,.       
-00007410: 2020 2020 2061 7574 6f73 7065 633d 5472       autospec=Tr
-00007420: 7565 2c0a 2020 2020 2020 2020 2920 6173  ue,.        ) as
-00007430: 205f 6365 2c20 7061 7463 6828 0a20 2020   _ce, patch(.   
-00007440: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
-00007450: 626c 696f 2e64 6174 6162 6173 6543 6f72  blio.databaseCor
-00007460: 652e 5068 7973 4269 626c 696f 4442 436f  e.PhysBiblioDBCo
-00007470: 7265 2e63 7265 6174 6554 6162 6c65 7322  re.createTables"
-00007480: 2c20 6175 746f 7370 6563 3d54 7275 650a  , autospec=True.
-00007490: 2020 2020 2020 2020 2920 6173 205f 6374          ) as _ct
-000074a0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-000074b0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-000074c0: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
-000074d0: 7973 4269 626c 696f 4442 436f 7265 2e63  ysBiblioDBCore.c
-000074e0: 6865 636b 4461 7461 6261 7365 5570 6461  heckDatabaseUpda
-000074f0: 7465 7322 2c0a 2020 2020 2020 2020 2020  tes",.          
-00007500: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
-00007510: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
-00007520: 632c 2070 6174 6368 280a 2020 2020 2020  c, patch(.      
-00007530: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-00007540: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
-00007550: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
-00007560: 6c6f 6164 5375 6243 6c61 7373 6573 222c  loadSubClasses",
-00007570: 2061 7574 6f73 7065 633d 5472 7565 0a20   autospec=True. 
-00007580: 2020 2020 2020 2029 2061 7320 5f6c 7363         ) as _lsc
-00007590: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-000075a0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-000075b0: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
-000075c0: 7973 4269 626c 696f 4442 436f 7265 2e6f  ysBiblioDBCore.o
-000075d0: 7065 6e44 4222 2c20 6175 746f 7370 6563  penDB", autospec
-000075e0: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
-000075f0: 6173 205f 6f3a 0a20 2020 2020 2020 2020  as _o:.         
-00007600: 2020 2064 6263 203d 2050 6879 7342 6962     dbc = PhysBib
-00007610: 6c69 6f44 4243 6f72 6528 7465 6d70 4442  lioDBCore(tempDB
-00007620: 4e61 6d65 2c20 7042 4c6f 6767 6572 2c20  Name, pBLogger, 
-00007630: 6e6f 4f70 656e 3d54 7275 652c 2069 6e66  noOpen=True, inf
-00007640: 6f3d 4661 6c73 6529 0a20 2020 2020 2020  o=False).       
-00007650: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00007660: 4571 7561 6c28 5f6f 2e63 616c 6c5f 636f  Equal(_o.call_co
-00007670: 756e 742c 2030 290a 2020 2020 2020 2020  unt, 0).        
-00007680: 2020 2020 5f69 2e61 7373 6572 745f 6e6f      _i.assert_no
-00007690: 745f 6361 6c6c 6564 2829 0a20 2020 2020  t_called().     
-000076a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000076b0: 7274 4571 7561 6c28 5f63 742e 6361 6c6c  rtEqual(_ct.call
-000076c0: 5f63 6f75 6e74 2c20 3029 0a20 2020 2020  _count, 0).     
-000076d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000076e0: 7274 4571 7561 6c28 5f63 652e 6361 6c6c  rtEqual(_ce.call
-000076f0: 5f63 6f75 6e74 2c20 3029 0a20 2020 2020  _count, 0).     
-00007700: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00007710: 7274 4571 7561 6c28 5f63 632e 6361 6c6c  rtEqual(_cc.call
-00007720: 5f63 6f75 6e74 2c20 3029 0a20 2020 2020  _count, 0).     
-00007730: 2020 2020 2020 2064 6263 203d 2050 6879         dbc = Phy
-00007740: 7342 6962 6c69 6f44 4243 6f72 6528 7465  sBiblioDBCore(te
-00007750: 6d70 4442 4e61 6d65 2c20 7042 4c6f 6767  mpDBName, pBLogg
-00007760: 6572 2c20 696e 666f 3d46 616c 7365 290a  er, info=False).
-00007770: 2020 2020 2020 2020 2020 2020 5f6f 2e61              _o.a
-00007780: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00007790: 655f 7769 7468 2864 6263 2c20 696e 666f  e_with(dbc, info
-000077a0: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-000077b0: 2020 2020 5f69 2e61 7373 6572 745f 6361      _i.assert_ca
-000077c0: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
-000077d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077e0: 222d 2d2d 2d2d 2d2d 4e65 7720 6461 7461  "-------New data
-000077f0: 6261 7365 206f 7220 6d69 7373 696e 6720  base or missing 
-00007800: 7461 626c 6573 2e5c 6e43 7265 6174 696e  tables.\nCreatin
-00007810: 6720 7468 656d 215c 6e5c 6e22 0a20 2020  g them!\n\n".   
-00007820: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00007830: 2020 2020 2020 205f 6374 2e61 7373 6572         _ct.asser
-00007840: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-00007850: 7468 2864 6263 290a 2020 2020 2020 2020  th(dbc).        
-00007860: 2020 2020 5f63 652e 6173 7365 7274 5f63      _ce.assert_c
-00007870: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00007880: 6462 6329 0a20 2020 2020 2020 2020 2020  dbc).           
-00007890: 205f 6363 2e61 7373 6572 745f 6361 6c6c   _cc.assert_call
-000078a0: 6564 5f6f 6e63 655f 7769 7468 2864 6263  ed_once_with(dbc
-000078b0: 290a 0a20 2020 2020 2020 2077 6974 6820  )..        with 
-000078c0: 7061 7463 6828 226f 732e 7061 7468 2e65  patch("os.path.e
-000078d0: 7869 7374 7322 2c20 7265 7475 726e 5f76  xists", return_v
-000078e0: 616c 7565 3d54 7275 6529 2061 7320 5f65  alue=True) as _e
-000078f0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-00007900: 2020 2020 2022 6c6f 6767 696e 672e 4c6f       "logging.Lo
-00007910: 6767 6572 2e69 6e66 6f22 0a20 2020 2020  gger.info".     
-00007920: 2020 2029 2061 7320 5f69 2c20 7061 7463     ) as _i, patc
-00007930: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-00007940: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-00007950: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
-00007960: 696f 4442 436f 7265 2e63 6865 636b 4578  ioDBCore.checkEx
-00007970: 6973 7469 6e67 5461 626c 6573 222c 0a20  istingTables",. 
-00007980: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00007990: 6e5f 7661 6c75 653d 4661 6c73 652c 0a20  n_value=False,. 
-000079a0: 2020 2020 2020 2020 2020 2061 7574 6f73             autos
-000079b0: 7065 633d 5472 7565 2c0a 2020 2020 2020  pec=True,.      
-000079c0: 2020 2920 6173 205f 6365 2c20 7061 7463    ) as _ce, patc
-000079d0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-000079e0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-000079f0: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
-00007a00: 696f 4442 436f 7265 2e63 7265 6174 6554  ioDBCore.createT
-00007a10: 6162 6c65 7322 2c20 6175 746f 7370 6563  ables", autospec
-00007a20: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
-00007a30: 6173 205f 6374 2c20 7061 7463 6828 0a20  as _ct, patch(. 
-00007a40: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
-00007a50: 6269 626c 696f 2e64 6174 6162 6173 6543  biblio.databaseC
-00007a60: 6f72 652e 5068 7973 4269 626c 696f 4442  ore.PhysBiblioDB
-00007a70: 436f 7265 2e63 6865 636b 4461 7461 6261  Core.checkDataba
-00007a80: 7365 5570 6461 7465 7322 2c0a 2020 2020  seUpdates",.    
-00007a90: 2020 2020 2020 2020 6175 746f 7370 6563          autospec
-00007aa0: 3d54 7275 652c 0a20 2020 2020 2020 2029  =True,.        )
-00007ab0: 2061 7320 5f63 632c 2070 6174 6368 280a   as _cc, patch(.
-00007ac0: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
-00007ad0: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
-00007ae0: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
-00007af0: 4243 6f72 652e 6c6f 6164 5375 6243 6c61  BCore.loadSubCla
-00007b00: 7373 6573 222c 2061 7574 6f73 7065 633d  sses", autospec=
-00007b10: 5472 7565 0a20 2020 2020 2020 2029 2061  True.        ) a
-00007b20: 7320 5f6c 7363 2c20 7061 7463 6828 0a20  s _lsc, patch(. 
-00007b30: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
-00007b40: 6269 626c 696f 2e64 6174 6162 6173 6543  biblio.databaseC
-00007b50: 6f72 652e 5068 7973 4269 626c 696f 4442  ore.PhysBiblioDB
-00007b60: 436f 7265 2e6f 7065 6e44 4222 2c20 6175  Core.openDB", au
-00007b70: 746f 7370 6563 3d54 7275 650a 2020 2020  tospec=True.    
-00007b80: 2020 2020 2920 6173 205f 6f3a 0a20 2020      ) as _o:.   
-00007b90: 2020 2020 2020 2020 2064 6263 203d 2050           dbc = P
-00007ba0: 6879 7342 6962 6c69 6f44 4243 6f72 6528  hysBiblioDBCore(
-00007bb0: 7465 6d70 4442 4e61 6d65 2c20 7042 4c6f  tempDBName, pBLo
-00007bc0: 6767 6572 290a 2020 2020 2020 2020 2020  gger).          
-00007bd0: 2020 5f6f 2e61 7373 6572 745f 6361 6c6c    _o.assert_call
-00007be0: 6564 5f6f 6e63 655f 7769 7468 2864 6263  ed_once_with(dbc
-00007bf0: 2c20 696e 666f 3d54 7275 6529 0a20 2020  , info=True).   
-00007c00: 2020 2020 2020 2020 205f 692e 6173 7365           _i.asse
-00007c10: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-00007c20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00007c30: 2e61 7373 6572 7445 7175 616c 285f 6374  .assertEqual(_ct
-00007c40: 2e63 616c 6c5f 636f 756e 742c 2030 290a  .call_count, 0).
-00007c50: 2020 2020 2020 2020 2020 2020 5f63 652e              _ce.
-00007c60: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00007c70: 6365 5f77 6974 6828 6462 6329 0a20 2020  ce_with(dbc).   
-00007c80: 2020 2020 2020 2020 205f 6363 2e61 7373           _cc.ass
-00007c90: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-00007ca0: 7769 7468 2864 6263 290a 0a20 2020 2020  with(dbc)..     
-00007cb0: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-00007cc0: 7565 2868 6173 6174 7472 2864 6263 2c20  ue(hasattr(dbc, 
-00007cd0: 2272 654f 7065 6e44 4222 2929 0a20 2020  "reOpenDB")).   
-00007ce0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00007cf0: 5472 7565 2868 6173 6174 7472 2864 6263  True(hasattr(dbc
-00007d00: 2c20 226c 6f61 6453 7562 436c 6173 7365  , "loadSubClasse
-00007d10: 7322 2929 0a0a 2020 2020 6465 6620 7465  s"))..    def te
-00007d20: 7374 5f6f 7065 6e44 4228 7365 6c66 2c20  st_openDB(self, 
-00007d30: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
-00007d40: 2222 2274 6573 7420 6f70 656e 4442 2222  """test openDB""
-00007d50: 220a 2020 2020 2020 2020 7769 7468 2070  ".        with p
-00007d60: 6174 6368 2822 6f73 2e70 6174 682e 6578  atch("os.path.ex
-00007d70: 6973 7473 222c 2072 6574 7572 6e5f 7661  ists", return_va
-00007d80: 6c75 653d 5472 7565 2920 6173 205f 652c  lue=True) as _e,
-00007d90: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-00007da0: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-00007db0: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
-00007dc0: 7342 6962 6c69 6f44 4243 6f72 652e 6c6f  sBiblioDBCore.lo
-00007dd0: 6164 5375 6243 6c61 7373 6573 222c 2061  adSubClasses", a
-00007de0: 7574 6f73 7065 633d 5472 7565 0a20 2020  utospec=True.   
-00007df0: 2020 2020 2029 2061 7320 5f6c 7363 3a0a       ) as _lsc:.
-00007e00: 2020 2020 2020 2020 2020 2020 6462 6320              dbc 
-00007e10: 3d20 5068 7973 4269 626c 696f 4442 436f  = PhysBiblioDBCo
-00007e20: 7265 2874 656d 7044 424e 616d 652c 2070  re(tempDBName, p
-00007e30: 424c 6f67 6765 722c 206e 6f4f 7065 6e3d  BLogger, noOpen=
-00007e40: 5472 7565 290a 2020 2020 2020 2020 7365  True).        se
-00007e50: 6c66 2e61 7373 6572 7445 7175 616c 2864  lf.assertEqual(d
-00007e60: 6263 2e63 6f6e 6e2c 204e 6f6e 6529 0a20  bc.conn, None). 
-00007e70: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-00007e80: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
-00007e90: 722e 696e 666f 2229 2061 7320 5f69 2c20  r.info") as _i, 
-00007ea0: 7061 7463 6828 2273 716c 6974 6533 2e63  patch("sqlite3.c
-00007eb0: 6f6e 6e65 6374 2229 2061 7320 5f63 2c20  onnect") as _c, 
-00007ec0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-00007ed0: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
-00007ee0: 6174 6162 6173 6543 6f72 652e 5068 7973  atabaseCore.Phys
-00007ef0: 4269 626c 696f 4442 436f 7265 2e6c 6f61  BiblioDBCore.loa
-00007f00: 6453 7562 436c 6173 7365 7322 2c20 6175  dSubClasses", au
-00007f10: 746f 7370 6563 3d54 7275 650a 2020 2020  tospec=True.    
-00007f20: 2020 2020 2920 6173 205f 6c73 633a 0a20      ) as _lsc:. 
-00007f30: 2020 2020 2020 2020 2020 2064 6263 2e6f             dbc.o
-00007f40: 7065 6e44 4228 290a 2020 2020 2020 2020  penDB().        
-00007f50: 2020 2020 5f69 2e61 7373 6572 745f 6361      _i.assert_ca
-00007f60: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
-00007f70: 4f70 656e 696e 6720 6461 7461 6261 7365  Opening database
-00007f80: 3a20 2573 2220 2520 7465 6d70 4442 4e61  : %s" % tempDBNa
-00007f90: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
-00007fa0: 5f63 2e61 7373 6572 745f 6361 6c6c 6564  _c.assert_called
-00007fb0: 5f6f 6e63 655f 7769 7468 2874 656d 7044  _once_with(tempD
-00007fc0: 424e 616d 652c 2063 6865 636b 5f73 616d  BName, check_sam
-00007fd0: 655f 7468 7265 6164 3d46 616c 7365 290a  e_thread=False).
-00007fe0: 2020 2020 2020 2020 2020 2020 5f63 2829              _c()
-00007ff0: 2e63 7572 736f 722e 6173 7365 7274 5f63  .cursor.assert_c
-00008000: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00008010: 290a 2020 2020 2020 2020 2020 2020 5f6c  ).            _l
-00008020: 7363 2e61 7373 6572 745f 6361 6c6c 6564  sc.assert_called
-00008030: 5f6f 6e63 655f 7769 7468 2864 6263 290a  _once_with(dbc).
-00008040: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00008050: 2e61 7373 6572 7445 7175 616c 2864 6263  .assertEqual(dbc
-00008060: 2e63 6f6e 6e2c 205f 6328 2929 0a20 2020  .conn, _c()).   
-00008070: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00008080: 7365 7274 4571 7561 6c28 6462 632e 636f  sertEqual(dbc.co
-00008090: 6e6e 2e72 6f77 5f66 6163 746f 7279 2c20  nn.row_factory, 
-000080a0: 7371 6c69 7465 332e 526f 7729 0a20 2020  sqlite3.Row).   
-000080b0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-000080c0: 7365 7274 4571 7561 6c28 6462 632e 6375  sertEqual(dbc.cu
-000080d0: 7273 2c20 5f63 2829 2e63 7572 736f 7228  rs, _c().cursor(
-000080e0: 2929 0a20 2020 2020 2020 2077 6974 6820  )).        with 
-000080f0: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-00008100: 6f67 6765 722e 6465 6275 6722 2920 6173  ogger.debug") as
-00008110: 205f 642c 2070 6174 6368 2822 7371 6c69   _d, patch("sqli
-00008120: 7465 332e 636f 6e6e 6563 7422 2920 6173  te3.connect") as
-00008130: 205f 632c 2070 6174 6368 280a 2020 2020   _c, patch(.    
-00008140: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-00008150: 6c69 6f2e 6461 7461 6261 7365 436f 7265  lio.databaseCore
-00008160: 2e50 6879 7342 6962 6c69 6f44 4243 6f72  .PhysBiblioDBCor
-00008170: 652e 6c6f 6164 5375 6243 6c61 7373 6573  e.loadSubClasses
-00008180: 222c 2061 7574 6f73 7065 633d 5472 7565  ", autospec=True
-00008190: 0a20 2020 2020 2020 2029 2061 7320 5f6c  .        ) as _l
-000081a0: 7363 3a0a 2020 2020 2020 2020 2020 2020  sc:.            
-000081b0: 6462 632e 6f70 656e 4442 2869 6e66 6f3d  dbc.openDB(info=
-000081c0: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
-000081d0: 2020 205f 642e 6173 7365 7274 5f63 616c     _d.assert_cal
-000081e0: 6c65 645f 6f6e 6365 5f77 6974 6828 224f  led_once_with("O
-000081f0: 7065 6e69 6e67 2064 6174 6162 6173 653a  pening database:
-00008200: 2025 7322 2025 2074 656d 7044 424e 616d   %s" % tempDBNam
-00008210: 6529 0a20 2020 2020 2020 2020 2020 205f  e).            _
-00008220: 632e 6173 7365 7274 5f63 616c 6c65 645f  c.assert_called_
-00008230: 6f6e 6365 5f77 6974 6828 7465 6d70 4442  once_with(tempDB
-00008240: 4e61 6d65 2c20 6368 6563 6b5f 7361 6d65  Name, check_same
-00008250: 5f74 6872 6561 643d 4661 6c73 6529 0a20  _thread=False). 
-00008260: 2020 2020 2020 2020 2020 205f 6328 292e             _c().
-00008270: 6375 7273 6f72 2e61 7373 6572 745f 6361  cursor.assert_ca
-00008280: 6c6c 6564 5f6f 6e63 655f 7769 7468 2829  lled_once_with()
-00008290: 0a20 2020 2020 2020 2020 2020 205f 6c73  .            _ls
-000082a0: 632e 6173 7365 7274 5f63 616c 6c65 645f  c.assert_called_
-000082b0: 6f6e 6365 5f77 6974 6828 6462 6329 0a20  once_with(dbc). 
-000082c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000082d0: 6173 7365 7274 4571 7561 6c28 6462 632e  assertEqual(dbc.
-000082e0: 636f 6e6e 2c20 5f63 2829 290a 2020 2020  conn, _c()).    
-000082f0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00008300: 6572 7445 7175 616c 2864 6263 2e63 6f6e  ertEqual(dbc.con
-00008310: 6e2e 726f 775f 6661 6374 6f72 792c 2073  n.row_factory, s
-00008320: 716c 6974 6533 2e52 6f77 290a 2020 2020  qlite3.Row).    
-00008330: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00008340: 6572 7445 7175 616c 2864 6263 2e63 7572  ertEqual(dbc.cur
-00008350: 732c 205f 6328 292e 6375 7273 6f72 2829  s, _c().cursor()
-00008360: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00008370: 636c 6f73 6544 4228 7365 6c66 2c20 2a61  closeDB(self, *a
-00008380: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-00008390: 2274 6573 7420 636c 6f73 6544 4222 2222  "test closeDB"""
-000083a0: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-000083b0: 7463 6828 226f 732e 7061 7468 2e65 7869  tch("os.path.exi
-000083c0: 7374 7322 2c20 7265 7475 726e 5f76 616c  sts", return_val
-000083d0: 7565 3d54 7275 6529 2061 7320 5f65 2c20  ue=True) as _e, 
-000083e0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-000083f0: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
-00008400: 6174 6162 6173 6543 6f72 652e 5068 7973  atabaseCore.Phys
-00008410: 4269 626c 696f 4442 436f 7265 2e6c 6f61  BiblioDBCore.loa
-00008420: 6453 7562 436c 6173 7365 7322 2c20 6175  dSubClasses", au
-00008430: 746f 7370 6563 3d54 7275 650a 2020 2020  tospec=True.    
-00008440: 2020 2020 2920 6173 205f 6c73 633a 0a20      ) as _lsc:. 
-00008450: 2020 2020 2020 2020 2020 2064 6263 203d             dbc =
-00008460: 2050 6879 7342 6962 6c69 6f44 4243 6f72   PhysBiblioDBCor
-00008470: 6528 7465 6d70 4442 4e61 6d65 2c20 7042  e(tempDBName, pB
-00008480: 4c6f 6767 6572 2c20 6e6f 4f70 656e 3d54  Logger, noOpen=T
-00008490: 7275 6529 0a20 2020 2020 2020 2064 6263  rue).        dbc
-000084a0: 2e63 6f6e 6e20 3d20 4d61 6769 634d 6f63  .conn = MagicMoc
-000084b0: 6b28 290a 2020 2020 2020 2020 7769 7468  k().        with
-000084c0: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
-000084d0: 4c6f 6767 6572 2e69 6e66 6f22 2920 6173  Logger.info") as
-000084e0: 205f 693a 0a20 2020 2020 2020 2020 2020   _i:.           
-000084f0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00008500: 2864 6263 2e63 6c6f 7365 4442 2829 290a  (dbc.closeDB()).
-00008510: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
-00008520: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00008530: 655f 7769 7468 2822 436c 6f73 696e 6720  e_with("Closing 
-00008540: 6461 7461 6261 7365 2e2e 2e22 290a 2020  database...").  
-00008550: 2020 2020 2020 2020 2020 6462 632e 636f            dbc.co
-00008560: 6e6e 2e63 6c6f 7365 2e61 7373 6572 745f  nn.close.assert_
-00008570: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-00008580: 2829 0a20 2020 2020 2020 2064 6263 2e63  ().        dbc.c
-00008590: 6f6e 6e2e 7265 7365 745f 6d6f 636b 2829  onn.reset_mock()
-000085a0: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-000085b0: 7463 6828 226c 6f67 6769 6e67 2e4c 6f67  tch("logging.Log
-000085c0: 6765 722e 6465 6275 6722 2920 6173 205f  ger.debug") as _
-000085d0: 643a 0a20 2020 2020 2020 2020 2020 2073  d:.            s
-000085e0: 656c 662e 6173 7365 7274 5472 7565 2864  elf.assertTrue(d
-000085f0: 6263 2e63 6c6f 7365 4442 2869 6e66 6f3d  bc.closeDB(info=
-00008600: 4661 6c73 6529 290a 2020 2020 2020 2020  False)).        
-00008610: 2020 2020 5f64 2e61 7373 6572 745f 6361      _d.assert_ca
-00008620: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
-00008630: 436c 6f73 696e 6720 6461 7461 6261 7365  Closing database
-00008640: 2e2e 2e22 290a 2020 2020 2020 2020 2020  ...").          
-00008650: 2020 6462 632e 636f 6e6e 2e63 6c6f 7365    dbc.conn.close
-00008660: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-00008670: 6e63 655f 7769 7468 2829 0a0a 2020 2020  nce_with()..    
-00008680: 6465 6620 7465 7374 5f73 656e 6444 4249  def test_sendDBI
-00008690: 734c 6f63 6b65 6428 7365 6c66 2c20 2a61  sLocked(self, *a
-000086a0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-000086b0: 2274 6573 7420 7468 6520 7365 6e64 4442  "test the sendDB
-000086c0: 4973 4c6f 636b 6564 2066 756e 6374 696f  IsLocked functio
-000086d0: 6e22 2222 0a20 2020 2020 2020 2073 656c  n""".        sel
-000086e0: 662e 6173 7365 7274 5472 7565 2868 6173  f.assertTrue(has
-000086f0: 6174 7472 2873 656c 662e 7042 4442 2c20  attr(self.pBDB, 
-00008700: 226f 6e49 734c 6f63 6b65 6422 2929 0a20  "onIsLocked")). 
-00008710: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00008720: 2e6f 6e49 734c 6f63 6b65 6420 3d20 4e6f  .onIsLocked = No
-00008730: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-00008740: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
-00008750: 2e70 4244 422e 7365 6e64 4442 4973 4c6f  .pBDB.sendDBIsLo
-00008760: 636b 6564 2829 290a 2020 2020 2020 2020  cked()).        
-00008770: 7365 6c66 2e70 4244 422e 6f6e 4973 4c6f  self.pBDB.onIsLo
-00008780: 636b 6564 203d 2031 3233 0a20 2020 2020  cked = 123.     
-00008790: 2020 2077 6974 6820 7061 7463 6828 226c     with patch("l
-000087a0: 6f67 6769 6e67 2e4c 6f67 6765 722e 6578  ogging.Logger.ex
-000087b0: 6365 7074 696f 6e22 2920 6173 205f 6578  ception") as _ex
-000087c0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000087d0: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
-000087e0: 656c 662e 7042 4442 2e73 656e 6444 4249  elf.pBDB.sendDBI
-000087f0: 734c 6f63 6b65 6428 2929 0a20 2020 2020  sLocked()).     
-00008800: 2020 2020 2020 205f 6578 2e61 7373 6572         _ex.asser
-00008810: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-00008820: 7468 2822 496e 7661 6c69 6420 6073 656c  th("Invalid `sel
-00008830: 662e 6f6e 4973 4c6f 636b 6564 6021 2229  f.onIsLocked`!")
-00008840: 0a20 2020 2020 2020 2074 6d70 203d 204d  .        tmp = M
-00008850: 6167 6963 4d6f 636b 2829 0a20 2020 2020  agicMock().     
-00008860: 2020 2074 6d70 2e65 6d69 7420 3d20 4d61     tmp.emit = Ma
-00008870: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
-00008880: 2020 7365 6c66 2e70 4244 422e 6f6e 4973    self.pBDB.onIs
-00008890: 4c6f 636b 6564 203d 2074 6d70 0a20 2020  Locked = tmp.   
-000088a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000088b0: 5472 7565 2873 656c 662e 7042 4442 2e73  True(self.pBDB.s
-000088c0: 656e 6444 4249 734c 6f63 6b65 6428 2929  endDBIsLocked())
-000088d0: 0a20 2020 2020 2020 2074 6d70 2e65 6d69  .        tmp.emi
-000088e0: 742e 6173 7365 7274 5f63 616c 6c65 645f  t.assert_called_
-000088f0: 6f6e 6365 5f77 6974 6828 290a 0a20 2020  once_with()..   
-00008900: 2064 6566 2074 6573 745f 6368 6563 6b55   def test_checkU
-00008910: 6e63 6f6d 6d69 7474 6564 2873 656c 662c  ncommitted(self,
-00008920: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-00008930: 2022 2222 7465 7374 2063 6865 636b 556e   """test checkUn
-00008940: 636f 6d6d 6974 7465 6422 2222 0a20 2020  committed""".   
-00008950: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-00008960: 226f 732e 7061 7468 2e65 7869 7374 7322  "os.path.exists"
-00008970: 2c20 7265 7475 726e 5f76 616c 7565 3d54  , return_value=T
-00008980: 7275 6529 2061 7320 5f65 2c20 7061 7463  rue) as _e, patc
-00008990: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-000089a0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-000089b0: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
-000089c0: 696f 4442 436f 7265 2e6c 6f61 6453 7562  ioDBCore.loadSub
-000089d0: 436c 6173 7365 7322 2c20 6175 746f 7370  Classes", autosp
-000089e0: 6563 3d54 7275 650a 2020 2020 2020 2020  ec=True.        
-000089f0: 2920 6173 205f 6c73 633a 0a20 2020 2020  ) as _lsc:.     
-00008a00: 2020 2020 2020 2064 6263 203d 2050 6879         dbc = Phy
-00008a10: 7342 6962 6c69 6f44 4243 6f72 6528 7465  sBiblioDBCore(te
-00008a20: 6d70 4442 4e61 6d65 2c20 7042 4c6f 6767  mpDBName, pBLogg
-00008a30: 6572 2c20 6e6f 4f70 656e 3d54 7275 6529  er, noOpen=True)
-00008a40: 0a20 2020 2020 2020 2064 6263 2e63 6f6e  .        dbc.con
-00008a50: 6e20 3d20 4d61 6769 634d 6f63 6b28 290a  n = MagicMock().
-00008a60: 2020 2020 2020 2020 6462 632e 636f 6e6e          dbc.conn
-00008a70: 2e69 6e5f 7472 616e 7361 6374 696f 6e20  .in_transaction 
-00008a80: 3d20 2261 6263 220a 2020 2020 2020 2020  = "abc".        
-00008a90: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00008aa0: 2864 6263 2e63 6865 636b 556e 636f 6d6d  (dbc.checkUncomm
-00008ab0: 6974 7465 6428 292c 2022 6162 6322 290a  itted(), "abc").
-00008ac0: 0a20 2020 2064 6566 2074 6573 745f 636f  .    def test_co
-00008ad0: 6d6d 6974 2873 656c 662c 202a 6172 6773  mmit(self, *args
-00008ae0: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
-00008af0: 7374 2063 6f6d 6d69 7422 2222 0a20 2020  st commit""".   
-00008b00: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-00008b10: 226f 732e 7061 7468 2e65 7869 7374 7322  "os.path.exists"
-00008b20: 2c20 7265 7475 726e 5f76 616c 7565 3d54  , return_value=T
-00008b30: 7275 6529 2061 7320 5f65 2c20 7061 7463  rue) as _e, patc
-00008b40: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-00008b50: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-00008b60: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
-00008b70: 696f 4442 436f 7265 2e6c 6f61 6453 7562  ioDBCore.loadSub
-00008b80: 436c 6173 7365 7322 2c20 6175 746f 7370  Classes", autosp
-00008b90: 6563 3d54 7275 650a 2020 2020 2020 2020  ec=True.        
-00008ba0: 2920 6173 205f 6c73 633a 0a20 2020 2020  ) as _lsc:.     
-00008bb0: 2020 2020 2020 2064 6263 203d 2050 6879         dbc = Phy
-00008bc0: 7342 6962 6c69 6f44 4243 6f72 6528 7465  sBiblioDBCore(te
-00008bd0: 6d70 4442 4e61 6d65 2c20 7042 4c6f 6767  mpDBName, pBLogg
-00008be0: 6572 2c20 6e6f 4f70 656e 3d54 7275 6529  er, noOpen=True)
-00008bf0: 0a20 2020 2020 2020 2064 6263 2e63 6f6e  .        dbc.con
-00008c00: 6e20 3d20 4d61 6769 634d 6f63 6b28 290a  n = MagicMock().
-00008c10: 2020 2020 2020 2020 6462 632e 6462 4368          dbc.dbCh
-00008c20: 616e 6765 6420 3d20 2261 6263 220a 2020  anged = "abc".  
-00008c30: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00008c40: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-00008c50: 2e69 6e66 6f22 2920 6173 205f 693a 0a20  .info") as _i:. 
-00008c60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00008c70: 6173 7365 7274 5472 7565 2864 6263 2e63  assertTrue(dbc.c
-00008c80: 6f6d 6d69 7428 2929 0a20 2020 2020 2020  ommit()).       
-00008c90: 2020 2020 2064 6263 2e63 6f6e 6e2e 636f       dbc.conn.co
-00008ca0: 6d6d 6974 2e61 7373 6572 745f 6361 6c6c  mmit.assert_call
-00008cb0: 6564 5f6f 6e63 655f 7769 7468 2829 0a20  ed_once_with(). 
-00008cc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00008cd0: 6173 7365 7274 4661 6c73 6528 6462 632e  assertFalse(dbc.
-00008ce0: 6462 4368 616e 6765 6429 0a20 2020 2020  dbChanged).     
-00008cf0: 2020 2020 2020 205f 692e 6173 7365 7274         _i.assert
-00008d00: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-00008d10: 6828 2244 6174 6162 6173 6520 7361 7665  h("Database save
-00008d20: 642e 2229 0a20 2020 2020 2020 2020 2020  d.").           
-00008d30: 2064 6263 2e64 6243 6861 6e67 6564 203d   dbc.dbChanged =
-00008d40: 2022 6162 6322 0a20 2020 2020 2020 2020   "abc".         
-00008d50: 2020 205f 692e 7265 7365 745f 6d6f 636b     _i.reset_mock
-00008d60: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-00008d70: 656c 662e 6173 7365 7274 5472 7565 2864  elf.assertTrue(d
-00008d80: 6263 2e63 6f6d 6d69 7428 7665 7262 6f73  bc.commit(verbos
-00008d90: 653d 4661 6c73 6529 290a 2020 2020 2020  e=False)).      
-00008da0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00008db0: 7446 616c 7365 2864 6263 2e64 6243 6861  tFalse(dbc.dbCha
-00008dc0: 6e67 6564 290a 2020 2020 2020 2020 2020  nged).          
-00008dd0: 2020 5f69 2e61 7373 6572 745f 6e6f 745f    _i.assert_not_
-00008de0: 6361 6c6c 6564 2829 0a20 2020 2020 2020  called().       
-00008df0: 2064 6263 2e63 6f6e 6e2e 636f 6d6d 6974   dbc.conn.commit
-00008e00: 2e72 6573 6574 5f6d 6f63 6b28 290a 2020  .reset_mock().  
-00008e10: 2020 2020 2020 6462 632e 636f 6e6e 2e63        dbc.conn.c
-00008e20: 6f6d 6d69 742e 7369 6465 5f65 6666 6563  ommit.side_effec
-00008e30: 7420 3d20 4578 6365 7074 696f 6e28 2265  t = Exception("e
-00008e40: 7272 6f72 2229 0a20 2020 2020 2020 2064  rror").        d
-00008e50: 6263 2e64 6243 6861 6e67 6564 203d 2022  bc.dbChanged = "
-00008e60: 6162 6322 0a20 2020 2020 2020 2077 6974  abc".        wit
-00008e70: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
-00008e80: 2e4c 6f67 6765 722e 6578 6365 7074 696f  .Logger.exceptio
-00008e90: 6e22 2920 6173 205f 653a 0a20 2020 2020  n") as _e:.     
-00008ea0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00008eb0: 7274 4661 6c73 6528 6462 632e 636f 6d6d  rtFalse(dbc.comm
-00008ec0: 6974 2829 290a 2020 2020 2020 2020 2020  it()).          
-00008ed0: 2020 6462 632e 636f 6e6e 2e63 6f6d 6d69    dbc.conn.commi
-00008ee0: 742e 6173 7365 7274 5f63 616c 6c65 645f  t.assert_called_
-00008ef0: 6f6e 6365 5f77 6974 6828 290a 2020 2020  once_with().    
-00008f00: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00008f10: 6572 7445 7175 616c 2864 6263 2e64 6243  ertEqual(dbc.dbC
-00008f20: 6861 6e67 6564 2c20 2261 6263 2229 0a20  hanged, "abc"). 
-00008f30: 2020 2020 2020 2020 2020 205f 652e 6173             _e.as
-00008f40: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-00008f50: 5f77 6974 6828 2249 6d70 6f73 7369 626c  _with("Impossibl
-00008f60: 6520 746f 2063 6f6d 6d69 7421 2229 0a0a  e to commit!")..
-00008f70: 2020 2020 6465 6620 7465 7374 5f75 6e64      def test_und
-00008f80: 6f28 7365 6c66 2c20 2a61 7267 7329 3a0a  o(self, *args):.
-00008f90: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
-00008fa0: 756e 646f 2222 220a 2020 2020 2020 2020  undo""".        
-00008fb0: 7769 7468 2070 6174 6368 2822 6f73 2e70  with patch("os.p
-00008fc0: 6174 682e 6578 6973 7473 222c 2072 6574  ath.exists", ret
-00008fd0: 7572 6e5f 7661 6c75 653d 5472 7565 2920  urn_value=True) 
-00008fe0: 6173 205f 652c 2070 6174 6368 280a 2020  as _e, patch(.  
-00008ff0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-00009000: 6962 6c69 6f2e 6461 7461 6261 7365 436f  iblio.databaseCo
-00009010: 7265 2e50 6879 7342 6962 6c69 6f44 4243  re.PhysBiblioDBC
-00009020: 6f72 652e 6c6f 6164 5375 6243 6c61 7373  ore.loadSubClass
-00009030: 6573 222c 2061 7574 6f73 7065 633d 5472  es", autospec=Tr
-00009040: 7565 0a20 2020 2020 2020 2029 2061 7320  ue.        ) as 
-00009050: 5f6c 7363 3a0a 2020 2020 2020 2020 2020  _lsc:.          
-00009060: 2020 6462 6320 3d20 5068 7973 4269 626c    dbc = PhysBibl
-00009070: 696f 4442 436f 7265 2874 656d 7044 424e  ioDBCore(tempDBN
-00009080: 616d 652c 2070 424c 6f67 6765 722c 206e  ame, pBLogger, n
-00009090: 6f4f 7065 6e3d 5472 7565 290a 2020 2020  oOpen=True).    
-000090a0: 2020 2020 6462 632e 636f 6e6e 203d 204d      dbc.conn = M
-000090b0: 6167 6963 4d6f 636b 2829 0a20 2020 2020  agicMock().     
-000090c0: 2020 2064 6263 2e64 6243 6861 6e67 6564     dbc.dbChanged
-000090d0: 203d 2022 6162 6322 0a20 2020 2020 2020   = "abc".       
-000090e0: 2077 6974 6820 7061 7463 6828 226c 6f67   with patch("log
-000090f0: 6769 6e67 2e4c 6f67 6765 722e 696e 666f  ging.Logger.info
-00009100: 2229 2061 7320 5f69 3a0a 2020 2020 2020  ") as _i:.      
-00009110: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00009120: 7454 7275 6528 6462 632e 756e 646f 2829  tTrue(dbc.undo()
-00009130: 290a 2020 2020 2020 2020 2020 2020 6462  ).            db
-00009140: 632e 636f 6e6e 2e72 6f6c 6c62 6163 6b2e  c.conn.rollback.
-00009150: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00009160: 6365 5f77 6974 6828 290a 2020 2020 2020  ce_with().      
-00009170: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00009180: 7446 616c 7365 2864 6263 2e64 6243 6861  tFalse(dbc.dbCha
-00009190: 6e67 6564 290a 2020 2020 2020 2020 2020  nged).          
-000091a0: 2020 5f69 2e61 7373 6572 745f 6361 6c6c    _i.assert_call
-000091b0: 6564 5f6f 6e63 655f 7769 7468 2822 526f  ed_once_with("Ro
-000091c0: 6c6c 6564 2062 6163 6b20 746f 206c 6173  lled back to las
-000091d0: 7420 636f 6d6d 6974 2e22 290a 2020 2020  t commit.").    
-000091e0: 2020 2020 2020 2020 6462 632e 6462 4368          dbc.dbCh
-000091f0: 616e 6765 6420 3d20 2261 6263 220a 2020  anged = "abc".  
-00009200: 2020 2020 2020 2020 2020 5f69 2e72 6573            _i.res
-00009210: 6574 5f6d 6f63 6b28 290a 2020 2020 2020  et_mock().      
-00009220: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00009230: 7454 7275 6528 6462 632e 756e 646f 2876  tTrue(dbc.undo(v
-00009240: 6572 626f 7365 3d46 616c 7365 2929 0a20  erbose=False)). 
-00009250: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009260: 6173 7365 7274 4661 6c73 6528 6462 632e  assertFalse(dbc.
-00009270: 6462 4368 616e 6765 6429 0a20 2020 2020  dbChanged).     
-00009280: 2020 2020 2020 205f 692e 6173 7365 7274         _i.assert
-00009290: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
-000092a0: 2020 2020 2020 6462 632e 636f 6e6e 2e72        dbc.conn.r
-000092b0: 6f6c 6c62 6163 6b2e 7265 7365 745f 6d6f  ollback.reset_mo
-000092c0: 636b 2829 0a20 2020 2020 2020 2064 6263  ck().        dbc
-000092d0: 2e63 6f6e 6e2e 726f 6c6c 6261 636b 2e73  .conn.rollback.s
-000092e0: 6964 655f 6566 6665 6374 203d 2045 7863  ide_effect = Exc
-000092f0: 6570 7469 6f6e 2822 6572 726f 7222 290a  eption("error").
-00009300: 2020 2020 2020 2020 6462 632e 6462 4368          dbc.dbCh
-00009310: 616e 6765 6420 3d20 2261 6263 220a 2020  anged = "abc".  
-00009320: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00009330: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-00009340: 2e65 7863 6570 7469 6f6e 2229 2061 7320  .exception") as 
-00009350: 5f65 3a0a 2020 2020 2020 2020 2020 2020  _e:.            
-00009360: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
-00009370: 2864 6263 2e75 6e64 6f28 2929 0a20 2020  (dbc.undo()).   
-00009380: 2020 2020 2020 2020 2064 6263 2e63 6f6e           dbc.con
-00009390: 6e2e 726f 6c6c 6261 636b 2e61 7373 6572  n.rollback.asser
-000093a0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-000093b0: 7468 2829 0a20 2020 2020 2020 2020 2020  th().           
-000093c0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000093d0: 6c28 6462 632e 6462 4368 616e 6765 642c  l(dbc.dbChanged,
-000093e0: 2022 6162 6322 290a 2020 2020 2020 2020   "abc").        
-000093f0: 2020 2020 5f65 2e61 7373 6572 745f 6361      _e.assert_ca
-00009400: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
-00009410: 496d 706f 7373 6962 6c65 2074 6f20 726f  Impossible to ro
-00009420: 6c6c 6261 636b 2122 290a 0a20 2020 2064  llback!")..    d
-00009430: 6566 2074 6573 745f 636f 6e6e 4578 6563  ef test_connExec
-00009440: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-00009450: 2020 2020 2020 2022 2222 7465 7374 2063         """test c
-00009460: 6f6e 6e45 7865 6322 2222 0a20 2020 2020  onnExec""".     
-00009470: 2020 2073 656c 662e 7042 4442 2e64 6243     self.pBDB.dbC
-00009480: 6861 6e67 6564 203d 2046 616c 7365 0a20  hanged = False. 
-00009490: 2020 2020 2020 2074 7275 6563 6f6e 6e20         trueconn 
-000094a0: 3d20 7365 6c66 2e70 4244 422e 636f 6e6e  = self.pBDB.conn
-000094b0: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-000094c0: 4442 2e63 6f6e 6e20 3d20 4d61 6769 634d  DB.conn = MagicM
-000094d0: 6f63 6b28 290a 2020 2020 2020 2020 7365  ock().        se
-000094e0: 6c66 2e70 4244 422e 636f 6e6e 2e65 7865  lf.pBDB.conn.exe
-000094f0: 6375 7465 2e73 6964 655f 6566 6665 6374  cute.side_effect
-00009500: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-00009510: 2050 726f 6772 616d 6d69 6e67 4572 726f   ProgrammingErro
-00009520: 7228 2261 2229 2c0a 2020 2020 2020 2020  r("a"),.        
-00009530: 2020 2020 4461 7461 6261 7365 4572 726f      DatabaseErro
-00009540: 7228 2262 2229 2c0a 2020 2020 2020 2020  r("b"),.        
-00009550: 2020 2020 496e 7465 7266 6163 6545 7272      InterfaceErr
-00009560: 6f72 2822 6322 292c 0a20 2020 2020 2020  or("c"),.       
-00009570: 205d 0a20 2020 2020 2020 2077 6974 6820   ].        with 
-00009580: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-00009590: 6f67 6765 722e 6578 6365 7074 696f 6e22  ogger.exception"
-000095a0: 2920 6173 205f 6578 3a0a 2020 2020 2020  ) as _ex:.      
-000095b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000095c0: 7446 616c 7365 2873 656c 662e 7042 4442  tFalse(self.pBDB
-000095d0: 2e63 6f6e 6e45 7865 6328 2261 2229 290a  .connExec("a")).
-000095e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000095f0: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
-00009600: 662e 7042 4442 2e63 6f6e 6e45 7865 6328  f.pBDB.connExec(
-00009610: 2261 2229 290a 2020 2020 2020 2020 2020  "a")).          
-00009620: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
-00009630: 7365 2873 656c 662e 7042 4442 2e63 6f6e  se(self.pBDB.con
-00009640: 6e45 7865 6328 2261 2229 290a 2020 2020  nExec("a")).    
-00009650: 2020 2020 2020 2020 5f65 782e 6173 7365          _ex.asse
-00009660: 7274 5f68 6173 5f63 616c 6c73 280a 2020  rt_has_calls(.  
-00009670: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
-00009680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009690: 2020 2020 6361 6c6c 2822 436f 6e6e 6563      call("Connec
-000096a0: 7469 6f6e 2065 7272 6f72 3a20 615c 6e71  tion error: a\nq
-000096b0: 7565 7279 3a20 6122 292c 0a20 2020 2020  uery: a"),.     
-000096c0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000096d0: 616c 6c28 2243 6f6e 6e65 6374 696f 6e20  all("Connection 
-000096e0: 6572 726f 723a 2062 5c6e 7175 6572 793a  error: b\nquery:
-000096f0: 2061 2229 2c0a 2020 2020 2020 2020 2020   a"),.          
-00009700: 2020 2020 2020 2020 2020 6361 6c6c 2822            call("
-00009710: 436f 6e6e 6563 7469 6f6e 2065 7272 6f72  Connection error
-00009720: 3a20 635c 6e71 7565 7279 3a20 6122 292c  : c\nquery: a"),
-00009730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009740: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
-00009750: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-00009760: 4442 2e63 6f6e 6e2e 6578 6563 7574 652e  DB.conn.execute.
-00009770: 7369 6465 5f65 6666 6563 7420 3d20 496e  side_effect = In
-00009780: 7465 6772 6974 7945 7272 6f72 2822 6422  tegrityError("d"
-00009790: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
-000097a0: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
-000097b0: 6767 6572 2e65 7863 6570 7469 6f6e 2229  gger.exception")
-000097c0: 2061 7320 5f65 783a 0a20 2020 2020 2020   as _ex:.       
-000097d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000097e0: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
-000097f0: 636f 6e6e 4578 6563 2822 6122 2929 0a20  connExec("a")). 
-00009800: 2020 2020 2020 2020 2020 205f 6578 2e61             _ex.a
-00009810: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00009820: 655f 7769 7468 2822 4361 6e6e 6f74 2069  e_with("Cannot i
-00009830: 6e73 6572 742f 7570 6461 7465 3a20 4944  nsert/update: ID
-00009840: 2065 7869 7374 7321 5c6e 645c 6e71 7565   exists!\nd\nque
-00009850: 7279 3a20 6122 290a 0a20 2020 2020 2020  ry: a")..       
-00009860: 2073 656c 662e 7042 4442 2e63 6f6e 6e2e   self.pBDB.conn.
-00009870: 6578 6563 7574 652e 7369 6465 5f65 6666  execute.side_eff
-00009880: 6563 7420 3d20 4f70 6572 6174 696f 6e61  ect = Operationa
-00009890: 6c45 7272 6f72 2822 6522 290a 2020 2020  lError("e").    
-000098a0: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
-000098b0: 6c6f 6767 696e 672e 4c6f 6767 6572 2e65  logging.Logger.e
-000098c0: 7863 6570 7469 6f6e 2229 2061 7320 5f65  xception") as _e
-000098d0: 782c 2070 6174 6368 280a 2020 2020 2020  x, patch(.      
-000098e0: 2020 2020 2020 226c 6f67 6769 6e67 2e4c        "logging.L
-000098f0: 6f67 6765 722e 6572 726f 7222 0a20 2020  ogger.error".   
-00009900: 2020 2020 2029 2061 7320 5f65 722c 2070       ) as _er, p
-00009910: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-00009920: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-00009930: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
-00009940: 6962 6c69 6f44 4243 6f72 652e 7365 6e64  iblioDBCore.send
-00009950: 4442 4973 4c6f 636b 6564 222c 0a20 2020  DBIsLocked",.   
-00009960: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-00009970: 7661 6c75 653d 5472 7565 2c0a 2020 2020  value=True,.    
-00009980: 2020 2020 2020 2020 6175 746f 7370 6563          autospec
-00009990: 3d54 7275 652c 0a20 2020 2020 2020 2029  =True,.        )
-000099a0: 2061 7320 5f6c 6f3a 0a20 2020 2020 2020   as _lo:.       
-000099b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000099c0: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
-000099d0: 636f 6e6e 4578 6563 2822 6122 2929 0a20  connExec("a")). 
-000099e0: 2020 2020 2020 2020 2020 205f 6578 2e61             _ex.a
-000099f0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00009a00: 655f 7769 7468 2822 436f 6e6e 6563 7469  e_with("Connecti
-00009a10: 6f6e 2065 7272 6f72 3a20 655c 6e71 7565  on error: e\nque
-00009a20: 7279 3a20 6122 290a 2020 2020 2020 2020  ry: a").        
-00009a30: 2020 2020 5f65 722e 6173 7365 7274 5f6e      _er.assert_n
-00009a40: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
-00009a50: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00009a60: 6572 7445 7175 616c 285f 6c6f 2e63 616c  ertEqual(_lo.cal
-00009a70: 6c5f 636f 756e 742c 2030 290a 2020 2020  l_count, 0).    
-00009a80: 2020 2020 7365 6c66 2e70 4244 422e 636f      self.pBDB.co
-00009a90: 6e6e 2e65 7865 6375 7465 2e73 6964 655f  nn.execute.side_
-00009aa0: 6566 6665 6374 203d 204f 7065 7261 7469  effect = Operati
-00009ab0: 6f6e 616c 4572 726f 7228 2264 6174 6162  onalError("datab
-00009ac0: 6173 6520 6973 206c 6f63 6b65 6422 290a  ase is locked").
-00009ad0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-00009ae0: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
-00009af0: 6572 2e65 7863 6570 7469 6f6e 2229 2061  er.exception") a
-00009b00: 7320 5f65 782c 2070 6174 6368 280a 2020  s _ex, patch(.  
-00009b10: 2020 2020 2020 2020 2020 226c 6f67 6769            "loggi
-00009b20: 6e67 2e4c 6f67 6765 722e 6572 726f 7222  ng.Logger.error"
-00009b30: 0a20 2020 2020 2020 2029 2061 7320 5f65  .        ) as _e
-00009b40: 722c 2070 6174 6368 280a 2020 2020 2020  r, patch(.      
-00009b50: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-00009b60: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
-00009b70: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
-00009b80: 7365 6e64 4442 4973 4c6f 636b 6564 222c  sendDBIsLocked",
-00009b90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00009ba0: 7572 6e5f 7661 6c75 653d 5472 7565 2c0a  urn_value=True,.
-00009bb0: 2020 2020 2020 2020 2020 2020 6175 746f              auto
-00009bc0: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
-00009bd0: 2020 2029 2061 7320 5f6c 6f3a 0a20 2020     ) as _lo:.   
-00009be0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00009bf0: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
-00009c00: 4244 422e 636f 6e6e 4578 6563 2822 6122  BDB.connExec("a"
-00009c10: 2929 0a20 2020 2020 2020 2020 2020 205f  )).            _
-00009c20: 6578 2e61 7373 6572 745f 6e6f 745f 6361  ex.assert_not_ca
-00009c30: 6c6c 6564 2829 0a20 2020 2020 2020 2020  lled().         
-00009c40: 2020 205f 6572 2e61 7373 6572 745f 6e6f     _er.assert_no
-00009c50: 745f 6361 6c6c 6564 2829 0a20 2020 2020  t_called().     
-00009c60: 2020 2020 2020 205f 6c6f 2e61 7373 6572         _lo.asser
-00009c70: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-00009c80: 7468 2873 656c 662e 7042 4442 290a 2020  th(self.pBDB).  
-00009c90: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00009ca0: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-00009cb0: 2e65 7863 6570 7469 6f6e 2229 2061 7320  .exception") as 
-00009cc0: 5f65 782c 2070 6174 6368 280a 2020 2020  _ex, patch(.    
-00009cd0: 2020 2020 2020 2020 226c 6f67 6769 6e67          "logging
-00009ce0: 2e4c 6f67 6765 722e 6572 726f 7222 0a20  .Logger.error". 
-00009cf0: 2020 2020 2020 2029 2061 7320 5f65 722c         ) as _er,
-00009d00: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-00009d10: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-00009d20: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
-00009d30: 7342 6962 6c69 6f44 4243 6f72 652e 7365  sBiblioDBCore.se
-00009d40: 6e64 4442 4973 4c6f 636b 6564 222c 0a20  ndDBIsLocked",. 
-00009d50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00009d60: 6e5f 7661 6c75 653d 4661 6c73 652c 0a20  n_value=False,. 
-00009d70: 2020 2020 2020 2020 2020 2061 7574 6f73             autos
-00009d80: 7065 633d 5472 7565 2c0a 2020 2020 2020  pec=True,.      
-00009d90: 2020 2920 6173 205f 6c6f 3a0a 2020 2020    ) as _lo:.    
-00009da0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00009db0: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
-00009dc0: 4442 2e63 6f6e 6e45 7865 6328 2261 2229  DB.connExec("a")
-00009dd0: 290a 2020 2020 2020 2020 2020 2020 5f65  ).            _e
-00009de0: 782e 6173 7365 7274 5f6e 6f74 5f63 616c  x.assert_not_cal
-00009df0: 6c65 6428 290a 2020 2020 2020 2020 2020  led().          
-00009e00: 2020 5f65 722e 6173 7365 7274 5f63 616c    _er.assert_cal
-00009e10: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
-00009e20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00009e30: 4f70 6572 6174 696f 6e61 6c45 7272 6f72  OperationalError
-00009e40: 3a20 7468 6520 6461 7461 6261 7365 2069  : the database i
-00009e50: 7320 616c 7265 6164 7920 6f70 656e 2022  s already open "
-00009e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009e70: 202b 2022 696e 2061 6e6f 7468 6572 2069   + "in another i
-00009e80: 6e73 7461 6e63 6520 6f66 2074 6865 2061  nstance of the a
-00009e90: 7070 6c69 6361 7469 6f6e 5c6e 7175 6572  pplication\nquer
-00009ea0: 7920 6661 696c 6564 3a20 6122 0a20 2020  y failed: a".   
-00009eb0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00009ec0: 2020 2020 2020 205f 6c6f 2e61 7373 6572         _lo.asser
-00009ed0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-00009ee0: 7468 2873 656c 662e 7042 4442 290a 0a20  th(self.pBDB).. 
-00009ef0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00009f00: 2e63 6f6e 6e2e 6578 6563 7574 652e 7265  .conn.execute.re
-00009f10: 7365 745f 6d6f 636b 2829 0a20 2020 2020  set_mock().     
-00009f20: 2020 2073 656c 662e 7042 4442 2e63 6f6e     self.pBDB.con
-00009f30: 6e2e 6578 6563 7574 652e 7369 6465 5f65  n.execute.side_e
-00009f40: 6666 6563 7420 3d20 4e6f 6e65 0a20 2020  ffect = None.   
-00009f50: 2020 2020 2073 656c 662e 7042 4442 6269       self.pBDBbi
-00009f60: 7320 3d20 5068 7973 4269 626c 696f 4442  s = PhysBiblioDB
-00009f70: 2874 656d 7044 424e 616d 652c 2070 424c  (tempDBName, pBL
-00009f80: 6f67 6765 7229 0a20 2020 2020 2020 2073  ogger).        s
-00009f90: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
-00009fa0: 7365 6c66 2e70 4244 422e 6462 4368 616e  self.pBDB.dbChan
-00009fb0: 6765 6429 0a20 2020 2020 2020 2073 656c  ged).        sel
-00009fc0: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-00009fd0: 662e 7042 4442 2e63 6f6e 6e45 7865 6328  f.pBDB.connExec(
-00009fe0: 2261 2229 290a 2020 2020 2020 2020 7365  "a")).        se
-00009ff0: 6c66 2e70 4244 422e 636f 6e6e 2e65 7865  lf.pBDB.conn.exe
-0000a000: 6375 7465 2e61 7373 6572 745f 6361 6c6c  cute.assert_call
-0000a010: 6564 5f6f 6e63 655f 7769 7468 2822 6122  ed_once_with("a"
-0000a020: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0000a030: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-0000a040: 4244 422e 6462 4368 616e 6765 6429 0a20  BDB.dbChanged). 
-0000a050: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0000a060: 2e64 6243 6861 6e67 6564 203d 2046 616c  .dbChanged = Fal
-0000a070: 7365 0a20 2020 2020 2020 2073 656c 662e  se.        self.
-0000a080: 7042 4442 2e63 6f6e 6e2e 6578 6563 7574  pBDB.conn.execut
-0000a090: 652e 7265 7365 745f 6d6f 636b 2829 0a20  e.reset_mock(). 
-0000a0a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000a0b0: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
-0000a0c0: 2e63 6f6e 6e45 7865 6328 2261 222c 2064  .connExec("a", d
-0000a0d0: 6174 613d 2262 2229 290a 2020 2020 2020  ata="b")).      
-0000a0e0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-0000a0f0: 6528 7365 6c66 2e70 4244 422e 6462 4368  e(self.pBDB.dbCh
-0000a100: 616e 6765 6429 0a20 2020 2020 2020 2073  anged).        s
-0000a110: 656c 662e 7042 4442 2e63 6f6e 6e2e 6578  elf.pBDB.conn.ex
-0000a120: 6563 7574 652e 6173 7365 7274 5f63 616c  ecute.assert_cal
-0000a130: 6c65 645f 6f6e 6365 5f77 6974 6828 2261  led_once_with("a
-0000a140: 222c 2022 6222 290a 2020 2020 2020 2020  ", "b").        
-0000a150: 7365 6c66 2e70 4244 4262 6973 2e75 6e64  self.pBDBbis.und
-0000a160: 6f28 290a 2020 2020 2020 2020 7365 6c66  o().        self
-0000a170: 2e70 4244 4262 6973 2e63 6c6f 7365 4442  .pBDBbis.closeDB
-0000a180: 2829 0a0a 2020 2020 2020 2020 7365 6c66  ()..        self
-0000a190: 2e70 4244 422e 636f 6e6e 203d 2074 7275  .pBDB.conn = tru
-0000a1a0: 6563 6f6e 6e0a 0a20 2020 2064 6566 2074  econn..    def t
-0000a1b0: 6573 745f 6375 7273 4578 6563 2873 656c  est_cursExec(sel
-0000a1c0: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
-0000a1d0: 2020 2022 2222 7465 7374 2063 7572 7345     """test cursE
-0000a1e0: 7865 6322 2222 0a20 2020 2020 2020 2074  xec""".        t
-0000a1f0: 7275 6563 6f6e 6e20 3d20 7365 6c66 2e70  rueconn = self.p
-0000a200: 4244 422e 6375 7273 0a20 2020 2020 2020  BDB.curs.       
-0000a210: 2073 656c 662e 7042 4442 2e63 7572 7320   self.pBDB.curs 
-0000a220: 3d20 4d61 6769 634d 6f63 6b28 290a 2020  = MagicMock().  
-0000a230: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0000a240: 6375 7273 2e65 7865 6375 7465 2e73 6964  curs.execute.sid
-0000a250: 655f 6566 6665 6374 203d 2045 7863 6570  e_effect = Excep
-0000a260: 7469 6f6e 2822 6122 290a 2020 2020 2020  tion("a").      
-0000a270: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
-0000a280: 6767 696e 672e 4c6f 6767 6572 2e65 7863  gging.Logger.exc
-0000a290: 6570 7469 6f6e 2229 2061 7320 5f65 783a  eption") as _ex:
-0000a2a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000a2b0: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
-0000a2c0: 6c66 2e70 4244 422e 6375 7273 4578 6563  lf.pBDB.cursExec
-0000a2d0: 2822 6122 2929 0a20 2020 2020 2020 2020  ("a")).         
-0000a2e0: 2020 205f 6578 2e61 7373 6572 745f 6361     _ex.assert_ca
-0000a2f0: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
-0000a300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a310: 2743 7572 736f 7220 6572 726f 723a 2061  'Cursor error: a
-0000a320: 5c6e 5468 6520 7175 6572 7920 7761 733a  \nThe query was:
-0000a330: 2022 6122 5c6e 2720 2b20 2261 6e64 2074   "a"\n' + "and t
-0000a340: 6865 2070 6172 616d 6574 6572 733a 204e  he parameters: N
-0000a350: 6f6e 6522 0a20 2020 2020 2020 2020 2020  one".           
-0000a360: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
-0000a370: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-0000a380: 6f67 6765 722e 6578 6365 7074 696f 6e22  ogger.exception"
-0000a390: 2920 6173 205f 6578 3a0a 2020 2020 2020  ) as _ex:.      
-0000a3a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000a3b0: 7446 616c 7365 2873 656c 662e 7042 4442  tFalse(self.pBDB
-0000a3c0: 2e63 7572 7345 7865 6328 2261 222c 2064  .cursExec("a", d
-0000a3d0: 6174 613d 5b22 6222 5d29 290a 2020 2020  ata=["b"])).    
-0000a3e0: 2020 2020 2020 2020 5f65 782e 6173 7365          _ex.asse
-0000a3f0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-0000a400: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
-0000a410: 2020 2020 2027 4375 7273 6f72 2065 7272       'Cursor err
-0000a420: 6f72 3a20 615c 6e54 6865 2071 7565 7279  or: a\nThe query
-0000a430: 2077 6173 3a20 2261 225c 6e27 202b 2022   was: "a"\n' + "
-0000a440: 616e 6420 7468 6520 7061 7261 6d65 7465  and the paramete
-0000a450: 7273 3a20 5b27 6227 5d22 0a20 2020 2020  rs: ['b']".     
-0000a460: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000a470: 2020 7365 6c66 2e70 4244 422e 6375 7273    self.pBDB.curs
-0000a480: 2e65 7865 6375 7465 2e72 6573 6574 5f6d  .execute.reset_m
-0000a490: 6f63 6b28 290a 2020 2020 2020 2020 7365  ock().        se
-0000a4a0: 6c66 2e70 4244 422e 6375 7273 2e65 7865  lf.pBDB.curs.exe
-0000a4b0: 6375 7465 2e73 6964 655f 6566 6665 6374  cute.side_effect
-0000a4c0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-0000a4d0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-0000a4e0: 7365 6c66 2e70 4244 422e 6375 7273 4578  self.pBDB.cursEx
-0000a4f0: 6563 2822 6122 2c20 6461 7461 3d22 6222  ec("a", data="b"
-0000a500: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-0000a510: 7042 4442 2e63 7572 732e 6578 6563 7574  pBDB.curs.execut
-0000a520: 652e 6173 7365 7274 5f63 616c 6c65 645f  e.assert_called_
-0000a530: 6f6e 6365 5f77 6974 6828 2261 222c 2022  once_with("a", "
-0000a540: 6222 290a 0a20 2020 2020 2020 2073 656c  b")..        sel
-0000a550: 662e 7042 4442 2e63 7572 7320 3d20 7472  f.pBDB.curs = tr
-0000a560: 7565 636f 6e6e 0a0a 2020 2020 6465 6620  ueconn..    def 
-0000a570: 7465 7374 5f63 7572 736f 7228 7365 6c66  test_cursor(self
-0000a580: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
-0000a590: 2020 2222 2274 6573 7420 6375 7273 6f72    """test cursor
-0000a5a0: 2222 220a 2020 2020 2020 2020 7769 7468  """.        with
-0000a5b0: 2070 6174 6368 2822 6f73 2e70 6174 682e   patch("os.path.
-0000a5c0: 6578 6973 7473 222c 2072 6574 7572 6e5f  exists", return_
-0000a5d0: 7661 6c75 653d 5472 7565 2920 6173 205f  value=True) as _
-0000a5e0: 652c 2070 6174 6368 280a 2020 2020 2020  e, patch(.      
-0000a5f0: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0000a600: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
-0000a610: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
-0000a620: 6c6f 6164 5375 6243 6c61 7373 6573 222c  loadSubClasses",
-0000a630: 2061 7574 6f73 7065 633d 5472 7565 0a20   autospec=True. 
-0000a640: 2020 2020 2020 2029 2061 7320 5f6c 7363         ) as _lsc
-0000a650: 3a0a 2020 2020 2020 2020 2020 2020 6462  :.            db
-0000a660: 6320 3d20 5068 7973 4269 626c 696f 4442  c = PhysBiblioDB
-0000a670: 436f 7265 2874 656d 7044 424e 616d 652c  Core(tempDBName,
-0000a680: 2070 424c 6f67 6765 722c 206e 6f4f 7065   pBLogger, noOpe
-0000a690: 6e3d 5472 7565 290a 2020 2020 2020 2020  n=True).        
-0000a6a0: 6462 632e 6375 7273 203d 2022 6375 7273  dbc.curs = "curs
-0000a6b0: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-0000a6c0: 7373 6572 7445 7175 616c 2864 6263 2e63  ssertEqual(dbc.c
-0000a6d0: 7572 736f 7228 292c 2022 6375 7273 2229  ursor(), "curs")
-0000a6e0: 0a0a 2020 2020 6465 6620 7465 7374 5f63  ..    def test_c
-0000a6f0: 6865 636b 4578 6973 7469 6e67 5461 626c  heckExistingTabl
-0000a700: 6573 2873 656c 662c 202a 6172 6773 293a  es(self, *args):
-0000a710: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
-0000a720: 2063 6865 636b 4578 6973 7469 6e67 5461   checkExistingTa
-0000a730: 626c 6573 2222 220a 2020 2020 2020 2020  bles""".        
-0000a740: 7769 7468 2070 6174 6368 2822 6f73 2e70  with patch("os.p
-0000a750: 6174 682e 6578 6973 7473 222c 2072 6574  ath.exists", ret
-0000a760: 7572 6e5f 7661 6c75 653d 5472 7565 2920  urn_value=True) 
-0000a770: 6173 205f 652c 2070 6174 6368 280a 2020  as _e, patch(.  
-0000a780: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-0000a790: 6962 6c69 6f2e 6461 7461 6261 7365 436f  iblio.databaseCo
-0000a7a0: 7265 2e50 6879 7342 6962 6c69 6f44 4243  re.PhysBiblioDBC
-0000a7b0: 6f72 652e 6c6f 6164 5375 6243 6c61 7373  ore.loadSubClass
-0000a7c0: 6573 222c 2061 7574 6f73 7065 633d 5472  es", autospec=Tr
-0000a7d0: 7565 0a20 2020 2020 2020 2029 2061 7320  ue.        ) as 
-0000a7e0: 5f6c 7363 3a0a 2020 2020 2020 2020 2020  _lsc:.          
-0000a7f0: 2020 6462 6320 3d20 5068 7973 4269 626c    dbc = PhysBibl
-0000a800: 696f 4442 436f 7265 2874 656d 7044 424e  ioDBCore(tempDBN
-0000a810: 616d 652c 2070 424c 6f67 6765 722c 206e  ame, pBLogger, n
-0000a820: 6f4f 7065 6e3d 5472 7565 290a 2020 2020  oOpen=True).    
-0000a830: 2020 2020 6462 632e 6375 7273 203d 205b      dbc.curs = [
-0000a840: 5b22 7461 6231 222c 2022 3122 5d2c 205b  ["tab1", "1"], [
-0000a850: 2274 6162 3222 2c20 2232 225d 5d0a 2020  "tab2", "2"]].  
-0000a860: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-0000a870: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
-0000a880: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
-0000a890: 7365 436f 7265 2e50 6879 7342 6962 6c69  seCore.PhysBibli
-0000a8a0: 6f44 4243 6f72 652e 6375 7273 4578 6563  oDBCore.cursExec
-0000a8b0: 222c 2061 7574 6f73 7065 633d 5472 7565  ", autospec=True
-0000a8c0: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
-0000a8d0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000a8e0: 656c 662e 6173 7365 7274 5472 7565 2864  elf.assertTrue(d
-0000a8f0: 6263 2e63 6865 636b 4578 6973 7469 6e67  bc.checkExisting
-0000a900: 5461 626c 6573 2829 290a 2020 2020 2020  Tables()).      
-0000a910: 2020 2020 2020 5f63 652e 6173 7365 7274        _ce.assert
-0000a920: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-0000a930: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
-0000a940: 2020 2064 6263 2c20 2253 454c 4543 5420     dbc, "SELECT 
-0000a950: 6e61 6d65 2046 524f 4d20 7371 6c69 7465  name FROM sqlite
-0000a960: 5f6d 6173 7465 7220 5748 4552 4520 7479  _master WHERE ty
-0000a970: 7065 3d27 7461 626c 6527 3b22 0a20 2020  pe='table';".   
-0000a980: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000a990: 2020 2077 6974 6820 7061 7463 6828 0a20     with patch(. 
-0000a9a0: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
-0000a9b0: 6269 626c 696f 2e64 6174 6162 6173 6543  biblio.databaseC
-0000a9c0: 6f72 652e 5068 7973 4269 626c 696f 4442  ore.PhysBiblioDB
-0000a9d0: 436f 7265 2e63 7572 7345 7865 6322 2c20  Core.cursExec", 
-0000a9e0: 6175 746f 7370 6563 3d54 7275 650a 2020  autospec=True.  
-0000a9f0: 2020 2020 2020 2920 6173 205f 6365 3a0a        ) as _ce:.
-0000aa00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000aa10: 2e61 7373 6572 7446 616c 7365 2864 6263  .assertFalse(dbc
-0000aa20: 2e63 6865 636b 4578 6973 7469 6e67 5461  .checkExistingTa
-0000aa30: 626c 6573 2877 616e 7465 6454 6162 6c65  bles(wantedTable
-0000aa40: 733d 5b22 7461 6231 222c 2022 7461 6232  s=["tab1", "tab2
-0000aa50: 225d 2929 0a20 2020 2020 2020 2064 6263  "])).        dbc
-0000aa60: 2e63 7572 7320 3d20 5b0a 2020 2020 2020  .curs = [.      
-0000aa70: 2020 2020 2020 5b22 6361 7465 676f 7269        ["categori
-0000aa80: 6573 225d 2c0a 2020 2020 2020 2020 2020  es"],.          
-0000aa90: 2020 5b22 656e 7472 6965 7322 5d2c 0a20    ["entries"],. 
-0000aaa0: 2020 2020 2020 2020 2020 205b 2265 6e74             ["ent
-0000aab0: 7279 4361 7473 225d 2c0a 2020 2020 2020  ryCats"],.      
-0000aac0: 2020 2020 2020 5b22 656e 7472 7945 7870        ["entryExp
-0000aad0: 7322 5d2c 0a20 2020 2020 2020 2020 2020  s"],.           
-0000aae0: 205b 2265 7870 4361 7473 225d 2c0a 2020   ["expCats"],.  
-0000aaf0: 2020 2020 2020 2020 2020 5b22 6578 7065            ["expe
-0000ab00: 7269 6d65 6e74 7322 5d2c 0a20 2020 2020  riments"],.     
-0000ab10: 2020 2020 2020 205b 2273 6574 7469 6e67         ["setting
-0000ab20: 7322 5d2c 0a20 2020 2020 2020 205d 0a20  s"],.        ]. 
-0000ab30: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0000ab40: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-0000ab50: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-0000ab60: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
-0000ab70: 696f 4442 436f 7265 2e63 7572 7345 7865  ioDBCore.cursExe
-0000ab80: 6322 2c20 6175 746f 7370 6563 3d54 7275  c", autospec=Tru
-0000ab90: 650a 2020 2020 2020 2020 2920 6173 205f  e.        ) as _
-0000aba0: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
-0000abb0: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
-0000abc0: 2864 6263 2e63 6865 636b 4578 6973 7469  (dbc.checkExisti
-0000abd0: 6e67 5461 626c 6573 2829 290a 0a20 2020  ngTables())..   
-0000abe0: 2064 6566 2074 6573 745f 6372 6561 7465   def test_create
-0000abf0: 5461 626c 6528 7365 6c66 2c20 2a61 7267  Table(self, *arg
-0000ac00: 7329 3a0a 2020 2020 2020 2020 2222 2274  s):.        """t
-0000ac10: 6573 7420 6372 6561 7465 5461 626c 6522  est createTable"
-0000ac20: 2222 0a20 2020 2020 2020 2069 6620 6f73  "".        if os
-0000ac30: 2e70 6174 682e 6578 6973 7473 2874 656d  .path.exists(tem
-0000ac40: 7046 4442 4e61 6d65 293a 0a20 2020 2020  pFDBName):.     
-0000ac50: 2020 2020 2020 206f 732e 7265 6d6f 7665         os.remove
-0000ac60: 2874 656d 7046 4442 4e61 6d65 290a 2020  (tempFDBName).  
-0000ac70: 2020 2020 2020 6f70 656e 2874 656d 7046        open(tempF
-0000ac80: 4442 4e61 6d65 2c20 2261 2229 2e63 6c6f  DBName, "a").clo
-0000ac90: 7365 2829 0a20 2020 2020 2020 2077 6974  se().        wit
-0000aca0: 6820 7061 7463 6828 226f 732e 7061 7468  h patch("os.path
-0000acb0: 2e65 7869 7374 7322 2c20 7265 7475 726e  .exists", return
-0000acc0: 5f76 616c 7565 3d54 7275 6529 2061 7320  _value=True) as 
-0000acd0: 5f65 2c20 7061 7463 6828 0a20 2020 2020  _e, patch(.     
-0000ace0: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
-0000acf0: 696f 2e64 6174 6162 6173 6543 6f72 652e  io.databaseCore.
-0000ad00: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
-0000ad10: 2e6c 6f61 6453 7562 436c 6173 7365 7322  .loadSubClasses"
-0000ad20: 2c20 6175 746f 7370 6563 3d54 7275 650a  , autospec=True.
-0000ad30: 2020 2020 2020 2020 2920 6173 205f 6c73          ) as _ls
-0000ad40: 633a 0a20 2020 2020 2020 2020 2020 2064  c:.            d
-0000ad50: 6263 203d 2050 6879 7342 6962 6c69 6f44  bc = PhysBiblioD
-0000ad60: 4243 6f72 6528 7465 6d70 4644 424e 616d  BCore(tempFDBNam
-0000ad70: 652c 2070 424c 6f67 6765 722c 206e 6f4f  e, pBLogger, noO
-0000ad80: 7065 6e3d 5472 7565 290a 2020 2020 2020  pen=True).      
-0000ad90: 2020 6462 632e 6f70 656e 4442 2829 0a20    dbc.openDB(). 
-0000ada0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0000adb0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-0000adc0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-0000add0: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
-0000ade0: 696f 4442 436f 7265 2e63 6f6e 6e45 7865  ioDBCore.connExe
-0000adf0: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
-0000ae00: 7369 6465 5f65 6666 6563 743d 5b54 7275  side_effect=[Tru
-0000ae10: 652c 2046 616c 7365 5d2c 0a20 2020 2020  e, False],.     
-0000ae20: 2020 2020 2020 2061 7574 6f73 7065 633d         autospec=
-0000ae30: 5472 7565 2c0a 2020 2020 2020 2020 2920  True,.        ) 
-0000ae40: 6173 205f 6365 2c20 7061 7463 6828 226c  as _ce, patch("l
-0000ae50: 6f67 6769 6e67 2e4c 6f67 6765 722e 696e  ogging.Logger.in
-0000ae60: 666f 2229 2061 7320 5f69 2c20 7061 7463  fo") as _i, patc
-0000ae70: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-0000ae80: 6c6f 6767 696e 672e 4c6f 6767 6572 2e63  logging.Logger.c
-0000ae90: 7269 7469 6361 6c22 0a20 2020 2020 2020  ritical".       
-0000aea0: 2029 2061 7320 5f63 2c20 7061 7463 6828   ) as _c, patch(
-0000aeb0: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-0000aec0: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-0000aed0: 6543 6f72 652e 5068 7973 4269 626c 696f  eCore.PhysBiblio
-0000aee0: 4442 436f 7265 2e63 6f6d 6d69 7422 2c20  DBCore.commit", 
-0000aef0: 6175 746f 7370 6563 3d54 7275 650a 2020  autospec=True.  
-0000af00: 2020 2020 2020 2920 6173 205f 636f 3a0a        ) as _co:.
-0000af10: 2020 2020 2020 2020 2020 2020 6462 632e              dbc.
-0000af20: 6372 6561 7465 5461 626c 6528 2274 6162  createTable("tab
-0000af30: 6c65 6e61 6d65 222c 205b 5b22 6162 6322  lename", [["abc"
-0000af40: 2c20 2264 6566 225d 2c20 5b22 6768 6922  , "def"], ["ghi"
-0000af50: 2c20 226a 6b6c 225d 5d29 0a20 2020 2020  , "jkl"]]).     
-0000af60: 2020 2020 2020 205f 6365 2e61 7373 6572         _ce.asser
-0000af70: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-0000af80: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
-0000af90: 2020 2020 6462 632c 2022 4352 4541 5445      dbc, "CREATE
-0000afa0: 2054 4142 4c45 2074 6162 6c65 6e61 6d65   TABLE tablename
-0000afb0: 2028 5c6e 6162 6320 6465 662c 5c6e 6768   (\nabc def,\ngh
-0000afc0: 6920 6a6b 6c29 3b22 0a20 2020 2020 2020  i jkl);".       
-0000afd0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000afe0: 2020 205f 692e 6173 7365 7274 5f63 616c     _i.assert_cal
-0000aff0: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
-0000b000: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000b010: 4352 4541 5445 2054 4142 4c45 2074 6162  CREATE TABLE tab
-0000b020: 6c65 6e61 6d65 2028 5c6e 6162 6320 6465  lename (\nabc de
-0000b030: 662c 5c6e 6768 6920 6a6b 6c29 3b5c 6e22  f,\nghi jkl);\n"
-0000b040: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000b050: 2020 2020 2020 2020 2020 2064 6263 2e63             dbc.c
-0000b060: 7265 6174 6554 6162 6c65 2822 7461 626c  reateTable("tabl
-0000b070: 656e 616d 6522 2c20 5b5b 2261 6263 222c  ename", [["abc",
-0000b080: 2022 6465 6622 5d2c 205b 2267 6869 222c   "def"], ["ghi",
-0000b090: 2022 6a6b 6c22 5d5d 290a 2020 2020 2020   "jkl"]]).      
-0000b0a0: 2020 2020 2020 5f63 2e61 7373 6572 745f        _c.assert_
-0000b0b0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-0000b0c0: 2822 4372 6561 7465 2074 6162 6c65 2074  ("Create table t
-0000b0d0: 6162 6c65 6e61 6d65 2066 6169 6c65 6422  ablename failed"
-0000b0e0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000b0f0: 6c66 2e61 7373 6572 7445 7175 616c 285f  lf.assertEqual(_
-0000b100: 636f 2e63 616c 6c5f 636f 756e 742c 2030  co.call_count, 0
-0000b110: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
-0000b120: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000b130: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-0000b140: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
-0000b150: 6962 6c69 6f44 4243 6f72 652e 636f 6e6e  iblioDBCore.conn
-0000b160: 4578 6563 222c 0a20 2020 2020 2020 2020  Exec",.         
-0000b170: 2020 2073 6964 655f 6566 6665 6374 3d5b     side_effect=[
-0000b180: 5472 7565 2c20 4661 6c73 655d 2c0a 2020  True, False],.  
-0000b190: 2020 2020 2020 2020 2020 6175 746f 7370            autosp
-0000b1a0: 6563 3d54 7275 652c 0a20 2020 2020 2020  ec=True,.       
-0000b1b0: 2029 2061 7320 5f63 652c 2070 6174 6368   ) as _ce, patch
-0000b1c0: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-0000b1d0: 2e69 6e66 6f22 2920 6173 205f 692c 2070  .info") as _i, p
-0000b1e0: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000b1f0: 2020 226c 6f67 6769 6e67 2e4c 6f67 6765    "logging.Logge
-0000b200: 722e 6372 6974 6963 616c 220a 2020 2020  r.critical".    
-0000b210: 2020 2020 2920 6173 205f 632c 2070 6174      ) as _c, pat
-0000b220: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-0000b230: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
-0000b240: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
-0000b250: 6c69 6f44 4243 6f72 652e 636f 6d6d 6974  lioDBCore.commit
-0000b260: 222c 2061 7574 6f73 7065 633d 5472 7565  ", autospec=True
-0000b270: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
-0000b280: 6f2c 2070 6174 6368 280a 2020 2020 2020  o, patch(.      
-0000b290: 2020 2020 2020 2273 7973 2e65 7869 7422        "sys.exit"
-0000b2a0: 0a20 2020 2020 2020 2029 2061 7320 5f65  .        ) as _e
-0000b2b0: 3a0a 2020 2020 2020 2020 2020 2020 6462  :.            db
-0000b2c0: 632e 6372 6561 7465 5461 626c 6528 0a20  c.createTable(. 
-0000b2d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000b2e0: 7461 626c 656e 616d 6522 2c20 5b5b 2261  tablename", [["a
-0000b2f0: 6263 222c 2022 6465 6622 5d2c 205b 2267  bc", "def"], ["g
-0000b300: 6869 222c 2022 6a6b 6c22 5d5d 2c20 6372  hi", "jkl"]], cr
-0000b310: 6974 6963 616c 3d54 7275 650a 2020 2020  itical=True.    
-0000b320: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000b330: 2020 2020 2020 5f63 652e 6173 7365 7274        _ce.assert
-0000b340: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-0000b350: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
-0000b360: 2020 2064 6263 2c20 2243 5245 4154 4520     dbc, "CREATE 
-0000b370: 5441 424c 4520 7461 626c 656e 616d 6520  TABLE tablename 
-0000b380: 285c 6e61 6263 2064 6566 2c5c 6e67 6869  (\nabc def,\nghi
-0000b390: 206a 6b6c 293b 220a 2020 2020 2020 2020   jkl);".        
-0000b3a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000b3b0: 2020 5f69 2e61 7373 6572 745f 6361 6c6c    _i.assert_call
-0000b3c0: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
-0000b3d0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
-0000b3e0: 5245 4154 4520 5441 424c 4520 7461 626c  REATE TABLE tabl
-0000b3f0: 656e 616d 6520 285c 6e61 6263 2064 6566  ename (\nabc def
-0000b400: 2c5c 6e67 6869 206a 6b6c 293b 5c6e 220a  ,\nghi jkl);\n".
-0000b410: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000b420: 2020 2020 2020 2020 2020 5f63 6f2e 6173            _co.as
-0000b430: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-0000b440: 5f77 6974 6828 6462 6329 0a20 2020 2020  _with(dbc).     
-0000b450: 2020 2020 2020 2064 6263 2e63 7265 6174         dbc.creat
-0000b460: 6554 6162 6c65 280a 2020 2020 2020 2020  eTable(.        
-0000b470: 2020 2020 2020 2020 2274 6162 6c65 6e61          "tablena
-0000b480: 6d65 222c 205b 5b22 6162 6322 2c20 2264  me", [["abc", "d
-0000b490: 6566 225d 2c20 5b22 6768 6922 2c20 226a  ef"], ["ghi", "j
-0000b4a0: 6b6c 225d 5d2c 2063 7269 7469 6361 6c3d  kl"]], critical=
-0000b4b0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-0000b4c0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0000b4d0: 632e 6173 7365 7274 5f63 616c 6c65 645f  c.assert_called_
-0000b4e0: 6f6e 6365 5f77 6974 6828 2243 7265 6174  once_with("Creat
-0000b4f0: 6520 7461 626c 6520 7461 626c 656e 616d  e table tablenam
-0000b500: 6520 6661 696c 6564 2229 0a20 2020 2020  e failed").     
-0000b510: 2020 2020 2020 205f 652e 6173 7365 7274         _e.assert
-0000b520: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-0000b530: 6828 3129 0a20 2020 2020 2020 2020 2020  h(1).           
-0000b540: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000b550: 6c28 5f63 6f2e 6361 6c6c 5f63 6f75 6e74  l(_co.call_count
-0000b560: 2c20 3129 0a0a 2020 2020 6465 6620 7465  , 1)..    def te
-0000b570: 7374 5f63 7265 6174 6554 6162 6c65 7328  st_createTables(
-0000b580: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
-0000b590: 2020 2020 2020 2222 2254 6573 7420 6372        """Test cr
-0000b5a0: 6561 7465 5461 626c 6573 2222 220a 2020  eateTables""".  
-0000b5b0: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
-0000b5c0: 2e65 7869 7374 7328 7465 6d70 4644 424e  .exists(tempFDBN
-0000b5d0: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
-0000b5e0: 2020 6f73 2e72 656d 6f76 6528 7465 6d70    os.remove(temp
-0000b5f0: 4644 424e 616d 6529 0a20 2020 2020 2020  FDBName).       
-0000b600: 206f 7065 6e28 7465 6d70 4644 424e 616d   open(tempFDBNam
-0000b610: 652c 2022 6122 292e 636c 6f73 6528 290a  e, "a").close().
-0000b620: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-0000b630: 6368 2822 6f73 2e70 6174 682e 6578 6973  ch("os.path.exis
-0000b640: 7473 222c 2072 6574 7572 6e5f 7661 6c75  ts", return_valu
-0000b650: 653d 5472 7565 2920 6173 205f 652c 2070  e=True) as _e, p
-0000b660: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000b670: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-0000b680: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
-0000b690: 6962 6c69 6f44 4243 6f72 652e 6c6f 6164  iblioDBCore.load
-0000b6a0: 5375 6243 6c61 7373 6573 222c 2061 7574  SubClasses", aut
-0000b6b0: 6f73 7065 633d 5472 7565 0a20 2020 2020  ospec=True.     
-0000b6c0: 2020 2029 2061 7320 5f6c 7363 3a0a 2020     ) as _lsc:.  
-0000b6d0: 2020 2020 2020 2020 2020 6462 6320 3d20            dbc = 
-0000b6e0: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
-0000b6f0: 2874 656d 7046 4442 4e61 6d65 2c20 7042  (tempFDBName, pB
-0000b700: 4c6f 6767 6572 2c20 6e6f 4f70 656e 3d54  Logger, noOpen=T
-0000b710: 7275 6529 0a20 2020 2020 2020 2064 6263  rue).        dbc
-0000b720: 2e6f 7065 6e44 4228 290a 2020 2020 2020  .openDB().      
-0000b730: 2020 6f72 6967 6375 7273 203d 2064 6263    origcurs = dbc
-0000b740: 2e63 7572 730a 2020 2020 2020 2020 6462  .curs.        db
-0000b750: 632e 6375 7273 203d 205b 5d0a 2020 2020  c.curs = [].    
-0000b760: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
-0000b770: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
-0000b780: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
-0000b790: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
-0000b7a0: 4243 6f72 652e 6375 7273 4578 6563 222c  BCore.cursExec",
-0000b7b0: 2061 7574 6f73 7065 633d 5472 7565 0a20   autospec=True. 
-0000b7c0: 2020 2020 2020 2029 2061 7320 5f63 7572         ) as _cur
-0000b7d0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-0000b7e0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-0000b7f0: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
-0000b800: 7973 4269 626c 696f 4442 436f 7265 2e63  ysBiblioDBCore.c
-0000b810: 7265 6174 6554 6162 6c65 222c 2061 7574  reateTable", aut
-0000b820: 6f73 7065 633d 5472 7565 0a20 2020 2020  ospec=True.     
-0000b830: 2020 2029 2061 7320 5f63 742c 2070 6174     ) as _ct, pat
-0000b840: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-0000b850: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-0000b860: 696e 666f 220a 2020 2020 2020 2020 2920  info".        ) 
-0000b870: 6173 205f 692c 2070 6174 6368 280a 2020  as _i, patch(.  
-0000b880: 2020 2020 2020 2020 2020 226c 6f67 6769            "loggi
-0000b890: 6e67 2e4c 6f67 6765 722e 6572 726f 7222  ng.Logger.error"
-0000b8a0: 0a20 2020 2020 2020 2029 2061 7320 5f65  .        ) as _e
-0000b8b0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-0000b8c0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-0000b8d0: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
-0000b8e0: 7973 4269 626c 696f 4442 436f 7265 2e63  ysBiblioDBCore.c
-0000b8f0: 6f6d 6d69 7422 2c20 6175 746f 7370 6563  ommit", autospec
-0000b900: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
-0000b910: 6173 205f 636f 6d3a 0a20 2020 2020 2020  as _com:.       
-0000b920: 2020 2020 2077 6974 6820 7365 6c66 2e61       with self.a
-0000b930: 7373 6572 7452 6169 7365 7328 4174 7472  ssertRaises(Attr
-0000b940: 6962 7574 6545 7272 6f72 293a 0a20 2020  ibuteError):.   
-0000b950: 2020 2020 2020 2020 2020 2020 2064 6263               dbc
-0000b960: 2e63 7265 6174 6554 6162 6c65 7328 290a  .createTables().
-0000b970: 2020 2020 2020 2020 2020 2020 5f63 742e              _ct.
-0000b980: 6173 7365 7274 5f68 6173 5f63 616c 6c73  assert_has_calls
-0000b990: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000b9a0: 2020 5b63 616c 6c28 6462 632c 2071 2c20    [call(dbc, q, 
-0000b9b0: 7461 626c 6546 6965 6c64 735b 715d 2920  tableFields[q]) 
-0000b9c0: 666f 7220 7120 696e 2074 6162 6c65 4669  for q in tableFi
-0000b9d0: 656c 6473 2e6b 6579 7328 295d 0a20 2020  elds.keys()].   
-0000b9e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000b9f0: 2020 2020 2020 205f 6375 722e 6173 7365         _cur.asse
-0000ba00: 7274 5f61 6e79 5f63 616c 6c28 0a20 2020  rt_any_call(.   
-0000ba10: 2020 2020 2020 2020 2020 2020 2064 6263               dbc
-0000ba20: 2c20 2253 454c 4543 5420 6e61 6d65 2046  , "SELECT name F
-0000ba30: 524f 4d20 7371 6c69 7465 5f6d 6173 7465  ROM sqlite_maste
-0000ba40: 7220 5748 4552 4520 7479 7065 3d27 7461  r WHERE type='ta
-0000ba50: 626c 6527 3b22 0a20 2020 2020 2020 2020  ble';".         
-0000ba60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000ba70: 205f 6375 722e 6173 7365 7274 5f61 6e79   _cur.assert_any
-0000ba80: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0000ba90: 2020 2020 2020 2064 6263 2c20 2273 656c         dbc, "sel
-0000baa0: 6563 7420 2a20 6672 6f6d 2063 6174 6567  ect * from categ
-0000bab0: 6f72 6965 7320 7768 6572 6520 6964 4361  ories where idCa
-0000bac0: 7420 3d20 3020 6f72 2069 6443 6174 203d  t = 0 or idCat =
-0000bad0: 2031 5c6e 220a 2020 2020 2020 2020 2020   1\n".          
-0000bae0: 2020 290a 2020 2020 2020 2020 6462 632e    ).        dbc.
-0000baf0: 636c 6f73 6544 4228 290a 2020 2020 2020  closeDB().      
-0000bb00: 2020 6f73 2e72 656d 6f76 6528 7465 6d70    os.remove(temp
-0000bb10: 4644 424e 616d 6529 0a20 2020 2020 2020  FDBName).       
-0000bb20: 206f 7065 6e28 7465 6d70 4644 424e 616d   open(tempFDBNam
-0000bb30: 652c 2022 6122 292e 636c 6f73 6528 290a  e, "a").close().
-0000bb40: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-0000bb50: 6368 2822 6f73 2e70 6174 682e 6578 6973  ch("os.path.exis
-0000bb60: 7473 222c 2072 6574 7572 6e5f 7661 6c75  ts", return_valu
-0000bb70: 653d 5472 7565 2920 6173 205f 652c 2070  e=True) as _e, p
-0000bb80: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000bb90: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-0000bba0: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
-0000bbb0: 6962 6c69 6f44 4243 6f72 652e 6c6f 6164  iblioDBCore.load
-0000bbc0: 5375 6243 6c61 7373 6573 222c 2061 7574  SubClasses", aut
-0000bbd0: 6f73 7065 633d 5472 7565 0a20 2020 2020  ospec=True.     
-0000bbe0: 2020 2029 2061 7320 5f6c 7363 3a0a 2020     ) as _lsc:.  
-0000bbf0: 2020 2020 2020 2020 2020 6462 6320 3d20            dbc = 
-0000bc00: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
-0000bc10: 2874 656d 7046 4442 4e61 6d65 2c20 7042  (tempFDBName, pB
-0000bc20: 4c6f 6767 6572 2c20 6e6f 4f70 656e 3d54  Logger, noOpen=T
-0000bc30: 7275 6529 0a20 2020 2020 2020 2064 6263  rue).        dbc
-0000bc40: 2e6f 7065 6e44 4228 290a 2020 2020 2020  .openDB().      
-0000bc50: 2020 7769 7468 2070 6174 6368 280a 2020    with patch(.  
-0000bc60: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-0000bc70: 6962 6c69 6f2e 6461 7461 6261 7365 436f  iblio.databaseCo
-0000bc80: 7265 2e50 6879 7342 6962 6c69 6f44 4243  re.PhysBiblioDBC
-0000bc90: 6f72 652e 636f 6e6e 4578 6563 222c 0a20  ore.connExec",. 
-0000bca0: 2020 2020 2020 2020 2020 2073 6964 655f             side_
-0000bcb0: 6566 6665 6374 3d5b 5472 7565 2c20 4661  effect=[True, Fa
-0000bcc0: 6c73 655d 2c0a 2020 2020 2020 2020 2020  lse],.          
-0000bcd0: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
-0000bce0: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
-0000bcf0: 6f6e 2c20 7061 7463 6828 0a20 2020 2020  on, patch(.     
-0000bd00: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
-0000bd10: 696f 2e64 6174 6162 6173 6543 6f72 652e  io.databaseCore.
-0000bd20: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
-0000bd30: 2e63 7265 6174 6554 6162 6c65 222c 2061  .createTable", a
-0000bd40: 7574 6f73 7065 633d 5472 7565 0a20 2020  utospec=True.   
-0000bd50: 2020 2020 2029 2061 7320 5f63 742c 2070       ) as _ct, p
-0000bd60: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000bd70: 2020 226c 6f67 6769 6e67 2e4c 6f67 6765    "logging.Logge
-0000bd80: 722e 696e 666f 220a 2020 2020 2020 2020  r.info".        
-0000bd90: 2920 6173 205f 692c 2070 6174 6368 280a  ) as _i, patch(.
-0000bda0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-0000bdb0: 6769 6e67 2e4c 6f67 6765 722e 6572 726f  ging.Logger.erro
-0000bdc0: 7222 0a20 2020 2020 2020 2029 2061 7320  r".        ) as 
-0000bdd0: 5f65 2c20 7061 7463 6828 0a20 2020 2020  _e, patch(.     
-0000bde0: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
-0000bdf0: 696f 2e64 6174 6162 6173 6543 6f72 652e  io.databaseCore.
-0000be00: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
-0000be10: 2e63 6f6d 6d69 7422 2c20 6175 746f 7370  .commit", autosp
-0000be20: 6563 3d54 7275 650a 2020 2020 2020 2020  ec=True.        
-0000be30: 2920 6173 205f 636f 6d3a 0a20 2020 2020  ) as _com:.     
-0000be40: 2020 2020 2020 2064 6263 2e63 7265 6174         dbc.creat
-0000be50: 6554 6162 6c65 7328 290a 2020 2020 2020  eTables().      
-0000be60: 2020 2020 2020 5f63 6f6e 2e61 7373 6572        _con.asser
-0000be70: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-0000be80: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
-0000be90: 2020 2020 6462 632c 0a20 2020 2020 2020      dbc,.       
-0000bea0: 2020 2020 2020 2020 2022 494e 5345 5254           "INSERT
-0000beb0: 2069 6e74 6f20 6361 7465 676f 7269 6573   into categories
-0000bec0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0000bed0: 2020 202b 2022 2869 6443 6174 2c20 6e61     + "(idCat, na
-0000bee0: 6d65 2c20 6465 7363 7269 7074 696f 6e2c  me, description,
-0000bef0: 2070 6172 656e 7443 6174 2c20 6f72 6429   parentCat, ord)
-0000bf00: 2076 616c 7565 7320 220a 2020 2020 2020   values ".      
-0000bf10: 2020 2020 2020 2020 2020 2b20 2728 302c            + '(0,
-0000bf20: 224d 6169 6e22 2c22 5468 6973 2069 7320  "Main","This is 
-0000bf30: 7468 6520 6d61 696e 2063 6174 6567 6f72  the main categor
-0000bf40: 792e 2027 0a20 2020 2020 2020 2020 2020  y. '.           
-0000bf50: 2020 2020 202b 2027 416c 6c20 7468 6520       + 'All the 
-0000bf60: 6f74 6865 7220 6f6e 6573 2061 7265 2073  other ones are s
-0000bf70: 7562 6361 7465 676f 7269 6573 206f 6620  ubcategories of 
-0000bf80: 7468 6973 206f 6e65 222c 302c 3029 2c20  this one",0,0), 
-0000bf90: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-0000bfa0: 2020 2b20 2728 312c 2254 6167 7322 2c22    + '(1,"Tags","
-0000bfb0: 5573 6520 7468 6973 2063 6174 6567 6f72  Use this categor
-0000bfc0: 7920 746f 2073 746f 7265 2074 6167 7320  y to store tags 
-0000bfd0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-0000bfe0: 2020 2b20 2728 7375 6368 2061 733a 206f    + '(such as: o
-0000bff0: 6e67 6f69 6e67 2070 726f 6a65 6374 732c  ngoing projects,
-0000c000: 2074 656d 706f 7261 7279 2063 6174 732c   temporary cats,
-0000c010: 2e2e 2e29 222c 302c 3029 5c6e 272c 0a20  ...)",0,0)\n',. 
-0000c020: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000c030: 2020 2020 2020 2020 205f 636f 6d2e 6173           _com.as
-0000c040: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-0000c050: 5f77 6974 6828 6462 6329 0a20 2020 2020  _with(dbc).     
-0000c060: 2020 2020 2020 2064 6263 2e75 6e64 6f28         dbc.undo(
-0000c070: 290a 2020 2020 2020 2020 2020 2020 6462  ).            db
-0000c080: 632e 6372 6561 7465 5461 626c 6573 2829  c.createTables()
-0000c090: 2020 2320 7265 7065 6174 2c20 6e6f 7720    # repeat, now 
-0000c0a0: 636f 6e6e 4578 6563 2067 6976 6573 2046  connExec gives F
-0000c0b0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0000c0c0: 205f 652e 6173 7365 7274 5f61 6e79 5f63   _e.assert_any_c
-0000c0d0: 616c 6c28 2249 6e73 6572 7420 6d61 696e  all("Insert main
-0000c0e0: 2063 6174 6567 6f72 6965 7320 6661 696c   categories fail
-0000c0f0: 6564 2229 0a0a 2020 2020 6465 6620 7465  ed")..    def te
-0000c100: 7374 5f63 6865 636b 4461 7461 6261 7365  st_checkDatabase
-0000c110: 5570 6461 7465 735f 4442 4328 7365 6c66  Updates_DBC(self
-0000c120: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
-0000c130: 2020 2222 2274 6573 7420 6368 6563 6b44    """test checkD
-0000c140: 6174 6162 6173 6555 7064 6174 6573 2069  atabaseUpdates i
-0000c150: 6e20 5068 7973 4269 626c 696f 4442 436f  n PhysBiblioDBCo
-0000c160: 7265 2222 220a 2020 2020 2020 2020 7769  re""".        wi
-0000c170: 7468 2070 6174 6368 2822 6f73 2e70 6174  th patch("os.pat
-0000c180: 682e 6578 6973 7473 222c 2072 6574 7572  h.exists", retur
-0000c190: 6e5f 7661 6c75 653d 5472 7565 2920 6173  n_value=True) as
-0000c1a0: 205f 652c 2070 6174 6368 280a 2020 2020   _e, patch(.    
-0000c1b0: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-0000c1c0: 6c69 6f2e 6461 7461 6261 7365 436f 7265  lio.databaseCore
-0000c1d0: 2e50 6879 7342 6962 6c69 6f44 4243 6f72  .PhysBiblioDBCor
-0000c1e0: 652e 6c6f 6164 5375 6243 6c61 7373 6573  e.loadSubClasses
-0000c1f0: 222c 2061 7574 6f73 7065 633d 5472 7565  ", autospec=True
-0000c200: 0a20 2020 2020 2020 2029 2061 7320 5f6c  .        ) as _l
-0000c210: 7363 3a0a 2020 2020 2020 2020 2020 2020  sc:.            
-0000c220: 6462 6320 3d20 5068 7973 4269 626c 696f  dbc = PhysBiblio
-0000c230: 4442 436f 7265 2874 656d 7044 424e 616d  DBCore(tempDBNam
-0000c240: 652c 2070 424c 6f67 6765 722c 206e 6f4f  e, pBLogger, noO
-0000c250: 7065 6e3d 5472 7565 290a 2020 2020 2020  pen=True).      
-0000c260: 2020 6462 632e 6375 7273 203d 205b 0a20    dbc.curs = [. 
-0000c270: 2020 2020 2020 2020 2020 205b 302c 2022             [0, "
-0000c280: 7469 746c 6522 5d2c 0a20 2020 2020 2020  title"],.       
-0000c290: 2020 2020 205b 312c 2022 636f 6c75 6d6e       [1, "column
-0000c2a0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-0000c2b0: 5b32 2c20 2262 6962 6469 6374 225d 2c0a  [2, "bibdict"],.
-0000c2c0: 2020 2020 2020 2020 2020 2020 5b33 2c20              [3, 
-0000c2d0: 2263 6974 6174 696f 6e73 225d 2c0a 2020  "citations"],.  
-0000c2e0: 2020 2020 2020 2020 2020 5b34 2c20 2263            [4, "c
-0000c2f0: 6974 6174 696f 6e73 5f6e 6f5f 7365 6c66  itations_no_self
-0000c300: 225d 2c0a 2020 2020 2020 2020 5d0a 2020  "],.        ].  
-0000c310: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-0000c320: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-0000c330: 2e69 6e66 6f22 2920 6173 205f 692c 2070  .info") as _i, p
-0000c340: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000c350: 2020 226c 6f67 6769 6e67 2e4c 6f67 6765    "logging.Logge
-0000c360: 722e 6572 726f 7222 0a20 2020 2020 2020  r.error".       
-0000c370: 2029 2061 7320 5f65 2c20 7061 7463 6828   ) as _e, patch(
-0000c380: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-0000c390: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-0000c3a0: 6543 6f72 652e 5068 7973 4269 626c 696f  eCore.PhysBiblio
-0000c3b0: 4442 436f 7265 2e63 6f6d 6d69 7422 2c20  DBCore.commit", 
-0000c3c0: 6175 746f 7370 6563 3d54 7275 650a 2020  autospec=True.  
-0000c3d0: 2020 2020 2020 2920 6173 205f 636f 2c20        ) as _co, 
-0000c3e0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-0000c3f0: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
-0000c400: 6174 6162 6173 6543 6f72 652e 5068 7973  atabaseCore.Phys
-0000c410: 4269 626c 696f 4442 436f 7265 2e75 6e64  BiblioDBCore.und
-0000c420: 6f22 2c20 6175 746f 7370 6563 3d54 7275  o", autospec=Tru
-0000c430: 650a 2020 2020 2020 2020 2920 6173 205f  e.        ) as _
-0000c440: 756e 2c20 7061 7463 6828 0a20 2020 2020  un, patch(.     
-0000c450: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
-0000c460: 696f 2e64 6174 6162 6173 6543 6f72 652e  io.databaseCore.
-0000c470: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
-0000c480: 2e63 7572 7345 7865 6322 2c20 6175 746f  .cursExec", auto
-0000c490: 7370 6563 3d54 7275 650a 2020 2020 2020  spec=True.      
-0000c4a0: 2020 2920 6173 205f 6375 652c 2070 6174    ) as _cue, pat
-0000c4b0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-0000c4c0: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
-0000c4d0: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
-0000c4e0: 6c69 6f44 4243 6f72 652e 636f 6e6e 4578  lioDBCore.connEx
-0000c4f0: 6563 222c 0a20 2020 2020 2020 2020 2020  ec",.           
-0000c500: 2073 6964 655f 6566 6665 6374 3d5b 5472   side_effect=[Tr
-0000c510: 7565 2c20 4661 6c73 652c 2054 7275 652c  ue, False, True,
-0000c520: 2054 7275 652c 2046 616c 7365 2c20 4661   True, False, Fa
-0000c530: 6c73 655d 2c0a 2020 2020 2020 2020 2020  lse],.          
-0000c540: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
-0000c550: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
-0000c560: 6f65 3a0a 2020 2020 2020 2020 2020 2020  oe:.            
-0000c570: 6462 632e 6368 6563 6b44 6174 6162 6173  dbc.checkDatabas
-0000c580: 6555 7064 6174 6573 2829 0a20 2020 2020  eUpdates().     
-0000c590: 2020 2020 2020 205f 6375 652e 6173 7365         _cue.asse
-0000c5a0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-0000c5b0: 6974 6828 6462 632c 2022 5052 4147 4d41  ith(dbc, "PRAGMA
-0000c5c0: 2074 6162 6c65 5f69 6e66 6f28 656e 7472   table_info(entr
-0000c5d0: 6965 7329 3b22 290a 2020 2020 2020 2020  ies);").        
-0000c5e0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0000c5f0: 7175 616c 285f 636f 652e 6361 6c6c 5f63  qual(_coe.call_c
-0000c600: 6f75 6e74 2c20 3029 0a20 2020 2020 2020  ount, 0).       
-0000c610: 2020 2020 2064 6263 2e63 7572 7320 3d20       dbc.curs = 
-0000c620: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0000c630: 2020 5b30 2c20 2274 6974 6c65 225d 2c0a    [0, "title"],.
-0000c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c650: 5b31 2c20 2263 6f6c 756d 6e22 5d2c 0a20  [1, "column"],. 
-0000c660: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0000c670: 322c 2022 6369 7461 7469 6f6e 7322 5d2c  2, "citations"],
-0000c680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c690: 205b 332c 2022 6369 7461 7469 6f6e 735f   [3, "citations_
-0000c6a0: 6e6f 5f73 656c 6622 5d2c 0a20 2020 2020  no_self"],.     
-0000c6b0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-0000c6c0: 2020 2020 2064 6263 2e63 6865 636b 4461       dbc.checkDa
-0000c6d0: 7461 6261 7365 5570 6461 7465 7328 290a  tabaseUpdates().
-0000c6e0: 2020 2020 2020 2020 2020 2020 5f63 6f65              _coe
-0000c6f0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-0000c700: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
-0000c710: 2020 2020 2020 2020 2020 6462 632c 2022            dbc, "
-0000c720: 414c 5445 5220 5441 424c 4520 656e 7472  ALTER TABLE entr
-0000c730: 6965 7320 4144 4420 434f 4c55 4d4e 2062  ies ADD COLUMN b
-0000c740: 6962 6469 6374 2074 6578 743b 220a 2020  ibdict text;".  
-0000c750: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000c760: 2020 2020 2020 2020 5f63 6f2e 6173 7365          _co.asse
-0000c770: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-0000c780: 6974 6828 6462 6329 0a20 2020 2020 2020  ith(dbc).       
-0000c790: 2020 2020 205f 692e 6173 7365 7274 5f63       _i.assert_c
-0000c7a0: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-0000c7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c7c0: 2022 4e65 7720 636f 6c75 6d6e 2069 6e20   "New column in 
-0000c7d0: 7461 626c 6520 2765 6e74 7269 6573 273a  table 'entries':
-0000c7e0: 2027 6269 6264 6963 7427 2028 7465 7874   'bibdict' (text
-0000c7f0: 292e 220a 2020 2020 2020 2020 2020 2020  ).".            
-0000c800: 290a 2020 2020 2020 2020 2020 2020 5f65  ).            _e
-0000c810: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-0000c820: 6564 2829 0a20 2020 2020 2020 2020 2020  ed().           
-0000c830: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000c840: 6c28 5f75 6e2e 6361 6c6c 5f63 6f75 6e74  l(_un.call_count
-0000c850: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
-0000c860: 2064 6263 2e63 6865 636b 4461 7461 6261   dbc.checkDataba
-0000c870: 7365 5570 6461 7465 7328 290a 2020 2020  seUpdates().    
-0000c880: 2020 2020 2020 2020 5f63 6f2e 6173 7365          _co.asse
-0000c890: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-0000c8a0: 6974 6828 6462 6329 0a20 2020 2020 2020  ith(dbc).       
-0000c8b0: 2020 2020 205f 652e 6173 7365 7274 5f63       _e.assert_c
-0000c8c0: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-0000c8d0: 2243 616e 6e6f 7420 616c 7465 7220 7461  "Cannot alter ta
-0000c8e0: 626c 6520 2765 6e74 7269 6573 2721 2229  ble 'entries'!")
-0000c8f0: 0a20 2020 2020 2020 2020 2020 205f 756e  .            _un
-0000c900: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-0000c910: 6e63 655f 7769 7468 2864 6263 290a 2020  nce_with(dbc).  
-0000c920: 2020 2020 2020 2020 2020 5f75 6e2e 7265            _un.re
-0000c930: 7365 745f 6d6f 636b 2829 0a20 2020 2020  set_mock().     
-0000c940: 2020 2020 2020 205f 652e 7265 7365 745f         _e.reset_
-0000c950: 6d6f 636b 2829 0a20 2020 2020 2020 2020  mock().         
-0000c960: 2020 2064 6263 2e63 7572 7320 3d20 5b5b     dbc.curs = [[
-0000c970: 302c 2022 7469 746c 6522 5d2c 205b 312c  0, "title"], [1,
-0000c980: 2022 636f 6c75 6d6e 225d 2c20 5b32 2c20   "column"], [2, 
-0000c990: 2262 6962 6469 6374 225d 5d0a 2020 2020  "bibdict"]].    
-0000c9a0: 2020 2020 2020 2020 5f63 6f65 2e72 6573          _coe.res
-0000c9b0: 6574 5f6d 6f63 6b28 290a 2020 2020 2020  et_mock().      
-0000c9c0: 2020 2020 2020 5f63 6f2e 7265 7365 745f        _co.reset_
-0000c9d0: 6d6f 636b 2829 0a20 2020 2020 2020 2020  mock().         
-0000c9e0: 2020 2064 6263 2e63 6865 636b 4461 7461     dbc.checkData
-0000c9f0: 6261 7365 5570 6461 7465 7328 290a 2020  baseUpdates().  
-0000ca00: 2020 2020 2020 2020 2020 5f63 6f65 2e61            _coe.a
-0000ca10: 7373 6572 745f 616e 795f 6361 6c6c 280a  ssert_any_call(.
-0000ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca30: 6462 632c 2022 414c 5445 5220 5441 424c  dbc, "ALTER TABL
-0000ca40: 4520 656e 7472 6965 7320 4144 4420 434f  E entries ADD CO
-0000ca50: 4c55 4d4e 2063 6974 6174 696f 6e73 2069  LUMN citations i
-0000ca60: 6e74 6567 6572 2064 6566 6175 6c74 2030  nteger default 0
-0000ca70: 3b22 0a20 2020 2020 2020 2020 2020 2029  ;".            )
-0000ca80: 0a20 2020 2020 2020 2020 2020 205f 636f  .            _co
-0000ca90: 652e 6173 7365 7274 5f61 6e79 5f63 616c  e.assert_any_cal
-0000caa0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-0000cab0: 2020 2064 6263 2c0a 2020 2020 2020 2020     dbc,.        
-0000cac0: 2020 2020 2020 2020 2241 4c54 4552 2054          "ALTER T
-0000cad0: 4142 4c45 2065 6e74 7269 6573 2041 4444  ABLE entries ADD
-0000cae0: 2043 4f4c 554d 4e20 6369 7461 7469 6f6e   COLUMN citation
-0000caf0: 735f 6e6f 5f73 656c 6620 696e 7465 6765  s_no_self intege
-0000cb00: 7220 6465 6661 756c 7420 303b 222c 0a20  r default 0;",. 
-0000cb10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000cb20: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000cb30: 7365 7274 4571 7561 6c28 5f63 6f2e 6361  sertEqual(_co.ca
-0000cb40: 6c6c 5f63 6f75 6e74 2c20 3229 0a20 2020  ll_count, 2).   
-0000cb50: 2020 2020 2020 2020 205f 692e 6173 7365           _i.asse
-0000cb60: 7274 5f61 6e79 5f63 616c 6c28 224e 6577  rt_any_call("New
-0000cb70: 2063 6f6c 756d 6e20 696e 2074 6162 6c65   column in table
-0000cb80: 2027 656e 7472 6965 7327 3a20 2763 6974   'entries': 'cit
-0000cb90: 6174 696f 6e73 2720 2869 6e74 6567 6572  ations' (integer
-0000cba0: 292e 2229 0a20 2020 2020 2020 2020 2020  ).").           
-0000cbb0: 205f 692e 6173 7365 7274 5f61 6e79 5f63   _i.assert_any_c
-0000cbc0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0000cbd0: 2020 2020 2022 4e65 7720 636f 6c75 6d6e       "New column
-0000cbe0: 2069 6e20 7461 626c 6520 2765 6e74 7269   in table 'entri
-0000cbf0: 6573 273a 2027 6369 7461 7469 6f6e 735f  es': 'citations_
-0000cc00: 6e6f 5f73 656c 6627 2028 696e 7465 6765  no_self' (intege
-0000cc10: 7229 2e22 0a20 2020 2020 2020 2020 2020  r).".           
-0000cc20: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0000cc30: 652e 6173 7365 7274 5f6e 6f74 5f63 616c  e.assert_not_cal
-0000cc40: 6c65 6428 290a 2020 2020 2020 2020 2020  led().          
-0000cc50: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000cc60: 616c 285f 756e 2e63 616c 6c5f 636f 756e  al(_un.call_coun
-0000cc70: 742c 2030 290a 2020 2020 2020 2020 2020  t, 0).          
-0000cc80: 2020 6462 632e 6368 6563 6b44 6174 6162    dbc.checkDatab
-0000cc90: 6173 6555 7064 6174 6573 2829 0a20 2020  aseUpdates().   
-0000cca0: 2020 2020 2020 2020 205f 652e 6173 7365           _e.asse
-0000ccb0: 7274 5f61 6e79 5f63 616c 6c28 2243 616e  rt_any_call("Can
-0000ccc0: 6e6f 7420 616c 7465 7220 7461 626c 6520  not alter table 
-0000ccd0: 2765 6e74 7269 6573 2721 2229 0a20 2020  'entries'!").   
-0000cce0: 2020 2020 2020 2020 205f 756e 2e61 7373           _un.ass
-0000ccf0: 6572 745f 616e 795f 6361 6c6c 2864 6263  ert_any_call(dbc
-0000cd00: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-0000cd10: 5068 7973 4269 626c 696f 4442 5375 6228  PhysBiblioDBSub(
-0000cd20: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
-0000cd30: 2020 2020 2020 2222 2274 6573 7420 6d65        """test me
-0000cd40: 7468 6f64 7320 696e 2050 6879 7342 6962  thods in PhysBib
-0000cd50: 6c69 6f44 4253 7562 2222 220a 2020 2020  lioDBSub""".    
-0000cd60: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
-0000cd70: 6f73 2e70 6174 682e 6578 6973 7473 222c  os.path.exists",
-0000cd80: 2072 6574 7572 6e5f 7661 6c75 653d 5472   return_value=Tr
-0000cd90: 7565 2920 6173 205f 652c 2070 6174 6368  ue) as _e, patch
-0000cda0: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
-0000cdb0: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
-0000cdc0: 7365 436f 7265 2e50 6879 7342 6962 6c69  seCore.PhysBibli
-0000cdd0: 6f44 4243 6f72 652e 6c6f 6164 5375 6243  oDBCore.loadSubC
-0000cde0: 6c61 7373 6573 222c 2061 7574 6f73 7065  lasses", autospe
-0000cdf0: 633d 5472 7565 0a20 2020 2020 2020 2029  c=True.        )
-0000ce00: 2061 7320 5f6c 7363 3a0a 2020 2020 2020   as _lsc:.      
-0000ce10: 2020 2020 2020 6462 6320 3d20 5068 7973        dbc = Phys
-0000ce20: 4269 626c 696f 4442 436f 7265 2874 656d  BiblioDBCore(tem
-0000ce30: 7044 424e 616d 652c 2070 424c 6f67 6765  pDBName, pBLogge
-0000ce40: 7229 0a0a 2020 2020 2020 2020 2320 5f5f  r)..        # __
-0000ce50: 696e 6974 5f5f 0a20 2020 2020 2020 2064  init__.        d
-0000ce60: 6273 203d 2050 6879 7342 6962 6c69 6f44  bs = PhysBiblioD
-0000ce70: 4253 7562 2864 6263 290a 2020 2020 2020  BSub(dbc).      
-0000ce80: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000ce90: 616c 2864 6273 2e6d 6169 6e44 422c 2064  al(dbs.mainDB, d
-0000cea0: 6263 290a 2020 2020 2020 2020 7365 6c66  bc).        self
-0000ceb0: 2e61 7373 6572 7445 7175 616c 2864 6273  .assertEqual(dbs
-0000cec0: 2e6d 6169 6e44 422e 7461 626c 6546 6965  .mainDB.tableFie
-0000ced0: 6c64 732c 2064 6263 2e74 6162 6c65 4669  lds, dbc.tableFi
-0000cee0: 656c 6473 290a 2020 2020 2020 2020 7365  elds).        se
-0000cef0: 6c66 2e61 7373 6572 7445 7175 616c 2864  lf.assertEqual(d
-0000cf00: 6273 2e6d 6169 6e44 422e 7461 626c 6543  bs.mainDB.tableC
-0000cf10: 6f6c 732c 2064 6263 2e74 6162 6c65 436f  ols, dbc.tableCo
-0000cf20: 6c73 290a 2020 2020 2020 2020 7365 6c66  ls).        self
-0000cf30: 2e61 7373 6572 7445 7175 616c 2864 6273  .assertEqual(dbs
-0000cf40: 2e6d 6169 6e44 422e 636f 6e6e 2c20 6462  .mainDB.conn, db
-0000cf50: 632e 636f 6e6e 290a 2020 2020 2020 2020  c.conn).        
-0000cf60: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000cf70: 2864 6273 2e6d 6169 6e44 422e 6375 7273  (dbs.mainDB.curs
-0000cf80: 2c20 6462 632e 6375 7273 290a 2020 2020  , dbc.curs).    
-0000cf90: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0000cfa0: 7175 616c 2864 6273 2e6d 6169 6e44 422e  qual(dbs.mainDB.
-0000cfb0: 6462 6e61 6d65 2c20 6462 632e 6462 6e61  dbname, dbc.dbna
-0000cfc0: 6d65 290a 2020 2020 2020 2020 7365 6c66  me).        self
-0000cfd0: 2e61 7373 6572 7445 7175 616c 2864 6273  .assertEqual(dbs
-0000cfe0: 2e6c 6173 7446 6574 6368 6564 2c20 4e6f  .lastFetched, No
-0000cff0: 6e65 290a 2020 2020 2020 2020 7365 6c66  ne).        self
-0000d000: 2e61 7373 6572 7445 7175 616c 2864 6273  .assertEqual(dbs
-0000d010: 2e63 6174 7348 6965 722c 204e 6f6e 6529  .catsHier, None)
-0000d020: 0a0a 2020 2020 2020 2020 2320 636c 6f73  ..        # clos
-0000d030: 6544 420a 2020 2020 2020 2020 7769 7468  eDB.        with
-0000d040: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-0000d050: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-0000d060: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
-0000d070: 7342 6962 6c69 6f44 4243 6f72 652e 636c  sBiblioDBCore.cl
-0000d080: 6f73 6544 4222 2c20 6175 746f 7370 6563  oseDB", autospec
-0000d090: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
-0000d0a0: 6173 205f 663a 0a20 2020 2020 2020 2020  as _f:.         
-0000d0b0: 2020 2064 6273 2e63 6c6f 7365 4442 2829     dbs.closeDB()
-0000d0c0: 0a20 2020 2020 2020 2020 2020 205f 662e  .            _f.
-0000d0d0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-0000d0e0: 6365 5f77 6974 6828 6462 732e 6d61 696e  ce_with(dbs.main
-0000d0f0: 4442 290a 0a20 2020 2020 2020 2023 2063  DB)..        # c
-0000d100: 6f6d 6d69 740a 2020 2020 2020 2020 7769  ommit.        wi
-0000d110: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-0000d120: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0000d130: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
-0000d140: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
-0000d150: 636f 6d6d 6974 222c 2061 7574 6f73 7065  commit", autospe
-0000d160: 633d 5472 7565 0a20 2020 2020 2020 2029  c=True.        )
-0000d170: 2061 7320 5f66 3a0a 2020 2020 2020 2020   as _f:.        
-0000d180: 2020 2020 6462 732e 636f 6d6d 6974 2829      dbs.commit()
-0000d190: 0a20 2020 2020 2020 2020 2020 205f 662e  .            _f.
-0000d1a0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-0000d1b0: 6365 5f77 6974 6828 6462 732e 6d61 696e  ce_with(dbs.main
-0000d1c0: 4442 290a 0a20 2020 2020 2020 2023 2063  DB)..        # c
-0000d1d0: 6f6e 6e45 7865 630a 2020 2020 2020 2020  onnExec.        
-0000d1e0: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
-0000d1f0: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-0000d200: 6c69 6f2e 6461 7461 6261 7365 436f 7265  lio.databaseCore
-0000d210: 2e50 6879 7342 6962 6c69 6f44 4243 6f72  .PhysBiblioDBCor
-0000d220: 652e 636f 6e6e 4578 6563 222c 0a20 2020  e.connExec",.   
-0000d230: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-0000d240: 7661 6c75 653d 2261 6263 222c 0a20 2020  value="abc",.   
-0000d250: 2020 2020 2020 2020 2061 7574 6f73 7065           autospe
-0000d260: 633d 5472 7565 2c0a 2020 2020 2020 2020  c=True,.        
-0000d270: 2920 6173 205f 663a 0a20 2020 2020 2020  ) as _f:.       
-0000d280: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000d290: 4571 7561 6c28 6462 732e 636f 6e6e 4578  Equal(dbs.connEx
-0000d2a0: 6563 2822 6122 292c 2022 6162 6322 290a  ec("a"), "abc").
-0000d2b0: 2020 2020 2020 2020 2020 2020 5f66 2e61              _f.a
-0000d2c0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-0000d2d0: 655f 7769 7468 2864 6273 2e6d 6169 6e44  e_with(dbs.mainD
-0000d2e0: 422c 2022 6122 2c20 6461 7461 3d4e 6f6e  B, "a", data=Non
-0000d2f0: 6529 0a20 2020 2020 2020 2077 6974 6820  e).        with 
-0000d300: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-0000d310: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
-0000d320: 6174 6162 6173 6543 6f72 652e 5068 7973  atabaseCore.Phys
-0000d330: 4269 626c 696f 4442 436f 7265 2e63 6f6e  BiblioDBCore.con
-0000d340: 6e45 7865 6322 2c0a 2020 2020 2020 2020  nExec",.        
-0000d350: 2020 2020 7265 7475 726e 5f76 616c 7565      return_value
-0000d360: 3d22 6162 6322 2c0a 2020 2020 2020 2020  ="abc",.        
-0000d370: 2020 2020 6175 746f 7370 6563 3d54 7275      autospec=Tru
-0000d380: 652c 0a20 2020 2020 2020 2029 2061 7320  e,.        ) as 
-0000d390: 5f66 3a0a 2020 2020 2020 2020 2020 2020  _f:.            
-0000d3a0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000d3b0: 2864 6273 2e63 6f6e 6e45 7865 6328 2261  (dbs.connExec("a
-0000d3c0: 222c 2064 6174 613d 2262 2229 2c20 2261  ", data="b"), "a
-0000d3d0: 6263 2229 0a20 2020 2020 2020 2020 2020  bc").           
-0000d3e0: 205f 662e 6173 7365 7274 5f63 616c 6c65   _f.assert_calle
-0000d3f0: 645f 6f6e 6365 5f77 6974 6828 6462 732e  d_once_with(dbs.
-0000d400: 6d61 696e 4442 2c20 2261 222c 2064 6174  mainDB, "a", dat
-0000d410: 613d 2262 2229 0a0a 2020 2020 2020 2020  a="b")..        
-0000d420: 2320 6375 7273 4578 6563 0a20 2020 2020  # cursExec.     
-0000d430: 2020 2077 6974 6820 7061 7463 6828 0a20     with patch(. 
-0000d440: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
-0000d450: 6269 626c 696f 2e64 6174 6162 6173 6543  biblio.databaseC
-0000d460: 6f72 652e 5068 7973 4269 626c 696f 4442  ore.PhysBiblioDB
-0000d470: 436f 7265 2e63 7572 7345 7865 6322 2c0a  Core.cursExec",.
-0000d480: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000d490: 726e 5f76 616c 7565 3d22 6162 6322 2c0a  rn_value="abc",.
-0000d4a0: 2020 2020 2020 2020 2020 2020 6175 746f              auto
-0000d4b0: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
-0000d4c0: 2020 2029 2061 7320 5f66 3a0a 2020 2020     ) as _f:.    
-0000d4d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000d4e0: 6572 7445 7175 616c 2864 6273 2e63 7572  ertEqual(dbs.cur
-0000d4f0: 7345 7865 6328 2261 2229 2c20 2261 6263  sExec("a"), "abc
-0000d500: 2229 0a20 2020 2020 2020 2020 2020 205f  ").            _
-0000d510: 662e 6173 7365 7274 5f63 616c 6c65 645f  f.assert_called_
-0000d520: 6f6e 6365 5f77 6974 6828 6462 732e 6d61  once_with(dbs.ma
-0000d530: 696e 4442 2c20 2261 222c 2064 6174 613d  inDB, "a", data=
-0000d540: 4e6f 6e65 290a 2020 2020 2020 2020 7769  None).        wi
-0000d550: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-0000d560: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0000d570: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
-0000d580: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
-0000d590: 6375 7273 4578 6563 222c 0a20 2020 2020  cursExec",.     
-0000d5a0: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
-0000d5b0: 6c75 653d 2261 6263 222c 0a20 2020 2020  lue="abc",.     
-0000d5c0: 2020 2020 2020 2061 7574 6f73 7065 633d         autospec=
-0000d5d0: 5472 7565 2c0a 2020 2020 2020 2020 2920  True,.        ) 
-0000d5e0: 6173 205f 663a 0a20 2020 2020 2020 2020  as _f:.         
-0000d5f0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0000d600: 7561 6c28 6462 732e 6375 7273 4578 6563  ual(dbs.cursExec
-0000d610: 2822 6122 2c20 6461 7461 3d22 6222 292c  ("a", data="b"),
-0000d620: 2022 6162 6322 290a 2020 2020 2020 2020   "abc").        
-0000d630: 2020 2020 5f66 2e61 7373 6572 745f 6361      _f.assert_ca
-0000d640: 6c6c 6564 5f6f 6e63 655f 7769 7468 2864  lled_once_with(d
-0000d650: 6273 2e6d 6169 6e44 422c 2022 6122 2c20  bs.mainDB, "a", 
-0000d660: 6461 7461 3d22 6222 290a 0a20 2020 2020  data="b")..     
-0000d670: 2020 2023 2063 7572 736f 720a 2020 2020     # cursor.    
-0000d680: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
-0000d690: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
-0000d6a0: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
-0000d6b0: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
-0000d6c0: 4243 6f72 652e 6375 7273 6f72 222c 0a20  BCore.cursor",. 
-0000d6d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000d6e0: 6e5f 7661 6c75 653d 2263 7572 7322 2c0a  n_value="curs",.
-0000d6f0: 2020 2020 2020 2020 2020 2020 6175 746f              auto
-0000d700: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
-0000d710: 2020 2029 2061 7320 5f66 3a0a 2020 2020     ) as _f:.    
-0000d720: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000d730: 6572 7445 7175 616c 2864 6273 2e63 7572  ertEqual(dbs.cur
-0000d740: 736f 7228 292c 2022 6375 7273 2229 0a20  sor(), "curs"). 
-0000d750: 2020 2020 2020 2020 2020 205f 662e 6173             _f.as
-0000d760: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-0000d770: 5f77 6974 6828 6462 732e 6d61 696e 4442  _with(dbs.mainDB
-0000d780: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-0000d790: 6368 6563 6b44 6174 6162 6173 6555 7064  checkDatabaseUpd
-0000d7a0: 6174 6573 5f44 4228 7365 6c66 2c20 2a61  ates_DB(self, *a
-0000d7b0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-0000d7c0: 2274 6573 7420 6368 6563 6b44 6174 6162  "test checkDatab
-0000d7d0: 6173 6555 7064 6174 6573 2069 6e20 5068  aseUpdates in Ph
-0000d7e0: 7973 4269 626c 696f 4442 2222 220a 2020  ysBiblioDB""".  
-0000d7f0: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-0000d800: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
-0000d810: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
-0000d820: 7365 436f 7265 2e50 6879 7342 6962 6c69  seCore.PhysBibli
-0000d830: 6f44 4243 6f72 652e 6368 6563 6b44 6174  oDBCore.checkDat
-0000d840: 6162 6173 6555 7064 6174 6573 222c 0a20  abaseUpdates",. 
-0000d850: 2020 2020 2020 2020 2020 2061 7574 6f73             autos
-0000d860: 7065 633d 5472 7565 2c0a 2020 2020 2020  pec=True,.      
-0000d870: 2020 2920 6173 205f 7375 2c20 7061 7463    ) as _su, patc
-0000d880: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-0000d890: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-0000d8a0: 6173 652e 5068 7973 4269 626c 696f 4442  ase.PhysBiblioDB
-0000d8b0: 2e63 6f6e 7665 7274 5365 6172 6368 466f  .convertSearchFo
-0000d8c0: 726d 6174 222c 2061 7574 6f73 7065 633d  rmat", autospec=
-0000d8d0: 5472 7565 0a20 2020 2020 2020 2029 2061  True.        ) a
-0000d8e0: 7320 5f63 662c 2070 6174 6368 280a 2020  s _cf, patch(.  
-0000d8f0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-0000d900: 6962 6c69 6f2e 6461 7461 6261 7365 2e50  iblio.database.P
-0000d910: 6879 7342 6962 6c69 6f44 422e 6368 6563  hysBiblioDB.chec
-0000d920: 6b43 6173 6549 6e73 656e 7369 7469 7665  kCaseInsensitive
-0000d930: 4269 626b 6579 222c 2061 7574 6f73 7065  Bibkey", autospe
-0000d940: 633d 5472 7565 0a20 2020 2020 2020 2029  c=True.        )
-0000d950: 2061 7320 5f63 693a 0a20 2020 2020 2020   as _ci:.       
-0000d960: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
-0000d970: 6865 636b 4461 7461 6261 7365 5570 6461  heckDatabaseUpda
-0000d980: 7465 7328 290a 2020 2020 2020 2020 2020  tes().          
-0000d990: 2020 5f73 752e 6173 7365 7274 5f63 616c    _su.assert_cal
-0000d9a0: 6c65 645f 6f6e 6365 5f77 6974 6828 7365  led_once_with(se
-0000d9b0: 6c66 2e70 4244 4229 0a20 2020 2020 2020  lf.pBDB).       
-0000d9c0: 2020 2020 205f 6366 2e61 7373 6572 745f       _cf.assert_
-0000d9d0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-0000d9e0: 2873 656c 662e 7042 4442 290a 2020 2020  (self.pBDB).    
-0000d9f0: 2020 2020 2020 2020 5f63 692e 6173 7365          _ci.asse
-0000da00: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-0000da10: 6974 6828 7365 6c66 2e70 4244 4229 0a0a  ith(self.pBDB)..
-0000da20: 2020 2020 6465 6620 7465 7374 5f63 6865      def test_che
-0000da30: 636b 4361 7365 496e 7365 6e73 6974 6976  ckCaseInsensitiv
-0000da40: 6542 6962 6b65 7928 7365 6c66 2c20 2a61  eBibkey(self, *a
-0000da50: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-0000da60: 2274 6573 7420 6368 6563 6b43 6173 6549  "test checkCaseI
-0000da70: 6e73 656e 7369 7469 7665 4269 626b 6579  nsensitiveBibkey
-0000da80: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-0000da90: 2e70 4244 422e 6375 7273 203d 204d 6167  .pBDB.curs = Mag
-0000daa0: 6963 4d6f 636b 2829 0a20 2020 2020 2020  icMock().       
-0000dab0: 2073 656c 662e 7042 4442 2e63 7572 732e   self.pBDB.curs.
-0000dac0: 6665 7463 6861 6c6c 2e72 6574 7572 6e5f  fetchall.return_
-0000dad0: 7661 6c75 6520 3d20 5b22 225d 0a20 2020  value = [""].   
-0000dae0: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0000daf0: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-0000db00: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-0000db10: 6543 6f72 652e 5068 7973 4269 626c 696f  eCore.PhysBiblio
-0000db20: 4442 436f 7265 2e63 7572 7345 7865 6322  DBCore.cursExec"
-0000db30: 2c20 6175 746f 7370 6563 3d54 7275 650a  , autospec=True.
-0000db40: 2020 2020 2020 2020 2920 6173 205f 6375          ) as _cu
-0000db50: 722c 2070 6174 6368 2822 6c6f 6767 696e  r, patch("loggin
-0000db60: 672e 4c6f 6767 6572 2e65 7863 6570 7469  g.Logger.excepti
-0000db70: 6f6e 2229 2061 7320 5f65 783a 0a20 2020  on") as _ex:.   
-0000db80: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0000db90: 4442 2e63 6865 636b 4361 7365 496e 7365  DB.checkCaseInse
-0000dba0: 6e73 6974 6976 6542 6962 6b65 7928 290a  nsitiveBibkey().
-0000dbb0: 2020 2020 2020 2020 2020 2020 5f63 7572              _cur
-0000dbc0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-0000dbd0: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
-0000dbe0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0000dbf0: 4244 422c 0a20 2020 2020 2020 2020 2020  BDB,.           
-0000dc00: 2020 2020 2022 5345 4c45 4354 2073 716c       "SELECT sql
-0000dc10: 2046 524f 4d20 7371 6c69 7465 5f6d 6173   FROM sqlite_mas
-0000dc20: 7465 7220 5748 4552 4520 7479 7065 3d27  ter WHERE type='
-0000dc30: 7461 626c 6527 2022 0a20 2020 2020 2020  table' ".       
-0000dc40: 2020 2020 2020 2020 202b 2022 414e 4420           + "AND 
-0000dc50: 7462 6c5f 6e61 6d65 3d27 656e 7472 6965  tbl_name='entrie
-0000dc60: 7327 222c 0a20 2020 2020 2020 2020 2020  s'",.           
-0000dc70: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0000dc80: 6578 2e61 7373 6572 745f 6361 6c6c 6564  ex.assert_called
-0000dc90: 5f6f 6e63 655f 7769 7468 2822 496d 706f  _once_with("Impo
-0000dca0: 7373 6962 6c65 2074 6f20 7265 6164 2063  ssible to read c
-0000dcb0: 7265 6174 6520 7461 626c 6520 666f 7220  reate table for 
-0000dcc0: 2765 6e74 7269 6573 2722 290a 2020 2020  'entries'").    
-0000dcd0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0000dce0: 422e 6375 7273 2e66 6574 6368 616c 6c2e  B.curs.fetchall.
-0000dcf0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-0000dd00: 6365 5f77 6974 6828 290a 2020 2020 2020  ce_with().      
-0000dd10: 2020 7365 6c66 2e70 4244 422e 6375 7273    self.pBDB.curs
-0000dd20: 2e66 6574 6368 616c 6c2e 7265 7475 726e  .fetchall.return
-0000dd30: 5f76 616c 7565 203d 205b 2822 6162 6365  _value = [("abce
-0000dd40: 6422 2c29 5d0a 2020 2020 2020 2020 7769  d",)].        wi
-0000dd50: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-0000dd60: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0000dd70: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
-0000dd80: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
-0000dd90: 6375 7273 4578 6563 222c 2061 7574 6f73  cursExec", autos
-0000dda0: 7065 633d 5472 7565 0a20 2020 2020 2020  pec=True.       
-0000ddb0: 2029 2061 7320 5f63 7572 2c20 7061 7463   ) as _cur, patc
-0000ddc0: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
-0000ddd0: 722e 6465 6275 6722 2920 6173 205f 6462  r.debug") as _db
-0000dde0: 673a 0a20 2020 2020 2020 2020 2020 2073  g:.            s
-0000ddf0: 656c 662e 7042 4442 2e63 6865 636b 4361  elf.pBDB.checkCa
-0000de00: 7365 496e 7365 6e73 6974 6976 6542 6962  seInsensitiveBib
-0000de10: 6b65 7928 290a 2020 2020 2020 2020 2020  key().          
-0000de20: 2020 5f63 7572 2e61 7373 6572 745f 6361    _cur.assert_ca
-0000de30: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
-0000de40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de50: 7365 6c66 2e70 4244 422c 0a20 2020 2020  self.pBDB,.     
-0000de60: 2020 2020 2020 2020 2020 2022 5345 4c45             "SELE
-0000de70: 4354 2073 716c 2046 524f 4d20 7371 6c69  CT sql FROM sqli
-0000de80: 7465 5f6d 6173 7465 7220 5748 4552 4520  te_master WHERE 
-0000de90: 7479 7065 3d27 7461 626c 6527 2022 0a20  type='table' ". 
-0000dea0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0000deb0: 2022 414e 4420 7462 6c5f 6e61 6d65 3d27   "AND tbl_name='
-0000dec0: 656e 7472 6965 7327 222c 0a20 2020 2020  entries'",.     
-0000ded0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000dee0: 2020 2020 205f 6462 672e 6173 7365 7274       _dbg.assert
-0000def0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-0000df00: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
-0000df10: 2020 2022 2762 6962 6b65 7927 2077 6173     "'bibkey' was
-0000df20: 206e 6f74 2063 7265 6174 6564 2077 6974   not created wit
-0000df30: 686f 7574 2027 636f 6c6c 6174 6520 6e6f  hout 'collate no
-0000df40: 6361 7365 272e 220a 2020 2020 2020 2020  case'.".        
-0000df50: 2020 2020 2020 2020 2b20 2220 4e6f 7468          + " Noth
-0000df60: 696e 6720 746f 2064 6f20 6865 7265 2e22  ing to do here."
-0000df70: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000df80: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0000df90: 2e63 7572 732e 6665 7463 6861 6c6c 2e72  .curs.fetchall.r
-0000dfa0: 6574 7572 6e5f 7661 6c75 6520 3d20 5b0a  eturn_value = [.
-0000dfb0: 2020 2020 2020 2020 2020 2020 2822 5c6e              ("\n
-0000dfc0: 6269 626b 6579 2074 6578 7420 7072 696d  bibkey text prim
-0000dfd0: 6172 7920 6b65 7920 6e6f 7420 6e75 6c6c  ary key not null
-0000dfe0: 2c5c 6e22 2c29 0a20 2020 2020 2020 205d  ,\n",).        ]
-0000dff0: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-0000e000: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
-0000e010: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
-0000e020: 6162 6173 6543 6f72 652e 5068 7973 4269  abaseCore.PhysBi
-0000e030: 626c 696f 4442 436f 7265 2e63 7572 7345  blioDBCore.cursE
-0000e040: 7865 6322 2c20 6175 746f 7370 6563 3d54  xec", autospec=T
-0000e050: 7275 650a 2020 2020 2020 2020 2920 6173  rue.        ) as
-0000e060: 205f 6375 722c 2070 6174 6368 280a 2020   _cur, patch(.  
-0000e070: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-0000e080: 6962 6c69 6f2e 6461 7461 6261 7365 436f  iblio.databaseCo
-0000e090: 7265 2e50 6879 7342 6962 6c69 6f44 4243  re.PhysBiblioDBC
-0000e0a0: 6f72 652e 636f 6e6e 4578 6563 222c 0a20  ore.connExec",. 
-0000e0b0: 2020 2020 2020 2020 2020 2061 7574 6f73             autos
-0000e0c0: 7065 633d 5472 7565 2c0a 2020 2020 2020  pec=True,.      
-0000e0d0: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
-0000e0e0: 7565 3d46 616c 7365 2c0a 2020 2020 2020  ue=False,.      
-0000e0f0: 2020 2920 6173 205f 636f 6e2c 2070 6174    ) as _con, pat
-0000e100: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-0000e110: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-0000e120: 696e 666f 220a 2020 2020 2020 2020 2920  info".        ) 
-0000e130: 6173 205f 696e 2c20 7061 7463 6828 0a20  as _in, patch(. 
-0000e140: 2020 2020 2020 2020 2020 2022 6c6f 6767             "logg
-0000e150: 696e 672e 4c6f 6767 6572 2e65 7863 6570  ing.Logger.excep
-0000e160: 7469 6f6e 220a 2020 2020 2020 2020 2920  tion".        ) 
-0000e170: 6173 205f 6578 2c20 7061 7463 6828 0a20  as _ex, patch(. 
-0000e180: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
-0000e190: 6269 626c 696f 2e64 6174 6162 6173 6543  biblio.databaseC
-0000e1a0: 6f72 652e 5068 7973 4269 626c 696f 4442  ore.PhysBiblioDB
-0000e1b0: 436f 7265 2e75 6e64 6f22 2c20 6175 746f  Core.undo", auto
-0000e1c0: 7370 6563 3d54 7275 650a 2020 2020 2020  spec=True.      
-0000e1d0: 2020 2920 6173 205f 756e 3a0a 2020 2020    ) as _un:.    
-0000e1e0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0000e1f0: 422e 6368 6563 6b43 6173 6549 6e73 656e  B.checkCaseInsen
-0000e200: 7369 7469 7665 4269 626b 6579 2829 0a20  sitiveBibkey(). 
-0000e210: 2020 2020 2020 2020 2020 205f 6375 722e             _cur.
-0000e220: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-0000e230: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
-0000e240: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0000e250: 4442 2c0a 2020 2020 2020 2020 2020 2020  DB,.            
-0000e260: 2020 2020 2253 454c 4543 5420 7371 6c20      "SELECT sql 
-0000e270: 4652 4f4d 2073 716c 6974 655f 6d61 7374  FROM sqlite_mast
-0000e280: 6572 2057 4845 5245 2074 7970 653d 2774  er WHERE type='t
-0000e290: 6162 6c65 2720 220a 2020 2020 2020 2020  able' ".        
-0000e2a0: 2020 2020 2020 2020 2b20 2241 4e44 2074          + "AND t
-0000e2b0: 626c 5f6e 616d 653d 2765 6e74 7269 6573  bl_name='entries
-0000e2c0: 2722 2c0a 2020 2020 2020 2020 2020 2020  '",.            
-0000e2d0: 290a 2020 2020 2020 2020 2020 2020 5f63  ).            _c
-0000e2e0: 6f6e 2e61 7373 6572 745f 6361 6c6c 6564  on.assert_called
-0000e2f0: 5f6f 6e63 655f 7769 7468 2873 656c 662e  _once_with(self.
-0000e300: 7042 4442 2c20 2242 4547 494e 2054 5241  pBDB, "BEGIN TRA
-0000e310: 4e53 4143 5449 4f4e 3b22 290a 2020 2020  NSACTION;").    
-0000e320: 2020 2020 2020 2020 5f69 6e2e 6173 7365          _in.asse
-0000e330: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-0000e340: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
-0000e350: 2020 2020 2022 5065 7266 6f72 6d69 6e67       "Performing
-0000e360: 2063 6f6e 7665 7273 696f 6e20 6f66 2027   conversion of '
-0000e370: 656e 7472 6965 7327 2074 6162 6c65 2074  entries' table t
-0000e380: 6f20 6361 7365 2d69 6e73 656e 7369 7469  o case-insensiti
-0000e390: 7665 206b 6579 220a 2020 2020 2020 2020  ve key".        
-0000e3a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000e3b0: 2020 5f65 782e 6173 7365 7274 5f63 616c    _ex.assert_cal
-0000e3c0: 6c65 645f 6f6e 6365 5f77 6974 6828 2249  led_once_with("I
-0000e3d0: 6d70 6f73 7369 626c 6520 746f 2072 656e  mpossible to ren
-0000e3e0: 616d 6520 7461 626c 6520 2765 6e74 7269  ame table 'entri
-0000e3f0: 6573 2722 290a 2020 2020 2020 2020 2020  es'").          
-0000e400: 2020 5f75 6e2e 6173 7365 7274 5f63 616c    _un.assert_cal
-0000e410: 6c65 645f 6f6e 6365 5f77 6974 6828 7365  led_once_with(se
-0000e420: 6c66 2e70 4244 4229 0a20 2020 2020 2020  lf.pBDB).       
-0000e430: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
-0000e440: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
-0000e450: 626c 696f 2e64 6174 6162 6173 6543 6f72  blio.databaseCor
-0000e460: 652e 5068 7973 4269 626c 696f 4442 436f  e.PhysBiblioDBCo
-0000e470: 7265 2e63 7572 7345 7865 6322 2c20 6175  re.cursExec", au
-0000e480: 746f 7370 6563 3d54 7275 650a 2020 2020  tospec=True.    
-0000e490: 2020 2020 2920 6173 205f 6375 722c 2070      ) as _cur, p
-0000e4a0: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000e4b0: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-0000e4c0: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
-0000e4d0: 6962 6c69 6f44 4243 6f72 652e 636f 6e6e  iblioDBCore.conn
-0000e4e0: 4578 6563 222c 0a20 2020 2020 2020 2020  Exec",.         
-0000e4f0: 2020 2061 7574 6f73 7065 633d 5472 7565     autospec=True
-0000e500: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-0000e510: 7475 726e 5f76 616c 7565 3d54 7275 652c  turn_value=True,
-0000e520: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
-0000e530: 6f6e 2c20 7061 7463 6828 0a20 2020 2020  on, patch(.     
-0000e540: 2020 2020 2020 2022 6c6f 6767 696e 672e         "logging.
-0000e550: 4c6f 6767 6572 2e69 6e66 6f22 0a20 2020  Logger.info".   
-0000e560: 2020 2020 2029 2061 7320 5f69 6e2c 2070       ) as _in, p
-0000e570: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000e580: 2020 226c 6f67 6769 6e67 2e4c 6f67 6765    "logging.Logge
-0000e590: 722e 6578 6365 7074 696f 6e22 0a20 2020  r.exception".   
-0000e5a0: 2020 2020 2029 2061 7320 5f65 782c 2070       ) as _ex, p
-0000e5b0: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-0000e5c0: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-0000e5d0: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
-0000e5e0: 6962 6c69 6f44 4243 6f72 652e 6372 6561  iblioDBCore.crea
-0000e5f0: 7465 5461 626c 6522 2c20 6175 746f 7370  teTable", autosp
-0000e600: 6563 3d54 7275 650a 2020 2020 2020 2020  ec=True.        
-0000e610: 2920 6173 205f 6374 2c20 7061 7463 6828  ) as _ct, patch(
-0000e620: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-0000e630: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-0000e640: 6543 6f72 652e 5068 7973 4269 626c 696f  eCore.PhysBiblio
-0000e650: 4442 436f 7265 2e63 6f6d 6d69 7422 2c20  DBCore.commit", 
-0000e660: 6175 746f 7370 6563 3d54 7275 650a 2020  autospec=True.  
-0000e670: 2020 2020 2020 2920 6173 205f 636f 6d2c        ) as _com,
-0000e680: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-0000e690: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-0000e6a0: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
-0000e6b0: 7342 6962 6c69 6f44 4243 6f72 652e 756e  sBiblioDBCore.un
-0000e6c0: 646f 222c 2061 7574 6f73 7065 633d 5472  do", autospec=Tr
-0000e6d0: 7565 0a20 2020 2020 2020 2029 2061 7320  ue.        ) as 
-0000e6e0: 5f75 6e3a 0a20 2020 2020 2020 2020 2020  _un:.           
-0000e6f0: 2073 656c 662e 7042 4442 2e63 6865 636b   self.pBDB.check
-0000e700: 4361 7365 496e 7365 6e73 6974 6976 6542  CaseInsensitiveB
-0000e710: 6962 6b65 7928 290a 2020 2020 2020 2020  ibkey().        
-0000e720: 2020 2020 5f63 7572 2e61 7373 6572 745f      _cur.assert_
-0000e730: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-0000e740: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000e750: 2020 7365 6c66 2e70 4244 422c 0a20 2020    self.pBDB,.   
-0000e760: 2020 2020 2020 2020 2020 2020 2022 5345               "SE
-0000e770: 4c45 4354 2073 716c 2046 524f 4d20 7371  LECT sql FROM sq
-0000e780: 6c69 7465 5f6d 6173 7465 7220 5748 4552  lite_master WHER
-0000e790: 4520 7479 7065 3d27 7461 626c 6527 2022  E type='table' "
-0000e7a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e7b0: 202b 2022 414e 4420 7462 6c5f 6e61 6d65   + "AND tbl_name
-0000e7c0: 3d27 656e 7472 6965 7327 222c 0a20 2020  ='entries'",.   
-0000e7d0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000e7e0: 2020 2020 2020 205f 6374 2e61 7373 6572         _ct.asser
-0000e7f0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-0000e800: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
-0000e810: 2020 2020 7365 6c66 2e70 4244 422c 2022      self.pBDB, "
-0000e820: 656e 7472 6965 7322 2c20 7365 6c66 2e70  entries", self.p
-0000e830: 4244 422e 7461 626c 6546 6965 6c64 735b  BDB.tableFields[
-0000e840: 2265 6e74 7269 6573 225d 0a20 2020 2020  "entries"].     
-0000e850: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000e860: 2020 2020 205f 636f 6e2e 6173 7365 7274       _con.assert
-0000e870: 5f68 6173 5f63 616c 6c73 280a 2020 2020  _has_calls(.    
-0000e880: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0000e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8a0: 2020 6361 6c6c 2873 656c 662e 7042 4442    call(self.pBDB
-0000e8b0: 2c20 2242 4547 494e 2054 5241 4e53 4143  , "BEGIN TRANSAC
-0000e8c0: 5449 4f4e 3b22 292c 0a20 2020 2020 2020  TION;"),.       
-0000e8d0: 2020 2020 2020 2020 2020 2020 2063 616c               cal
-0000e8e0: 6c28 7365 6c66 2e70 4244 422c 2022 414c  l(self.pBDB, "AL
-0000e8f0: 5445 5220 5441 424c 4520 656e 7472 6965  TER TABLE entrie
-0000e900: 7320 5245 4e41 4d45 2054 4f20 746d 705f  s RENAME TO tmp_
-0000e910: 656e 7472 6965 733b 2229 2c0a 2020 2020  entries;"),.    
+00006400: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00006410: 6c28 6c65 6e28 7365 6c66 2e70 4244 422e  l(len(self.pBDB.
+00006420: 6361 7473 2e67 6574 416c 6c28 2929 2c20  cats.getAll()), 
+00006430: 3329 0a20 2020 2020 2020 2073 656c 662e  3).        self.
+00006440: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
+00006450: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00006460: 422e 636f 6e6e 4578 6563 280a 2020 2020  B.connExec(.    
+00006470: 2020 2020 2020 2020 2020 2020 2222 220a              """.
+00006480: 2020 2020 2020 2020 2020 2020 494e 5345              INSE
+00006490: 5254 2069 6e74 6f20 6361 7465 676f 7269  RT into categori
+000064a0: 6573 2028 6e61 6d65 2c20 6465 7363 7269  es (name, descri
+000064b0: 7074 696f 6e2c 2070 6172 656e 7443 6174  ption, parentCat
+000064c0: 2c20 636f 6d6d 656e 7473 2c20 6f72 6429  , comments, ord)
+000064d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000064e0: 2076 616c 7565 7320 283a 6e61 6d65 2c20   values (:name, 
+000064f0: 3a64 6573 6372 6970 7469 6f6e 2c20 3a70  :description, :p
+00006500: 6172 656e 7443 6174 2c20 3a63 6f6d 6d65  arentCat, :comme
+00006510: 6e74 732c 203a 6f72 6429 0a20 2020 2020  nts, :ord).     
+00006520: 2020 2020 2020 2022 2222 2c0a 2020 2020         """,.    
+00006530: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00006540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006550: 2020 226e 616d 6522 3a20 2261 6263 6422    "name": "abcd"
+00006560: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006570: 2020 2020 2020 2264 6573 6372 6970 7469        "descripti
+00006580: 6f6e 223a 2022 6522 2c0a 2020 2020 2020  on": "e",.      
+00006590: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+000065a0: 6172 656e 7443 6174 223a 2030 2c0a 2020  arentCat": 0,.  
+000065b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000065c0: 2020 2263 6f6d 6d65 6e74 7322 3a20 2222    "comments": ""
+000065d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000065e0: 2020 2020 2020 226f 7264 223a 2030 2c0a        "ord": 0,.
+000065f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006600: 7d2c 0a20 2020 2020 2020 2020 2020 2029  },.            )
+00006610: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00006620: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00006630: 7561 6c28 6c65 6e28 7365 6c66 2e70 4244  ual(len(self.pBD
+00006640: 422e 6361 7473 2e67 6574 416c 6c28 2929  B.cats.getAll())
+00006650: 2c20 3429 0a20 2020 2020 2020 2073 656c  , 4).        sel
+00006660: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
+00006670: 6c66 2e70 4244 422e 6375 7273 4578 6563  lf.pBDB.cursExec
+00006680: 2822 5345 4c45 4354 202a 2066 726f 6d20  ("SELECT * from 
+00006690: 6361 7465 676f 7269 6573 2077 6865 7265  categories where
+000066a0: 2022 2929 0a20 2020 2020 2020 2073 656c   ")).        sel
+000066b0: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
+000066c0: 6e28 7365 6c66 2e70 4244 422e 6361 7473  n(self.pBDB.cats
+000066d0: 2e67 6574 416c 6c28 2929 2c20 3429 0a20  .getAll()), 4). 
+000066e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000066f0: 7274 4661 6c73 6528 0a20 2020 2020 2020  rtFalse(.       
+00006700: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
+00006710: 6f6e 6e45 7865 6328 0a20 2020 2020 2020  onnExec(.       
+00006720: 2020 2020 2020 2020 2022 2222 0a20 2020           """.   
+00006730: 2020 2020 2020 2020 2049 4e53 4552 5420           INSERT 
+00006740: 696e 746f 2063 6174 6567 6f72 6965 7320  into categories 
+00006750: 286e 616d 652c 2064 6573 6372 6970 7469  (name, descripti
+00006760: 6f6e 2c20 7061 7265 6e74 4361 742c 2063  on, parentCat, c
+00006770: 6f6d 6d65 6e74 732c 206f 7264 290a 2020  omments, ord).  
+00006780: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00006790: 6c75 6573 2028 3a6e 616d 652c 203a 6465  lues (:name, :de
+000067a0: 7363 7269 7074 696f 6e2c 203a 7061 7265  scription, :pare
+000067b0: 6e74 4361 742c 203a 636f 6d6d 656e 7473  ntCat, :comments
+000067c0: 2c20 3a6f 7264 290a 2020 2020 2020 2020  , :ord).        
+000067d0: 2020 2020 2222 222c 0a20 2020 2020 2020      """,.       
+000067e0: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
+000067f0: 3a20 2261 6263 6422 2c20 2264 6573 6372  : "abcd", "descr
+00006800: 6970 7469 6f6e 223a 2022 6522 2c20 2270  iption": "e", "p
+00006810: 6172 656e 7443 6174 223a 2030 2c20 2263  arentCat": 0, "c
+00006820: 6f6d 6d65 6e74 7322 3a20 2222 7d2c 0a20  omments": ""},. 
+00006830: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00006840: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00006850: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00006860: 6c65 6e28 7365 6c66 2e70 4244 422e 6361  len(self.pBDB.ca
+00006870: 7473 2e67 6574 416c 6c28 2929 2c20 3429  ts.getAll()), 4)
+00006880: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00006890: 7365 7274 5261 6973 6573 2841 7474 7269  sertRaises(Attri
+000068a0: 6275 7465 4572 726f 722c 206c 616d 6264  buteError, lambd
+000068b0: 613a 2073 656c 662e 7042 4442 2e73 7461  a: self.pBDB.sta
+000068c0: 7473 290a 2020 2020 2020 2020 6462 5374  ts).        dbSt
+000068d0: 6174 7328 7365 6c66 2e70 4244 4229 0a20  ats(self.pBDB). 
+000068e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000068f0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00006900: 2020 2020 2073 656c 662e 7042 4442 2e73       self.pBDB.s
+00006910: 7461 7473 2c0a 2020 2020 2020 2020 2020  tats,.          
+00006920: 2020 7b22 6269 6273 223a 2030 2c20 2263    {"bibs": 0, "c
+00006930: 6174 7322 3a20 342c 2022 6578 7073 223a  ats": 4, "exps":
+00006940: 2030 2c20 2263 6174 4269 6222 3a20 302c   0, "catBib": 0,
+00006950: 2022 6361 7445 7870 223a 2030 2c20 2262   "catExp": 0, "b
+00006960: 6962 4578 7022 3a20 307d 2c0a 2020 2020  ibExp": 0},.    
+00006970: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00006980: 6c66 2e70 4244 422e 6361 7473 2e64 656c  lf.pBDB.cats.del
+00006990: 6574 6528 5b32 2c20 335d 290a 2020 2020  ete([2, 3]).    
+000069a0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000069b0: 7175 616c 286c 656e 2873 656c 662e 7042  qual(len(self.pB
+000069c0: 4442 2e63 6174 732e 6765 7441 6c6c 2829  DB.cats.getAll()
+000069d0: 292c 2032 290a 2020 2020 2020 2020 7365  ), 2).        se
+000069e0: 6c66 2e70 4244 422e 636f 6d6d 6974 2829  lf.pBDB.commit()
+000069f0: 0a0a 2020 2020 6465 6620 7465 7374 5f6c  ..    def test_l
+00006a00: 6974 6572 616c 5f65 7661 6c28 7365 6c66  iteral_eval(self
+00006a10: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
+00006a20: 2020 2222 2254 6573 7420 6c69 7465 7261    """Test litera
+00006a30: 6c5f 6576 616c 2069 6e20 5068 7973 4269  l_eval in PhysBi
+00006a40: 626c 696f 4442 5375 6222 2222 0a20 2020  blioDBSub""".   
+00006a50: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00006a60: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+00006a70: 6361 7473 2e6c 6974 6572 616c 5f65 7661  cats.literal_eva
+00006a80: 6c28 225b 312c 325d 2229 2c20 5b31 2c20  l("[1,2]"), [1, 
+00006a90: 325d 290a 2020 2020 2020 2020 7365 6c66  2]).        self
+00006aa0: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
+00006ab0: 662e 7042 4442 2e63 6174 732e 6c69 7465  f.pBDB.cats.lite
+00006ac0: 7261 6c5f 6576 616c 2822 5b27 7465 7374  ral_eval("['test
+00006ad0: 272c 2761 275d 2229 2c20 5b22 7465 7374  ','a']"), ["test
+00006ae0: 222c 2022 6122 5d29 0a20 2020 2020 2020  ", "a"]).       
+00006af0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00006b00: 6c28 7365 6c66 2e70 4244 422e 6361 7473  l(self.pBDB.cats
+00006b10: 2e6c 6974 6572 616c 5f65 7661 6c28 2227  .literal_eval("'
+00006b20: 7465 7374 2062 2722 292c 2022 2774 6573  test b'"), "'tes
+00006b30: 7420 6227 2229 0a20 2020 2020 2020 2073  t b'").        s
+00006b40: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00006b50: 7365 6c66 2e70 4244 422e 6361 7473 2e6c  self.pBDB.cats.l
+00006b60: 6974 6572 616c 5f65 7661 6c28 2274 6573  iteral_eval("tes
+00006b70: 7420 6322 292c 2022 7465 7374 2063 2229  t c"), "test c")
+00006b80: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00006b90: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00006ba0: 4244 422e 6361 7473 2e6c 6974 6572 616c  BDB.cats.literal
+00006bb0: 5f65 7661 6c28 2722 7465 7374 2064 2227  _eval('"test d"'
+00006bc0: 292c 2027 2274 6573 7420 6422 2729 0a20  ), '"test d"'). 
+00006bd0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00006be0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+00006bf0: 422e 6361 7473 2e6c 6974 6572 616c 5f65  B.cats.literal_e
+00006c00: 7661 6c28 225b 7465 7374 2065 2229 2c20  val("[test e"), 
+00006c10: 225b 7465 7374 2065 2229 0a20 2020 2020  "[test e").     
+00006c20: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00006c30: 7561 6c28 7365 6c66 2e70 4244 422e 6361  ual(self.pBDB.ca
+00006c40: 7473 2e6c 6974 6572 616c 5f65 7661 6c28  ts.literal_eval(
+00006c50: 225b 7465 7374 2066 5d22 292c 204e 6f6e  "[test f]"), Non
+00006c60: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+00006c70: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00006c80: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00006c90: 4442 2e63 6174 732e 6c69 7465 7261 6c5f  DB.cats.literal_
+00006ca0: 6576 616c 2822 2774 6573 7420 6727 2c27  eval("'test g','
+00006cb0: 7465 7374 2068 2722 292c 205b 2274 6573  test h'"), ["tes
+00006cc0: 7420 6722 2c20 2274 6573 7420 6822 5d0a  t g", "test h"].
+00006cd0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00006ce0: 2020 7769 7468 2070 6174 6368 280a 2020    with patch(.  
+00006cf0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
+00006d00: 6962 6c69 6f2e 6461 7461 6261 7365 436f  iblio.databaseCo
+00006d10: 7265 2e50 6879 7342 6962 6c69 6f44 4243  re.PhysBiblioDBC
+00006d20: 6f72 652e 7365 6e64 4442 4973 4c6f 636b  ore.sendDBIsLock
+00006d30: 6564 222c 2061 7574 6f73 7065 633d 5472  ed", autospec=Tr
+00006d40: 7565 0a20 2020 2020 2020 2029 2061 7320  ue.        ) as 
+00006d50: 5f73 3a0a 2020 2020 2020 2020 2020 2020  _s:.            
+00006d60: 7365 6c66 2e70 4244 422e 6361 7473 2e6d  self.pBDB.cats.m
+00006d70: 6169 6e44 422e 7365 6e64 4442 4973 4c6f  ainDB.sendDBIsLo
+00006d80: 636b 6564 2829 0a20 2020 2020 2020 2020  cked().         
+00006d90: 2020 205f 732e 6173 7365 7274 5f63 616c     _s.assert_cal
+00006da0: 6c65 645f 6f6e 6365 5f77 6974 6828 7365  led_once_with(se
+00006db0: 6c66 2e70 4244 422e 6361 7473 2e6d 6169  lf.pBDB.cats.mai
+00006dc0: 6e44 4229 0a0a 2020 2020 6465 6620 7465  nDB)..    def te
+00006dd0: 7374 5f69 6e69 7428 7365 6c66 2c20 2a61  st_init(self, *a
+00006de0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+00006df0: 2274 6573 7420 696e 6974 2222 220a 2020  "test init""".  
+00006e00: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+00006e10: 2822 6f73 2e70 6174 682e 6578 6973 7473  ("os.path.exists
+00006e20: 222c 2072 6574 7572 6e5f 7661 6c75 653d  ", return_value=
+00006e30: 5472 7565 2920 6173 205f 652c 2070 6174  True) as _e, pat
+00006e40: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+00006e50: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+00006e60: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
+00006e70: 6c69 6f44 4243 6f72 652e 6c6f 6164 5375  lioDBCore.loadSu
+00006e80: 6243 6c61 7373 6573 222c 2061 7574 6f73  bClasses", autos
+00006e90: 7065 633d 5472 7565 0a20 2020 2020 2020  pec=True.       
+00006ea0: 2029 2061 7320 5f6c 7363 2c20 7061 7463   ) as _lsc, patc
+00006eb0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+00006ec0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
+00006ed0: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
+00006ee0: 696f 4442 436f 7265 2e6f 7065 6e44 4222  ioDBCore.openDB"
+00006ef0: 2c20 6175 746f 7370 6563 3d54 7275 650a  , autospec=True.
+00006f00: 2020 2020 2020 2020 2920 6173 205f 6f3a          ) as _o:
+00006f10: 0a20 2020 2020 2020 2020 2020 2064 6263  .            dbc
+00006f20: 203d 2050 6879 7342 6962 6c69 6f44 4243   = PhysBiblioDBC
+00006f30: 6f72 6528 7465 6d70 4442 4e61 6d65 2c20  ore(tempDBName, 
+00006f40: 7042 4c6f 6767 6572 2c20 6e6f 4f70 656e  pBLogger, noOpen
+00006f50: 3d54 7275 652c 2069 6e66 6f3d 4661 6c73  =True, info=Fals
+00006f60: 6529 0a20 2020 2020 2020 2020 2020 205f  e).            _
+00006f70: 652e 6173 7365 7274 5f63 616c 6c65 645f  e.assert_called_
+00006f80: 6f6e 6365 5f77 6974 6828 7465 6d70 4442  once_with(tempDB
+00006f90: 4e61 6d65 290a 2020 2020 2020 2020 2020  Name).          
+00006fa0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00006fb0: 616c 285f 6f2e 6361 6c6c 5f63 6f75 6e74  al(_o.call_count
+00006fc0: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+00006fd0: 205f 6c73 632e 6173 7365 7274 5f63 616c   _lsc.assert_cal
+00006fe0: 6c65 645f 6f6e 6365 5f77 6974 6828 6462  led_once_with(db
+00006ff0: 6329 0a20 2020 2020 2020 2073 656c 662e  c).        self.
+00007000: 6173 7365 7274 4571 7561 6c28 6462 632e  assertEqual(dbc.
+00007010: 7461 626c 6546 6965 6c64 732c 2070 6879  tableFields, phy
+00007020: 7362 6962 6c69 6f2e 7461 626c 6573 4465  sbiblio.tablesDe
+00007030: 662e 7461 626c 6546 6965 6c64 7329 0a20  f.tableFields). 
+00007040: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00007050: 7274 4571 7561 6c28 6462 632e 6465 7363  rtEqual(dbc.desc
+00007060: 7269 7074 696f 6e73 2c20 7068 7973 6269  riptions, physbi
+00007070: 626c 696f 2e74 6162 6c65 7344 6566 2e66  blio.tablesDef.f
+00007080: 6965 6c64 7344 6573 6372 6970 7469 6f6e  ieldsDescription
+00007090: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
+000070a0: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
+000070b0: 2864 6263 2e74 6162 6c65 436f 6c73 2c20  (dbc.tableCols, 
+000070c0: 6469 6374 290a 2020 2020 2020 2020 7365  dict).        se
+000070d0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+000070e0: 2020 2020 2020 2020 2020 2020 6462 632e              dbc.
+000070f0: 7461 626c 6543 6f6c 732c 0a20 2020 2020  tableCols,.     
+00007100: 2020 2020 2020 207b 713a 205b 615b 305d         {q: [a[0]
+00007110: 2066 6f72 2061 2069 6e20 6462 632e 7461   for a in dbc.ta
+00007120: 626c 6546 6965 6c64 735b 715d 5d20 666f  bleFields[q]] fo
+00007130: 7220 7120 696e 2064 6263 2e74 6162 6c65  r q in dbc.table
+00007140: 4669 656c 6473 2e6b 6579 7328 297d 2c0a  Fields.keys()},.
+00007150: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00007160: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00007170: 616c 2864 6263 2e64 6243 6861 6e67 6564  al(dbc.dbChanged
+00007180: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+00007190: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000071a0: 6c28 6462 632e 636f 6e6e 2c20 4e6f 6e65  l(dbc.conn, None
+000071b0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000071c0: 7373 6572 7445 7175 616c 2864 6263 2e63  ssertEqual(dbc.c
+000071d0: 7572 732c 204e 6f6e 6529 0a20 2020 2020  urs, None).     
+000071e0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+000071f0: 7561 6c28 6462 632e 6f6e 4973 4c6f 636b  ual(dbc.onIsLock
+00007200: 6564 2c20 4e6f 6e65 290a 2020 2020 2020  ed, None).      
+00007210: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00007220: 616c 2864 6263 2e64 626e 616d 652c 2074  al(dbc.dbname, t
+00007230: 656d 7044 424e 616d 6529 0a20 2020 2020  empDBName).     
+00007240: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00007250: 7561 6c28 6462 632e 6c6f 6767 6572 2c20  ual(dbc.logger, 
+00007260: 7042 4c6f 6767 6572 290a 2020 2020 2020  pBLogger).      
+00007270: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00007280: 616c 2864 6263 2e6c 6173 7446 6574 6368  al(dbc.lastFetch
+00007290: 6564 2c20 4e6f 6e65 290a 2020 2020 2020  ed, None).      
+000072a0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000072b0: 616c 2864 6263 2e63 6174 7348 6965 722c  al(dbc.catsHier,
+000072c0: 204e 6f6e 6529 0a0a 2020 2020 2020 2020   None)..        
+000072d0: 7769 7468 2070 6174 6368 2822 6f73 2e70  with patch("os.p
+000072e0: 6174 682e 6578 6973 7473 222c 2072 6574  ath.exists", ret
+000072f0: 7572 6e5f 7661 6c75 653d 5472 7565 2920  urn_value=True) 
+00007300: 6173 205f 652c 2070 6174 6368 280a 2020  as _e, patch(.  
+00007310: 2020 2020 2020 2020 2020 226c 6f67 6769            "loggi
+00007320: 6e67 2e4c 6f67 6765 722e 696e 666f 220a  ng.Logger.info".
+00007330: 2020 2020 2020 2020 2920 6173 205f 692c          ) as _i,
+00007340: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+00007350: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+00007360: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
+00007370: 7342 6962 6c69 6f44 4243 6f72 652e 6368  sBiblioDBCore.ch
+00007380: 6563 6b45 7869 7374 696e 6754 6162 6c65  eckExistingTable
+00007390: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+000073a0: 7265 7475 726e 5f76 616c 7565 3d54 7275  return_value=Tru
+000073b0: 652c 0a20 2020 2020 2020 2020 2020 2061  e,.            a
+000073c0: 7574 6f73 7065 633d 5472 7565 2c0a 2020  utospec=True,.  
+000073d0: 2020 2020 2020 2920 6173 205f 6365 2c20        ) as _ce, 
+000073e0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
+000073f0: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
+00007400: 6174 6162 6173 6543 6f72 652e 5068 7973  atabaseCore.Phys
+00007410: 4269 626c 696f 4442 436f 7265 2e63 7265  BiblioDBCore.cre
+00007420: 6174 6554 6162 6c65 7322 2c20 6175 746f  ateTables", auto
+00007430: 7370 6563 3d54 7275 650a 2020 2020 2020  spec=True.      
+00007440: 2020 2920 6173 205f 6374 2c20 7061 7463    ) as _ct, patc
+00007450: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+00007460: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
+00007470: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
+00007480: 696f 4442 436f 7265 2e63 6865 636b 4461  ioDBCore.checkDa
+00007490: 7461 6261 7365 5570 6461 7465 7322 2c0a  tabaseUpdates",.
+000074a0: 2020 2020 2020 2020 2020 2020 6175 746f              auto
+000074b0: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
+000074c0: 2020 2029 2061 7320 5f63 632c 2070 6174     ) as _cc, pat
+000074d0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+000074e0: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+000074f0: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
+00007500: 6c69 6f44 4243 6f72 652e 6c6f 6164 5375  lioDBCore.loadSu
+00007510: 6243 6c61 7373 6573 222c 2061 7574 6f73  bClasses", autos
+00007520: 7065 633d 5472 7565 0a20 2020 2020 2020  pec=True.       
+00007530: 2029 2061 7320 5f6c 7363 2c20 7061 7463   ) as _lsc, patc
+00007540: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+00007550: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
+00007560: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
+00007570: 696f 4442 436f 7265 2e6f 7065 6e44 4222  ioDBCore.openDB"
+00007580: 2c20 6175 746f 7370 6563 3d54 7275 650a  , autospec=True.
+00007590: 2020 2020 2020 2020 2920 6173 205f 6f3a          ) as _o:
+000075a0: 0a20 2020 2020 2020 2020 2020 2064 6263  .            dbc
+000075b0: 203d 2050 6879 7342 6962 6c69 6f44 4243   = PhysBiblioDBC
+000075c0: 6f72 6528 7465 6d70 4442 4e61 6d65 2c20  ore(tempDBName, 
+000075d0: 7042 4c6f 6767 6572 2c20 6e6f 4f70 656e  pBLogger, noOpen
+000075e0: 3d54 7275 652c 2069 6e66 6f3d 4661 6c73  =True, info=Fals
+000075f0: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
+00007600: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00007610: 5f6f 2e63 616c 6c5f 636f 756e 742c 2030  _o.call_count, 0
+00007620: 290a 2020 2020 2020 2020 2020 2020 5f69  ).            _i
+00007630: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+00007640: 6564 2829 0a20 2020 2020 2020 2020 2020  ed().           
+00007650: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00007660: 6c28 5f63 742e 6361 6c6c 5f63 6f75 6e74  l(_ct.call_count
+00007670: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+00007680: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00007690: 6c28 5f63 652e 6361 6c6c 5f63 6f75 6e74  l(_ce.call_count
+000076a0: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+000076b0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000076c0: 6c28 5f63 632e 6361 6c6c 5f63 6f75 6e74  l(_cc.call_count
+000076d0: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+000076e0: 2064 6263 203d 2050 6879 7342 6962 6c69   dbc = PhysBibli
+000076f0: 6f44 4243 6f72 6528 7465 6d70 4442 4e61  oDBCore(tempDBNa
+00007700: 6d65 2c20 7042 4c6f 6767 6572 2c20 696e  me, pBLogger, in
+00007710: 666f 3d46 616c 7365 290a 2020 2020 2020  fo=False).      
+00007720: 2020 2020 2020 5f6f 2e61 7373 6572 745f        _o.assert_
+00007730: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+00007740: 2864 6263 2c20 696e 666f 3d46 616c 7365  (dbc, info=False
+00007750: 290a 2020 2020 2020 2020 2020 2020 5f69  ).            _i
+00007760: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+00007770: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
+00007780: 2020 2020 2020 2020 2020 222d 2d2d 2d2d            "-----
+00007790: 2d2d 4e65 7720 6461 7461 6261 7365 206f  --New database o
+000077a0: 7220 6d69 7373 696e 6720 7461 626c 6573  r missing tables
+000077b0: 2e5c 6e43 7265 6174 696e 6720 7468 656d  .\nCreating them
+000077c0: 215c 6e5c 6e22 0a20 2020 2020 2020 2020  !\n\n".         
+000077d0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+000077e0: 205f 6374 2e61 7373 6572 745f 6361 6c6c   _ct.assert_call
+000077f0: 6564 5f6f 6e63 655f 7769 7468 2864 6263  ed_once_with(dbc
+00007800: 290a 2020 2020 2020 2020 2020 2020 5f63  ).            _c
+00007810: 652e 6173 7365 7274 5f63 616c 6c65 645f  e.assert_called_
+00007820: 6f6e 6365 5f77 6974 6828 6462 6329 0a20  once_with(dbc). 
+00007830: 2020 2020 2020 2020 2020 205f 6363 2e61             _cc.a
+00007840: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00007850: 655f 7769 7468 2864 6263 290a 0a20 2020  e_with(dbc)..   
+00007860: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+00007870: 226f 732e 7061 7468 2e65 7869 7374 7322  "os.path.exists"
+00007880: 2c20 7265 7475 726e 5f76 616c 7565 3d54  , return_value=T
+00007890: 7275 6529 2061 7320 5f65 2c20 7061 7463  rue) as _e, patc
+000078a0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+000078b0: 6c6f 6767 696e 672e 4c6f 6767 6572 2e69  logging.Logger.i
+000078c0: 6e66 6f22 0a20 2020 2020 2020 2029 2061  nfo".        ) a
+000078d0: 7320 5f69 2c20 7061 7463 6828 0a20 2020  s _i, patch(.   
+000078e0: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+000078f0: 626c 696f 2e64 6174 6162 6173 6543 6f72  blio.databaseCor
+00007900: 652e 5068 7973 4269 626c 696f 4442 436f  e.PhysBiblioDBCo
+00007910: 7265 2e63 6865 636b 4578 6973 7469 6e67  re.checkExisting
+00007920: 5461 626c 6573 222c 0a20 2020 2020 2020  Tables",.       
+00007930: 2020 2020 2072 6574 7572 6e5f 7661 6c75       return_valu
+00007940: 653d 4661 6c73 652c 0a20 2020 2020 2020  e=False,.       
+00007950: 2020 2020 2061 7574 6f73 7065 633d 5472       autospec=Tr
+00007960: 7565 2c0a 2020 2020 2020 2020 2920 6173  ue,.        ) as
+00007970: 205f 6365 2c20 7061 7463 6828 0a20 2020   _ce, patch(.   
+00007980: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+00007990: 626c 696f 2e64 6174 6162 6173 6543 6f72  blio.databaseCor
+000079a0: 652e 5068 7973 4269 626c 696f 4442 436f  e.PhysBiblioDBCo
+000079b0: 7265 2e63 7265 6174 6554 6162 6c65 7322  re.createTables"
+000079c0: 2c20 6175 746f 7370 6563 3d54 7275 650a  , autospec=True.
+000079d0: 2020 2020 2020 2020 2920 6173 205f 6374          ) as _ct
+000079e0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
+000079f0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+00007a00: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
+00007a10: 7973 4269 626c 696f 4442 436f 7265 2e63  ysBiblioDBCore.c
+00007a20: 6865 636b 4461 7461 6261 7365 5570 6461  heckDatabaseUpda
+00007a30: 7465 7322 2c0a 2020 2020 2020 2020 2020  tes",.          
+00007a40: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
+00007a50: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
+00007a60: 632c 2070 6174 6368 280a 2020 2020 2020  c, patch(.      
+00007a70: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
+00007a80: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
+00007a90: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
+00007aa0: 6c6f 6164 5375 6243 6c61 7373 6573 222c  loadSubClasses",
+00007ab0: 2061 7574 6f73 7065 633d 5472 7565 0a20   autospec=True. 
+00007ac0: 2020 2020 2020 2029 2061 7320 5f6c 7363         ) as _lsc
+00007ad0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
+00007ae0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+00007af0: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
+00007b00: 7973 4269 626c 696f 4442 436f 7265 2e6f  ysBiblioDBCore.o
+00007b10: 7065 6e44 4222 2c20 6175 746f 7370 6563  penDB", autospec
+00007b20: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
+00007b30: 6173 205f 6f3a 0a20 2020 2020 2020 2020  as _o:.         
+00007b40: 2020 2064 6263 203d 2050 6879 7342 6962     dbc = PhysBib
+00007b50: 6c69 6f44 4243 6f72 6528 7465 6d70 4442  lioDBCore(tempDB
+00007b60: 4e61 6d65 2c20 7042 4c6f 6767 6572 290a  Name, pBLogger).
+00007b70: 2020 2020 2020 2020 2020 2020 5f6f 2e61              _o.a
+00007b80: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00007b90: 655f 7769 7468 2864 6263 2c20 696e 666f  e_with(dbc, info
+00007ba0: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
+00007bb0: 2020 205f 692e 6173 7365 7274 5f6e 6f74     _i.assert_not
+00007bc0: 5f63 616c 6c65 6428 290a 2020 2020 2020  _called().      
+00007bd0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007be0: 7445 7175 616c 285f 6374 2e63 616c 6c5f  tEqual(_ct.call_
+00007bf0: 636f 756e 742c 2030 290a 2020 2020 2020  count, 0).      
+00007c00: 2020 2020 2020 5f63 652e 6173 7365 7274        _ce.assert
+00007c10: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+00007c20: 6828 6462 6329 0a20 2020 2020 2020 2020  h(dbc).         
+00007c30: 2020 205f 6363 2e61 7373 6572 745f 6361     _cc.assert_ca
+00007c40: 6c6c 6564 5f6f 6e63 655f 7769 7468 2864  lled_once_with(d
+00007c50: 6263 290a 0a20 2020 2020 2020 2073 656c  bc)..        sel
+00007c60: 662e 6173 7365 7274 5472 7565 2868 6173  f.assertTrue(has
+00007c70: 6174 7472 2864 6263 2c20 2272 654f 7065  attr(dbc, "reOpe
+00007c80: 6e44 4222 2929 0a20 2020 2020 2020 2073  nDB")).        s
+00007c90: 656c 662e 6173 7365 7274 5472 7565 2868  elf.assertTrue(h
+00007ca0: 6173 6174 7472 2864 6263 2c20 226c 6f61  asattr(dbc, "loa
+00007cb0: 6453 7562 436c 6173 7365 7322 2929 0a0a  dSubClasses"))..
+00007cc0: 2020 2020 6465 6620 7465 7374 5f6f 7065      def test_ope
+00007cd0: 6e44 4228 7365 6c66 2c20 2a61 7267 7329  nDB(self, *args)
+00007ce0: 3a0a 2020 2020 2020 2020 2222 2274 6573  :.        """tes
+00007cf0: 7420 6f70 656e 4442 2222 220a 2020 2020  t openDB""".    
+00007d00: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+00007d10: 6f73 2e70 6174 682e 6578 6973 7473 222c  os.path.exists",
+00007d20: 2072 6574 7572 6e5f 7661 6c75 653d 5472   return_value=Tr
+00007d30: 7565 2920 6173 205f 652c 2070 6174 6368  ue) as _e, patch
+00007d40: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
+00007d50: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
+00007d60: 7365 436f 7265 2e50 6879 7342 6962 6c69  seCore.PhysBibli
+00007d70: 6f44 4243 6f72 652e 6c6f 6164 5375 6243  oDBCore.loadSubC
+00007d80: 6c61 7373 6573 222c 2061 7574 6f73 7065  lasses", autospe
+00007d90: 633d 5472 7565 0a20 2020 2020 2020 2029  c=True.        )
+00007da0: 2061 7320 5f6c 7363 3a0a 2020 2020 2020   as _lsc:.      
+00007db0: 2020 2020 2020 6462 6320 3d20 5068 7973        dbc = Phys
+00007dc0: 4269 626c 696f 4442 436f 7265 2874 656d  BiblioDBCore(tem
+00007dd0: 7044 424e 616d 652c 2070 424c 6f67 6765  pDBName, pBLogge
+00007de0: 722c 206e 6f4f 7065 6e3d 5472 7565 290a  r, noOpen=True).
+00007df0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00007e00: 6572 7445 7175 616c 2864 6263 2e63 6f6e  ertEqual(dbc.con
+00007e10: 6e2c 204e 6f6e 6529 0a20 2020 2020 2020  n, None).       
+00007e20: 2077 6974 6820 7061 7463 6828 226c 6f67   with patch("log
+00007e30: 6769 6e67 2e4c 6f67 6765 722e 696e 666f  ging.Logger.info
+00007e40: 2229 2061 7320 5f69 2c20 7061 7463 6828  ") as _i, patch(
+00007e50: 2273 716c 6974 6533 2e63 6f6e 6e65 6374  "sqlite3.connect
+00007e60: 2229 2061 7320 5f63 2c20 7061 7463 6828  ") as _c, patch(
+00007e70: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
+00007e80: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
+00007e90: 6543 6f72 652e 5068 7973 4269 626c 696f  eCore.PhysBiblio
+00007ea0: 4442 436f 7265 2e6c 6f61 6453 7562 436c  DBCore.loadSubCl
+00007eb0: 6173 7365 7322 2c20 6175 746f 7370 6563  asses", autospec
+00007ec0: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
+00007ed0: 6173 205f 6c73 633a 0a20 2020 2020 2020  as _lsc:.       
+00007ee0: 2020 2020 2064 6263 2e6f 7065 6e44 4228       dbc.openDB(
+00007ef0: 290a 2020 2020 2020 2020 2020 2020 5f69  ).            _i
+00007f00: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+00007f10: 6e63 655f 7769 7468 2822 4f70 656e 696e  nce_with("Openin
+00007f20: 6720 6461 7461 6261 7365 3a20 2573 2220  g database: %s" 
+00007f30: 2520 7465 6d70 4442 4e61 6d65 290a 2020  % tempDBName).  
+00007f40: 2020 2020 2020 2020 2020 5f63 2e61 7373            _c.ass
+00007f50: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+00007f60: 7769 7468 2874 656d 7044 424e 616d 652c  with(tempDBName,
+00007f70: 2063 6865 636b 5f73 616d 655f 7468 7265   check_same_thre
+00007f80: 6164 3d46 616c 7365 290a 2020 2020 2020  ad=False).      
+00007f90: 2020 2020 2020 5f63 2829 2e63 7572 736f        _c().curso
+00007fa0: 722e 6173 7365 7274 5f63 616c 6c65 645f  r.assert_called_
+00007fb0: 6f6e 6365 5f77 6974 6828 290a 2020 2020  once_with().    
+00007fc0: 2020 2020 2020 2020 5f6c 7363 2e61 7373          _lsc.ass
+00007fd0: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+00007fe0: 7769 7468 2864 6263 290a 2020 2020 2020  with(dbc).      
+00007ff0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00008000: 7445 7175 616c 2864 6263 2e63 6f6e 6e2c  tEqual(dbc.conn,
+00008010: 205f 6328 2929 0a20 2020 2020 2020 2020   _c()).         
+00008020: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00008030: 7561 6c28 6462 632e 636f 6e6e 2e72 6f77  ual(dbc.conn.row
+00008040: 5f66 6163 746f 7279 2c20 7371 6c69 7465  _factory, sqlite
+00008050: 332e 526f 7729 0a20 2020 2020 2020 2020  3.Row).         
+00008060: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00008070: 7561 6c28 6462 632e 6375 7273 2c20 5f63  ual(dbc.curs, _c
+00008080: 2829 2e63 7572 736f 7228 2929 0a20 2020  ().cursor()).   
+00008090: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+000080a0: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
+000080b0: 6465 6275 6722 2920 6173 205f 642c 2070  debug") as _d, p
+000080c0: 6174 6368 2822 7371 6c69 7465 332e 636f  atch("sqlite3.co
+000080d0: 6e6e 6563 7422 2920 6173 205f 632c 2070  nnect") as _c, p
+000080e0: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+000080f0: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
+00008100: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
+00008110: 6962 6c69 6f44 4243 6f72 652e 6c6f 6164  iblioDBCore.load
+00008120: 5375 6243 6c61 7373 6573 222c 2061 7574  SubClasses", aut
+00008130: 6f73 7065 633d 5472 7565 0a20 2020 2020  ospec=True.     
+00008140: 2020 2029 2061 7320 5f6c 7363 3a0a 2020     ) as _lsc:.  
+00008150: 2020 2020 2020 2020 2020 6462 632e 6f70            dbc.op
+00008160: 656e 4442 2869 6e66 6f3d 4661 6c73 6529  enDB(info=False)
+00008170: 0a20 2020 2020 2020 2020 2020 205f 642e  .            _d.
+00008180: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+00008190: 6365 5f77 6974 6828 224f 7065 6e69 6e67  ce_with("Opening
+000081a0: 2064 6174 6162 6173 653a 2025 7322 2025   database: %s" %
+000081b0: 2074 656d 7044 424e 616d 6529 0a20 2020   tempDBName).   
+000081c0: 2020 2020 2020 2020 205f 632e 6173 7365           _c.asse
+000081d0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+000081e0: 6974 6828 7465 6d70 4442 4e61 6d65 2c20  ith(tempDBName, 
+000081f0: 6368 6563 6b5f 7361 6d65 5f74 6872 6561  check_same_threa
+00008200: 643d 4661 6c73 6529 0a20 2020 2020 2020  d=False).       
+00008210: 2020 2020 205f 6328 292e 6375 7273 6f72       _c().cursor
+00008220: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+00008230: 6e63 655f 7769 7468 2829 0a20 2020 2020  nce_with().     
+00008240: 2020 2020 2020 205f 6c73 632e 6173 7365         _lsc.asse
+00008250: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+00008260: 6974 6828 6462 6329 0a20 2020 2020 2020  ith(dbc).       
+00008270: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00008280: 4571 7561 6c28 6462 632e 636f 6e6e 2c20  Equal(dbc.conn, 
+00008290: 5f63 2829 290a 2020 2020 2020 2020 2020  _c()).          
+000082a0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000082b0: 616c 2864 6263 2e63 6f6e 6e2e 726f 775f  al(dbc.conn.row_
+000082c0: 6661 6374 6f72 792c 2073 716c 6974 6533  factory, sqlite3
+000082d0: 2e52 6f77 290a 2020 2020 2020 2020 2020  .Row).          
+000082e0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000082f0: 616c 2864 6263 2e63 7572 732c 205f 6328  al(dbc.curs, _c(
+00008300: 292e 6375 7273 6f72 2829 290a 0a20 2020  ).cursor())..   
+00008310: 2064 6566 2074 6573 745f 636c 6f73 6544   def test_closeD
+00008320: 4228 7365 6c66 2c20 2a61 7267 7329 3a0a  B(self, *args):.
+00008330: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
+00008340: 636c 6f73 6544 4222 2222 0a20 2020 2020  closeDB""".     
+00008350: 2020 2077 6974 6820 7061 7463 6828 226f     with patch("o
+00008360: 732e 7061 7468 2e65 7869 7374 7322 2c20  s.path.exists", 
+00008370: 7265 7475 726e 5f76 616c 7565 3d54 7275  return_value=Tru
+00008380: 6529 2061 7320 5f65 2c20 7061 7463 6828  e) as _e, patch(
+00008390: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
+000083a0: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
+000083b0: 6543 6f72 652e 5068 7973 4269 626c 696f  eCore.PhysBiblio
+000083c0: 4442 436f 7265 2e6c 6f61 6453 7562 436c  DBCore.loadSubCl
+000083d0: 6173 7365 7322 2c20 6175 746f 7370 6563  asses", autospec
+000083e0: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
+000083f0: 6173 205f 6c73 633a 0a20 2020 2020 2020  as _lsc:.       
+00008400: 2020 2020 2064 6263 203d 2050 6879 7342       dbc = PhysB
+00008410: 6962 6c69 6f44 4243 6f72 6528 7465 6d70  iblioDBCore(temp
+00008420: 4442 4e61 6d65 2c20 7042 4c6f 6767 6572  DBName, pBLogger
+00008430: 2c20 6e6f 4f70 656e 3d54 7275 6529 0a20  , noOpen=True). 
+00008440: 2020 2020 2020 2064 6263 2e63 6f6e 6e20         dbc.conn 
+00008450: 3d20 4d61 6769 634d 6f63 6b28 290a 2020  = MagicMock().  
+00008460: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+00008470: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
+00008480: 2e69 6e66 6f22 2920 6173 205f 693a 0a20  .info") as _i:. 
+00008490: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000084a0: 6173 7365 7274 5472 7565 2864 6263 2e63  assertTrue(dbc.c
+000084b0: 6c6f 7365 4442 2829 290a 2020 2020 2020  loseDB()).      
+000084c0: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
+000084d0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+000084e0: 2822 436c 6f73 696e 6720 6461 7461 6261  ("Closing databa
+000084f0: 7365 2e2e 2e22 290a 2020 2020 2020 2020  se...").        
+00008500: 2020 2020 6462 632e 636f 6e6e 2e63 6c6f      dbc.conn.clo
+00008510: 7365 2e61 7373 6572 745f 6361 6c6c 6564  se.assert_called
+00008520: 5f6f 6e63 655f 7769 7468 2829 0a20 2020  _once_with().   
+00008530: 2020 2020 2064 6263 2e63 6f6e 6e2e 7265       dbc.conn.re
+00008540: 7365 745f 6d6f 636b 2829 0a20 2020 2020  set_mock().     
+00008550: 2020 2077 6974 6820 7061 7463 6828 226c     with patch("l
+00008560: 6f67 6769 6e67 2e4c 6f67 6765 722e 6465  ogging.Logger.de
+00008570: 6275 6722 2920 6173 205f 643a 0a20 2020  bug") as _d:.   
+00008580: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00008590: 7365 7274 5472 7565 2864 6263 2e63 6c6f  sertTrue(dbc.clo
+000085a0: 7365 4442 2869 6e66 6f3d 4661 6c73 6529  seDB(info=False)
+000085b0: 290a 2020 2020 2020 2020 2020 2020 5f64  ).            _d
+000085c0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+000085d0: 6e63 655f 7769 7468 2822 436c 6f73 696e  nce_with("Closin
+000085e0: 6720 6461 7461 6261 7365 2e2e 2e22 290a  g database...").
+000085f0: 2020 2020 2020 2020 2020 2020 6462 632e              dbc.
+00008600: 636f 6e6e 2e63 6c6f 7365 2e61 7373 6572  conn.close.asser
+00008610: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+00008620: 7468 2829 0a0a 2020 2020 6465 6620 7465  th()..    def te
+00008630: 7374 5f73 656e 6444 4249 734c 6f63 6b65  st_sendDBIsLocke
+00008640: 6428 7365 6c66 2c20 2a61 7267 7329 3a0a  d(self, *args):.
+00008650: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
+00008660: 7468 6520 7365 6e64 4442 4973 4c6f 636b  the sendDBIsLock
+00008670: 6564 2066 756e 6374 696f 6e22 2222 0a20  ed function""". 
+00008680: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00008690: 7274 5472 7565 2868 6173 6174 7472 2873  rtTrue(hasattr(s
+000086a0: 656c 662e 7042 4442 2c20 226f 6e49 734c  elf.pBDB, "onIsL
+000086b0: 6f63 6b65 6422 2929 0a20 2020 2020 2020  ocked")).       
+000086c0: 2073 656c 662e 7042 4442 2e6f 6e49 734c   self.pBDB.onIsL
+000086d0: 6f63 6b65 6420 3d20 4e6f 6e65 0a20 2020  ocked = None.   
+000086e0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000086f0: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
+00008700: 7365 6e64 4442 4973 4c6f 636b 6564 2829  sendDBIsLocked()
+00008710: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
+00008720: 4244 422e 6f6e 4973 4c6f 636b 6564 203d  BDB.onIsLocked =
+00008730: 2031 3233 0a20 2020 2020 2020 2077 6974   123.        wit
+00008740: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
+00008750: 2e4c 6f67 6765 722e 6578 6365 7074 696f  .Logger.exceptio
+00008760: 6e22 2920 6173 205f 6578 3a0a 2020 2020  n") as _ex:.    
+00008770: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00008780: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
+00008790: 4442 2e73 656e 6444 4249 734c 6f63 6b65  DB.sendDBIsLocke
+000087a0: 6428 2929 0a20 2020 2020 2020 2020 2020  d()).           
+000087b0: 205f 6578 2e61 7373 6572 745f 6361 6c6c   _ex.assert_call
+000087c0: 6564 5f6f 6e63 655f 7769 7468 2822 496e  ed_once_with("In
+000087d0: 7661 6c69 6420 6073 656c 662e 6f6e 4973  valid `self.onIs
+000087e0: 4c6f 636b 6564 6021 2229 0a20 2020 2020  Locked`!").     
+000087f0: 2020 2074 6d70 203d 204d 6167 6963 4d6f     tmp = MagicMo
+00008800: 636b 2829 0a20 2020 2020 2020 2074 6d70  ck().        tmp
+00008810: 2e65 6d69 7420 3d20 4d61 6769 634d 6f63  .emit = MagicMoc
+00008820: 6b28 290a 2020 2020 2020 2020 7365 6c66  k().        self
+00008830: 2e70 4244 422e 6f6e 4973 4c6f 636b 6564  .pBDB.onIsLocked
+00008840: 203d 2074 6d70 0a20 2020 2020 2020 2073   = tmp.        s
+00008850: 656c 662e 6173 7365 7274 5472 7565 2873  elf.assertTrue(s
+00008860: 656c 662e 7042 4442 2e73 656e 6444 4249  elf.pBDB.sendDBI
+00008870: 734c 6f63 6b65 6428 2929 0a20 2020 2020  sLocked()).     
+00008880: 2020 2074 6d70 2e65 6d69 742e 6173 7365     tmp.emit.asse
+00008890: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+000088a0: 6974 6828 290a 0a20 2020 2064 6566 2074  ith()..    def t
+000088b0: 6573 745f 6368 6563 6b55 6e63 6f6d 6d69  est_checkUncommi
+000088c0: 7474 6564 2873 656c 662c 202a 6172 6773  tted(self, *args
+000088d0: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
+000088e0: 7374 2063 6865 636b 556e 636f 6d6d 6974  st checkUncommit
+000088f0: 7465 6422 2222 0a20 2020 2020 2020 2077  ted""".        w
+00008900: 6974 6820 7061 7463 6828 226f 732e 7061  ith patch("os.pa
+00008910: 7468 2e65 7869 7374 7322 2c20 7265 7475  th.exists", retu
+00008920: 726e 5f76 616c 7565 3d54 7275 6529 2061  rn_value=True) a
+00008930: 7320 5f65 2c20 7061 7463 6828 0a20 2020  s _e, patch(.   
+00008940: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+00008950: 626c 696f 2e64 6174 6162 6173 6543 6f72  blio.databaseCor
+00008960: 652e 5068 7973 4269 626c 696f 4442 436f  e.PhysBiblioDBCo
+00008970: 7265 2e6c 6f61 6453 7562 436c 6173 7365  re.loadSubClasse
+00008980: 7322 2c20 6175 746f 7370 6563 3d54 7275  s", autospec=Tru
+00008990: 650a 2020 2020 2020 2020 2920 6173 205f  e.        ) as _
+000089a0: 6c73 633a 0a20 2020 2020 2020 2020 2020  lsc:.           
+000089b0: 2064 6263 203d 2050 6879 7342 6962 6c69   dbc = PhysBibli
+000089c0: 6f44 4243 6f72 6528 7465 6d70 4442 4e61  oDBCore(tempDBNa
+000089d0: 6d65 2c20 7042 4c6f 6767 6572 2c20 6e6f  me, pBLogger, no
+000089e0: 4f70 656e 3d54 7275 6529 0a20 2020 2020  Open=True).     
+000089f0: 2020 2064 6263 2e63 6f6e 6e20 3d20 4d61     dbc.conn = Ma
+00008a00: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
+00008a10: 2020 6462 632e 636f 6e6e 2e69 6e5f 7472    dbc.conn.in_tr
+00008a20: 616e 7361 6374 696f 6e20 3d20 2261 6263  ansaction = "abc
+00008a30: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+00008a40: 7373 6572 7445 7175 616c 2864 6263 2e63  ssertEqual(dbc.c
+00008a50: 6865 636b 556e 636f 6d6d 6974 7465 6428  heckUncommitted(
+00008a60: 292c 2022 6162 6322 290a 0a20 2020 2064  ), "abc")..    d
+00008a70: 6566 2074 6573 745f 636f 6d6d 6974 2873  ef test_commit(s
+00008a80: 656c 662c 202a 6172 6773 293a 0a20 2020  elf, *args):.   
+00008a90: 2020 2020 2022 2222 7465 7374 2063 6f6d       """test com
+00008aa0: 6d69 7422 2222 0a20 2020 2020 2020 2077  mit""".        w
+00008ab0: 6974 6820 7061 7463 6828 226f 732e 7061  ith patch("os.pa
+00008ac0: 7468 2e65 7869 7374 7322 2c20 7265 7475  th.exists", retu
+00008ad0: 726e 5f76 616c 7565 3d54 7275 6529 2061  rn_value=True) a
+00008ae0: 7320 5f65 2c20 7061 7463 6828 0a20 2020  s _e, patch(.   
+00008af0: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+00008b00: 626c 696f 2e64 6174 6162 6173 6543 6f72  blio.databaseCor
+00008b10: 652e 5068 7973 4269 626c 696f 4442 436f  e.PhysBiblioDBCo
+00008b20: 7265 2e6c 6f61 6453 7562 436c 6173 7365  re.loadSubClasse
+00008b30: 7322 2c20 6175 746f 7370 6563 3d54 7275  s", autospec=Tru
+00008b40: 650a 2020 2020 2020 2020 2920 6173 205f  e.        ) as _
+00008b50: 6c73 633a 0a20 2020 2020 2020 2020 2020  lsc:.           
+00008b60: 2064 6263 203d 2050 6879 7342 6962 6c69   dbc = PhysBibli
+00008b70: 6f44 4243 6f72 6528 7465 6d70 4442 4e61  oDBCore(tempDBNa
+00008b80: 6d65 2c20 7042 4c6f 6767 6572 2c20 6e6f  me, pBLogger, no
+00008b90: 4f70 656e 3d54 7275 6529 0a20 2020 2020  Open=True).     
+00008ba0: 2020 2064 6263 2e63 6f6e 6e20 3d20 4d61     dbc.conn = Ma
+00008bb0: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
+00008bc0: 2020 6462 632e 6462 4368 616e 6765 6420    dbc.dbChanged 
+00008bd0: 3d20 2261 6263 220a 2020 2020 2020 2020  = "abc".        
+00008be0: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
+00008bf0: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
+00008c00: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
+00008c10: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00008c20: 5472 7565 2864 6263 2e63 6f6d 6d69 7428  True(dbc.commit(
+00008c30: 2929 0a20 2020 2020 2020 2020 2020 2064  )).            d
+00008c40: 6263 2e63 6f6e 6e2e 636f 6d6d 6974 2e61  bc.conn.commit.a
+00008c50: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00008c60: 655f 7769 7468 2829 0a20 2020 2020 2020  e_with().       
+00008c70: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00008c80: 4661 6c73 6528 6462 632e 6462 4368 616e  False(dbc.dbChan
+00008c90: 6765 6429 0a20 2020 2020 2020 2020 2020  ged).           
+00008ca0: 205f 692e 6173 7365 7274 5f63 616c 6c65   _i.assert_calle
+00008cb0: 645f 6f6e 6365 5f77 6974 6828 2244 6174  d_once_with("Dat
+00008cc0: 6162 6173 6520 7361 7665 642e 2229 0a20  abase saved."). 
+00008cd0: 2020 2020 2020 2020 2020 2064 6263 2e64             dbc.d
+00008ce0: 6243 6861 6e67 6564 203d 2022 6162 6322  bChanged = "abc"
+00008cf0: 0a20 2020 2020 2020 2020 2020 205f 692e  .            _i.
+00008d00: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
+00008d10: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00008d20: 7365 7274 5472 7565 2864 6263 2e63 6f6d  sertTrue(dbc.com
+00008d30: 6d69 7428 7665 7262 6f73 653d 4661 6c73  mit(verbose=Fals
+00008d40: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
+00008d50: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
+00008d60: 2864 6263 2e64 6243 6861 6e67 6564 290a  (dbc.dbChanged).
+00008d70: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
+00008d80: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+00008d90: 2829 0a20 2020 2020 2020 2064 6263 2e63  ().        dbc.c
+00008da0: 6f6e 6e2e 636f 6d6d 6974 2e72 6573 6574  onn.commit.reset
+00008db0: 5f6d 6f63 6b28 290a 2020 2020 2020 2020  _mock().        
+00008dc0: 6462 632e 636f 6e6e 2e63 6f6d 6d69 742e  dbc.conn.commit.
+00008dd0: 7369 6465 5f65 6666 6563 7420 3d20 4578  side_effect = Ex
+00008de0: 6365 7074 696f 6e28 2265 7272 6f72 2229  ception("error")
+00008df0: 0a20 2020 2020 2020 2064 6263 2e64 6243  .        dbc.dbC
+00008e00: 6861 6e67 6564 203d 2022 6162 6322 0a20  hanged = "abc". 
+00008e10: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+00008e20: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
+00008e30: 722e 6578 6365 7074 696f 6e22 2920 6173  r.exception") as
+00008e40: 205f 653a 0a20 2020 2020 2020 2020 2020   _e:.           
+00008e50: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
+00008e60: 6528 6462 632e 636f 6d6d 6974 2829 290a  e(dbc.commit()).
+00008e70: 2020 2020 2020 2020 2020 2020 6462 632e              dbc.
+00008e80: 636f 6e6e 2e63 6f6d 6d69 742e 6173 7365  conn.commit.asse
+00008e90: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+00008ea0: 6974 6828 290a 2020 2020 2020 2020 2020  ith().          
+00008eb0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00008ec0: 616c 2864 6263 2e64 6243 6861 6e67 6564  al(dbc.dbChanged
+00008ed0: 2c20 2261 6263 2229 0a20 2020 2020 2020  , "abc").       
+00008ee0: 2020 2020 205f 652e 6173 7365 7274 5f63       _e.assert_c
+00008ef0: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+00008f00: 2249 6d70 6f73 7369 626c 6520 746f 2063  "Impossible to c
+00008f10: 6f6d 6d69 7421 2229 0a0a 2020 2020 6465  ommit!")..    de
+00008f20: 6620 7465 7374 5f75 6e64 6f28 7365 6c66  f test_undo(self
+00008f30: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
+00008f40: 2020 2222 2274 6573 7420 756e 646f 2222    """test undo""
+00008f50: 220a 2020 2020 2020 2020 7769 7468 2070  ".        with p
+00008f60: 6174 6368 2822 6f73 2e70 6174 682e 6578  atch("os.path.ex
+00008f70: 6973 7473 222c 2072 6574 7572 6e5f 7661  ists", return_va
+00008f80: 6c75 653d 5472 7565 2920 6173 205f 652c  lue=True) as _e,
+00008f90: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+00008fa0: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+00008fb0: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
+00008fc0: 7342 6962 6c69 6f44 4243 6f72 652e 6c6f  sBiblioDBCore.lo
+00008fd0: 6164 5375 6243 6c61 7373 6573 222c 2061  adSubClasses", a
+00008fe0: 7574 6f73 7065 633d 5472 7565 0a20 2020  utospec=True.   
+00008ff0: 2020 2020 2029 2061 7320 5f6c 7363 3a0a       ) as _lsc:.
+00009000: 2020 2020 2020 2020 2020 2020 6462 6320              dbc 
+00009010: 3d20 5068 7973 4269 626c 696f 4442 436f  = PhysBiblioDBCo
+00009020: 7265 2874 656d 7044 424e 616d 652c 2070  re(tempDBName, p
+00009030: 424c 6f67 6765 722c 206e 6f4f 7065 6e3d  BLogger, noOpen=
+00009040: 5472 7565 290a 2020 2020 2020 2020 6462  True).        db
+00009050: 632e 636f 6e6e 203d 204d 6167 6963 4d6f  c.conn = MagicMo
+00009060: 636b 2829 0a20 2020 2020 2020 2064 6263  ck().        dbc
+00009070: 2e64 6243 6861 6e67 6564 203d 2022 6162  .dbChanged = "ab
+00009080: 6322 0a20 2020 2020 2020 2077 6974 6820  c".        with 
+00009090: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
+000090a0: 6f67 6765 722e 696e 666f 2229 2061 7320  ogger.info") as 
+000090b0: 5f69 3a0a 2020 2020 2020 2020 2020 2020  _i:.            
+000090c0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+000090d0: 6462 632e 756e 646f 2829 290a 2020 2020  dbc.undo()).    
+000090e0: 2020 2020 2020 2020 6462 632e 636f 6e6e          dbc.conn
+000090f0: 2e72 6f6c 6c62 6163 6b2e 6173 7365 7274  .rollback.assert
+00009100: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+00009110: 6828 290a 2020 2020 2020 2020 2020 2020  h().            
+00009120: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
+00009130: 2864 6263 2e64 6243 6861 6e67 6564 290a  (dbc.dbChanged).
+00009140: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
+00009150: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00009160: 655f 7769 7468 2822 526f 6c6c 6564 2062  e_with("Rolled b
+00009170: 6163 6b20 746f 206c 6173 7420 636f 6d6d  ack to last comm
+00009180: 6974 2e22 290a 2020 2020 2020 2020 2020  it.").          
+00009190: 2020 6462 632e 6462 4368 616e 6765 6420    dbc.dbChanged 
+000091a0: 3d20 2261 6263 220a 2020 2020 2020 2020  = "abc".        
+000091b0: 2020 2020 5f69 2e72 6573 6574 5f6d 6f63      _i.reset_moc
+000091c0: 6b28 290a 2020 2020 2020 2020 2020 2020  k().            
+000091d0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+000091e0: 6462 632e 756e 646f 2876 6572 626f 7365  dbc.undo(verbose
+000091f0: 3d46 616c 7365 2929 0a20 2020 2020 2020  =False)).       
+00009200: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00009210: 4661 6c73 6528 6462 632e 6462 4368 616e  False(dbc.dbChan
+00009220: 6765 6429 0a20 2020 2020 2020 2020 2020  ged).           
+00009230: 205f 692e 6173 7365 7274 5f6e 6f74 5f63   _i.assert_not_c
+00009240: 616c 6c65 6428 290a 2020 2020 2020 2020  alled().        
+00009250: 6462 632e 636f 6e6e 2e72 6f6c 6c62 6163  dbc.conn.rollbac
+00009260: 6b2e 7265 7365 745f 6d6f 636b 2829 0a20  k.reset_mock(). 
+00009270: 2020 2020 2020 2064 6263 2e63 6f6e 6e2e         dbc.conn.
+00009280: 726f 6c6c 6261 636b 2e73 6964 655f 6566  rollback.side_ef
+00009290: 6665 6374 203d 2045 7863 6570 7469 6f6e  fect = Exception
+000092a0: 2822 6572 726f 7222 290a 2020 2020 2020  ("error").      
+000092b0: 2020 6462 632e 6462 4368 616e 6765 6420    dbc.dbChanged 
+000092c0: 3d20 2261 6263 220a 2020 2020 2020 2020  = "abc".        
+000092d0: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
+000092e0: 696e 672e 4c6f 6767 6572 2e65 7863 6570  ing.Logger.excep
+000092f0: 7469 6f6e 2229 2061 7320 5f65 3a0a 2020  tion") as _e:.  
+00009300: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00009310: 7373 6572 7446 616c 7365 2864 6263 2e75  ssertFalse(dbc.u
+00009320: 6e64 6f28 2929 0a20 2020 2020 2020 2020  ndo()).         
+00009330: 2020 2064 6263 2e63 6f6e 6e2e 726f 6c6c     dbc.conn.roll
+00009340: 6261 636b 2e61 7373 6572 745f 6361 6c6c  back.assert_call
+00009350: 6564 5f6f 6e63 655f 7769 7468 2829 0a20  ed_once_with(). 
+00009360: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00009370: 6173 7365 7274 4571 7561 6c28 6462 632e  assertEqual(dbc.
+00009380: 6462 4368 616e 6765 642c 2022 6162 6322  dbChanged, "abc"
+00009390: 290a 2020 2020 2020 2020 2020 2020 5f65  ).            _e
+000093a0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+000093b0: 6e63 655f 7769 7468 2822 496d 706f 7373  nce_with("Imposs
+000093c0: 6962 6c65 2074 6f20 726f 6c6c 6261 636b  ible to rollback
+000093d0: 2122 290a 0a20 2020 2064 6566 2074 6573  !")..    def tes
+000093e0: 745f 636f 6e6e 4578 6563 2873 656c 662c  t_connExec(self,
+000093f0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
+00009400: 2022 2222 7465 7374 2063 6f6e 6e45 7865   """test connExe
+00009410: 6322 2222 0a20 2020 2020 2020 2073 656c  c""".        sel
+00009420: 662e 7042 4442 2e64 6243 6861 6e67 6564  f.pBDB.dbChanged
+00009430: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00009440: 2074 7275 6563 6f6e 6e20 3d20 7365 6c66   trueconn = self
+00009450: 2e70 4244 422e 636f 6e6e 0a20 2020 2020  .pBDB.conn.     
+00009460: 2020 2073 656c 662e 7042 4442 2e63 6f6e     self.pBDB.con
+00009470: 6e20 3d20 4d61 6769 634d 6f63 6b28 290a  n = MagicMock().
+00009480: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00009490: 422e 636f 6e6e 2e65 7865 6375 7465 2e73  B.conn.execute.s
+000094a0: 6964 655f 6566 6665 6374 203d 205b 0a20  ide_effect = [. 
+000094b0: 2020 2020 2020 2020 2020 2050 726f 6772             Progr
+000094c0: 616d 6d69 6e67 4572 726f 7228 2261 2229  ammingError("a")
+000094d0: 2c0a 2020 2020 2020 2020 2020 2020 4461  ,.            Da
+000094e0: 7461 6261 7365 4572 726f 7228 2262 2229  tabaseError("b")
+000094f0: 2c0a 2020 2020 2020 2020 2020 2020 496e  ,.            In
+00009500: 7465 7266 6163 6545 7272 6f72 2822 6322  terfaceError("c"
+00009510: 292c 0a20 2020 2020 2020 205d 0a20 2020  ),.        ].   
+00009520: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+00009530: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
+00009540: 6578 6365 7074 696f 6e22 2920 6173 205f  exception") as _
+00009550: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
+00009560: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
+00009570: 2873 656c 662e 7042 4442 2e63 6f6e 6e45  (self.pBDB.connE
+00009580: 7865 6328 2261 2229 290a 2020 2020 2020  xec("a")).      
+00009590: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000095a0: 7446 616c 7365 2873 656c 662e 7042 4442  tFalse(self.pBDB
+000095b0: 2e63 6f6e 6e45 7865 6328 2261 2229 290a  .connExec("a")).
+000095c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000095d0: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
+000095e0: 662e 7042 4442 2e63 6f6e 6e45 7865 6328  f.pBDB.connExec(
+000095f0: 2261 2229 290a 2020 2020 2020 2020 2020  "a")).          
+00009600: 2020 5f65 782e 6173 7365 7274 5f68 6173    _ex.assert_has
+00009610: 5f63 616c 6c73 280a 2020 2020 2020 2020  _calls(.        
+00009620: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00009630: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+00009640: 6c6c 2822 436f 6e6e 6563 7469 6f6e 2065  ll("Connection e
+00009650: 7272 6f72 3a20 615c 6e71 7565 7279 3a20  rror: a\nquery: 
+00009660: 6122 292c 0a20 2020 2020 2020 2020 2020  a"),.           
+00009670: 2020 2020 2020 2020 2063 616c 6c28 2243           call("C
+00009680: 6f6e 6e65 6374 696f 6e20 6572 726f 723a  onnection error:
+00009690: 2062 5c6e 7175 6572 793a 2061 2229 2c0a   b\nquery: a"),.
+000096a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096b0: 2020 2020 6361 6c6c 2822 436f 6e6e 6563      call("Connec
+000096c0: 7469 6f6e 2065 7272 6f72 3a20 635c 6e71  tion error: c\nq
+000096d0: 7565 7279 3a20 6122 292c 0a20 2020 2020  uery: a"),.     
+000096e0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+000096f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00009700: 2020 2073 656c 662e 7042 4442 2e63 6f6e     self.pBDB.con
+00009710: 6e2e 6578 6563 7574 652e 7369 6465 5f65  n.execute.side_e
+00009720: 6666 6563 7420 3d20 496e 7465 6772 6974  ffect = Integrit
+00009730: 7945 7272 6f72 2822 6422 290a 2020 2020  yError("d").    
+00009740: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+00009750: 6c6f 6767 696e 672e 4c6f 6767 6572 2e65  logging.Logger.e
+00009760: 7863 6570 7469 6f6e 2229 2061 7320 5f65  xception") as _e
+00009770: 783a 0a20 2020 2020 2020 2020 2020 2073  x:.            s
+00009780: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+00009790: 7365 6c66 2e70 4244 422e 636f 6e6e 4578  self.pBDB.connEx
+000097a0: 6563 2822 6122 2929 0a20 2020 2020 2020  ec("a")).       
+000097b0: 2020 2020 205f 6578 2e61 7373 6572 745f       _ex.assert_
+000097c0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+000097d0: 2822 4361 6e6e 6f74 2069 6e73 6572 742f  ("Cannot insert/
+000097e0: 7570 6461 7465 3a20 4944 2065 7869 7374  update: ID exist
+000097f0: 7321 5c6e 645c 6e71 7565 7279 3a20 6122  s!\nd\nquery: a"
+00009800: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00009810: 7042 4442 2e63 6f6e 6e2e 6578 6563 7574  pBDB.conn.execut
+00009820: 652e 7369 6465 5f65 6666 6563 7420 3d20  e.side_effect = 
+00009830: 4f70 6572 6174 696f 6e61 6c45 7272 6f72  OperationalError
+00009840: 2822 6522 290a 2020 2020 2020 2020 7769  ("e").        wi
+00009850: 7468 2070 6174 6368 2822 6c6f 6767 696e  th patch("loggin
+00009860: 672e 4c6f 6767 6572 2e65 7863 6570 7469  g.Logger.excepti
+00009870: 6f6e 2229 2061 7320 5f65 782c 2070 6174  on") as _ex, pat
+00009880: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+00009890: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
+000098a0: 6572 726f 7222 0a20 2020 2020 2020 2029  error".        )
+000098b0: 2061 7320 5f65 722c 2070 6174 6368 280a   as _er, patch(.
+000098c0: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+000098d0: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+000098e0: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
+000098f0: 4243 6f72 652e 7365 6e64 4442 4973 4c6f  BCore.sendDBIsLo
+00009900: 636b 6564 222c 0a20 2020 2020 2020 2020  cked",.         
+00009910: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
+00009920: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00009930: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
+00009940: 0a20 2020 2020 2020 2029 2061 7320 5f6c  .        ) as _l
+00009950: 6f3a 0a20 2020 2020 2020 2020 2020 2073  o:.            s
+00009960: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+00009970: 7365 6c66 2e70 4244 422e 636f 6e6e 4578  self.pBDB.connEx
+00009980: 6563 2822 6122 2929 0a20 2020 2020 2020  ec("a")).       
+00009990: 2020 2020 205f 6578 2e61 7373 6572 745f       _ex.assert_
+000099a0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+000099b0: 2822 436f 6e6e 6563 7469 6f6e 2065 7272  ("Connection err
+000099c0: 6f72 3a20 655c 6e71 7565 7279 3a20 6122  or: e\nquery: a"
+000099d0: 290a 2020 2020 2020 2020 2020 2020 5f65  ).            _e
+000099e0: 722e 6173 7365 7274 5f6e 6f74 5f63 616c  r.assert_not_cal
+000099f0: 6c65 6428 290a 2020 2020 2020 2020 2020  led().          
+00009a00: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00009a10: 616c 285f 6c6f 2e63 616c 6c5f 636f 756e  al(_lo.call_coun
+00009a20: 742c 2030 290a 2020 2020 2020 2020 7365  t, 0).        se
+00009a30: 6c66 2e70 4244 422e 636f 6e6e 2e65 7865  lf.pBDB.conn.exe
+00009a40: 6375 7465 2e73 6964 655f 6566 6665 6374  cute.side_effect
+00009a50: 203d 204f 7065 7261 7469 6f6e 616c 4572   = OperationalEr
+00009a60: 726f 7228 2264 6174 6162 6173 6520 6973  ror("database is
+00009a70: 206c 6f63 6b65 6422 290a 2020 2020 2020   locked").      
+00009a80: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
+00009a90: 6767 696e 672e 4c6f 6767 6572 2e65 7863  gging.Logger.exc
+00009aa0: 6570 7469 6f6e 2229 2061 7320 5f65 782c  eption") as _ex,
+00009ab0: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+00009ac0: 2020 2020 226c 6f67 6769 6e67 2e4c 6f67      "logging.Log
+00009ad0: 6765 722e 6572 726f 7222 0a20 2020 2020  ger.error".     
+00009ae0: 2020 2029 2061 7320 5f65 722c 2070 6174     ) as _er, pat
+00009af0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+00009b00: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+00009b10: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
+00009b20: 6c69 6f44 4243 6f72 652e 7365 6e64 4442  lioDBCore.sendDB
+00009b30: 4973 4c6f 636b 6564 222c 0a20 2020 2020  IsLocked",.     
+00009b40: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
+00009b50: 6c75 653d 5472 7565 2c0a 2020 2020 2020  lue=True,.      
+00009b60: 2020 2020 2020 6175 746f 7370 6563 3d54        autospec=T
+00009b70: 7275 652c 0a20 2020 2020 2020 2029 2061  rue,.        ) a
+00009b80: 7320 5f6c 6f3a 0a20 2020 2020 2020 2020  s _lo:.         
+00009b90: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
+00009ba0: 6c73 6528 7365 6c66 2e70 4244 422e 636f  lse(self.pBDB.co
+00009bb0: 6e6e 4578 6563 2822 6122 2929 0a20 2020  nnExec("a")).   
+00009bc0: 2020 2020 2020 2020 205f 6578 2e61 7373           _ex.ass
+00009bd0: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+00009be0: 0a20 2020 2020 2020 2020 2020 205f 6572  .            _er
+00009bf0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+00009c00: 6564 2829 0a20 2020 2020 2020 2020 2020  ed().           
+00009c10: 205f 6c6f 2e61 7373 6572 745f 6361 6c6c   _lo.assert_call
+00009c20: 6564 5f6f 6e63 655f 7769 7468 2873 656c  ed_once_with(sel
+00009c30: 662e 7042 4442 290a 2020 2020 2020 2020  f.pBDB).        
+00009c40: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
+00009c50: 696e 672e 4c6f 6767 6572 2e65 7863 6570  ing.Logger.excep
+00009c60: 7469 6f6e 2229 2061 7320 5f65 782c 2070  tion") as _ex, p
+00009c70: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+00009c80: 2020 226c 6f67 6769 6e67 2e4c 6f67 6765    "logging.Logge
+00009c90: 722e 6572 726f 7222 0a20 2020 2020 2020  r.error".       
+00009ca0: 2029 2061 7320 5f65 722c 2070 6174 6368   ) as _er, patch
+00009cb0: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
+00009cc0: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
+00009cd0: 7365 436f 7265 2e50 6879 7342 6962 6c69  seCore.PhysBibli
+00009ce0: 6f44 4243 6f72 652e 7365 6e64 4442 4973  oDBCore.sendDBIs
+00009cf0: 4c6f 636b 6564 222c 0a20 2020 2020 2020  Locked",.       
+00009d00: 2020 2020 2072 6574 7572 6e5f 7661 6c75       return_valu
+00009d10: 653d 4661 6c73 652c 0a20 2020 2020 2020  e=False,.       
+00009d20: 2020 2020 2061 7574 6f73 7065 633d 5472       autospec=Tr
+00009d30: 7565 2c0a 2020 2020 2020 2020 2920 6173  ue,.        ) as
+00009d40: 205f 6c6f 3a0a 2020 2020 2020 2020 2020   _lo:.          
+00009d50: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
+00009d60: 7365 2873 656c 662e 7042 4442 2e63 6f6e  se(self.pBDB.con
+00009d70: 6e45 7865 6328 2261 2229 290a 2020 2020  nExec("a")).    
+00009d80: 2020 2020 2020 2020 5f65 782e 6173 7365          _ex.asse
+00009d90: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00009da0: 2020 2020 2020 2020 2020 2020 5f65 722e              _er.
+00009db0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+00009dc0: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
+00009dd0: 2020 2020 2020 2020 2022 4f70 6572 6174           "Operat
+00009de0: 696f 6e61 6c45 7272 6f72 3a20 7468 6520  ionalError: the 
+00009df0: 6461 7461 6261 7365 2069 7320 616c 7265  database is alre
+00009e00: 6164 7920 6f70 656e 2022 0a20 2020 2020  ady open ".     
+00009e10: 2020 2020 2020 2020 2020 202b 2022 696e             + "in
+00009e20: 2061 6e6f 7468 6572 2069 6e73 7461 6e63   another instanc
+00009e30: 6520 6f66 2074 6865 2061 7070 6c69 6361  e of the applica
+00009e40: 7469 6f6e 5c6e 7175 6572 7920 6661 696c  tion\nquery fail
+00009e50: 6564 3a20 6122 0a20 2020 2020 2020 2020  ed: a".         
+00009e60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00009e70: 205f 6c6f 2e61 7373 6572 745f 6361 6c6c   _lo.assert_call
+00009e80: 6564 5f6f 6e63 655f 7769 7468 2873 656c  ed_once_with(sel
+00009e90: 662e 7042 4442 290a 0a20 2020 2020 2020  f.pBDB)..       
+00009ea0: 2073 656c 662e 7042 4442 2e63 6f6e 6e2e   self.pBDB.conn.
+00009eb0: 6578 6563 7574 652e 7265 7365 745f 6d6f  execute.reset_mo
+00009ec0: 636b 2829 0a20 2020 2020 2020 2073 656c  ck().        sel
+00009ed0: 662e 7042 4442 2e63 6f6e 6e2e 6578 6563  f.pBDB.conn.exec
+00009ee0: 7574 652e 7369 6465 5f65 6666 6563 7420  ute.side_effect 
+00009ef0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00009f00: 656c 662e 7042 4442 6269 7320 3d20 5068  elf.pBDBbis = Ph
+00009f10: 7973 4269 626c 696f 4442 2874 656d 7044  ysBiblioDB(tempD
+00009f20: 424e 616d 652c 2070 424c 6f67 6765 7229  BName, pBLogger)
+00009f30: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00009f40: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
+00009f50: 4244 422e 6462 4368 616e 6765 6429 0a20  BDB.dbChanged). 
+00009f60: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00009f70: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
+00009f80: 2e63 6f6e 6e45 7865 6328 2261 2229 290a  .connExec("a")).
+00009f90: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00009fa0: 422e 636f 6e6e 2e65 7865 6375 7465 2e61  B.conn.execute.a
+00009fb0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00009fc0: 655f 7769 7468 2822 6122 290a 2020 2020  e_with("a").    
+00009fd0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00009fe0: 7275 6528 7365 6c66 2e70 4244 422e 6462  rue(self.pBDB.db
+00009ff0: 4368 616e 6765 6429 0a20 2020 2020 2020  Changed).       
+0000a000: 2073 656c 662e 7042 4442 2e64 6243 6861   self.pBDB.dbCha
+0000a010: 6e67 6564 203d 2046 616c 7365 0a20 2020  nged = False.   
+0000a020: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
+0000a030: 6f6e 6e2e 6578 6563 7574 652e 7265 7365  onn.execute.rese
+0000a040: 745f 6d6f 636b 2829 0a20 2020 2020 2020  t_mock().       
+0000a050: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+0000a060: 2873 656c 662e 7042 4442 2e63 6f6e 6e45  (self.pBDB.connE
+0000a070: 7865 6328 2261 222c 2064 6174 613d 2262  xec("a", data="b
+0000a080: 2229 290a 2020 2020 2020 2020 7365 6c66  ")).        self
+0000a090: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+0000a0a0: 2e70 4244 422e 6462 4368 616e 6765 6429  .pBDB.dbChanged)
+0000a0b0: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+0000a0c0: 4442 2e63 6f6e 6e2e 6578 6563 7574 652e  DB.conn.execute.
+0000a0d0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+0000a0e0: 6365 5f77 6974 6828 2261 222c 2022 6222  ce_with("a", "b"
+0000a0f0: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
+0000a100: 4244 4262 6973 2e75 6e64 6f28 290a 2020  BDBbis.undo().  
+0000a110: 2020 2020 2020 7365 6c66 2e70 4244 4262        self.pBDBb
+0000a120: 6973 2e63 6c6f 7365 4442 2829 0a0a 2020  is.closeDB()..  
+0000a130: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0000a140: 636f 6e6e 203d 2074 7275 6563 6f6e 6e0a  conn = trueconn.
+0000a150: 0a20 2020 2064 6566 2074 6573 745f 6375  .    def test_cu
+0000a160: 7273 4578 6563 2873 656c 662c 202a 6172  rsExec(self, *ar
+0000a170: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+0000a180: 7465 7374 2063 7572 7345 7865 6322 2222  test cursExec"""
+0000a190: 0a20 2020 2020 2020 2074 7275 6563 6f6e  .        truecon
+0000a1a0: 6e20 3d20 7365 6c66 2e70 4244 422e 6375  n = self.pBDB.cu
+0000a1b0: 7273 0a20 2020 2020 2020 2073 656c 662e  rs.        self.
+0000a1c0: 7042 4442 2e63 7572 7320 3d20 4d61 6769  pBDB.curs = Magi
+0000a1d0: 634d 6f63 6b28 290a 2020 2020 2020 2020  cMock().        
+0000a1e0: 7365 6c66 2e70 4244 422e 6375 7273 2e65  self.pBDB.curs.e
+0000a1f0: 7865 6375 7465 2e73 6964 655f 6566 6665  xecute.side_effe
+0000a200: 6374 203d 2045 7863 6570 7469 6f6e 2822  ct = Exception("
+0000a210: 6122 290a 2020 2020 2020 2020 7769 7468  a").        with
+0000a220: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
+0000a230: 4c6f 6767 6572 2e65 7863 6570 7469 6f6e  Logger.exception
+0000a240: 2229 2061 7320 5f65 783a 0a20 2020 2020  ") as _ex:.     
+0000a250: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000a260: 7274 4661 6c73 6528 7365 6c66 2e70 4244  rtFalse(self.pBD
+0000a270: 422e 6375 7273 4578 6563 2822 6122 2929  B.cursExec("a"))
+0000a280: 0a20 2020 2020 2020 2020 2020 205f 6578  .            _ex
+0000a290: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+0000a2a0: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
+0000a2b0: 2020 2020 2020 2020 2020 2743 7572 736f            'Curso
+0000a2c0: 7220 6572 726f 723a 2061 5c6e 5468 6520  r error: a\nThe 
+0000a2d0: 7175 6572 7920 7761 733a 2022 6122 5c6e  query was: "a"\n
+0000a2e0: 2720 2b20 2261 6e64 2074 6865 2070 6172  ' + "and the par
+0000a2f0: 616d 6574 6572 733a 204e 6f6e 6522 0a20  ameters: None". 
+0000a300: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000a310: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+0000a320: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
+0000a330: 6578 6365 7074 696f 6e22 2920 6173 205f  exception") as _
+0000a340: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
+0000a350: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
+0000a360: 2873 656c 662e 7042 4442 2e63 7572 7345  (self.pBDB.cursE
+0000a370: 7865 6328 2261 222c 2064 6174 613d 5b22  xec("a", data=["
+0000a380: 6222 5d29 290a 2020 2020 2020 2020 2020  b"])).          
+0000a390: 2020 5f65 782e 6173 7365 7274 5f63 616c    _ex.assert_cal
+0000a3a0: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
+0000a3b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0000a3c0: 4375 7273 6f72 2065 7272 6f72 3a20 615c  Cursor error: a\
+0000a3d0: 6e54 6865 2071 7565 7279 2077 6173 3a20  nThe query was: 
+0000a3e0: 2261 225c 6e27 202b 2022 616e 6420 7468  "a"\n' + "and th
+0000a3f0: 6520 7061 7261 6d65 7465 7273 3a20 5b27  e parameters: ['
+0000a400: 6227 5d22 0a20 2020 2020 2020 2020 2020  b']".           
+0000a410: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
+0000a420: 2e70 4244 422e 6375 7273 2e65 7865 6375  .pBDB.curs.execu
+0000a430: 7465 2e72 6573 6574 5f6d 6f63 6b28 290a  te.reset_mock().
+0000a440: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0000a450: 422e 6375 7273 2e65 7865 6375 7465 2e73  B.curs.execute.s
+0000a460: 6964 655f 6566 6665 6374 203d 204e 6f6e  ide_effect = Non
+0000a470: 650a 2020 2020 2020 2020 7365 6c66 2e61  e.        self.a
+0000a480: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
+0000a490: 4244 422e 6375 7273 4578 6563 2822 6122  BDB.cursExec("a"
+0000a4a0: 2c20 6461 7461 3d22 6222 2929 0a20 2020  , data="b")).   
+0000a4b0: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
+0000a4c0: 7572 732e 6578 6563 7574 652e 6173 7365  urs.execute.asse
+0000a4d0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+0000a4e0: 6974 6828 2261 222c 2022 6222 290a 0a20  ith("a", "b").. 
+0000a4f0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0000a500: 2e63 7572 7320 3d20 7472 7565 636f 6e6e  .curs = trueconn
+0000a510: 0a0a 2020 2020 6465 6620 7465 7374 5f63  ..    def test_c
+0000a520: 7572 736f 7228 7365 6c66 2c20 2a61 7267  ursor(self, *arg
+0000a530: 7329 3a0a 2020 2020 2020 2020 2222 2274  s):.        """t
+0000a540: 6573 7420 6375 7273 6f72 2222 220a 2020  est cursor""".  
+0000a550: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+0000a560: 2822 6f73 2e70 6174 682e 6578 6973 7473  ("os.path.exists
+0000a570: 222c 2072 6574 7572 6e5f 7661 6c75 653d  ", return_value=
+0000a580: 5472 7565 2920 6173 205f 652c 2070 6174  True) as _e, pat
+0000a590: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0000a5a0: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0000a5b0: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
+0000a5c0: 6c69 6f44 4243 6f72 652e 6c6f 6164 5375  lioDBCore.loadSu
+0000a5d0: 6243 6c61 7373 6573 222c 2061 7574 6f73  bClasses", autos
+0000a5e0: 7065 633d 5472 7565 0a20 2020 2020 2020  pec=True.       
+0000a5f0: 2029 2061 7320 5f6c 7363 3a0a 2020 2020   ) as _lsc:.    
+0000a600: 2020 2020 2020 2020 6462 6320 3d20 5068          dbc = Ph
+0000a610: 7973 4269 626c 696f 4442 436f 7265 2874  ysBiblioDBCore(t
+0000a620: 656d 7044 424e 616d 652c 2070 424c 6f67  empDBName, pBLog
+0000a630: 6765 722c 206e 6f4f 7065 6e3d 5472 7565  ger, noOpen=True
+0000a640: 290a 2020 2020 2020 2020 6462 632e 6375  ).        dbc.cu
+0000a650: 7273 203d 2022 6375 7273 220a 2020 2020  rs = "curs".    
+0000a660: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0000a670: 7175 616c 2864 6263 2e63 7572 736f 7228  qual(dbc.cursor(
+0000a680: 292c 2022 6375 7273 2229 0a0a 2020 2020  ), "curs")..    
+0000a690: 6465 6620 7465 7374 5f63 6865 636b 4578  def test_checkEx
+0000a6a0: 6973 7469 6e67 5461 626c 6573 2873 656c  istingTables(sel
+0000a6b0: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
+0000a6c0: 2020 2022 2222 7465 7374 2063 6865 636b     """test check
+0000a6d0: 4578 6973 7469 6e67 5461 626c 6573 2222  ExistingTables""
+0000a6e0: 220a 2020 2020 2020 2020 7769 7468 2070  ".        with p
+0000a6f0: 6174 6368 2822 6f73 2e70 6174 682e 6578  atch("os.path.ex
+0000a700: 6973 7473 222c 2072 6574 7572 6e5f 7661  ists", return_va
+0000a710: 6c75 653d 5472 7565 2920 6173 205f 652c  lue=True) as _e,
+0000a720: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+0000a730: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+0000a740: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
+0000a750: 7342 6962 6c69 6f44 4243 6f72 652e 6c6f  sBiblioDBCore.lo
+0000a760: 6164 5375 6243 6c61 7373 6573 222c 2061  adSubClasses", a
+0000a770: 7574 6f73 7065 633d 5472 7565 0a20 2020  utospec=True.   
+0000a780: 2020 2020 2029 2061 7320 5f6c 7363 3a0a       ) as _lsc:.
+0000a790: 2020 2020 2020 2020 2020 2020 6462 6320              dbc 
+0000a7a0: 3d20 5068 7973 4269 626c 696f 4442 436f  = PhysBiblioDBCo
+0000a7b0: 7265 2874 656d 7044 424e 616d 652c 2070  re(tempDBName, p
+0000a7c0: 424c 6f67 6765 722c 206e 6f4f 7065 6e3d  BLogger, noOpen=
+0000a7d0: 5472 7565 290a 2020 2020 2020 2020 6462  True).        db
+0000a7e0: 632e 6375 7273 203d 205b 5b22 7461 6231  c.curs = [["tab1
+0000a7f0: 222c 2022 3122 5d2c 205b 2274 6162 3222  ", "1"], ["tab2"
+0000a800: 2c20 2232 225d 5d0a 2020 2020 2020 2020  , "2"]].        
+0000a810: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
+0000a820: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
+0000a830: 6c69 6f2e 6461 7461 6261 7365 436f 7265  lio.databaseCore
+0000a840: 2e50 6879 7342 6962 6c69 6f44 4243 6f72  .PhysBiblioDBCor
+0000a850: 652e 6375 7273 4578 6563 222c 2061 7574  e.cursExec", aut
+0000a860: 6f73 7065 633d 5472 7565 0a20 2020 2020  ospec=True.     
+0000a870: 2020 2029 2061 7320 5f63 653a 0a20 2020     ) as _ce:.   
+0000a880: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0000a890: 7365 7274 5472 7565 2864 6263 2e63 6865  sertTrue(dbc.che
+0000a8a0: 636b 4578 6973 7469 6e67 5461 626c 6573  ckExistingTables
+0000a8b0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+0000a8c0: 5f63 652e 6173 7365 7274 5f63 616c 6c65  _ce.assert_calle
+0000a8d0: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
+0000a8e0: 2020 2020 2020 2020 2020 2020 2064 6263               dbc
+0000a8f0: 2c20 2253 454c 4543 5420 6e61 6d65 2046  , "SELECT name F
+0000a900: 524f 4d20 7371 6c69 7465 5f6d 6173 7465  ROM sqlite_maste
+0000a910: 7220 5748 4552 4520 7479 7065 3d27 7461  r WHERE type='ta
+0000a920: 626c 6527 3b22 0a20 2020 2020 2020 2020  ble';".         
+0000a930: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
+0000a940: 6820 7061 7463 6828 0a20 2020 2020 2020  h patch(.       
+0000a950: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+0000a960: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
+0000a970: 7973 4269 626c 696f 4442 436f 7265 2e63  ysBiblioDBCore.c
+0000a980: 7572 7345 7865 6322 2c20 6175 746f 7370  ursExec", autosp
+0000a990: 6563 3d54 7275 650a 2020 2020 2020 2020  ec=True.        
+0000a9a0: 2920 6173 205f 6365 3a0a 2020 2020 2020  ) as _ce:.      
+0000a9b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000a9c0: 7446 616c 7365 2864 6263 2e63 6865 636b  tFalse(dbc.check
+0000a9d0: 4578 6973 7469 6e67 5461 626c 6573 2877  ExistingTables(w
+0000a9e0: 616e 7465 6454 6162 6c65 733d 5b22 7461  antedTables=["ta
+0000a9f0: 6231 222c 2022 7461 6232 225d 2929 0a20  b1", "tab2"])). 
+0000aa00: 2020 2020 2020 2064 6263 2e63 7572 7320         dbc.curs 
+0000aa10: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+0000aa20: 5b22 6361 7465 676f 7269 6573 225d 2c0a  ["categories"],.
+0000aa30: 2020 2020 2020 2020 2020 2020 5b22 656e              ["en
+0000aa40: 7472 6965 7322 5d2c 0a20 2020 2020 2020  tries"],.       
+0000aa50: 2020 2020 205b 2265 6e74 7279 4361 7473       ["entryCats
+0000aa60: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0000aa70: 5b22 656e 7472 7945 7870 7322 5d2c 0a20  ["entryExps"],. 
+0000aa80: 2020 2020 2020 2020 2020 205b 2265 7870             ["exp
+0000aa90: 4361 7473 225d 2c0a 2020 2020 2020 2020  Cats"],.        
+0000aaa0: 2020 2020 5b22 6578 7065 7269 6d65 6e74      ["experiment
+0000aab0: 7322 5d2c 0a20 2020 2020 2020 2020 2020  s"],.           
+0000aac0: 205b 2273 6574 7469 6e67 7322 5d2c 0a20   ["settings"],. 
+0000aad0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+0000aae0: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
+0000aaf0: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+0000ab00: 626c 696f 2e64 6174 6162 6173 6543 6f72  blio.databaseCor
+0000ab10: 652e 5068 7973 4269 626c 696f 4442 436f  e.PhysBiblioDBCo
+0000ab20: 7265 2e63 7572 7345 7865 6322 2c20 6175  re.cursExec", au
+0000ab30: 746f 7370 6563 3d54 7275 650a 2020 2020  tospec=True.    
+0000ab40: 2020 2020 2920 6173 205f 6365 3a0a 2020      ) as _ce:.  
+0000ab50: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000ab60: 7373 6572 7446 616c 7365 2864 6263 2e63  ssertFalse(dbc.c
+0000ab70: 6865 636b 4578 6973 7469 6e67 5461 626c  heckExistingTabl
+0000ab80: 6573 2829 290a 0a20 2020 2064 6566 2074  es())..    def t
+0000ab90: 6573 745f 6372 6561 7465 5461 626c 6528  est_createTable(
+0000aba0: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+0000abb0: 2020 2020 2020 2222 2274 6573 7420 6372        """test cr
+0000abc0: 6561 7465 5461 626c 6522 2222 0a20 2020  eateTable""".   
+0000abd0: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
+0000abe0: 6578 6973 7473 2874 656d 7046 4442 4e61  exists(tempFDBNa
+0000abf0: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+0000ac00: 206f 732e 7265 6d6f 7665 2874 656d 7046   os.remove(tempF
+0000ac10: 4442 4e61 6d65 290a 2020 2020 2020 2020  DBName).        
+0000ac20: 6f70 656e 2874 656d 7046 4442 4e61 6d65  open(tempFDBName
+0000ac30: 2c20 2261 2229 2e63 6c6f 7365 2829 0a20  , "a").close(). 
+0000ac40: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+0000ac50: 6828 226f 732e 7061 7468 2e65 7869 7374  h("os.path.exist
+0000ac60: 7322 2c20 7265 7475 726e 5f76 616c 7565  s", return_value
+0000ac70: 3d54 7275 6529 2061 7320 5f65 2c20 7061  =True) as _e, pa
+0000ac80: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+0000ac90: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
+0000aca0: 6162 6173 6543 6f72 652e 5068 7973 4269  abaseCore.PhysBi
+0000acb0: 626c 696f 4442 436f 7265 2e6c 6f61 6453  blioDBCore.loadS
+0000acc0: 7562 436c 6173 7365 7322 2c20 6175 746f  ubClasses", auto
+0000acd0: 7370 6563 3d54 7275 650a 2020 2020 2020  spec=True.      
+0000ace0: 2020 2920 6173 205f 6c73 633a 0a20 2020    ) as _lsc:.   
+0000acf0: 2020 2020 2020 2020 2064 6263 203d 2050           dbc = P
+0000ad00: 6879 7342 6962 6c69 6f44 4243 6f72 6528  hysBiblioDBCore(
+0000ad10: 7465 6d70 4644 424e 616d 652c 2070 424c  tempFDBName, pBL
+0000ad20: 6f67 6765 722c 206e 6f4f 7065 6e3d 5472  ogger, noOpen=Tr
+0000ad30: 7565 290a 2020 2020 2020 2020 6462 632e  ue).        dbc.
+0000ad40: 6f70 656e 4442 2829 0a20 2020 2020 2020  openDB().       
+0000ad50: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
+0000ad60: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+0000ad70: 626c 696f 2e64 6174 6162 6173 6543 6f72  blio.databaseCor
+0000ad80: 652e 5068 7973 4269 626c 696f 4442 436f  e.PhysBiblioDBCo
+0000ad90: 7265 2e63 6f6e 6e45 7865 6322 2c0a 2020  re.connExec",.  
+0000ada0: 2020 2020 2020 2020 2020 7369 6465 5f65            side_e
+0000adb0: 6666 6563 743d 5b54 7275 652c 2046 616c  ffect=[True, Fal
+0000adc0: 7365 5d2c 0a20 2020 2020 2020 2020 2020  se],.           
+0000add0: 2061 7574 6f73 7065 633d 5472 7565 2c0a   autospec=True,.
+0000ade0: 2020 2020 2020 2020 2920 6173 205f 6365          ) as _ce
+0000adf0: 2c20 7061 7463 6828 226c 6f67 6769 6e67  , patch("logging
+0000ae00: 2e4c 6f67 6765 722e 696e 666f 2229 2061  .Logger.info") a
+0000ae10: 7320 5f69 2c20 7061 7463 6828 0a20 2020  s _i, patch(.   
+0000ae20: 2020 2020 2020 2020 2022 6c6f 6767 696e           "loggin
+0000ae30: 672e 4c6f 6767 6572 2e63 7269 7469 6361  g.Logger.critica
+0000ae40: 6c22 0a20 2020 2020 2020 2029 2061 7320  l".        ) as 
+0000ae50: 5f63 2c20 7061 7463 6828 0a20 2020 2020  _c, patch(.     
+0000ae60: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
+0000ae70: 696f 2e64 6174 6162 6173 6543 6f72 652e  io.databaseCore.
+0000ae80: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
+0000ae90: 2e63 6f6d 6d69 7422 2c20 6175 746f 7370  .commit", autosp
+0000aea0: 6563 3d54 7275 650a 2020 2020 2020 2020  ec=True.        
+0000aeb0: 2920 6173 205f 636f 3a0a 2020 2020 2020  ) as _co:.      
+0000aec0: 2020 2020 2020 6462 632e 6372 6561 7465        dbc.create
+0000aed0: 5461 626c 6528 2274 6162 6c65 6e61 6d65  Table("tablename
+0000aee0: 222c 205b 5b22 6162 6322 2c20 2264 6566  ", [["abc", "def
+0000aef0: 225d 2c20 5b22 6768 6922 2c20 226a 6b6c  "], ["ghi", "jkl
+0000af00: 225d 5d29 0a20 2020 2020 2020 2020 2020  "]]).           
+0000af10: 205f 6365 2e61 7373 6572 745f 6361 6c6c   _ce.assert_call
+0000af20: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
+0000af30: 2020 2020 2020 2020 2020 2020 2020 6462                db
+0000af40: 632c 2022 4352 4541 5445 2054 4142 4c45  c, "CREATE TABLE
+0000af50: 2074 6162 6c65 6e61 6d65 2028 5c6e 6162   tablename (\nab
+0000af60: 6320 6465 662c 5c6e 6768 6920 6a6b 6c29  c def,\nghi jkl)
+0000af70: 3b22 0a20 2020 2020 2020 2020 2020 2029  ;".            )
+0000af80: 0a20 2020 2020 2020 2020 2020 205f 692e  .            _i.
+0000af90: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+0000afa0: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
+0000afb0: 2020 2020 2020 2020 2022 4352 4541 5445           "CREATE
+0000afc0: 2054 4142 4c45 2074 6162 6c65 6e61 6d65   TABLE tablename
+0000afd0: 2028 5c6e 6162 6320 6465 662c 5c6e 6768   (\nabc def,\ngh
+0000afe0: 6920 6a6b 6c29 3b5c 6e22 0a20 2020 2020  i jkl);\n".     
+0000aff0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000b000: 2020 2020 2064 6263 2e63 7265 6174 6554       dbc.createT
+0000b010: 6162 6c65 2822 7461 626c 656e 616d 6522  able("tablename"
+0000b020: 2c20 5b5b 2261 6263 222c 2022 6465 6622  , [["abc", "def"
+0000b030: 5d2c 205b 2267 6869 222c 2022 6a6b 6c22  ], ["ghi", "jkl"
+0000b040: 5d5d 290a 2020 2020 2020 2020 2020 2020  ]]).            
+0000b050: 5f63 2e61 7373 6572 745f 6361 6c6c 6564  _c.assert_called
+0000b060: 5f6f 6e63 655f 7769 7468 2822 4372 6561  _once_with("Crea
+0000b070: 7465 2074 6162 6c65 2074 6162 6c65 6e61  te table tablena
+0000b080: 6d65 2066 6169 6c65 6422 290a 2020 2020  me failed").    
+0000b090: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000b0a0: 6572 7445 7175 616c 285f 636f 2e63 616c  ertEqual(_co.cal
+0000b0b0: 6c5f 636f 756e 742c 2030 290a 2020 2020  l_count, 0).    
+0000b0c0: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
+0000b0d0: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+0000b0e0: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+0000b0f0: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
+0000b100: 4243 6f72 652e 636f 6e6e 4578 6563 222c  BCore.connExec",
+0000b110: 0a20 2020 2020 2020 2020 2020 2073 6964  .            sid
+0000b120: 655f 6566 6665 6374 3d5b 5472 7565 2c20  e_effect=[True, 
+0000b130: 4661 6c73 655d 2c0a 2020 2020 2020 2020  False],.        
+0000b140: 2020 2020 6175 746f 7370 6563 3d54 7275      autospec=Tru
+0000b150: 652c 0a20 2020 2020 2020 2029 2061 7320  e,.        ) as 
+0000b160: 5f63 652c 2070 6174 6368 2822 6c6f 6767  _ce, patch("logg
+0000b170: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
+0000b180: 2920 6173 205f 692c 2070 6174 6368 280a  ) as _i, patch(.
+0000b190: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0000b1a0: 6769 6e67 2e4c 6f67 6765 722e 6372 6974  ging.Logger.crit
+0000b1b0: 6963 616c 220a 2020 2020 2020 2020 2920  ical".        ) 
+0000b1c0: 6173 205f 632c 2070 6174 6368 280a 2020  as _c, patch(.  
+0000b1d0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
+0000b1e0: 6962 6c69 6f2e 6461 7461 6261 7365 436f  iblio.databaseCo
+0000b1f0: 7265 2e50 6879 7342 6962 6c69 6f44 4243  re.PhysBiblioDBC
+0000b200: 6f72 652e 636f 6d6d 6974 222c 2061 7574  ore.commit", aut
+0000b210: 6f73 7065 633d 5472 7565 0a20 2020 2020  ospec=True.     
+0000b220: 2020 2029 2061 7320 5f63 6f2c 2070 6174     ) as _co, pat
+0000b230: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0000b240: 2273 7973 2e65 7869 7422 0a20 2020 2020  "sys.exit".     
+0000b250: 2020 2029 2061 7320 5f65 3a0a 2020 2020     ) as _e:.    
+0000b260: 2020 2020 2020 2020 6462 632e 6372 6561          dbc.crea
+0000b270: 7465 5461 626c 6528 0a20 2020 2020 2020  teTable(.       
+0000b280: 2020 2020 2020 2020 2022 7461 626c 656e           "tablen
+0000b290: 616d 6522 2c20 5b5b 2261 6263 222c 2022  ame", [["abc", "
+0000b2a0: 6465 6622 5d2c 205b 2267 6869 222c 2022  def"], ["ghi", "
+0000b2b0: 6a6b 6c22 5d5d 2c20 6372 6974 6963 616c  jkl"]], critical
+0000b2c0: 3d54 7275 650a 2020 2020 2020 2020 2020  =True.          
+0000b2d0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000b2e0: 5f63 652e 6173 7365 7274 5f63 616c 6c65  _ce.assert_calle
+0000b2f0: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
+0000b300: 2020 2020 2020 2020 2020 2020 2064 6263               dbc
+0000b310: 2c20 2243 5245 4154 4520 5441 424c 4520  , "CREATE TABLE 
+0000b320: 7461 626c 656e 616d 6520 285c 6e61 6263  tablename (\nabc
+0000b330: 2064 6566 2c5c 6e67 6869 206a 6b6c 293b   def,\nghi jkl);
+0000b340: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0000b350: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
+0000b360: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+0000b370: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
+0000b380: 2020 2020 2020 2020 2243 5245 4154 4520          "CREATE 
+0000b390: 5441 424c 4520 7461 626c 656e 616d 6520  TABLE tablename 
+0000b3a0: 285c 6e61 6263 2064 6566 2c5c 6e67 6869  (\nabc def,\nghi
+0000b3b0: 206a 6b6c 293b 5c6e 220a 2020 2020 2020   jkl);\n".      
+0000b3c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000b3d0: 2020 2020 5f63 6f2e 6173 7365 7274 5f63      _co.assert_c
+0000b3e0: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+0000b3f0: 6462 6329 0a20 2020 2020 2020 2020 2020  dbc).           
+0000b400: 2064 6263 2e63 7265 6174 6554 6162 6c65   dbc.createTable
+0000b410: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000b420: 2020 2274 6162 6c65 6e61 6d65 222c 205b    "tablename", [
+0000b430: 5b22 6162 6322 2c20 2264 6566 225d 2c20  ["abc", "def"], 
+0000b440: 5b22 6768 6922 2c20 226a 6b6c 225d 5d2c  ["ghi", "jkl"]],
+0000b450: 2063 7269 7469 6361 6c3d 5472 7565 0a20   critical=True. 
+0000b460: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000b470: 2020 2020 2020 2020 205f 632e 6173 7365           _c.asse
+0000b480: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+0000b490: 6974 6828 2243 7265 6174 6520 7461 626c  ith("Create tabl
+0000b4a0: 6520 7461 626c 656e 616d 6520 6661 696c  e tablename fail
+0000b4b0: 6564 2229 0a20 2020 2020 2020 2020 2020  ed").           
+0000b4c0: 205f 652e 6173 7365 7274 5f63 616c 6c65   _e.assert_calle
+0000b4d0: 645f 6f6e 6365 5f77 6974 6828 3129 0a20  d_once_with(1). 
+0000b4e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000b4f0: 6173 7365 7274 4571 7561 6c28 5f63 6f2e  assertEqual(_co.
+0000b500: 6361 6c6c 5f63 6f75 6e74 2c20 3129 0a0a  call_count, 1)..
+0000b510: 2020 2020 6465 6620 7465 7374 5f63 7265      def test_cre
+0000b520: 6174 6554 6162 6c65 7328 7365 6c66 2c20  ateTables(self, 
+0000b530: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
+0000b540: 2222 2254 6573 7420 6372 6561 7465 5461  """Test createTa
+0000b550: 626c 6573 2222 220a 2020 2020 2020 2020  bles""".        
+0000b560: 6966 206f 732e 7061 7468 2e65 7869 7374  if os.path.exist
+0000b570: 7328 7465 6d70 4644 424e 616d 6529 3a0a  s(tempFDBName):.
+0000b580: 2020 2020 2020 2020 2020 2020 6f73 2e72              os.r
+0000b590: 656d 6f76 6528 7465 6d70 4644 424e 616d  emove(tempFDBNam
+0000b5a0: 6529 0a20 2020 2020 2020 206f 7065 6e28  e).        open(
+0000b5b0: 7465 6d70 4644 424e 616d 652c 2022 6122  tempFDBName, "a"
+0000b5c0: 292e 636c 6f73 6528 290a 2020 2020 2020  ).close().      
+0000b5d0: 2020 7769 7468 2070 6174 6368 2822 6f73    with patch("os
+0000b5e0: 2e70 6174 682e 6578 6973 7473 222c 2072  .path.exists", r
+0000b5f0: 6574 7572 6e5f 7661 6c75 653d 5472 7565  eturn_value=True
+0000b600: 2920 6173 205f 652c 2070 6174 6368 280a  ) as _e, patch(.
+0000b610: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+0000b620: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+0000b630: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
+0000b640: 4243 6f72 652e 6c6f 6164 5375 6243 6c61  BCore.loadSubCla
+0000b650: 7373 6573 222c 2061 7574 6f73 7065 633d  sses", autospec=
+0000b660: 5472 7565 0a20 2020 2020 2020 2029 2061  True.        ) a
+0000b670: 7320 5f6c 7363 3a0a 2020 2020 2020 2020  s _lsc:.        
+0000b680: 2020 2020 6462 6320 3d20 5068 7973 4269      dbc = PhysBi
+0000b690: 626c 696f 4442 436f 7265 2874 656d 7046  blioDBCore(tempF
+0000b6a0: 4442 4e61 6d65 2c20 7042 4c6f 6767 6572  DBName, pBLogger
+0000b6b0: 2c20 6e6f 4f70 656e 3d54 7275 6529 0a20  , noOpen=True). 
+0000b6c0: 2020 2020 2020 2064 6263 2e6f 7065 6e44         dbc.openD
+0000b6d0: 4228 290a 2020 2020 2020 2020 6f72 6967  B().        orig
+0000b6e0: 6375 7273 203d 2064 6263 2e63 7572 730a  curs = dbc.curs.
+0000b6f0: 2020 2020 2020 2020 6462 632e 6375 7273          dbc.curs
+0000b700: 203d 205b 5d0a 2020 2020 2020 2020 7769   = [].        wi
+0000b710: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
+0000b720: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
+0000b730: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
+0000b740: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
+0000b750: 6375 7273 4578 6563 222c 2061 7574 6f73  cursExec", autos
+0000b760: 7065 633d 5472 7565 0a20 2020 2020 2020  pec=True.       
+0000b770: 2029 2061 7320 5f63 7572 2c20 7061 7463   ) as _cur, patc
+0000b780: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+0000b790: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
+0000b7a0: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
+0000b7b0: 696f 4442 436f 7265 2e63 7265 6174 6554  ioDBCore.createT
+0000b7c0: 6162 6c65 222c 2061 7574 6f73 7065 633d  able", autospec=
+0000b7d0: 5472 7565 0a20 2020 2020 2020 2029 2061  True.        ) a
+0000b7e0: 7320 5f63 742c 2070 6174 6368 280a 2020  s _ct, patch(.  
+0000b7f0: 2020 2020 2020 2020 2020 226c 6f67 6769            "loggi
+0000b800: 6e67 2e4c 6f67 6765 722e 696e 666f 220a  ng.Logger.info".
+0000b810: 2020 2020 2020 2020 2920 6173 205f 692c          ) as _i,
+0000b820: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+0000b830: 2020 2020 226c 6f67 6769 6e67 2e4c 6f67      "logging.Log
+0000b840: 6765 722e 6572 726f 7222 0a20 2020 2020  ger.error".     
+0000b850: 2020 2029 2061 7320 5f65 2c20 7061 7463     ) as _e, patc
+0000b860: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+0000b870: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
+0000b880: 6173 6543 6f72 652e 5068 7973 4269 626c  aseCore.PhysBibl
+0000b890: 696f 4442 436f 7265 2e63 6f6d 6d69 7422  ioDBCore.commit"
+0000b8a0: 2c20 6175 746f 7370 6563 3d54 7275 650a  , autospec=True.
+0000b8b0: 2020 2020 2020 2020 2920 6173 205f 636f          ) as _co
+0000b8c0: 6d3a 0a20 2020 2020 2020 2020 2020 2077  m:.            w
+0000b8d0: 6974 6820 7365 6c66 2e61 7373 6572 7452  ith self.assertR
+0000b8e0: 6169 7365 7328 4174 7472 6962 7574 6545  aises(AttributeE
+0000b8f0: 7272 6f72 293a 0a20 2020 2020 2020 2020  rror):.         
+0000b900: 2020 2020 2020 2064 6263 2e63 7265 6174         dbc.creat
+0000b910: 6554 6162 6c65 7328 290a 2020 2020 2020  eTables().      
+0000b920: 2020 2020 2020 5f63 742e 6173 7365 7274        _ct.assert
+0000b930: 5f68 6173 5f63 616c 6c73 280a 2020 2020  _has_calls(.    
+0000b940: 2020 2020 2020 2020 2020 2020 5b63 616c              [cal
+0000b950: 6c28 6462 632c 2071 2c20 7461 626c 6546  l(dbc, q, tableF
+0000b960: 6965 6c64 735b 715d 2920 666f 7220 7120  ields[q]) for q 
+0000b970: 696e 2074 6162 6c65 4669 656c 6473 2e6b  in tableFields.k
+0000b980: 6579 7328 295d 0a20 2020 2020 2020 2020  eys()].         
+0000b990: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000b9a0: 205f 6375 722e 6173 7365 7274 5f61 6e79   _cur.assert_any
+0000b9b0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0000b9c0: 2020 2020 2020 2064 6263 2c20 2253 454c         dbc, "SEL
+0000b9d0: 4543 5420 6e61 6d65 2046 524f 4d20 7371  ECT name FROM sq
+0000b9e0: 6c69 7465 5f6d 6173 7465 7220 5748 4552  lite_master WHER
+0000b9f0: 4520 7479 7065 3d27 7461 626c 6527 3b22  E type='table';"
+0000ba00: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000ba10: 2020 2020 2020 2020 2020 205f 6375 722e             _cur.
+0000ba20: 6173 7365 7274 5f61 6e79 5f63 616c 6c28  assert_any_call(
+0000ba30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ba40: 2064 6263 2c20 2273 656c 6563 7420 2a20   dbc, "select * 
+0000ba50: 6672 6f6d 2063 6174 6567 6f72 6965 7320  from categories 
+0000ba60: 7768 6572 6520 6964 4361 7420 3d20 3020  where idCat = 0 
+0000ba70: 6f72 2069 6443 6174 203d 2031 5c6e 220a  or idCat = 1\n".
+0000ba80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000ba90: 2020 2020 2020 6462 632e 636c 6f73 6544        dbc.closeD
+0000baa0: 4228 290a 2020 2020 2020 2020 6f73 2e72  B().        os.r
+0000bab0: 656d 6f76 6528 7465 6d70 4644 424e 616d  emove(tempFDBNam
+0000bac0: 6529 0a20 2020 2020 2020 206f 7065 6e28  e).        open(
+0000bad0: 7465 6d70 4644 424e 616d 652c 2022 6122  tempFDBName, "a"
+0000bae0: 292e 636c 6f73 6528 290a 2020 2020 2020  ).close().      
+0000baf0: 2020 7769 7468 2070 6174 6368 2822 6f73    with patch("os
+0000bb00: 2e70 6174 682e 6578 6973 7473 222c 2072  .path.exists", r
+0000bb10: 6574 7572 6e5f 7661 6c75 653d 5472 7565  eturn_value=True
+0000bb20: 2920 6173 205f 652c 2070 6174 6368 280a  ) as _e, patch(.
+0000bb30: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+0000bb40: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+0000bb50: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
+0000bb60: 4243 6f72 652e 6c6f 6164 5375 6243 6c61  BCore.loadSubCla
+0000bb70: 7373 6573 222c 2061 7574 6f73 7065 633d  sses", autospec=
+0000bb80: 5472 7565 0a20 2020 2020 2020 2029 2061  True.        ) a
+0000bb90: 7320 5f6c 7363 3a0a 2020 2020 2020 2020  s _lsc:.        
+0000bba0: 2020 2020 6462 6320 3d20 5068 7973 4269      dbc = PhysBi
+0000bbb0: 626c 696f 4442 436f 7265 2874 656d 7046  blioDBCore(tempF
+0000bbc0: 4442 4e61 6d65 2c20 7042 4c6f 6767 6572  DBName, pBLogger
+0000bbd0: 2c20 6e6f 4f70 656e 3d54 7275 6529 0a20  , noOpen=True). 
+0000bbe0: 2020 2020 2020 2064 6263 2e6f 7065 6e44         dbc.openD
+0000bbf0: 4228 290a 2020 2020 2020 2020 7769 7468  B().        with
+0000bc00: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+0000bc10: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+0000bc20: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
+0000bc30: 7342 6962 6c69 6f44 4243 6f72 652e 636f  sBiblioDBCore.co
+0000bc40: 6e6e 4578 6563 222c 0a20 2020 2020 2020  nnExec",.       
+0000bc50: 2020 2020 2073 6964 655f 6566 6665 6374       side_effect
+0000bc60: 3d5b 5472 7565 2c20 4661 6c73 655d 2c0a  =[True, False],.
+0000bc70: 2020 2020 2020 2020 2020 2020 6175 746f              auto
+0000bc80: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
+0000bc90: 2020 2029 2061 7320 5f63 6f6e 2c20 7061     ) as _con, pa
+0000bca0: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+0000bcb0: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
+0000bcc0: 6162 6173 6543 6f72 652e 5068 7973 4269  abaseCore.PhysBi
+0000bcd0: 626c 696f 4442 436f 7265 2e63 7265 6174  blioDBCore.creat
+0000bce0: 6554 6162 6c65 222c 2061 7574 6f73 7065  eTable", autospe
+0000bcf0: 633d 5472 7565 0a20 2020 2020 2020 2029  c=True.        )
+0000bd00: 2061 7320 5f63 742c 2070 6174 6368 280a   as _ct, patch(.
+0000bd10: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0000bd20: 6769 6e67 2e4c 6f67 6765 722e 696e 666f  ging.Logger.info
+0000bd30: 220a 2020 2020 2020 2020 2920 6173 205f  ".        ) as _
+0000bd40: 692c 2070 6174 6368 280a 2020 2020 2020  i, patch(.      
+0000bd50: 2020 2020 2020 226c 6f67 6769 6e67 2e4c        "logging.L
+0000bd60: 6f67 6765 722e 6572 726f 7222 0a20 2020  ogger.error".   
+0000bd70: 2020 2020 2029 2061 7320 5f65 2c20 7061       ) as _e, pa
+0000bd80: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+0000bd90: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
+0000bda0: 6162 6173 6543 6f72 652e 5068 7973 4269  abaseCore.PhysBi
+0000bdb0: 626c 696f 4442 436f 7265 2e63 6f6d 6d69  blioDBCore.commi
+0000bdc0: 7422 2c20 6175 746f 7370 6563 3d54 7275  t", autospec=Tru
+0000bdd0: 650a 2020 2020 2020 2020 2920 6173 205f  e.        ) as _
+0000bde0: 636f 6d3a 0a20 2020 2020 2020 2020 2020  com:.           
+0000bdf0: 2064 6263 2e63 7265 6174 6554 6162 6c65   dbc.createTable
+0000be00: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0000be10: 5f63 6f6e 2e61 7373 6572 745f 6361 6c6c  _con.assert_call
+0000be20: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
+0000be30: 2020 2020 2020 2020 2020 2020 2020 6462                db
+0000be40: 632c 0a20 2020 2020 2020 2020 2020 2020  c,.             
+0000be50: 2020 2022 494e 5345 5254 2069 6e74 6f20     "INSERT into 
+0000be60: 6361 7465 676f 7269 6573 2022 0a20 2020  categories ".   
+0000be70: 2020 2020 2020 2020 2020 2020 202b 2022               + "
+0000be80: 2869 6443 6174 2c20 6e61 6d65 2c20 6465  (idCat, name, de
+0000be90: 7363 7269 7074 696f 6e2c 2070 6172 656e  scription, paren
+0000bea0: 7443 6174 2c20 6f72 6429 2076 616c 7565  tCat, ord) value
+0000beb0: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
+0000bec0: 2020 2020 2b20 2728 302c 224d 6169 6e22      + '(0,"Main"
+0000bed0: 2c22 5468 6973 2069 7320 7468 6520 6d61  ,"This is the ma
+0000bee0: 696e 2063 6174 6567 6f72 792e 2027 0a20  in category. '. 
+0000bef0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+0000bf00: 2027 416c 6c20 7468 6520 6f74 6865 7220   'All the other 
+0000bf10: 6f6e 6573 2061 7265 2073 7562 6361 7465  ones are subcate
+0000bf20: 676f 7269 6573 206f 6620 7468 6973 206f  gories of this o
+0000bf30: 6e65 222c 302c 3029 2c20 270a 2020 2020  ne",0,0), '.    
+0000bf40: 2020 2020 2020 2020 2020 2020 2b20 2728              + '(
+0000bf50: 312c 2254 6167 7322 2c22 5573 6520 7468  1,"Tags","Use th
+0000bf60: 6973 2063 6174 6567 6f72 7920 746f 2073  is category to s
+0000bf70: 746f 7265 2074 6167 7320 270a 2020 2020  tore tags '.    
+0000bf80: 2020 2020 2020 2020 2020 2020 2b20 2728              + '(
+0000bf90: 7375 6368 2061 733a 206f 6e67 6f69 6e67  such as: ongoing
+0000bfa0: 2070 726f 6a65 6374 732c 2074 656d 706f   projects, tempo
+0000bfb0: 7261 7279 2063 6174 732c 2e2e 2e29 222c  rary cats,...)",
+0000bfc0: 302c 3029 5c6e 272c 0a20 2020 2020 2020  0,0)\n',.       
+0000bfd0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000bfe0: 2020 205f 636f 6d2e 6173 7365 7274 5f63     _com.assert_c
+0000bff0: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+0000c000: 6462 6329 0a20 2020 2020 2020 2020 2020  dbc).           
+0000c010: 2064 6263 2e75 6e64 6f28 290a 2020 2020   dbc.undo().    
+0000c020: 2020 2020 2020 2020 6462 632e 6372 6561          dbc.crea
+0000c030: 7465 5461 626c 6573 2829 2020 2320 7265  teTables()  # re
+0000c040: 7065 6174 2c20 6e6f 7720 636f 6e6e 4578  peat, now connEx
+0000c050: 6563 2067 6976 6573 2046 616c 7365 0a20  ec gives False. 
+0000c060: 2020 2020 2020 2020 2020 205f 652e 6173             _e.as
+0000c070: 7365 7274 5f61 6e79 5f63 616c 6c28 2249  sert_any_call("I
+0000c080: 6e73 6572 7420 6d61 696e 2063 6174 6567  nsert main categ
+0000c090: 6f72 6965 7320 6661 696c 6564 2229 0a0a  ories failed")..
+0000c0a0: 2020 2020 6465 6620 7465 7374 5f63 6865      def test_che
+0000c0b0: 636b 4461 7461 6261 7365 5570 6461 7465  ckDatabaseUpdate
+0000c0c0: 735f 4442 4328 7365 6c66 2c20 2a61 7267  s_DBC(self, *arg
+0000c0d0: 7329 3a0a 2020 2020 2020 2020 2222 2274  s):.        """t
+0000c0e0: 6573 7420 6368 6563 6b44 6174 6162 6173  est checkDatabas
+0000c0f0: 6555 7064 6174 6573 2069 6e20 5068 7973  eUpdates in Phys
+0000c100: 4269 626c 696f 4442 436f 7265 2222 220a  BiblioDBCore""".
+0000c110: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0000c120: 6368 2822 6f73 2e70 6174 682e 6578 6973  ch("os.path.exis
+0000c130: 7473 222c 2072 6574 7572 6e5f 7661 6c75  ts", return_valu
+0000c140: 653d 5472 7565 2920 6173 205f 652c 2070  e=True) as _e, p
+0000c150: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+0000c160: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
+0000c170: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
+0000c180: 6962 6c69 6f44 4243 6f72 652e 6c6f 6164  iblioDBCore.load
+0000c190: 5375 6243 6c61 7373 6573 222c 2061 7574  SubClasses", aut
+0000c1a0: 6f73 7065 633d 5472 7565 0a20 2020 2020  ospec=True.     
+0000c1b0: 2020 2029 2061 7320 5f6c 7363 3a0a 2020     ) as _lsc:.  
+0000c1c0: 2020 2020 2020 2020 2020 6462 6320 3d20            dbc = 
+0000c1d0: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
+0000c1e0: 2874 656d 7044 424e 616d 652c 2070 424c  (tempDBName, pBL
+0000c1f0: 6f67 6765 722c 206e 6f4f 7065 6e3d 5472  ogger, noOpen=Tr
+0000c200: 7565 290a 2020 2020 2020 2020 6462 632e  ue).        dbc.
+0000c210: 6375 7273 203d 205b 0a20 2020 2020 2020  curs = [.       
+0000c220: 2020 2020 205b 302c 2022 7469 746c 6522       [0, "title"
+0000c230: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+0000c240: 312c 2022 636f 6c75 6d6e 225d 2c0a 2020  1, "column"],.  
+0000c250: 2020 2020 2020 2020 2020 5b32 2c20 2262            [2, "b
+0000c260: 6962 6469 6374 225d 2c0a 2020 2020 2020  ibdict"],.      
+0000c270: 2020 2020 2020 5b33 2c20 2263 6974 6174        [3, "citat
+0000c280: 696f 6e73 225d 2c0a 2020 2020 2020 2020  ions"],.        
+0000c290: 2020 2020 5b34 2c20 2263 6974 6174 696f      [4, "citatio
+0000c2a0: 6e73 5f6e 6f5f 7365 6c66 225d 2c0a 2020  ns_no_self"],.  
+0000c2b0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+0000c2c0: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
+0000c2d0: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
+0000c2e0: 2920 6173 205f 692c 2070 6174 6368 280a  ) as _i, patch(.
+0000c2f0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0000c300: 6769 6e67 2e4c 6f67 6765 722e 6572 726f  ging.Logger.erro
+0000c310: 7222 0a20 2020 2020 2020 2029 2061 7320  r".        ) as 
+0000c320: 5f65 2c20 7061 7463 6828 0a20 2020 2020  _e, patch(.     
+0000c330: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
+0000c340: 696f 2e64 6174 6162 6173 6543 6f72 652e  io.databaseCore.
+0000c350: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
+0000c360: 2e63 6f6d 6d69 7422 2c20 6175 746f 7370  .commit", autosp
+0000c370: 6563 3d54 7275 650a 2020 2020 2020 2020  ec=True.        
+0000c380: 2920 6173 205f 636f 2c20 7061 7463 6828  ) as _co, patch(
+0000c390: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
+0000c3a0: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
+0000c3b0: 6543 6f72 652e 5068 7973 4269 626c 696f  eCore.PhysBiblio
+0000c3c0: 4442 436f 7265 2e75 6e64 6f22 2c20 6175  DBCore.undo", au
+0000c3d0: 746f 7370 6563 3d54 7275 650a 2020 2020  tospec=True.    
+0000c3e0: 2020 2020 2920 6173 205f 756e 2c20 7061      ) as _un, pa
+0000c3f0: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+0000c400: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
+0000c410: 6162 6173 6543 6f72 652e 5068 7973 4269  abaseCore.PhysBi
+0000c420: 626c 696f 4442 436f 7265 2e63 7572 7345  blioDBCore.cursE
+0000c430: 7865 6322 2c20 6175 746f 7370 6563 3d54  xec", autospec=T
+0000c440: 7275 650a 2020 2020 2020 2020 2920 6173  rue.        ) as
+0000c450: 205f 6375 652c 2070 6174 6368 280a 2020   _cue, patch(.  
+0000c460: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
+0000c470: 6962 6c69 6f2e 6461 7461 6261 7365 436f  iblio.databaseCo
+0000c480: 7265 2e50 6879 7342 6962 6c69 6f44 4243  re.PhysBiblioDBC
+0000c490: 6f72 652e 636f 6e6e 4578 6563 222c 0a20  ore.connExec",. 
+0000c4a0: 2020 2020 2020 2020 2020 2073 6964 655f             side_
+0000c4b0: 6566 6665 6374 3d5b 5472 7565 2c20 4661  effect=[True, Fa
+0000c4c0: 6c73 652c 2054 7275 652c 2054 7275 652c  lse, True, True,
+0000c4d0: 2046 616c 7365 2c20 4661 6c73 655d 2c0a   False, False],.
+0000c4e0: 2020 2020 2020 2020 2020 2020 6175 746f              auto
+0000c4f0: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
+0000c500: 2020 2029 2061 7320 5f63 6f65 3a0a 2020     ) as _coe:.  
+0000c510: 2020 2020 2020 2020 2020 6462 632e 6368            dbc.ch
+0000c520: 6563 6b44 6174 6162 6173 6555 7064 6174  eckDatabaseUpdat
+0000c530: 6573 2829 0a20 2020 2020 2020 2020 2020  es().           
+0000c540: 205f 6375 652e 6173 7365 7274 5f63 616c   _cue.assert_cal
+0000c550: 6c65 645f 6f6e 6365 5f77 6974 6828 6462  led_once_with(db
+0000c560: 632c 2022 5052 4147 4d41 2074 6162 6c65  c, "PRAGMA table
+0000c570: 5f69 6e66 6f28 656e 7472 6965 7329 3b22  _info(entries);"
+0000c580: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000c590: 6c66 2e61 7373 6572 7445 7175 616c 285f  lf.assertEqual(_
+0000c5a0: 636f 652e 6361 6c6c 5f63 6f75 6e74 2c20  coe.call_count, 
+0000c5b0: 3029 0a20 2020 2020 2020 2020 2020 2064  0).            d
+0000c5c0: 6263 2e63 7572 7320 3d20 5b0a 2020 2020  bc.curs = [.    
+0000c5d0: 2020 2020 2020 2020 2020 2020 5b30 2c20              [0, 
+0000c5e0: 2274 6974 6c65 225d 2c0a 2020 2020 2020  "title"],.      
+0000c5f0: 2020 2020 2020 2020 2020 5b31 2c20 2263            [1, "c
+0000c600: 6f6c 756d 6e22 5d2c 0a20 2020 2020 2020  olumn"],.       
+0000c610: 2020 2020 2020 2020 205b 322c 2022 6369           [2, "ci
+0000c620: 7461 7469 6f6e 7322 5d2c 0a20 2020 2020  tations"],.     
+0000c630: 2020 2020 2020 2020 2020 205b 332c 2022             [3, "
+0000c640: 6369 7461 7469 6f6e 735f 6e6f 5f73 656c  citations_no_sel
+0000c650: 6622 5d2c 0a20 2020 2020 2020 2020 2020  f"],.           
+0000c660: 205d 0a20 2020 2020 2020 2020 2020 2064   ].            d
+0000c670: 6263 2e63 6865 636b 4461 7461 6261 7365  bc.checkDatabase
+0000c680: 5570 6461 7465 7328 290a 2020 2020 2020  Updates().      
+0000c690: 2020 2020 2020 5f63 6f65 2e61 7373 6572        _coe.asser
+0000c6a0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+0000c6b0: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
+0000c6c0: 2020 2020 6462 632c 2022 414c 5445 5220      dbc, "ALTER 
+0000c6d0: 5441 424c 4520 656e 7472 6965 7320 4144  TABLE entries AD
+0000c6e0: 4420 434f 4c55 4d4e 2062 6962 6469 6374  D COLUMN bibdict
+0000c6f0: 2074 6578 743b 220a 2020 2020 2020 2020   text;".        
+0000c700: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000c710: 2020 5f63 6f2e 6173 7365 7274 5f63 616c    _co.assert_cal
+0000c720: 6c65 645f 6f6e 6365 5f77 6974 6828 6462  led_once_with(db
+0000c730: 6329 0a20 2020 2020 2020 2020 2020 205f  c).            _
+0000c740: 692e 6173 7365 7274 5f63 616c 6c65 645f  i.assert_called_
+0000c750: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
+0000c760: 2020 2020 2020 2020 2020 2022 4e65 7720             "New 
+0000c770: 636f 6c75 6d6e 2069 6e20 7461 626c 6520  column in table 
+0000c780: 2765 6e74 7269 6573 273a 2027 6269 6264  'entries': 'bibd
+0000c790: 6963 7427 2028 7465 7874 292e 220a 2020  ict' (text).".  
+0000c7a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000c7b0: 2020 2020 2020 2020 5f65 2e61 7373 6572          _e.asser
+0000c7c0: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+0000c7d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000c7e0: 6173 7365 7274 4571 7561 6c28 5f75 6e2e  assertEqual(_un.
+0000c7f0: 6361 6c6c 5f63 6f75 6e74 2c20 3029 0a20  call_count, 0). 
+0000c800: 2020 2020 2020 2020 2020 2064 6263 2e63             dbc.c
+0000c810: 6865 636b 4461 7461 6261 7365 5570 6461  heckDatabaseUpda
+0000c820: 7465 7328 290a 2020 2020 2020 2020 2020  tes().          
+0000c830: 2020 5f63 6f2e 6173 7365 7274 5f63 616c    _co.assert_cal
+0000c840: 6c65 645f 6f6e 6365 5f77 6974 6828 6462  led_once_with(db
+0000c850: 6329 0a20 2020 2020 2020 2020 2020 205f  c).            _
+0000c860: 652e 6173 7365 7274 5f63 616c 6c65 645f  e.assert_called_
+0000c870: 6f6e 6365 5f77 6974 6828 2243 616e 6e6f  once_with("Canno
+0000c880: 7420 616c 7465 7220 7461 626c 6520 2765  t alter table 'e
+0000c890: 6e74 7269 6573 2721 2229 0a20 2020 2020  ntries'!").     
+0000c8a0: 2020 2020 2020 205f 756e 2e61 7373 6572         _un.asser
+0000c8b0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+0000c8c0: 7468 2864 6263 290a 2020 2020 2020 2020  th(dbc).        
+0000c8d0: 2020 2020 5f75 6e2e 7265 7365 745f 6d6f      _un.reset_mo
+0000c8e0: 636b 2829 0a20 2020 2020 2020 2020 2020  ck().           
+0000c8f0: 205f 652e 7265 7365 745f 6d6f 636b 2829   _e.reset_mock()
+0000c900: 0a20 2020 2020 2020 2020 2020 2064 6263  .            dbc
+0000c910: 2e63 7572 7320 3d20 5b5b 302c 2022 7469  .curs = [[0, "ti
+0000c920: 746c 6522 5d2c 205b 312c 2022 636f 6c75  tle"], [1, "colu
+0000c930: 6d6e 225d 2c20 5b32 2c20 2262 6962 6469  mn"], [2, "bibdi
+0000c940: 6374 225d 5d0a 2020 2020 2020 2020 2020  ct"]].          
+0000c950: 2020 5f63 6f65 2e72 6573 6574 5f6d 6f63    _coe.reset_moc
+0000c960: 6b28 290a 2020 2020 2020 2020 2020 2020  k().            
+0000c970: 5f63 6f2e 7265 7365 745f 6d6f 636b 2829  _co.reset_mock()
+0000c980: 0a20 2020 2020 2020 2020 2020 2064 6263  .            dbc
+0000c990: 2e63 6865 636b 4461 7461 6261 7365 5570  .checkDatabaseUp
+0000c9a0: 6461 7465 7328 290a 2020 2020 2020 2020  dates().        
+0000c9b0: 2020 2020 5f63 6f65 2e61 7373 6572 745f      _coe.assert_
+0000c9c0: 616e 795f 6361 6c6c 280a 2020 2020 2020  any_call(.      
+0000c9d0: 2020 2020 2020 2020 2020 6462 632c 2022            dbc, "
+0000c9e0: 414c 5445 5220 5441 424c 4520 656e 7472  ALTER TABLE entr
+0000c9f0: 6965 7320 4144 4420 434f 4c55 4d4e 2063  ies ADD COLUMN c
+0000ca00: 6974 6174 696f 6e73 2069 6e74 6567 6572  itations integer
+0000ca10: 2064 6566 6175 6c74 2030 3b22 0a20 2020   default 0;".   
+0000ca20: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000ca30: 2020 2020 2020 205f 636f 652e 6173 7365         _coe.asse
+0000ca40: 7274 5f61 6e79 5f63 616c 6c28 0a20 2020  rt_any_call(.   
+0000ca50: 2020 2020 2020 2020 2020 2020 2064 6263               dbc
+0000ca60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ca70: 2020 2241 4c54 4552 2054 4142 4c45 2065    "ALTER TABLE e
+0000ca80: 6e74 7269 6573 2041 4444 2043 4f4c 554d  ntries ADD COLUM
+0000ca90: 4e20 6369 7461 7469 6f6e 735f 6e6f 5f73  N citations_no_s
+0000caa0: 656c 6620 696e 7465 6765 7220 6465 6661  elf integer defa
+0000cab0: 756c 7420 303b 222c 0a20 2020 2020 2020  ult 0;",.       
+0000cac0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000cad0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0000cae0: 7561 6c28 5f63 6f2e 6361 6c6c 5f63 6f75  ual(_co.call_cou
+0000caf0: 6e74 2c20 3229 0a20 2020 2020 2020 2020  nt, 2).         
+0000cb00: 2020 205f 692e 6173 7365 7274 5f61 6e79     _i.assert_any
+0000cb10: 5f63 616c 6c28 224e 6577 2063 6f6c 756d  _call("New colum
+0000cb20: 6e20 696e 2074 6162 6c65 2027 656e 7472  n in table 'entr
+0000cb30: 6965 7327 3a20 2763 6974 6174 696f 6e73  ies': 'citations
+0000cb40: 2720 2869 6e74 6567 6572 292e 2229 0a20  ' (integer)."). 
+0000cb50: 2020 2020 2020 2020 2020 205f 692e 6173             _i.as
+0000cb60: 7365 7274 5f61 6e79 5f63 616c 6c28 0a20  sert_any_call(. 
+0000cb70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000cb80: 4e65 7720 636f 6c75 6d6e 2069 6e20 7461  New column in ta
+0000cb90: 626c 6520 2765 6e74 7269 6573 273a 2027  ble 'entries': '
+0000cba0: 6369 7461 7469 6f6e 735f 6e6f 5f73 656c  citations_no_sel
+0000cbb0: 6627 2028 696e 7465 6765 7229 2e22 0a20  f' (integer).". 
+0000cbc0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000cbd0: 2020 2020 2020 2020 205f 652e 6173 7365           _e.asse
+0000cbe0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+0000cbf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000cc00: 2e61 7373 6572 7445 7175 616c 285f 756e  .assertEqual(_un
+0000cc10: 2e63 616c 6c5f 636f 756e 742c 2030 290a  .call_count, 0).
+0000cc20: 2020 2020 2020 2020 2020 2020 6462 632e              dbc.
+0000cc30: 6368 6563 6b44 6174 6162 6173 6555 7064  checkDatabaseUpd
+0000cc40: 6174 6573 2829 0a20 2020 2020 2020 2020  ates().         
+0000cc50: 2020 205f 652e 6173 7365 7274 5f61 6e79     _e.assert_any
+0000cc60: 5f63 616c 6c28 2243 616e 6e6f 7420 616c  _call("Cannot al
+0000cc70: 7465 7220 7461 626c 6520 2765 6e74 7269  ter table 'entri
+0000cc80: 6573 2721 2229 0a20 2020 2020 2020 2020  es'!").         
+0000cc90: 2020 205f 756e 2e61 7373 6572 745f 616e     _un.assert_an
+0000cca0: 795f 6361 6c6c 2864 6263 290a 0a20 2020  y_call(dbc)..   
+0000ccb0: 2064 6566 2074 6573 745f 5068 7973 4269   def test_PhysBi
+0000ccc0: 626c 696f 4442 5375 6228 7365 6c66 2c20  blioDBSub(self, 
+0000ccd0: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
+0000cce0: 2222 2274 6573 7420 6d65 7468 6f64 7320  """test methods 
+0000ccf0: 696e 2050 6879 7342 6962 6c69 6f44 4253  in PhysBiblioDBS
+0000cd00: 7562 2222 220a 2020 2020 2020 2020 7769  ub""".        wi
+0000cd10: 7468 2070 6174 6368 2822 6f73 2e70 6174  th patch("os.pat
+0000cd20: 682e 6578 6973 7473 222c 2072 6574 7572  h.exists", retur
+0000cd30: 6e5f 7661 6c75 653d 5472 7565 2920 6173  n_value=True) as
+0000cd40: 205f 652c 2070 6174 6368 280a 2020 2020   _e, patch(.    
+0000cd50: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
+0000cd60: 6c69 6f2e 6461 7461 6261 7365 436f 7265  lio.databaseCore
+0000cd70: 2e50 6879 7342 6962 6c69 6f44 4243 6f72  .PhysBiblioDBCor
+0000cd80: 652e 6c6f 6164 5375 6243 6c61 7373 6573  e.loadSubClasses
+0000cd90: 222c 2061 7574 6f73 7065 633d 5472 7565  ", autospec=True
+0000cda0: 0a20 2020 2020 2020 2029 2061 7320 5f6c  .        ) as _l
+0000cdb0: 7363 3a0a 2020 2020 2020 2020 2020 2020  sc:.            
+0000cdc0: 6462 6320 3d20 5068 7973 4269 626c 696f  dbc = PhysBiblio
+0000cdd0: 4442 436f 7265 2874 656d 7044 424e 616d  DBCore(tempDBNam
+0000cde0: 652c 2070 424c 6f67 6765 7229 0a0a 2020  e, pBLogger)..  
+0000cdf0: 2020 2020 2020 2320 5f5f 696e 6974 5f5f        # __init__
+0000ce00: 0a20 2020 2020 2020 2064 6273 203d 2050  .        dbs = P
+0000ce10: 6879 7342 6962 6c69 6f44 4253 7562 2864  hysBiblioDBSub(d
+0000ce20: 6263 290a 2020 2020 2020 2020 7365 6c66  bc).        self
+0000ce30: 2e61 7373 6572 7445 7175 616c 2864 6273  .assertEqual(dbs
+0000ce40: 2e6d 6169 6e44 422c 2064 6263 290a 2020  .mainDB, dbc).  
+0000ce50: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000ce60: 7445 7175 616c 2864 6273 2e6d 6169 6e44  tEqual(dbs.mainD
+0000ce70: 422e 7461 626c 6546 6965 6c64 732c 2064  B.tableFields, d
+0000ce80: 6263 2e74 6162 6c65 4669 656c 6473 290a  bc.tableFields).
+0000ce90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000cea0: 6572 7445 7175 616c 2864 6273 2e6d 6169  ertEqual(dbs.mai
+0000ceb0: 6e44 422e 7461 626c 6543 6f6c 732c 2064  nDB.tableCols, d
+0000cec0: 6263 2e74 6162 6c65 436f 6c73 290a 2020  bc.tableCols).  
+0000ced0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000cee0: 7445 7175 616c 2864 6273 2e6d 6169 6e44  tEqual(dbs.mainD
+0000cef0: 422e 636f 6e6e 2c20 6462 632e 636f 6e6e  B.conn, dbc.conn
+0000cf00: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0000cf10: 7373 6572 7445 7175 616c 2864 6273 2e6d  ssertEqual(dbs.m
+0000cf20: 6169 6e44 422e 6375 7273 2c20 6462 632e  ainDB.curs, dbc.
+0000cf30: 6375 7273 290a 2020 2020 2020 2020 7365  curs).        se
+0000cf40: 6c66 2e61 7373 6572 7445 7175 616c 2864  lf.assertEqual(d
+0000cf50: 6273 2e6d 6169 6e44 422e 6462 6e61 6d65  bs.mainDB.dbname
+0000cf60: 2c20 6462 632e 6462 6e61 6d65 290a 2020  , dbc.dbname).  
+0000cf70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000cf80: 7445 7175 616c 2864 6273 2e6c 6173 7446  tEqual(dbs.lastF
+0000cf90: 6574 6368 6564 2c20 4e6f 6e65 290a 2020  etched, None).  
+0000cfa0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000cfb0: 7445 7175 616c 2864 6273 2e63 6174 7348  tEqual(dbs.catsH
+0000cfc0: 6965 722c 204e 6f6e 6529 0a0a 2020 2020  ier, None)..    
+0000cfd0: 2020 2020 2320 636c 6f73 6544 420a 2020      # closeDB.  
+0000cfe0: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+0000cff0: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
+0000d000: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
+0000d010: 7365 436f 7265 2e50 6879 7342 6962 6c69  seCore.PhysBibli
+0000d020: 6f44 4243 6f72 652e 636c 6f73 6544 4222  oDBCore.closeDB"
+0000d030: 2c20 6175 746f 7370 6563 3d54 7275 650a  , autospec=True.
+0000d040: 2020 2020 2020 2020 2920 6173 205f 663a          ) as _f:
+0000d050: 0a20 2020 2020 2020 2020 2020 2064 6273  .            dbs
+0000d060: 2e63 6c6f 7365 4442 2829 0a20 2020 2020  .closeDB().     
+0000d070: 2020 2020 2020 205f 662e 6173 7365 7274         _f.assert
+0000d080: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+0000d090: 6828 6462 732e 6d61 696e 4442 290a 0a20  h(dbs.mainDB).. 
+0000d0a0: 2020 2020 2020 2023 2063 6f6d 6d69 740a         # commit.
+0000d0b0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0000d0c0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0000d0d0: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0000d0e0: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
+0000d0f0: 6c69 6f44 4243 6f72 652e 636f 6d6d 6974  lioDBCore.commit
+0000d100: 222c 2061 7574 6f73 7065 633d 5472 7565  ", autospec=True
+0000d110: 0a20 2020 2020 2020 2029 2061 7320 5f66  .        ) as _f
+0000d120: 3a0a 2020 2020 2020 2020 2020 2020 6462  :.            db
+0000d130: 732e 636f 6d6d 6974 2829 0a20 2020 2020  s.commit().     
+0000d140: 2020 2020 2020 205f 662e 6173 7365 7274         _f.assert
+0000d150: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+0000d160: 6828 6462 732e 6d61 696e 4442 290a 0a20  h(dbs.mainDB).. 
+0000d170: 2020 2020 2020 2023 2063 6f6e 6e45 7865         # connExe
+0000d180: 630a 2020 2020 2020 2020 7769 7468 2070  c.        with p
+0000d190: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+0000d1a0: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
+0000d1b0: 7461 6261 7365 436f 7265 2e50 6879 7342  tabaseCore.PhysB
+0000d1c0: 6962 6c69 6f44 4243 6f72 652e 636f 6e6e  iblioDBCore.conn
+0000d1d0: 4578 6563 222c 0a20 2020 2020 2020 2020  Exec",.         
+0000d1e0: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
+0000d1f0: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
+0000d200: 2020 2061 7574 6f73 7065 633d 5472 7565     autospec=True
+0000d210: 2c0a 2020 2020 2020 2020 2920 6173 205f  ,.        ) as _
+0000d220: 663a 0a20 2020 2020 2020 2020 2020 2073  f:.            s
+0000d230: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0000d240: 6462 732e 636f 6e6e 4578 6563 2822 6122  dbs.connExec("a"
+0000d250: 292c 2022 6162 6322 290a 2020 2020 2020  ), "abc").      
+0000d260: 2020 2020 2020 5f66 2e61 7373 6572 745f        _f.assert_
+0000d270: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+0000d280: 2864 6273 2e6d 6169 6e44 422c 2022 6122  (dbs.mainDB, "a"
+0000d290: 2c20 6461 7461 3d4e 6f6e 6529 0a20 2020  , data=None).   
+0000d2a0: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+0000d2b0: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
+0000d2c0: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
+0000d2d0: 6543 6f72 652e 5068 7973 4269 626c 696f  eCore.PhysBiblio
+0000d2e0: 4442 436f 7265 2e63 6f6e 6e45 7865 6322  DBCore.connExec"
+0000d2f0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+0000d300: 7475 726e 5f76 616c 7565 3d22 6162 6322  turn_value="abc"
+0000d310: 2c0a 2020 2020 2020 2020 2020 2020 6175  ,.            au
+0000d320: 746f 7370 6563 3d54 7275 652c 0a20 2020  tospec=True,.   
+0000d330: 2020 2020 2029 2061 7320 5f66 3a0a 2020       ) as _f:.  
+0000d340: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000d350: 7373 6572 7445 7175 616c 2864 6273 2e63  ssertEqual(dbs.c
+0000d360: 6f6e 6e45 7865 6328 2261 222c 2064 6174  onnExec("a", dat
+0000d370: 613d 2262 2229 2c20 2261 6263 2229 0a20  a="b"), "abc"). 
+0000d380: 2020 2020 2020 2020 2020 205f 662e 6173             _f.as
+0000d390: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+0000d3a0: 5f77 6974 6828 6462 732e 6d61 696e 4442  _with(dbs.mainDB
+0000d3b0: 2c20 2261 222c 2064 6174 613d 2262 2229  , "a", data="b")
+0000d3c0: 0a0a 2020 2020 2020 2020 2320 6375 7273  ..        # curs
+0000d3d0: 4578 6563 0a20 2020 2020 2020 2077 6974  Exec.        wit
+0000d3e0: 6820 7061 7463 6828 0a20 2020 2020 2020  h patch(.       
+0000d3f0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+0000d400: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
+0000d410: 7973 4269 626c 696f 4442 436f 7265 2e63  ysBiblioDBCore.c
+0000d420: 7572 7345 7865 6322 2c0a 2020 2020 2020  ursExec",.      
+0000d430: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
+0000d440: 7565 3d22 6162 6322 2c0a 2020 2020 2020  ue="abc",.      
+0000d450: 2020 2020 2020 6175 746f 7370 6563 3d54        autospec=T
+0000d460: 7275 652c 0a20 2020 2020 2020 2029 2061  rue,.        ) a
+0000d470: 7320 5f66 3a0a 2020 2020 2020 2020 2020  s _f:.          
+0000d480: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0000d490: 616c 2864 6273 2e63 7572 7345 7865 6328  al(dbs.cursExec(
+0000d4a0: 2261 2229 2c20 2261 6263 2229 0a20 2020  "a"), "abc").   
+0000d4b0: 2020 2020 2020 2020 205f 662e 6173 7365           _f.asse
+0000d4c0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+0000d4d0: 6974 6828 6462 732e 6d61 696e 4442 2c20  ith(dbs.mainDB, 
+0000d4e0: 2261 222c 2064 6174 613d 4e6f 6e65 290a  "a", data=None).
+0000d4f0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0000d500: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0000d510: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0000d520: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
+0000d530: 6c69 6f44 4243 6f72 652e 6375 7273 4578  lioDBCore.cursEx
+0000d540: 6563 222c 0a20 2020 2020 2020 2020 2020  ec",.           
+0000d550: 2072 6574 7572 6e5f 7661 6c75 653d 2261   return_value="a
+0000d560: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+0000d570: 2061 7574 6f73 7065 633d 5472 7565 2c0a   autospec=True,.
+0000d580: 2020 2020 2020 2020 2920 6173 205f 663a          ) as _f:
+0000d590: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d5a0: 662e 6173 7365 7274 4571 7561 6c28 6462  f.assertEqual(db
+0000d5b0: 732e 6375 7273 4578 6563 2822 6122 2c20  s.cursExec("a", 
+0000d5c0: 6461 7461 3d22 6222 292c 2022 6162 6322  data="b"), "abc"
+0000d5d0: 290a 2020 2020 2020 2020 2020 2020 5f66  ).            _f
+0000d5e0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+0000d5f0: 6e63 655f 7769 7468 2864 6273 2e6d 6169  nce_with(dbs.mai
+0000d600: 6e44 422c 2022 6122 2c20 6461 7461 3d22  nDB, "a", data="
+0000d610: 6222 290a 0a20 2020 2020 2020 2023 2063  b")..        # c
+0000d620: 7572 736f 720a 2020 2020 2020 2020 7769  ursor.        wi
+0000d630: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
+0000d640: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
+0000d650: 6f2e 6461 7461 6261 7365 436f 7265 2e50  o.databaseCore.P
+0000d660: 6879 7342 6962 6c69 6f44 4243 6f72 652e  hysBiblioDBCore.
+0000d670: 6375 7273 6f72 222c 0a20 2020 2020 2020  cursor",.       
+0000d680: 2020 2020 2072 6574 7572 6e5f 7661 6c75       return_valu
+0000d690: 653d 2263 7572 7322 2c0a 2020 2020 2020  e="curs",.      
+0000d6a0: 2020 2020 2020 6175 746f 7370 6563 3d54        autospec=T
+0000d6b0: 7275 652c 0a20 2020 2020 2020 2029 2061  rue,.        ) a
+0000d6c0: 7320 5f66 3a0a 2020 2020 2020 2020 2020  s _f:.          
+0000d6d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0000d6e0: 616c 2864 6273 2e63 7572 736f 7228 292c  al(dbs.cursor(),
+0000d6f0: 2022 6375 7273 2229 0a20 2020 2020 2020   "curs").       
+0000d700: 2020 2020 205f 662e 6173 7365 7274 5f63       _f.assert_c
+0000d710: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+0000d720: 6462 732e 6d61 696e 4442 290a 0a20 2020  dbs.mainDB)..   
+0000d730: 2064 6566 2074 6573 745f 6368 6563 6b44   def test_checkD
+0000d740: 6174 6162 6173 6555 7064 6174 6573 5f44  atabaseUpdates_D
+0000d750: 4228 7365 6c66 2c20 2a61 7267 7329 3a0a  B(self, *args):.
+0000d760: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
+0000d770: 6368 6563 6b44 6174 6162 6173 6555 7064  checkDatabaseUpd
+0000d780: 6174 6573 2069 6e20 5068 7973 4269 626c  ates in PhysBibl
+0000d790: 696f 4442 2222 220a 2020 2020 2020 2020  ioDB""".        
+0000d7a0: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
+0000d7b0: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
+0000d7c0: 6c69 6f2e 6461 7461 6261 7365 436f 7265  lio.databaseCore
+0000d7d0: 2e50 6879 7342 6962 6c69 6f44 4243 6f72  .PhysBiblioDBCor
+0000d7e0: 652e 6368 6563 6b44 6174 6162 6173 6555  e.checkDatabaseU
+0000d7f0: 7064 6174 6573 222c 0a20 2020 2020 2020  pdates",.       
+0000d800: 2020 2020 2061 7574 6f73 7065 633d 5472       autospec=Tr
+0000d810: 7565 2c0a 2020 2020 2020 2020 2920 6173  ue,.        ) as
+0000d820: 205f 7375 2c20 7061 7463 6828 0a20 2020   _su, patch(.   
+0000d830: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+0000d840: 626c 696f 2e64 6174 6162 6173 652e 5068  blio.database.Ph
+0000d850: 7973 4269 626c 696f 4442 2e63 6f6e 7665  ysBiblioDB.conve
+0000d860: 7274 5365 6172 6368 466f 726d 6174 222c  rtSearchFormat",
+0000d870: 2061 7574 6f73 7065 633d 5472 7565 0a20   autospec=True. 
+0000d880: 2020 2020 2020 2029 2061 7320 5f63 662c         ) as _cf,
+0000d890: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+0000d8a0: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+0000d8b0: 6461 7461 6261 7365 2e50 6879 7342 6962  database.PhysBib
+0000d8c0: 6c69 6f44 422e 6368 6563 6b43 6173 6549  lioDB.checkCaseI
+0000d8d0: 6e73 656e 7369 7469 7665 4269 626b 6579  nsensitiveBibkey
+0000d8e0: 222c 2061 7574 6f73 7065 633d 5472 7565  ", autospec=True
+0000d8f0: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
+0000d900: 693a 0a20 2020 2020 2020 2020 2020 2073  i:.            s
+0000d910: 656c 662e 7042 4442 2e63 6865 636b 4461  elf.pBDB.checkDa
+0000d920: 7461 6261 7365 5570 6461 7465 7328 290a  tabaseUpdates().
+0000d930: 2020 2020 2020 2020 2020 2020 5f73 752e              _su.
+0000d940: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+0000d950: 6365 5f77 6974 6828 7365 6c66 2e70 4244  ce_with(self.pBD
+0000d960: 4229 0a20 2020 2020 2020 2020 2020 205f  B).            _
+0000d970: 6366 2e61 7373 6572 745f 6361 6c6c 6564  cf.assert_called
+0000d980: 5f6f 6e63 655f 7769 7468 2873 656c 662e  _once_with(self.
+0000d990: 7042 4442 290a 2020 2020 2020 2020 2020  pBDB).          
+0000d9a0: 2020 5f63 692e 6173 7365 7274 5f63 616c    _ci.assert_cal
+0000d9b0: 6c65 645f 6f6e 6365 5f77 6974 6828 7365  led_once_with(se
+0000d9c0: 6c66 2e70 4244 4229 0a0a 2020 2020 6465  lf.pBDB)..    de
+0000d9d0: 6620 7465 7374 5f63 6865 636b 4361 7365  f test_checkCase
+0000d9e0: 496e 7365 6e73 6974 6976 6542 6962 6b65  InsensitiveBibke
+0000d9f0: 7928 7365 6c66 2c20 2a61 7267 7329 3a0a  y(self, *args):.
+0000da00: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
+0000da10: 6368 6563 6b43 6173 6549 6e73 656e 7369  checkCaseInsensi
+0000da20: 7469 7665 4269 626b 6579 2222 220a 2020  tiveBibkey""".  
+0000da30: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0000da40: 6375 7273 203d 204d 6167 6963 4d6f 636b  curs = MagicMock
+0000da50: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+0000da60: 7042 4442 2e63 7572 732e 6665 7463 6861  pBDB.curs.fetcha
+0000da70: 6c6c 2e72 6574 7572 6e5f 7661 6c75 6520  ll.return_value 
+0000da80: 3d20 5b22 225d 0a20 2020 2020 2020 2077  = [""].        w
+0000da90: 6974 6820 7061 7463 6828 0a20 2020 2020  ith patch(.     
+0000daa0: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
+0000dab0: 696f 2e64 6174 6162 6173 6543 6f72 652e  io.databaseCore.
+0000dac0: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
+0000dad0: 2e63 7572 7345 7865 6322 2c20 6175 746f  .cursExec", auto
+0000dae0: 7370 6563 3d54 7275 650a 2020 2020 2020  spec=True.      
+0000daf0: 2020 2920 6173 205f 6375 722c 2070 6174    ) as _cur, pat
+0000db00: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
+0000db10: 6572 2e65 7863 6570 7469 6f6e 2229 2061  er.exception") a
+0000db20: 7320 5f65 783a 0a20 2020 2020 2020 2020  s _ex:.         
+0000db30: 2020 2073 656c 662e 7042 4442 2e63 6865     self.pBDB.che
+0000db40: 636b 4361 7365 496e 7365 6e73 6974 6976  ckCaseInsensitiv
+0000db50: 6542 6962 6b65 7928 290a 2020 2020 2020  eBibkey().      
+0000db60: 2020 2020 2020 5f63 7572 2e61 7373 6572        _cur.asser
+0000db70: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+0000db80: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
+0000db90: 2020 2020 7365 6c66 2e70 4244 422c 0a20      self.pBDB,. 
+0000dba0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000dbb0: 5345 4c45 4354 2073 716c 2046 524f 4d20  SELECT sql FROM 
+0000dbc0: 7371 6c69 7465 5f6d 6173 7465 7220 5748  sqlite_master WH
+0000dbd0: 4552 4520 7479 7065 3d27 7461 626c 6527  ERE type='table'
+0000dbe0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000dbf0: 2020 202b 2022 414e 4420 7462 6c5f 6e61     + "AND tbl_na
+0000dc00: 6d65 3d27 656e 7472 6965 7327 222c 0a20  me='entries'",. 
+0000dc10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000dc20: 2020 2020 2020 2020 205f 6578 2e61 7373           _ex.ass
+0000dc30: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+0000dc40: 7769 7468 2822 496d 706f 7373 6962 6c65  with("Impossible
+0000dc50: 2074 6f20 7265 6164 2063 7265 6174 6520   to read create 
+0000dc60: 7461 626c 6520 666f 7220 2765 6e74 7269  table for 'entri
+0000dc70: 6573 2722 290a 2020 2020 2020 2020 2020  es'").          
+0000dc80: 2020 7365 6c66 2e70 4244 422e 6375 7273    self.pBDB.curs
+0000dc90: 2e66 6574 6368 616c 6c2e 6173 7365 7274  .fetchall.assert
+0000dca0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+0000dcb0: 6828 290a 2020 2020 2020 2020 7365 6c66  h().        self
+0000dcc0: 2e70 4244 422e 6375 7273 2e66 6574 6368  .pBDB.curs.fetch
+0000dcd0: 616c 6c2e 7265 7475 726e 5f76 616c 7565  all.return_value
+0000dce0: 203d 205b 2822 6162 6365 6422 2c29 5d0a   = [("abced",)].
+0000dcf0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0000dd00: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0000dd10: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0000dd20: 6261 7365 436f 7265 2e50 6879 7342 6962  baseCore.PhysBib
+0000dd30: 6c69 6f44 4243 6f72 652e 6375 7273 4578  lioDBCore.cursEx
+0000dd40: 6563 222c 2061 7574 6f73 7065 633d 5472  ec", autospec=Tr
+0000dd50: 7565 0a20 2020 2020 2020 2029 2061 7320  ue.        ) as 
+0000dd60: 5f63 7572 2c20 7061 7463 6828 226c 6f67  _cur, patch("log
+0000dd70: 6769 6e67 2e4c 6f67 6765 722e 6465 6275  ging.Logger.debu
+0000dd80: 6722 2920 6173 205f 6462 673a 0a20 2020  g") as _dbg:.   
+0000dd90: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0000dda0: 4442 2e63 6865 636b 4361 7365 496e 7365  DB.checkCaseInse
+0000ddb0: 6e73 6974 6976 6542 6962 6b65 7928 290a  nsitiveBibkey().
+0000ddc0: 2020 2020 2020 2020 2020 2020 5f63 7572              _cur
+0000ddd0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+0000dde0: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
+0000ddf0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0000de00: 4244 422c 0a20 2020 2020 2020 2020 2020  BDB,.           
+0000de10: 2020 2020 2022 5345 4c45 4354 2073 716c       "SELECT sql
+0000de20: 2046 524f 4d20 7371 6c69 7465 5f6d 6173   FROM sqlite_mas
+0000de30: 7465 7220 5748 4552 4520 7479 7065 3d27  ter WHERE type='
+0000de40: 7461 626c 6527 2022 0a20 2020 2020 2020  table' ".       
+0000de50: 2020 2020 2020 2020 202b 2022 414e 4420           + "AND 
+0000de60: 7462 6c5f 6e61 6d65 3d27 656e 7472 6965  tbl_name='entrie
+0000de70: 7327 222c 0a20 2020 2020 2020 2020 2020  s'",.           
+0000de80: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
+0000de90: 6462 672e 6173 7365 7274 5f63 616c 6c65  dbg.assert_calle
+0000dea0: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
+0000deb0: 2020 2020 2020 2020 2020 2020 2022 2762               "'b
+0000dec0: 6962 6b65 7927 2077 6173 206e 6f74 2063  ibkey' was not c
+0000ded0: 7265 6174 6564 2077 6974 686f 7574 2027  reated without '
+0000dee0: 636f 6c6c 6174 6520 6e6f 6361 7365 272e  collate nocase'.
+0000def0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000df00: 2020 2b20 2220 4e6f 7468 696e 6720 746f    + " Nothing to
+0000df10: 2064 6f20 6865 7265 2e22 0a20 2020 2020   do here.".     
+0000df20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000df30: 2073 656c 662e 7042 4442 2e63 7572 732e   self.pBDB.curs.
+0000df40: 6665 7463 6861 6c6c 2e72 6574 7572 6e5f  fetchall.return_
+0000df50: 7661 6c75 6520 3d20 5b0a 2020 2020 2020  value = [.      
+0000df60: 2020 2020 2020 2822 5c6e 6269 626b 6579        ("\nbibkey
+0000df70: 2074 6578 7420 7072 696d 6172 7920 6b65   text primary ke
+0000df80: 7920 6e6f 7420 6e75 6c6c 2c5c 6e22 2c29  y not null,\n",)
+0000df90: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
+0000dfa0: 2020 2077 6974 6820 7061 7463 6828 0a20     with patch(. 
+0000dfb0: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+0000dfc0: 6269 626c 696f 2e64 6174 6162 6173 6543  biblio.databaseC
+0000dfd0: 6f72 652e 5068 7973 4269 626c 696f 4442  ore.PhysBiblioDB
+0000dfe0: 436f 7265 2e63 7572 7345 7865 6322 2c20  Core.cursExec", 
+0000dff0: 6175 746f 7370 6563 3d54 7275 650a 2020  autospec=True.  
+0000e000: 2020 2020 2020 2920 6173 205f 6375 722c        ) as _cur,
+0000e010: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+0000e020: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+0000e030: 6461 7461 6261 7365 436f 7265 2e50 6879  databaseCore.Phy
+0000e040: 7342 6962 6c69 6f44 4243 6f72 652e 636f  sBiblioDBCore.co
+0000e050: 6e6e 4578 6563 222c 0a20 2020 2020 2020  nnExec",.       
+0000e060: 2020 2020 2061 7574 6f73 7065 633d 5472       autospec=Tr
+0000e070: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+0000e080: 7265 7475 726e 5f76 616c 7565 3d46 616c  return_value=Fal
+0000e090: 7365 2c0a 2020 2020 2020 2020 2920 6173  se,.        ) as
+0000e0a0: 205f 636f 6e2c 2070 6174 6368 280a 2020   _con, patch(.  
+0000e0b0: 2020 2020 2020 2020 2020 226c 6f67 6769            "loggi
+0000e0c0: 6e67 2e4c 6f67 6765 722e 696e 666f 220a  ng.Logger.info".
+0000e0d0: 2020 2020 2020 2020 2920 6173 205f 696e          ) as _in
+0000e0e0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
+0000e0f0: 2020 2020 2022 6c6f 6767 696e 672e 4c6f       "logging.Lo
+0000e100: 6767 6572 2e65 7863 6570 7469 6f6e 220a  gger.exception".
+0000e110: 2020 2020 2020 2020 2920 6173 205f 6578          ) as _ex
+0000e120: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
+0000e130: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+0000e140: 2e64 6174 6162 6173 6543 6f72 652e 5068  .databaseCore.Ph
+0000e150: 7973 4269 626c 696f 4442 436f 7265 2e75  ysBiblioDBCore.u
+0000e160: 6e64 6f22 2c20 6175 746f 7370 6563 3d54  ndo", autospec=T
+0000e170: 7275 650a 2020 2020 2020 2020 2920 6173  rue.        ) as
+0000e180: 205f 756e 3a0a 2020 2020 2020 2020 2020   _un:.          
+0000e190: 2020 7365 6c66 2e70 4244 422e 6368 6563    self.pBDB.chec
+0000e1a0: 6b43 6173 6549 6e73 656e 7369 7469 7665  kCaseInsensitive
+0000e1b0: 4269 626b 6579 2829 0a20 2020 2020 2020  Bibkey().       
+0000e1c0: 2020 2020 205f 6375 722e 6173 7365 7274       _cur.assert
+0000e1d0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+0000e1e0: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
+0000e1f0: 2020 2073 656c 662e 7042 4442 2c0a 2020     self.pBDB,.  
+0000e200: 2020 2020 2020 2020 2020 2020 2020 2253                "S
+0000e210: 454c 4543 5420 7371 6c20 4652 4f4d 2073  ELECT sql FROM s
+0000e220: 716c 6974 655f 6d61 7374 6572 2057 4845  qlite_master WHE
+0000e230: 5245 2074 7970 653d 2774 6162 6c65 2720  RE type='table' 
+0000e240: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000e250: 2020 2b20 2241 4e44 2074 626c 5f6e 616d    + "AND tbl_nam
+0000e260: 653d 2765 6e74 7269 6573 2722 2c0a 2020  e='entries'",.  
+0000e270: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000e280: 2020 2020 2020 2020 5f63 6f6e 2e61 7373          _con.ass
+0000e290: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+0000e2a0: 7769 7468 2873 656c 662e 7042 4442 2c20  with(self.pBDB, 
+0000e2b0: 2242 4547 494e 2054 5241 4e53 4143 5449  "BEGIN TRANSACTI
+0000e2c0: 4f4e 3b22 290a 2020 2020 2020 2020 2020  ON;").          
+0000e2d0: 2020 5f69 6e2e 6173 7365 7274 5f63 616c    _in.assert_cal
+0000e2e0: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
+0000e2f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000e300: 5065 7266 6f72 6d69 6e67 2063 6f6e 7665  Performing conve
+0000e310: 7273 696f 6e20 6f66 2027 656e 7472 6965  rsion of 'entrie
+0000e320: 7327 2074 6162 6c65 2074 6f20 6361 7365  s' table to case
+0000e330: 2d69 6e73 656e 7369 7469 7665 206b 6579  -insensitive key
+0000e340: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0000e350: 2020 2020 2020 2020 2020 2020 5f65 782e              _ex.
+0000e360: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+0000e370: 6365 5f77 6974 6828 2249 6d70 6f73 7369  ce_with("Impossi
+0000e380: 626c 6520 746f 2072 656e 616d 6520 7461  ble to rename ta
+0000e390: 626c 6520 2765 6e74 7269 6573 2722 290a  ble 'entries'").
+0000e3a0: 2020 2020 2020 2020 2020 2020 5f75 6e2e              _un.
+0000e3b0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+0000e3c0: 6365 5f77 6974 6828 7365 6c66 2e70 4244  ce_with(self.pBD
+0000e3d0: 4229 0a20 2020 2020 2020 2077 6974 6820  B).        with 
+0000e3e0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
+0000e3f0: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
+0000e400: 6174 6162 6173 6543 6f72 652e 5068 7973  atabaseCore.Phys
+0000e410: 4269 626c 696f 4442 436f 7265 2e63 7572  BiblioDBCore.cur
+0000e420: 7345 7865 6322 2c20 6175 746f 7370 6563  sExec", autospec
+0000e430: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
+0000e440: 6173 205f 6375 722c 2070 6174 6368 280a  as _cur, patch(.
+0000e450: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+0000e460: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+0000e470: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
+0000e480: 4243 6f72 652e 636f 6e6e 4578 6563 222c  BCore.connExec",
+0000e490: 0a20 2020 2020 2020 2020 2020 2061 7574  .            aut
+0000e4a0: 6f73 7065 633d 5472 7565 2c0a 2020 2020  ospec=True,.    
+0000e4b0: 2020 2020 2020 2020 7265 7475 726e 5f76          return_v
+0000e4c0: 616c 7565 3d54 7275 652c 0a20 2020 2020  alue=True,.     
+0000e4d0: 2020 2029 2061 7320 5f63 6f6e 2c20 7061     ) as _con, pa
+0000e4e0: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+0000e4f0: 2022 6c6f 6767 696e 672e 4c6f 6767 6572   "logging.Logger
+0000e500: 2e69 6e66 6f22 0a20 2020 2020 2020 2029  .info".        )
+0000e510: 2061 7320 5f69 6e2c 2070 6174 6368 280a   as _in, patch(.
+0000e520: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0000e530: 6769 6e67 2e4c 6f67 6765 722e 6578 6365  ging.Logger.exce
+0000e540: 7074 696f 6e22 0a20 2020 2020 2020 2029  ption".        )
+0000e550: 2061 7320 5f65 782c 2070 6174 6368 280a   as _ex, patch(.
+0000e560: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+0000e570: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+0000e580: 436f 7265 2e50 6879 7342 6962 6c69 6f44  Core.PhysBiblioD
+0000e590: 4243 6f72 652e 6372 6561 7465 5461 626c  BCore.createTabl
+0000e5a0: 6522 2c20 6175 746f 7370 6563 3d54 7275  e", autospec=Tru
+0000e5b0: 650a 2020 2020 2020 2020 2920 6173 205f  e.        ) as _
+0000e5c0: 6374 2c20 7061 7463 6828 0a20 2020 2020  ct, patch(.     
+0000e5d0: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
+0000e5e0: 696f 2e64 6174 6162 6173 6543 6f72 652e  io.databaseCore.
+0000e5f0: 5068 7973 4269 626c 696f 4442 436f 7265  PhysBiblioDBCore
+0000e600: 2e63 6f6d 6d69 7422 2c20 6175 746f 7370  .commit", autosp
+0000e610: 6563 3d54 7275 650a 2020 2020 2020 2020  ec=True.        
+0000e620: 2920 6173 205f 636f 6d2c 2070 6174 6368  ) as _com, patch
+0000e630: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
+0000e640: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
+0000e650: 7365 436f 7265 2e50 6879 7342 6962 6c69  seCore.PhysBibli
+0000e660: 6f44 4243 6f72 652e 756e 646f 222c 2061  oDBCore.undo", a
+0000e670: 7574 6f73 7065 633d 5472 7565 0a20 2020  utospec=True.   
+0000e680: 2020 2020 2029 2061 7320 5f75 6e3a 0a20       ) as _un:. 
+0000e690: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000e6a0: 7042 4442 2e63 6865 636b 4361 7365 496e  pBDB.checkCaseIn
+0000e6b0: 7365 6e73 6974 6976 6542 6962 6b65 7928  sensitiveBibkey(
+0000e6c0: 290a 2020 2020 2020 2020 2020 2020 5f63  ).            _c
+0000e6d0: 7572 2e61 7373 6572 745f 6361 6c6c 6564  ur.assert_called
+0000e6e0: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
+0000e6f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e700: 2e70 4244 422c 0a20 2020 2020 2020 2020  .pBDB,.         
+0000e710: 2020 2020 2020 2022 5345 4c45 4354 2073         "SELECT s
+0000e720: 716c 2046 524f 4d20 7371 6c69 7465 5f6d  ql FROM sqlite_m
+0000e730: 6173 7465 7220 5748 4552 4520 7479 7065  aster WHERE type
+0000e740: 3d27 7461 626c 6527 2022 0a20 2020 2020  ='table' ".     
+0000e750: 2020 2020 2020 2020 2020 202b 2022 414e             + "AN
+0000e760: 4420 7462 6c5f 6e61 6d65 3d27 656e 7472  D tbl_name='entr
+0000e770: 6965 7327 222c 0a20 2020 2020 2020 2020  ies'",.         
+0000e780: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000e790: 205f 6374 2e61 7373 6572 745f 6361 6c6c   _ct.assert_call
+0000e7a0: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
+0000e7b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000e7c0: 6c66 2e70 4244 422c 2022 656e 7472 6965  lf.pBDB, "entrie
+0000e7d0: 7322 2c20 7365 6c66 2e70 4244 422e 7461  s", self.pBDB.ta
+0000e7e0: 626c 6546 6965 6c64 735b 2265 6e74 7269  bleFields["entri
+0000e7f0: 6573 225d 0a20 2020 2020 2020 2020 2020  es"].           
+0000e800: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
+0000e810: 636f 6e2e 6173 7365 7274 5f68 6173 5f63  con.assert_has_c
+0000e820: 616c 6c73 280a 2020 2020 2020 2020 2020  alls(.          
+0000e830: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+0000e840: 2020 2020 2020 2020 2020 2020 6361 6c6c              call
+0000e850: 2873 656c 662e 7042 4442 2c20 2242 4547  (self.pBDB, "BEG
+0000e860: 494e 2054 5241 4e53 4143 5449 4f4e 3b22  IN TRANSACTION;"
+0000e870: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000e880: 2020 2020 2020 2063 616c 6c28 7365 6c66         call(self
+0000e890: 2e70 4244 422c 2022 414c 5445 5220 5441  .pBDB, "ALTER TA
+0000e8a0: 424c 4520 656e 7472 6965 7320 5245 4e41  BLE entries RENA
+0000e8b0: 4d45 2054 4f20 746d 705f 656e 7472 6965  ME TO tmp_entrie
+0000e8c0: 733b 2229 2c0a 2020 2020 2020 2020 2020  s;"),.          
+0000e8d0: 2020 2020 2020 2020 2020 6361 6c6c 2873            call(s
+0000e8e0: 656c 662e 7042 4442 2c20 2249 4e53 4552  elf.pBDB, "INSER
+0000e8f0: 5420 494e 544f 2065 6e74 7269 6573 2053  T INTO entries S
+0000e900: 454c 4543 5420 2a20 4652 4f4d 2074 6d70  ELECT * FROM tmp
+0000e910: 5f65 6e74 7269 6573 3b22 292c 0a20 2020  _entries;"),.   
 0000e920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e930: 6361 6c6c 2873 656c 662e 7042 4442 2c20  call(self.pBDB, 
-0000e940: 2249 4e53 4552 5420 494e 544f 2065 6e74  "INSERT INTO ent
-0000e950: 7269 6573 2053 454c 4543 5420 2a20 4652  ries SELECT * FR
-0000e960: 4f4d 2074 6d70 5f65 6e74 7269 6573 3b22  OM tmp_entries;"
-0000e970: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000e980: 2020 2020 2020 2063 616c 6c28 7365 6c66         call(self
-0000e990: 2e70 4244 422c 2022 4452 4f50 2054 4142  .pBDB, "DROP TAB
-0000e9a0: 4c45 2074 6d70 5f65 6e74 7269 6573 3b22  LE tmp_entries;"
-0000e9b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000e9c0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0000e9d0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0000e9e0: 696e 2e61 7373 6572 745f 6361 6c6c 6564  in.assert_called
-0000e9f0: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
-0000ea00: 2020 2020 2020 2020 2020 2020 2250 6572              "Per
-0000ea10: 666f 726d 696e 6720 636f 6e76 6572 7369  forming conversi
-0000ea20: 6f6e 206f 6620 2765 6e74 7269 6573 2720  on of 'entries' 
-0000ea30: 7461 626c 6520 746f 2063 6173 652d 696e  table to case-in
-0000ea40: 7365 6e73 6974 6976 6520 6b65 7922 0a20  sensitive key". 
-0000ea50: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000ea60: 2020 2020 2020 2020 205f 636f 6d2e 6173           _com.as
-0000ea70: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-0000ea80: 5f77 6974 6828 7365 6c66 2e70 4244 4229  _with(self.pBDB)
-0000ea90: 0a20 2020 2020 2020 2020 2020 205f 6578  .            _ex
-0000eaa0: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
-0000eab0: 6564 2829 0a20 2020 2020 2020 2020 2020  ed().           
-0000eac0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000ead0: 6c28 5f75 6e2e 6361 6c6c 5f63 6f75 6e74  l(_un.call_count
-0000eae0: 2c20 3029 0a20 2020 2020 2020 2073 656c  , 0).        sel
-0000eaf0: 662e 7042 4442 2e63 7572 7320 3d20 7365  f.pBDB.curs = se
-0000eb00: 6c66 2e70 4244 422e 636f 6e6e 2e63 7572  lf.pBDB.conn.cur
-0000eb10: 736f 7228 290a 0a0a 4075 6e69 7474 6573  sor()...@unittes
-0000eb20: 742e 736b 6970 4966 2873 6b69 7054 6573  t.skipIf(skipTes
-0000eb30: 7473 5365 7474 696e 6773 2e64 622c 2022  tsSettings.db, "
-0000eb40: 4461 7461 6261 7365 2074 6573 7473 2229  Database tests")
-0000eb50: 0a40 7061 7463 6828 226c 6f67 6769 6e67  .@patch("logging
-0000eb60: 2e4c 6f67 6765 722e 6465 6275 6722 290a  .Logger.debug").
-0000eb70: 4070 6174 6368 2822 6c6f 6767 696e 672e  @patch("logging.
-0000eb80: 4c6f 6767 6572 2e69 6e66 6f22 290a 4070  Logger.info").@p
-0000eb90: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
-0000eba0: 6767 6572 2e77 6172 6e69 6e67 2229 0a40  gger.warning").@
-0000ebb0: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-0000ebc0: 6f67 6765 722e 6578 6365 7074 696f 6e22  ogger.exception"
-0000ebd0: 290a 636c 6173 7320 5465 7374 4461 7461  ).class TestData
-0000ebe0: 6261 7365 4c69 6e6b 7328 4442 5465 7374  baseLinks(DBTest
-0000ebf0: 4361 7365 293a 0a20 2020 2022 2222 5465  Case):.    """Te
-0000ec00: 7374 2073 7562 636c 6173 7365 7320 636f  st subclasses co
-0000ec10: 6e6e 6563 7469 6e67 2063 6174 6567 6f72  nnecting categor
-0000ec20: 6965 732c 2065 7870 6572 696d 656e 7473  ies, experiments
-0000ec30: 2c20 656e 7472 6965 7322 2222 0a0a 2020  , entries"""..  
-0000ec40: 2020 6465 6620 7465 7374 5f43 6174 7345    def test_CatsE
-0000ec50: 6e74 7269 6573 2873 656c 662c 202a 6172  ntries(self, *ar
-0000ec60: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-0000ec70: 5465 7374 2043 6174 7345 6e74 7269 6573  Test CatsEntries
-0000ec80: 2066 756e 6374 696f 6e73 2222 220a 2020   functions""".  
-0000ec90: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0000eca0: 7574 696c 732e 636c 6561 6e53 7061 7265  utils.cleanSpare
-0000ecb0: 456e 7472 6965 7328 290a 2020 2020 2020  Entries().      
-0000ecc0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-0000ecd0: 6528 7365 6c66 2e70 4244 422e 6361 7442  e(self.pBDB.catB
-0000ece0: 6962 2e69 6e73 6572 7428 312c 2022 7465  ib.insert(1, "te
-0000ecf0: 7374 2229 290a 2020 2020 2020 2020 7365  st")).        se
-0000ed00: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
+0000e930: 2063 616c 6c28 7365 6c66 2e70 4244 422c   call(self.pBDB,
+0000e940: 2022 4452 4f50 2054 4142 4c45 2074 6d70   "DROP TABLE tmp
+0000e950: 5f65 6e74 7269 6573 3b22 292c 0a20 2020  _entries;"),.   
+0000e960: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0000e970: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000e980: 2020 2020 2020 2020 205f 696e 2e61 7373           _in.ass
+0000e990: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+0000e9a0: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
+0000e9b0: 2020 2020 2020 2250 6572 666f 726d 696e        "Performin
+0000e9c0: 6720 636f 6e76 6572 7369 6f6e 206f 6620  g conversion of 
+0000e9d0: 2765 6e74 7269 6573 2720 7461 626c 6520  'entries' table 
+0000e9e0: 746f 2063 6173 652d 696e 7365 6e73 6974  to case-insensit
+0000e9f0: 6976 6520 6b65 7922 0a20 2020 2020 2020  ive key".       
+0000ea00: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000ea10: 2020 205f 636f 6d2e 6173 7365 7274 5f63     _com.assert_c
+0000ea20: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+0000ea30: 7365 6c66 2e70 4244 4229 0a20 2020 2020  self.pBDB).     
+0000ea40: 2020 2020 2020 205f 6578 2e61 7373 6572         _ex.asser
+0000ea50: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
+0000ea60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ea70: 6173 7365 7274 4571 7561 6c28 5f75 6e2e  assertEqual(_un.
+0000ea80: 6361 6c6c 5f63 6f75 6e74 2c20 3029 0a20  call_count, 0). 
+0000ea90: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0000eaa0: 2e63 7572 7320 3d20 7365 6c66 2e70 4244  .curs = self.pBD
+0000eab0: 422e 636f 6e6e 2e63 7572 736f 7228 290a  B.conn.cursor().
+0000eac0: 0a0a 4075 6e69 7474 6573 742e 736b 6970  ..@unittest.skip
+0000ead0: 4966 2873 6b69 7054 6573 7473 5365 7474  If(skipTestsSett
+0000eae0: 696e 6773 2e64 622c 2022 4461 7461 6261  ings.db, "Databa
+0000eaf0: 7365 2074 6573 7473 2229 0a40 7061 7463  se tests").@patc
+0000eb00: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
+0000eb10: 722e 6465 6275 6722 290a 4070 6174 6368  r.debug").@patch
+0000eb20: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
+0000eb30: 2e69 6e66 6f22 290a 4070 6174 6368 2822  .info").@patch("
+0000eb40: 6c6f 6767 696e 672e 4c6f 6767 6572 2e77  logging.Logger.w
+0000eb50: 6172 6e69 6e67 2229 0a40 7061 7463 6828  arning").@patch(
+0000eb60: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
+0000eb70: 6578 6365 7074 696f 6e22 290a 636c 6173  exception").clas
+0000eb80: 7320 5465 7374 4461 7461 6261 7365 4c69  s TestDatabaseLi
+0000eb90: 6e6b 7328 4442 5465 7374 4361 7365 293a  nks(DBTestCase):
+0000eba0: 0a20 2020 2022 2222 5465 7374 2073 7562  .    """Test sub
+0000ebb0: 636c 6173 7365 7320 636f 6e6e 6563 7469  classes connecti
+0000ebc0: 6e67 2063 6174 6567 6f72 6965 732c 2065  ng categories, e
+0000ebd0: 7870 6572 696d 656e 7473 2c20 656e 7472  xperiments, entr
+0000ebe0: 6965 7322 2222 0a0a 2020 2020 6465 6620  ies"""..    def 
+0000ebf0: 7465 7374 5f43 6174 7345 6e74 7269 6573  test_CatsEntries
+0000ec00: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
+0000ec10: 2020 2020 2020 2022 2222 5465 7374 2043         """Test C
+0000ec20: 6174 7345 6e74 7269 6573 2066 756e 6374  atsEntries funct
+0000ec30: 696f 6e73 2222 220a 2020 2020 2020 2020  ions""".        
+0000ec40: 7365 6c66 2e70 4244 422e 7574 696c 732e  self.pBDB.utils.
+0000ec50: 636c 6561 6e53 7061 7265 456e 7472 6965  cleanSpareEntrie
+0000ec60: 7328 290a 2020 2020 2020 2020 7365 6c66  s().        self
+0000ec70: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+0000ec80: 2e70 4244 422e 6361 7442 6962 2e69 6e73  .pBDB.catBib.ins
+0000ec90: 6572 7428 312c 2022 7465 7374 2229 290a  ert(1, "test")).
+0000eca0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000ecb0: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
+0000ecc0: 4442 2e63 6174 4269 622e 696e 7365 7274  DB.catBib.insert
+0000ecd0: 2831 2c20 2274 6573 7422 2929 2020 2320  (1, "test"))  # 
+0000ece0: 616c 7265 6164 7920 7072 6573 656e 740a  already present.
+0000ecf0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000ed00: 6572 7445 7175 616c 2874 7570 6c65 2873  ertEqual(tuple(s
 0000ed10: 656c 662e 7042 4442 2e63 6174 4269 622e  elf.pBDB.catBib.
-0000ed20: 696e 7365 7274 2831 2c20 2274 6573 7422  insert(1, "test"
-0000ed30: 2929 2020 2320 616c 7265 6164 7920 7072  ))  # already pr
-0000ed40: 6573 656e 740a 2020 2020 2020 2020 7365  esent.        se
-0000ed50: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
-0000ed60: 7570 6c65 2873 656c 662e 7042 4442 2e63  uple(self.pBDB.c
-0000ed70: 6174 4269 622e 6765 744f 6e65 2831 2c20  atBib.getOne(1, 
-0000ed80: 2274 6573 7422 295b 305d 292c 2028 312c  "test")[0]), (1,
-0000ed90: 2022 7465 7374 222c 2031 2929 0a20 2020   "test", 1)).   
-0000eda0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000edb0: 5472 7565 2873 656c 662e 7042 4442 2e63  True(self.pBDB.c
-0000edc0: 6174 4269 622e 6465 6c65 7465 2831 2c20  atBib.delete(1, 
-0000edd0: 2274 6573 7422 2929 0a20 2020 2020 2020  "test")).       
-0000ede0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000edf0: 6c28 7365 6c66 2e70 4244 422e 6361 7442  l(self.pBDB.catB
-0000ee00: 6962 2e67 6574 4f6e 6528 312c 2022 7465  ib.getOne(1, "te
-0000ee10: 7374 2229 2c20 5b5d 290a 2020 2020 2020  st"), []).      
-0000ee20: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000ee30: 616c 2873 656c 662e 7042 4442 2e63 6174  al(self.pBDB.cat
-0000ee40: 4269 622e 696e 7365 7274 2831 2c20 5b22  Bib.insert(1, ["
-0000ee50: 7465 7374 3122 2c20 2274 6573 7432 225d  test1", "test2"]
-0000ee60: 292c 204e 6f6e 6529 0a20 2020 2020 2020  ), None).       
-0000ee70: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000ee80: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
-0000ee90: 7475 706c 6528 6129 2066 6f72 2061 2069  tuple(a) for a i
-0000eea0: 6e20 7365 6c66 2e70 4244 422e 6361 7442  n self.pBDB.catB
-0000eeb0: 6962 2e67 6574 416c 6c28 295d 2c0a 2020  ib.getAll()],.  
-0000eec0: 2020 2020 2020 2020 2020 5b28 312c 2022            [(1, "
-0000eed0: 7465 7374 3122 2c20 3129 2c20 2832 2c20  test1", 1), (2, 
-0000eee0: 2274 6573 7432 222c 2031 295d 2c0a 2020  "test2", 1)],.  
-0000eef0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000ef00: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000ef10: 2873 656c 662e 7042 4442 2e63 6174 4269  (self.pBDB.catBi
-0000ef20: 622e 6465 6c65 7465 2831 2c20 5b22 7465  b.delete(1, ["te
-0000ef30: 7374 3122 2c20 2274 6573 7432 225d 292c  st1", "test2"]),
-0000ef40: 204e 6f6e 6529 0a20 2020 2020 2020 2073   None).        s
-0000ef50: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000ef60: 5b74 7570 6c65 2861 2920 666f 7220 6120  [tuple(a) for a 
-0000ef70: 696e 2073 656c 662e 7042 4442 2e63 6174  in self.pBDB.cat
-0000ef80: 4269 622e 6765 7441 6c6c 2829 5d2c 205b  Bib.getAll()], [
-0000ef90: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
-0000efa0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-0000efb0: 2e70 4244 422e 6361 7442 6962 2e69 6e73  .pBDB.catBib.ins
-0000efc0: 6572 7428 5b31 2c20 325d 2c20 5b22 7465  ert([1, 2], ["te
-0000efd0: 7374 3122 2c20 2274 6573 7441 225d 292c  st1", "testA"]),
-0000efe0: 204e 6f6e 6529 0a20 2020 2020 2020 2073   None).        s
-0000eff0: 656c 662e 6173 7365 7274 5472 7565 2873  elf.assertTrue(s
-0000f000: 656c 662e 7042 4442 2e63 6174 4269 622e  elf.pBDB.catBib.
-0000f010: 7570 6461 7465 4269 626b 6579 2822 7465  updateBibkey("te
-0000f020: 7374 3222 2c20 2274 6573 7441 2229 290a  st2", "testA")).
-0000f030: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000f040: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0000f050: 2020 2020 2020 5b74 7570 6c65 2861 2920        [tuple(a) 
-0000f060: 666f 7220 6120 696e 2073 656c 662e 7042  for a in self.pB
-0000f070: 4442 2e63 6174 4269 622e 6765 7441 6c6c  DB.catBib.getAll
-0000f080: 2829 5d2c 0a20 2020 2020 2020 2020 2020  ()],.           
-0000f090: 205b 2831 2c20 2274 6573 7431 222c 2031   [(1, "test1", 1
-0000f0a0: 292c 2028 322c 2022 7465 7374 3222 2c20  ), (2, "test2", 
-0000f0b0: 3129 2c20 2833 2c20 2274 6573 7431 222c  1), (3, "test1",
-0000f0c0: 2032 292c 2028 342c 2022 7465 7374 3222   2), (4, "test2"
-0000f0d0: 2c20 3229 5d2c 0a20 2020 2020 2020 2029  , 2)],.        )
-0000f0e0: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-0000f0f0: 4442 2e75 7469 6c73 2e63 6c65 616e 5370  DB.utils.cleanSp
-0000f100: 6172 6545 6e74 7269 6573 2829 0a20 2020  areEntries().   
-0000f110: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0000f120: 2262 7569 6c74 696e 732e 696e 7075 7422  "builtins.input"
-0000f130: 2c20 7265 7475 726e 5f76 616c 7565 3d22  , return_value="
-0000f140: 5b31 2c32 5d22 2920 6173 205f 696e 7075  [1,2]") as _inpu
-0000f150: 743a 0a20 2020 2020 2020 2020 2020 2073  t:.            s
-0000f160: 656c 662e 7042 4442 2e63 6174 4269 622e  elf.pBDB.catBib.
-0000f170: 6173 6b43 6174 7328 2274 6573 7431 2229  askCats("test1")
-0000f180: 0a20 2020 2020 2020 2020 2020 205f 696e  .            _in
-0000f190: 7075 742e 6173 7365 7274 5f63 616c 6c65  put.assert_calle
-0000f1a0: 645f 6f6e 6365 5f77 6974 6828 2263 6174  d_once_with("cat
-0000f1b0: 6567 6f72 6965 7320 666f 7220 2774 6573  egories for 'tes
-0000f1c0: 7431 273a 2022 290a 2020 2020 2020 2020  t1': ").        
-0000f1d0: 7769 7468 2070 6174 6368 2822 6275 696c  with patch("buil
-0000f1e0: 7469 6e73 2e69 6e70 7574 222c 2072 6574  tins.input", ret
-0000f1f0: 7572 6e5f 7661 6c75 653d 2231 2c32 2229  urn_value="1,2")
-0000f200: 2061 7320 5f69 6e70 7574 3a0a 2020 2020   as _input:.    
-0000f210: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0000f220: 422e 6361 7442 6962 2e61 736b 4361 7473  B.catBib.askCats
-0000f230: 2822 7465 7374 3122 290a 2020 2020 2020  ("test1").      
-0000f240: 2020 2020 2020 5f69 6e70 7574 2e61 7373        _input.ass
-0000f250: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-0000f260: 7769 7468 2822 6361 7465 676f 7269 6573  with("categories
-0000f270: 2066 6f72 2027 7465 7374 3127 3a20 2229   for 'test1': ")
-0000f280: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-0000f290: 7463 6828 2262 7569 6c74 696e 732e 696e  tch("builtins.in
-0000f2a0: 7075 7422 2c20 7265 7475 726e 5f76 616c  put", return_val
-0000f2b0: 7565 3d22 7465 7374 3222 2920 6173 205f  ue="test2") as _
-0000f2c0: 696e 7075 743a 0a20 2020 2020 2020 2020  input:.         
-0000f2d0: 2020 2073 656c 662e 7042 4442 2e63 6174     self.pBDB.cat
-0000f2e0: 4269 622e 6173 6b4b 6579 7328 5b31 2c20  Bib.askKeys([1, 
-0000f2f0: 325d 290a 2020 2020 2020 2020 2020 2020  2]).            
-0000f300: 5f69 6e70 7574 2e61 7373 6572 745f 6861  _input.assert_ha
-0000f310: 735f 6361 6c6c 7328 0a20 2020 2020 2020  s_calls(.       
-0000f320: 2020 2020 2020 2020 205b 6361 6c6c 2822           [call("
-0000f330: 656e 7472 6965 7320 666f 7220 2731 273a  entries for '1':
-0000f340: 2022 292c 2063 616c 6c28 2265 6e74 7269   "), call("entri
-0000f350: 6573 2066 6f72 2027 3227 3a20 2229 5d0a  es for '2': ")].
-0000f360: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000f370: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000f380: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0000f390: 2020 2020 5b74 7570 6c65 2861 2920 666f      [tuple(a) fo
-0000f3a0: 7220 6120 696e 2073 656c 662e 7042 4442  r a in self.pBDB
-0000f3b0: 2e63 6174 4269 622e 6765 7441 6c6c 2829  .catBib.getAll()
-0000f3c0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
-0000f3d0: 2831 2c20 2274 6573 7431 222c 2031 292c  (1, "test1", 1),
-0000f3e0: 2028 322c 2022 7465 7374 3122 2c20 3229   (2, "test1", 2)
-0000f3f0: 2c20 2833 2c20 2274 6573 7432 222c 2031  , (3, "test2", 1
-0000f400: 292c 2028 342c 2022 7465 7374 3222 2c20  ), (4, "test2", 
-0000f410: 3229 5d2c 0a20 2020 2020 2020 2029 0a20  2)],.        ). 
-0000f420: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000f430: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-0000f440: 422e 6361 7442 6962 2e63 6f75 6e74 4279  B.catBib.countBy
-0000f450: 4361 7428 3129 2c20 3229 0a20 2020 2020  Cat(1), 2).     
-0000f460: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-0000f470: 7565 2873 656c 662e 7042 4442 2e63 6174  ue(self.pBDB.cat
-0000f480: 4269 622e 696e 7365 7274 2822 7465 7374  Bib.insert("test
-0000f490: 222c 2022 7465 7374 2229 290a 0a20 2020  ", "test"))..   
-0000f4a0: 2064 6566 2074 6573 745f 6361 7445 7870   def test_catExp
-0000f4b0: 7328 7365 6c66 2c20 2a61 7267 7329 3a0a  s(self, *args):.
-0000f4c0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-0000f4d0: 4361 7473 4578 7073 2066 756e 6374 696f  CatsExps functio
-0000f4e0: 6e73 2222 220a 2020 2020 2020 2020 7365  ns""".        se
-0000f4f0: 6c66 2e70 4244 422e 7574 696c 732e 636c  lf.pBDB.utils.cl
-0000f500: 6561 6e53 7061 7265 456e 7472 6965 7328  eanSpareEntries(
-0000f510: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0000f520: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-0000f530: 4244 422e 6361 7445 7870 2e69 6e73 6572  BDB.catExp.inser
-0000f540: 7428 312c 2031 3029 290a 2020 2020 2020  t(1, 10)).      
-0000f550: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
-0000f560: 7365 2873 656c 662e 7042 4442 2e63 6174  se(self.pBDB.cat
-0000f570: 4578 702e 696e 7365 7274 2831 2c20 3130  Exp.insert(1, 10
-0000f580: 2929 2020 2320 616c 7265 6164 7920 7072  ))  # already pr
-0000f590: 6573 656e 740a 2020 2020 2020 2020 7365  esent.        se
-0000f5a0: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
-0000f5b0: 7570 6c65 2873 656c 662e 7042 4442 2e63  uple(self.pBDB.c
-0000f5c0: 6174 4578 702e 6765 744f 6e65 2831 2c20  atExp.getOne(1, 
-0000f5d0: 3130 295b 305d 292c 2028 312c 2031 302c  10)[0]), (1, 10,
-0000f5e0: 2031 2929 0a20 2020 2020 2020 2073 656c   1)).        sel
-0000f5f0: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-0000f600: 662e 7042 4442 2e63 6174 4578 702e 6465  f.pBDB.catExp.de
-0000f610: 6c65 7465 2831 2c20 3130 2929 0a20 2020  lete(1, 10)).   
-0000f620: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000f630: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-0000f640: 6361 7445 7870 2e67 6574 4f6e 6528 312c  catExp.getOne(1,
-0000f650: 2031 3029 2c20 5b5d 290a 2020 2020 2020   10), []).      
-0000f660: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000f670: 616c 2873 656c 662e 7042 4442 2e63 6174  al(self.pBDB.cat
-0000f680: 4578 702e 696e 7365 7274 2831 2c20 5b31  Exp.insert(1, [1
-0000f690: 302c 2031 315d 292c 204e 6f6e 6529 0a20  0, 11]), None). 
-0000f6a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000f6b0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-0000f6c0: 2020 2020 205b 7475 706c 6528 6129 2066       [tuple(a) f
-0000f6d0: 6f72 2061 2069 6e20 7365 6c66 2e70 4244  or a in self.pBD
-0000f6e0: 422e 6361 7445 7870 2e67 6574 416c 6c28  B.catExp.getAll(
-0000f6f0: 295d 2c20 5b28 312c 2031 302c 2031 292c  )], [(1, 10, 1),
-0000f700: 2028 322c 2031 312c 2031 295d 0a20 2020   (2, 11, 1)].   
-0000f710: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-0000f720: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000f730: 7365 6c66 2e70 4244 422e 6361 7445 7870  self.pBDB.catExp
-0000f740: 2e64 656c 6574 6528 312c 205b 3130 2c20  .delete(1, [10, 
-0000f750: 3131 5d29 2c20 4e6f 6e65 290a 2020 2020  11]), None).    
-0000f760: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0000f770: 7175 616c 285b 7475 706c 6528 6129 2066  qual([tuple(a) f
-0000f780: 6f72 2061 2069 6e20 7365 6c66 2e70 4244  or a in self.pBD
-0000f790: 422e 6361 7445 7870 2e67 6574 416c 6c28  B.catExp.getAll(
-0000f7a0: 295d 2c20 5b5d 290a 2020 2020 2020 2020  )], []).        
-0000f7b0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000f7c0: 2873 656c 662e 7042 4442 2e63 6174 4578  (self.pBDB.catEx
-0000f7d0: 702e 696e 7365 7274 285b 312c 2032 5d2c  p.insert([1, 2],
-0000f7e0: 205b 3130 2c20 3131 5d29 2c20 4e6f 6e65   [10, 11]), None
-0000f7f0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0000f800: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-0000f810: 2020 2020 2020 2020 5b74 7570 6c65 2861          [tuple(a
-0000f820: 2920 666f 7220 6120 696e 2073 656c 662e  ) for a in self.
-0000f830: 7042 4442 2e63 6174 4578 702e 6765 7441  pBDB.catExp.getA
-0000f840: 6c6c 2829 5d2c 0a20 2020 2020 2020 2020  ll()],.         
-0000f850: 2020 205b 2831 2c20 3130 2c20 3129 2c20     [(1, 10, 1), 
-0000f860: 2832 2c20 3131 2c20 3129 2c20 2833 2c20  (2, 11, 1), (3, 
-0000f870: 3130 2c20 3229 2c20 2834 2c20 3131 2c20  10, 2), (4, 11, 
-0000f880: 3229 5d2c 0a20 2020 2020 2020 2029 0a20  2)],.        ). 
-0000f890: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0000f8a0: 2e75 7469 6c73 2e63 6c65 616e 5370 6172  .utils.cleanSpar
-0000f8b0: 6545 6e74 7269 6573 2829 0a20 2020 2020  eEntries().     
-0000f8c0: 2020 2077 6974 6820 7061 7463 6828 2262     with patch("b
-0000f8d0: 7569 6c74 696e 732e 696e 7075 7422 2c20  uiltins.input", 
-0000f8e0: 7265 7475 726e 5f76 616c 7565 3d22 5b31  return_value="[1
-0000f8f0: 2c32 5d22 2920 6173 205f 696e 7075 743a  ,2]") as _input:
-0000f900: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f910: 662e 7042 4442 2e63 6174 4578 702e 6173  f.pBDB.catExp.as
-0000f920: 6b43 6174 7328 3130 290a 2020 2020 2020  kCats(10).      
-0000f930: 2020 2020 2020 5f69 6e70 7574 2e61 7373        _input.ass
-0000f940: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-0000f950: 7769 7468 2822 6361 7465 676f 7269 6573  with("categories
-0000f960: 2066 6f72 2027 3130 273a 2022 290a 2020   for '10': ").  
-0000f970: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-0000f980: 2822 6275 696c 7469 6e73 2e69 6e70 7574  ("builtins.input
-0000f990: 222c 2072 6574 7572 6e5f 7661 6c75 653d  ", return_value=
-0000f9a0: 2231 3122 2920 6173 205f 696e 7075 743a  "11") as _input:
-0000f9b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f9c0: 662e 7042 4442 2e63 6174 4578 702e 6173  f.pBDB.catExp.as
-0000f9d0: 6b45 7870 7328 5b31 2c20 325d 290a 2020  kExps([1, 2]).  
-0000f9e0: 2020 2020 2020 2020 2020 5f69 6e70 7574            _input
-0000f9f0: 2e61 7373 6572 745f 6861 735f 6361 6c6c  .assert_has_call
-0000fa00: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-0000fa10: 2020 205b 6361 6c6c 2822 6578 7065 7269     [call("experi
-0000fa20: 6d65 6e74 7320 666f 7220 2731 273a 2022  ments for '1': "
-0000fa30: 292c 2063 616c 6c28 2265 7870 6572 696d  ), call("experim
-0000fa40: 656e 7473 2066 6f72 2027 3227 3a20 2229  ents for '2': ")
-0000fa50: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
-0000fa60: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000fa70: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0000fa80: 2020 2020 2020 5b74 7570 6c65 2861 2920        [tuple(a) 
-0000fa90: 666f 7220 6120 696e 2073 656c 662e 7042  for a in self.pB
-0000faa0: 4442 2e63 6174 4578 702e 6765 7441 6c6c  DB.catExp.getAll
-0000fab0: 2829 5d2c 0a20 2020 2020 2020 2020 2020  ()],.           
-0000fac0: 205b 2831 2c20 3130 2c20 3129 2c20 2832   [(1, 10, 1), (2
-0000fad0: 2c20 3130 2c20 3229 2c20 2833 2c20 3131  , 10, 2), (3, 11
-0000fae0: 2c20 3129 2c20 2834 2c20 3131 2c20 3229  , 1), (4, 11, 2)
-0000faf0: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-0000fb00: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000fb10: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-0000fb20: 6361 7445 7870 2e63 6f75 6e74 4279 4361  catExp.countByCa
-0000fb30: 7428 3129 2c20 3229 0a20 2020 2020 2020  t(1), 2).       
-0000fb40: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000fb50: 6c28 7365 6c66 2e70 4244 422e 6361 7445  l(self.pBDB.catE
-0000fb60: 7870 2e63 6f75 6e74 4279 4578 7028 3130  xp.countByExp(10
-0000fb70: 292c 2032 290a 2020 2020 2020 2020 7365  ), 2).        se
-0000fb80: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-0000fb90: 656c 662e 7042 4442 2e63 6174 4578 702e  elf.pBDB.catExp.
-0000fba0: 636f 756e 7442 7945 7870 2831 292c 2030  countByExp(1), 0
-0000fbb0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0000fbc0: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-0000fbd0: 4244 422e 6361 7445 7870 2e69 6e73 6572  BDB.catExp.inser
-0000fbe0: 7428 2274 6573 7422 2c20 2274 6573 7422  t("test", "test"
-0000fbf0: 2929 0a0a 2020 2020 6465 6620 7465 7374  ))..    def test
-0000fc00: 5f45 6e74 7279 4578 7073 2873 656c 662c  _EntryExps(self,
-0000fc10: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-0000fc20: 2022 2222 5465 7374 2045 6e74 7279 4578   """Test EntryEx
-0000fc30: 7073 2066 756e 6374 696f 6e73 2222 220a  ps functions""".
-0000fc40: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0000fc50: 422e 7574 696c 732e 636c 6561 6e53 7061  B.utils.cleanSpa
-0000fc60: 7265 456e 7472 6965 7328 290a 2020 2020  reEntries().    
-0000fc70: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-0000fc80: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
-0000fc90: 6245 7870 2e69 6e73 6572 7428 2274 6573  bExp.insert("tes
-0000fca0: 7422 2c20 3129 290a 2020 2020 2020 2020  t", 1)).        
-0000fcb0: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
+0000ed20: 6765 744f 6e65 2831 2c20 2274 6573 7422  getOne(1, "test"
+0000ed30: 295b 305d 292c 2028 312c 2022 7465 7374  )[0]), (1, "test
+0000ed40: 222c 2031 2929 0a20 2020 2020 2020 2073  ", 1)).        s
+0000ed50: 656c 662e 6173 7365 7274 5472 7565 2873  elf.assertTrue(s
+0000ed60: 656c 662e 7042 4442 2e63 6174 4269 622e  elf.pBDB.catBib.
+0000ed70: 6465 6c65 7465 2831 2c20 2274 6573 7422  delete(1, "test"
+0000ed80: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+0000ed90: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+0000eda0: 2e70 4244 422e 6361 7442 6962 2e67 6574  .pBDB.catBib.get
+0000edb0: 4f6e 6528 312c 2022 7465 7374 2229 2c20  One(1, "test"), 
+0000edc0: 5b5d 290a 2020 2020 2020 2020 7365 6c66  []).        self
+0000edd0: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
+0000ede0: 662e 7042 4442 2e63 6174 4269 622e 696e  f.pBDB.catBib.in
+0000edf0: 7365 7274 2831 2c20 5b22 7465 7374 3122  sert(1, ["test1"
+0000ee00: 2c20 2274 6573 7432 225d 292c 204e 6f6e  , "test2"]), Non
+0000ee10: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+0000ee20: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0000ee30: 2020 2020 2020 2020 205b 7475 706c 6528           [tuple(
+0000ee40: 6129 2066 6f72 2061 2069 6e20 7365 6c66  a) for a in self
+0000ee50: 2e70 4244 422e 6361 7442 6962 2e67 6574  .pBDB.catBib.get
+0000ee60: 416c 6c28 295d 2c0a 2020 2020 2020 2020  All()],.        
+0000ee70: 2020 2020 5b28 312c 2022 7465 7374 3122      [(1, "test1"
+0000ee80: 2c20 3129 2c20 2832 2c20 2274 6573 7432  , 1), (2, "test2
+0000ee90: 222c 2031 295d 2c0a 2020 2020 2020 2020  ", 1)],.        
+0000eea0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0000eeb0: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+0000eec0: 7042 4442 2e63 6174 4269 622e 6465 6c65  pBDB.catBib.dele
+0000eed0: 7465 2831 2c20 5b22 7465 7374 3122 2c20  te(1, ["test1", 
+0000eee0: 2274 6573 7432 225d 292c 204e 6f6e 6529  "test2"]), None)
+0000eef0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0000ef00: 7365 7274 4571 7561 6c28 5b74 7570 6c65  sertEqual([tuple
+0000ef10: 2861 2920 666f 7220 6120 696e 2073 656c  (a) for a in sel
+0000ef20: 662e 7042 4442 2e63 6174 4269 622e 6765  f.pBDB.catBib.ge
+0000ef30: 7441 6c6c 2829 5d2c 205b 5d29 0a20 2020  tAll()], []).   
+0000ef40: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000ef50: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+0000ef60: 6361 7442 6962 2e69 6e73 6572 7428 5b31  catBib.insert([1
+0000ef70: 2c20 325d 2c20 5b22 7465 7374 3122 2c20  , 2], ["test1", 
+0000ef80: 2274 6573 7441 225d 292c 204e 6f6e 6529  "testA"]), None)
+0000ef90: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0000efa0: 7365 7274 5472 7565 2873 656c 662e 7042  sertTrue(self.pB
+0000efb0: 4442 2e63 6174 4269 622e 7570 6461 7465  DB.catBib.update
+0000efc0: 4269 626b 6579 2822 7465 7374 3222 2c20  Bibkey("test2", 
+0000efd0: 2274 6573 7441 2229 290a 2020 2020 2020  "testA")).      
+0000efe0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0000eff0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0000f000: 5b74 7570 6c65 2861 2920 666f 7220 6120  [tuple(a) for a 
+0000f010: 696e 2073 656c 662e 7042 4442 2e63 6174  in self.pBDB.cat
+0000f020: 4269 622e 6765 7441 6c6c 2829 5d2c 0a20  Bib.getAll()],. 
+0000f030: 2020 2020 2020 2020 2020 205b 2831 2c20             [(1, 
+0000f040: 2274 6573 7431 222c 2031 292c 2028 322c  "test1", 1), (2,
+0000f050: 2022 7465 7374 3222 2c20 3129 2c20 2833   "test2", 1), (3
+0000f060: 2c20 2274 6573 7431 222c 2032 292c 2028  , "test1", 2), (
+0000f070: 342c 2022 7465 7374 3222 2c20 3229 5d2c  4, "test2", 2)],
+0000f080: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0000f090: 2020 2073 656c 662e 7042 4442 2e75 7469     self.pBDB.uti
+0000f0a0: 6c73 2e63 6c65 616e 5370 6172 6545 6e74  ls.cleanSpareEnt
+0000f0b0: 7269 6573 2829 0a20 2020 2020 2020 2077  ries().        w
+0000f0c0: 6974 6820 7061 7463 6828 2262 7569 6c74  ith patch("built
+0000f0d0: 696e 732e 696e 7075 7422 2c20 7265 7475  ins.input", retu
+0000f0e0: 726e 5f76 616c 7565 3d22 5b31 2c32 5d22  rn_value="[1,2]"
+0000f0f0: 2920 6173 205f 696e 7075 743a 0a20 2020  ) as _input:.   
+0000f100: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0000f110: 4442 2e63 6174 4269 622e 6173 6b43 6174  DB.catBib.askCat
+0000f120: 7328 2274 6573 7431 2229 0a20 2020 2020  s("test1").     
+0000f130: 2020 2020 2020 205f 696e 7075 742e 6173         _input.as
+0000f140: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+0000f150: 5f77 6974 6828 2263 6174 6567 6f72 6965  _with("categorie
+0000f160: 7320 666f 7220 2774 6573 7431 273a 2022  s for 'test1': "
+0000f170: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+0000f180: 6174 6368 2822 6275 696c 7469 6e73 2e69  atch("builtins.i
+0000f190: 6e70 7574 222c 2072 6574 7572 6e5f 7661  nput", return_va
+0000f1a0: 6c75 653d 2231 2c32 2229 2061 7320 5f69  lue="1,2") as _i
+0000f1b0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+0000f1c0: 2020 7365 6c66 2e70 4244 422e 6361 7442    self.pBDB.catB
+0000f1d0: 6962 2e61 736b 4361 7473 2822 7465 7374  ib.askCats("test
+0000f1e0: 3122 290a 2020 2020 2020 2020 2020 2020  1").            
+0000f1f0: 5f69 6e70 7574 2e61 7373 6572 745f 6361  _input.assert_ca
+0000f200: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
+0000f210: 6361 7465 676f 7269 6573 2066 6f72 2027  categories for '
+0000f220: 7465 7374 3127 3a20 2229 0a20 2020 2020  test1': ").     
+0000f230: 2020 2077 6974 6820 7061 7463 6828 2262     with patch("b
+0000f240: 7569 6c74 696e 732e 696e 7075 7422 2c20  uiltins.input", 
+0000f250: 7265 7475 726e 5f76 616c 7565 3d22 7465  return_value="te
+0000f260: 7374 3222 2920 6173 205f 696e 7075 743a  st2") as _input:
+0000f270: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000f280: 662e 7042 4442 2e63 6174 4269 622e 6173  f.pBDB.catBib.as
+0000f290: 6b4b 6579 7328 5b31 2c20 325d 290a 2020  kKeys([1, 2]).  
+0000f2a0: 2020 2020 2020 2020 2020 5f69 6e70 7574            _input
+0000f2b0: 2e61 7373 6572 745f 6861 735f 6361 6c6c  .assert_has_call
+0000f2c0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0000f2d0: 2020 205b 6361 6c6c 2822 656e 7472 6965     [call("entrie
+0000f2e0: 7320 666f 7220 2731 273a 2022 292c 2063  s for '1': "), c
+0000f2f0: 616c 6c28 2265 6e74 7269 6573 2066 6f72  all("entries for
+0000f300: 2027 3227 3a20 2229 5d0a 2020 2020 2020   '2': ")].      
+0000f310: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000f320: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0000f330: 280a 2020 2020 2020 2020 2020 2020 5b74  (.            [t
+0000f340: 7570 6c65 2861 2920 666f 7220 6120 696e  uple(a) for a in
+0000f350: 2073 656c 662e 7042 4442 2e63 6174 4269   self.pBDB.catBi
+0000f360: 622e 6765 7441 6c6c 2829 5d2c 0a20 2020  b.getAll()],.   
+0000f370: 2020 2020 2020 2020 205b 2831 2c20 2274           [(1, "t
+0000f380: 6573 7431 222c 2031 292c 2028 322c 2022  est1", 1), (2, "
+0000f390: 7465 7374 3122 2c20 3229 2c20 2833 2c20  test1", 2), (3, 
+0000f3a0: 2274 6573 7432 222c 2031 292c 2028 342c  "test2", 1), (4,
+0000f3b0: 2022 7465 7374 3222 2c20 3229 5d2c 0a20   "test2", 2)],. 
+0000f3c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000f3d0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000f3e0: 6c28 7365 6c66 2e70 4244 422e 6361 7442  l(self.pBDB.catB
+0000f3f0: 6962 2e63 6f75 6e74 4279 4361 7428 3129  ib.countByCat(1)
+0000f400: 2c20 3229 0a20 2020 2020 2020 2073 656c  , 2).        sel
+0000f410: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
+0000f420: 662e 7042 4442 2e63 6174 4269 622e 696e  f.pBDB.catBib.in
+0000f430: 7365 7274 2822 7465 7374 222c 2022 7465  sert("test", "te
+0000f440: 7374 2229 290a 0a20 2020 2064 6566 2074  st"))..    def t
+0000f450: 6573 745f 6361 7445 7870 7328 7365 6c66  est_catExps(self
+0000f460: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
+0000f470: 2020 2222 2254 6573 7420 4361 7473 4578    """Test CatsEx
+0000f480: 7073 2066 756e 6374 696f 6e73 2222 220a  ps functions""".
+0000f490: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0000f4a0: 422e 7574 696c 732e 636c 6561 6e53 7061  B.utils.cleanSpa
+0000f4b0: 7265 456e 7472 6965 7328 290a 2020 2020  reEntries().    
+0000f4c0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+0000f4d0: 7275 6528 7365 6c66 2e70 4244 422e 6361  rue(self.pBDB.ca
+0000f4e0: 7445 7870 2e69 6e73 6572 7428 312c 2031  tExp.insert(1, 1
+0000f4f0: 3029 290a 2020 2020 2020 2020 7365 6c66  0)).        self
+0000f500: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
+0000f510: 662e 7042 4442 2e63 6174 4578 702e 696e  f.pBDB.catExp.in
+0000f520: 7365 7274 2831 2c20 3130 2929 2020 2320  sert(1, 10))  # 
+0000f530: 616c 7265 6164 7920 7072 6573 656e 740a  already present.
+0000f540: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000f550: 6572 7445 7175 616c 2874 7570 6c65 2873  ertEqual(tuple(s
+0000f560: 656c 662e 7042 4442 2e63 6174 4578 702e  elf.pBDB.catExp.
+0000f570: 6765 744f 6e65 2831 2c20 3130 295b 305d  getOne(1, 10)[0]
+0000f580: 292c 2028 312c 2031 302c 2031 2929 0a20  ), (1, 10, 1)). 
+0000f590: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000f5a0: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
+0000f5b0: 2e63 6174 4578 702e 6465 6c65 7465 2831  .catExp.delete(1
+0000f5c0: 2c20 3130 2929 0a20 2020 2020 2020 2073  , 10)).        s
+0000f5d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0000f5e0: 7365 6c66 2e70 4244 422e 6361 7445 7870  self.pBDB.catExp
+0000f5f0: 2e67 6574 4f6e 6528 312c 2031 3029 2c20  .getOne(1, 10), 
+0000f600: 5b5d 290a 2020 2020 2020 2020 7365 6c66  []).        self
+0000f610: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
+0000f620: 662e 7042 4442 2e63 6174 4578 702e 696e  f.pBDB.catExp.in
+0000f630: 7365 7274 2831 2c20 5b31 302c 2031 315d  sert(1, [10, 11]
+0000f640: 292c 204e 6f6e 6529 0a20 2020 2020 2020  ), None).       
+0000f650: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000f660: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+0000f670: 7475 706c 6528 6129 2066 6f72 2061 2069  tuple(a) for a i
+0000f680: 6e20 7365 6c66 2e70 4244 422e 6361 7445  n self.pBDB.catE
+0000f690: 7870 2e67 6574 416c 6c28 295d 2c20 5b28  xp.getAll()], [(
+0000f6a0: 312c 2031 302c 2031 292c 2028 322c 2031  1, 10, 1), (2, 1
+0000f6b0: 312c 2031 295d 0a20 2020 2020 2020 2029  1, 1)].        )
+0000f6c0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0000f6d0: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+0000f6e0: 4244 422e 6361 7445 7870 2e64 656c 6574  BDB.catExp.delet
+0000f6f0: 6528 312c 205b 3130 2c20 3131 5d29 2c20  e(1, [10, 11]), 
+0000f700: 4e6f 6e65 290a 2020 2020 2020 2020 7365  None).        se
+0000f710: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
+0000f720: 7475 706c 6528 6129 2066 6f72 2061 2069  tuple(a) for a i
+0000f730: 6e20 7365 6c66 2e70 4244 422e 6361 7445  n self.pBDB.catE
+0000f740: 7870 2e67 6574 416c 6c28 295d 2c20 5b5d  xp.getAll()], []
+0000f750: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0000f760: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+0000f770: 7042 4442 2e63 6174 4578 702e 696e 7365  pBDB.catExp.inse
+0000f780: 7274 285b 312c 2032 5d2c 205b 3130 2c20  rt([1, 2], [10, 
+0000f790: 3131 5d29 2c20 4e6f 6e65 290a 2020 2020  11]), None).    
+0000f7a0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0000f7b0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+0000f7c0: 2020 5b74 7570 6c65 2861 2920 666f 7220    [tuple(a) for 
+0000f7d0: 6120 696e 2073 656c 662e 7042 4442 2e63  a in self.pBDB.c
+0000f7e0: 6174 4578 702e 6765 7441 6c6c 2829 5d2c  atExp.getAll()],
+0000f7f0: 0a20 2020 2020 2020 2020 2020 205b 2831  .            [(1
+0000f800: 2c20 3130 2c20 3129 2c20 2832 2c20 3131  , 10, 1), (2, 11
+0000f810: 2c20 3129 2c20 2833 2c20 3130 2c20 3229  , 1), (3, 10, 2)
+0000f820: 2c20 2834 2c20 3131 2c20 3229 5d2c 0a20  , (4, 11, 2)],. 
+0000f830: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000f840: 2073 656c 662e 7042 4442 2e75 7469 6c73   self.pBDB.utils
+0000f850: 2e63 6c65 616e 5370 6172 6545 6e74 7269  .cleanSpareEntri
+0000f860: 6573 2829 0a20 2020 2020 2020 2077 6974  es().        wit
+0000f870: 6820 7061 7463 6828 2262 7569 6c74 696e  h patch("builtin
+0000f880: 732e 696e 7075 7422 2c20 7265 7475 726e  s.input", return
+0000f890: 5f76 616c 7565 3d22 5b31 2c32 5d22 2920  _value="[1,2]") 
+0000f8a0: 6173 205f 696e 7075 743a 0a20 2020 2020  as _input:.     
+0000f8b0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0000f8c0: 2e63 6174 4578 702e 6173 6b43 6174 7328  .catExp.askCats(
+0000f8d0: 3130 290a 2020 2020 2020 2020 2020 2020  10).            
+0000f8e0: 5f69 6e70 7574 2e61 7373 6572 745f 6361  _input.assert_ca
+0000f8f0: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
+0000f900: 6361 7465 676f 7269 6573 2066 6f72 2027  categories for '
+0000f910: 3130 273a 2022 290a 2020 2020 2020 2020  10': ").        
+0000f920: 7769 7468 2070 6174 6368 2822 6275 696c  with patch("buil
+0000f930: 7469 6e73 2e69 6e70 7574 222c 2072 6574  tins.input", ret
+0000f940: 7572 6e5f 7661 6c75 653d 2231 3122 2920  urn_value="11") 
+0000f950: 6173 205f 696e 7075 743a 0a20 2020 2020  as _input:.     
+0000f960: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0000f970: 2e63 6174 4578 702e 6173 6b45 7870 7328  .catExp.askExps(
+0000f980: 5b31 2c20 325d 290a 2020 2020 2020 2020  [1, 2]).        
+0000f990: 2020 2020 5f69 6e70 7574 2e61 7373 6572      _input.asser
+0000f9a0: 745f 6861 735f 6361 6c6c 7328 0a20 2020  t_has_calls(.   
+0000f9b0: 2020 2020 2020 2020 2020 2020 205b 6361               [ca
+0000f9c0: 6c6c 2822 6578 7065 7269 6d65 6e74 7320  ll("experiments 
+0000f9d0: 666f 7220 2731 273a 2022 292c 2063 616c  for '1': "), cal
+0000f9e0: 6c28 2265 7870 6572 696d 656e 7473 2066  l("experiments f
+0000f9f0: 6f72 2027 3227 3a20 2229 5d0a 2020 2020  or '2': ")].    
+0000fa00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000fa10: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0000fa20: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0000fa30: 5b74 7570 6c65 2861 2920 666f 7220 6120  [tuple(a) for a 
+0000fa40: 696e 2073 656c 662e 7042 4442 2e63 6174  in self.pBDB.cat
+0000fa50: 4578 702e 6765 7441 6c6c 2829 5d2c 0a20  Exp.getAll()],. 
+0000fa60: 2020 2020 2020 2020 2020 205b 2831 2c20             [(1, 
+0000fa70: 3130 2c20 3129 2c20 2832 2c20 3130 2c20  10, 1), (2, 10, 
+0000fa80: 3229 2c20 2833 2c20 3131 2c20 3129 2c20  2), (3, 11, 1), 
+0000fa90: 2834 2c20 3131 2c20 3229 5d2c 0a20 2020  (4, 11, 2)],.   
+0000faa0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0000fab0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0000fac0: 7365 6c66 2e70 4244 422e 6361 7445 7870  self.pBDB.catExp
+0000fad0: 2e63 6f75 6e74 4279 4361 7428 3129 2c20  .countByCat(1), 
+0000fae0: 3229 0a20 2020 2020 2020 2073 656c 662e  2).        self.
+0000faf0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+0000fb00: 2e70 4244 422e 6361 7445 7870 2e63 6f75  .pBDB.catExp.cou
+0000fb10: 6e74 4279 4578 7028 3130 292c 2032 290a  ntByExp(10), 2).
+0000fb20: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000fb30: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+0000fb40: 4442 2e63 6174 4578 702e 636f 756e 7442  DB.catExp.countB
+0000fb50: 7945 7870 2831 292c 2030 290a 2020 2020  yExp(1), 0).    
+0000fb60: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+0000fb70: 7275 6528 7365 6c66 2e70 4244 422e 6361  rue(self.pBDB.ca
+0000fb80: 7445 7870 2e69 6e73 6572 7428 2274 6573  tExp.insert("tes
+0000fb90: 7422 2c20 2274 6573 7422 2929 0a0a 2020  t", "test"))..  
+0000fba0: 2020 6465 6620 7465 7374 5f45 6e74 7279    def test_Entry
+0000fbb0: 4578 7073 2873 656c 662c 202a 6172 6773  Exps(self, *args
+0000fbc0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+0000fbd0: 7374 2045 6e74 7279 4578 7073 2066 756e  st EntryExps fun
+0000fbe0: 6374 696f 6e73 2222 220a 2020 2020 2020  ctions""".      
+0000fbf0: 2020 7365 6c66 2e70 4244 422e 7574 696c    self.pBDB.util
+0000fc00: 732e 636c 6561 6e53 7061 7265 456e 7472  s.cleanSpareEntr
+0000fc10: 6965 7328 290a 2020 2020 2020 2020 7365  ies().        se
+0000fc20: 6c66 2e61 7373 6572 7454 7275 6528 7365  lf.assertTrue(se
+0000fc30: 6c66 2e70 4244 422e 6269 6245 7870 2e69  lf.pBDB.bibExp.i
+0000fc40: 6e73 6572 7428 2274 6573 7422 2c20 3129  nsert("test", 1)
+0000fc50: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0000fc60: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
+0000fc70: 7042 4442 2e62 6962 4578 702e 696e 7365  pBDB.bibExp.inse
+0000fc80: 7274 2822 7465 7374 222c 2031 2929 2020  rt("test", 1))  
+0000fc90: 2320 616c 7265 6164 7920 7072 6573 656e  # already presen
+0000fca0: 740a 2020 2020 2020 2020 7365 6c66 2e61  t.        self.a
+0000fcb0: 7373 6572 7445 7175 616c 2874 7570 6c65  ssertEqual(tuple
 0000fcc0: 2873 656c 662e 7042 4442 2e62 6962 4578  (self.pBDB.bibEx
-0000fcd0: 702e 696e 7365 7274 2822 7465 7374 222c  p.insert("test",
-0000fce0: 2031 2929 2020 2320 616c 7265 6164 7920   1))  # already 
-0000fcf0: 7072 6573 656e 740a 2020 2020 2020 2020  present.        
-0000fd00: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000fd10: 2874 7570 6c65 2873 656c 662e 7042 4442  (tuple(self.pBDB
-0000fd20: 2e62 6962 4578 702e 6765 744f 6e65 2822  .bibExp.getOne("
-0000fd30: 7465 7374 222c 2031 295b 305d 292c 2028  test", 1)[0]), (
-0000fd40: 312c 2022 7465 7374 222c 2031 2929 0a20  1, "test", 1)). 
-0000fd50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000fd60: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
-0000fd70: 2e62 6962 4578 702e 6465 6c65 7465 2822  .bibExp.delete("
-0000fd80: 7465 7374 222c 2031 2929 0a20 2020 2020  test", 1)).     
-0000fd90: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0000fda0: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
-0000fdb0: 6245 7870 2e67 6574 4f6e 6528 2274 6573  bExp.getOne("tes
-0000fdc0: 7422 2c20 3129 2c20 5b5d 290a 2020 2020  t", 1), []).    
-0000fdd0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0000fde0: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
-0000fdf0: 6962 4578 702e 696e 7365 7274 285b 2274  ibExp.insert(["t
-0000fe00: 6573 7431 222c 2022 7465 7374 3222 5d2c  est1", "test2"],
-0000fe10: 2031 292c 204e 6f6e 6529 0a20 2020 2020   1), None).     
-0000fe20: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0000fe30: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-0000fe40: 205b 7475 706c 6528 6129 2066 6f72 2061   [tuple(a) for a
-0000fe50: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-0000fe60: 6245 7870 2e67 6574 416c 6c28 295d 2c0a  bExp.getAll()],.
-0000fe70: 2020 2020 2020 2020 2020 2020 5b28 312c              [(1,
-0000fe80: 2022 7465 7374 3122 2c20 3129 2c20 2832   "test1", 1), (2
-0000fe90: 2c20 2274 6573 7432 222c 2031 295d 2c0a  , "test2", 1)],.
-0000fea0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000feb0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000fec0: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
-0000fed0: 4578 702e 6465 6c65 7465 285b 2274 6573  Exp.delete(["tes
-0000fee0: 7431 222c 2022 7465 7374 3222 5d2c 2031  t1", "test2"], 1
-0000fef0: 292c 204e 6f6e 6529 0a20 2020 2020 2020  ), None).       
-0000ff00: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000ff10: 6c28 5b74 7570 6c65 2861 2920 666f 7220  l([tuple(a) for 
-0000ff20: 6120 696e 2073 656c 662e 7042 4442 2e62  a in self.pBDB.b
-0000ff30: 6962 4578 702e 6765 7441 6c6c 2829 5d2c  ibExp.getAll()],
-0000ff40: 205b 5d29 0a20 2020 2020 2020 2073 656c   []).        sel
-0000ff50: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-0000ff60: 6c66 2e70 4244 422e 6269 6245 7870 2e69  lf.pBDB.bibExp.i
-0000ff70: 6e73 6572 7428 5b22 7465 7374 3122 2c20  nsert(["test1", 
-0000ff80: 2274 6573 7441 225d 2c20 5b31 2c20 325d  "testA"], [1, 2]
-0000ff90: 292c 204e 6f6e 6529 0a20 2020 2020 2020  ), None).       
-0000ffa0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-0000ffb0: 2873 656c 662e 7042 4442 2e62 6962 4578  (self.pBDB.bibEx
-0000ffc0: 702e 7570 6461 7465 4269 626b 6579 2822  p.updateBibkey("
-0000ffd0: 7465 7374 3222 2c20 2274 6573 7441 2229  test2", "testA")
-0000ffe0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0000fff0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00010000: 2020 2020 2020 2020 5b74 7570 6c65 2861          [tuple(a
-00010010: 2920 666f 7220 6120 696e 2073 656c 662e  ) for a in self.
-00010020: 7042 4442 2e62 6962 4578 702e 6765 7441  pBDB.bibExp.getA
-00010030: 6c6c 2829 5d2c 0a20 2020 2020 2020 2020  ll()],.         
-00010040: 2020 205b 2831 2c20 2274 6573 7431 222c     [(1, "test1",
-00010050: 2031 292c 2028 322c 2022 7465 7374 3122   1), (2, "test1"
-00010060: 2c20 3229 2c20 2833 2c20 2274 6573 7432  , 2), (3, "test2
-00010070: 222c 2031 292c 2028 342c 2022 7465 7374  ", 1), (4, "test
-00010080: 3222 2c20 3229 5d2c 0a20 2020 2020 2020  2", 2)],.       
-00010090: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-000100a0: 7042 4442 2e75 7469 6c73 2e63 6c65 616e  pBDB.utils.clean
-000100b0: 5370 6172 6545 6e74 7269 6573 2829 0a20  SpareEntries(). 
-000100c0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-000100d0: 6828 2262 7569 6c74 696e 732e 696e 7075  h("builtins.inpu
-000100e0: 7422 2c20 7265 7475 726e 5f76 616c 7565  t", return_value
-000100f0: 3d22 5b31 2c32 5d22 2920 6173 205f 696e  ="[1,2]") as _in
-00010100: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-00010110: 2073 656c 662e 7042 4442 2e62 6962 4578   self.pBDB.bibEx
-00010120: 702e 6173 6b45 7870 7328 2274 6573 7431  p.askExps("test1
-00010130: 2229 0a20 2020 2020 2020 2020 2020 205f  ").            _
-00010140: 696e 7075 742e 6173 7365 7274 5f63 616c  input.assert_cal
-00010150: 6c65 645f 6f6e 6365 5f77 6974 6828 2265  led_once_with("e
-00010160: 7870 6572 696d 656e 7473 2066 6f72 2027  xperiments for '
-00010170: 7465 7374 3127 3a20 2229 0a20 2020 2020  test1': ").     
-00010180: 2020 2077 6974 6820 7061 7463 6828 2262     with patch("b
-00010190: 7569 6c74 696e 732e 696e 7075 7422 2c20  uiltins.input", 
-000101a0: 7265 7475 726e 5f76 616c 7565 3d22 312c  return_value="1,
-000101b0: 3222 2920 6173 205f 696e 7075 743a 0a20  2") as _input:. 
-000101c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000101d0: 7042 4442 2e62 6962 4578 702e 6173 6b45  pBDB.bibExp.askE
-000101e0: 7870 7328 2274 6573 7431 2229 0a20 2020  xps("test1").   
-000101f0: 2020 2020 2020 2020 205f 696e 7075 742e           _input.
-00010200: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00010210: 6365 5f77 6974 6828 2265 7870 6572 696d  ce_with("experim
-00010220: 656e 7473 2066 6f72 2027 7465 7374 3127  ents for 'test1'
-00010230: 3a20 2229 0a20 2020 2020 2020 2077 6974  : ").        wit
-00010240: 6820 7061 7463 6828 2262 7569 6c74 696e  h patch("builtin
-00010250: 732e 696e 7075 7422 2c20 7265 7475 726e  s.input", return
-00010260: 5f76 616c 7565 3d22 7465 7374 3222 2920  _value="test2") 
-00010270: 6173 205f 696e 7075 743a 0a20 2020 2020  as _input:.     
-00010280: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00010290: 2e62 6962 4578 702e 6173 6b4b 6579 7328  .bibExp.askKeys(
-000102a0: 5b31 2c20 325d 290a 2020 2020 2020 2020  [1, 2]).        
-000102b0: 2020 2020 5f69 6e70 7574 2e61 7373 6572      _input.asser
-000102c0: 745f 6861 735f 6361 6c6c 7328 0a20 2020  t_has_calls(.   
-000102d0: 2020 2020 2020 2020 2020 2020 205b 6361               [ca
-000102e0: 6c6c 2822 656e 7472 6965 7320 666f 7220  ll("entries for 
-000102f0: 2731 273a 2022 292c 2063 616c 6c28 2265  '1': "), call("e
-00010300: 6e74 7269 6573 2066 6f72 2027 3227 3a20  ntries for '2': 
-00010310: 2229 5d0a 2020 2020 2020 2020 2020 2020  ")].            
-00010320: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00010330: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00010340: 2020 2020 2020 2020 5b74 7570 6c65 2861          [tuple(a
-00010350: 2920 666f 7220 6120 696e 2073 656c 662e  ) for a in self.
-00010360: 7042 4442 2e62 6962 4578 702e 6765 7441  pBDB.bibExp.getA
-00010370: 6c6c 2829 5d2c 0a20 2020 2020 2020 2020  ll()],.         
-00010380: 2020 205b 2831 2c20 2274 6573 7431 222c     [(1, "test1",
-00010390: 2031 292c 2028 322c 2022 7465 7374 3122   1), (2, "test1"
-000103a0: 2c20 3229 2c20 2833 2c20 2274 6573 7432  , 2), (3, "test2
-000103b0: 222c 2031 292c 2028 342c 2022 7465 7374  ", 1), (4, "test
-000103c0: 3222 2c20 3229 5d2c 0a20 2020 2020 2020  2", 2)],.       
-000103d0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-000103e0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-000103f0: 2e70 4244 422e 6269 6245 7870 2e63 6f75  .pBDB.bibExp.cou
-00010400: 6e74 4279 4578 7028 3129 2c20 3229 0a20  ntByExp(1), 2). 
-00010410: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00010420: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
-00010430: 2e62 6962 4578 702e 696e 7365 7274 2822  .bibExp.insert("
-00010440: 7465 7374 222c 2022 7465 7374 2229 290a  test", "test")).
-00010450: 0a0a 4075 6e69 7474 6573 742e 736b 6970  ..@unittest.skip
-00010460: 4966 2873 6b69 7054 6573 7473 5365 7474  If(skipTestsSett
-00010470: 696e 6773 2e64 622c 2022 4461 7461 6261  ings.db, "Databa
-00010480: 7365 2074 6573 7473 2229 0a40 7061 7463  se tests").@patc
-00010490: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
-000104a0: 722e 6465 6275 6722 290a 4070 6174 6368  r.debug").@patch
-000104b0: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-000104c0: 2e69 6e66 6f22 290a 4070 6174 6368 2822  .info").@patch("
-000104d0: 6c6f 6767 696e 672e 4c6f 6767 6572 2e77  logging.Logger.w
-000104e0: 6172 6e69 6e67 2229 0a40 7061 7463 6828  arning").@patch(
-000104f0: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-00010500: 6578 6365 7074 696f 6e22 290a 636c 6173  exception").clas
-00010510: 7320 5465 7374 4461 7461 6261 7365 4578  s TestDatabaseEx
-00010520: 7065 7269 6d65 6e74 7328 4442 5465 7374  periments(DBTest
-00010530: 4361 7365 293a 0a20 2020 2022 2222 5465  Case):.    """Te
-00010540: 7374 7320 666f 7220 7468 6520 6d65 7468  sts for the meth
-00010550: 6f64 7320 696e 2074 6865 2065 7870 6572  ods in the exper
-00010560: 696d 656e 7473 2073 7562 636c 6173 7322  iments subclass"
-00010570: 2222 0a0a 2020 2020 6465 6620 6368 6563  ""..    def chec
-00010580: 6b4e 756d 6265 7245 7870 6572 696d 656e  kNumberExperimen
-00010590: 7473 2873 656c 662c 206e 756d 6265 7229  ts(self, number)
-000105a0: 3a0a 2020 2020 2020 2020 2222 2243 6865  :.        """Che
-000105b0: 636b 2074 6865 206e 756d 6265 7220 6f66  ck the number of
-000105c0: 2065 7870 6572 696d 656e 7473 2222 220a   experiments""".
-000105d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000105e0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-000105f0: 4442 2e65 7870 732e 636f 756e 7428 292c  DB.exps.count(),
-00010600: 206e 756d 6265 7229 0a0a 2020 2020 6465   number)..    de
-00010610: 6620 7465 7374 5f69 6e73 6572 7455 7064  f test_insertUpd
-00010620: 6174 6544 656c 6574 6528 7365 6c66 2c20  ateDelete(self, 
-00010630: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
-00010640: 2222 2254 6573 7420 696e 7365 7274 2c20  """Test insert, 
-00010650: 7570 6461 7465 2c20 7570 6461 7465 4669  update, updateFi
-00010660: 656c 642c 2064 656c 6574 6520 666f 7220  eld, delete for 
-00010670: 616e 2065 7870 6572 696d 656e 7422 2222  an experiment"""
-00010680: 0a20 2020 2020 2020 2073 656c 662e 6368  .        self.ch
-00010690: 6563 6b4e 756d 6265 7245 7870 6572 696d  eckNumberExperim
-000106a0: 656e 7473 2830 290a 2020 2020 2020 2020  ents(0).        
-000106b0: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
-000106c0: 2873 656c 662e 7042 4442 2e65 7870 732e  (self.pBDB.exps.
-000106d0: 696e 7365 7274 287b 226e 616d 6522 3a20  insert({"name": 
-000106e0: 2265 7870 3122 7d29 290a 2020 2020 2020  "exp1"})).      
-000106f0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00010700: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-00010710: 656c 662e 7042 4442 2e65 7870 732e 696e  elf.pBDB.exps.in
-00010720: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
-00010730: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
-00010740: 6578 7031 222c 2022 636f 6d6d 656e 7473  exp1", "comments
-00010750: 223a 2022 222c 2022 686f 6d65 7061 6765  ": "", "homepage
-00010760: 223a 2022 222c 2022 696e 7370 6972 6522  ": "", "inspire"
-00010770: 3a20 2222 7d0a 2020 2020 2020 2020 2020  : ""}.          
-00010780: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
-00010790: 2020 2020 2020 7365 6c66 2e63 6865 636b        self.check
-000107a0: 4e75 6d62 6572 4578 7065 7269 6d65 6e74  NumberExperiment
-000107b0: 7328 3129 0a20 2020 2020 2020 2073 656c  s(1).        sel
-000107c0: 662e 6173 7365 7274 5472 7565 280a 2020  f.assertTrue(.  
-000107d0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-000107e0: 4244 422e 6578 7073 2e69 6e73 6572 7428  BDB.exps.insert(
-000107f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010800: 207b 226e 616d 6522 3a20 2265 7870 3122   {"name": "exp1"
-00010810: 2c20 2263 6f6d 6d65 6e74 7322 3a20 2222  , "comments": ""
-00010820: 2c20 2268 6f6d 6570 6167 6522 3a20 2222  , "homepage": ""
-00010830: 2c20 2269 6e73 7069 7265 223a 2022 227d  , "inspire": ""}
-00010840: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00010850: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00010860: 2073 656c 662e 6368 6563 6b4e 756d 6265   self.checkNumbe
-00010870: 7245 7870 6572 696d 656e 7473 2832 290a  rExperiments(2).
-00010880: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00010890: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-000108a0: 2020 2020 2020 7b65 5b22 6964 4578 7022        {e["idExp"
-000108b0: 5d3a 2065 5b22 6e61 6d65 225d 2066 6f72  ]: e["name"] for
-000108c0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-000108d0: 6578 7073 2e67 6574 416c 6c28 297d 2c0a  exps.getAll()},.
-000108e0: 2020 2020 2020 2020 2020 2020 7b31 3a20              {1: 
-000108f0: 2265 7870 3122 2c20 323a 2022 6578 7031  "exp1", 2: "exp1
-00010900: 227d 2c0a 2020 2020 2020 2020 290a 2020  "},.        ).  
-00010910: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00010920: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00010930: 2020 2020 7b65 5b22 6964 4578 7022 5d3a      {e["idExp"]:
-00010940: 2065 5b22 696e 7370 6972 6522 5d20 666f   e["inspire"] fo
-00010950: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-00010960: 2e65 7870 732e 6765 7441 6c6c 2829 7d2c  .exps.getAll()},
-00010970: 207b 313a 2022 222c 2032 3a20 2222 7d0a   {1: "", 2: ""}.
-00010980: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00010990: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-000109a0: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-000109b0: 656c 662e 7042 4442 2e65 7870 732e 7570  elf.pBDB.exps.up
-000109c0: 6461 7465 280a 2020 2020 2020 2020 2020  date(.          
-000109d0: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
-000109e0: 6578 7032 222c 2022 636f 6d6d 656e 7473  exp2", "comments
-000109f0: 223a 2022 222c 2022 686f 6d65 7061 6765  ": "", "homepage
-00010a00: 223a 2022 222c 2022 696e 7370 6972 6522  ": "", "inspire"
-00010a10: 3a20 2231 3233 227d 2c20 320a 2020 2020  : "123"}, 2.    
-00010a20: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00010a30: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00010a40: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00010a50: 2020 2020 2020 2020 2020 7b65 5b22 6964            {e["id
-00010a60: 4578 7022 5d3a 2065 5b22 6e61 6d65 225d  Exp"]: e["name"]
-00010a70: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00010a80: 4244 422e 6578 7073 2e67 6574 416c 6c28  BDB.exps.getAll(
-00010a90: 297d 2c0a 2020 2020 2020 2020 2020 2020  )},.            
-00010aa0: 7b31 3a20 2265 7870 3122 2c20 323a 2022  {1: "exp1", 2: "
-00010ab0: 6578 7032 227d 2c0a 2020 2020 2020 2020  exp2"},.        
-00010ac0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00010ad0: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-00010ae0: 4244 422e 6578 7073 2e75 7064 6174 6546  BDB.exps.updateF
-00010af0: 6965 6c64 2831 2c20 2269 6e73 7069 7265  ield(1, "inspire
-00010b00: 222c 2022 3435 3622 2929 0a20 2020 2020  ", "456")).     
-00010b10: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00010b20: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00010b30: 207b 655b 2269 6445 7870 225d 3a20 655b   {e["idExp"]: e[
-00010b40: 2269 6e73 7069 7265 225d 2066 6f72 2065  "inspire"] for e
-00010b50: 2069 6e20 7365 6c66 2e70 4244 422e 6578   in self.pBDB.ex
-00010b60: 7073 2e67 6574 416c 6c28 297d 2c0a 2020  ps.getAll()},.  
-00010b70: 2020 2020 2020 2020 2020 7b31 3a20 2234            {1: "4
-00010b80: 3536 222c 2032 3a20 2231 3233 227d 2c0a  56", 2: "123"},.
-00010b90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00010ba0: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
-00010bb0: 7365 2873 656c 662e 7042 4442 2e65 7870  se(self.pBDB.exp
-00010bc0: 732e 7570 6461 7465 287b 226e 616d 6522  s.update({"name"
-00010bd0: 3a20 2265 7870 3222 2c20 2269 6e73 7069  : "exp2", "inspi
-00010be0: 7265 223a 2022 3132 3322 7d2c 2032 2929  re": "123"}, 2))
-00010bf0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00010c00: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
-00010c10: 4244 422e 6578 7073 2e75 7064 6174 6546  BDB.exps.updateF
-00010c20: 6965 6c64 2831 2c20 2269 6e73 7069 7265  ield(1, "inspire
-00010c30: 7322 2c20 2234 3536 2229 290a 2020 2020  s", "456")).    
-00010c40: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
-00010c50: 616c 7365 2873 656c 662e 7042 4442 2e65  alse(self.pBDB.e
-00010c60: 7870 732e 7570 6461 7465 4669 656c 6428  xps.updateField(
-00010c70: 312c 2022 6964 4578 7022 2c20 2232 2229  1, "idExp", "2")
-00010c80: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00010c90: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
-00010ca0: 7042 4442 2e65 7870 732e 7570 6461 7465  pBDB.exps.update
-00010cb0: 4669 656c 6428 312c 2022 696e 7370 6972  Field(1, "inspir
-00010cc0: 6522 2c20 4e6f 6e65 2929 0a20 2020 2020  e", None)).     
-00010cd0: 2020 2073 656c 662e 6368 6563 6b4e 756d     self.checkNum
-00010ce0: 6265 7245 7870 6572 696d 656e 7473 2832  berExperiments(2
-00010cf0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00010d00: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-00010d10: 4244 422e 6361 7445 7870 2e69 6e73 6572  BDB.catExp.inser
-00010d20: 7428 312c 2031 2929 0a20 2020 2020 2020  t(1, 1)).       
-00010d30: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00010d40: 2873 656c 662e 7042 4442 2e62 6962 4578  (self.pBDB.bibEx
-00010d50: 702e 696e 7365 7274 2822 7465 7374 222c  p.insert("test",
-00010d60: 2031 2929 0a20 2020 2020 2020 2064 6253   1)).        dbS
-00010d70: 7461 7473 2873 656c 662e 7042 4442 290a  tats(self.pBDB).
-00010d80: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00010d90: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-00010da0: 4442 2e73 7461 7473 5b22 6578 7073 225d  DB.stats["exps"]
-00010db0: 2c20 3229 0a20 2020 2020 2020 2073 656c  , 2).        sel
-00010dc0: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-00010dd0: 6c66 2e70 4244 422e 7374 6174 735b 2263  lf.pBDB.stats["c
-00010de0: 6174 4578 7022 5d2c 2031 290a 2020 2020  atExp"], 1).    
-00010df0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00010e00: 7175 616c 2873 656c 662e 7042 4442 2e73  qual(self.pBDB.s
-00010e10: 7461 7473 5b22 6269 6245 7870 225d 2c20  tats["bibExp"], 
-00010e20: 3129 0a20 2020 2020 2020 2073 656c 662e  1).        self.
-00010e30: 7042 4442 2e65 7870 732e 6465 6c65 7465  pBDB.exps.delete
-00010e40: 285b 312c 2032 5d29 0a20 2020 2020 2020  ([1, 2]).       
-00010e50: 2073 656c 662e 6368 6563 6b4e 756d 6265   self.checkNumbe
-00010e60: 7245 7870 6572 696d 656e 7473 2830 290a  rExperiments(0).
-00010e70: 2020 2020 2020 2020 6462 5374 6174 7328          dbStats(
-00010e80: 7365 6c66 2e70 4244 4229 0a20 2020 2020  self.pBDB).     
-00010e90: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00010ea0: 7561 6c28 7365 6c66 2e70 4244 422e 7374  ual(self.pBDB.st
-00010eb0: 6174 735b 2263 6174 4578 7022 5d2c 2030  ats["catExp"], 0
-00010ec0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00010ed0: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-00010ee0: 7042 4442 2e73 7461 7473 5b22 6269 6245  pBDB.stats["bibE
-00010ef0: 7870 225d 2c20 3029 0a0a 2020 2020 6465  xp"], 0)..    de
-00010f00: 6620 7465 7374 5f67 6574 2873 656c 662c  f test_get(self,
-00010f10: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-00010f20: 2022 2222 5465 7374 2067 6574 206d 6574   """Test get met
-00010f30: 686f 6473 2222 220a 2020 2020 2020 2020  hods""".        
-00010f40: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-00010f50: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00010f60: 662e 7042 4442 2e65 7870 732e 696e 7365  f.pBDB.exps.inse
-00010f70: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
-00010f80: 2020 2020 7b22 6e61 6d65 223a 2022 6578      {"name": "ex
-00010f90: 7031 222c 2022 636f 6d6d 656e 7473 223a  p1", "comments":
-00010fa0: 2022 222c 2022 686f 6d65 7061 6765 223a   "", "homepage":
-00010fb0: 2022 222c 2022 696e 7370 6972 6522 3a20   "", "inspire": 
-00010fc0: 2222 7d0a 2020 2020 2020 2020 2020 2020  ""}.            
-00010fd0: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00010fe0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00010ff0: 7275 6528 0a20 2020 2020 2020 2020 2020  rue(.           
-00011000: 2073 656c 662e 7042 4442 2e65 7870 732e   self.pBDB.exps.
-00011010: 696e 7365 7274 280a 2020 2020 2020 2020  insert(.        
-00011020: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
-00011030: 2022 6578 7032 222c 2022 636f 6d6d 656e   "exp2", "commen
-00011040: 7473 223a 2022 222c 2022 686f 6d65 7061  ts": "", "homepa
-00011050: 6765 223a 2022 222c 2022 696e 7370 6972  ge": "", "inspir
-00011060: 6522 3a20 2222 7d0a 2020 2020 2020 2020  e": ""}.        
-00011070: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
-00011080: 2020 2020 2020 2020 7365 6c66 2e63 6865          self.che
-00011090: 636b 4e75 6d62 6572 4578 7065 7269 6d65  ckNumberExperime
-000110a0: 6e74 7328 3229 0a20 2020 2020 2020 2073  nts(2).        s
-000110b0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000110c0: 0a20 2020 2020 2020 2020 2020 205b 6469  .            [di
-000110d0: 6374 2865 2920 666f 7220 6520 696e 2073  ct(e) for e in s
-000110e0: 656c 662e 7042 4442 2e65 7870 732e 6765  elf.pBDB.exps.ge
-000110f0: 7441 6c6c 2829 5d2c 0a20 2020 2020 2020  tAll()],.       
-00011100: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00011110: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00011120: 2020 2020 2020 2020 2020 2020 2022 6964               "id
-00011130: 4578 7022 3a20 312c 0a20 2020 2020 2020  Exp": 1,.       
-00011140: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
-00011150: 6d65 223a 2022 6578 7031 222c 0a20 2020  me": "exp1",.   
-00011160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011170: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
-00011180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011190: 2020 2020 2022 686f 6d65 7061 6765 223a       "homepage":
-000111a0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-000111b0: 2020 2020 2020 2020 2022 696e 7370 6972           "inspir
-000111c0: 6522 3a20 2222 2c0a 2020 2020 2020 2020  e": "",.        
-000111d0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-000111e0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-000111f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011200: 2022 6964 4578 7022 3a20 322c 0a20 2020   "idExp": 2,.   
-00011210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011220: 2022 6e61 6d65 223a 2022 6578 7032 222c   "name": "exp2",
-00011230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011240: 2020 2020 2022 636f 6d6d 656e 7473 223a       "comments":
-00011250: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00011260: 2020 2020 2020 2020 2022 686f 6d65 7061           "homepa
-00011270: 6765 223a 2022 222c 0a20 2020 2020 2020  ge": "",.       
-00011280: 2020 2020 2020 2020 2020 2020 2022 696e               "in
-00011290: 7370 6972 6522 3a20 2222 2c0a 2020 2020  spire": "",.    
-000112a0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-000112b0: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-000112c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000112d0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000112e0: 280a 2020 2020 2020 2020 2020 2020 5b64  (.            [d
-000112f0: 6963 7428 6529 2066 6f72 2065 2069 6e20  ict(e) for e in 
-00011300: 7365 6c66 2e70 4244 422e 6578 7073 2e67  self.pBDB.exps.g
-00011310: 6574 4279 4944 2831 295d 2c0a 2020 2020  etByID(1)],.    
-00011320: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00011330: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00011340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011350: 2269 6445 7870 223a 2031 2c0a 2020 2020  "idExp": 1,.    
-00011360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011370: 226e 616d 6522 3a20 2265 7870 3122 2c0a  "name": "exp1",.
-00011380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011390: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
-000113a0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-000113b0: 2020 2020 2020 2020 2268 6f6d 6570 6167          "homepag
-000113c0: 6522 3a20 2222 2c0a 2020 2020 2020 2020  e": "",.        
-000113d0: 2020 2020 2020 2020 2020 2020 2269 6e73              "ins
-000113e0: 7069 7265 223a 2022 222c 0a20 2020 2020  pire": "",.     
-000113f0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00011400: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00011410: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00011420: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00011430: 2020 2020 2020 2020 2020 2020 5b64 6963              [dic
-00011440: 7428 6529 2066 6f72 2065 2069 6e20 7365  t(e) for e in se
-00011450: 6c66 2e70 4244 422e 6578 7073 2e67 6574  lf.pBDB.exps.get
-00011460: 4279 4e61 6d65 2822 6578 7032 2229 5d2c  ByName("exp2")],
-00011470: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-00011480: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00011490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000114a0: 2020 2020 2022 6964 4578 7022 3a20 322c       "idExp": 2,
-000114b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000114c0: 2020 2020 2022 6e61 6d65 223a 2022 6578       "name": "ex
-000114d0: 7032 222c 0a20 2020 2020 2020 2020 2020  p2",.           
-000114e0: 2020 2020 2020 2020 2022 636f 6d6d 656e           "commen
-000114f0: 7473 223a 2022 222c 0a20 2020 2020 2020  ts": "",.       
-00011500: 2020 2020 2020 2020 2020 2020 2022 686f               "ho
-00011510: 6d65 7061 6765 223a 2022 222c 0a20 2020  mepage": "",.   
-00011520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011530: 2022 696e 7370 6972 6522 3a20 2222 2c0a   "inspire": "",.
-00011540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011550: 7d0a 2020 2020 2020 2020 2020 2020 5d2c  }.            ],
-00011560: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00011570: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00011580: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00011590: 2073 656c 662e 7042 4442 2e65 7870 732e   self.pBDB.exps.
-000115a0: 6765 7444 6963 7442 7949 4428 3129 2c0a  getDictByID(1),.
-000115b0: 2020 2020 2020 2020 2020 2020 7b22 6964              {"id
-000115c0: 4578 7022 3a20 312c 2022 6e61 6d65 223a  Exp": 1, "name":
-000115d0: 2022 6578 7031 222c 2022 636f 6d6d 656e   "exp1", "commen
-000115e0: 7473 223a 2022 222c 2022 686f 6d65 7061  ts": "", "homepa
-000115f0: 6765 223a 2022 222c 2022 696e 7370 6972  ge": "", "inspir
-00011600: 6522 3a20 2222 7d2c 0a20 2020 2020 2020  e": ""},.       
-00011610: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
-00011620: 5f66 696c 7465 7241 6c6c 2873 656c 662c  _filterAll(self,
-00011630: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-00011640: 2022 2222 7465 7374 2074 6865 2066 696c   """test the fil
-00011650: 7465 7241 6c6c 2066 756e 6374 696f 6e2c  terAll function,
-00011660: 2074 6861 7420 6c6f 6f6b 7320 696e 746f   that looks into
-00011670: 2061 6c6c 2074 6865 2066 6965 6c64 730a   all the fields.
-00011680: 2020 2020 2020 2020 666f 7220 6120 6d61          for a ma
-00011690: 7463 6869 6e67 2073 7472 696e 670a 2020  tching string.  
-000116a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000116b0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-000116c0: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-000116d0: 656c 662e 7042 4442 2e65 7870 732e 696e  elf.pBDB.exps.in
-000116e0: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
-000116f0: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
-00011700: 6578 7031 6d61 7463 6822 2c20 2263 6f6d  exp1match", "com
-00011710: 6d65 6e74 7322 3a20 2222 2c20 2268 6f6d  ments": "", "hom
-00011720: 6570 6167 6522 3a20 2222 2c20 2269 6e73  epage": "", "ins
-00011730: 7069 7265 223a 2022 227d 0a20 2020 2020  pire": ""}.     
-00011740: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00011750: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00011760: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
-00011770: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00011780: 422e 6578 7073 2e69 6e73 6572 7428 0a20  B.exps.insert(. 
-00011790: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-000117a0: 226e 616d 6522 3a20 2265 7870 3222 2c20  "name": "exp2", 
-000117b0: 2263 6f6d 6d65 6e74 7322 3a20 226d 6174  "comments": "mat
-000117c0: 6368 222c 2022 686f 6d65 7061 6765 223a  ch", "homepage":
-000117d0: 2022 222c 2022 696e 7370 6972 6522 3a20   "", "inspire": 
-000117e0: 2222 7d0a 2020 2020 2020 2020 2020 2020  ""}.            
-000117f0: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00011800: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00011810: 7275 6528 0a20 2020 2020 2020 2020 2020  rue(.           
-00011820: 2073 656c 662e 7042 4442 2e65 7870 732e   self.pBDB.exps.
-00011830: 696e 7365 7274 280a 2020 2020 2020 2020  insert(.        
-00011840: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
-00011850: 2022 6578 7033 222c 2022 636f 6d6d 656e   "exp3", "commen
-00011860: 7473 223a 2022 222c 2022 686f 6d65 7061  ts": "", "homepa
-00011870: 6765 223a 2022 6d61 7463 6822 2c20 2269  ge": "match", "i
-00011880: 6e73 7069 7265 223a 2022 227d 0a20 2020  nspire": ""}.   
-00011890: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000118a0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-000118b0: 662e 6173 7365 7274 5472 7565 280a 2020  f.assertTrue(.  
-000118c0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-000118d0: 4244 422e 6578 7073 2e69 6e73 6572 7428  BDB.exps.insert(
-000118e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000118f0: 207b 226e 616d 6522 3a20 2265 7870 3422   {"name": "exp4"
-00011900: 2c20 2263 6f6d 6d65 6e74 7322 3a20 2222  , "comments": ""
-00011910: 2c20 2268 6f6d 6570 6167 6522 3a20 2222  , "homepage": ""
-00011920: 2c20 2269 6e73 7069 7265 223a 2022 6d61  , "inspire": "ma
-00011930: 7463 6822 7d0a 2020 2020 2020 2020 2020  tch"}.          
-00011940: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
-00011950: 2020 2020 2020 7365 6c66 2e63 6865 636b        self.check
-00011960: 4e75 6d62 6572 4578 7065 7269 6d65 6e74  NumberExperiment
-00011970: 7328 3429 0a20 2020 2020 2020 2073 656c  s(4).        sel
-00011980: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00011990: 2020 2020 2020 2020 2020 205b 6469 6374             [dict
-000119a0: 2865 2920 666f 7220 6520 696e 2073 656c  (e) for e in sel
-000119b0: 662e 7042 4442 2e65 7870 732e 6669 6c74  f.pBDB.exps.filt
-000119c0: 6572 416c 6c28 226d 6174 6368 2229 5d2c  erAll("match")],
-000119d0: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-000119e0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-000119f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011a00: 2020 2020 2022 6964 4578 7022 3a20 312c       "idExp": 1,
-00011a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011a20: 2020 2020 2022 6e61 6d65 223a 2022 6578       "name": "ex
-00011a30: 7031 6d61 7463 6822 2c0a 2020 2020 2020  p1match",.      
-00011a40: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00011a50: 6f6d 6d65 6e74 7322 3a20 2222 2c0a 2020  omments": "",.  
-00011a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a70: 2020 2268 6f6d 6570 6167 6522 3a20 2222    "homepage": ""
-00011a80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00011a90: 2020 2020 2020 2269 6e73 7069 7265 223a        "inspire":
-00011aa0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00011ab0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00011ac0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00011ad0: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00011ae0: 6445 7870 223a 2032 2c0a 2020 2020 2020  dExp": 2,.      
-00011af0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-00011b00: 616d 6522 3a20 2265 7870 3222 2c0a 2020  ame": "exp2",.  
-00011b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b20: 2020 2263 6f6d 6d65 6e74 7322 3a20 226d    "comments": "m
-00011b30: 6174 6368 222c 0a20 2020 2020 2020 2020  atch",.         
-00011b40: 2020 2020 2020 2020 2020 2022 686f 6d65             "home
-00011b50: 7061 6765 223a 2022 222c 0a20 2020 2020  page": "",.     
-00011b60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00011b70: 696e 7370 6972 6522 3a20 2222 2c0a 2020  inspire": "",.  
-00011b80: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+0000fcd0: 702e 6765 744f 6e65 2822 7465 7374 222c  p.getOne("test",
+0000fce0: 2031 295b 305d 292c 2028 312c 2022 7465   1)[0]), (1, "te
+0000fcf0: 7374 222c 2031 2929 0a20 2020 2020 2020  st", 1)).       
+0000fd00: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+0000fd10: 2873 656c 662e 7042 4442 2e62 6962 4578  (self.pBDB.bibEx
+0000fd20: 702e 6465 6c65 7465 2822 7465 7374 222c  p.delete("test",
+0000fd30: 2031 2929 0a20 2020 2020 2020 2073 656c   1)).        sel
+0000fd40: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+0000fd50: 6c66 2e70 4244 422e 6269 6245 7870 2e67  lf.pBDB.bibExp.g
+0000fd60: 6574 4f6e 6528 2274 6573 7422 2c20 3129  etOne("test", 1)
+0000fd70: 2c20 5b5d 290a 2020 2020 2020 2020 7365  , []).        se
+0000fd80: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+0000fd90: 656c 662e 7042 4442 2e62 6962 4578 702e  elf.pBDB.bibExp.
+0000fda0: 696e 7365 7274 285b 2274 6573 7431 222c  insert(["test1",
+0000fdb0: 2022 7465 7374 3222 5d2c 2031 292c 204e   "test2"], 1), N
+0000fdc0: 6f6e 6529 0a20 2020 2020 2020 2073 656c  one).        sel
+0000fdd0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0000fde0: 2020 2020 2020 2020 2020 205b 7475 706c             [tupl
+0000fdf0: 6528 6129 2066 6f72 2061 2069 6e20 7365  e(a) for a in se
+0000fe00: 6c66 2e70 4244 422e 6269 6245 7870 2e67  lf.pBDB.bibExp.g
+0000fe10: 6574 416c 6c28 295d 2c0a 2020 2020 2020  etAll()],.      
+0000fe20: 2020 2020 2020 5b28 312c 2022 7465 7374        [(1, "test
+0000fe30: 3122 2c20 3129 2c20 2832 2c20 2274 6573  1", 1), (2, "tes
+0000fe40: 7432 222c 2031 295d 2c0a 2020 2020 2020  t2", 1)],.      
+0000fe50: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+0000fe60: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
+0000fe70: 662e 7042 4442 2e62 6962 4578 702e 6465  f.pBDB.bibExp.de
+0000fe80: 6c65 7465 285b 2274 6573 7431 222c 2022  lete(["test1", "
+0000fe90: 7465 7374 3222 5d2c 2031 292c 204e 6f6e  test2"], 1), Non
+0000fea0: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+0000feb0: 6173 7365 7274 4571 7561 6c28 5b74 7570  assertEqual([tup
+0000fec0: 6c65 2861 2920 666f 7220 6120 696e 2073  le(a) for a in s
+0000fed0: 656c 662e 7042 4442 2e62 6962 4578 702e  elf.pBDB.bibExp.
+0000fee0: 6765 7441 6c6c 2829 5d2c 205b 5d29 0a20  getAll()], []). 
+0000fef0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000ff00: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+0000ff10: 422e 6269 6245 7870 2e69 6e73 6572 7428  B.bibExp.insert(
+0000ff20: 5b22 7465 7374 3122 2c20 2274 6573 7441  ["test1", "testA
+0000ff30: 225d 2c20 5b31 2c20 325d 292c 204e 6f6e  "], [1, 2]), Non
+0000ff40: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+0000ff50: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+0000ff60: 7042 4442 2e62 6962 4578 702e 7570 6461  pBDB.bibExp.upda
+0000ff70: 7465 4269 626b 6579 2822 7465 7374 3222  teBibkey("test2"
+0000ff80: 2c20 2274 6573 7441 2229 290a 2020 2020  , "testA")).    
+0000ff90: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0000ffa0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+0000ffb0: 2020 5b74 7570 6c65 2861 2920 666f 7220    [tuple(a) for 
+0000ffc0: 6120 696e 2073 656c 662e 7042 4442 2e62  a in self.pBDB.b
+0000ffd0: 6962 4578 702e 6765 7441 6c6c 2829 5d2c  ibExp.getAll()],
+0000ffe0: 0a20 2020 2020 2020 2020 2020 205b 2831  .            [(1
+0000fff0: 2c20 2274 6573 7431 222c 2031 292c 2028  , "test1", 1), (
+00010000: 322c 2022 7465 7374 3122 2c20 3229 2c20  2, "test1", 2), 
+00010010: 2833 2c20 2274 6573 7432 222c 2031 292c  (3, "test2", 1),
+00010020: 2028 342c 2022 7465 7374 3222 2c20 3229   (4, "test2", 2)
+00010030: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00010040: 2020 2020 2073 656c 662e 7042 4442 2e75       self.pBDB.u
+00010050: 7469 6c73 2e63 6c65 616e 5370 6172 6545  tils.cleanSpareE
+00010060: 6e74 7269 6573 2829 0a20 2020 2020 2020  ntries().       
+00010070: 2077 6974 6820 7061 7463 6828 2262 7569   with patch("bui
+00010080: 6c74 696e 732e 696e 7075 7422 2c20 7265  ltins.input", re
+00010090: 7475 726e 5f76 616c 7565 3d22 5b31 2c32  turn_value="[1,2
+000100a0: 5d22 2920 6173 205f 696e 7075 743a 0a20  ]") as _input:. 
+000100b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000100c0: 7042 4442 2e62 6962 4578 702e 6173 6b45  pBDB.bibExp.askE
+000100d0: 7870 7328 2274 6573 7431 2229 0a20 2020  xps("test1").   
+000100e0: 2020 2020 2020 2020 205f 696e 7075 742e           _input.
+000100f0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+00010100: 6365 5f77 6974 6828 2265 7870 6572 696d  ce_with("experim
+00010110: 656e 7473 2066 6f72 2027 7465 7374 3127  ents for 'test1'
+00010120: 3a20 2229 0a20 2020 2020 2020 2077 6974  : ").        wit
+00010130: 6820 7061 7463 6828 2262 7569 6c74 696e  h patch("builtin
+00010140: 732e 696e 7075 7422 2c20 7265 7475 726e  s.input", return
+00010150: 5f76 616c 7565 3d22 312c 3222 2920 6173  _value="1,2") as
+00010160: 205f 696e 7075 743a 0a20 2020 2020 2020   _input:.       
+00010170: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00010180: 6962 4578 702e 6173 6b45 7870 7328 2274  ibExp.askExps("t
+00010190: 6573 7431 2229 0a20 2020 2020 2020 2020  est1").         
+000101a0: 2020 205f 696e 7075 742e 6173 7365 7274     _input.assert
+000101b0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+000101c0: 6828 2265 7870 6572 696d 656e 7473 2066  h("experiments f
+000101d0: 6f72 2027 7465 7374 3127 3a20 2229 0a20  or 'test1': "). 
+000101e0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+000101f0: 6828 2262 7569 6c74 696e 732e 696e 7075  h("builtins.inpu
+00010200: 7422 2c20 7265 7475 726e 5f76 616c 7565  t", return_value
+00010210: 3d22 7465 7374 3222 2920 6173 205f 696e  ="test2") as _in
+00010220: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+00010230: 2073 656c 662e 7042 4442 2e62 6962 4578   self.pBDB.bibEx
+00010240: 702e 6173 6b4b 6579 7328 5b31 2c20 325d  p.askKeys([1, 2]
+00010250: 290a 2020 2020 2020 2020 2020 2020 5f69  ).            _i
+00010260: 6e70 7574 2e61 7373 6572 745f 6861 735f  nput.assert_has_
+00010270: 6361 6c6c 7328 0a20 2020 2020 2020 2020  calls(.         
+00010280: 2020 2020 2020 205b 6361 6c6c 2822 656e         [call("en
+00010290: 7472 6965 7320 666f 7220 2731 273a 2022  tries for '1': "
+000102a0: 292c 2063 616c 6c28 2265 6e74 7269 6573  ), call("entries
+000102b0: 2066 6f72 2027 3227 3a20 2229 5d0a 2020   for '2': ")].  
+000102c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000102d0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000102e0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+000102f0: 2020 5b74 7570 6c65 2861 2920 666f 7220    [tuple(a) for 
+00010300: 6120 696e 2073 656c 662e 7042 4442 2e62  a in self.pBDB.b
+00010310: 6962 4578 702e 6765 7441 6c6c 2829 5d2c  ibExp.getAll()],
+00010320: 0a20 2020 2020 2020 2020 2020 205b 2831  .            [(1
+00010330: 2c20 2274 6573 7431 222c 2031 292c 2028  , "test1", 1), (
+00010340: 322c 2022 7465 7374 3122 2c20 3229 2c20  2, "test1", 2), 
+00010350: 2833 2c20 2274 6573 7432 222c 2031 292c  (3, "test2", 1),
+00010360: 2028 342c 2022 7465 7374 3222 2c20 3229   (4, "test2", 2)
+00010370: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00010380: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00010390: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+000103a0: 6269 6245 7870 2e63 6f75 6e74 4279 4578  bibExp.countByEx
+000103b0: 7028 3129 2c20 3229 0a20 2020 2020 2020  p(1), 2).       
+000103c0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+000103d0: 2873 656c 662e 7042 4442 2e62 6962 4578  (self.pBDB.bibEx
+000103e0: 702e 696e 7365 7274 2822 7465 7374 222c  p.insert("test",
+000103f0: 2022 7465 7374 2229 290a 0a0a 4075 6e69   "test"))...@uni
+00010400: 7474 6573 742e 736b 6970 4966 2873 6b69  ttest.skipIf(ski
+00010410: 7054 6573 7473 5365 7474 696e 6773 2e64  pTestsSettings.d
+00010420: 622c 2022 4461 7461 6261 7365 2074 6573  b, "Database tes
+00010430: 7473 2229 0a40 7061 7463 6828 226c 6f67  ts").@patch("log
+00010440: 6769 6e67 2e4c 6f67 6765 722e 6465 6275  ging.Logger.debu
+00010450: 6722 290a 4070 6174 6368 2822 6c6f 6767  g").@patch("logg
+00010460: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
+00010470: 290a 4070 6174 6368 2822 6c6f 6767 696e  ).@patch("loggin
+00010480: 672e 4c6f 6767 6572 2e77 6172 6e69 6e67  g.Logger.warning
+00010490: 2229 0a40 7061 7463 6828 226c 6f67 6769  ").@patch("loggi
+000104a0: 6e67 2e4c 6f67 6765 722e 6578 6365 7074  ng.Logger.except
+000104b0: 696f 6e22 290a 636c 6173 7320 5465 7374  ion").class Test
+000104c0: 4461 7461 6261 7365 4578 7065 7269 6d65  DatabaseExperime
+000104d0: 6e74 7328 4442 5465 7374 4361 7365 293a  nts(DBTestCase):
+000104e0: 0a20 2020 2022 2222 5465 7374 7320 666f  .    """Tests fo
+000104f0: 7220 7468 6520 6d65 7468 6f64 7320 696e  r the methods in
+00010500: 2074 6865 2065 7870 6572 696d 656e 7473   the experiments
+00010510: 2073 7562 636c 6173 7322 2222 0a0a 2020   subclass"""..  
+00010520: 2020 6465 6620 6368 6563 6b4e 756d 6265    def checkNumbe
+00010530: 7245 7870 6572 696d 656e 7473 2873 656c  rExperiments(sel
+00010540: 662c 206e 756d 6265 7229 3a0a 2020 2020  f, number):.    
+00010550: 2020 2020 2222 2243 6865 636b 2074 6865      """Check the
+00010560: 206e 756d 6265 7220 6f66 2065 7870 6572   number of exper
+00010570: 696d 656e 7473 2222 220a 2020 2020 2020  iments""".      
+00010580: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00010590: 616c 2873 656c 662e 7042 4442 2e65 7870  al(self.pBDB.exp
+000105a0: 732e 636f 756e 7428 292c 206e 756d 6265  s.count(), numbe
+000105b0: 7229 0a0a 2020 2020 6465 6620 7465 7374  r)..    def test
+000105c0: 5f69 6e73 6572 7455 7064 6174 6544 656c  _insertUpdateDel
+000105d0: 6574 6528 7365 6c66 2c20 2a61 7267 7329  ete(self, *args)
+000105e0: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+000105f0: 7420 696e 7365 7274 2c20 7570 6461 7465  t insert, update
+00010600: 2c20 7570 6461 7465 4669 656c 642c 2064  , updateField, d
+00010610: 656c 6574 6520 666f 7220 616e 2065 7870  elete for an exp
+00010620: 6572 696d 656e 7422 2222 0a20 2020 2020  eriment""".     
+00010630: 2020 2073 656c 662e 6368 6563 6b4e 756d     self.checkNum
+00010640: 6265 7245 7870 6572 696d 656e 7473 2830  berExperiments(0
+00010650: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00010660: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
+00010670: 7042 4442 2e65 7870 732e 696e 7365 7274  pBDB.exps.insert
+00010680: 287b 226e 616d 6522 3a20 2265 7870 3122  ({"name": "exp1"
+00010690: 7d29 290a 2020 2020 2020 2020 7365 6c66  })).        self
+000106a0: 2e61 7373 6572 7454 7275 6528 0a20 2020  .assertTrue(.   
+000106b0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+000106c0: 4442 2e65 7870 732e 696e 7365 7274 280a  DB.exps.insert(.
+000106d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000106e0: 7b22 6e61 6d65 223a 2022 6578 7031 222c  {"name": "exp1",
+000106f0: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
+00010700: 2022 686f 6d65 7061 6765 223a 2022 222c   "homepage": "",
+00010710: 2022 696e 7370 6972 6522 3a20 2222 7d0a   "inspire": ""}.
+00010720: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00010730: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00010740: 7365 6c66 2e63 6865 636b 4e75 6d62 6572  self.checkNumber
+00010750: 4578 7065 7269 6d65 6e74 7328 3129 0a20  Experiments(1). 
+00010760: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00010770: 7274 5472 7565 280a 2020 2020 2020 2020  rtTrue(.        
+00010780: 2020 2020 7365 6c66 2e70 4244 422e 6578      self.pBDB.ex
+00010790: 7073 2e69 6e73 6572 7428 0a20 2020 2020  ps.insert(.     
+000107a0: 2020 2020 2020 2020 2020 207b 226e 616d             {"nam
+000107b0: 6522 3a20 2265 7870 3122 2c20 2263 6f6d  e": "exp1", "com
+000107c0: 6d65 6e74 7322 3a20 2222 2c20 2268 6f6d  ments": "", "hom
+000107d0: 6570 6167 6522 3a20 2222 2c20 2269 6e73  epage": "", "ins
+000107e0: 7069 7265 223a 2022 227d 0a20 2020 2020  pire": ""}.     
+000107f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00010800: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00010810: 6368 6563 6b4e 756d 6265 7245 7870 6572  checkNumberExper
+00010820: 696d 656e 7473 2832 290a 2020 2020 2020  iments(2).      
+00010830: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00010840: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00010850: 7b65 5b22 6964 4578 7022 5d3a 2065 5b22  {e["idExp"]: e["
+00010860: 6e61 6d65 225d 2066 6f72 2065 2069 6e20  name"] for e in 
+00010870: 7365 6c66 2e70 4244 422e 6578 7073 2e67  self.pBDB.exps.g
+00010880: 6574 416c 6c28 297d 2c0a 2020 2020 2020  etAll()},.      
+00010890: 2020 2020 2020 7b31 3a20 2265 7870 3122        {1: "exp1"
+000108a0: 2c20 323a 2022 6578 7031 227d 2c0a 2020  , 2: "exp1"},.  
+000108b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000108c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+000108d0: 280a 2020 2020 2020 2020 2020 2020 7b65  (.            {e
+000108e0: 5b22 6964 4578 7022 5d3a 2065 5b22 696e  ["idExp"]: e["in
+000108f0: 7370 6972 6522 5d20 666f 7220 6520 696e  spire"] for e in
+00010900: 2073 656c 662e 7042 4442 2e65 7870 732e   self.pBDB.exps.
+00010910: 6765 7441 6c6c 2829 7d2c 207b 313a 2022  getAll()}, {1: "
+00010920: 222c 2032 3a20 2222 7d0a 2020 2020 2020  ", 2: ""}.      
+00010930: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00010940: 2e61 7373 6572 7454 7275 6528 0a20 2020  .assertTrue(.   
+00010950: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00010960: 4442 2e65 7870 732e 7570 6461 7465 280a  DB.exps.update(.
+00010970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010980: 7b22 6e61 6d65 223a 2022 6578 7032 222c  {"name": "exp2",
+00010990: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
+000109a0: 2022 686f 6d65 7061 6765 223a 2022 222c   "homepage": "",
+000109b0: 2022 696e 7370 6972 6522 3a20 2231 3233   "inspire": "123
+000109c0: 227d 2c20 320a 2020 2020 2020 2020 2020  "}, 2.          
+000109d0: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
+000109e0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000109f0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00010a00: 2020 2020 7b65 5b22 6964 4578 7022 5d3a      {e["idExp"]:
+00010a10: 2065 5b22 6e61 6d65 225d 2066 6f72 2065   e["name"] for e
+00010a20: 2069 6e20 7365 6c66 2e70 4244 422e 6578   in self.pBDB.ex
+00010a30: 7073 2e67 6574 416c 6c28 297d 2c0a 2020  ps.getAll()},.  
+00010a40: 2020 2020 2020 2020 2020 7b31 3a20 2265            {1: "e
+00010a50: 7870 3122 2c20 323a 2022 6578 7032 227d  xp1", 2: "exp2"}
+00010a60: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00010a70: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00010a80: 7275 6528 7365 6c66 2e70 4244 422e 6578  rue(self.pBDB.ex
+00010a90: 7073 2e75 7064 6174 6546 6965 6c64 2831  ps.updateField(1
+00010aa0: 2c20 2269 6e73 7069 7265 222c 2022 3435  , "inspire", "45
+00010ab0: 3622 2929 0a20 2020 2020 2020 2073 656c  6")).        sel
+00010ac0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00010ad0: 2020 2020 2020 2020 2020 207b 655b 2269             {e["i
+00010ae0: 6445 7870 225d 3a20 655b 2269 6e73 7069  dExp"]: e["inspi
+00010af0: 7265 225d 2066 6f72 2065 2069 6e20 7365  re"] for e in se
+00010b00: 6c66 2e70 4244 422e 6578 7073 2e67 6574  lf.pBDB.exps.get
+00010b10: 416c 6c28 297d 2c0a 2020 2020 2020 2020  All()},.        
+00010b20: 2020 2020 7b31 3a20 2234 3536 222c 2032      {1: "456", 2
+00010b30: 3a20 2231 3233 227d 2c0a 2020 2020 2020  : "123"},.      
+00010b40: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00010b50: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
+00010b60: 662e 7042 4442 2e65 7870 732e 7570 6461  f.pBDB.exps.upda
+00010b70: 7465 287b 226e 616d 6522 3a20 2265 7870  te({"name": "exp
+00010b80: 3222 2c20 2269 6e73 7069 7265 223a 2022  2", "inspire": "
+00010b90: 3132 3322 7d2c 2032 2929 0a20 2020 2020  123"}, 2)).     
+00010ba0: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
+00010bb0: 6c73 6528 7365 6c66 2e70 4244 422e 6578  lse(self.pBDB.ex
+00010bc0: 7073 2e75 7064 6174 6546 6965 6c64 2831  ps.updateField(1
+00010bd0: 2c20 2269 6e73 7069 7265 7322 2c20 2234  , "inspires", "4
+00010be0: 3536 2229 290a 2020 2020 2020 2020 7365  56")).        se
+00010bf0: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
+00010c00: 656c 662e 7042 4442 2e65 7870 732e 7570  elf.pBDB.exps.up
+00010c10: 6461 7465 4669 656c 6428 312c 2022 6964  dateField(1, "id
+00010c20: 4578 7022 2c20 2232 2229 290a 2020 2020  Exp", "2")).    
+00010c30: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+00010c40: 616c 7365 2873 656c 662e 7042 4442 2e65  alse(self.pBDB.e
+00010c50: 7870 732e 7570 6461 7465 4669 656c 6428  xps.updateField(
+00010c60: 312c 2022 696e 7370 6972 6522 2c20 4e6f  1, "inspire", No
+00010c70: 6e65 2929 0a20 2020 2020 2020 2073 656c  ne)).        sel
+00010c80: 662e 6368 6563 6b4e 756d 6265 7245 7870  f.checkNumberExp
+00010c90: 6572 696d 656e 7473 2832 290a 2020 2020  eriments(2).    
+00010ca0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00010cb0: 7275 6528 7365 6c66 2e70 4244 422e 6361  rue(self.pBDB.ca
+00010cc0: 7445 7870 2e69 6e73 6572 7428 312c 2031  tExp.insert(1, 1
+00010cd0: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+00010ce0: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+00010cf0: 7042 4442 2e62 6962 4578 702e 696e 7365  pBDB.bibExp.inse
+00010d00: 7274 2822 7465 7374 222c 2031 2929 0a20  rt("test", 1)). 
+00010d10: 2020 2020 2020 2064 6253 7461 7473 2873         dbStats(s
+00010d20: 656c 662e 7042 4442 290a 2020 2020 2020  elf.pBDB).      
+00010d30: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00010d40: 616c 2873 656c 662e 7042 4442 2e73 7461  al(self.pBDB.sta
+00010d50: 7473 5b22 6578 7073 225d 2c20 3229 0a20  ts["exps"], 2). 
+00010d60: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00010d70: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+00010d80: 422e 7374 6174 735b 2263 6174 4578 7022  B.stats["catExp"
+00010d90: 5d2c 2031 290a 2020 2020 2020 2020 7365  ], 1).        se
+00010da0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00010db0: 656c 662e 7042 4442 2e73 7461 7473 5b22  elf.pBDB.stats["
+00010dc0: 6269 6245 7870 225d 2c20 3129 0a20 2020  bibExp"], 1).   
+00010dd0: 2020 2020 2073 656c 662e 7042 4442 2e65       self.pBDB.e
+00010de0: 7870 732e 6465 6c65 7465 285b 312c 2032  xps.delete([1, 2
+00010df0: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
+00010e00: 6368 6563 6b4e 756d 6265 7245 7870 6572  checkNumberExper
+00010e10: 696d 656e 7473 2830 290a 2020 2020 2020  iments(0).      
+00010e20: 2020 6462 5374 6174 7328 7365 6c66 2e70    dbStats(self.p
+00010e30: 4244 4229 0a20 2020 2020 2020 2073 656c  BDB).        sel
+00010e40: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00010e50: 6c66 2e70 4244 422e 7374 6174 735b 2263  lf.pBDB.stats["c
+00010e60: 6174 4578 7022 5d2c 2030 290a 2020 2020  atExp"], 0).    
+00010e70: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00010e80: 7175 616c 2873 656c 662e 7042 4442 2e73  qual(self.pBDB.s
+00010e90: 7461 7473 5b22 6269 6245 7870 225d 2c20  tats["bibExp"], 
+00010ea0: 3029 0a0a 2020 2020 6465 6620 7465 7374  0)..    def test
+00010eb0: 5f67 6574 2873 656c 662c 202a 6172 6773  _get(self, *args
+00010ec0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00010ed0: 7374 2067 6574 206d 6574 686f 6473 2222  st get methods""
+00010ee0: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+00010ef0: 7373 6572 7454 7275 6528 0a20 2020 2020  ssertTrue(.     
+00010f00: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00010f10: 2e65 7870 732e 696e 7365 7274 280a 2020  .exps.insert(.  
+00010f20: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+00010f30: 6e61 6d65 223a 2022 6578 7031 222c 2022  name": "exp1", "
+00010f40: 636f 6d6d 656e 7473 223a 2022 222c 2022  comments": "", "
+00010f50: 686f 6d65 7061 6765 223a 2022 222c 2022  homepage": "", "
+00010f60: 696e 7370 6972 6522 3a20 2222 7d0a 2020  inspire": ""}.  
+00010f70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00010f80: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00010f90: 6c66 2e61 7373 6572 7454 7275 6528 0a20  lf.assertTrue(. 
+00010fa0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00010fb0: 7042 4442 2e65 7870 732e 696e 7365 7274  pBDB.exps.insert
+00010fc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00010fd0: 2020 7b22 6e61 6d65 223a 2022 6578 7032    {"name": "exp2
+00010fe0: 222c 2022 636f 6d6d 656e 7473 223a 2022  ", "comments": "
+00010ff0: 222c 2022 686f 6d65 7061 6765 223a 2022  ", "homepage": "
+00011000: 222c 2022 696e 7370 6972 6522 3a20 2222  ", "inspire": ""
+00011010: 7d0a 2020 2020 2020 2020 2020 2020 290a  }.            ).
+00011020: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00011030: 2020 7365 6c66 2e63 6865 636b 4e75 6d62    self.checkNumb
+00011040: 6572 4578 7065 7269 6d65 6e74 7328 3229  erExperiments(2)
+00011050: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00011060: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00011070: 2020 2020 2020 205b 6469 6374 2865 2920         [dict(e) 
+00011080: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+00011090: 4442 2e65 7870 732e 6765 7441 6c6c 2829  DB.exps.getAll()
+000110a0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+000110b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000110c0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000110d0: 2020 2020 2020 2022 6964 4578 7022 3a20         "idExp": 
+000110e0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+000110f0: 2020 2020 2020 2022 6e61 6d65 223a 2022         "name": "
+00011100: 6578 7031 222c 0a20 2020 2020 2020 2020  exp1",.         
+00011110: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
+00011120: 656e 7473 223a 2022 222c 0a20 2020 2020  ents": "",.     
+00011130: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00011140: 686f 6d65 7061 6765 223a 2022 222c 0a20  homepage": "",. 
+00011150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011160: 2020 2022 696e 7370 6972 6522 3a20 2222     "inspire": ""
+00011170: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011180: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+00011190: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+000111a0: 2020 2020 2020 2020 2020 2022 6964 4578             "idEx
+000111b0: 7022 3a20 322c 0a20 2020 2020 2020 2020  p": 2,.         
+000111c0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+000111d0: 223a 2022 6578 7032 222c 0a20 2020 2020  ": "exp2",.     
+000111e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000111f0: 636f 6d6d 656e 7473 223a 2022 222c 0a20  comments": "",. 
+00011200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011210: 2020 2022 686f 6d65 7061 6765 223a 2022     "homepage": "
+00011220: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00011230: 2020 2020 2020 2022 696e 7370 6972 6522         "inspire"
+00011240: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00011250: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00011260: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00011270: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00011280: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00011290: 2020 2020 2020 2020 5b64 6963 7428 6529          [dict(e)
+000112a0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+000112b0: 4244 422e 6578 7073 2e67 6574 4279 4944  BDB.exps.getByID
+000112c0: 2831 295d 2c0a 2020 2020 2020 2020 2020  (1)],.          
+000112d0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+000112e0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+000112f0: 2020 2020 2020 2020 2020 2269 6445 7870            "idExp
+00011300: 223a 2031 2c0a 2020 2020 2020 2020 2020  ": 1,.          
+00011310: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00011320: 3a20 2265 7870 3122 2c0a 2020 2020 2020  : "exp1",.      
+00011330: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00011340: 6f6d 6d65 6e74 7322 3a20 2222 2c0a 2020  omments": "",.  
+00011350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011360: 2020 2268 6f6d 6570 6167 6522 3a20 2222    "homepage": ""
+00011370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011380: 2020 2020 2020 2269 6e73 7069 7265 223a        "inspire":
+00011390: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+000113a0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+000113b0: 2020 205d 2c0a 2020 2020 2020 2020 290a     ],.        ).
+000113c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000113d0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+000113e0: 2020 2020 2020 5b64 6963 7428 6529 2066        [dict(e) f
+000113f0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+00011400: 422e 6578 7073 2e67 6574 4279 4e61 6d65  B.exps.getByName
+00011410: 2822 6578 7032 2229 5d2c 0a20 2020 2020  ("exp2")],.     
+00011420: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00011430: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00011440: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00011450: 6964 4578 7022 3a20 322c 0a20 2020 2020  idExp": 2,.     
+00011460: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00011470: 6e61 6d65 223a 2022 6578 7032 222c 0a20  name": "exp2",. 
+00011480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011490: 2020 2022 636f 6d6d 656e 7473 223a 2022     "comments": "
+000114a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000114b0: 2020 2020 2020 2022 686f 6d65 7061 6765         "homepage
+000114c0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+000114d0: 2020 2020 2020 2020 2020 2022 696e 7370             "insp
+000114e0: 6972 6522 3a20 2222 2c0a 2020 2020 2020  ire": "",.      
+000114f0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00011500: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+00011510: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00011520: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00011530: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011540: 7042 4442 2e65 7870 732e 6765 7444 6963  pBDB.exps.getDic
+00011550: 7442 7949 4428 3129 2c0a 2020 2020 2020  tByID(1),.      
+00011560: 2020 2020 2020 7b22 6964 4578 7022 3a20        {"idExp": 
+00011570: 312c 2022 6e61 6d65 223a 2022 6578 7031  1, "name": "exp1
+00011580: 222c 2022 636f 6d6d 656e 7473 223a 2022  ", "comments": "
+00011590: 222c 2022 686f 6d65 7061 6765 223a 2022  ", "homepage": "
+000115a0: 222c 2022 696e 7370 6972 6522 3a20 2222  ", "inspire": ""
+000115b0: 7d2c 0a20 2020 2020 2020 2029 0a0a 2020  },.        )..  
+000115c0: 2020 6465 6620 7465 7374 5f66 696c 7465    def test_filte
+000115d0: 7241 6c6c 2873 656c 662c 202a 6172 6773  rAll(self, *args
+000115e0: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
+000115f0: 7374 2074 6865 2066 696c 7465 7241 6c6c  st the filterAll
+00011600: 2066 756e 6374 696f 6e2c 2074 6861 7420   function, that 
+00011610: 6c6f 6f6b 7320 696e 746f 2061 6c6c 2074  looks into all t
+00011620: 6865 2066 6965 6c64 730a 2020 2020 2020  he fields.      
+00011630: 2020 666f 7220 6120 6d61 7463 6869 6e67    for a matching
+00011640: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
+00011650: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+00011660: 2e61 7373 6572 7454 7275 6528 0a20 2020  .assertTrue(.   
+00011670: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00011680: 4442 2e65 7870 732e 696e 7365 7274 280a  DB.exps.insert(.
+00011690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000116a0: 7b22 6e61 6d65 223a 2022 6578 7031 6d61  {"name": "exp1ma
+000116b0: 7463 6822 2c20 2263 6f6d 6d65 6e74 7322  tch", "comments"
+000116c0: 3a20 2222 2c20 2268 6f6d 6570 6167 6522  : "", "homepage"
+000116d0: 3a20 2222 2c20 2269 6e73 7069 7265 223a  : "", "inspire":
+000116e0: 2022 227d 0a20 2020 2020 2020 2020 2020   ""}.           
+000116f0: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
+00011700: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00011710: 5472 7565 280a 2020 2020 2020 2020 2020  True(.          
+00011720: 2020 7365 6c66 2e70 4244 422e 6578 7073    self.pBDB.exps
+00011730: 2e69 6e73 6572 7428 0a20 2020 2020 2020  .insert(.       
+00011740: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
+00011750: 3a20 2265 7870 3222 2c20 2263 6f6d 6d65  : "exp2", "comme
+00011760: 6e74 7322 3a20 226d 6174 6368 222c 2022  nts": "match", "
+00011770: 686f 6d65 7061 6765 223a 2022 222c 2022  homepage": "", "
+00011780: 696e 7370 6972 6522 3a20 2222 7d0a 2020  inspire": ""}.  
+00011790: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000117a0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+000117b0: 6c66 2e61 7373 6572 7454 7275 6528 0a20  lf.assertTrue(. 
+000117c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000117d0: 7042 4442 2e65 7870 732e 696e 7365 7274  pBDB.exps.insert
+000117e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000117f0: 2020 7b22 6e61 6d65 223a 2022 6578 7033    {"name": "exp3
+00011800: 222c 2022 636f 6d6d 656e 7473 223a 2022  ", "comments": "
+00011810: 222c 2022 686f 6d65 7061 6765 223a 2022  ", "homepage": "
+00011820: 6d61 7463 6822 2c20 2269 6e73 7069 7265  match", "inspire
+00011830: 223a 2022 227d 0a20 2020 2020 2020 2020  ": ""}.         
+00011840: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
+00011850: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00011860: 7274 5472 7565 280a 2020 2020 2020 2020  rtTrue(.        
+00011870: 2020 2020 7365 6c66 2e70 4244 422e 6578      self.pBDB.ex
+00011880: 7073 2e69 6e73 6572 7428 0a20 2020 2020  ps.insert(.     
+00011890: 2020 2020 2020 2020 2020 207b 226e 616d             {"nam
+000118a0: 6522 3a20 2265 7870 3422 2c20 2263 6f6d  e": "exp4", "com
+000118b0: 6d65 6e74 7322 3a20 2222 2c20 2268 6f6d  ments": "", "hom
+000118c0: 6570 6167 6522 3a20 2222 2c20 2269 6e73  epage": "", "ins
+000118d0: 7069 7265 223a 2022 6d61 7463 6822 7d0a  pire": "match"}.
+000118e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000118f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00011900: 7365 6c66 2e63 6865 636b 4e75 6d62 6572  self.checkNumber
+00011910: 4578 7065 7269 6d65 6e74 7328 3429 0a20  Experiments(4). 
+00011920: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00011930: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00011940: 2020 2020 205b 6469 6374 2865 2920 666f       [dict(e) fo
+00011950: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00011960: 2e65 7870 732e 6669 6c74 6572 416c 6c28  .exps.filterAll(
+00011970: 226d 6174 6368 2229 5d2c 0a20 2020 2020  "match")],.     
+00011980: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00011990: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+000119a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000119b0: 6964 4578 7022 3a20 312c 0a20 2020 2020  idExp": 1,.     
+000119c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000119d0: 6e61 6d65 223a 2022 6578 7031 6d61 7463  name": "exp1matc
+000119e0: 6822 2c0a 2020 2020 2020 2020 2020 2020  h",.            
+000119f0: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
+00011a00: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
+00011a10: 2020 2020 2020 2020 2020 2020 2268 6f6d              "hom
+00011a20: 6570 6167 6522 3a20 2222 2c0a 2020 2020  epage": "",.    
+00011a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a40: 2269 6e73 7069 7265 223a 2022 222c 0a20  "inspire": "",. 
+00011a50: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00011a60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011a70: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00011a80: 2020 2020 2020 2020 2269 6445 7870 223a          "idExp":
+00011a90: 2032 2c0a 2020 2020 2020 2020 2020 2020   2,.            
+00011aa0: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
+00011ab0: 2265 7870 3222 2c0a 2020 2020 2020 2020  "exp2",.        
+00011ac0: 2020 2020 2020 2020 2020 2020 2263 6f6d              "com
+00011ad0: 6d65 6e74 7322 3a20 226d 6174 6368 222c  ments": "match",
+00011ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011af0: 2020 2020 2022 686f 6d65 7061 6765 223a       "homepage":
+00011b00: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00011b10: 2020 2020 2020 2020 2022 696e 7370 6972           "inspir
+00011b20: 6522 3a20 2222 2c0a 2020 2020 2020 2020  e": "",.        
+00011b30: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00011b40: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00011b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b60: 2022 6964 4578 7022 3a20 332c 0a20 2020   "idExp": 3,.   
+00011b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b80: 2022 6e61 6d65 223a 2022 6578 7033 222c   "name": "exp3",
 00011b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011ba0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00011bb0: 2020 2020 2020 2022 6964 4578 7022 3a20         "idExp": 
-00011bc0: 332c 0a20 2020 2020 2020 2020 2020 2020  3,.             
-00011bd0: 2020 2020 2020 2022 6e61 6d65 223a 2022         "name": "
-00011be0: 6578 7033 222c 0a20 2020 2020 2020 2020  exp3",.         
-00011bf0: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
-00011c00: 656e 7473 223a 2022 222c 0a20 2020 2020  ents": "",.     
-00011c10: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00011c20: 686f 6d65 7061 6765 223a 2022 6d61 7463  homepage": "matc
-00011c30: 6822 2c0a 2020 2020 2020 2020 2020 2020  h",.            
-00011c40: 2020 2020 2020 2020 2269 6e73 7069 7265          "inspire
-00011c50: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-00011c60: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00011c70: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00011c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c90: 2269 6445 7870 223a 2034 2c0a 2020 2020  "idExp": 4,.    
-00011ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011cb0: 226e 616d 6522 3a20 2265 7870 3422 2c0a  "name": "exp4",.
-00011cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011cd0: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
-00011ce0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-00011cf0: 2020 2020 2020 2020 2268 6f6d 6570 6167          "homepag
-00011d00: 6522 3a20 2222 2c0a 2020 2020 2020 2020  e": "",.        
-00011d10: 2020 2020 2020 2020 2020 2020 2269 6e73              "ins
-00011d20: 7069 7265 223a 2022 6d61 7463 6822 2c0a  pire": "match",.
-00011d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d40: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-00011d50: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00011d60: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00011d70: 7175 616c 286c 656e 2873 656c 662e 7042  qual(len(self.pB
-00011d80: 4442 2e65 7870 732e 6669 6c74 6572 416c  DB.exps.filterAl
-00011d90: 6c28 226e 6f6e 6d61 7463 6822 2929 2c20  l("nonmatch")), 
-00011da0: 3029 0a0a 2020 2020 6465 6620 7465 7374  0)..    def test
-00011db0: 5f70 7269 6e74 2873 656c 662c 202a 6172  _print(self, *ar
-00011dc0: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00011dd0: 5465 7374 2074 6f5f 7374 722c 2070 7269  Test to_str, pri
-00011de0: 6e74 416c 6c20 616e 6420 7072 696e 7449  ntAll and printI
-00011df0: 6e43 6174 7322 2222 0a20 2020 2020 2020  nCats""".       
-00011e00: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00011e10: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00011e20: 6c66 2e70 4244 422e 6578 7073 2e69 6e73  lf.pBDB.exps.ins
-00011e30: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
-00011e40: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00011e50: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
-00011e60: 223a 2022 6578 7031 222c 0a20 2020 2020  ": "exp1",.     
-00011e70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00011e80: 636f 6d6d 656e 7473 223a 2022 636f 6d6d  comments": "comm
-00011e90: 656e 7422 2c0a 2020 2020 2020 2020 2020  ent",.          
-00011ea0: 2020 2020 2020 2020 2020 2268 6f6d 6570            "homep
-00011eb0: 6167 6522 3a20 2268 7474 703a 2f2f 736f  age": "http://so
-00011ec0: 6d65 2e75 726c 2e6f 7267 2f22 2c0a 2020  me.url.org/",.  
-00011ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ee0: 2020 2269 6e73 7069 7265 223a 2022 3132    "inspire": "12
-00011ef0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00011f00: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-00011f10: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
-00011f20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00011f30: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00011f40: 2020 2073 656c 662e 7042 4442 2e65 7870     self.pBDB.exp
-00011f50: 732e 746f 5f73 7472 2873 656c 662e 7042  s.to_str(self.pB
-00011f60: 4442 2e65 7870 732e 6765 7442 7949 4428  DB.exps.getByID(
-00011f70: 3129 5b30 5d29 2c0a 2020 2020 2020 2020  1)[0]),.        
-00011f80: 2020 2020 2220 2031 3a20 6578 7031 2020      "  1: exp1  
-00011f90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00011fa0: 0a20 2020 2020 2020 2020 2020 202b 2022  .            + "
-00011fb0: 5b68 7474 703a 2f2f 736f 6d65 2e75 726c  [http://some.url
-00011fc0: 2e6f 7267 2f20 2020 2020 2020 2020 2020  .org/           
-00011fd0: 2020 2020 2020 2020 205d 205b 3132 5d22           ] [12]"
-00011fe0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00011ff0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00012000: 7275 6528 0a20 2020 2020 2020 2020 2020  rue(.           
-00012010: 2073 656c 662e 7042 4442 2e65 7870 732e   self.pBDB.exps.
-00012020: 696e 7365 7274 280a 2020 2020 2020 2020  insert(.        
-00012030: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
-00012040: 2022 6578 7032 222c 2022 636f 6d6d 656e   "exp2", "commen
-00012050: 7473 223a 2022 222c 2022 686f 6d65 7061  ts": "", "homepa
-00012060: 6765 223a 2022 222c 2022 696e 7370 6972  ge": "", "inspir
-00012070: 6522 3a20 2222 7d0a 2020 2020 2020 2020  e": ""}.        
-00012080: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
-00012090: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000120a0: 6572 745f 7374 646f 7574 280a 2020 2020  ert_stdout(.    
-000120b0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-000120c0: 422e 6578 7073 2e70 7269 6e74 416c 6c2c  B.exps.printAll,
-000120d0: 0a20 2020 2020 2020 2020 2020 2022 2020  .            "  
-000120e0: 313a 2065 7870 3120 2020 2020 2020 2020  1: exp1         
-000120f0: 2020 2020 2020 2020 220a 2020 2020 2020          ".      
-00012100: 2020 2020 2020 2b20 225b 6874 7470 3a2f        + "[http:/
-00012110: 2f73 6f6d 652e 7572 6c2e 6f72 672f 2020  /some.url.org/  
-00012120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012130: 2020 5d20 5b31 325d 5c6e 2020 220a 2020    ] [12]\n  ".  
-00012140: 2020 2020 2020 2020 2020 2b20 2232 3a20            + "2: 
-00012150: 6578 7032 2020 2020 2020 2020 2020 2020  exp2            
-00012160: 2020 2020 2022 0a20 2020 2020 2020 2020       ".         
-00012170: 2020 202b 2022 5b20 2020 2020 2020 2020     + "[         
-00012180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012190: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-000121a0: 205b 5d5c 6e22 2c0a 2020 2020 2020 2020   []\n",.        
-000121b0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000121c0: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-000121d0: 4244 422e 6361 7445 7870 2e69 6e73 6572  BDB.catExp.inser
-000121e0: 7428 302c 2031 2929 0a20 2020 2020 2020  t(0, 1)).       
-000121f0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00012200: 2873 656c 662e 7042 4442 2e63 6174 4578  (self.pBDB.catEx
-00012210: 702e 696e 7365 7274 2831 2c20 3229 290a  p.insert(1, 2)).
-00012220: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00012230: 6572 745f 7374 646f 7574 280a 2020 2020  ert_stdout(.    
-00012240: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00012250: 422e 6578 7073 2e70 7269 6e74 496e 4361  B.exps.printInCa
-00012260: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-00012270: 2220 2020 303a 204d 6169 6e5c 6e20 2020  "   0: Main\n   
-00012280: 2020 2020 2020 202d 3e20 6578 7031 2028         -> exp1 (
-00012290: 3129 5c6e 2020 2020 2020 2020 313a 2022  1)\n        1: "
-000122a0: 0a20 2020 2020 2020 2020 2020 202b 2022  .            + "
-000122b0: 5461 6773 5c6e 2020 2020 2020 2020 2020  Tags\n          
-000122c0: 2020 2020 202d 3e20 6578 7032 2028 3229       -> exp2 (2)
-000122d0: 5c6e 222c 0a20 2020 2020 2020 2029 0a0a  \n",.        )..
-000122e0: 2020 2020 6465 6620 7465 7374 5f67 6574      def test_get
-000122f0: 4279 4f74 6865 7273 2873 656c 662c 202a  ByOthers(self, *
-00012300: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00012310: 2222 5465 7374 2067 6574 4279 4361 7420  ""Test getByCat 
-00012320: 616e 6420 6765 7442 7945 6e74 7279 2063  and getByEntry c
-00012330: 7265 6174 696e 6720 736f 6d65 2066 616b  reating some fak
-00012340: 6520 7265 636f 7264 7322 2222 0a20 2020  e records""".   
-00012350: 2020 2020 2064 6174 6120 3d20 7365 6c66       data = self
-00012360: 2e70 4244 422e 6269 6273 2e70 7265 7061  .pBDB.bibs.prepa
-00012370: 7265 496e 7365 7274 280a 2020 2020 2020  reInsert(.      
-00012380: 2020 2020 2020 275c 6e5c 6e25 636f 6d6d        '\n\n%comm
-00012390: 656e 745c 6e40 6172 7469 636c 657b 6162  ent\n@article{ab
-000123a0: 632c 5c6e 6175 7468 6f72 203d 2022 6d65  c,\nauthor = "me
-000123b0: 222c 2720 2b20 275c 6e74 6974 6c65 203d  ",' + '\ntitle =
-000123c0: 2022 7469 746c 6522 2c7d 272c 0a20 2020   "title",}',.   
-000123d0: 2020 2020 2020 2020 2062 6962 6b65 793d           bibkey=
-000123e0: 2261 6263 222c 0a20 2020 2020 2020 2029  "abc",.        )
-000123f0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00012400: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
-00012410: 7265 7061 7265 496e 7365 7274 280a 2020  repareInsert(.  
-00012420: 2020 2020 2020 2020 2020 275c 6e5c 6e25            '\n\n%
-00012430: 636f 6d6d 656e 745c 6e40 6172 7469 636c  comment\n@articl
-00012440: 657b 6465 6667 6869 2c5c 6e61 7574 686f  e{defghi,\nautho
-00012450: 7220 3d20 226d 6522 2c5c 6e27 202b 2027  r = "me",\n' + '
-00012460: 7469 746c 6520 3d20 2274 6974 6c65 222c  title = "title",
-00012470: 7d27 2c0a 2020 2020 2020 2020 2020 2020  }',.            
-00012480: 6269 626b 6579 3d22 6465 6667 6869 222c  bibkey="defghi",
-00012490: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000124a0: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-000124b0: 7565 2873 656c 662e 7042 4442 2e62 6962  ue(self.pBDB.bib
-000124c0: 732e 696e 7365 7274 2864 6174 6129 290a  s.insert(data)).
-000124d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000124e0: 6572 7454 7275 6528 0a20 2020 2020 2020  ertTrue(.       
-000124f0: 2020 2020 2073 656c 662e 7042 4442 2e65       self.pBDB.e
-00012500: 7870 732e 696e 7365 7274 280a 2020 2020  xps.insert(.    
-00012510: 2020 2020 2020 2020 2020 2020 7b22 6e61              {"na
-00012520: 6d65 223a 2022 6578 7031 222c 2022 636f  me": "exp1", "co
-00012530: 6d6d 656e 7473 223a 2022 222c 2022 686f  mments": "", "ho
-00012540: 6d65 7061 6765 223a 2022 222c 2022 696e  mepage": "", "in
-00012550: 7370 6972 6522 3a20 2222 7d0a 2020 2020  spire": ""}.    
-00012560: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00012570: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00012580: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
-00012590: 2e70 4244 422e 6361 7445 7870 2e69 6e73  .pBDB.catExp.ins
-000125a0: 6572 7428 302c 2031 2929 0a20 2020 2020  ert(0, 1)).     
-000125b0: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-000125c0: 7565 2873 656c 662e 7042 4442 2e62 6962  ue(self.pBDB.bib
-000125d0: 4578 702e 696e 7365 7274 2822 6162 6322  Exp.insert("abc"
-000125e0: 2c20 3129 290a 2020 2020 2020 2020 7365  , 1)).        se
-000125f0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-00012600: 656c 662e 7042 4442 2e65 7870 732e 6765  elf.pBDB.exps.ge
-00012610: 7442 7945 6e74 7279 2822 6465 6622 292c  tByEntry("def"),
-00012620: 205b 5d29 0a20 2020 2020 2020 2073 656c   []).        sel
-00012630: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00012640: 2020 2020 2020 2020 2020 205b 6469 6374             [dict
-00012650: 2865 2920 666f 7220 6520 696e 2073 656c  (e) for e in sel
-00012660: 662e 7042 4442 2e65 7870 732e 6765 7442  f.pBDB.exps.getB
-00012670: 7945 6e74 7279 2822 6162 6322 295d 2c0a  yEntry("abc")],.
-00012680: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00012690: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-000126a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000126b0: 2020 2020 2269 6e73 7069 7265 223a 2022      "inspire": "
-000126c0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000126d0: 2020 2020 2020 2022 636f 6d6d 656e 7473         "comments
-000126e0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-000126f0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
-00012700: 223a 2022 6578 7031 222c 0a20 2020 2020  ": "exp1",.     
-00012710: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00012720: 6269 626b 6579 223a 2022 6162 6322 2c0a  bibkey": "abc",.
-00012730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012740: 2020 2020 2269 6445 6e45 7822 3a20 312c      "idEnEx": 1,
-00012750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012760: 2020 2020 2022 686f 6d65 7061 6765 223a       "homepage":
-00012770: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00012780: 2020 2020 2020 2020 2022 6964 4578 7022           "idExp"
-00012790: 3a20 312c 0a20 2020 2020 2020 2020 2020  : 1,.           
-000127a0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-000127b0: 2020 205d 2c0a 2020 2020 2020 2020 290a     ],.        ).
-000127c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000127d0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-000127e0: 2020 2020 2020 5b64 6963 7428 6529 2066        [dict(e) f
-000127f0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-00012800: 422e 6578 7073 2e67 6574 4279 456e 7472  B.exps.getByEntr
-00012810: 6965 7328 5b22 6162 6322 2c20 2264 6566  ies(["abc", "def
-00012820: 6768 6922 5d29 5d2c 0a20 2020 2020 2020  ghi"])],.       
-00012830: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00012840: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00012850: 2020 2020 2020 2020 2020 2020 2022 696e               "in
-00012860: 7370 6972 6522 3a20 2222 2c0a 2020 2020  spire": "",.    
-00012870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012880: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
-00012890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000128a0: 2020 2020 226e 616d 6522 3a20 2265 7870      "name": "exp
-000128b0: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-000128c0: 2020 2020 2020 2020 2262 6962 6b65 7922          "bibkey"
-000128d0: 3a20 2261 6263 222c 0a20 2020 2020 2020  : "abc",.       
-000128e0: 2020 2020 2020 2020 2020 2020 2022 6964               "id
-000128f0: 456e 4578 223a 2031 2c0a 2020 2020 2020  EnEx": 1,.      
-00012900: 2020 2020 2020 2020 2020 2020 2020 2268                "h
-00012910: 6f6d 6570 6167 6522 3a20 2222 2c0a 2020  omepage": "",.  
-00012920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012930: 2020 2269 6445 7870 223a 2031 2c0a 2020    "idExp": 1,.  
-00012940: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-00012950: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-00012960: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00012970: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00012980: 6c28 7365 6c66 2e70 4244 422e 6578 7073  l(self.pBDB.exps
-00012990: 2e67 6574 4279 4361 7428 2231 2229 2c20  .getByCat("1"), 
-000129a0: 5b5d 290a 2020 2020 2020 2020 7365 6c66  []).        self
-000129b0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-000129c0: 2020 2020 2020 2020 2020 5b64 6963 7428            [dict(
-000129d0: 6529 2066 6f72 2065 2069 6e20 7365 6c66  e) for e in self
-000129e0: 2e70 4244 422e 6578 7073 2e67 6574 4279  .pBDB.exps.getBy
-000129f0: 4361 7428 3029 5d2c 0a20 2020 2020 2020  Cat(0)],.       
-00012a00: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00012a10: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00012a20: 2020 2020 2020 2020 2020 2020 2022 6964               "id
-00012a30: 4361 7422 3a20 302c 0a20 2020 2020 2020  Cat": 0,.       
-00012a40: 2020 2020 2020 2020 2020 2020 2022 696e               "in
-00012a50: 7370 6972 6522 3a20 2222 2c0a 2020 2020  spire": "",.    
-00012a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a70: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
-00012a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a90: 2020 2020 226e 616d 6522 3a20 2265 7870      "name": "exp
-00012aa0: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-00012ab0: 2020 2020 2020 2020 2269 6445 7843 223a          "idExC":
-00012ac0: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
-00012ad0: 2020 2020 2020 2020 2268 6f6d 6570 6167          "homepag
-00012ae0: 6522 3a20 2222 2c0a 2020 2020 2020 2020  e": "",.        
-00012af0: 2020 2020 2020 2020 2020 2020 2269 6445              "idE
-00012b00: 7870 223a 2031 2c0a 2020 2020 2020 2020  xp": 1,.        
-00012b10: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00012b20: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00012b30: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00012b40: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
-00012b50: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00012b60: 422e 6578 7073 2e69 6e73 6572 7428 0a20  B.exps.insert(. 
-00012b70: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00012b80: 226e 616d 6522 3a20 2265 7870 3222 2c20  "name": "exp2", 
-00012b90: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c20  "comments": "", 
-00012ba0: 2268 6f6d 6570 6167 6522 3a20 2222 2c20  "homepage": "", 
-00012bb0: 2269 6e73 7069 7265 223a 2022 227d 0a20  "inspire": ""}. 
-00012bc0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00012bd0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00012be0: 656c 662e 6173 7365 7274 5472 7565 2873  elf.assertTrue(s
-00012bf0: 656c 662e 7042 4442 2e62 6962 4578 702e  elf.pBDB.bibExp.
-00012c00: 696e 7365 7274 2822 6465 6667 6869 222c  insert("defghi",
-00012c10: 2032 2929 0a20 2020 2020 2020 2073 656c   2)).        sel
-00012c20: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00012c30: 2020 2020 2020 2020 2020 205b 6469 6374             [dict
-00012c40: 2865 2920 666f 7220 6520 696e 2073 656c  (e) for e in sel
-00012c50: 662e 7042 4442 2e65 7870 732e 6765 7442  f.pBDB.exps.getB
-00012c60: 7945 6e74 7269 6573 285b 2261 6263 222c  yEntries(["abc",
-00012c70: 2022 6465 6667 6869 225d 295d 2c0a 2020   "defghi"])],.  
-00012c80: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00012c90: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00012ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012cb0: 2020 2269 6e73 7069 7265 223a 2022 222c    "inspire": "",
-00012cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012cd0: 2020 2020 2022 636f 6d6d 656e 7473 223a       "comments":
-00012ce0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00012cf0: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
-00012d00: 2022 6578 7031 222c 0a20 2020 2020 2020   "exp1",.       
-00012d10: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
-00012d20: 626b 6579 223a 2022 6162 6322 2c0a 2020  bkey": "abc",.  
-00012d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d40: 2020 2269 6445 6e45 7822 3a20 312c 0a20    "idEnEx": 1,. 
+00011ba0: 2020 2020 2022 636f 6d6d 656e 7473 223a       "comments":
+00011bb0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00011bc0: 2020 2020 2020 2020 2022 686f 6d65 7061           "homepa
+00011bd0: 6765 223a 2022 6d61 7463 6822 2c0a 2020  ge": "match",.  
+00011be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011bf0: 2020 2269 6e73 7069 7265 223a 2022 222c    "inspire": "",
+00011c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011c10: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00011c20: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00011c30: 2020 2020 2020 2020 2020 2269 6445 7870            "idExp
+00011c40: 223a 2034 2c0a 2020 2020 2020 2020 2020  ": 4,.          
+00011c50: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00011c60: 3a20 2265 7870 3422 2c0a 2020 2020 2020  : "exp4",.      
+00011c70: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00011c80: 6f6d 6d65 6e74 7322 3a20 2222 2c0a 2020  omments": "",.  
+00011c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ca0: 2020 2268 6f6d 6570 6167 6522 3a20 2222    "homepage": ""
+00011cb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011cc0: 2020 2020 2020 2269 6e73 7069 7265 223a        "inspire":
+00011cd0: 2022 6d61 7463 6822 2c0a 2020 2020 2020   "match",.      
+00011ce0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00011cf0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00011d00: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00011d10: 6c66 2e61 7373 6572 7445 7175 616c 286c  lf.assertEqual(l
+00011d20: 656e 2873 656c 662e 7042 4442 2e65 7870  en(self.pBDB.exp
+00011d30: 732e 6669 6c74 6572 416c 6c28 226e 6f6e  s.filterAll("non
+00011d40: 6d61 7463 6822 2929 2c20 3029 0a0a 2020  match")), 0)..  
+00011d50: 2020 6465 6620 7465 7374 5f70 7269 6e74    def test_print
+00011d60: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
+00011d70: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+00011d80: 6f5f 7374 722c 2070 7269 6e74 416c 6c20  o_str, printAll 
+00011d90: 616e 6420 7072 696e 7449 6e43 6174 7322  and printInCats"
+00011da0: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+00011db0: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
+00011dc0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00011dd0: 422e 6578 7073 2e69 6e73 6572 7428 0a20  B.exps.insert(. 
+00011de0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00011df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011e00: 2020 2020 2022 6e61 6d65 223a 2022 6578       "name": "ex
+00011e10: 7031 222c 0a20 2020 2020 2020 2020 2020  p1",.           
+00011e20: 2020 2020 2020 2020 2022 636f 6d6d 656e           "commen
+00011e30: 7473 223a 2022 636f 6d6d 656e 7422 2c0a  ts": "comment",.
+00011e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e50: 2020 2020 2268 6f6d 6570 6167 6522 3a20      "homepage": 
+00011e60: 2268 7474 703a 2f2f 736f 6d65 2e75 726c  "http://some.url
+00011e70: 2e6f 7267 2f22 2c0a 2020 2020 2020 2020  .org/",.        
+00011e80: 2020 2020 2020 2020 2020 2020 2269 6e73              "ins
+00011e90: 7069 7265 223a 2022 3132 222c 0a20 2020  pire": "12",.   
+00011ea0: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+00011eb0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00011ec0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00011ed0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00011ee0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011ef0: 662e 7042 4442 2e65 7870 732e 746f 5f73  f.pBDB.exps.to_s
+00011f00: 7472 2873 656c 662e 7042 4442 2e65 7870  tr(self.pBDB.exp
+00011f10: 732e 6765 7442 7949 4428 3129 5b30 5d29  s.getByID(1)[0])
+00011f20: 2c0a 2020 2020 2020 2020 2020 2020 2220  ,.            " 
+00011f30: 2031 3a20 6578 7031 2020 2020 2020 2020   1: exp1        
+00011f40: 2020 2020 2020 2020 2022 0a20 2020 2020           ".     
+00011f50: 2020 2020 2020 202b 2022 5b68 7474 703a         + "[http:
+00011f60: 2f2f 736f 6d65 2e75 726c 2e6f 7267 2f20  //some.url.org/ 
+00011f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f80: 2020 205d 205b 3132 5d22 2c0a 2020 2020     ] [12]",.    
+00011f90: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00011fa0: 6c66 2e61 7373 6572 7454 7275 6528 0a20  lf.assertTrue(. 
+00011fb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011fc0: 7042 4442 2e65 7870 732e 696e 7365 7274  pBDB.exps.insert
+00011fd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00011fe0: 2020 7b22 6e61 6d65 223a 2022 6578 7032    {"name": "exp2
+00011ff0: 222c 2022 636f 6d6d 656e 7473 223a 2022  ", "comments": "
+00012000: 222c 2022 686f 6d65 7061 6765 223a 2022  ", "homepage": "
+00012010: 222c 2022 696e 7370 6972 6522 3a20 2222  ", "inspire": ""
+00012020: 7d0a 2020 2020 2020 2020 2020 2020 290a  }.            ).
+00012030: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00012040: 2020 7365 6c66 2e61 7373 6572 745f 7374    self.assert_st
+00012050: 646f 7574 280a 2020 2020 2020 2020 2020  dout(.          
+00012060: 2020 7365 6c66 2e70 4244 422e 6578 7073    self.pBDB.exps
+00012070: 2e70 7269 6e74 416c 6c2c 0a20 2020 2020  .printAll,.     
+00012080: 2020 2020 2020 2022 2020 313a 2065 7870         "  1: exp
+00012090: 3120 2020 2020 2020 2020 2020 2020 2020  1               
+000120a0: 2020 220a 2020 2020 2020 2020 2020 2020    ".            
+000120b0: 2b20 225b 6874 7470 3a2f 2f73 6f6d 652e  + "[http://some.
+000120c0: 7572 6c2e 6f72 672f 2020 2020 2020 2020  url.org/        
+000120d0: 2020 2020 2020 2020 2020 2020 5d20 5b31              ] [1
+000120e0: 325d 5c6e 2020 220a 2020 2020 2020 2020  2]\n  ".        
+000120f0: 2020 2020 2b20 2232 3a20 6578 7032 2020      + "2: exp2  
+00012100: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00012110: 0a20 2020 2020 2020 2020 2020 202b 2022  .            + "
+00012120: 5b20 2020 2020 2020 2020 2020 2020 2020  [               
+00012130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012140: 2020 2020 2020 2020 205d 205b 5d5c 6e22           ] []\n"
+00012150: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00012160: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00012170: 7275 6528 7365 6c66 2e70 4244 422e 6361  rue(self.pBDB.ca
+00012180: 7445 7870 2e69 6e73 6572 7428 302c 2031  tExp.insert(0, 1
+00012190: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+000121a0: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+000121b0: 7042 4442 2e63 6174 4578 702e 696e 7365  pBDB.catExp.inse
+000121c0: 7274 2831 2c20 3229 290a 2020 2020 2020  rt(1, 2)).      
+000121d0: 2020 7365 6c66 2e61 7373 6572 745f 7374    self.assert_st
+000121e0: 646f 7574 280a 2020 2020 2020 2020 2020  dout(.          
+000121f0: 2020 7365 6c66 2e70 4244 422e 6578 7073    self.pBDB.exps
+00012200: 2e70 7269 6e74 496e 4361 7473 2c0a 2020  .printInCats,.  
+00012210: 2020 2020 2020 2020 2020 2220 2020 303a            "   0:
+00012220: 204d 6169 6e5c 6e20 2020 2020 2020 2020   Main\n         
+00012230: 202d 3e20 6578 7031 2028 3129 5c6e 2020   -> exp1 (1)\n  
+00012240: 2020 2020 2020 313a 2022 0a20 2020 2020        1: ".     
+00012250: 2020 2020 2020 202b 2022 5461 6773 5c6e         + "Tags\n
+00012260: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+00012270: 3e20 6578 7032 2028 3229 5c6e 222c 0a20  > exp2 (2)\n",. 
+00012280: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00012290: 6620 7465 7374 5f67 6574 4279 4f74 6865  f test_getByOthe
+000122a0: 7273 2873 656c 662c 202a 6172 6773 293a  rs(self, *args):
+000122b0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+000122c0: 2067 6574 4279 4361 7420 616e 6420 6765   getByCat and ge
+000122d0: 7442 7945 6e74 7279 2063 7265 6174 696e  tByEntry creatin
+000122e0: 6720 736f 6d65 2066 616b 6520 7265 636f  g some fake reco
+000122f0: 7264 7322 2222 0a20 2020 2020 2020 2064  rds""".        d
+00012300: 6174 6120 3d20 7365 6c66 2e70 4244 422e  ata = self.pBDB.
+00012310: 6269 6273 2e70 7265 7061 7265 496e 7365  bibs.prepareInse
+00012320: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
+00012330: 275c 6e5c 6e25 636f 6d6d 656e 745c 6e40  '\n\n%comment\n@
+00012340: 6172 7469 636c 657b 6162 632c 5c6e 6175  article{abc,\nau
+00012350: 7468 6f72 203d 2022 6d65 222c 2720 2b20  thor = "me",' + 
+00012360: 275c 6e74 6974 6c65 203d 2022 7469 746c  '\ntitle = "titl
+00012370: 6522 2c7d 272c 0a20 2020 2020 2020 2020  e",}',.         
+00012380: 2020 2062 6962 6b65 793d 2261 6263 222c     bibkey="abc",
+00012390: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000123a0: 2020 2064 6174 6120 3d20 7365 6c66 2e70     data = self.p
+000123b0: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
+000123c0: 496e 7365 7274 280a 2020 2020 2020 2020  Insert(.        
+000123d0: 2020 2020 275c 6e5c 6e25 636f 6d6d 656e      '\n\n%commen
+000123e0: 745c 6e40 6172 7469 636c 657b 6465 6667  t\n@article{defg
+000123f0: 6869 2c5c 6e61 7574 686f 7220 3d20 226d  hi,\nauthor = "m
+00012400: 6522 2c5c 6e27 202b 2027 7469 746c 6520  e",\n' + 'title 
+00012410: 3d20 2274 6974 6c65 222c 7d27 2c0a 2020  = "title",}',.  
+00012420: 2020 2020 2020 2020 2020 6269 626b 6579            bibkey
+00012430: 3d22 6465 6667 6869 222c 0a20 2020 2020  ="defghi",.     
+00012440: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00012450: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
+00012460: 662e 7042 4442 2e62 6962 732e 696e 7365  f.pBDB.bibs.inse
+00012470: 7274 2864 6174 6129 290a 2020 2020 2020  rt(data)).      
+00012480: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+00012490: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
+000124a0: 656c 662e 7042 4442 2e65 7870 732e 696e  elf.pBDB.exps.in
+000124b0: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
+000124c0: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
+000124d0: 6578 7031 222c 2022 636f 6d6d 656e 7473  exp1", "comments
+000124e0: 223a 2022 222c 2022 686f 6d65 7061 6765  ": "", "homepage
+000124f0: 223a 2022 222c 2022 696e 7370 6972 6522  ": "", "inspire"
+00012500: 3a20 2222 7d0a 2020 2020 2020 2020 2020  : ""}.          
+00012510: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
+00012520: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00012530: 7454 7275 6528 7365 6c66 2e70 4244 422e  tTrue(self.pBDB.
+00012540: 6361 7445 7870 2e69 6e73 6572 7428 302c  catExp.insert(0,
+00012550: 2031 2929 0a20 2020 2020 2020 2073 656c   1)).        sel
+00012560: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
+00012570: 662e 7042 4442 2e62 6962 4578 702e 696e  f.pBDB.bibExp.in
+00012580: 7365 7274 2822 6162 6322 2c20 3129 290a  sert("abc", 1)).
+00012590: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000125a0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+000125b0: 4442 2e65 7870 732e 6765 7442 7945 6e74  DB.exps.getByEnt
+000125c0: 7279 2822 6465 6622 292c 205b 5d29 0a20  ry("def"), []). 
+000125d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000125e0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000125f0: 2020 2020 205b 6469 6374 2865 2920 666f       [dict(e) fo
+00012600: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00012610: 2e65 7870 732e 6765 7442 7945 6e74 7279  .exps.getByEntry
+00012620: 2822 6162 6322 295d 2c0a 2020 2020 2020  ("abc")],.      
+00012630: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00012640: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00012650: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+00012660: 6e73 7069 7265 223a 2022 222c 0a20 2020  nspire": "",.   
+00012670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012680: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
+00012690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000126a0: 2020 2020 2022 6e61 6d65 223a 2022 6578       "name": "ex
+000126b0: 7031 222c 0a20 2020 2020 2020 2020 2020  p1",.           
+000126c0: 2020 2020 2020 2020 2022 6269 626b 6579           "bibkey
+000126d0: 223a 2022 6162 6322 2c0a 2020 2020 2020  ": "abc",.      
+000126e0: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+000126f0: 6445 6e45 7822 3a20 312c 0a20 2020 2020  dEnEx": 1,.     
+00012700: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00012710: 686f 6d65 7061 6765 223a 2022 222c 0a20  homepage": "",. 
+00012720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012730: 2020 2022 6964 4578 7022 3a20 312c 0a20     "idExp": 1,. 
+00012740: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00012750: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
+00012760: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00012770: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00012780: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00012790: 5b64 6963 7428 6529 2066 6f72 2065 2069  [dict(e) for e i
+000127a0: 6e20 7365 6c66 2e70 4244 422e 6578 7073  n self.pBDB.exps
+000127b0: 2e67 6574 4279 456e 7472 6965 7328 5b22  .getByEntries(["
+000127c0: 6162 6322 2c20 2264 6566 6768 6922 5d29  abc", "defghi"])
+000127d0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+000127e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000127f0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00012800: 2020 2020 2020 2022 696e 7370 6972 6522         "inspire"
+00012810: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00012820: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
+00012830: 6e74 7322 3a20 2222 2c0a 2020 2020 2020  nts": "",.      
+00012840: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00012850: 616d 6522 3a20 2265 7870 3122 2c0a 2020  ame": "exp1",.  
+00012860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012870: 2020 2262 6962 6b65 7922 3a20 2261 6263    "bibkey": "abc
+00012880: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00012890: 2020 2020 2020 2022 6964 456e 4578 223a         "idEnEx":
+000128a0: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
+000128b0: 2020 2020 2020 2020 2268 6f6d 6570 6167          "homepag
+000128c0: 6522 3a20 2222 2c0a 2020 2020 2020 2020  e": "",.        
+000128d0: 2020 2020 2020 2020 2020 2020 2269 6445              "idE
+000128e0: 7870 223a 2031 2c0a 2020 2020 2020 2020  xp": 1,.        
+000128f0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00012900: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+00012910: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00012920: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+00012930: 2e70 4244 422e 6578 7073 2e67 6574 4279  .pBDB.exps.getBy
+00012940: 4361 7428 2231 2229 2c20 5b5d 290a 2020  Cat("1"), []).  
+00012950: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00012960: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00012970: 2020 2020 5b64 6963 7428 6529 2066 6f72      [dict(e) for
+00012980: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00012990: 6578 7073 2e67 6574 4279 4361 7428 3029  exps.getByCat(0)
+000129a0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+000129b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000129c0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+000129d0: 2020 2020 2020 2022 6964 4361 7422 3a20         "idCat": 
+000129e0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+000129f0: 2020 2020 2020 2022 696e 7370 6972 6522         "inspire"
+00012a00: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00012a10: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
+00012a20: 6e74 7322 3a20 2222 2c0a 2020 2020 2020  nts": "",.      
+00012a30: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00012a40: 616d 6522 3a20 2265 7870 3122 2c0a 2020  ame": "exp1",.  
+00012a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a60: 2020 2269 6445 7843 223a 2031 2c0a 2020    "idExC": 1,.  
+00012a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a80: 2020 2268 6f6d 6570 6167 6522 3a20 2222    "homepage": ""
+00012a90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012aa0: 2020 2020 2020 2269 6445 7870 223a 2031        "idExp": 1
+00012ab0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012ac0: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+00012ad0: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00012ae0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00012af0: 5472 7565 280a 2020 2020 2020 2020 2020  True(.          
+00012b00: 2020 7365 6c66 2e70 4244 422e 6578 7073    self.pBDB.exps
+00012b10: 2e69 6e73 6572 7428 0a20 2020 2020 2020  .insert(.       
+00012b20: 2020 2020 2020 2020 207b 226e 616d 6522           {"name"
+00012b30: 3a20 2265 7870 3222 2c20 2263 6f6d 6d65  : "exp2", "comme
+00012b40: 6e74 7322 3a20 2222 2c20 2268 6f6d 6570  nts": "", "homep
+00012b50: 6167 6522 3a20 2222 2c20 2269 6e73 7069  age": "", "inspi
+00012b60: 7265 223a 2022 227d 0a20 2020 2020 2020  re": ""}.       
+00012b70: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+00012b80: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00012b90: 7365 7274 5472 7565 2873 656c 662e 7042  sertTrue(self.pB
+00012ba0: 4442 2e62 6962 4578 702e 696e 7365 7274  DB.bibExp.insert
+00012bb0: 2822 6465 6667 6869 222c 2032 2929 0a20  ("defghi", 2)). 
+00012bc0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00012bd0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00012be0: 2020 2020 205b 6469 6374 2865 2920 666f       [dict(e) fo
+00012bf0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00012c00: 2e65 7870 732e 6765 7442 7945 6e74 7269  .exps.getByEntri
+00012c10: 6573 285b 2261 6263 222c 2022 6465 6667  es(["abc", "defg
+00012c20: 6869 225d 295d 2c0a 2020 2020 2020 2020  hi"])],.        
+00012c30: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+00012c40: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00012c50: 2020 2020 2020 2020 2020 2020 2269 6e73              "ins
+00012c60: 7069 7265 223a 2022 222c 0a20 2020 2020  pire": "",.     
+00012c70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00012c80: 636f 6d6d 656e 7473 223a 2022 222c 0a20  comments": "",. 
+00012c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012ca0: 2020 2022 6e61 6d65 223a 2022 6578 7031     "name": "exp1
+00012cb0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00012cc0: 2020 2020 2020 2022 6269 626b 6579 223a         "bibkey":
+00012cd0: 2022 6162 6322 2c0a 2020 2020 2020 2020   "abc",.        
+00012ce0: 2020 2020 2020 2020 2020 2020 2269 6445              "idE
+00012cf0: 6e45 7822 3a20 312c 0a20 2020 2020 2020  nEx": 1,.       
+00012d00: 2020 2020 2020 2020 2020 2020 2022 686f               "ho
+00012d10: 6d65 7061 6765 223a 2022 222c 0a20 2020  mepage": "",.   
+00012d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012d30: 2022 6964 4578 7022 3a20 312c 0a20 2020   "idExp": 1,.   
+00012d40: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
 00012d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d60: 2020 2022 686f 6d65 7061 6765 223a 2022     "homepage": "
-00012d70: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00012d80: 2020 2020 2020 2022 6964 4578 7022 3a20         "idExp": 
-00012d90: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-00012da0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-00012db0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-00012dc0: 2020 2020 2020 2020 2020 2020 2269 6e73              "ins
-00012dd0: 7069 7265 223a 2022 222c 0a20 2020 2020  pire": "",.     
-00012de0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00012df0: 636f 6d6d 656e 7473 223a 2022 222c 0a20  comments": "",. 
-00012e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e10: 2020 2022 6e61 6d65 223a 2022 6578 7032     "name": "exp2
-00012e20: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00012e30: 2020 2020 2020 2022 6269 626b 6579 223a         "bibkey":
-00012e40: 2022 6465 6667 6869 222c 0a20 2020 2020   "defghi",.     
-00012e50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00012e60: 6964 456e 4578 223a 2032 2c0a 2020 2020  idEnEx": 2,.    
-00012e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e80: 2268 6f6d 6570 6167 6522 3a20 2222 2c0a  "homepage": "",.
-00012e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ea0: 2020 2020 2269 6445 7870 223a 2032 2c0a      "idExp": 2,.
-00012eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ec0: 7d2c 0a20 2020 2020 2020 2020 2020 205d  },.            ]
-00012ed0: 2c0a 2020 2020 2020 2020 290a 0a0a 4075  ,.        )...@u
-00012ee0: 6e69 7474 6573 742e 736b 6970 4966 2873  nittest.skipIf(s
-00012ef0: 6b69 7054 6573 7473 5365 7474 696e 6773  kipTestsSettings
-00012f00: 2e64 622c 2022 4461 7461 6261 7365 2074  .db, "Database t
-00012f10: 6573 7473 2229 0a40 7061 7463 6828 226c  ests").@patch("l
-00012f20: 6f67 6769 6e67 2e4c 6f67 6765 722e 6465  ogging.Logger.de
-00012f30: 6275 6722 290a 4070 6174 6368 2822 6c6f  bug").@patch("lo
-00012f40: 6767 696e 672e 4c6f 6767 6572 2e69 6e66  gging.Logger.inf
-00012f50: 6f22 290a 4070 6174 6368 2822 6c6f 6767  o").@patch("logg
-00012f60: 696e 672e 4c6f 6767 6572 2e77 6172 6e69  ing.Logger.warni
-00012f70: 6e67 2229 0a40 7061 7463 6828 226c 6f67  ng").@patch("log
-00012f80: 6769 6e67 2e4c 6f67 6765 722e 6578 6365  ging.Logger.exce
-00012f90: 7074 696f 6e22 290a 636c 6173 7320 5465  ption").class Te
-00012fa0: 7374 4461 7461 6261 7365 4361 7465 676f  stDatabaseCatego
-00012fb0: 7269 6573 2844 4254 6573 7443 6173 6529  ries(DBTestCase)
-00012fc0: 3a0a 2020 2020 2222 2254 6573 7473 2066  :.    """Tests f
-00012fd0: 6f72 2074 6865 206d 6574 686f 6473 2069  or the methods i
-00012fe0: 6e20 7468 6520 6361 7465 676f 7269 6573  n the categories
-00012ff0: 2073 7562 636c 6173 7322 2222 0a0a 2020   subclass"""..  
-00013000: 2020 6465 6620 6368 6563 6b4e 756d 6265    def checkNumbe
-00013010: 7243 6174 6567 6f72 6965 7328 7365 6c66  rCategories(self
-00013020: 2c20 6e75 6d62 6572 293a 0a20 2020 2020  , number):.     
-00013030: 2020 2022 2222 4368 6563 6b20 7468 6520     """Check the 
-00013040: 6e75 6d62 6572 206f 6620 6578 7065 7269  number of experi
-00013050: 6d65 6e74 7322 2222 0a20 2020 2020 2020  ments""".       
-00013060: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00013070: 6c28 7365 6c66 2e70 4244 422e 6361 7473  l(self.pBDB.cats
-00013080: 2e63 6f75 6e74 2829 2c20 6e75 6d62 6572  .count(), number
-00013090: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-000130a0: 696e 7365 7274 5570 6461 7465 4465 6c65  insertUpdateDele
-000130b0: 7465 2873 656c 662c 202a 6172 6773 293a  te(self, *args):
-000130c0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-000130d0: 2069 6e73 6572 742c 2075 7064 6174 652c   insert, update,
-000130e0: 2075 7064 6174 6546 6965 6c64 2c20 6465   updateField, de
-000130f0: 6c65 7465 2066 6f72 2061 6e20 6578 7065  lete for an expe
-00013100: 7269 6d65 6e74 2222 220a 2020 2020 2020  riment""".      
-00013110: 2020 7365 6c66 2e63 6865 636b 4e75 6d62    self.checkNumb
-00013120: 6572 4361 7465 676f 7269 6573 2832 290a  erCategories(2).
-00013130: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00013140: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
-00013150: 4442 2e63 6174 732e 696e 7365 7274 287b  DB.cats.insert({
-00013160: 226e 616d 6522 3a20 2263 6174 3122 7d29  "name": "cat1"})
-00013170: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00013180: 7373 6572 7454 7275 6528 0a20 2020 2020  ssertTrue(.     
-00013190: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-000131a0: 2e63 6174 732e 696e 7365 7274 280a 2020  .cats.insert(.  
-000131b0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-000131c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000131d0: 2020 2020 226e 616d 6522 3a20 2263 6174      "name": "cat
-000131e0: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-000131f0: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
-00013200: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
-00013210: 2020 2020 2020 2020 2020 2020 2264 6573              "des
-00013220: 6372 6970 7469 6f6e 223a 2022 222c 0a20  cription": "",. 
-00013230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013240: 2020 2022 7061 7265 6e74 4361 7422 3a20     "parentCat": 
-00013250: 2230 222c 0a20 2020 2020 2020 2020 2020  "0",.           
-00013260: 2020 2020 2020 2020 2022 6f72 6422 3a20           "ord": 
-00013270: 2230 222c 0a20 2020 2020 2020 2020 2020  "0",.           
-00013280: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-00013290: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
-000132a0: 2020 2020 2020 2073 656c 662e 6368 6563         self.chec
-000132b0: 6b4e 756d 6265 7243 6174 6567 6f72 6965  kNumberCategorie
-000132c0: 7328 3329 0a20 2020 2020 2020 2073 656c  s(3).        sel
-000132d0: 662e 6173 7365 7274 4661 6c73 6528 0a20  f.assertFalse(. 
-000132e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000132f0: 7042 4442 2e63 6174 732e 696e 7365 7274  pBDB.cats.insert
-00013300: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00013310: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00013320: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-00013330: 2263 6174 3122 2c0a 2020 2020 2020 2020  "cat1",.        
-00013340: 2020 2020 2020 2020 2020 2020 2263 6f6d              "com
-00013350: 6d65 6e74 7322 3a20 2222 2c0a 2020 2020  ments": "",.    
-00013360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013370: 2264 6573 6372 6970 7469 6f6e 223a 2022  "description": "
-00013380: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00013390: 2020 2020 2020 2022 7061 7265 6e74 4361         "parentCa
-000133a0: 7422 3a20 2230 222c 0a20 2020 2020 2020  t": "0",.       
-000133b0: 2020 2020 2020 2020 2020 2020 2022 6f72               "or
-000133c0: 6422 3a20 2231 222c 0a20 2020 2020 2020  d": "1",.       
-000133d0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-000133e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000133f0: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
-00013400: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-00013410: 6f67 6765 722e 696e 666f 2229 2061 7320  ogger.info") as 
-00013420: 5f69 3a0a 2020 2020 2020 2020 2020 2020  _i:.            
-00013430: 7365 6c66 2e70 4244 422e 6361 7473 2e69  self.pBDB.cats.i
-00013440: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
-00013450: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00013460: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
-00013470: 6d65 223a 2022 6361 7431 222c 0a20 2020  me": "cat1",.   
-00013480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013490: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
-000134a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000134b0: 2020 2020 2022 6465 7363 7269 7074 696f       "descriptio
-000134c0: 6e22 3a20 2222 2c0a 2020 2020 2020 2020  n": "",.        
-000134d0: 2020 2020 2020 2020 2020 2020 2270 6172              "par
-000134e0: 656e 7443 6174 223a 2022 3022 2c0a 2020  entCat": "0",.  
-000134f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013500: 2020 226f 7264 223a 2022 3122 2c0a 2020    "ord": "1",.  
-00013510: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-00013520: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00013530: 2020 2020 2020 2020 2020 5f69 2e61 7373            _i.ass
-00013540: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-00013550: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
-00013560: 2020 2020 2020 2241 6e20 656e 7472 7920        "An entry 
-00013570: 7769 7468 2074 6865 2073 616d 6520 6e61  with the same na
-00013580: 6d65 2069 7320 616c 7265 6164 7920 7072  me is already pr
-00013590: 6573 656e 7420 696e 2022 0a20 2020 2020  esent in ".     
-000135a0: 2020 2020 2020 2020 2020 202b 2022 7468             + "th
-000135b0: 6520 7361 6d65 2063 6174 6567 6f72 7921  e same category!
-000135c0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-000135d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000135e0: 6572 7454 7275 6528 0a20 2020 2020 2020  ertTrue(.       
-000135f0: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
-00013600: 6174 732e 696e 7365 7274 280a 2020 2020  ats.insert(.    
-00013610: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00013620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013630: 2020 226e 616d 6522 3a20 2263 6174 3122    "name": "cat1"
-00013640: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013650: 2020 2020 2020 2263 6f6d 6d65 6e74 7322        "comments"
-00013660: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-00013670: 2020 2020 2020 2020 2020 2264 6573 6372            "descr
-00013680: 6970 7469 6f6e 223a 2022 222c 0a20 2020  iption": "",.   
-00013690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136a0: 2022 7061 7265 6e74 4361 7422 3a20 2231   "parentCat": "1
-000136b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000136c0: 2020 2020 2020 2022 6f72 6422 3a20 2231         "ord": "1
-000136d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000136e0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-000136f0: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
-00013700: 2020 2020 2073 656c 662e 6368 6563 6b4e       self.checkN
-00013710: 756d 6265 7243 6174 6567 6f72 6965 7328  umberCategories(
-00013720: 3429 0a20 2020 2020 2020 2073 656c 662e  4).        self.
-00013730: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00013740: 2020 2020 2020 2020 207b 655b 2269 6443           {e["idC
-00013750: 6174 225d 3a20 655b 226e 616d 6522 5d20  at"]: e["name"] 
-00013760: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-00013770: 4442 2e63 6174 732e 6765 7441 6c6c 2829  DB.cats.getAll()
-00013780: 7d2c 0a20 2020 2020 2020 2020 2020 207b  },.            {
-00013790: 303a 2022 4d61 696e 222c 2031 3a20 2254  0: "Main", 1: "T
-000137a0: 6167 7322 2c20 323a 2022 6361 7431 222c  ags", 2: "cat1",
-000137b0: 2033 3a20 2263 6174 3122 7d2c 0a20 2020   3: "cat1"},.   
-000137c0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-000137d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000137e0: 0a20 2020 2020 2020 2020 2020 207b 655b  .            {e[
-000137f0: 2269 6443 6174 225d 3a20 655b 2270 6172  "idCat"]: e["par
-00013800: 656e 7443 6174 225d 2066 6f72 2065 2069  entCat"] for e i
-00013810: 6e20 7365 6c66 2e70 4244 422e 6361 7473  n self.pBDB.cats
-00013820: 2e67 6574 416c 6c28 297d 2c0a 2020 2020  .getAll()},.    
-00013830: 2020 2020 2020 2020 7b30 3a20 302c 2031          {0: 0, 1
-00013840: 3a20 302c 2032 3a20 302c 2033 3a20 317d  : 0, 2: 0, 3: 1}
-00013850: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00013860: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00013870: 7275 6528 0a20 2020 2020 2020 2020 2020  rue(.           
-00013880: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
-00013890: 7570 6461 7465 280a 2020 2020 2020 2020  update(.        
-000138a0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-000138b0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-000138c0: 616d 6522 3a20 2263 6174 3222 2c0a 2020  ame": "cat2",.  
-000138d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138e0: 2020 2263 6f6d 6d65 6e74 7322 3a20 2222    "comments": ""
-000138f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013900: 2020 2020 2020 2264 6573 6372 6970 7469        "descripti
-00013910: 6f6e 223a 2022 222c 0a20 2020 2020 2020  on": "",.       
-00013920: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
-00013930: 7265 6e74 4361 7422 3a20 2231 222c 0a20  rentCat": "1",. 
-00013940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013950: 2020 2022 6f72 6422 3a20 302c 0a20 2020     "ord": 0,.   
-00013960: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-00013970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013980: 322c 0a20 2020 2020 2020 2020 2020 2029  2,.            )
-00013990: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000139a0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000139b0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-000139c0: 207b 655b 2269 6443 6174 225d 3a20 655b   {e["idCat"]: e[
-000139d0: 226e 616d 6522 5d20 666f 7220 6520 696e  "name"] for e in
-000139e0: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
-000139f0: 6765 7441 6c6c 2829 7d2c 0a20 2020 2020  getAll()},.     
-00013a00: 2020 2020 2020 207b 303a 2022 4d61 696e         {0: "Main
-00013a10: 222c 2031 3a20 2254 6167 7322 2c20 323a  ", 1: "Tags", 2:
-00013a20: 2022 6361 7432 222c 2033 3a20 2263 6174   "cat2", 3: "cat
-00013a30: 3122 7d2c 0a20 2020 2020 2020 2029 0a20  1"},.        ). 
-00013a40: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00013a50: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
-00013a60: 2e63 6174 732e 7570 6461 7465 4669 656c  .cats.updateFiel
-00013a70: 6428 312c 2022 6465 7363 7269 7074 696f  d(1, "descriptio
-00013a80: 6e22 2c20 2261 6263 6422 2929 0a20 2020  n", "abcd")).   
-00013a90: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00013aa0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00013ab0: 2020 207b 655b 2269 6443 6174 225d 3a20     {e["idCat"]: 
-00013ac0: 655b 2264 6573 6372 6970 7469 6f6e 225d  e["description"]
-00013ad0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00013ae0: 4244 422e 6361 7473 2e67 6574 416c 6c28  BDB.cats.getAll(
-00013af0: 297d 2c0a 2020 2020 2020 2020 2020 2020  )},.            
-00013b00: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00013b10: 2020 303a 2022 5468 6973 2069 7320 7468    0: "This is th
-00013b20: 6520 6d61 696e 2063 6174 6567 6f72 792e  e main category.
-00013b30: 2041 6c6c 2074 6865 206f 7468 6572 206f   All the other o
-00013b40: 6e65 7320 6172 6520 220a 2020 2020 2020  nes are ".      
-00013b50: 2020 2020 2020 2020 2020 2b20 2273 7562            + "sub
-00013b60: 6361 7465 676f 7269 6573 206f 6620 7468  categories of th
-00013b70: 6973 206f 6e65 222c 0a20 2020 2020 2020  is one",.       
-00013b80: 2020 2020 2020 2020 2031 3a20 2261 6263           1: "abc
-00013b90: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
-00013ba0: 2020 2020 323a 2022 222c 0a20 2020 2020      2: "",.     
-00013bb0: 2020 2020 2020 2020 2020 2033 3a20 2222             3: ""
-00013bc0: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
-00013bd0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00013be0: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-00013bf0: 6c73 6528 7365 6c66 2e70 4244 422e 6361  lse(self.pBDB.ca
-00013c00: 7473 2e75 7064 6174 6528 7b22 6e61 6d65  ts.update({"name
-00013c10: 223a 2022 6361 7432 222c 2022 636f 6d6d  ": "cat2", "comm
-00013c20: 656e 7473 223a 2022 227d 2c20 3229 290a  ents": ""}, 2)).
-00013c30: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00013c40: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
-00013c50: 4442 2e63 6174 732e 7570 6461 7465 4669  DB.cats.updateFi
-00013c60: 656c 6428 312c 2022 696e 7370 6972 6573  eld(1, "inspires
-00013c70: 222c 2022 6162 6322 2929 0a20 2020 2020  ", "abc")).     
-00013c80: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-00013c90: 6c73 6528 7365 6c66 2e70 4244 422e 6361  lse(self.pBDB.ca
-00013ca0: 7473 2e75 7064 6174 6546 6965 6c64 2831  ts.updateField(1
-00013cb0: 2c20 2269 6443 6174 222c 2022 3222 2929  , "idCat", "2"))
-00013cc0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00013cd0: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
-00013ce0: 4244 422e 6361 7473 2e75 7064 6174 6546  BDB.cats.updateF
-00013cf0: 6965 6c64 2831 2c20 2270 6172 656e 7443  ield(1, "parentC
-00013d00: 6174 222c 204e 6f6e 6529 290a 2020 2020  at", None)).    
-00013d10: 2020 2020 7365 6c66 2e63 6865 636b 4e75      self.checkNu
-00013d20: 6d62 6572 4361 7465 676f 7269 6573 2834  mberCategories(4
-00013d30: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00013d40: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-00013d50: 4244 422e 6361 7445 7870 2e69 6e73 6572  BDB.catExp.inser
-00013d60: 7428 322c 2031 2929 0a20 2020 2020 2020  t(2, 1)).       
-00013d70: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00013d80: 2873 656c 662e 7042 4442 2e63 6174 4269  (self.pBDB.catBi
-00013d90: 622e 696e 7365 7274 2832 2c20 2274 6573  b.insert(2, "tes
-00013da0: 7422 2929 0a20 2020 2020 2020 2073 656c  t")).        sel
-00013db0: 662e 6173 7365 7274 5472 7565 280a 2020  f.assertTrue(.  
-00013dc0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00013dd0: 4244 422e 6361 7473 2e69 6e73 6572 7428  BDB.cats.insert(
-00013de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013df0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00013e00: 2020 2020 2020 2022 6e61 6d65 223a 2022         "name": "
-00013e10: 6361 7433 222c 0a20 2020 2020 2020 2020  cat3",.         
-00013e20: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
-00013e30: 656e 7473 223a 2022 222c 0a20 2020 2020  ents": "",.     
-00013e40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00013e50: 6465 7363 7269 7074 696f 6e22 3a20 2222  description": ""
-00013e60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013e70: 2020 2020 2020 2270 6172 656e 7443 6174        "parentCat
-00013e80: 223a 2022 3322 2c0a 2020 2020 2020 2020  ": "3",.        
-00013e90: 2020 2020 2020 2020 2020 2020 226f 7264              "ord
-00013ea0: 223a 2022 3122 2c0a 2020 2020 2020 2020  ": "1",.        
-00013eb0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00013ec0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00013ed0: 290a 2020 2020 2020 2020 6462 5374 6174  ).        dbStat
-00013ee0: 7328 7365 6c66 2e70 4244 4229 0a20 2020  s(self.pBDB).   
-00013ef0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00013f00: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-00013f10: 7374 6174 735b 2263 6174 7322 5d2c 2035  stats["cats"], 5
-00013f20: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00013f30: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-00013f40: 7042 4442 2e73 7461 7473 5b22 6361 7445  pBDB.stats["catE
-00013f50: 7870 225d 2c20 3129 0a20 2020 2020 2020  xp"], 1).       
-00013f60: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00013f70: 6c28 7365 6c66 2e70 4244 422e 7374 6174  l(self.pBDB.stat
-00013f80: 735b 2263 6174 4269 6222 5d2c 2031 290a  s["catBib"], 1).
-00013f90: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00013fa0: 422e 6361 7473 2e64 656c 6574 6528 5b32  B.cats.delete([2
-00013fb0: 2c20 335d 290a 2020 2020 2020 2020 7365  , 3]).        se
-00013fc0: 6c66 2e63 6865 636b 4e75 6d62 6572 4361  lf.checkNumberCa
-00013fd0: 7465 676f 7269 6573 2832 290a 2020 2020  tegories(2).    
-00013fe0: 2020 2020 6462 5374 6174 7328 7365 6c66      dbStats(self
-00013ff0: 2e70 4244 4229 0a20 2020 2020 2020 2073  .pBDB).        s
-00014000: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00014010: 7365 6c66 2e70 4244 422e 7374 6174 735b  self.pBDB.stats[
-00014020: 2263 6174 4578 7022 5d2c 2030 290a 2020  "catExp"], 0).  
-00014030: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00014040: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
-00014050: 2e73 7461 7473 5b22 6361 7442 6962 225d  .stats["catBib"]
-00014060: 2c20 3029 0a20 2020 2020 2020 2077 6974  , 0).        wit
-00014070: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
-00014080: 2e4c 6f67 6765 722e 696e 666f 2229 2061  .Logger.info") a
-00014090: 7320 5f69 3a0a 2020 2020 2020 2020 2020  s _i:.          
-000140a0: 2020 7365 6c66 2e70 4244 422e 6361 7473    self.pBDB.cats
-000140b0: 2e64 656c 6574 6528 3029 0a20 2020 2020  .delete(0).     
-000140c0: 2020 2020 2020 205f 692e 6173 7365 7274         _i.assert
-000140d0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-000140e0: 6828 2259 6f75 2073 686f 756c 6420 6e6f  h("You should no
-000140f0: 7420 6465 6c65 7465 2074 6865 2063 6174  t delete the cat
-00014100: 6567 6f72 7920 7769 7468 2069 643a 2030  egory with id: 0
-00014110: 2e22 290a 2020 2020 2020 2020 7365 6c66  .").        self
-00014120: 2e63 6865 636b 4e75 6d62 6572 4361 7465  .checkNumberCate
-00014130: 676f 7269 6573 2832 290a 2020 2020 2020  gories(2).      
-00014140: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
-00014150: 6767 696e 672e 4c6f 6767 6572 2e69 6e66  gging.Logger.inf
-00014160: 6f22 2920 6173 205f 693a 0a20 2020 2020  o") as _i:.     
-00014170: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00014180: 2e63 6174 732e 6465 6c65 7465 2831 290a  .cats.delete(1).
-00014190: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
-000141a0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-000141b0: 655f 7769 7468 2822 596f 7520 7368 6f75  e_with("You shou
-000141c0: 6c64 206e 6f74 2064 656c 6574 6520 7468  ld not delete th
-000141d0: 6520 6361 7465 676f 7279 2077 6974 6820  e category with 
-000141e0: 6964 3a20 312e 2229 0a20 2020 2020 2020  id: 1.").       
-000141f0: 2073 656c 662e 6368 6563 6b4e 756d 6265   self.checkNumbe
-00014200: 7243 6174 6567 6f72 6965 7328 3229 0a0a  rCategories(2)..
-00014210: 2020 2020 6465 6620 7465 7374 5f67 6574      def test_get
-00014220: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-00014230: 2020 2020 2020 2022 2222 5465 7374 2067         """Test g
-00014240: 6574 206d 6574 686f 6473 2222 220a 2020  et methods""".  
-00014250: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00014260: 7454 7275 6528 0a20 2020 2020 2020 2020  tTrue(.         
-00014270: 2020 2073 656c 662e 7042 4442 2e63 6174     self.pBDB.cat
-00014280: 732e 696e 7365 7274 280a 2020 2020 2020  s.insert(.      
-00014290: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-000142a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000142b0: 226e 616d 6522 3a20 2263 6174 3122 2c0a  "name": "cat1",.
-000142c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000142d0: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
-000142e0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-000142f0: 2020 2020 2020 2020 2264 6573 6372 6970          "descrip
-00014300: 7469 6f6e 223a 2022 222c 0a20 2020 2020  tion": "",.     
-00014310: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00014320: 7061 7265 6e74 4361 7422 3a20 2231 222c  parentCat": "1",
-00014330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014340: 2020 2020 2022 6f72 6422 3a20 2230 222c       "ord": "0",
-00014350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014360: 207d 0a20 2020 2020 2020 2020 2020 2029   }.            )
-00014370: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00014380: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-00014390: 7565 280a 2020 2020 2020 2020 2020 2020  ue(.            
-000143a0: 7365 6c66 2e70 4244 422e 6361 7473 2e69  self.pBDB.cats.i
-000143b0: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
-000143c0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-000143d0: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
-000143e0: 6d65 223a 2022 6361 7432 222c 0a20 2020  me": "cat2",.   
-000143f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014400: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
-00014410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014420: 2020 2020 2022 6465 7363 7269 7074 696f       "descriptio
-00014430: 6e22 3a20 2222 2c0a 2020 2020 2020 2020  n": "",.        
-00014440: 2020 2020 2020 2020 2020 2020 2270 6172              "par
-00014450: 656e 7443 6174 223a 2022 3122 2c0a 2020  entCat": "1",.  
-00014460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014470: 2020 226f 7264 223a 2022 3022 2c0a 2020    "ord": "0",.  
-00014480: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-00014490: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000144a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000144b0: 7365 6c66 2e63 6865 636b 4e75 6d62 6572  self.checkNumber
-000144c0: 4361 7465 676f 7269 6573 2834 290a 2020  Categories(4).  
-000144d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000144e0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-000144f0: 2020 2020 5b64 6963 7428 6529 2066 6f72      [dict(e) for
-00014500: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00014510: 6361 7473 2e67 6574 416c 6c28 295d 2c0a  cats.getAll()],.
-00014520: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00014530: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00014540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014550: 2020 2020 2269 6443 6174 223a 2030 2c0a      "idCat": 0,.
-00014560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014570: 2020 2020 226e 616d 6522 3a20 224d 6169      "name": "Mai
-00014580: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
-00014590: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
-000145a0: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
-000145b0: 2020 2020 2020 2020 2020 2020 2264 6573              "des
-000145c0: 6372 6970 7469 6f6e 223a 2022 5468 6973  cription": "This
-000145d0: 2069 7320 7468 6520 6d61 696e 2063 6174   is the main cat
-000145e0: 6567 6f72 792e 2022 0a20 2020 2020 2020  egory. ".       
-000145f0: 2020 2020 2020 2020 2020 2020 202b 2022               + "
-00014600: 416c 6c20 7468 6520 6f74 6865 7220 6f6e  All the other on
-00014610: 6573 2061 7265 2073 7562 6361 7465 676f  es are subcatego
-00014620: 7269 6573 206f 6620 7468 6973 206f 6e65  ries of this one
-00014630: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00014640: 2020 2020 2020 2022 7061 7265 6e74 4361         "parentCa
-00014650: 7422 3a20 302c 0a20 2020 2020 2020 2020  t": 0,.         
-00014660: 2020 2020 2020 2020 2020 2022 6f72 6422             "ord"
-00014670: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
-00014680: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00014690: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-000146a0: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-000146b0: 6443 6174 223a 2031 2c0a 2020 2020 2020  dCat": 1,.      
-000146c0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-000146d0: 616d 6522 3a20 2254 6167 7322 2c0a 2020  ame": "Tags",.  
-000146e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146f0: 2020 2263 6f6d 6d65 6e74 7322 3a20 2222    "comments": ""
-00014700: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014710: 2020 2020 2020 2264 6573 6372 6970 7469        "descripti
-00014720: 6f6e 223a 2022 5573 6520 7468 6973 2063  on": "Use this c
-00014730: 6174 6567 6f72 7920 746f 2073 746f 7265  ategory to store
-00014740: 2074 6167 7320 220a 2020 2020 2020 2020   tags ".        
-00014750: 2020 2020 2020 2020 2020 2020 2b20 2228              + "(
-00014760: 7375 6368 2061 733a 206f 6e67 6f69 6e67  such as: ongoing
-00014770: 2070 726f 6a65 6374 732c 2074 656d 706f   projects, tempo
-00014780: 7261 7279 2063 6174 732c 2e2e 2e29 222c  rary cats,...)",
-00014790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000147a0: 2020 2020 2022 7061 7265 6e74 4361 7422       "parentCat"
-000147b0: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
-000147c0: 2020 2020 2020 2020 2022 6f72 6422 3a20           "ord": 
-000147d0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-000147e0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-000147f0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-00014800: 2020 2020 2020 2020 2020 2020 2269 6443              "idC
-00014810: 6174 223a 2032 2c0a 2020 2020 2020 2020  at": 2,.        
-00014820: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-00014830: 6522 3a20 2263 6174 3122 2c0a 2020 2020  e": "cat1",.    
-00014840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014850: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
-00014860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014870: 2020 2020 2264 6573 6372 6970 7469 6f6e      "description
-00014880: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-00014890: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
-000148a0: 6e74 4361 7422 3a20 312c 0a20 2020 2020  ntCat": 1,.     
-000148b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000148c0: 6f72 6422 3a20 302c 0a20 2020 2020 2020  ord": 0,.       
-000148d0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-000148e0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-000148f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014900: 2020 2269 6443 6174 223a 2033 2c0a 2020    "idCat": 3,.  
-00014910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014920: 2020 226e 616d 6522 3a20 2263 6174 3222    "name": "cat2"
-00014930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014940: 2020 2020 2020 2263 6f6d 6d65 6e74 7322        "comments"
-00014950: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-00014960: 2020 2020 2020 2020 2020 2264 6573 6372            "descr
-00014970: 6970 7469 6f6e 223a 2022 222c 0a20 2020  iption": "",.   
-00014980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014990: 2022 7061 7265 6e74 4361 7422 3a20 312c   "parentCat": 1,
-000149a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000149b0: 2020 2020 2022 6f72 6422 3a20 302c 0a20       "ord": 0,. 
-000149c0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-000149d0: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
-000149e0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000149f0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00014a00: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00014a10: 205b 6469 6374 2865 2920 666f 7220 6520   [dict(e) for e 
-00014a20: 696e 2073 656c 662e 7042 4442 2e63 6174  in self.pBDB.cat
-00014a30: 732e 6765 7442 7949 4428 3229 5d2c 0a20  s.getByID(2)],. 
-00014a40: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-00014a50: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-00014a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a70: 2020 2022 6964 4361 7422 3a20 322c 0a20     "idCat": 2,. 
-00014a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a90: 2020 2022 6e61 6d65 223a 2022 6361 7431     "name": "cat1
-00014aa0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00014ab0: 2020 2020 2020 2022 636f 6d6d 656e 7473         "comments
-00014ac0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-00014ad0: 2020 2020 2020 2020 2020 2022 6465 7363             "desc
-00014ae0: 7269 7074 696f 6e22 3a20 2222 2c0a 2020  ription": "",.  
-00014af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b00: 2020 2270 6172 656e 7443 6174 223a 2031    "parentCat": 1
-00014b10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014b20: 2020 2020 2020 226f 7264 223a 2030 2c0a        "ord": 0,.
-00014b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b40: 7d0a 2020 2020 2020 2020 2020 2020 5d2c  }.            ],
-00014b50: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00014b60: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00014b70: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00014b80: 205b 6469 6374 2865 2920 666f 7220 6520   [dict(e) for e 
-00014b90: 696e 2073 656c 662e 7042 4442 2e63 6174  in self.pBDB.cat
-00014ba0: 732e 6765 7442 794e 616d 6528 2263 6174  s.getByName("cat
-00014bb0: 3222 295d 2c0a 2020 2020 2020 2020 2020  2")],.          
-00014bc0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00014bd0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-00014be0: 2020 2020 2020 2020 2020 2269 6443 6174            "idCat
-00014bf0: 223a 2033 2c0a 2020 2020 2020 2020 2020  ": 3,.          
-00014c00: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-00014c10: 3a20 2263 6174 3222 2c0a 2020 2020 2020  : "cat2",.      
-00014c20: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00014c30: 6f6d 6d65 6e74 7322 3a20 2222 2c0a 2020  omments": "",.  
-00014c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c50: 2020 2264 6573 6372 6970 7469 6f6e 223a    "description":
-00014c60: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00014c70: 2020 2020 2020 2020 2022 7061 7265 6e74           "parent
-00014c80: 4361 7422 3a20 312c 0a20 2020 2020 2020  Cat": 1,.       
-00014c90: 2020 2020 2020 2020 2020 2020 2022 6f72               "or
-00014ca0: 6422 3a20 302c 0a20 2020 2020 2020 2020  d": 0,.         
-00014cb0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00014cc0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00014cd0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00014ce0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00014cf0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00014d00: 422e 6361 7473 2e67 6574 4469 6374 4279  B.cats.getDictBy
-00014d10: 4944 2832 292c 0a20 2020 2020 2020 2020  ID(2),.         
-00014d20: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-00014d30: 2020 2020 2022 6964 4361 7422 3a20 322c       "idCat": 2,
-00014d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014d50: 2022 6e61 6d65 223a 2022 6361 7431 222c   "name": "cat1",
-00014d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014d70: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
-00014d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014d90: 2022 6465 7363 7269 7074 696f 6e22 3a20   "description": 
-00014da0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-00014db0: 2020 2020 2270 6172 656e 7443 6174 223a      "parentCat":
-00014dc0: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
-00014dd0: 2020 2020 226f 7264 223a 2030 2c0a 2020      "ord": 0,.  
-00014de0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-00014df0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00014e00: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00014e10: 0a20 2020 2020 2020 2020 2020 205b 6469  .            [di
-00014e20: 6374 2865 2920 666f 7220 6520 696e 2073  ct(e) for e in s
-00014e30: 656c 662e 7042 4442 2e63 6174 732e 6765  elf.pBDB.cats.ge
-00014e40: 7443 6869 6c64 2830 295d 2c0a 2020 2020  tChild(0)],.    
-00014e50: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00014e60: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00014e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e80: 2269 6443 6174 223a 2030 2c0a 2020 2020  "idCat": 0,.    
-00014e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ea0: 226e 616d 6522 3a20 224d 6169 6e22 2c0a  "name": "Main",.
-00014eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ec0: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
-00014ed0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-00014ee0: 2020 2020 2020 2020 2264 6573 6372 6970          "descrip
-00014ef0: 7469 6f6e 223a 2022 5468 6973 2069 7320  tion": "This is 
-00014f00: 7468 6520 6d61 696e 2063 6174 6567 6f72  the main categor
-00014f10: 792e 2022 0a20 2020 2020 2020 2020 2020  y. ".           
-00014f20: 2020 2020 2020 2020 202b 2022 416c 6c20           + "All 
-00014f30: 7468 6520 6f74 6865 7220 6f6e 6573 2061  the other ones a
-00014f40: 7265 2073 7562 6361 7465 676f 7269 6573  re subcategories
-00014f50: 206f 6620 7468 6973 206f 6e65 222c 0a20   of this one",. 
-00014f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f70: 2020 2022 7061 7265 6e74 4361 7422 3a20     "parentCat": 
-00014f80: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-00014f90: 2020 2020 2020 2022 6f72 6422 3a20 302c         "ord": 0,
-00014fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014fb0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-00014fc0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-00014fd0: 2020 2020 2020 2020 2020 2269 6443 6174            "idCat
-00014fe0: 223a 2031 2c0a 2020 2020 2020 2020 2020  ": 1,.          
-00014ff0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-00015000: 3a20 2254 6167 7322 2c0a 2020 2020 2020  : "Tags",.      
-00015010: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00015020: 6f6d 6d65 6e74 7322 3a20 2222 2c0a 2020  omments": "",.  
-00015030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015040: 2020 2264 6573 6372 6970 7469 6f6e 223a    "description":
-00015050: 2022 5573 6520 7468 6973 2063 6174 6567   "Use this categ
-00015060: 6f72 7920 746f 2073 746f 7265 2074 6167  ory to store tag
-00015070: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
-00015080: 2020 2020 2020 2020 2b20 2228 7375 6368          + "(such
-00015090: 2061 733a 206f 6e67 6f69 6e67 2070 726f   as: ongoing pro
-000150a0: 6a65 6374 732c 2074 656d 706f 7261 7279  jects, temporary
-000150b0: 2063 6174 732c 2e2e 2e29 222c 0a20 2020   cats,...)",.   
-000150c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150d0: 2022 7061 7265 6e74 4361 7422 3a20 302c   "parentCat": 0,
-000150e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000150f0: 2020 2020 2022 6f72 6422 3a20 302c 0a20       "ord": 0,. 
-00015100: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00015110: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
-00015120: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00015130: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00015140: 7561 6c28 5b64 6963 7428 6529 2066 6f72  ual([dict(e) for
-00015150: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00015160: 6361 7473 2e67 6574 4368 696c 6428 3229  cats.getChild(2)
-00015170: 5d2c 205b 5d29 0a20 2020 2020 2020 2073  ], []).        s
-00015180: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00015190: 0a20 2020 2020 2020 2020 2020 205b 6469  .            [di
-000151a0: 6374 2865 2920 666f 7220 6520 696e 2073  ct(e) for e in s
-000151b0: 656c 662e 7042 4442 2e63 6174 732e 6765  elf.pBDB.cats.ge
-000151c0: 7450 6172 656e 7428 3129 5d2c 0a20 2020  tParent(1)],.   
-000151d0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-000151e0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-000151f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015200: 2022 6964 4361 7422 3a20 302c 0a20 2020   "idCat": 0,.   
-00015210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015220: 2022 6e61 6d65 223a 2022 4d61 696e 222c   "name": "Main",
-00015230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015240: 2020 2020 2022 636f 6d6d 656e 7473 223a       "comments":
-00015250: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00015260: 2020 2020 2020 2020 2022 6465 7363 7269           "descri
-00015270: 7074 696f 6e22 3a20 2254 6869 7320 6973  ption": "This is
-00015280: 2074 6865 206d 6169 6e20 6361 7465 676f   the main catego
-00015290: 7279 2e20 220a 2020 2020 2020 2020 2020  ry. ".          
-000152a0: 2020 2020 2020 2020 2020 2b20 2241 6c6c            + "All
-000152b0: 2074 6865 206f 7468 6572 206f 6e65 7320   the other ones 
-000152c0: 6172 6520 7375 6263 6174 6567 6f72 6965  are subcategorie
-000152d0: 7320 6f66 2074 6869 7320 6f6e 6522 2c0a  s of this one",.
-000152e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152f0: 2020 2020 2270 6172 656e 7443 6174 223a      "parentCat":
-00015300: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-00015310: 2020 2020 2020 2020 226f 7264 223a 2030          "ord": 0
-00015320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015330: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00015340: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-00015350: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00015360: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-00015370: 6361 7473 2e67 6574 416c 6c43 6174 7349  cats.getAllCatsI
-00015380: 6e54 7265 6528 3029 2c20 5b30 2c20 312c  nTree(0), [0, 1,
-00015390: 2032 2c20 335d 290a 2020 2020 2020 2020   2, 3]).        
-000153a0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000153b0: 2873 656c 662e 7042 4442 2e63 6174 732e  (self.pBDB.cats.
-000153c0: 6765 7441 6c6c 4361 7473 496e 5472 6565  getAllCatsInTree
-000153d0: 2831 292c 205b 312c 2032 2c20 335d 290a  (1), [1, 2, 3]).
-000153e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000153f0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-00015400: 4442 2e63 6174 732e 6765 7441 6c6c 4361  DB.cats.getAllCa
-00015410: 7473 496e 5472 6565 2832 292c 205b 325d  tsInTree(2), [2]
-00015420: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00015430: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-00015440: 7042 4442 2e63 6174 732e 6765 7441 6c6c  pBDB.cats.getAll
-00015450: 4361 7473 496e 5472 6565 2835 292c 205b  CatsInTree(5), [
-00015460: 5d29 0a0a 2020 2020 6465 6620 7465 7374  ])..    def test
-00015470: 5f67 6574 4279 4f74 6865 7273 2873 656c  _getByOthers(sel
-00015480: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
-00015490: 2020 2022 2222 5465 7374 2067 6574 4279     """Test getBy
-000154a0: 4578 7020 616e 6420 6765 7442 7945 6e74  Exp and getByEnt
-000154b0: 7279 2063 7265 6174 696e 6720 736f 6d65  ry creating some
-000154c0: 2066 616b 6520 7265 636f 7264 7322 2222   fake records"""
-000154d0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-000154e0: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
-000154f0: 7265 7061 7265 496e 7365 7274 280a 2020  repareInsert(.  
-00015500: 2020 2020 2020 2020 2020 275c 6e5c 6e25            '\n\n%
-00015510: 636f 6d6d 656e 745c 6e40 6172 7469 636c  comment\n@articl
-00015520: 657b 6162 632c 5c6e 6175 7468 6f72 203d  e{abc,\nauthor =
-00015530: 2022 6d65 222c 5c6e 2720 2b20 2774 6974   "me",\n' + 'tit
-00015540: 6c65 203d 2022 7469 746c 6522 2c7d 272c  le = "title",}',
-00015550: 0a20 2020 2020 2020 2020 2020 2062 6962  .            bib
-00015560: 6b65 793d 2261 6263 222c 0a20 2020 2020  key="abc",.     
-00015570: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00015580: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-00015590: 662e 7042 4442 2e62 6962 732e 696e 7365  f.pBDB.bibs.inse
-000155a0: 7274 2864 6174 6129 290a 2020 2020 2020  rt(data)).      
-000155b0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-000155c0: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-000155d0: 656c 662e 7042 4442 2e65 7870 732e 696e  elf.pBDB.exps.in
-000155e0: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
-000155f0: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
-00015600: 6578 7031 222c 2022 636f 6d6d 656e 7473  exp1", "comments
-00015610: 223a 2022 222c 2022 686f 6d65 7061 6765  ": "", "homepage
-00015620: 223a 2022 222c 2022 696e 7370 6972 6522  ": "", "inspire"
-00015630: 3a20 2222 7d0a 2020 2020 2020 2020 2020  : ""}.          
-00015640: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
-00015650: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00015660: 7454 7275 6528 7365 6c66 2e70 4244 422e  tTrue(self.pBDB.
-00015670: 6361 7445 7870 2e69 6e73 6572 7428 312c  catExp.insert(1,
-00015680: 2031 2929 0a20 2020 2020 2020 2073 656c   1)).        sel
-00015690: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-000156a0: 662e 7042 4442 2e63 6174 4269 622e 696e  f.pBDB.catBib.in
-000156b0: 7365 7274 2831 2c20 2261 6263 2229 290a  sert(1, "abc")).
-000156c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000156d0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-000156e0: 4442 2e63 6174 732e 6765 7442 7945 6e74  DB.cats.getByEnt
-000156f0: 7279 2822 6465 6622 292c 205b 5d29 0a20  ry("def"), []). 
-00015700: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00015710: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00015720: 2020 2020 205b 6469 6374 2865 2920 666f       [dict(e) fo
-00015730: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-00015740: 2e63 6174 732e 6765 7442 7945 6e74 7279  .cats.getByEntry
-00015750: 2822 6162 6322 295d 2c0a 2020 2020 2020  ("abc")],.      
-00015760: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-00015770: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00015780: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00015790: 6443 6174 223a 2031 2c0a 2020 2020 2020  dCat": 1,.      
-000157a0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-000157b0: 6172 656e 7443 6174 223a 2030 2c0a 2020  arentCat": 0,.  
-000157c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000157d0: 2020 2264 6573 6372 6970 7469 6f6e 223a    "description":
-000157e0: 2022 5573 6520 7468 6973 2063 6174 6567   "Use this categ
-000157f0: 6f72 7920 746f 2073 746f 7265 2074 6167  ory to store tag
-00015800: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
-00015810: 2020 2020 2020 2020 2b20 2228 7375 6368          + "(such
-00015820: 2061 733a 206f 6e67 6f69 6e67 2070 726f   as: ongoing pro
-00015830: 6a65 6374 732c 2074 656d 706f 7261 7279  jects, temporary
-00015840: 2063 6174 732c 2e2e 2e29 222c 0a20 2020   cats,...)",.   
-00015850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015860: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
-00015870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015880: 2020 2020 2022 6964 456e 4322 3a20 312c       "idEnC": 1,
-00015890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000158a0: 2020 2020 2022 6f72 6422 3a20 302c 0a20       "ord": 0,. 
-000158b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000158c0: 2020 2022 6269 626b 6579 223a 2022 6162     "bibkey": "ab
-000158d0: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
-000158e0: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-000158f0: 2254 6167 7322 2c0a 2020 2020 2020 2020  "Tags",.        
-00015900: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00015910: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00015920: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00015930: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-00015940: 2e70 4244 422e 6361 7473 2e67 6574 4279  .pBDB.cats.getBy
-00015950: 4578 7028 2232 2229 2c20 5b5d 290a 2020  Exp("2"), []).  
-00015960: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00015970: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00015980: 2020 2020 5b64 6963 7428 6529 2066 6f72      [dict(e) for
-00015990: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-000159a0: 6361 7473 2e67 6574 4279 4578 7028 3129  cats.getByExp(1)
-000159b0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
-000159c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000159d0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-000159e0: 2020 2020 2020 2022 6964 4361 7422 3a20         "idCat": 
-000159f0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-00015a00: 2020 2020 2020 2022 6964 4578 7022 3a20         "idExp": 
-00015a10: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-00015a20: 2020 2020 2020 2022 7061 7265 6e74 4361         "parentCa
-00015a30: 7422 3a20 302c 0a20 2020 2020 2020 2020  t": 0,.         
-00015a40: 2020 2020 2020 2020 2020 2022 6465 7363             "desc
-00015a50: 7269 7074 696f 6e22 3a20 2255 7365 2074  ription": "Use t
-00015a60: 6869 7320 6361 7465 676f 7279 2074 6f20  his category to 
-00015a70: 7374 6f72 6520 7461 6773 2022 0a20 2020  store tags ".   
-00015a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a90: 202b 2022 2873 7563 6820 6173 3a20 6f6e   + "(such as: on
-00015aa0: 676f 696e 6720 7072 6f6a 6563 7473 2c20  going projects, 
-00015ab0: 7465 6d70 6f72 6172 7920 6361 7473 2c2e  temporary cats,.
-00015ac0: 2e2e 2922 2c0a 2020 2020 2020 2020 2020  ..)",.          
-00015ad0: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
-00015ae0: 6e74 7322 3a20 2222 2c0a 2020 2020 2020  nts": "",.      
-00015af0: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00015b00: 6445 7843 223a 2031 2c0a 2020 2020 2020  dExC": 1,.      
-00015b10: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-00015b20: 7264 223a 2030 2c0a 2020 2020 2020 2020  rd": 0,.        
-00015b30: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-00015b40: 6522 3a20 2254 6167 7322 2c0a 2020 2020  e": "Tags",.    
-00015b50: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00015b60: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-00015b70: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00015b80: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00015b90: 7365 6c66 2e70 4244 422e 6361 7473 2e67  self.pBDB.cats.g
-00015ba0: 6574 4279 4578 7028 2232 2229 2c20 5b5d  etByExp("2"), []
-00015bb0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00015bc0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00015bd0: 2020 2020 2020 2020 5b64 6963 7428 6529          [dict(e)
-00015be0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00015bf0: 4244 422e 6361 7473 2e67 6574 4279 456e  BDB.cats.getByEn
-00015c00: 7472 6965 7328 5b22 6162 6322 2c20 2264  tries(["abc", "d
-00015c10: 6566 6768 6922 5d29 5d2c 0a20 2020 2020  efghi"])],.     
-00015c20: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00015c30: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-00015c40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00015c50: 6964 4361 7422 3a20 312c 0a20 2020 2020  idCat": 1,.     
-00015c60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00015c70: 7061 7265 6e74 4361 7422 3a20 302c 0a20  parentCat": 0,. 
-00015c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c90: 2020 2022 6465 7363 7269 7074 696f 6e22     "description"
-00015ca0: 3a20 2255 7365 2074 6869 7320 6361 7465  : "Use this cate
-00015cb0: 676f 7279 2074 6f20 7374 6f72 6520 7461  gory to store ta
-00015cc0: 6773 2022 0a20 2020 2020 2020 2020 2020  gs ".           
-00015cd0: 2020 2020 2020 2020 202b 2022 2873 7563           + "(suc
-00015ce0: 6820 6173 3a20 6f6e 676f 696e 6720 7072  h as: ongoing pr
-00015cf0: 6f6a 6563 7473 2c20 7465 6d70 6f72 6172  ojects, temporar
-00015d00: 7920 6361 7473 2c2e 2e2e 2922 2c0a 2020  y cats,...)",.  
-00015d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d20: 2020 2263 6f6d 6d65 6e74 7322 3a20 2222    "comments": ""
-00015d30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015d40: 2020 2020 2020 2269 6445 6e43 223a 2031        "idEnC": 1
-00015d50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015d60: 2020 2020 2020 226f 7264 223a 2030 2c0a        "ord": 0,.
-00015d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d80: 2020 2020 2262 6962 6b65 7922 3a20 2261      "bibkey": "a
-00015d90: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
-00015da0: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
-00015db0: 2022 5461 6773 222c 0a20 2020 2020 2020   "Tags",.       
-00015dc0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00015dd0: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00015de0: 2020 290a 2020 2020 2020 2020 6461 7461    ).        data
-00015df0: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
-00015e00: 732e 7072 6570 6172 6549 6e73 6572 7428  s.prepareInsert(
-00015e10: 0a20 2020 2020 2020 2020 2020 2027 5c6e  .            '\n
-00015e20: 5c6e 2563 6f6d 6d65 6e74 5c6e 4061 7274  \n%comment\n@art
-00015e30: 6963 6c65 7b64 6566 6768 692c 5c6e 6175  icle{defghi,\nau
-00015e40: 7468 6f72 203d 2022 6d65 222c 5c6e 2720  thor = "me",\n' 
-00015e50: 2b20 2774 6974 6c65 203d 2022 7469 746c  + 'title = "titl
-00015e60: 6522 2c7d 272c 0a20 2020 2020 2020 2020  e",}',.         
-00015e70: 2020 2062 6962 6b65 793d 2264 6566 6768     bibkey="defgh
-00015e80: 6922 2c0a 2020 2020 2020 2020 290a 2020  i",.        ).  
-00015e90: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00015ea0: 7454 7275 6528 7365 6c66 2e70 4244 422e  tTrue(self.pBDB.
-00015eb0: 6361 7442 6962 2e69 6e73 6572 7428 302c  catBib.insert(0,
-00015ec0: 2022 6465 6667 6869 2229 290a 2020 2020   "defghi")).    
-00015ed0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00015ee0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00015ef0: 2020 5b64 6963 7428 6529 2066 6f72 2065    [dict(e) for e
-00015f00: 2069 6e20 7365 6c66 2e70 4244 422e 6361   in self.pBDB.ca
-00015f10: 7473 2e67 6574 4279 456e 7472 6965 7328  ts.getByEntries(
-00015f20: 5b22 6162 6322 2c20 2264 6566 6768 6922  ["abc", "defghi"
-00015f30: 5d29 5d2c 0a20 2020 2020 2020 2020 2020  ])],.           
-00015f40: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00015f50: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-00015f60: 2020 2020 2020 2020 2022 6964 4361 7422           "idCat"
-00015f70: 3a20 312c 0a20 2020 2020 2020 2020 2020  : 1,.           
-00015f80: 2020 2020 2020 2020 2022 7061 7265 6e74           "parent
-00015f90: 4361 7422 3a20 302c 0a20 2020 2020 2020  Cat": 0,.       
-00015fa0: 2020 2020 2020 2020 2020 2020 2022 6465               "de
-00015fb0: 7363 7269 7074 696f 6e22 3a20 2255 7365  scription": "Use
-00015fc0: 2074 6869 7320 6361 7465 676f 7279 2074   this category t
-00015fd0: 6f20 7374 6f72 6520 7461 6773 2022 0a20  o store tags ". 
-00015fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ff0: 2020 202b 2022 2873 7563 6820 6173 3a20     + "(such as: 
-00016000: 6f6e 676f 696e 6720 7072 6f6a 6563 7473  ongoing projects
-00016010: 2c20 7465 6d70 6f72 6172 7920 6361 7473  , temporary cats
-00016020: 2c2e 2e2e 2922 2c0a 2020 2020 2020 2020  ,...)",.        
-00016030: 2020 2020 2020 2020 2020 2020 2263 6f6d              "com
-00016040: 6d65 6e74 7322 3a20 2222 2c0a 2020 2020  ments": "",.    
-00016050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016060: 2269 6445 6e43 223a 2031 2c0a 2020 2020  "idEnC": 1,.    
-00016070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016080: 226f 7264 223a 2030 2c0a 2020 2020 2020  "ord": 0,.      
-00016090: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-000160a0: 6962 6b65 7922 3a20 2261 6263 222c 0a20  ibkey": "abc",. 
-000160b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000160c0: 2020 2022 6e61 6d65 223a 2022 5461 6773     "name": "Tags
-000160d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000160e0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-000160f0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-00016100: 2020 2020 2020 2020 2020 2020 2269 6443              "idC
-00016110: 6174 223a 2030 2c0a 2020 2020 2020 2020  at": 0,.        
-00016120: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-00016130: 6522 3a20 224d 6169 6e22 2c0a 2020 2020  e": "Main",.    
-00016140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016150: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
-00016160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016170: 2020 2020 2264 6573 6372 6970 7469 6f6e      "description
-00016180: 223a 2022 5468 6973 2069 7320 7468 6520  ": "This is the 
-00016190: 6d61 696e 2063 6174 6567 6f72 792e 2022  main category. "
-000161a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000161b0: 2020 2020 202b 2022 416c 6c20 7468 6520       + "All the 
-000161c0: 6f74 6865 7220 6f6e 6573 2061 7265 2073  other ones are s
-000161d0: 7562 6361 7465 676f 7269 6573 206f 6620  ubcategories of 
-000161e0: 7468 6973 206f 6e65 222c 0a20 2020 2020  this one",.     
-000161f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00016200: 7061 7265 6e74 4361 7422 3a20 302c 0a20  parentCat": 0,. 
-00016210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016220: 2020 2022 6f72 6422 3a20 302c 0a20 2020     "ord": 0,.   
-00016230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016240: 2022 6964 456e 4322 3a20 322c 0a20 2020   "idEnC": 2,.   
-00016250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016260: 2022 6269 626b 6579 223a 2022 6465 6667   "bibkey": "defg
-00016270: 6869 222c 0a20 2020 2020 2020 2020 2020  hi",.           
-00016280: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00016290: 2020 2020 5d2c 0a20 2020 2020 2020 2029      ],.        )
-000162a0: 0a0a 2020 2020 6465 6620 7465 7374 5f63  ..    def test_c
-000162b0: 6174 5374 7269 6e67 2873 656c 662c 202a  atString(self, *
-000162c0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-000162d0: 2222 5465 7374 2063 6174 5374 7269 6e67  ""Test catString
-000162e0: 2077 6974 6820 6578 6973 7469 6e67 2061   with existing a
-000162f0: 6e64 206e 6f6e 2065 7869 7374 696e 6720  nd non existing 
-00016300: 7265 636f 7264 7322 2222 0a20 2020 2020  records""".     
-00016310: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00016320: 7561 6c28 6361 7453 7472 696e 6728 312c  ual(catString(1,
-00016330: 2073 656c 662e 7042 4442 292c 2022 2020   self.pBDB), "  
-00016340: 2031 3a20 5461 6773 2229 0a20 2020 2020   1: Tags").     
-00016350: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00016360: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00016370: 2063 6174 5374 7269 6e67 2831 2c20 7365   catString(1, se
-00016380: 6c66 2e70 4244 422c 2054 7275 6529 2c0a  lf.pBDB, True),.
-00016390: 2020 2020 2020 2020 2020 2020 2220 2020              "   
-000163a0: 313a 2054 6167 7320 2d20 3c69 3e55 7365  1: Tags - <i>Use
-000163b0: 2074 6869 7320 6361 7465 676f 7279 2074   this category t
-000163c0: 6f20 7374 6f72 6520 7461 6773 2022 0a20  o store tags ". 
-000163d0: 2020 2020 2020 2020 2020 202b 2022 2873             + "(s
-000163e0: 7563 6820 6173 3a20 6f6e 676f 696e 6720  uch as: ongoing 
-000163f0: 7072 6f6a 6563 7473 2c20 7465 6d70 6f72  projects, tempor
-00016400: 6172 7920 6361 7473 2c2e 2e2e 293c 2f69  ary cats,...)</i
-00016410: 3e22 2c0a 2020 2020 2020 2020 290a 2020  >",.        ).  
-00016420: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00016430: 7445 7175 616c 2863 6174 5374 7269 6e67  tEqual(catString
-00016440: 2832 2c20 7365 6c66 2e70 4244 4229 2c20  (2, self.pBDB), 
-00016450: 2222 290a 2020 2020 2020 2020 7769 7468  "").        with
-00016460: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
-00016470: 4c6f 6767 6572 2e77 6172 6e69 6e67 2229  Logger.warning")
-00016480: 2061 7320 5f69 3a0a 2020 2020 2020 2020   as _i:.        
-00016490: 2020 2020 6361 7453 7472 696e 6728 322c      catString(2,
-000164a0: 2073 656c 662e 7042 4442 290a 2020 2020   self.pBDB).    
-000164b0: 2020 2020 2020 2020 5f69 2e61 7373 6572          _i.asser
-000164c0: 745f 616e 795f 6361 6c6c 2822 4361 7465  t_any_call("Cate
-000164d0: 676f 7279 2027 3227 206e 6f74 2069 6e20  gory '2' not in 
-000164e0: 6461 7461 6261 7365 2229 0a0a 2020 2020  database")..    
-000164f0: 6465 6620 7465 7374 5f63 6174 735f 616c  def test_cats_al
-00016500: 7068 6162 6574 6963 616c 2873 656c 662c  phabetical(self,
-00016510: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-00016520: 2022 2222 5465 7374 2061 6c70 6861 6265   """Test alphabe
-00016530: 7469 6361 6c20 6f72 6465 7269 6e67 206f  tical ordering o
-00016540: 6620 6964 4361 7473 2077 6974 6820 6361  f idCats with ca
-00016550: 7473 5f61 6c70 6861 6265 7469 6361 6c22  ts_alphabetical"
-00016560: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
-00016570: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
-00016580: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00016590: 422e 6361 7473 2e69 6e73 6572 7428 0a20  B.cats.insert(. 
-000165a0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-000165b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000165c0: 2020 2020 2022 6e61 6d65 223a 2022 6322       "name": "c"
-000165d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000165e0: 2020 2020 2020 2263 6f6d 6d65 6e74 7322        "comments"
-000165f0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-00016600: 2020 2020 2020 2020 2020 2264 6573 6372            "descr
-00016610: 6970 7469 6f6e 223a 2022 222c 0a20 2020  iption": "",.   
-00016620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016630: 2022 7061 7265 6e74 4361 7422 3a20 2231   "parentCat": "1
-00016640: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00016650: 2020 2020 2020 2022 6f72 6422 3a20 2230         "ord": "0
-00016660: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00016670: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-00016680: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
-00016690: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000166a0: 5472 7565 280a 2020 2020 2020 2020 2020  True(.          
-000166b0: 2020 7365 6c66 2e70 4244 422e 6361 7473    self.pBDB.cats
-000166c0: 2e69 6e73 6572 7428 0a20 2020 2020 2020  .insert(.       
-000166d0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-000166e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000166f0: 6e61 6d65 223a 2022 6722 2c0a 2020 2020  name": "g",.    
-00016700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016710: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
-00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016730: 2020 2020 2264 6573 6372 6970 7469 6f6e      "description
-00016740: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-00016750: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
-00016760: 6e74 4361 7422 3a20 2231 222c 0a20 2020  ntCat": "1",.   
-00016770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016780: 2022 6f72 6422 3a20 2230 222c 0a20 2020   "ord": "0",.   
-00016790: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-000167a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000167b0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-000167c0: 656c 662e 6173 7365 7274 5472 7565 280a  elf.assertTrue(.
-000167d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000167e0: 2e70 4244 422e 6361 7473 2e69 6e73 6572  .pBDB.cats.inser
-000167f0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00016800: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-00016810: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
-00016820: 2022 6422 2c0a 2020 2020 2020 2020 2020   "d",.          
-00016830: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
-00016840: 6e74 7322 3a20 2222 2c0a 2020 2020 2020  nts": "",.      
-00016850: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-00016860: 6573 6372 6970 7469 6f6e 223a 2022 222c  escription": "",
-00016870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016880: 2020 2020 2022 7061 7265 6e74 4361 7422       "parentCat"
-00016890: 3a20 2231 222c 0a20 2020 2020 2020 2020  : "1",.         
-000168a0: 2020 2020 2020 2020 2020 2022 6f72 6422             "ord"
-000168b0: 3a20 2230 222c 0a20 2020 2020 2020 2020  : "0",.         
-000168c0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-000168d0: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-000168e0: 0a20 2020 2020 2020 206c 6973 7449 6420  .        listId 
-000168f0: 3d20 5b61 5b22 6964 4361 7422 5d20 666f  = [a["idCat"] fo
-00016900: 7220 6120 696e 2073 656c 662e 7042 4442  r a in self.pBDB
-00016910: 2e63 6174 732e 6765 7443 6869 6c64 2831  .cats.getChild(1
-00016920: 295d 0a20 2020 2020 2020 2073 656c 662e  )].        self.
-00016930: 6173 7365 7274 4571 7561 6c28 6c69 7374  assertEqual(list
-00016940: 4964 2c20 5b32 2c20 332c 2034 5d29 0a20  Id, [2, 3, 4]). 
-00016950: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00016960: 7274 4571 7561 6c28 6361 7473 5f61 6c70  rtEqual(cats_alp
-00016970: 6861 6265 7469 6361 6c28 6c69 7374 4964  habetical(listId
-00016980: 2c20 7365 6c66 2e70 4244 4229 2c20 5b32  , self.pBDB), [2
-00016990: 2c20 342c 2033 5d29 0a20 2020 2020 2020  , 4, 3]).       
-000169a0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000169b0: 6c28 6361 7473 5f61 6c70 6861 6265 7469  l(cats_alphabeti
-000169c0: 6361 6c28 5b33 2c20 342c 2035 5d2c 2073  cal([3, 4, 5], s
-000169d0: 656c 662e 7042 4442 292c 205b 342c 2033  elf.pBDB), [4, 3
-000169e0: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
-000169f0: 6173 7365 7274 4571 7561 6c28 6361 7473  assertEqual(cats
-00016a00: 5f61 6c70 6861 6265 7469 6361 6c28 5b5d  _alphabetical([]
-00016a10: 2c20 7365 6c66 2e70 4244 4229 2c20 5b5d  , self.pBDB), []
-00016a20: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
-00016a30: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
-00016a40: 6767 6572 2e77 6172 6e69 6e67 2229 2061  gger.warning") a
-00016a50: 7320 5f69 3a0a 2020 2020 2020 2020 2020  s _i:.          
-00016a60: 2020 6361 7473 5f61 6c70 6861 6265 7469    cats_alphabeti
-00016a70: 6361 6c28 5b35 5d2c 2073 656c 662e 7042  cal([5], self.pB
-00016a80: 4442 290a 2020 2020 2020 2020 2020 2020  DB).            
-00016a90: 5f69 2e61 7373 6572 745f 616e 795f 6361  _i.assert_any_ca
-00016aa0: 6c6c 2822 4361 7465 676f 7279 2027 3527  ll("Category '5'
-00016ab0: 206e 6f74 2069 6e20 6461 7461 6261 7365   not in database
-00016ac0: 2229 0a0a 2020 2020 6465 6620 7465 7374  ")..    def test
-00016ad0: 5f68 6965 7261 7263 6879 2873 656c 662c  _hierarchy(self,
-00016ae0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-00016af0: 2022 2222 5465 7374 696e 6720 7468 6520   """Testing the 
-00016b00: 636f 6e73 7472 7563 7469 6f6e 2061 6e64  construction and
-00016b10: 2070 7269 6e74 206f 6620 7468 6520 6361   print of the ca
-00016b20: 7465 676f 7279 2068 6965 7261 7263 6869  tegory hierarchi
-00016b30: 6573 2222 220a 2020 2020 2020 2020 7365  es""".        se
-00016b40: 6c66 2e61 7373 6572 7454 7275 6528 0a20  lf.assertTrue(. 
-00016b50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00016b60: 7042 4442 2e63 6174 732e 696e 7365 7274  pBDB.cats.insert
-00016b70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00016b80: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00016b90: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-00016ba0: 2263 222c 0a20 2020 2020 2020 2020 2020  "c",.           
-00016bb0: 2020 2020 2020 2020 2022 636f 6d6d 656e           "commen
-00016bc0: 7473 223a 2022 222c 0a20 2020 2020 2020  ts": "",.       
-00016bd0: 2020 2020 2020 2020 2020 2020 2022 6465               "de
-00016be0: 7363 7269 7074 696f 6e22 3a20 2231 222c  scription": "1",
-00016bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016c00: 2020 2020 2022 7061 7265 6e74 4361 7422       "parentCat"
-00016c10: 3a20 2231 222c 0a20 2020 2020 2020 2020  : "1",.         
-00016c20: 2020 2020 2020 2020 2020 2022 6f72 6422             "ord"
-00016c30: 3a20 2230 222c 0a20 2020 2020 2020 2020  : "0",.         
-00016c40: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00016c50: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-00016c60: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00016c70: 7365 7274 5472 7565 280a 2020 2020 2020  sertTrue(.      
-00016c80: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00016c90: 6361 7473 2e69 6e73 6572 7428 0a20 2020  cats.insert(.   
-00016ca0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cc0: 2020 2022 6e61 6d65 223a 2022 6422 2c0a     "name": "d",.
-00016cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ce0: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
-00016cf0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-00016d00: 2020 2020 2020 2020 2264 6573 6372 6970          "descrip
-00016d10: 7469 6f6e 223a 2022 3222 2c0a 2020 2020  tion": "2",.    
-00016d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d30: 2270 6172 656e 7443 6174 223a 2022 3222  "parentCat": "2"
-00016d40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016d50: 2020 2020 2020 226f 7264 223a 2022 3022        "ord": "0"
-00016d60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016d70: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00016d80: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00016d90: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00016da0: 7275 6528 0a20 2020 2020 2020 2020 2020  rue(.           
-00016db0: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
-00016dc0: 696e 7365 7274 280a 2020 2020 2020 2020  insert(.        
-00016dd0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00016de0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-00016df0: 616d 6522 3a20 2265 222c 0a20 2020 2020  ame": "e",.     
-00016e00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00016e10: 636f 6d6d 656e 7473 223a 2022 222c 0a20  comments": "",. 
-00016e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e30: 2020 2022 6465 7363 7269 7074 696f 6e22     "description"
-00016e40: 3a20 2233 222c 0a20 2020 2020 2020 2020  : "3",.         
-00016e50: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
-00016e60: 6e74 4361 7422 3a20 2231 222c 0a20 2020  ntCat": "1",.   
-00016e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e80: 2022 6f72 6422 3a20 2230 222c 0a20 2020   "ord": "0",.   
-00016e90: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-00016ea0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00016eb0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00016ec0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00016ed0: 7365 6c66 2e70 4244 422e 6361 7473 2e67  self.pBDB.cats.g
-00016ee0: 6574 4869 6572 2829 2c20 7b30 3a20 7b31  etHier(), {0: {1
-00016ef0: 3a20 7b32 3a20 7b33 3a20 7b7d 7d2c 2034  : {2: {3: {}}, 4
-00016f00: 3a20 7b7d 7d7d 7d29 0a20 2020 2020 2020  : {}}}}).       
-00016f10: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00016f20: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-00016f30: 656c 662e 7042 4442 2e63 6174 732e 6765  elf.pBDB.cats.ge
-00016f40: 7448 6965 7228 7265 706c 6163 653d 4661  tHier(replace=Fa
-00016f50: 6c73 6529 2c20 7b30 3a20 7b31 3a20 7b32  lse), {0: {1: {2
-00016f60: 3a20 7b33 3a20 7b7d 7d2c 2034 3a20 7b7d  : {3: {}}, 4: {}
-00016f70: 7d7d 7d0a 2020 2020 2020 2020 290a 2020  }}}.        ).  
-00016f80: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00016f90: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
-00016fa0: 2e63 6174 732e 6765 7448 6965 7228 7374  .cats.getHier(st
-00016fb0: 6172 7446 726f 6d3d 3229 2c20 7b32 3a20  artFrom=2), {2: 
-00016fc0: 7b33 3a20 7b7d 7d7d 290a 2020 2020 2020  {3: {}}}).      
-00016fd0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00016fe0: 616c 2873 656c 662e 7042 4442 2e63 6174  al(self.pBDB.cat
-00016ff0: 732e 6765 7448 6965 7228 7365 6c66 2e70  s.getHier(self.p
-00017000: 4244 422e 6361 7473 2e67 6574 4368 696c  BDB.cats.getChil
-00017010: 6428 3229 292c 207b 303a 207b 7d7d 290a  d(2)), {0: {}}).
-00017020: 2020 2020 2020 2020 2320 6173 2030 2069          # as 0 i
-00017030: 7320 6e6f 7420 696e 2074 6865 206f 7269  s not in the ori
-00017040: 6769 6e61 6c20 6c69 7374 210a 2020 2020  ginal list!.    
-00017050: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00017060: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00017070: 2020 7365 6c66 2e70 4244 422e 6361 7473    self.pBDB.cats
-00017080: 2e67 6574 4869 6572 2873 656c 662e 7042  .getHier(self.pB
-00017090: 4442 2e63 6174 732e 6765 7443 6869 6c64  DB.cats.getChild
-000170a0: 2832 292c 2073 7461 7274 4672 6f6d 3d32  (2), startFrom=2
-000170b0: 292c 0a20 2020 2020 2020 2020 2020 207b  ),.            {
-000170c0: 323a 207b 333a 207b 7d7d 7d2c 0a20 2020  2: {3: {}}},.   
-000170d0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-000170e0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000170f0: 7365 6c66 2e70 4244 422e 6361 7473 2e67  self.pBDB.cats.g
-00017100: 6574 4869 6572 2829 2c20 7b30 3a20 7b31  etHier(), {0: {1
-00017110: 3a20 7b32 3a20 7b33 3a20 7b7d 7d2c 2034  : {2: {3: {}}, 4
-00017120: 3a20 7b7d 7d7d 7d29 0a20 2020 2020 2020  : {}}}}).       
-00017130: 2073 656c 662e 6173 7365 7274 5f73 7464   self.assert_std
-00017140: 6f75 7428 0a20 2020 2020 2020 2020 2020  out(.           
-00017150: 206c 616d 6264 613a 2073 656c 662e 7042   lambda: self.pB
-00017160: 4442 2e63 6174 732e 7072 696e 7448 6965  DB.cats.printHie
-00017170: 7228 7265 706c 6163 653d 5472 7565 292c  r(replace=True),
-00017180: 0a20 2020 2020 2020 2020 2020 2022 2020  .            "  
-00017190: 2030 3a20 4d61 696e 5c6e 2020 2020 2020   0: Main\n      
-000171a0: 2020 313a 2054 6167 735c 6e20 2020 2020    1: Tags\n     
-000171b0: 2020 2020 2020 2020 220a 2020 2020 2020          ".      
-000171c0: 2020 2020 2020 2b20 2232 3a20 635c 6e20        + "2: c\n 
-000171d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000171e0: 2033 3a20 645c 6e20 2020 2020 2020 2020   3: d\n         
-000171f0: 2020 2020 343a 2065 5c6e 222c 0a20 2020      4: e\n",.   
-00017200: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00017210: 656c 662e 6173 7365 7274 5f73 7464 6f75  elf.assert_stdou
-00017220: 7428 0a20 2020 2020 2020 2020 2020 206c  t(.            l
-00017230: 616d 6264 613a 2073 656c 662e 7042 4442  ambda: self.pBDB
-00017240: 2e63 6174 732e 7072 696e 7448 6965 7228  .cats.printHier(
-00017250: 7265 706c 6163 653d 5472 7565 2c20 7370  replace=True, sp
-00017260: 3d33 202a 2022 2022 292c 0a20 2020 2020  =3 * " "),.     
-00017270: 2020 2020 2020 2022 2020 2030 3a20 4d61         "   0: Ma
-00017280: 696e 5c6e 2020 2020 2020 313a 2054 6167  in\n      1: Tag
-00017290: 735c 6e20 2020 2020 2020 2020 323a 2063  s\n         2: c
-000172a0: 5c6e 2020 2020 2020 2020 2020 2020 220a  \n            ".
-000172b0: 2020 2020 2020 2020 2020 2020 2b20 2233              + "3
-000172c0: 3a20 645c 6e20 2020 2020 2020 2020 343a  : d\n         4:
-000172d0: 2065 5c6e 222c 0a20 2020 2020 2020 2029   e\n",.        )
-000172e0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000172f0: 7365 7274 5f73 7464 6f75 7428 0a20 2020  sert_stdout(.   
-00017300: 2020 2020 2020 2020 206c 616d 6264 613a           lambda:
-00017310: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
-00017320: 7072 696e 7448 6965 7228 7265 706c 6163  printHier(replac
-00017330: 653d 5472 7565 2c20 7374 6172 7446 726f  e=True, startFro
-00017340: 6d3d 322c 2077 6974 6844 6573 633d 5472  m=2, withDesc=Tr
-00017350: 7565 292c 0a20 2020 2020 2020 2020 2020  ue),.           
-00017360: 2022 2020 2032 3a20 6320 2d20 3c69 3e31   "   2: c - <i>1
-00017370: 3c2f 693e 5c6e 2020 2020 2020 2020 333a  </i>\n        3:
-00017380: 2064 202d 203c 693e 323c 2f69 3e5c 6e22   d - <i>2</i>\n"
-00017390: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-000173a0: 2020 2020 7365 6c66 2e61 7373 6572 745f      self.assert_
-000173b0: 7374 646f 7574 280a 2020 2020 2020 2020  stdout(.        
-000173c0: 2020 2020 6c61 6d62 6461 3a20 7365 6c66      lambda: self
-000173d0: 2e70 4244 422e 6361 7473 2e70 7269 6e74  .pBDB.cats.print
-000173e0: 4869 6572 2872 6570 6c61 6365 3d54 7275  Hier(replace=Tru
-000173f0: 652c 2064 6570 7468 3d32 292c 0a20 2020  e, depth=2),.   
-00017400: 2020 2020 2020 2020 2022 2020 2030 3a20           "   0: 
-00017410: 4d61 696e 5c6e 2020 2020 2020 2020 313a  Main\n        1:
-00017420: 2054 6167 735c 6e20 2020 2020 2020 2020   Tags\n         
-00017430: 2020 2020 323a 2063 5c6e 2020 2020 2020      2: c\n      
-00017440: 2020 2020 2020 2034 3a20 655c 6e22 2c0a         4: e\n",.
-00017450: 2020 2020 2020 2020 290a 0a0a 4075 6e69          )...@uni
-00017460: 7474 6573 742e 736b 6970 4966 2873 6b69  ttest.skipIf(ski
-00017470: 7054 6573 7473 5365 7474 696e 6773 2e64  pTestsSettings.d
-00017480: 622c 2022 4461 7461 6261 7365 2074 6573  b, "Database tes
-00017490: 7473 2229 0a40 7061 7463 6828 226c 6f67  ts").@patch("log
-000174a0: 6769 6e67 2e4c 6f67 6765 722e 6465 6275  ging.Logger.debu
-000174b0: 6722 290a 4070 6174 6368 2822 6c6f 6767  g").@patch("logg
-000174c0: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
-000174d0: 290a 4070 6174 6368 2822 6c6f 6767 696e  ).@patch("loggin
-000174e0: 672e 4c6f 6767 6572 2e77 6172 6e69 6e67  g.Logger.warning
-000174f0: 2229 0a40 7061 7463 6828 226c 6f67 6769  ").@patch("loggi
-00017500: 6e67 2e4c 6f67 6765 722e 6572 726f 7222  ng.Logger.error"
-00017510: 290a 4070 6174 6368 2822 6c6f 6767 696e  ).@patch("loggin
-00017520: 672e 4c6f 6767 6572 2e65 7863 6570 7469  g.Logger.excepti
-00017530: 6f6e 2229 0a63 6c61 7373 2054 6573 7444  on").class TestD
-00017540: 6174 6162 6173 6545 6e74 7269 6573 2844  atabaseEntries(D
-00017550: 4254 6573 7443 6173 6529 3a0a 2020 2020  BTestCase):.    
-00017560: 2222 2254 6573 7473 2066 6f72 2074 6865  """Tests for the
-00017570: 206d 6574 686f 6473 2069 6e20 7468 6520   methods in the 
-00017580: 656e 7472 6965 7320 7375 6263 6c61 7373  entries subclass
-00017590: 2222 220a 0a20 2020 2064 6566 2069 6e73  """..    def ins
-000175a0: 6572 745f 7468 7265 6528 7365 6c66 293a  ert_three(self):
-000175b0: 0a20 2020 2020 2020 2022 2222 496e 7365  .        """Inse
-000175c0: 7274 2074 6872 6565 2065 6c65 6d65 6e74  rt three element
-000175d0: 7320 696e 2074 6865 2044 4220 666f 7220  s in the DB for 
-000175e0: 7465 7374 696e 6722 2222 0a20 2020 2020  testing""".     
-000175f0: 2020 2064 6174 6120 3d20 7365 6c66 2e70     data = self.p
-00017600: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
-00017610: 496e 7365 7274 280a 2020 2020 2020 2020  Insert(.        
-00017620: 2020 2020 2740 6172 7469 636c 657b 6162      '@article{ab
-00017630: 632c 5c6e 6175 7468 6f72 203d 2022 6d65  c,\nauthor = "me
-00017640: 222c 5c6e 7469 746c 6520 3d20 2261 6263  ",\ntitle = "abc
-00017650: 222c 7d27 2c20 6172 7869 763d 2261 6263  ",}', arxiv="abc
-00017660: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-00017670: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00017680: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
-00017690: 6273 2e69 6e73 6572 7428 6461 7461 2929  bs.insert(data))
-000176a0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-000176b0: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
-000176c0: 7265 7061 7265 496e 7365 7274 280a 2020  repareInsert(.  
-000176d0: 2020 2020 2020 2020 2020 2740 6172 7469            '@arti
-000176e0: 636c 657b 6465 662c 5c6e 6175 7468 6f72  cle{def,\nauthor
-000176f0: 203d 2022 6d65 222c 5c6e 7469 746c 6520   = "me",\ntitle 
-00017700: 3d20 2264 6566 222c 7d27 2c20 6172 7869  = "def",}', arxi
-00017710: 763d 2264 6566 220a 2020 2020 2020 2020  v="def".        
-00017720: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00017730: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-00017740: 4244 422e 6269 6273 2e69 6e73 6572 7428  BDB.bibs.insert(
-00017750: 6461 7461 2929 0a20 2020 2020 2020 2064  data)).        d
-00017760: 6174 6120 3d20 7365 6c66 2e70 4244 422e  ata = self.pBDB.
-00017770: 6269 6273 2e70 7265 7061 7265 496e 7365  bibs.prepareInse
-00017780: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
-00017790: 2740 6172 7469 636c 657b 6768 692c 5c6e  '@article{ghi,\n
-000177a0: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
-000177b0: 7469 746c 6520 3d20 2267 6869 222c 7d27  title = "ghi",}'
-000177c0: 2c20 6172 7869 763d 2267 6869 220a 2020  , arxiv="ghi".  
-000177d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000177e0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-000177f0: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
-00017800: 6e73 6572 7428 6461 7461 2929 0a0a 2020  nsert(data))..  
-00017810: 2020 6465 6620 7465 7374 5f63 6174 4578    def test_catEx
-00017820: 7053 7472 696e 6773 2873 656c 662c 202a  pStrings(self, *
-00017830: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00017840: 2222 7465 7374 205f 6361 7445 7870 5374  ""test _catExpSt
-00017850: 7269 6e67 7322 2222 0a20 2020 2020 2020  rings""".       
-00017860: 206a 432c 2077 432c 2076 4320 3d20 7365   jC, wC, vC = se
-00017870: 6c66 2e70 4244 422e 6269 6273 2e5f 6361  lf.pBDB.bibs._ca
-00017880: 7445 7870 5374 7269 6e67 7328 0a20 2020  tExpStrings(.   
-00017890: 2020 2020 2020 2020 205b 312c 2032 5d2c           [1, 2],
-000178a0: 2022 616c 6c20 7468 6520 666f 6c6c 6f77   "all the follow
-000178b0: 696e 6722 2c20 2265 6e74 7279 4361 7473  ing", "entryCats
-000178c0: 222c 2022 6964 4361 7422 0a20 2020 2020  ", "idCat".     
-000178d0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-000178e0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-000178f0: 2020 2020 2020 2020 2020 206a 432c 0a20             jC,. 
-00017900: 2020 2020 2020 2020 2020 2022 206c 6566             " lef
-00017910: 7420 6a6f 696e 2065 6e74 7279 4361 7473  t join entryCats
-00017920: 2065 6e74 7279 4361 7473 3020 6f6e 2065   entryCats0 on e
-00017930: 6e74 7269 6573 2e62 6962 6b65 793d 656e  ntries.bibkey=en
-00017940: 7472 7943 6174 7330 2e62 6962 6b65 7922  tryCats0.bibkey"
-00017950: 0a20 2020 2020 2020 2020 2020 202b 2022  .            + "
-00017960: 2020 6c65 6674 206a 6f69 6e20 656e 7472    left join entr
-00017970: 7943 6174 7320 656e 7472 7943 6174 7331  yCats entryCats1
-00017980: 206f 6e20 656e 7472 6965 732e 6269 626b   on entries.bibk
-00017990: 6579 3d65 6e74 7279 4361 7473 312e 6269  ey=entryCats1.bi
-000179a0: 626b 6579 222c 0a20 2020 2020 2020 2029  bkey",.        )
-000179b0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000179c0: 7365 7274 4571 7561 6c28 7743 2c20 2228  sertEqual(wC, "(
-000179d0: 656e 7472 7943 6174 7330 2e69 6443 6174  entryCats0.idCat
-000179e0: 203d 203f 2061 6e64 2065 6e74 7279 4361   = ? and entryCa
-000179f0: 7473 312e 6964 4361 7420 3d20 3f29 2229  ts1.idCat = ?)")
-00017a00: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00017a10: 7365 7274 4571 7561 6c28 7643 2c20 2822  sertEqual(vC, ("
-00017a20: 3122 2c20 2232 2229 290a 2020 2020 2020  1", "2")).      
-00017a30: 2020 6a43 2c20 7743 2c20 7643 203d 2073    jC, wC, vC = s
-00017a40: 656c 662e 7042 4442 2e62 6962 732e 5f63  elf.pBDB.bibs._c
-00017a50: 6174 4578 7053 7472 696e 6773 280a 2020  atExpStrings(.  
-00017a60: 2020 2020 2020 2020 2020 5b31 2c20 325d            [1, 2]
-00017a70: 2c20 2261 7420 6c65 6173 7420 6f6e 6520  , "at least one 
-00017a80: 616d 6f6e 6722 2c20 2265 6e74 7279 4361  among", "entryCa
-00017a90: 7473 222c 2022 6964 4361 7422 0a20 2020  ts", "idCat".   
-00017aa0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00017ab0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00017ac0: 6a43 2c20 2220 6c65 6674 206a 6f69 6e20  jC, " left join 
-00017ad0: 656e 7472 7943 6174 7320 6f6e 2065 6e74  entryCats on ent
-00017ae0: 7269 6573 2e62 6962 6b65 793d 656e 7472  ries.bibkey=entr
-00017af0: 7943 6174 732e 6269 626b 6579 2229 0a20  yCats.bibkey"). 
-00017b00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00017b10: 7274 4571 7561 6c28 7743 2c20 2228 2065  rtEqual(wC, "( e
-00017b20: 6e74 7279 4361 7473 2e69 6443 6174 203d  ntryCats.idCat =
-00017b30: 203f 206f 7220 656e 7472 7943 6174 732e   ? or entryCats.
-00017b40: 6964 4361 7420 3d20 3f20 2922 290a 2020  idCat = ? )").  
-00017b50: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00017b60: 7445 7175 616c 2876 432c 2028 2231 222c  tEqual(vC, ("1",
-00017b70: 2022 3222 2929 0a20 2020 2020 2020 206a   "2")).        j
-00017b80: 432c 2077 432c 2076 4320 3d20 7365 6c66  C, wC, vC = self
-00017b90: 2e70 4244 422e 6269 6273 2e5f 6361 7445  .pBDB.bibs._catE
-00017ba0: 7870 5374 7269 6e67 7328 0a20 2020 2020  xpStrings(.     
-00017bb0: 2020 2020 2020 205b 312c 2032 5d2c 2022         [1, 2], "
-00017bc0: 7261 6e64 6f6d 222c 2022 656e 7472 7943  random", "entryC
-00017bd0: 6174 7322 2c20 2269 6443 6174 220a 2020  ats", "idCat".  
-00017be0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00017bf0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00017c00: 286a 432c 2022 2229 0a20 2020 2020 2020  (jC, "").       
-00017c10: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00017c20: 6c28 7743 2c20 2222 290a 2020 2020 2020  l(wC, "").      
-00017c30: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00017c40: 616c 2876 432c 2028 2929 0a20 2020 2020  al(vC, ()).     
-00017c50: 2020 206a 432c 2077 432c 2076 4320 3d20     jC, wC, vC = 
-00017c60: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
-00017c70: 6361 7445 7870 5374 7269 6e67 7328 312c  catExpStrings(1,
-00017c80: 2022 7261 6e64 6f6d 222c 2022 656e 7472   "random", "entr
-00017c90: 7945 7870 7322 2c20 2269 6445 7870 2229  yExps", "idExp")
-00017ca0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00017cb0: 7365 7274 4571 7561 6c28 6a43 2c20 2220  sertEqual(jC, " 
-00017cc0: 6c65 6674 206a 6f69 6e20 656e 7472 7945  left join entryE
-00017cd0: 7870 7320 6f6e 2065 6e74 7269 6573 2e62  xps on entries.b
-00017ce0: 6962 6b65 793d 656e 7472 7945 7870 732e  ibkey=entryExps.
-00017cf0: 6269 626b 6579 2229 0a20 2020 2020 2020  bibkey").       
-00017d00: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00017d10: 6c28 7743 2c20 2265 6e74 7279 4578 7073  l(wC, "entryExps
-00017d20: 2e69 6445 7870 203d 203f 2022 290a 2020  .idExp = ? ").  
-00017d30: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00017d40: 7445 7175 616c 2876 432c 2028 2231 222c  tEqual(vC, ("1",
-00017d50: 2929 0a0a 2020 2020 6465 6620 7465 7374  ))..    def test
-00017d60: 5f67 6574 5175 6572 7953 7472 2873 656c  _getQueryStr(sel
-00017d70: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
-00017d80: 2020 2022 2222 7465 7374 205f 6765 7451     """test _getQ
-00017d90: 7565 7279 5374 7222 2222 0a20 2020 2020  ueryStr""".     
-00017da0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00017db0: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
-00017dc0: 6273 2e5f 6765 7451 7565 7279 5374 7228  bs._getQueryStr(
-00017dd0: 2261 6263 222c 2022 6e6f 6122 292c 2022  "abc", "noa"), "
-00017de0: 6162 6322 290a 2020 2020 2020 2020 7365  abc").        se
-00017df0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-00017e00: 656c 662e 7042 4442 2e62 6962 732e 5f67  elf.pBDB.bibs._g
-00017e10: 6574 5175 6572 7953 7472 2822 6162 6322  etQueryStr("abc"
-00017e20: 2c20 226c 6f67 6c69 6b65 6d22 292c 2022  , "loglikem"), "
-00017e30: 2561 6263 2522 290a 0a20 2020 2064 6566  %abc%")..    def
-00017e40: 2074 6573 745f 7072 6570 6172 6549 6e73   test_prepareIns
-00017e50: 6572 7441 7278 6976 2873 656c 662c 202a  ertArxiv(self, *
-00017e60: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00017e70: 2222 7465 7374 205f 7072 6570 6172 6549  ""test _prepareI
-00017e80: 6e73 6572 7441 7278 6976 2222 220a 2020  nsertArxiv""".  
-00017e90: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00017ea0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00017eb0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00017ec0: 6273 2e5f 7072 6570 6172 6549 6e73 6572  bs._prepareInser
-00017ed0: 7441 7278 6976 287b 7d2c 207b 7d2c 204e  tArxiv({}, {}, N
-00017ee0: 6f6e 6529 2c20 7b22 6172 7869 7622 3a20  one), {"arxiv": 
-00017ef0: 2222 7d0a 2020 2020 2020 2020 290a 2020  ""}.        ).  
-00017f00: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00017f10: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
-00017f20: 2e62 6962 732e 5f70 7265 7061 7265 496e  .bibs._prepareIn
-00017f30: 7365 7274 4172 7869 7628 7b7d 2c20 7b7d  sertArxiv({}, {}
-00017f40: 2c20 2222 292c 207b 2261 7278 6976 223a  , ""), {"arxiv":
-00017f50: 2022 227d 290a 2020 2020 2020 2020 7365   ""}).        se
-00017f60: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00017f70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017f80: 2e70 4244 422e 6269 6273 2e5f 7072 6570  .pBDB.bibs._prep
-00017f90: 6172 6549 6e73 6572 7441 7278 6976 280a  areInsertArxiv(.
-00017fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fb0: 7b22 6172 7869 7622 3a20 2231 3233 227d  {"arxiv": "123"}
-00017fc0: 2c20 7b22 6172 7869 7622 3a20 2231 3131  , {"arxiv": "111
-00017fd0: 222c 2022 6570 7269 6e74 223a 2022 3232  ", "eprint": "22
-00017fe0: 3222 7d2c 2022 6162 6322 0a20 2020 2020  2"}, "abc".     
-00017ff0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00018000: 2020 2020 2020 7b22 6172 7869 7622 3a20        {"arxiv": 
-00018010: 2261 6263 227d 2c0a 2020 2020 2020 2020  "abc"},.        
-00018020: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00018030: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00018040: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00018050: 422e 6269 6273 2e5f 7072 6570 6172 6549  B.bibs._prepareI
-00018060: 6e73 6572 7441 7278 6976 280a 2020 2020  nsertArxiv(.    
-00018070: 2020 2020 2020 2020 2020 2020 7b22 6172              {"ar
-00018080: 7869 7622 3a20 2231 3233 227d 2c20 7b22  xiv": "123"}, {"
-00018090: 6172 7869 7622 3a20 2231 3131 222c 2022  arxiv": "111", "
-000180a0: 6570 7269 6e74 223a 2022 3232 3222 7d2c  eprint": "222"},
-000180b0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-000180c0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-000180d0: 207b 2261 7278 6976 223a 2022 3131 3122   {"arxiv": "111"
-000180e0: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-000180f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00018100: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00018110: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00018120: 732e 5f70 7265 7061 7265 496e 7365 7274  s._prepareInsert
-00018130: 4172 7869 7628 0a20 2020 2020 2020 2020  Arxiv(.         
-00018140: 2020 2020 2020 207b 2261 7278 6976 223a         {"arxiv":
-00018150: 2022 3132 3322 7d2c 207b 2265 7072 696e   "123"}, {"eprin
-00018160: 7422 3a20 2232 3232 227d 2c20 6172 7869  t": "222"}, arxi
-00018170: 763d 4e6f 6e65 0a20 2020 2020 2020 2020  v=None.         
-00018180: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-00018190: 2020 7b22 6172 7869 7622 3a20 2232 3232    {"arxiv": "222
-000181a0: 227d 2c0a 2020 2020 2020 2020 290a 2020  "},.        ).  
-000181b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000181c0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-000181d0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-000181e0: 6273 2e5f 7072 6570 6172 6549 6e73 6572  bs._prepareInser
-000181f0: 7441 7278 6976 280a 2020 2020 2020 2020  tArxiv(.        
-00018200: 2020 2020 2020 2020 7b22 6172 7869 7622          {"arxiv"
-00018210: 3a20 2231 3233 227d 2c0a 2020 2020 2020  : "123"},.      
-00018220: 2020 2020 2020 2020 2020 7b22 6570 7269            {"epri
-00018230: 6e74 223a 2022 3232 3222 7d2c 0a20 2020  nt": "222"},.   
-00018240: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-00018250: 2020 2020 2020 2020 7b22 6172 7869 7622          {"arxiv"
-00018260: 3a20 2232 3232 227d 2c0a 2020 2020 2020  : "222"},.      
-00018270: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-00018280: 745f 7072 6570 6172 6549 6e73 6572 7442  t_prepareInsertB
-00018290: 6173 6963 2873 656c 662c 202a 6172 6773  asic(self, *args
-000182a0: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
-000182b0: 7374 205f 7072 6570 6172 6549 6e73 6572  st _prepareInser
-000182c0: 7442 6173 6963 2222 220a 2020 2020 2020  tBasic""".      
-000182d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000182e0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-000182f0: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
-00018300: 7072 6570 6172 6549 6e73 6572 7442 6173  prepareInsertBas
-00018310: 6963 287b 7d2c 207b 7d2c 204e 6f6e 6529  ic({}, {}, None)
-00018320: 2c0a 2020 2020 2020 2020 2020 2020 287b  ,.            ({
-00018330: 2262 6962 6b65 7922 3a20 2222 7d2c 207b  "bibkey": ""}, {
-00018340: 2249 4422 3a20 2222 7d29 2c0a 2020 2020  "ID": ""}),.    
-00018350: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00018360: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00018370: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00018380: 2e70 4244 422e 6269 6273 2e5f 7072 6570  .pBDB.bibs._prep
-00018390: 6172 6549 6e73 6572 7442 6173 6963 287b  areInsertBasic({
-000183a0: 7d2c 207b 2249 4422 3a20 4e6f 6e65 7d2c  }, {"ID": None},
-000183b0: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
-000183c0: 2020 2020 287b 2262 6962 6b65 7922 3a20      ({"bibkey": 
-000183d0: 2222 7d2c 207b 2249 4422 3a20 2222 7d29  ""}, {"ID": ""})
-000183e0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-000183f0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00018400: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00018410: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00018420: 2e5f 7072 6570 6172 6549 6e73 6572 7442  ._prepareInsertB
-00018430: 6173 6963 287b 7d2c 207b 2249 4422 3a20  asic({}, {"ID": 
-00018440: 2261 6263 227d 2c20 6269 626b 6579 3d4e  "abc"}, bibkey=N
-00018450: 6f6e 6529 2c0a 2020 2020 2020 2020 2020  one),.          
-00018460: 2020 287b 2262 6962 6b65 7922 3a20 2261    ({"bibkey": "a
-00018470: 6263 227d 2c20 7b22 4944 223a 2022 6162  bc"}, {"ID": "ab
-00018480: 6322 7d29 2c0a 2020 2020 2020 2020 290a  c"}),.        ).
-00018490: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000184a0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-000184b0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-000184c0: 6269 6273 2e5f 7072 6570 6172 6549 6e73  bibs._prepareIns
-000184d0: 6572 7442 6173 6963 287b 7d2c 207b 2249  ertBasic({}, {"I
-000184e0: 4422 3a20 2261 6263 227d 292c 0a20 2020  D": "abc"}),.   
-000184f0: 2020 2020 2020 2020 2028 7b22 6269 626b           ({"bibk
-00018500: 6579 223a 2022 6162 6322 7d2c 207b 2249  ey": "abc"}, {"I
-00018510: 4422 3a20 2261 6263 227d 292c 0a20 2020  D": "abc"}),.   
-00018520: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00018530: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00018540: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00018550: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
-00018560: 7061 7265 496e 7365 7274 4261 7369 6328  pareInsertBasic(
-00018570: 7b7d 2c20 7b22 4944 223a 2022 6162 6322  {}, {"ID": "abc"
-00018580: 7d2c 2022 2229 2c0a 2020 2020 2020 2020  }, ""),.        
-00018590: 2020 2020 287b 2262 6962 6b65 7922 3a20      ({"bibkey": 
-000185a0: 2261 6263 227d 2c20 7b22 4944 223a 2022  "abc"}, {"ID": "
-000185b0: 6162 6322 7d29 2c0a 2020 2020 2020 2020  abc"}),.        
-000185c0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000185d0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-000185e0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-000185f0: 422e 6269 6273 2e5f 7072 6570 6172 6549  B.bibs._prepareI
-00018600: 6e73 6572 7442 6173 6963 287b 7d2c 207b  nsertBasic({}, {
-00018610: 2249 4422 3a20 2261 6263 227d 2c20 2264  "ID": "abc"}, "d
-00018620: 6566 2229 2c0a 2020 2020 2020 2020 2020  ef"),.          
-00018630: 2020 287b 2262 6962 6b65 7922 3a20 2264    ({"bibkey": "d
-00018640: 6566 227d 2c20 7b22 4944 223a 2022 6465  ef"}, {"ID": "de
-00018650: 6622 7d29 2c0a 2020 2020 2020 2020 290a  f"}),.        ).
-00018660: 0a20 2020 2064 6566 2074 6573 745f 7072  .    def test_pr
-00018670: 6570 6172 6549 6e73 6572 7443 6974 2873  epareInsertCit(s
-00018680: 656c 662c 202a 6172 6773 293a 0a20 2020  elf, *args):.   
-00018690: 2020 2020 2022 2222 7465 7374 205f 7072       """test _pr
-000186a0: 6570 6172 6549 6e73 6572 7443 6974 2222  epareInsertCit""
-000186b0: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-000186c0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-000186d0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-000186e0: 422e 6269 6273 2e5f 7072 6570 6172 6549  B.bibs._prepareI
-000186f0: 6e73 6572 7443 6974 287b 7d2c 204e 6f6e  nsertCit({}, Non
-00018700: 652c 204e 6f6e 6529 2c0a 2020 2020 2020  e, None),.      
-00018710: 2020 2020 2020 7b22 6369 7461 7469 6f6e        {"citation
-00018720: 7322 3a20 302c 2022 6369 7461 7469 6f6e  s": 0, "citation
-00018730: 735f 6e6f 5f73 656c 6622 3a20 307d 2c0a  s_no_self": 0},.
-00018740: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00018750: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00018760: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00018770: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
-00018780: 7072 6570 6172 6549 6e73 6572 7443 6974  prepareInsertCit
-00018790: 287b 7d2c 2022 222c 204e 6f6e 6529 2c0a  ({}, "", None),.
-000187a0: 2020 2020 2020 2020 2020 2020 7b22 6369              {"ci
-000187b0: 7461 7469 6f6e 7322 3a20 302c 2022 6369  tations": 0, "ci
-000187c0: 7461 7469 6f6e 735f 6e6f 5f73 656c 6622  tations_no_self"
-000187d0: 3a20 307d 2c0a 2020 2020 2020 2020 290a  : 0},.        ).
-000187e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000187f0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00018800: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00018810: 6269 6273 2e5f 7072 6570 6172 6549 6e73  bibs._prepareIns
-00018820: 6572 7443 6974 287b 7d2c 204e 6f6e 652c  ertCit({}, None,
-00018830: 2022 2229 2c0a 2020 2020 2020 2020 2020   ""),.          
-00018840: 2020 7b22 6369 7461 7469 6f6e 7322 3a20    {"citations": 
-00018850: 302c 2022 6369 7461 7469 6f6e 735f 6e6f  0, "citations_no
-00018860: 5f73 656c 6622 3a20 307d 2c0a 2020 2020  _self": 0},.    
-00018870: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00018880: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00018890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000188a0: 2e70 4244 422e 6269 6273 2e5f 7072 6570  .pBDB.bibs._prep
-000188b0: 6172 6549 6e73 6572 7443 6974 287b 7d2c  areInsertCit({},
-000188c0: 2022 3122 2c20 4e6f 6e65 292c 0a20 2020   "1", None),.   
-000188d0: 2020 2020 2020 2020 207b 2263 6974 6174           {"citat
-000188e0: 696f 6e73 223a 2031 2c20 2263 6974 6174  ions": 1, "citat
-000188f0: 696f 6e73 5f6e 6f5f 7365 6c66 223a 2030  ions_no_self": 0
-00018900: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-00018910: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00018920: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00018930: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00018940: 732e 5f70 7265 7061 7265 496e 7365 7274  s._prepareInsert
-00018950: 4369 7428 7b7d 2c20 4e6f 6e65 2c20 2231  Cit({}, None, "1
-00018960: 3222 292c 0a20 2020 2020 2020 2020 2020  2"),.           
-00018970: 207b 2263 6974 6174 696f 6e73 223a 2030   {"citations": 0
-00018980: 2c20 2263 6974 6174 696f 6e73 5f6e 6f5f  , "citations_no_
-00018990: 7365 6c66 223a 2031 327d 2c0a 2020 2020  self": 12},.    
-000189a0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-000189b0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-000189c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000189d0: 2e70 4244 422e 6269 6273 2e5f 7072 6570  .pBDB.bibs._prep
-000189e0: 6172 6549 6e73 6572 7443 6974 287b 7d2c  areInsertCit({},
-000189f0: 2022 6122 2c20 3131 2e33 292c 0a20 2020   "a", 11.3),.   
-00018a00: 2020 2020 2020 2020 207b 2263 6974 6174           {"citat
-00018a10: 696f 6e73 223a 2030 2c20 2263 6974 6174  ions": 0, "citat
-00018a20: 696f 6e73 5f6e 6f5f 7365 6c66 223a 2031  ions_no_self": 1
-00018a30: 317d 2c0a 2020 2020 2020 2020 290a 2020  1},.        ).  
-00018a40: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00018a50: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00018a60: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00018a70: 6273 2e5f 7072 6570 6172 6549 6e73 6572  bs._prepareInser
-00018a80: 7443 6974 287b 7d2c 2031 322c 2022 3131  tCit({}, 12, "11
-00018a90: 6122 292c 0a20 2020 2020 2020 2020 2020  a"),.           
-00018aa0: 207b 2263 6974 6174 696f 6e73 223a 2031   {"citations": 1
-00018ab0: 322c 2022 6369 7461 7469 6f6e 735f 6e6f  2, "citations_no
-00018ac0: 5f73 656c 6622 3a20 307d 2c0a 2020 2020  _self": 0},.    
-00018ad0: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
-00018ae0: 6573 745f 7072 6570 6172 6549 6e73 6572  est_prepareInser
-00018af0: 7444 6963 7428 7365 6c66 2c20 2a61 7267  tDict(self, *arg
-00018b00: 7329 3a0a 2020 2020 2020 2020 2222 2274  s):.        """t
-00018b10: 6573 7420 5f70 7265 7061 7265 496e 7365  est _prepareInse
-00018b20: 7274 4469 6374 2222 220a 2020 2020 2020  rtDict""".      
-00018b30: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00018b40: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00018b50: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
-00018b60: 7072 6570 6172 6549 6e73 6572 7444 6963  prepareInsertDic
-00018b70: 7428 7b7d 292c 0a20 2020 2020 2020 2020  t({}),.         
-00018b80: 2020 207b 2262 6962 6469 6374 223a 207b     {"bibdict": {
-00018b90: 7d7d 2c0a 2020 2020 2020 2020 290a 2020  }},.        ).  
-00018ba0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00018bb0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00018bc0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00018bd0: 6273 2e5f 7072 6570 6172 6549 6e73 6572  bs._prepareInser
-00018be0: 7444 6963 7428 7b22 6269 6274 6578 223a  tDict({"bibtex":
-00018bf0: 2022 227d 292c 0a20 2020 2020 2020 2020   ""}),.         
-00018c00: 2020 207b 2262 6962 6469 6374 223a 207b     {"bibdict": {
-00018c10: 7d2c 2022 6269 6274 6578 223a 2022 227d  }, "bibtex": ""}
-00018c20: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00018c30: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00018c40: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00018c50: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00018c60: 2e5f 7072 6570 6172 6549 6e73 6572 7444  ._prepareInsertD
-00018c70: 6963 7428 7b22 6269 6274 6578 223a 2022  ict({"bibtex": "
-00018c80: 4061 7274 6963 6c65 7b2c 227d 292c 0a20  @article{,"}),. 
-00018c90: 2020 2020 2020 2020 2020 207b 2262 6962             {"bib
-00018ca0: 6469 6374 223a 207b 7d2c 2022 6269 6274  dict": {}, "bibt
-00018cb0: 6578 223a 2022 4061 7274 6963 6c65 7b2c  ex": "@article{,
-00018cc0: 227d 2c0a 2020 2020 2020 2020 290a 2020  "},.        ).  
-00018cd0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00018ce0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00018cf0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00018d00: 6273 2e5f 7072 6570 6172 6549 6e73 6572  bs._prepareInser
-00018d10: 7444 6963 7428 0a20 2020 2020 2020 2020  tDict(.         
-00018d20: 2020 2020 2020 207b 2262 6962 7465 7822         {"bibtex"
-00018d30: 3a20 2740 6172 7469 636c 657b 6162 632c  : '@article{abc,
-00018d40: 5c6e 6175 7468 6f72 3d22 6d65 222c 5c6e  \nauthor="me",\n
-00018d50: 7469 746c 653d 2274 6974 6c65 222c 5c6e  title="title",\n
-00018d60: 7d5c 6e27 7d0a 2020 2020 2020 2020 2020  }\n'}.          
-00018d70: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-00018d80: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00018d90: 2020 2022 6269 6264 6963 7422 3a20 7b0a     "bibdict": {.
-00018da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018db0: 2020 2020 2245 4e54 5259 5459 5045 223a      "ENTRYTYPE":
-00018dc0: 2022 6172 7469 636c 6522 2c0a 2020 2020   "article",.    
-00018dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018de0: 2249 4422 3a20 2261 6263 222c 0a20 2020  "ID": "abc",.   
-00018df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e00: 2022 6175 7468 6f72 223a 2022 6d65 222c   "author": "me",
-00018e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018e20: 2020 2020 2022 7469 746c 6522 3a20 2274       "title": "t
-00018e30: 6974 6c65 222c 0a20 2020 2020 2020 2020  itle",.         
-00018e40: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00018e50: 2020 2020 2020 2020 2020 2262 6962 7465            "bibte
-00018e60: 7822 3a20 2740 6172 7469 636c 657b 6162  x": '@article{ab
-00018e70: 632c 5c6e 6175 7468 6f72 3d22 6d65 222c  c,\nauthor="me",
-00018e80: 5c6e 7469 746c 653d 2274 6974 6c65 222c  \ntitle="title",
-00018e90: 5c6e 7d5c 6e27 2c0a 2020 2020 2020 2020  \n}\n',.        
-00018ea0: 2020 2020 7d2c 0a20 2020 2020 2020 2029      },.        )
-00018eb0: 0a0a 2020 2020 6465 6620 7465 7374 5f70  ..    def test_p
-00018ec0: 7265 7061 7265 496e 7365 7274 4669 6c6c  repareInsertFill
-00018ed0: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-00018ee0: 2020 2020 2020 2022 2222 7465 7374 205f         """test _
-00018ef0: 7072 6570 6172 6549 6e73 6572 7446 696c  prepareInsertFil
-00018f00: 6c22 2222 0a20 2020 2020 2020 2077 6974  l""".        wit
-00018f10: 6820 7365 6c66 2e61 7373 6572 7452 6169  h self.assertRai
-00018f20: 7365 7328 4b65 7945 7272 6f72 293a 0a20  ses(KeyError):. 
-00018f30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00018f40: 7042 4442 2e62 6962 732e 5f70 7265 7061  pBDB.bibs._prepa
-00018f50: 7265 496e 7365 7274 4669 6c6c 287b 7d29  reInsertFill({})
-00018f60: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00018f70: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00018f80: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00018f90: 2e62 6962 732e 5f70 7265 7061 7265 496e  .bibs._prepareIn
-00018fa0: 7365 7274 4669 6c6c 287b 2262 6962 6469  sertFill({"bibdi
-00018fb0: 6374 223a 207b 7d7d 292c 0a20 2020 2020  ct": {}}),.     
-00018fc0: 2020 2020 2020 207b 2262 6962 6469 6374         {"bibdict
-00018fd0: 223a 207b 7d7d 2c0a 2020 2020 2020 2020  ": {}},.        
-00018fe0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00018ff0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00019000: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00019010: 422e 6269 6273 2e5f 7072 6570 6172 6549  B.bibs._prepareI
-00019020: 6e73 6572 7446 696c 6c28 7b22 6269 6264  nsertFill({"bibd
-00019030: 6963 7422 3a20 7b7d 2c20 2261 7278 6976  ict": {}, "arxiv
-00019040: 223a 2022 227d 292c 0a20 2020 2020 2020  ": ""}),.       
-00019050: 2020 2020 207b 2262 6962 6469 6374 223a       {"bibdict":
-00019060: 207b 7d2c 2022 6172 7869 7622 3a20 2222   {}, "arxiv": ""
-00019070: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-00019080: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00019090: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-000190a0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-000190b0: 732e 5f70 7265 7061 7265 496e 7365 7274  s._prepareInsert
-000190c0: 4669 6c6c 280a 2020 2020 2020 2020 2020  Fill(.          
-000190d0: 2020 2020 2020 7b22 6269 6264 6963 7422        {"bibdict"
-000190e0: 3a20 7b22 6172 7869 7622 3a20 2231 3233  : {"arxiv": "123
-000190f0: 227d 2c20 2261 7278 6976 223a 2022 227d  "}, "arxiv": ""}
-00019100: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-00019110: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
-00019120: 6264 6963 7422 3a20 7b22 6172 7869 7622  bdict": {"arxiv"
-00019130: 3a20 2231 3233 227d 2c20 2261 7278 6976  : "123"}, "arxiv
-00019140: 223a 2022 3132 3322 7d2c 0a20 2020 2020  ": "123"},.     
-00019150: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00019160: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00019170: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019180: 7042 4442 2e62 6962 732e 5f70 7265 7061  pBDB.bibs._prepa
-00019190: 7265 496e 7365 7274 4669 6c6c 280a 2020  reInsertFill(.  
-000191a0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-000191b0: 6269 6264 6963 7422 3a20 7b22 6570 7269  bibdict": {"epri
-000191c0: 6e74 223a 2022 3132 3322 7d2c 2022 6172  nt": "123"}, "ar
-000191d0: 7869 7622 3a20 2222 7d0a 2020 2020 2020  xiv": ""}.      
-000191e0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-000191f0: 2020 2020 207b 2262 6962 6469 6374 223a       {"bibdict":
-00019200: 207b 2265 7072 696e 7422 3a20 2231 3233   {"eprint": "123
-00019210: 227d 2c20 2261 7278 6976 223a 2022 3132  "}, "arxiv": "12
-00019220: 3322 7d2c 0a20 2020 2020 2020 2029 0a20  3"},.        ). 
-00019230: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00019240: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00019250: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00019260: 6962 732e 5f70 7265 7061 7265 496e 7365  ibs._prepareInse
-00019270: 7274 4669 6c6c 280a 2020 2020 2020 2020  rtFill(.        
-00019280: 2020 2020 2020 2020 7b22 6269 6264 6963          {"bibdic
-00019290: 7422 3a20 7b22 6172 7869 7622 3a20 2234  t": {"arxiv": "4
-000192a0: 3536 222c 2022 6570 7269 6e74 223a 2022  56", "eprint": "
-000192b0: 3132 3322 7d2c 2022 6172 7869 7622 3a20  123"}, "arxiv": 
-000192c0: 2222 7d0a 2020 2020 2020 2020 2020 2020  ""}.            
-000192d0: 292c 0a20 2020 2020 2020 2020 2020 207b  ),.            {
-000192e0: 2262 6962 6469 6374 223a 207b 2261 7278  "bibdict": {"arx
-000192f0: 6976 223a 2022 3435 3622 2c20 2265 7072  iv": "456", "epr
-00019300: 696e 7422 3a20 2231 3233 227d 2c20 2261  int": "123"}, "a
-00019310: 7278 6976 223a 2022 3435 3622 7d2c 0a20  rxiv": "456"},. 
-00019320: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00019330: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00019340: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-00019350: 656c 662e 7042 4442 2e62 6962 732e 5f70  elf.pBDB.bibs._p
-00019360: 7265 7061 7265 496e 7365 7274 4669 6c6c  repareInsertFill
-00019370: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00019380: 2020 7b22 6269 6264 6963 7422 3a20 7b22    {"bibdict": {"
-00019390: 6172 7869 7622 3a20 2234 3536 222c 2022  arxiv": "456", "
-000193a0: 6570 7269 6e74 223a 2022 3132 3322 7d2c  eprint": "123"},
-000193b0: 2022 6172 7869 7622 3a20 2237 3839 227d   "arxiv": "789"}
-000193c0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-000193d0: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
-000193e0: 6264 6963 7422 3a20 7b22 6172 7869 7622  bdict": {"arxiv"
-000193f0: 3a20 2234 3536 222c 2022 6570 7269 6e74  : "456", "eprint
-00019400: 223a 2022 3132 3322 7d2c 2022 6172 7869  ": "123"}, "arxi
-00019410: 7622 3a20 2237 3839 227d 2c0a 2020 2020  v": "789"},.    
-00019420: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
-00019430: 7220 6b20 696e 2028 2279 6561 7222 2c20  r k in ("year", 
-00019440: 2264 6f69 222c 2022 6973 626e 2229 3a0a  "doi", "isbn"):.
-00019450: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00019460: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00019470: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00019480: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
-00019490: 6570 6172 6549 6e73 6572 7446 696c 6c28  epareInsertFill(
-000194a0: 7b22 6269 6264 6963 7422 3a20 7b6b 3a20  {"bibdict": {k: 
-000194b0: 2222 7d7d 292c 0a20 2020 2020 2020 2020  ""}}),.         
-000194c0: 2020 2020 2020 207b 2262 6962 6469 6374         {"bibdict
-000194d0: 223a 207b 6b3a 2022 227d 7d2c 0a20 2020  ": {k: ""}},.   
-000194e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000194f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00019500: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00019510: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00019520: 4442 2e62 6962 732e 5f70 7265 7061 7265  DB.bibs._prepare
-00019530: 496e 7365 7274 4669 6c6c 287b 2262 6962  InsertFill({"bib
-00019540: 6469 6374 223a 207b 6b3a 2022 6162 6322  dict": {k: "abc"
-00019550: 7d7d 292c 0a20 2020 2020 2020 2020 2020  }}),.           
-00019560: 2020 2020 207b 2262 6962 6469 6374 223a       {"bibdict":
-00019570: 207b 6b3a 2022 6162 6322 7d2c 206b 3a20   {k: "abc"}, k: 
-00019580: 2261 6263 227d 2c0a 2020 2020 2020 2020  "abc"},.        
-00019590: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
-000195a0: 6573 745f 7072 6570 6172 6549 6e73 6572  est_prepareInser
-000195b0: 7446 6972 7374 6461 7465 2873 656c 662c  tFirstdate(self,
-000195c0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-000195d0: 2022 2222 7465 7374 205f 7072 6570 6172   """test _prepar
-000195e0: 6549 6e73 6572 7446 6972 7374 6461 7465  eInsertFirstdate
-000195f0: 2222 220a 2020 2020 2020 2020 746f 6461  """.        toda
-00019600: 7920 3d20 6461 7465 7469 6d65 2e64 6174  y = datetime.dat
-00019610: 652e 746f 6461 7928 292e 7374 7266 7469  e.today().strfti
-00019620: 6d65 2822 2559 2d25 6d2d 2564 2229 0a20  me("%Y-%m-%d"). 
-00019630: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00019640: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00019650: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00019660: 6962 732e 5f70 7265 7061 7265 496e 7365  ibs._prepareInse
-00019670: 7274 4669 7273 7464 6174 6528 7b7d 292c  rtFirstdate({}),
-00019680: 0a20 2020 2020 2020 2020 2020 207b 2266  .            {"f
-00019690: 6972 7374 6461 7465 223a 2074 6f64 6179  irstdate": today
-000196a0: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-000196b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000196c0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-000196d0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-000196e0: 732e 5f70 7265 7061 7265 496e 7365 7274  s._prepareInsert
-000196f0: 4669 7273 7464 6174 6528 7b7d 2c20 6669  Firstdate({}, fi
-00019700: 7273 7464 6174 653d 2222 292c 0a20 2020  rstdate=""),.   
-00019710: 2020 2020 2020 2020 207b 2266 6972 7374           {"first
-00019720: 6461 7465 223a 2074 6f64 6179 7d2c 0a20  date": today},. 
-00019730: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00019740: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00019750: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-00019760: 656c 662e 7042 4442 2e62 6962 732e 5f70  elf.pBDB.bibs._p
-00019770: 7265 7061 7265 496e 7365 7274 4669 7273  repareInsertFirs
-00019780: 7464 6174 6528 7b7d 2c20 6669 7273 7464  tdate({}, firstd
-00019790: 6174 653d 2232 3032 312d 3037 2d32 3622  ate="2021-07-26"
-000197a0: 292c 0a20 2020 2020 2020 2020 2020 207b  ),.            {
-000197b0: 2266 6972 7374 6461 7465 223a 2022 3230  "firstdate": "20
-000197c0: 3231 2d30 372d 3236 227d 2c0a 2020 2020  21-07-26"},.    
-000197d0: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
-000197e0: 6573 745f 7072 6570 6172 6549 6e73 6572  est_prepareInser
-000197f0: 744c 696e 6b28 7365 6c66 2c20 2a61 7267  tLink(self, *arg
-00019800: 7329 3a0a 2020 2020 2020 2020 2222 2274  s):.        """t
-00019810: 6573 7420 5f70 7265 7061 7265 496e 7365  est _prepareInse
-00019820: 7274 4c69 6e6b 2222 220a 2020 2020 2020  rtLink""".      
-00019830: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00019840: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00019850: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
-00019860: 7072 6570 6172 6549 6e73 6572 744c 696e  prepareInsertLin
-00019870: 6b28 7b7d 2c20 4e6f 6e65 292c 0a20 2020  k({}, None),.   
-00019880: 2020 2020 2020 2020 207b 226c 696e 6b22           {"link"
-00019890: 3a20 2222 7d2c 0a20 2020 2020 2020 2029  : ""},.        )
-000198a0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000198b0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-000198c0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-000198d0: 2e62 6962 732e 5f70 7265 7061 7265 496e  .bibs._prepareIn
-000198e0: 7365 7274 4c69 6e6b 287b 7d2c 206c 696e  sertLink({}, lin
-000198f0: 6b3d 2222 292c 0a20 2020 2020 2020 2020  k=""),.         
-00019900: 2020 207b 226c 696e 6b22 3a20 2222 7d2c     {"link": ""},
-00019910: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00019920: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00019930: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00019940: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00019950: 5f70 7265 7061 7265 496e 7365 7274 4c69  _prepareInsertLi
-00019960: 6e6b 287b 7d2c 2022 6162 6322 292c 0a20  nk({}, "abc"),. 
-00019970: 2020 2020 2020 2020 2020 207b 226c 696e             {"lin
-00019980: 6b22 3a20 2261 6263 227d 2c0a 2020 2020  k": "abc"},.    
-00019990: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-000199a0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-000199b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000199c0: 2e70 4244 422e 6269 6273 2e5f 7072 6570  .pBDB.bibs._prep
-000199d0: 6172 6549 6e73 6572 744c 696e 6b28 7b22  areInsertLink({"
-000199e0: 6172 7869 7622 3a20 2222 7d2c 204e 6f6e  arxiv": ""}, Non
-000199f0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00019a00: 7b22 6172 7869 7622 3a20 2222 2c20 226c  {"arxiv": "", "l
-00019a10: 696e 6b22 3a20 2222 7d2c 0a20 2020 2020  ink": ""},.     
-00019a20: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00019a30: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00019a40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019a50: 7042 4442 2e62 6962 732e 5f70 7265 7061  pBDB.bibs._prepa
-00019a60: 7265 496e 7365 7274 4c69 6e6b 287b 2261  reInsertLink({"a
-00019a70: 7278 6976 223a 2022 3132 3334 227d 2c20  rxiv": "1234"}, 
-00019a80: 4e6f 6e65 292c 0a20 2020 2020 2020 2020  None),.         
-00019a90: 2020 207b 2261 7278 6976 223a 2022 3132     {"arxiv": "12
-00019aa0: 3334 222c 2022 6c69 6e6b 223a 2070 6243  34", "link": pbC
-00019ab0: 6f6e 6669 672e 6172 7869 7655 726c 202b  onfig.arxivUrl +
-00019ac0: 2022 2f61 6273 2f31 3233 3422 7d2c 0a20   "/abs/1234"},. 
-00019ad0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00019ae0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00019af0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-00019b00: 656c 662e 7042 4442 2e62 6962 732e 5f70  elf.pBDB.bibs._p
-00019b10: 7265 7061 7265 496e 7365 7274 4c69 6e6b  repareInsertLink
-00019b20: 287b 2264 6f69 223a 2022 227d 2c20 4e6f  ({"doi": ""}, No
-00019b30: 6e65 292c 0a20 2020 2020 2020 2020 2020  ne),.           
-00019b40: 207b 2264 6f69 223a 2022 222c 2022 6c69   {"doi": "", "li
-00019b50: 6e6b 223a 2022 227d 2c0a 2020 2020 2020  nk": ""},.      
-00019b60: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00019b70: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00019b80: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00019b90: 4244 422e 6269 6273 2e5f 7072 6570 6172  BDB.bibs._prepar
-00019ba0: 6549 6e73 6572 744c 696e 6b28 7b22 646f  eInsertLink({"do
-00019bb0: 6922 3a20 2231 3233 3422 7d2c 204e 6f6e  i": "1234"}, Non
-00019bc0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00019bd0: 7b22 646f 6922 3a20 2231 3233 3422 2c20  {"doi": "1234", 
-00019be0: 226c 696e 6b22 3a20 7062 436f 6e66 6967  "link": pbConfig
-00019bf0: 2e64 6f69 5572 6c20 2b20 2231 3233 3422  .doiUrl + "1234"
-00019c00: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-00019c10: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00019c20: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00019c30: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00019c40: 732e 5f70 7265 7061 7265 496e 7365 7274  s._prepareInsert
-00019c50: 4c69 6e6b 287b 2261 7278 6976 223a 2022  Link({"arxiv": "
-00019c60: 3536 3738 222c 2022 646f 6922 3a20 2222  5678", "doi": ""
-00019c70: 7d2c 204e 6f6e 6529 2c0a 2020 2020 2020  }, None),.      
-00019c80: 2020 2020 2020 7b22 6172 7869 7622 3a20        {"arxiv": 
-00019c90: 2235 3637 3822 2c20 2264 6f69 223a 2022  "5678", "doi": "
-00019ca0: 222c 2022 6c69 6e6b 223a 2070 6243 6f6e  ", "link": pbCon
-00019cb0: 6669 672e 6172 7869 7655 726c 202b 2022  fig.arxivUrl + "
-00019cc0: 2f61 6273 2f35 3637 3822 7d2c 0a20 2020  /abs/5678"},.   
-00019cd0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00019ce0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00019cf0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00019d00: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
-00019d10: 7061 7265 496e 7365 7274 4c69 6e6b 287b  pareInsertLink({
-00019d20: 2261 7278 6976 223a 2022 3536 3738 222c  "arxiv": "5678",
-00019d30: 2022 646f 6922 3a20 2231 3233 3422 7d2c   "doi": "1234"},
-00019d40: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
-00019d50: 2020 2020 7b22 6172 7869 7622 3a20 2235      {"arxiv": "5
-00019d60: 3637 3822 2c20 2264 6f69 223a 2022 3132  678", "doi": "12
-00019d70: 3334 222c 2022 6c69 6e6b 223a 2070 6243  34", "link": pbC
-00019d80: 6f6e 6669 672e 646f 6955 726c 202b 2022  onfig.doiUrl + "
-00019d90: 3132 3334 227d 2c0a 2020 2020 2020 2020  1234"},.        
-00019da0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00019db0: 7072 6570 6172 6549 6e73 6572 7453 7461  prepareInsertSta
-00019dc0: 6e64 6172 6428 7365 6c66 2c20 2a61 7267  ndard(self, *arg
-00019dd0: 7329 3a0a 2020 2020 2020 2020 2222 2274  s):.        """t
-00019de0: 6573 7420 5f70 7265 7061 7265 496e 7365  est _prepareInse
-00019df0: 7274 5374 616e 6461 7264 2222 220a 2020  rtStandard""".  
-00019e00: 2020 2020 2020 656d 7074 7920 3d20 7b0a        empty = {.
-00019e10: 2020 2020 2020 2020 2020 2020 6b3a 204e              k: N
-00019e20: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00019e30: 666f 7220 6b20 696e 2028 0a20 2020 2020  for k in (.     
-00019e40: 2020 2020 2020 2020 2020 2022 6162 7374             "abst
-00019e50: 7261 6374 222c 0a20 2020 2020 2020 2020  ract",.         
-00019e60: 2020 2020 2020 2022 6372 6f73 7372 6566         "crossref
-00019e70: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00019e80: 2020 2022 646f 6922 2c0a 2020 2020 2020     "doi",.      
-00019e90: 2020 2020 2020 2020 2020 2269 7362 6e22            "isbn"
-00019ea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019eb0: 2020 2261 6473 222c 0a20 2020 2020 2020    "ads",.       
-00019ec0: 2020 2020 2020 2020 2022 636f 6d6d 656e           "commen
-00019ed0: 7473 222c 0a20 2020 2020 2020 2020 2020  ts",.           
-00019ee0: 2020 2020 2022 696e 7370 6972 6522 2c0a       "inspire",.
-00019ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019f00: 226f 6c64 5f6b 6579 7322 2c0a 2020 2020  "old_keys",.    
-00019f10: 2020 2020 2020 2020 2020 2020 2273 6368              "sch
-00019f20: 6f6c 6172 222c 0a20 2020 2020 2020 2020  olar",.         
-00019f30: 2020 2020 2020 2022 6d61 726b 7322 2c0a         "marks",.
-00019f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019f50: 2270 7562 6461 7465 222c 0a20 2020 2020  "pubdate",.     
-00019f60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00019f70: 207d 0a20 2020 2020 2020 2066 6f72 206b   }.        for k
-00019f80: 2069 6e20 280a 2020 2020 2020 2020 2020   in (.          
-00019f90: 2020 2262 6f6f 6b22 2c0a 2020 2020 2020    "book",.      
-00019fa0: 2020 2020 2020 2265 7870 5f70 6170 6572        "exp_paper
-00019fb0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-00019fc0: 6c65 6374 7572 6522 2c0a 2020 2020 2020  lecture",.      
-00019fd0: 2020 2020 2020 226e 6f55 7064 6174 6522        "noUpdate"
-00019fe0: 2c0a 2020 2020 2020 2020 2020 2020 2270  ,.            "p
-00019ff0: 6864 5f74 6865 7369 7322 2c0a 2020 2020  hd_thesis",.    
-0001a000: 2020 2020 2020 2020 2270 726f 6365 6564          "proceed
-0001a010: 696e 6722 2c0a 2020 2020 2020 2020 2020  ing",.          
-0001a020: 2020 2272 6576 6965 7722 2c0a 2020 2020    "review",.    
-0001a030: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-0001a040: 2020 2065 6d70 7479 5b6b 5d20 3d20 300a     empty[k] = 0.
-0001a050: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
-0001a060: 2028 226d 6172 6b73 222c 2022 7075 6264   ("marks", "pubd
-0001a070: 6174 6522 293a 0a20 2020 2020 2020 2020  ate"):.         
-0001a080: 2020 2065 6d70 7479 5b6b 5d20 3d20 2222     empty[k] = ""
-0001a090: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0001a0a0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0001a0b0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0001a0c0: 2e62 6962 732e 5f70 7265 7061 7265 496e  .bibs._prepareIn
-0001a0d0: 7365 7274 5374 616e 6461 7264 287b 7d2c  sertStandard({},
-0001a0e0: 207b 7d29 2c0a 2020 2020 2020 2020 2020   {}),.          
-0001a0f0: 2020 656d 7074 792c 0a20 2020 2020 2020    empty,.       
-0001a100: 2029 0a20 2020 2020 2020 2066 6f72 206b   ).        for k
-0001a110: 2069 6e20 280a 2020 2020 2020 2020 2020   in (.          
-0001a120: 2020 226d 6172 6b73 222c 0a20 2020 2020    "marks",.     
-0001a130: 2020 2020 2020 2022 7075 6264 6174 6522         "pubdate"
-0001a140: 2c0a 2020 2020 2020 2020 293a 0a20 2020  ,.        ):.   
-0001a150: 2020 2020 2020 2020 2065 203d 2065 6d70           e = emp
-0001a160: 7479 2e63 6f70 7928 290a 2020 2020 2020  ty.copy().      
-0001a170: 2020 2020 2020 655b 6b5d 203d 2022 6162        e[k] = "ab
-0001a180: 6322 0a20 2020 2020 2020 2020 2020 2073  c".            s
-0001a190: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0001a1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a1b0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0001a1c0: 5f70 7265 7061 7265 496e 7365 7274 5374  _prepareInsertSt
-0001a1d0: 616e 6461 7264 287b 7d2c 207b 7d2c 202a  andard({}, {}, *
-0001a1e0: 2a7b 6b3a 2022 6162 6322 7d29 2c0a 2020  *{k: "abc"}),.  
-0001a1f0: 2020 2020 2020 2020 2020 2020 2020 652c                e,
-0001a200: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001a210: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a220: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0001a230: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001a240: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
-0001a250: 7061 7265 496e 7365 7274 5374 616e 6461  pareInsertStanda
-0001a260: 7264 287b 7d2c 207b 7d2c 202a 2a7b 6b3a  rd({}, {}, **{k:
-0001a270: 2022 227d 292c 0a20 2020 2020 2020 2020   ""}),.         
-0001a280: 2020 2020 2020 2065 6d70 7479 2c0a 2020         empty,.  
-0001a290: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001a2a0: 2020 2020 666f 7220 6b20 696e 2028 0a20      for k in (. 
-0001a2b0: 2020 2020 2020 2020 2020 2022 626f 6f6b             "book
-0001a2c0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-0001a2d0: 6578 705f 7061 7065 7222 2c0a 2020 2020  exp_paper",.    
-0001a2e0: 2020 2020 2020 2020 226c 6563 7475 7265          "lecture
-0001a2f0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-0001a300: 6e6f 5570 6461 7465 222c 0a20 2020 2020  noUpdate",.     
-0001a310: 2020 2020 2020 2022 7068 645f 7468 6573         "phd_thes
-0001a320: 6973 222c 0a20 2020 2020 2020 2020 2020  is",.           
-0001a330: 2022 7072 6f63 6565 6469 6e67 222c 0a20   "proceeding",. 
-0001a340: 2020 2020 2020 2020 2020 2022 7265 7669             "revi
-0001a350: 6577 222c 0a20 2020 2020 2020 2029 3a0a  ew",.        ):.
-0001a360: 2020 2020 2020 2020 2020 2020 6520 3d20              e = 
-0001a370: 656d 7074 792e 636f 7079 2829 0a20 2020  empty.copy().   
-0001a380: 2020 2020 2020 2020 2065 5b6b 5d20 3d20           e[k] = 
-0001a390: 310a 2020 2020 2020 2020 2020 2020 7365  1.            se
-0001a3a0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0001a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3c0: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
-0001a3d0: 7072 6570 6172 6549 6e73 6572 7453 7461  prepareInsertSta
-0001a3e0: 6e64 6172 6428 7b7d 2c20 7b6b 3a20 2264  ndard({}, {k: "d
-0001a3f0: 6566 227d 2c20 2a2a 7b6b 3a20 2261 6263  ef"}, **{k: "abc
-0001a400: 227d 292c 0a20 2020 2020 2020 2020 2020  "}),.           
-0001a410: 2020 2020 2065 2c0a 2020 2020 2020 2020       e,.        
-0001a420: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0001a430: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0001a440: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-0001a450: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-0001a460: 6273 2e5f 7072 6570 6172 6549 6e73 6572  bs._prepareInser
-0001a470: 7453 7461 6e64 6172 6428 7b7d 2c20 7b6b  tStandard({}, {k
-0001a480: 3a20 2264 6566 227d 292c 0a20 2020 2020  : "def"}),.     
-0001a490: 2020 2020 2020 2020 2020 2065 6d70 7479             empty
-0001a4a0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0001a4b0: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
-0001a4c0: 2028 2261 6273 7472 6163 7422 2c20 2263   ("abstract", "c
-0001a4d0: 726f 7373 7265 6622 2c20 2264 6f69 222c  rossref", "doi",
-0001a4e0: 2022 6973 626e 2229 3a0a 2020 2020 2020   "isbn"):.      
-0001a4f0: 2020 2020 2020 6520 3d20 656d 7074 792e        e = empty.
-0001a500: 636f 7079 2829 0a20 2020 2020 2020 2020  copy().         
-0001a510: 2020 2065 5b6b 5d20 3d20 2261 6263 220a     e[k] = "abc".
-0001a520: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001a530: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0001a540: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001a550: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
-0001a560: 6570 6172 6549 6e73 6572 7453 7461 6e64  epareInsertStand
-0001a570: 6172 6428 7b7d 2c20 7b6b 3a20 2264 6566  ard({}, {k: "def
-0001a580: 227d 2c20 2a2a 7b6b 3a20 2261 6263 227d  "}, **{k: "abc"}
-0001a590: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0001a5a0: 2020 2065 2c0a 2020 2020 2020 2020 2020     e,.          
-0001a5b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001a5c0: 655b 6b5d 203d 2022 6465 6622 0a20 2020  e[k] = "def".   
-0001a5d0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001a5e0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0001a5f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a600: 7042 4442 2e62 6962 732e 5f70 7265 7061  pBDB.bibs._prepa
-0001a610: 7265 496e 7365 7274 5374 616e 6461 7264  reInsertStandard
-0001a620: 287b 7d2c 207b 6b3a 2022 6465 6622 7d29  ({}, {k: "def"})
-0001a630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a640: 2020 652c 0a20 2020 2020 2020 2020 2020    e,.           
-0001a650: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
-0001a660: 5f70 7265 7061 7265 496e 7365 7274 5965  _prepareInsertYe
-0001a670: 6172 2873 656c 662c 202a 6172 6773 293a  ar(self, *args):
-0001a680: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
-0001a690: 205f 7072 6570 6172 6549 6e73 6572 7459   _prepareInsertY
-0001a6a0: 6561 7222 2222 0a20 2020 2020 2020 2073  ear""".        s
-0001a6b0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0001a6c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001a6d0: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
-0001a6e0: 7061 7265 496e 7365 7274 5965 6172 287b  pareInsertYear({
-0001a6f0: 7d2c 207b 7d2c 204e 6f6e 6529 2c0a 2020  }, {}, None),.  
-0001a700: 2020 2020 2020 2020 2020 7b22 7965 6172            {"year
-0001a710: 223a 204e 6f6e 657d 2c0a 2020 2020 2020  ": None},.      
-0001a720: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0001a730: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0001a740: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0001a750: 4244 422e 6269 6273 2e5f 7072 6570 6172  BDB.bibs._prepar
-0001a760: 6549 6e73 6572 7459 6561 7228 7b7d 2c20  eInsertYear({}, 
-0001a770: 7b22 7965 6172 223a 2022 3230 3231 227d  {"year": "2021"}
-0001a780: 2c20 7965 6172 3d4e 6f6e 6529 2c0a 2020  , year=None),.  
-0001a790: 2020 2020 2020 2020 2020 7b22 7965 6172            {"year
-0001a7a0: 223a 2022 3230 3231 227d 2c0a 2020 2020  ": "2021"},.    
-0001a7b0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0001a7c0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0001a7d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001a7e0: 2e70 4244 422e 6269 6273 2e5f 7072 6570  .pBDB.bibs._prep
-0001a7f0: 6172 6549 6e73 6572 7459 6561 7228 0a20  areInsertYear(. 
-0001a800: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001a810: 2261 7278 6976 223a 2022 3139 3031 2e30  "arxiv": "1901.0
-0001a820: 3132 3334 227d 2c20 7b22 7965 6172 223a  1234"}, {"year":
-0001a830: 2022 3230 3231 227d 2c20 7965 6172 3d4e   "2021"}, year=N
-0001a840: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0001a850: 292c 0a20 2020 2020 2020 2020 2020 207b  ),.            {
-0001a860: 2261 7278 6976 223a 2022 3139 3031 2e30  "arxiv": "1901.0
-0001a870: 3132 3334 222c 2022 7965 6172 223a 2022  1234", "year": "
-0001a880: 3230 3231 227d 2c0a 2020 2020 2020 2020  2021"},.        
-0001a890: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0001a8a0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-0001a8b0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0001a8c0: 422e 6269 6273 2e5f 7072 6570 6172 6549  B.bibs._prepareI
-0001a8d0: 6e73 6572 7459 6561 7228 7b22 6172 7869  nsertYear({"arxi
-0001a8e0: 7622 3a20 2231 3930 312e 3031 3233 3422  v": "1901.01234"
-0001a8f0: 7d2c 207b 7d2c 2079 6561 723d 4e6f 6e65  }, {}, year=None
-0001a900: 292c 0a20 2020 2020 2020 2020 2020 207b  ),.            {
-0001a910: 2261 7278 6976 223a 2022 3139 3031 2e30  "arxiv": "1901.0
-0001a920: 3132 3334 222c 2022 7965 6172 223a 2022  1234", "year": "
-0001a930: 3230 3139 227d 2c0a 2020 2020 2020 2020  2019"},.        
-0001a940: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0001a950: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-0001a960: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0001a970: 422e 6269 6273 2e5f 7072 6570 6172 6549  B.bibs._prepareI
-0001a980: 6e73 6572 7459 6561 7228 0a20 2020 2020  nsertYear(.     
-0001a990: 2020 2020 2020 2020 2020 207b 2261 7278             {"arx
-0001a9a0: 6976 223a 2022 3139 3031 2e30 3132 3334  iv": "1901.01234
-0001a9b0: 227d 2c20 7b22 7965 6172 223a 2022 3230  "}, {"year": "20
-0001a9c0: 3231 227d 2c20 7965 6172 3d22 3230 3035  21"}, year="2005
-0001a9d0: 220a 2020 2020 2020 2020 2020 2020 292c  ".            ),
-0001a9e0: 0a20 2020 2020 2020 2020 2020 207b 2261  .            {"a
-0001a9f0: 7278 6976 223a 2022 3139 3031 2e30 3132  rxiv": "1901.012
-0001aa00: 3334 222c 2022 7965 6172 223a 2022 3230  34", "year": "20
-0001aa10: 3035 227d 2c0a 2020 2020 2020 2020 290a  05"},.        ).
-0001aa20: 0a20 2020 2064 6566 2074 6573 745f 7072  .    def test_pr
-0001aa30: 6f63 6573 7351 7565 7279 4669 656c 6473  ocessQueryFields
-0001aa40: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-0001aa50: 2020 2020 2020 2022 2222 7465 7374 205f         """test _
-0001aa60: 7072 6f63 6573 7351 7565 7279 4669 656c  processQueryFiel
-0001aa70: 6473 2222 220a 2020 2020 2020 2020 2320  ds""".        # 
-0001aa80: 6661 696c 696e 670a 2020 2020 2020 2020  failing.        
-0001aa90: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0001aaa0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0001aab0: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
-0001aac0: 6f63 6573 7351 7565 7279 4669 656c 6473  ocessQueryFields
-0001aad0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001aae0: 2020 7b22 6c6f 6769 6361 6c22 3a20 2261    {"logical": "a
-0001aaf0: 6263 222c 2022 7479 7065 223a 2022 5465  bc", "type": "Te
-0001ab00: 7874 222c 2022 636f 6e74 656e 7422 3a20  xt", "content": 
-0001ab10: 2222 2c20 226f 7065 7261 746f 7222 3a20  "", "operator": 
-0001ab20: 2262 6222 7d2c 0a20 2020 2020 2020 2020  "bb"},.         
-0001ab30: 2020 2020 2020 2054 7275 652c 0a20 2020         True,.   
-0001ab40: 2020 2020 2020 2020 2020 2020 2022 6162               "ab
-0001ab50: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
-0001ab60: 2020 2020 2277 6865 7265 222c 0a20 2020      "where",.   
-0001ab70: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
-0001ab80: 696e 222c 0a20 2020 2020 2020 2020 2020  in",.           
-0001ab90: 2020 2020 2028 292c 0a20 2020 2020 2020       (),.       
-0001aba0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0001abb0: 2020 2020 2854 7275 652c 2022 6162 6322      (True, "abc"
-0001abc0: 2c20 2277 6865 7265 222c 2022 6a6f 696e  , "where", "join
-0001abd0: 222c 2028 2929 2c0a 2020 2020 2020 2020  ", ()),.        
-0001abe0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0001abf0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-0001ac00: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0001ac10: 422e 6269 6273 2e5f 7072 6f63 6573 7351  B.bibs._processQ
-0001ac20: 7565 7279 4669 656c 6473 280a 2020 2020  ueryFields(.    
-0001ac30: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-0001ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac50: 2020 226c 6f67 6963 616c 223a 2022 6162    "logical": "ab
-0001ac60: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
-0001ac70: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-0001ac80: 2243 6174 6567 6f72 6965 7322 2c0a 2020  "Categories",.  
-0001ac90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aca0: 2020 2263 6f6e 7465 6e74 223a 2022 222c    "content": "",
-0001acb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001acc0: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-0001acd0: 2022 6262 222c 0a20 2020 2020 2020 2020   "bb",.         
-0001ace0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-0001acf0: 2020 2020 2020 2020 2020 5472 7565 2c0a            True,.
-0001ad00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ad10: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
-0001ad20: 2020 2020 2020 2022 7768 6572 6522 2c0a         "where",.
-0001ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ad40: 226a 6f69 6e22 2c0a 2020 2020 2020 2020  "join",.        
-0001ad50: 2020 2020 2020 2020 2829 2c0a 2020 2020          (),.    
-0001ad60: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-0001ad70: 2020 2020 2020 2028 5472 7565 2c20 2261         (True, "a
-0001ad80: 6263 222c 2022 7768 6572 6522 2c20 226a  bc", "where", "j
-0001ad90: 6f69 6e22 2c20 2829 292c 0a20 2020 2020  oin", ()),.     
-0001ada0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-0001adb0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-0001adc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001add0: 7042 4442 2e62 6962 732e 5f70 726f 6365  pBDB.bibs._proce
-0001ade0: 7373 5175 6572 7946 6965 6c64 7328 0a20  ssQueryFields(. 
-0001adf0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001ae00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ae10: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-0001ae20: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
-0001ae30: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-0001ae40: 223a 2022 4578 7065 7269 6d65 6e74 7322  ": "Experiments"
-0001ae50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ae60: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-0001ae70: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0001ae80: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-0001ae90: 6f72 223a 2022 6262 222c 0a20 2020 2020  or": "bb",.     
-0001aea0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-0001aeb0: 2020 2020 2020 2020 2020 2020 2020 5472                Tr
-0001aec0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-0001aed0: 2020 2020 2261 6263 222c 0a20 2020 2020      "abc",.     
-0001aee0: 2020 2020 2020 2020 2020 2022 7768 6572             "wher
-0001aef0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001af00: 2020 2020 226a 6f69 6e22 2c0a 2020 2020      "join",.    
-0001af10: 2020 2020 2020 2020 2020 2020 2829 2c0a              (),.
-0001af20: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001af30: 2020 2020 2020 2020 2020 2028 5472 7565             (True
-0001af40: 2c20 2261 6263 222c 2022 7768 6572 6522  , "abc", "where"
-0001af50: 2c20 226a 6f69 6e22 2c20 2829 292c 0a20  , "join", ()),. 
-0001af60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001af70: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0001af80: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-0001af90: 656c 662e 7042 4442 2e62 6962 732e 5f70  elf.pBDB.bibs._p
-0001afa0: 726f 6365 7373 5175 6572 7946 6965 6c64  rocessQueryField
-0001afb0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-0001afc0: 2020 207b 226c 6f67 6963 616c 223a 2022     {"logical": "
-0001afd0: 6162 6322 2c20 2274 7970 6522 3a20 224d  abc", "type": "M
-0001afe0: 6172 6b73 222c 2022 636f 6e74 656e 7422  arks", "content"
-0001aff0: 3a20 2222 2c20 226f 7065 7261 746f 7222  : "", "operator"
-0001b000: 3a20 2262 6222 7d2c 0a20 2020 2020 2020  : "bb"},.       
-0001b010: 2020 2020 2020 2020 2054 7275 652c 0a20           True,. 
-0001b020: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b030: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
-0001b040: 2020 2020 2020 2277 6865 7265 222c 0a20        "where",. 
-0001b050: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b060: 6a6f 696e 222c 0a20 2020 2020 2020 2020  join",.         
-0001b070: 2020 2020 2020 2028 292c 0a20 2020 2020         (),.     
-0001b080: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0001b090: 2020 2020 2020 2854 7275 652c 2022 6162        (True, "ab
-0001b0a0: 6322 2c20 2277 6865 7265 222c 2022 6a6f  c", "where", "jo
-0001b0b0: 696e 222c 2028 2929 2c0a 2020 2020 2020  in", ()),.      
-0001b0c0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0001b0d0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0001b0e0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0001b0f0: 4244 422e 6269 6273 2e5f 7072 6f63 6573  BDB.bibs._proces
-0001b100: 7351 7565 7279 4669 656c 6473 280a 2020  sQueryFields(.  
-0001b110: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b130: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
-0001b140: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
-0001b150: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-0001b160: 3a20 224d 6172 6b73 222c 0a20 2020 2020  : "Marks",.     
-0001b170: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b180: 636f 6e74 656e 7422 3a20 5b22 6122 2c20  content": ["a", 
-0001b190: 2262 225d 2c0a 2020 2020 2020 2020 2020  "b"],.          
-0001b1a0: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
-0001b1b0: 746f 7222 3a20 2262 6222 2c0a 2020 2020  tor": "bb",.    
-0001b1c0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-0001b1d0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-0001b1e0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-0001b1f0: 2020 2020 2022 6162 6322 2c0a 2020 2020       "abc",.    
-0001b200: 2020 2020 2020 2020 2020 2020 2277 6865              "whe
-0001b210: 7265 222c 0a20 2020 2020 2020 2020 2020  re",.           
-0001b220: 2020 2020 2022 6a6f 696e 222c 0a20 2020       "join",.   
-0001b230: 2020 2020 2020 2020 2020 2020 2028 292c               (),
-0001b240: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-0001b250: 2020 2020 2020 2020 2020 2020 2854 7275              (Tru
-0001b260: 652c 2022 6162 6322 2c20 2277 6865 7265  e, "abc", "where
-0001b270: 222c 2022 6a6f 696e 222c 2028 2929 2c0a  ", "join", ()),.
-0001b280: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001b290: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0001b2a0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-0001b2b0: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
-0001b2c0: 7072 6f63 6573 7351 7565 7279 4669 656c  processQueryFiel
-0001b2d0: 6473 280a 2020 2020 2020 2020 2020 2020  ds(.            
-0001b2e0: 2020 2020 7b22 6c6f 6769 6361 6c22 3a20      {"logical": 
-0001b2f0: 2261 6263 222c 2022 7479 7065 223a 2022  "abc", "type": "
-0001b300: 5479 7065 222c 2022 636f 6e74 656e 7422  Type", "content"
-0001b310: 3a20 2222 2c20 226f 7065 7261 746f 7222  : "", "operator"
-0001b320: 3a20 2262 6222 7d2c 0a20 2020 2020 2020  : "bb"},.       
-0001b330: 2020 2020 2020 2020 2054 7275 652c 0a20           True,. 
-0001b340: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b350: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
-0001b360: 2020 2020 2020 2277 6865 7265 222c 0a20        "where",. 
-0001b370: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b380: 6a6f 696e 222c 0a20 2020 2020 2020 2020  join",.         
-0001b390: 2020 2020 2020 2028 292c 0a20 2020 2020         (),.     
-0001b3a0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0001b3b0: 2020 2020 2020 2854 7275 652c 2022 6162        (True, "ab
-0001b3c0: 6322 2c20 2277 6865 7265 222c 2022 6a6f  c", "where", "jo
-0001b3d0: 696e 222c 2028 2929 2c0a 2020 2020 2020  in", ()),.      
-0001b3e0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0001b3f0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0001b400: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0001b410: 4244 422e 6269 6273 2e5f 7072 6f63 6573  BDB.bibs._proces
-0001b420: 7351 7565 7279 4669 656c 6473 280a 2020  sQueryFields(.  
-0001b430: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-0001b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b450: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
-0001b460: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
-0001b470: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-0001b480: 3a20 2254 7970 6522 2c0a 2020 2020 2020  : "Type",.      
-0001b490: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-0001b4a0: 6f6e 7465 6e74 223a 205b 2261 222c 2022  ontent": ["a", "
-0001b4b0: 6222 5d2c 0a20 2020 2020 2020 2020 2020  b"],.           
-0001b4c0: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-0001b4d0: 6f72 223a 2022 6262 222c 0a20 2020 2020  or": "bb",.     
-0001b4e0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-0001b4f0: 2020 2020 2020 2020 2020 2020 2020 5472                Tr
-0001b500: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-0001b510: 2020 2020 2261 6263 222c 0a20 2020 2020      "abc",.     
-0001b520: 2020 2020 2020 2020 2020 2022 7768 6572             "wher
-0001b530: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001b540: 2020 2020 226a 6f69 6e22 2c0a 2020 2020      "join",.    
-0001b550: 2020 2020 2020 2020 2020 2020 2829 2c0a              (),.
-0001b560: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001b570: 2020 2020 2020 2020 2020 2028 5472 7565             (True
-0001b580: 2c20 2261 6263 222c 2022 7768 6572 6522  , "abc", "where"
-0001b590: 2c20 226a 6f69 6e22 2c20 2829 292c 0a20  , "join", ()),. 
-0001b5a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001b5b0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0001b5c0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-0001b5d0: 656c 662e 7042 4442 2e62 6962 732e 5f70  elf.pBDB.bibs._p
-0001b5e0: 726f 6365 7373 5175 6572 7946 6965 6c64  rocessQueryField
-0001b5f0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-0001b600: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-0001b610: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-0001b620: 6c22 3a20 2261 6263 222c 0a20 2020 2020  l": "abc",.     
-0001b630: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b640: 7479 7065 223a 2022 7261 6e64 6f6d 222c  type": "random",
-0001b650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b660: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
-0001b670: 5b22 6122 2c20 2262 225d 2c0a 2020 2020  ["a", "b"],.    
-0001b680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b690: 226f 7065 7261 746f 7222 3a20 2262 6222  "operator": "bb"
-0001b6a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b6b0: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-0001b6c0: 2020 2020 2054 7275 652c 0a20 2020 2020       True,.     
-0001b6d0: 2020 2020 2020 2020 2020 2022 6162 6322             "abc"
-0001b6e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b6f0: 2020 2277 6865 7265 222c 0a20 2020 2020    "where",.     
-0001b700: 2020 2020 2020 2020 2020 2022 6a6f 696e             "join
-0001b710: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001b720: 2020 2028 292c 0a20 2020 2020 2020 2020     (),.         
-0001b730: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-0001b740: 2020 2846 616c 7365 2c20 2261 6263 222c    (False, "abc",
-0001b750: 2022 7768 6572 6522 2c20 226a 6f69 6e22   "where", "join"
-0001b760: 2c20 2829 292c 0a20 2020 2020 2020 2029  , ()),.        )
-0001b770: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0001b780: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0001b790: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0001b7a0: 2e62 6962 732e 5f70 726f 6365 7373 5175  .bibs._processQu
-0001b7b0: 6572 7946 6965 6c64 7328 0a20 2020 2020  eryFields(.     
-0001b7c0: 2020 2020 2020 2020 2020 207b 226c 6f67             {"log
-0001b7d0: 6963 616c 223a 2022 6162 6322 2c20 2274  ical": "abc", "t
-0001b7e0: 7970 6522 3a20 2254 6578 7422 2c20 2263  ype": "Text", "c
-0001b7f0: 6f6e 7465 6e74 223a 2022 222c 2022 6f70  ontent": "", "op
-0001b800: 6572 6174 6f72 223a 2022 6262 227d 2c0a  erator": "bb"},.
-0001b810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b820: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-0001b830: 2020 2020 2020 2022 6162 6322 2c0a 2020         "abc",.  
-0001b840: 2020 2020 2020 2020 2020 2020 2020 2277                "w
-0001b850: 6865 7265 222c 0a20 2020 2020 2020 2020  here",.         
-0001b860: 2020 2020 2020 2022 6a6f 696e 222c 0a20         "join",. 
-0001b870: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0001b880: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
-0001b890: 2c0a 2020 2020 2020 2020 2020 2020 2846  ,.            (F
-0001b8a0: 616c 7365 2c20 2261 6263 222c 2022 7768  alse, "abc", "wh
-0001b8b0: 6572 6522 2c20 226a 6f69 6e22 2c20 2829  ere", "join", ()
-0001b8c0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-0001b8d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001b8e0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0001b8f0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-0001b900: 732e 5f70 726f 6365 7373 5175 6572 7946  s._processQueryF
-0001b910: 6965 6c64 7328 0a20 2020 2020 2020 2020  ields(.         
-0001b920: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-0001b930: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-0001b940: 6769 6361 6c22 3a20 2261 6263 222c 0a20  gical": "abc",. 
-0001b950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b960: 2020 2022 7479 7065 223a 2022 5465 7874     "type": "Text
-0001b970: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001b980: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-0001b990: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-0001b9a0: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
-0001b9b0: 746f 7222 3a20 223d 222c 0a20 2020 2020  tor": "=",.     
-0001b9c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b9d0: 6669 656c 6422 3a20 2262 6222 2c0a 2020  field": "bb",.  
-0001b9e0: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-0001b9f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ba00: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0001ba10: 2020 2020 2020 2020 2261 6263 222c 0a20          "abc",. 
-0001ba20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001ba30: 7768 6572 6522 2c0a 2020 2020 2020 2020  where",.        
-0001ba40: 2020 2020 2020 2020 226a 6f69 6e22 2c0a          "join",.
-0001ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba60: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
-0001ba70: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
-0001ba80: 4661 6c73 652c 2022 6162 6322 2c20 2277  False, "abc", "w
-0001ba90: 6865 7265 222c 2022 6a6f 696e 222c 2028  here", "join", (
-0001baa0: 2929 2c0a 2020 2020 2020 2020 290a 2020  )),.        ).  
-0001bab0: 2020 2020 2020 2320 776f 726b 696e 670a        # working.
-0001bac0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001bad0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0001bae0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0001baf0: 6269 6273 2e5f 7072 6f63 6573 7351 7565  bibs._processQue
-0001bb00: 7279 4669 656c 6473 280a 2020 2020 2020  ryFields(.      
-0001bb10: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0001bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb30: 226c 6f67 6963 616c 223a 2022 6162 6322  "logical": "abc"
-0001bb40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001bb50: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
-0001bb60: 6578 7422 2c0a 2020 2020 2020 2020 2020  ext",.          
-0001bb70: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-0001bb80: 6e74 223a 2022 6162 6322 2c0a 2020 2020  nt": "abc",.    
-0001bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bba0: 226f 7065 7261 746f 7222 3a20 223d 222c  "operator": "=",
-0001bbb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bbc0: 2020 2020 2022 6669 656c 6422 3a20 2262       "field": "b
-0001bbd0: 6962 7465 7822 2c0a 2020 2020 2020 2020  ibtex",.        
-0001bbe0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0001bbf0: 2020 2020 2020 2020 2020 2046 616c 7365             False
-0001bc00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001bc10: 2020 2261 6263 222c 0a20 2020 2020 2020    "abc",.       
-0001bc20: 2020 2020 2020 2020 2022 7768 6572 6520           "where 
-0001bc30: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001bc40: 2020 2022 6a6f 696e 2022 2c0a 2020 2020     "join ",.    
-0001bc50: 2020 2020 2020 2020 2020 2020 2829 2c0a              (),.
-0001bc60: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001bc70: 2020 2020 2020 2020 2020 2028 4661 6c73             (Fals
-0001bc80: 652c 2022 6162 6322 2c20 2277 6865 7265  e, "abc", "where
-0001bc90: 2061 6e64 2062 6962 7465 7820 3d20 3f20   and bibtex = ? 
-0001bca0: 222c 2022 6a6f 696e 2022 2c20 2822 6162  ", "join ", ("ab
-0001bcb0: 6322 2c29 292c 0a20 2020 2020 2020 2029  c",)),.        )
-0001bcc0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0001bcd0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0001bce0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0001bcf0: 2e62 6962 732e 5f70 726f 6365 7373 5175  .bibs._processQu
-0001bd00: 6572 7946 6965 6c64 7328 0a20 2020 2020  eryFields(.     
-0001bd10: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-0001bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd30: 2022 6c6f 6769 6361 6c22 3a20 2261 6263   "logical": "abc
-0001bd40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001bd50: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
-0001bd60: 5465 7874 222c 0a20 2020 2020 2020 2020  Text",.         
-0001bd70: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-0001bd80: 656e 7422 3a20 2261 6263 222c 0a20 2020  ent": "abc",.   
-0001bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bda0: 2022 6f70 6572 6174 6f72 223a 2022 3d22   "operator": "="
-0001bdb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001bdc0: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
-0001bdd0: 6269 6274 6578 222c 0a20 2020 2020 2020  bibtex",.       
-0001bde0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-0001bdf0: 2020 2020 2020 2020 2020 2020 4661 6c73              Fals
-0001be00: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0001be10: 2020 2022 6162 6322 2c0a 2020 2020 2020     "abc",.      
-0001be20: 2020 2020 2020 2020 2020 2277 6865 7265            "where
-0001be30: 2022 2c0a 2020 2020 2020 2020 2020 2020   ",.            
-0001be40: 2020 2020 226a 6f69 6e20 222c 0a20 2020      "join ",.   
-0001be50: 2020 2020 2020 2020 2020 2020 2028 292c               (),
-0001be60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001be70: 2070 7265 7065 6e64 5461 623d 2265 6e74   prependTab="ent
-0001be80: 7269 6531 732e 222c 0a20 2020 2020 2020  rie1s.",.       
-0001be90: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0001bea0: 2020 2020 2846 616c 7365 2c20 2261 6263      (False, "abc
-0001beb0: 222c 2022 7768 6572 6520 616e 6420 656e  ", "where and en
-0001bec0: 7472 6965 3173 2e62 6962 7465 7820 3d20  trie1s.bibtex = 
-0001bed0: 3f20 222c 2022 6a6f 696e 2022 2c20 2822  ? ", "join ", ("
-0001bee0: 6162 6322 2c29 292c 0a20 2020 2020 2020  abc",)),.       
-0001bef0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0001bf00: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0001bf10: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0001bf20: 4442 2e62 6962 732e 5f70 726f 6365 7373  DB.bibs._process
-0001bf30: 5175 6572 7946 6965 6c64 7328 0a20 2020  QueryFields(.   
-0001bf40: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-0001bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf60: 2020 2022 6c6f 6769 6361 6c22 3a20 2261     "logical": "a
-0001bf70: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
-0001bf80: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-0001bf90: 2022 4361 7465 676f 7269 6573 222c 0a20   "Categories",. 
-0001bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bfb0: 2020 2022 636f 6e74 656e 7422 3a20 2231     "content": "1
-0001bfc0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001bfd0: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-0001bfe0: 223a 2022 6174 206c 6561 7374 206f 6e65  ": "at least one
-0001bff0: 2061 6d6f 6e67 222c 0a20 2020 2020 2020   among",.       
-0001c000: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
-0001c010: 656c 6422 3a20 2262 6962 7465 7822 2c0a  eld": "bibtex",.
-0001c020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c030: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0001c040: 2020 2046 616c 7365 2c0a 2020 2020 2020     False,.      
-0001c050: 2020 2020 2020 2020 2020 2261 6263 222c            "abc",
-0001c060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c070: 2022 7768 6572 6520 222c 0a20 2020 2020   "where ",.     
-0001c080: 2020 2020 2020 2020 2020 2022 6a6f 696e             "join
-0001c090: 2022 2c0a 2020 2020 2020 2020 2020 2020   ",.            
-0001c0a0: 2020 2020 2829 2c0a 2020 2020 2020 2020      (),.        
-0001c0b0: 2020 2020 2020 2020 7072 6570 656e 6454          prependT
-0001c0c0: 6162 3d22 656e 7472 6965 3173 2e22 2c0a  ab="entrie1s.",.
-0001c0d0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001c0e0: 2020 2020 2020 2020 2020 2028 0a20 2020             (.   
-0001c0f0: 2020 2020 2020 2020 2020 2020 2046 616c               Fal
-0001c100: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-0001c110: 2020 2020 2261 6263 222c 0a20 2020 2020      "abc",.     
-0001c120: 2020 2020 2020 2020 2020 2022 7768 6572             "wher
-0001c130: 6520 616e 6420 656e 7472 7943 6174 732e  e and entryCats.
-0001c140: 6964 4361 7420 3d20 3f20 2022 2c0a 2020  idCat = ?  ",.  
-0001c150: 2020 2020 2020 2020 2020 2020 2020 226a                "j
-0001c160: 6f69 6e20 206c 6566 7420 6a6f 696e 2065  oin  left join e
-0001c170: 6e74 7279 4361 7473 206f 6e20 656e 7472  ntryCats on entr
-0001c180: 6965 732e 6269 626b 6579 3d65 6e74 7279  ies.bibkey=entry
-0001c190: 4361 7473 2e62 6962 6b65 7922 2c0a 2020  Cats.bibkey",.  
-0001c1a0: 2020 2020 2020 2020 2020 2020 2020 2822                ("
-0001c1b0: 3122 2c29 2c0a 2020 2020 2020 2020 2020  1",),.          
-0001c1c0: 2020 292c 0a20 2020 2020 2020 2029 0a20    ),.        ). 
-0001c1d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001c1e0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-0001c1f0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-0001c200: 6962 732e 5f70 726f 6365 7373 5175 6572  ibs._processQuer
-0001c210: 7946 6965 6c64 7328 0a20 2020 2020 2020  yFields(.       
-0001c220: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-0001c230: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001c240: 6c6f 6769 6361 6c22 3a20 2261 6263 222c  logical": "abc",
+00012d60: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00012d70: 2020 2020 2020 2269 6e73 7069 7265 223a        "inspire":
+00012d80: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00012d90: 2020 2020 2020 2020 2022 636f 6d6d 656e           "commen
+00012da0: 7473 223a 2022 222c 0a20 2020 2020 2020  ts": "",.       
+00012db0: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
+00012dc0: 6d65 223a 2022 6578 7032 222c 0a20 2020  me": "exp2",.   
+00012dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012de0: 2022 6269 626b 6579 223a 2022 6465 6667   "bibkey": "defg
+00012df0: 6869 222c 0a20 2020 2020 2020 2020 2020  hi",.           
+00012e00: 2020 2020 2020 2020 2022 6964 456e 4578           "idEnEx
+00012e10: 223a 2032 2c0a 2020 2020 2020 2020 2020  ": 2,.          
+00012e20: 2020 2020 2020 2020 2020 2268 6f6d 6570            "homep
+00012e30: 6167 6522 3a20 2222 2c0a 2020 2020 2020  age": "",.      
+00012e40: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+00012e50: 6445 7870 223a 2032 2c0a 2020 2020 2020  dExp": 2,.      
+00012e60: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00012e70: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00012e80: 2020 2020 290a 0a0a 4075 6e69 7474 6573      )...@unittes
+00012e90: 742e 736b 6970 4966 2873 6b69 7054 6573  t.skipIf(skipTes
+00012ea0: 7473 5365 7474 696e 6773 2e64 622c 2022  tsSettings.db, "
+00012eb0: 4461 7461 6261 7365 2074 6573 7473 2229  Database tests")
+00012ec0: 0a40 7061 7463 6828 226c 6f67 6769 6e67  .@patch("logging
+00012ed0: 2e4c 6f67 6765 722e 6465 6275 6722 290a  .Logger.debug").
+00012ee0: 4070 6174 6368 2822 6c6f 6767 696e 672e  @patch("logging.
+00012ef0: 4c6f 6767 6572 2e69 6e66 6f22 290a 4070  Logger.info").@p
+00012f00: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
+00012f10: 6767 6572 2e77 6172 6e69 6e67 2229 0a40  gger.warning").@
+00012f20: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
+00012f30: 6f67 6765 722e 6578 6365 7074 696f 6e22  ogger.exception"
+00012f40: 290a 636c 6173 7320 5465 7374 4461 7461  ).class TestData
+00012f50: 6261 7365 4361 7465 676f 7269 6573 2844  baseCategories(D
+00012f60: 4254 6573 7443 6173 6529 3a0a 2020 2020  BTestCase):.    
+00012f70: 2222 2254 6573 7473 2066 6f72 2074 6865  """Tests for the
+00012f80: 206d 6574 686f 6473 2069 6e20 7468 6520   methods in the 
+00012f90: 6361 7465 676f 7269 6573 2073 7562 636c  categories subcl
+00012fa0: 6173 7322 2222 0a0a 2020 2020 6465 6620  ass"""..    def 
+00012fb0: 6368 6563 6b4e 756d 6265 7243 6174 6567  checkNumberCateg
+00012fc0: 6f72 6965 7328 7365 6c66 2c20 6e75 6d62  ories(self, numb
+00012fd0: 6572 293a 0a20 2020 2020 2020 2022 2222  er):.        """
+00012fe0: 4368 6563 6b20 7468 6520 6e75 6d62 6572  Check the number
+00012ff0: 206f 6620 6578 7065 7269 6d65 6e74 7322   of experiments"
+00013000: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+00013010: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+00013020: 2e70 4244 422e 6361 7473 2e63 6f75 6e74  .pBDB.cats.count
+00013030: 2829 2c20 6e75 6d62 6572 290a 0a20 2020  (), number)..   
+00013040: 2064 6566 2074 6573 745f 696e 7365 7274   def test_insert
+00013050: 5570 6461 7465 4465 6c65 7465 2873 656c  UpdateDelete(sel
+00013060: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
+00013070: 2020 2022 2222 5465 7374 2069 6e73 6572     """Test inser
+00013080: 742c 2075 7064 6174 652c 2075 7064 6174  t, update, updat
+00013090: 6546 6965 6c64 2c20 6465 6c65 7465 2066  eField, delete f
+000130a0: 6f72 2061 6e20 6578 7065 7269 6d65 6e74  or an experiment
+000130b0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+000130c0: 2e63 6865 636b 4e75 6d62 6572 4361 7465  .checkNumberCate
+000130d0: 676f 7269 6573 2832 290a 2020 2020 2020  gories(2).      
+000130e0: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
+000130f0: 7365 2873 656c 662e 7042 4442 2e63 6174  se(self.pBDB.cat
+00013100: 732e 696e 7365 7274 287b 226e 616d 6522  s.insert({"name"
+00013110: 3a20 2263 6174 3122 7d29 290a 2020 2020  : "cat1"})).    
+00013120: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00013130: 7275 6528 0a20 2020 2020 2020 2020 2020  rue(.           
+00013140: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
+00013150: 696e 7365 7274 280a 2020 2020 2020 2020  insert(.        
+00013160: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00013170: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00013180: 616d 6522 3a20 2263 6174 3122 2c0a 2020  ame": "cat1",.  
+00013190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131a0: 2020 2263 6f6d 6d65 6e74 7322 3a20 2222    "comments": ""
+000131b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000131c0: 2020 2020 2020 2264 6573 6372 6970 7469        "descripti
+000131d0: 6f6e 223a 2022 222c 0a20 2020 2020 2020  on": "",.       
+000131e0: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
+000131f0: 7265 6e74 4361 7422 3a20 2230 222c 0a20  rentCat": "0",. 
+00013200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013210: 2020 2022 6f72 6422 3a20 2230 222c 0a20     "ord": "0",. 
+00013220: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00013230: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00013240: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00013250: 2073 656c 662e 6368 6563 6b4e 756d 6265   self.checkNumbe
+00013260: 7243 6174 6567 6f72 6965 7328 3329 0a20  rCategories(3). 
+00013270: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00013280: 7274 4661 6c73 6528 0a20 2020 2020 2020  rtFalse(.       
+00013290: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
+000132a0: 6174 732e 696e 7365 7274 280a 2020 2020  ats.insert(.    
+000132b0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+000132c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000132d0: 2020 226e 616d 6522 3a20 2263 6174 3122    "name": "cat1"
+000132e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000132f0: 2020 2020 2020 2263 6f6d 6d65 6e74 7322        "comments"
+00013300: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00013310: 2020 2020 2020 2020 2020 2264 6573 6372            "descr
+00013320: 6970 7469 6f6e 223a 2022 222c 0a20 2020  iption": "",.   
+00013330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013340: 2022 7061 7265 6e74 4361 7422 3a20 2230   "parentCat": "0
+00013350: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00013360: 2020 2020 2020 2022 6f72 6422 3a20 2231         "ord": "1
+00013370: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00013380: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00013390: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
+000133a0: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+000133b0: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
+000133c0: 696e 666f 2229 2061 7320 5f69 3a0a 2020  info") as _i:.  
+000133d0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000133e0: 4244 422e 6361 7473 2e69 6e73 6572 7428  BDB.cats.insert(
+000133f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013400: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00013410: 2020 2020 2020 2022 6e61 6d65 223a 2022         "name": "
+00013420: 6361 7431 222c 0a20 2020 2020 2020 2020  cat1",.         
+00013430: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
+00013440: 656e 7473 223a 2022 222c 0a20 2020 2020  ents": "",.     
+00013450: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00013460: 6465 7363 7269 7074 696f 6e22 3a20 2222  description": ""
+00013470: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013480: 2020 2020 2020 2270 6172 656e 7443 6174        "parentCat
+00013490: 223a 2022 3022 2c0a 2020 2020 2020 2020  ": "0",.        
+000134a0: 2020 2020 2020 2020 2020 2020 226f 7264              "ord
+000134b0: 223a 2022 3122 2c0a 2020 2020 2020 2020  ": "1",.        
+000134c0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+000134d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000134e0: 2020 2020 5f69 2e61 7373 6572 745f 6361      _i.assert_ca
+000134f0: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
+00013500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013510: 2241 6e20 656e 7472 7920 7769 7468 2074  "An entry with t
+00013520: 6865 2073 616d 6520 6e61 6d65 2069 7320  he same name is 
+00013530: 616c 7265 6164 7920 7072 6573 656e 7420  already present 
+00013540: 696e 2022 0a20 2020 2020 2020 2020 2020  in ".           
+00013550: 2020 2020 202b 2022 7468 6520 7361 6d65       + "the same
+00013560: 2063 6174 6567 6f72 7921 220a 2020 2020   category!".    
+00013570: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00013580: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+00013590: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
+000135a0: 656c 662e 7042 4442 2e63 6174 732e 696e  elf.pBDB.cats.in
+000135b0: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
+000135c0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+000135d0: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
+000135e0: 6522 3a20 2263 6174 3122 2c0a 2020 2020  e": "cat1",.    
+000135f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013600: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
+00013610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013620: 2020 2020 2264 6573 6372 6970 7469 6f6e      "description
+00013630: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+00013640: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
+00013650: 6e74 4361 7422 3a20 2231 222c 0a20 2020  ntCat": "1",.   
+00013660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013670: 2022 6f72 6422 3a20 2231 222c 0a20 2020   "ord": "1",.   
+00013680: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+00013690: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000136a0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+000136b0: 656c 662e 6368 6563 6b4e 756d 6265 7243  elf.checkNumberC
+000136c0: 6174 6567 6f72 6965 7328 3429 0a20 2020  ategories(4).   
+000136d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000136e0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+000136f0: 2020 207b 655b 2269 6443 6174 225d 3a20     {e["idCat"]: 
+00013700: 655b 226e 616d 6522 5d20 666f 7220 6520  e["name"] for e 
+00013710: 696e 2073 656c 662e 7042 4442 2e63 6174  in self.pBDB.cat
+00013720: 732e 6765 7441 6c6c 2829 7d2c 0a20 2020  s.getAll()},.   
+00013730: 2020 2020 2020 2020 207b 303a 2022 4d61           {0: "Ma
+00013740: 696e 222c 2031 3a20 2254 6167 7322 2c20  in", 1: "Tags", 
+00013750: 323a 2022 6361 7431 222c 2033 3a20 2263  2: "cat1", 3: "c
+00013760: 6174 3122 7d2c 0a20 2020 2020 2020 2029  at1"},.        )
+00013770: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00013780: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00013790: 2020 2020 2020 207b 655b 2269 6443 6174         {e["idCat
+000137a0: 225d 3a20 655b 2270 6172 656e 7443 6174  "]: e["parentCat
+000137b0: 225d 2066 6f72 2065 2069 6e20 7365 6c66  "] for e in self
+000137c0: 2e70 4244 422e 6361 7473 2e67 6574 416c  .pBDB.cats.getAl
+000137d0: 6c28 297d 2c0a 2020 2020 2020 2020 2020  l()},.          
+000137e0: 2020 7b30 3a20 302c 2031 3a20 302c 2032    {0: 0, 1: 0, 2
+000137f0: 3a20 302c 2033 3a20 317d 2c0a 2020 2020  : 0, 3: 1},.    
+00013800: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00013810: 6c66 2e61 7373 6572 7454 7275 6528 0a20  lf.assertTrue(. 
+00013820: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00013830: 7042 4442 2e63 6174 732e 7570 6461 7465  pBDB.cats.update
+00013840: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00013850: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00013860: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
+00013870: 2263 6174 3222 2c0a 2020 2020 2020 2020  "cat2",.        
+00013880: 2020 2020 2020 2020 2020 2020 2263 6f6d              "com
+00013890: 6d65 6e74 7322 3a20 2222 2c0a 2020 2020  ments": "",.    
+000138a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138b0: 2264 6573 6372 6970 7469 6f6e 223a 2022  "description": "
+000138c0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000138d0: 2020 2020 2020 2022 7061 7265 6e74 4361         "parentCa
+000138e0: 7422 3a20 2231 222c 0a20 2020 2020 2020  t": "1",.       
+000138f0: 2020 2020 2020 2020 2020 2020 2022 6f72               "or
+00013900: 6422 3a20 302c 0a20 2020 2020 2020 2020  d": 0,.         
+00013910: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00013920: 2020 2020 2020 2020 2020 322c 0a20 2020            2,.   
+00013930: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00013940: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00013950: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00013960: 2020 2020 2020 2020 2020 207b 655b 2269             {e["i
+00013970: 6443 6174 225d 3a20 655b 226e 616d 6522  dCat"]: e["name"
+00013980: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
+00013990: 7042 4442 2e63 6174 732e 6765 7441 6c6c  pBDB.cats.getAll
+000139a0: 2829 7d2c 0a20 2020 2020 2020 2020 2020  ()},.           
+000139b0: 207b 303a 2022 4d61 696e 222c 2031 3a20   {0: "Main", 1: 
+000139c0: 2254 6167 7322 2c20 323a 2022 6361 7432  "Tags", 2: "cat2
+000139d0: 222c 2033 3a20 2263 6174 3122 7d2c 0a20  ", 3: "cat1"},. 
+000139e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000139f0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00013a00: 2873 656c 662e 7042 4442 2e63 6174 732e  (self.pBDB.cats.
+00013a10: 7570 6461 7465 4669 656c 6428 312c 2022  updateField(1, "
+00013a20: 6465 7363 7269 7074 696f 6e22 2c20 2261  description", "a
+00013a30: 6263 6422 2929 0a20 2020 2020 2020 2073  bcd")).        s
+00013a40: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00013a50: 0a20 2020 2020 2020 2020 2020 207b 655b  .            {e[
+00013a60: 2269 6443 6174 225d 3a20 655b 2264 6573  "idCat"]: e["des
+00013a70: 6372 6970 7469 6f6e 225d 2066 6f72 2065  cription"] for e
+00013a80: 2069 6e20 7365 6c66 2e70 4244 422e 6361   in self.pBDB.ca
+00013a90: 7473 2e67 6574 416c 6c28 297d 2c0a 2020  ts.getAll()},.  
+00013aa0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00013ab0: 2020 2020 2020 2020 2020 2020 303a 2022              0: "
+00013ac0: 5468 6973 2069 7320 7468 6520 6d61 696e  This is the main
+00013ad0: 2063 6174 6567 6f72 792e 2041 6c6c 2074   category. All t
+00013ae0: 6865 206f 7468 6572 206f 6e65 7320 6172  he other ones ar
+00013af0: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
+00013b00: 2020 2020 2b20 2273 7562 6361 7465 676f      + "subcatego
+00013b10: 7269 6573 206f 6620 7468 6973 206f 6e65  ries of this one
+00013b20: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00013b30: 2020 2031 3a20 2261 6263 6422 2c0a 2020     1: "abcd",.  
+00013b40: 2020 2020 2020 2020 2020 2020 2020 323a                2:
+00013b50: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00013b60: 2020 2020 2033 3a20 2222 2c0a 2020 2020       3: "",.    
+00013b70: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00013b80: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00013b90: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
+00013ba0: 6c66 2e70 4244 422e 6361 7473 2e75 7064  lf.pBDB.cats.upd
+00013bb0: 6174 6528 7b22 6e61 6d65 223a 2022 6361  ate({"name": "ca
+00013bc0: 7432 222c 2022 636f 6d6d 656e 7473 223a  t2", "comments":
+00013bd0: 2022 227d 2c20 3229 290a 2020 2020 2020   ""}, 2)).      
+00013be0: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
+00013bf0: 7365 2873 656c 662e 7042 4442 2e63 6174  se(self.pBDB.cat
+00013c00: 732e 7570 6461 7465 4669 656c 6428 312c  s.updateField(1,
+00013c10: 2022 696e 7370 6972 6573 222c 2022 6162   "inspires", "ab
+00013c20: 6322 2929 0a20 2020 2020 2020 2073 656c  c")).        sel
+00013c30: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
+00013c40: 6c66 2e70 4244 422e 6361 7473 2e75 7064  lf.pBDB.cats.upd
+00013c50: 6174 6546 6965 6c64 2831 2c20 2269 6443  ateField(1, "idC
+00013c60: 6174 222c 2022 3222 2929 0a20 2020 2020  at", "2")).     
+00013c70: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
+00013c80: 6c73 6528 7365 6c66 2e70 4244 422e 6361  lse(self.pBDB.ca
+00013c90: 7473 2e75 7064 6174 6546 6965 6c64 2831  ts.updateField(1
+00013ca0: 2c20 2270 6172 656e 7443 6174 222c 204e  , "parentCat", N
+00013cb0: 6f6e 6529 290a 2020 2020 2020 2020 7365  one)).        se
+00013cc0: 6c66 2e63 6865 636b 4e75 6d62 6572 4361  lf.checkNumberCa
+00013cd0: 7465 676f 7269 6573 2834 290a 2020 2020  tegories(4).    
+00013ce0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00013cf0: 7275 6528 7365 6c66 2e70 4244 422e 6361  rue(self.pBDB.ca
+00013d00: 7445 7870 2e69 6e73 6572 7428 322c 2031  tExp.insert(2, 1
+00013d10: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+00013d20: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+00013d30: 7042 4442 2e63 6174 4269 622e 696e 7365  pBDB.catBib.inse
+00013d40: 7274 2832 2c20 2274 6573 7422 2929 0a20  rt(2, "test")). 
+00013d50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00013d60: 7274 5472 7565 280a 2020 2020 2020 2020  rtTrue(.        
+00013d70: 2020 2020 7365 6c66 2e70 4244 422e 6361      self.pBDB.ca
+00013d80: 7473 2e69 6e73 6572 7428 0a20 2020 2020  ts.insert(.     
+00013d90: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00013da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013db0: 2022 6e61 6d65 223a 2022 6361 7433 222c   "name": "cat3",
+00013dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013dd0: 2020 2020 2022 636f 6d6d 656e 7473 223a       "comments":
+00013de0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00013df0: 2020 2020 2020 2020 2022 6465 7363 7269           "descri
+00013e00: 7074 696f 6e22 3a20 2222 2c0a 2020 2020  ption": "",.    
+00013e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e20: 2270 6172 656e 7443 6174 223a 2022 3322  "parentCat": "3"
+00013e30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013e40: 2020 2020 2020 226f 7264 223a 2022 3122        "ord": "1"
+00013e50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013e60: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+00013e70: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00013e80: 2020 2020 6462 5374 6174 7328 7365 6c66      dbStats(self
+00013e90: 2e70 4244 4229 0a20 2020 2020 2020 2073  .pBDB).        s
+00013ea0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00013eb0: 7365 6c66 2e70 4244 422e 7374 6174 735b  self.pBDB.stats[
+00013ec0: 2263 6174 7322 5d2c 2035 290a 2020 2020  "cats"], 5).    
+00013ed0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00013ee0: 7175 616c 2873 656c 662e 7042 4442 2e73  qual(self.pBDB.s
+00013ef0: 7461 7473 5b22 6361 7445 7870 225d 2c20  tats["catExp"], 
+00013f00: 3129 0a20 2020 2020 2020 2073 656c 662e  1).        self.
+00013f10: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+00013f20: 2e70 4244 422e 7374 6174 735b 2263 6174  .pBDB.stats["cat
+00013f30: 4269 6222 5d2c 2031 290a 2020 2020 2020  Bib"], 1).      
+00013f40: 2020 7365 6c66 2e70 4244 422e 6361 7473    self.pBDB.cats
+00013f50: 2e64 656c 6574 6528 5b32 2c20 335d 290a  .delete([2, 3]).
+00013f60: 2020 2020 2020 2020 7365 6c66 2e63 6865          self.che
+00013f70: 636b 4e75 6d62 6572 4361 7465 676f 7269  ckNumberCategori
+00013f80: 6573 2832 290a 2020 2020 2020 2020 6462  es(2).        db
+00013f90: 5374 6174 7328 7365 6c66 2e70 4244 4229  Stats(self.pBDB)
+00013fa0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00013fb0: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00013fc0: 4244 422e 7374 6174 735b 2263 6174 4578  BDB.stats["catEx
+00013fd0: 7022 5d2c 2030 290a 2020 2020 2020 2020  p"], 0).        
+00013fe0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00013ff0: 2873 656c 662e 7042 4442 2e73 7461 7473  (self.pBDB.stats
+00014000: 5b22 6361 7442 6962 225d 2c20 3029 0a20  ["catBib"], 0). 
+00014010: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+00014020: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
+00014030: 722e 696e 666f 2229 2061 7320 5f69 3a0a  r.info") as _i:.
+00014040: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00014050: 2e70 4244 422e 6361 7473 2e64 656c 6574  .pBDB.cats.delet
+00014060: 6528 3029 0a20 2020 2020 2020 2020 2020  e(0).           
+00014070: 205f 692e 6173 7365 7274 5f63 616c 6c65   _i.assert_calle
+00014080: 645f 6f6e 6365 5f77 6974 6828 2259 6f75  d_once_with("You
+00014090: 2073 686f 756c 6420 6e6f 7420 6465 6c65   should not dele
+000140a0: 7465 2074 6865 2063 6174 6567 6f72 7920  te the category 
+000140b0: 7769 7468 2069 643a 2030 2e22 290a 2020  with id: 0.").  
+000140c0: 2020 2020 2020 7365 6c66 2e63 6865 636b        self.check
+000140d0: 4e75 6d62 6572 4361 7465 676f 7269 6573  NumberCategories
+000140e0: 2832 290a 2020 2020 2020 2020 7769 7468  (2).        with
+000140f0: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
+00014100: 4c6f 6767 6572 2e69 6e66 6f22 2920 6173  Logger.info") as
+00014110: 205f 693a 0a20 2020 2020 2020 2020 2020   _i:.           
+00014120: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
+00014130: 6465 6c65 7465 2831 290a 2020 2020 2020  delete(1).      
+00014140: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
+00014150: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+00014160: 2822 596f 7520 7368 6f75 6c64 206e 6f74  ("You should not
+00014170: 2064 656c 6574 6520 7468 6520 6361 7465   delete the cate
+00014180: 676f 7279 2077 6974 6820 6964 3a20 312e  gory with id: 1.
+00014190: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+000141a0: 6368 6563 6b4e 756d 6265 7243 6174 6567  checkNumberCateg
+000141b0: 6f72 6965 7328 3229 0a0a 2020 2020 6465  ories(2)..    de
+000141c0: 6620 7465 7374 5f67 6574 2873 656c 662c  f test_get(self,
+000141d0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
+000141e0: 2022 2222 5465 7374 2067 6574 206d 6574   """Test get met
+000141f0: 686f 6473 2222 220a 2020 2020 2020 2020  hods""".        
+00014200: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+00014210: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00014220: 662e 7042 4442 2e63 6174 732e 696e 7365  f.pBDB.cats.inse
+00014230: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
+00014240: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00014250: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00014260: 3a20 2263 6174 3122 2c0a 2020 2020 2020  : "cat1",.      
+00014270: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00014280: 6f6d 6d65 6e74 7322 3a20 2222 2c0a 2020  omments": "",.  
+00014290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000142a0: 2020 2264 6573 6372 6970 7469 6f6e 223a    "description":
+000142b0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+000142c0: 2020 2020 2020 2020 2022 7061 7265 6e74           "parent
+000142d0: 4361 7422 3a20 2231 222c 0a20 2020 2020  Cat": "1",.     
+000142e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000142f0: 6f72 6422 3a20 2230 222c 0a20 2020 2020  ord": "0",.     
+00014300: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+00014310: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00014320: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00014330: 662e 6173 7365 7274 5472 7565 280a 2020  f.assertTrue(.  
+00014340: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00014350: 4244 422e 6361 7473 2e69 6e73 6572 7428  BDB.cats.insert(
+00014360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014370: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00014380: 2020 2020 2020 2022 6e61 6d65 223a 2022         "name": "
+00014390: 6361 7432 222c 0a20 2020 2020 2020 2020  cat2",.         
+000143a0: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
+000143b0: 656e 7473 223a 2022 222c 0a20 2020 2020  ents": "",.     
+000143c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000143d0: 6465 7363 7269 7074 696f 6e22 3a20 2222  description": ""
+000143e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000143f0: 2020 2020 2020 2270 6172 656e 7443 6174        "parentCat
+00014400: 223a 2022 3122 2c0a 2020 2020 2020 2020  ": "1",.        
+00014410: 2020 2020 2020 2020 2020 2020 226f 7264              "ord
+00014420: 223a 2022 3022 2c0a 2020 2020 2020 2020  ": "0",.        
+00014430: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00014440: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00014450: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
+00014460: 6865 636b 4e75 6d62 6572 4361 7465 676f  heckNumberCatego
+00014470: 7269 6573 2834 290a 2020 2020 2020 2020  ries(4).        
+00014480: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00014490: 280a 2020 2020 2020 2020 2020 2020 5b64  (.            [d
+000144a0: 6963 7428 6529 2066 6f72 2065 2069 6e20  ict(e) for e in 
+000144b0: 7365 6c66 2e70 4244 422e 6361 7473 2e67  self.pBDB.cats.g
+000144c0: 6574 416c 6c28 295d 2c0a 2020 2020 2020  etAll()],.      
+000144d0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+000144e0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+000144f0: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+00014500: 6443 6174 223a 2030 2c0a 2020 2020 2020  dCat": 0,.      
+00014510: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00014520: 616d 6522 3a20 224d 6169 6e22 2c0a 2020  ame": "Main",.  
+00014530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014540: 2020 2263 6f6d 6d65 6e74 7322 3a20 2222    "comments": ""
+00014550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014560: 2020 2020 2020 2264 6573 6372 6970 7469        "descripti
+00014570: 6f6e 223a 2022 5468 6973 2069 7320 7468  on": "This is th
+00014580: 6520 6d61 696e 2063 6174 6567 6f72 792e  e main category.
+00014590: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+000145a0: 2020 2020 2020 202b 2022 416c 6c20 7468         + "All th
+000145b0: 6520 6f74 6865 7220 6f6e 6573 2061 7265  e other ones are
+000145c0: 2073 7562 6361 7465 676f 7269 6573 206f   subcategories o
+000145d0: 6620 7468 6973 206f 6e65 222c 0a20 2020  f this one",.   
+000145e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000145f0: 2022 7061 7265 6e74 4361 7422 3a20 302c   "parentCat": 0,
+00014600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014610: 2020 2020 2022 6f72 6422 3a20 302c 0a20       "ord": 0,. 
+00014620: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00014630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014640: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00014650: 2020 2020 2020 2020 2269 6443 6174 223a          "idCat":
+00014660: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
+00014670: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
+00014680: 2254 6167 7322 2c0a 2020 2020 2020 2020  "Tags",.        
+00014690: 2020 2020 2020 2020 2020 2020 2263 6f6d              "com
+000146a0: 6d65 6e74 7322 3a20 2222 2c0a 2020 2020  ments": "",.    
+000146b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000146c0: 2264 6573 6372 6970 7469 6f6e 223a 2022  "description": "
+000146d0: 5573 6520 7468 6973 2063 6174 6567 6f72  Use this categor
+000146e0: 7920 746f 2073 746f 7265 2074 6167 7320  y to store tags 
+000146f0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00014700: 2020 2020 2020 2b20 2228 7375 6368 2061        + "(such a
+00014710: 733a 206f 6e67 6f69 6e67 2070 726f 6a65  s: ongoing proje
+00014720: 6374 732c 2074 656d 706f 7261 7279 2063  cts, temporary c
+00014730: 6174 732c 2e2e 2e29 222c 0a20 2020 2020  ats,...)",.     
+00014740: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00014750: 7061 7265 6e74 4361 7422 3a20 302c 0a20  parentCat": 0,. 
+00014760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014770: 2020 2022 6f72 6422 3a20 302c 0a20 2020     "ord": 0,.   
+00014780: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00014790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000147a0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000147b0: 2020 2020 2020 2269 6443 6174 223a 2032        "idCat": 2
+000147c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000147d0: 2020 2020 2020 226e 616d 6522 3a20 2263        "name": "c
+000147e0: 6174 3122 2c0a 2020 2020 2020 2020 2020  at1",.          
+000147f0: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
+00014800: 6e74 7322 3a20 2222 2c0a 2020 2020 2020  nts": "",.      
+00014810: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00014820: 6573 6372 6970 7469 6f6e 223a 2022 222c  escription": "",
+00014830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014840: 2020 2020 2022 7061 7265 6e74 4361 7422       "parentCat"
+00014850: 3a20 312c 0a20 2020 2020 2020 2020 2020  : 1,.           
+00014860: 2020 2020 2020 2020 2022 6f72 6422 3a20           "ord": 
+00014870: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+00014880: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+00014890: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+000148a0: 2020 2020 2020 2020 2020 2020 2269 6443              "idC
+000148b0: 6174 223a 2033 2c0a 2020 2020 2020 2020  at": 3,.        
+000148c0: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
+000148d0: 6522 3a20 2263 6174 3222 2c0a 2020 2020  e": "cat2",.    
+000148e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000148f0: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
+00014900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014910: 2020 2020 2264 6573 6372 6970 7469 6f6e      "description
+00014920: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+00014930: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
+00014940: 6e74 4361 7422 3a20 312c 0a20 2020 2020  ntCat": 1,.     
+00014950: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00014960: 6f72 6422 3a20 302c 0a20 2020 2020 2020  ord": 0,.       
+00014970: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+00014980: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+00014990: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+000149a0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+000149b0: 2020 2020 2020 2020 2020 205b 6469 6374             [dict
+000149c0: 2865 2920 666f 7220 6520 696e 2073 656c  (e) for e in sel
+000149d0: 662e 7042 4442 2e63 6174 732e 6765 7442  f.pBDB.cats.getB
+000149e0: 7949 4428 3229 5d2c 0a20 2020 2020 2020  yID(2)],.       
+000149f0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+00014a00: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+00014a10: 2020 2020 2020 2020 2020 2020 2022 6964               "id
+00014a20: 4361 7422 3a20 322c 0a20 2020 2020 2020  Cat": 2,.       
+00014a30: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
+00014a40: 6d65 223a 2022 6361 7431 222c 0a20 2020  me": "cat1",.   
+00014a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a60: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
+00014a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014a80: 2020 2020 2022 6465 7363 7269 7074 696f       "descriptio
+00014a90: 6e22 3a20 2222 2c0a 2020 2020 2020 2020  n": "",.        
+00014aa0: 2020 2020 2020 2020 2020 2020 2270 6172              "par
+00014ab0: 656e 7443 6174 223a 2031 2c0a 2020 2020  entCat": 1,.    
+00014ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ad0: 226f 7264 223a 2030 2c0a 2020 2020 2020  "ord": 0,.      
+00014ae0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00014af0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+00014b00: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00014b10: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00014b20: 2020 2020 2020 2020 2020 205b 6469 6374             [dict
+00014b30: 2865 2920 666f 7220 6520 696e 2073 656c  (e) for e in sel
+00014b40: 662e 7042 4442 2e63 6174 732e 6765 7442  f.pBDB.cats.getB
+00014b50: 794e 616d 6528 2263 6174 3222 295d 2c0a  yName("cat2")],.
+00014b60: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00014b70: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+00014b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b90: 2020 2020 2269 6443 6174 223a 2033 2c0a      "idCat": 3,.
+00014ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014bb0: 2020 2020 226e 616d 6522 3a20 2263 6174      "name": "cat
+00014bc0: 3222 2c0a 2020 2020 2020 2020 2020 2020  2",.            
+00014bd0: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
+00014be0: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
+00014bf0: 2020 2020 2020 2020 2020 2020 2264 6573              "des
+00014c00: 6372 6970 7469 6f6e 223a 2022 222c 0a20  cription": "",. 
+00014c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014c20: 2020 2022 7061 7265 6e74 4361 7422 3a20     "parentCat": 
+00014c30: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+00014c40: 2020 2020 2020 2022 6f72 6422 3a20 302c         "ord": 0,
+00014c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014c60: 207d 0a20 2020 2020 2020 2020 2020 205d   }.            ]
+00014c70: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00014c80: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00014c90: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00014ca0: 2020 7365 6c66 2e70 4244 422e 6361 7473    self.pBDB.cats
+00014cb0: 2e67 6574 4469 6374 4279 4944 2832 292c  .getDictByID(2),
+00014cc0: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+00014cd0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00014ce0: 6964 4361 7422 3a20 322c 0a20 2020 2020  idCat": 2,.     
+00014cf0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+00014d00: 223a 2022 6361 7431 222c 0a20 2020 2020  ": "cat1",.     
+00014d10: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
+00014d20: 656e 7473 223a 2022 222c 0a20 2020 2020  ents": "",.     
+00014d30: 2020 2020 2020 2020 2020 2022 6465 7363             "desc
+00014d40: 7269 7074 696f 6e22 3a20 2222 2c0a 2020  ription": "",.  
+00014d50: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00014d60: 6172 656e 7443 6174 223a 2031 2c0a 2020  arentCat": 1,.  
+00014d70: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+00014d80: 7264 223a 2030 2c0a 2020 2020 2020 2020  rd": 0,.        
+00014d90: 2020 2020 7d2c 0a20 2020 2020 2020 2029      },.        )
+00014da0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00014db0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00014dc0: 2020 2020 2020 205b 6469 6374 2865 2920         [dict(e) 
+00014dd0: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+00014de0: 4442 2e63 6174 732e 6765 7443 6869 6c64  DB.cats.getChild
+00014df0: 2830 295d 2c0a 2020 2020 2020 2020 2020  (0)],.          
+00014e00: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+00014e10: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00014e20: 2020 2020 2020 2020 2020 2269 6443 6174            "idCat
+00014e30: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
+00014e40: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00014e50: 3a20 224d 6169 6e22 2c0a 2020 2020 2020  : "Main",.      
+00014e60: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00014e70: 6f6d 6d65 6e74 7322 3a20 2222 2c0a 2020  omments": "",.  
+00014e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e90: 2020 2264 6573 6372 6970 7469 6f6e 223a    "description":
+00014ea0: 2022 5468 6973 2069 7320 7468 6520 6d61   "This is the ma
+00014eb0: 696e 2063 6174 6567 6f72 792e 2022 0a20  in category. ". 
+00014ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ed0: 2020 202b 2022 416c 6c20 7468 6520 6f74     + "All the ot
+00014ee0: 6865 7220 6f6e 6573 2061 7265 2073 7562  her ones are sub
+00014ef0: 6361 7465 676f 7269 6573 206f 6620 7468  categories of th
+00014f00: 6973 206f 6e65 222c 0a20 2020 2020 2020  is one",.       
+00014f10: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
+00014f20: 7265 6e74 4361 7422 3a20 302c 0a20 2020  rentCat": 0,.   
+00014f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014f40: 2022 6f72 6422 3a20 302c 0a20 2020 2020   "ord": 0,.     
+00014f50: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00014f60: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+00014f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014f80: 2020 2020 2269 6443 6174 223a 2031 2c0a      "idCat": 1,.
+00014f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fa0: 2020 2020 226e 616d 6522 3a20 2254 6167      "name": "Tag
+00014fb0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+00014fc0: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
+00014fd0: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
+00014fe0: 2020 2020 2020 2020 2020 2020 2264 6573              "des
+00014ff0: 6372 6970 7469 6f6e 223a 2022 5573 6520  cription": "Use 
+00015000: 7468 6973 2063 6174 6567 6f72 7920 746f  this category to
+00015010: 2073 746f 7265 2074 6167 7320 220a 2020   store tags ".  
+00015020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015030: 2020 2b20 2228 7375 6368 2061 733a 206f    + "(such as: o
+00015040: 6e67 6f69 6e67 2070 726f 6a65 6374 732c  ngoing projects,
+00015050: 2074 656d 706f 7261 7279 2063 6174 732c   temporary cats,
+00015060: 2e2e 2e29 222c 0a20 2020 2020 2020 2020  ...)",.         
+00015070: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
+00015080: 6e74 4361 7422 3a20 302c 0a20 2020 2020  ntCat": 0,.     
+00015090: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000150a0: 6f72 6422 3a20 302c 0a20 2020 2020 2020  ord": 0,.       
+000150b0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+000150c0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+000150d0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+000150e0: 662e 6173 7365 7274 4571 7561 6c28 5b64  f.assertEqual([d
+000150f0: 6963 7428 6529 2066 6f72 2065 2069 6e20  ict(e) for e in 
+00015100: 7365 6c66 2e70 4244 422e 6361 7473 2e67  self.pBDB.cats.g
+00015110: 6574 4368 696c 6428 3229 5d2c 205b 5d29  etChild(2)], [])
+00015120: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00015130: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00015140: 2020 2020 2020 205b 6469 6374 2865 2920         [dict(e) 
+00015150: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+00015160: 4442 2e63 6174 732e 6765 7450 6172 656e  DB.cats.getParen
+00015170: 7428 3129 5d2c 0a20 2020 2020 2020 2020  t(1)],.         
+00015180: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00015190: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+000151a0: 2020 2020 2020 2020 2020 2022 6964 4361             "idCa
+000151b0: 7422 3a20 302c 0a20 2020 2020 2020 2020  t": 0,.         
+000151c0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+000151d0: 223a 2022 4d61 696e 222c 0a20 2020 2020  ": "Main",.     
+000151e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000151f0: 636f 6d6d 656e 7473 223a 2022 222c 0a20  comments": "",. 
+00015200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015210: 2020 2022 6465 7363 7269 7074 696f 6e22     "description"
+00015220: 3a20 2254 6869 7320 6973 2074 6865 206d  : "This is the m
+00015230: 6169 6e20 6361 7465 676f 7279 2e20 220a  ain category. ".
+00015240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015250: 2020 2020 2b20 2241 6c6c 2074 6865 206f      + "All the o
+00015260: 7468 6572 206f 6e65 7320 6172 6520 7375  ther ones are su
+00015270: 6263 6174 6567 6f72 6965 7320 6f66 2074  bcategories of t
+00015280: 6869 7320 6f6e 6522 2c0a 2020 2020 2020  his one",.      
+00015290: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+000152a0: 6172 656e 7443 6174 223a 2030 2c0a 2020  arentCat": 0,.  
+000152b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000152c0: 2020 226f 7264 223a 2030 2c0a 2020 2020    "ord": 0,.    
+000152d0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+000152e0: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+000152f0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00015300: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00015310: 7365 6c66 2e70 4244 422e 6361 7473 2e67  self.pBDB.cats.g
+00015320: 6574 416c 6c43 6174 7349 6e54 7265 6528  etAllCatsInTree(
+00015330: 3029 2c20 5b30 2c20 312c 2032 2c20 335d  0), [0, 1, 2, 3]
+00015340: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00015350: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+00015360: 7042 4442 2e63 6174 732e 6765 7441 6c6c  pBDB.cats.getAll
+00015370: 4361 7473 496e 5472 6565 2831 292c 205b  CatsInTree(1), [
+00015380: 312c 2032 2c20 335d 290a 2020 2020 2020  1, 2, 3]).      
+00015390: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000153a0: 616c 2873 656c 662e 7042 4442 2e63 6174  al(self.pBDB.cat
+000153b0: 732e 6765 7441 6c6c 4361 7473 496e 5472  s.getAllCatsInTr
+000153c0: 6565 2832 292c 205b 325d 290a 2020 2020  ee(2), [2]).    
+000153d0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000153e0: 7175 616c 2873 656c 662e 7042 4442 2e63  qual(self.pBDB.c
+000153f0: 6174 732e 6765 7441 6c6c 4361 7473 496e  ats.getAllCatsIn
+00015400: 5472 6565 2835 292c 205b 5d29 0a0a 2020  Tree(5), [])..  
+00015410: 2020 6465 6620 7465 7374 5f67 6574 4279    def test_getBy
+00015420: 4f74 6865 7273 2873 656c 662c 202a 6172  Others(self, *ar
+00015430: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+00015440: 5465 7374 2067 6574 4279 4578 7020 616e  Test getByExp an
+00015450: 6420 6765 7442 7945 6e74 7279 2063 7265  d getByEntry cre
+00015460: 6174 696e 6720 736f 6d65 2066 616b 6520  ating some fake 
+00015470: 7265 636f 7264 7322 2222 0a20 2020 2020  records""".     
+00015480: 2020 2064 6174 6120 3d20 7365 6c66 2e70     data = self.p
+00015490: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
+000154a0: 496e 7365 7274 280a 2020 2020 2020 2020  Insert(.        
+000154b0: 2020 2020 275c 6e5c 6e25 636f 6d6d 656e      '\n\n%commen
+000154c0: 745c 6e40 6172 7469 636c 657b 6162 632c  t\n@article{abc,
+000154d0: 5c6e 6175 7468 6f72 203d 2022 6d65 222c  \nauthor = "me",
+000154e0: 5c6e 2720 2b20 2774 6974 6c65 203d 2022  \n' + 'title = "
+000154f0: 7469 746c 6522 2c7d 272c 0a20 2020 2020  title",}',.     
+00015500: 2020 2020 2020 2062 6962 6b65 793d 2261         bibkey="a
+00015510: 6263 222c 0a20 2020 2020 2020 2029 0a20  bc",.        ). 
+00015520: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00015530: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
+00015540: 2e62 6962 732e 696e 7365 7274 2864 6174  .bibs.insert(dat
+00015550: 6129 290a 2020 2020 2020 2020 7365 6c66  a)).        self
+00015560: 2e61 7373 6572 7454 7275 6528 0a20 2020  .assertTrue(.   
+00015570: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00015580: 4442 2e65 7870 732e 696e 7365 7274 280a  DB.exps.insert(.
+00015590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000155a0: 7b22 6e61 6d65 223a 2022 6578 7031 222c  {"name": "exp1",
+000155b0: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
+000155c0: 2022 686f 6d65 7061 6765 223a 2022 222c   "homepage": "",
+000155d0: 2022 696e 7370 6972 6522 3a20 2222 7d0a   "inspire": ""}.
+000155e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000155f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00015600: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+00015610: 7365 6c66 2e70 4244 422e 6361 7445 7870  self.pBDB.catExp
+00015620: 2e69 6e73 6572 7428 312c 2031 2929 0a20  .insert(1, 1)). 
+00015630: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00015640: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
+00015650: 2e63 6174 4269 622e 696e 7365 7274 2831  .catBib.insert(1
+00015660: 2c20 2261 6263 2229 290a 2020 2020 2020  , "abc")).      
+00015670: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00015680: 616c 2873 656c 662e 7042 4442 2e63 6174  al(self.pBDB.cat
+00015690: 732e 6765 7442 7945 6e74 7279 2822 6465  s.getByEntry("de
+000156a0: 6622 292c 205b 5d29 0a20 2020 2020 2020  f"), []).       
+000156b0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000156c0: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+000156d0: 6469 6374 2865 2920 666f 7220 6520 696e  dict(e) for e in
+000156e0: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
+000156f0: 6765 7442 7945 6e74 7279 2822 6162 6322  getByEntry("abc"
+00015700: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
+00015710: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00015720: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00015730: 2020 2020 2020 2020 2269 6443 6174 223a          "idCat":
+00015740: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
+00015750: 2020 2020 2020 2020 2270 6172 656e 7443          "parentC
+00015760: 6174 223a 2030 2c0a 2020 2020 2020 2020  at": 0,.        
+00015770: 2020 2020 2020 2020 2020 2020 2264 6573              "des
+00015780: 6372 6970 7469 6f6e 223a 2022 5573 6520  cription": "Use 
+00015790: 7468 6973 2063 6174 6567 6f72 7920 746f  this category to
+000157a0: 2073 746f 7265 2074 6167 7320 220a 2020   store tags ".  
+000157b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000157c0: 2020 2b20 2228 7375 6368 2061 733a 206f    + "(such as: o
+000157d0: 6e67 6f69 6e67 2070 726f 6a65 6374 732c  ngoing projects,
+000157e0: 2074 656d 706f 7261 7279 2063 6174 732c   temporary cats,
+000157f0: 2e2e 2e29 222c 0a20 2020 2020 2020 2020  ...)",.         
+00015800: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
+00015810: 656e 7473 223a 2022 222c 0a20 2020 2020  ents": "",.     
+00015820: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00015830: 6964 456e 4322 3a20 312c 0a20 2020 2020  idEnC": 1,.     
+00015840: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00015850: 6f72 6422 3a20 302c 0a20 2020 2020 2020  ord": 0,.       
+00015860: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+00015870: 626b 6579 223a 2022 6162 6322 2c0a 2020  bkey": "abc",.  
+00015880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015890: 2020 226e 616d 6522 3a20 2254 6167 7322    "name": "Tags"
+000158a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000158b0: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+000158c0: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+000158d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000158e0: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+000158f0: 6361 7473 2e67 6574 4279 4578 7028 2232  cats.getByExp("2
+00015900: 2229 2c20 5b5d 290a 2020 2020 2020 2020  "), []).        
+00015910: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00015920: 280a 2020 2020 2020 2020 2020 2020 5b64  (.            [d
+00015930: 6963 7428 6529 2066 6f72 2065 2069 6e20  ict(e) for e in 
+00015940: 7365 6c66 2e70 4244 422e 6361 7473 2e67  self.pBDB.cats.g
+00015950: 6574 4279 4578 7028 3129 5d2c 0a20 2020  etByExp(1)],.   
+00015960: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00015970: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00015980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015990: 2022 6964 4361 7422 3a20 312c 0a20 2020   "idCat": 1,.   
+000159a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159b0: 2022 6964 4578 7022 3a20 312c 0a20 2020   "idExp": 1,.   
+000159c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159d0: 2022 7061 7265 6e74 4361 7422 3a20 302c   "parentCat": 0,
+000159e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000159f0: 2020 2020 2022 6465 7363 7269 7074 696f       "descriptio
+00015a00: 6e22 3a20 2255 7365 2074 6869 7320 6361  n": "Use this ca
+00015a10: 7465 676f 7279 2074 6f20 7374 6f72 6520  tegory to store 
+00015a20: 7461 6773 2022 0a20 2020 2020 2020 2020  tags ".         
+00015a30: 2020 2020 2020 2020 2020 202b 2022 2873             + "(s
+00015a40: 7563 6820 6173 3a20 6f6e 676f 696e 6720  uch as: ongoing 
+00015a50: 7072 6f6a 6563 7473 2c20 7465 6d70 6f72  projects, tempor
+00015a60: 6172 7920 6361 7473 2c2e 2e2e 2922 2c0a  ary cats,...)",.
+00015a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a80: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
+00015a90: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+00015aa0: 2020 2020 2020 2020 2269 6445 7843 223a          "idExC":
+00015ab0: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
+00015ac0: 2020 2020 2020 2020 226f 7264 223a 2030          "ord": 0
+00015ad0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015ae0: 2020 2020 2020 226e 616d 6522 3a20 2254        "name": "T
+00015af0: 6167 7322 2c0a 2020 2020 2020 2020 2020  ags",.          
+00015b00: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00015b10: 2020 2020 5d2c 0a20 2020 2020 2020 2029      ],.        )
+00015b20: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00015b30: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00015b40: 4244 422e 6361 7473 2e67 6574 4279 4578  BDB.cats.getByEx
+00015b50: 7028 2232 2229 2c20 5b5d 290a 2020 2020  p("2"), []).    
+00015b60: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00015b70: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00015b80: 2020 5b64 6963 7428 6529 2066 6f72 2065    [dict(e) for e
+00015b90: 2069 6e20 7365 6c66 2e70 4244 422e 6361   in self.pBDB.ca
+00015ba0: 7473 2e67 6574 4279 456e 7472 6965 7328  ts.getByEntries(
+00015bb0: 5b22 6162 6322 2c20 2264 6566 6768 6922  ["abc", "defghi"
+00015bc0: 5d29 5d2c 0a20 2020 2020 2020 2020 2020  ])],.           
+00015bd0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00015be0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00015bf0: 2020 2020 2020 2020 2022 6964 4361 7422           "idCat"
+00015c00: 3a20 312c 0a20 2020 2020 2020 2020 2020  : 1,.           
+00015c10: 2020 2020 2020 2020 2022 7061 7265 6e74           "parent
+00015c20: 4361 7422 3a20 302c 0a20 2020 2020 2020  Cat": 0,.       
+00015c30: 2020 2020 2020 2020 2020 2020 2022 6465               "de
+00015c40: 7363 7269 7074 696f 6e22 3a20 2255 7365  scription": "Use
+00015c50: 2074 6869 7320 6361 7465 676f 7279 2074   this category t
+00015c60: 6f20 7374 6f72 6520 7461 6773 2022 0a20  o store tags ". 
+00015c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c80: 2020 202b 2022 2873 7563 6820 6173 3a20     + "(such as: 
+00015c90: 6f6e 676f 696e 6720 7072 6f6a 6563 7473  ongoing projects
+00015ca0: 2c20 7465 6d70 6f72 6172 7920 6361 7473  , temporary cats
+00015cb0: 2c2e 2e2e 2922 2c0a 2020 2020 2020 2020  ,...)",.        
+00015cc0: 2020 2020 2020 2020 2020 2020 2263 6f6d              "com
+00015cd0: 6d65 6e74 7322 3a20 2222 2c0a 2020 2020  ments": "",.    
+00015ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015cf0: 2269 6445 6e43 223a 2031 2c0a 2020 2020  "idEnC": 1,.    
+00015d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d10: 226f 7264 223a 2030 2c0a 2020 2020 2020  "ord": 0,.      
+00015d20: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+00015d30: 6962 6b65 7922 3a20 2261 6263 222c 0a20  ibkey": "abc",. 
+00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d50: 2020 2022 6e61 6d65 223a 2022 5461 6773     "name": "Tags
+00015d60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00015d70: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00015d80: 205d 2c0a 2020 2020 2020 2020 290a 2020   ],.        ).  
+00015d90: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
+00015da0: 662e 7042 4442 2e62 6962 732e 7072 6570  f.pBDB.bibs.prep
+00015db0: 6172 6549 6e73 6572 7428 0a20 2020 2020  areInsert(.     
+00015dc0: 2020 2020 2020 2027 5c6e 5c6e 2563 6f6d         '\n\n%com
+00015dd0: 6d65 6e74 5c6e 4061 7274 6963 6c65 7b64  ment\n@article{d
+00015de0: 6566 6768 692c 5c6e 6175 7468 6f72 203d  efghi,\nauthor =
+00015df0: 2022 6d65 222c 5c6e 2720 2b20 2774 6974   "me",\n' + 'tit
+00015e00: 6c65 203d 2022 7469 746c 6522 2c7d 272c  le = "title",}',
+00015e10: 0a20 2020 2020 2020 2020 2020 2062 6962  .            bib
+00015e20: 6b65 793d 2264 6566 6768 6922 2c0a 2020  key="defghi",.  
+00015e30: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00015e40: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+00015e50: 7365 6c66 2e70 4244 422e 6361 7442 6962  self.pBDB.catBib
+00015e60: 2e69 6e73 6572 7428 302c 2022 6465 6667  .insert(0, "defg
+00015e70: 6869 2229 290a 2020 2020 2020 2020 7365  hi")).        se
+00015e80: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00015e90: 2020 2020 2020 2020 2020 2020 5b64 6963              [dic
+00015ea0: 7428 6529 2066 6f72 2065 2069 6e20 7365  t(e) for e in se
+00015eb0: 6c66 2e70 4244 422e 6361 7473 2e67 6574  lf.pBDB.cats.get
+00015ec0: 4279 456e 7472 6965 7328 5b22 6162 6322  ByEntries(["abc"
+00015ed0: 2c20 2264 6566 6768 6922 5d29 5d2c 0a20  , "defghi"])],. 
+00015ee0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+00015ef0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+00015f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f10: 2020 2022 6964 4361 7422 3a20 312c 0a20     "idCat": 1,. 
+00015f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f30: 2020 2022 7061 7265 6e74 4361 7422 3a20     "parentCat": 
+00015f40: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+00015f50: 2020 2020 2020 2022 6465 7363 7269 7074         "descript
+00015f60: 696f 6e22 3a20 2255 7365 2074 6869 7320  ion": "Use this 
+00015f70: 6361 7465 676f 7279 2074 6f20 7374 6f72  category to stor
+00015f80: 6520 7461 6773 2022 0a20 2020 2020 2020  e tags ".       
+00015f90: 2020 2020 2020 2020 2020 2020 202b 2022               + "
+00015fa0: 2873 7563 6820 6173 3a20 6f6e 676f 696e  (such as: ongoin
+00015fb0: 6720 7072 6f6a 6563 7473 2c20 7465 6d70  g projects, temp
+00015fc0: 6f72 6172 7920 6361 7473 2c2e 2e2e 2922  orary cats,...)"
+00015fd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015fe0: 2020 2020 2020 2263 6f6d 6d65 6e74 7322        "comments"
+00015ff0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00016000: 2020 2020 2020 2020 2020 2269 6445 6e43            "idEnC
+00016010: 223a 2031 2c0a 2020 2020 2020 2020 2020  ": 1,.          
+00016020: 2020 2020 2020 2020 2020 226f 7264 223a            "ord":
+00016030: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+00016040: 2020 2020 2020 2020 2262 6962 6b65 7922          "bibkey"
+00016050: 3a20 2261 6263 222c 0a20 2020 2020 2020  : "abc",.       
+00016060: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
+00016070: 6d65 223a 2022 5461 6773 222c 0a20 2020  me": "Tags",.   
+00016080: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00016090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160a0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000160b0: 2020 2020 2020 2269 6443 6174 223a 2030        "idCat": 0
+000160c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000160d0: 2020 2020 2020 226e 616d 6522 3a20 224d        "name": "M
+000160e0: 6169 6e22 2c0a 2020 2020 2020 2020 2020  ain",.          
+000160f0: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
+00016100: 6e74 7322 3a20 2222 2c0a 2020 2020 2020  nts": "",.      
+00016110: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00016120: 6573 6372 6970 7469 6f6e 223a 2022 5468  escription": "Th
+00016130: 6973 2069 7320 7468 6520 6d61 696e 2063  is is the main c
+00016140: 6174 6567 6f72 792e 2022 0a20 2020 2020  ategory. ".     
+00016150: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+00016160: 2022 416c 6c20 7468 6520 6f74 6865 7220   "All the other 
+00016170: 6f6e 6573 2061 7265 2073 7562 6361 7465  ones are subcate
+00016180: 676f 7269 6573 206f 6620 7468 6973 206f  gories of this o
+00016190: 6e65 222c 0a20 2020 2020 2020 2020 2020  ne",.           
+000161a0: 2020 2020 2020 2020 2022 7061 7265 6e74           "parent
+000161b0: 4361 7422 3a20 302c 0a20 2020 2020 2020  Cat": 0,.       
+000161c0: 2020 2020 2020 2020 2020 2020 2022 6f72               "or
+000161d0: 6422 3a20 302c 0a20 2020 2020 2020 2020  d": 0,.         
+000161e0: 2020 2020 2020 2020 2020 2022 6964 456e             "idEn
+000161f0: 4322 3a20 322c 0a20 2020 2020 2020 2020  C": 2,.         
+00016200: 2020 2020 2020 2020 2020 2022 6269 626b             "bibk
+00016210: 6579 223a 2022 6465 6667 6869 222c 0a20  ey": "defghi",. 
+00016220: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00016230: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
+00016240: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00016250: 6465 6620 7465 7374 5f63 6174 5374 7269  def test_catStri
+00016260: 6e67 2873 656c 662c 202a 6172 6773 293a  ng(self, *args):
+00016270: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00016280: 2063 6174 5374 7269 6e67 2077 6974 6820   catString with 
+00016290: 6578 6973 7469 6e67 2061 6e64 206e 6f6e  existing and non
+000162a0: 2065 7869 7374 696e 6720 7265 636f 7264   existing record
+000162b0: 7322 2222 0a20 2020 2020 2020 2073 656c  s""".        sel
+000162c0: 662e 6173 7365 7274 4571 7561 6c28 6361  f.assertEqual(ca
+000162d0: 7453 7472 696e 6728 312c 2073 656c 662e  tString(1, self.
+000162e0: 7042 4442 292c 2022 2020 2031 3a20 5461  pBDB), "   1: Ta
+000162f0: 6773 2229 0a20 2020 2020 2020 2073 656c  gs").        sel
+00016300: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00016310: 2020 2020 2020 2020 2020 2063 6174 5374             catSt
+00016320: 7269 6e67 2831 2c20 7365 6c66 2e70 4244  ring(1, self.pBD
+00016330: 422c 2054 7275 6529 2c0a 2020 2020 2020  B, True),.      
+00016340: 2020 2020 2020 2220 2020 313a 2054 6167        "   1: Tag
+00016350: 7320 2d20 3c69 3e55 7365 2074 6869 7320  s - <i>Use this 
+00016360: 6361 7465 676f 7279 2074 6f20 7374 6f72  category to stor
+00016370: 6520 7461 6773 2022 0a20 2020 2020 2020  e tags ".       
+00016380: 2020 2020 202b 2022 2873 7563 6820 6173       + "(such as
+00016390: 3a20 6f6e 676f 696e 6720 7072 6f6a 6563  : ongoing projec
+000163a0: 7473 2c20 7465 6d70 6f72 6172 7920 6361  ts, temporary ca
+000163b0: 7473 2c2e 2e2e 293c 2f69 3e22 2c0a 2020  ts,...)</i>",.  
+000163c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000163d0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+000163e0: 2863 6174 5374 7269 6e67 2832 2c20 7365  (catString(2, se
+000163f0: 6c66 2e70 4244 4229 2c20 2222 290a 2020  lf.pBDB), "").  
+00016400: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+00016410: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
+00016420: 2e77 6172 6e69 6e67 2229 2061 7320 5f69  .warning") as _i
+00016430: 3a0a 2020 2020 2020 2020 2020 2020 6361  :.            ca
+00016440: 7453 7472 696e 6728 322c 2073 656c 662e  tString(2, self.
+00016450: 7042 4442 290a 2020 2020 2020 2020 2020  pBDB).          
+00016460: 2020 5f69 2e61 7373 6572 745f 616e 795f    _i.assert_any_
+00016470: 6361 6c6c 2822 4361 7465 676f 7279 2027  call("Category '
+00016480: 3227 206e 6f74 2069 6e20 6461 7461 6261  2' not in databa
+00016490: 7365 2229 0a0a 2020 2020 6465 6620 7465  se")..    def te
+000164a0: 7374 5f63 6174 735f 616c 7068 6162 6574  st_cats_alphabet
+000164b0: 6963 616c 2873 656c 662c 202a 6172 6773  ical(self, *args
+000164c0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+000164d0: 7374 2061 6c70 6861 6265 7469 6361 6c20  st alphabetical 
+000164e0: 6f72 6465 7269 6e67 206f 6620 6964 4361  ordering of idCa
+000164f0: 7473 2077 6974 6820 6361 7473 5f61 6c70  ts with cats_alp
+00016500: 6861 6265 7469 6361 6c22 2222 0a20 2020  habetical""".   
+00016510: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00016520: 5472 7565 280a 2020 2020 2020 2020 2020  True(.          
+00016530: 2020 7365 6c66 2e70 4244 422e 6361 7473    self.pBDB.cats
+00016540: 2e69 6e73 6572 7428 0a20 2020 2020 2020  .insert(.       
+00016550: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00016560: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00016570: 6e61 6d65 223a 2022 6322 2c0a 2020 2020  name": "c",.    
+00016580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016590: 2263 6f6d 6d65 6e74 7322 3a20 2222 2c0a  "comments": "",.
+000165a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000165b0: 2020 2020 2264 6573 6372 6970 7469 6f6e      "description
+000165c0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+000165d0: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
+000165e0: 6e74 4361 7422 3a20 2231 222c 0a20 2020  ntCat": "1",.   
+000165f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016600: 2022 6f72 6422 3a20 2230 222c 0a20 2020   "ord": "0",.   
+00016610: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+00016620: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00016630: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00016640: 656c 662e 6173 7365 7274 5472 7565 280a  elf.assertTrue(.
+00016650: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00016660: 2e70 4244 422e 6361 7473 2e69 6e73 6572  .pBDB.cats.inser
+00016670: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00016680: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00016690: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
+000166a0: 2022 6722 2c0a 2020 2020 2020 2020 2020   "g",.          
+000166b0: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
+000166c0: 6e74 7322 3a20 2222 2c0a 2020 2020 2020  nts": "",.      
+000166d0: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+000166e0: 6573 6372 6970 7469 6f6e 223a 2022 222c  escription": "",
+000166f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016700: 2020 2020 2022 7061 7265 6e74 4361 7422       "parentCat"
+00016710: 3a20 2231 222c 0a20 2020 2020 2020 2020  : "1",.         
+00016720: 2020 2020 2020 2020 2020 2022 6f72 6422             "ord"
+00016730: 3a20 2230 222c 0a20 2020 2020 2020 2020  : "0",.         
+00016740: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00016750: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+00016760: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00016770: 7365 7274 5472 7565 280a 2020 2020 2020  sertTrue(.      
+00016780: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00016790: 6361 7473 2e69 6e73 6572 7428 0a20 2020  cats.insert(.   
+000167a0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+000167b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000167c0: 2020 2022 6e61 6d65 223a 2022 6422 2c0a     "name": "d",.
+000167d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000167e0: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
+000167f0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+00016800: 2020 2020 2020 2020 2264 6573 6372 6970          "descrip
+00016810: 7469 6f6e 223a 2022 222c 0a20 2020 2020  tion": "",.     
+00016820: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00016830: 7061 7265 6e74 4361 7422 3a20 2231 222c  parentCat": "1",
+00016840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016850: 2020 2020 2022 6f72 6422 3a20 2230 222c       "ord": "0",
+00016860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016870: 207d 0a20 2020 2020 2020 2020 2020 2029   }.            )
+00016880: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00016890: 2020 206c 6973 7449 6420 3d20 5b61 5b22     listId = [a["
+000168a0: 6964 4361 7422 5d20 666f 7220 6120 696e  idCat"] for a in
+000168b0: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
+000168c0: 6765 7443 6869 6c64 2831 295d 0a20 2020  getChild(1)].   
+000168d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000168e0: 4571 7561 6c28 6c69 7374 4964 2c20 5b32  Equal(listId, [2
+000168f0: 2c20 332c 2034 5d29 0a20 2020 2020 2020  , 3, 4]).       
+00016900: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00016910: 6c28 6361 7473 5f61 6c70 6861 6265 7469  l(cats_alphabeti
+00016920: 6361 6c28 6c69 7374 4964 2c20 7365 6c66  cal(listId, self
+00016930: 2e70 4244 4229 2c20 5b32 2c20 342c 2033  .pBDB), [2, 4, 3
+00016940: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
+00016950: 6173 7365 7274 4571 7561 6c28 6361 7473  assertEqual(cats
+00016960: 5f61 6c70 6861 6265 7469 6361 6c28 5b33  _alphabetical([3
+00016970: 2c20 342c 2035 5d2c 2073 656c 662e 7042  , 4, 5], self.pB
+00016980: 4442 292c 205b 342c 2033 5d29 0a20 2020  DB), [4, 3]).   
+00016990: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000169a0: 4571 7561 6c28 6361 7473 5f61 6c70 6861  Equal(cats_alpha
+000169b0: 6265 7469 6361 6c28 5b5d 2c20 7365 6c66  betical([], self
+000169c0: 2e70 4244 4229 2c20 5b5d 290a 2020 2020  .pBDB), []).    
+000169d0: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+000169e0: 6c6f 6767 696e 672e 4c6f 6767 6572 2e77  logging.Logger.w
+000169f0: 6172 6e69 6e67 2229 2061 7320 5f69 3a0a  arning") as _i:.
+00016a00: 2020 2020 2020 2020 2020 2020 6361 7473              cats
+00016a10: 5f61 6c70 6861 6265 7469 6361 6c28 5b35  _alphabetical([5
+00016a20: 5d2c 2073 656c 662e 7042 4442 290a 2020  ], self.pBDB).  
+00016a30: 2020 2020 2020 2020 2020 5f69 2e61 7373            _i.ass
+00016a40: 6572 745f 616e 795f 6361 6c6c 2822 4361  ert_any_call("Ca
+00016a50: 7465 676f 7279 2027 3527 206e 6f74 2069  tegory '5' not i
+00016a60: 6e20 6461 7461 6261 7365 2229 0a0a 2020  n database")..  
+00016a70: 2020 6465 6620 7465 7374 5f68 6965 7261    def test_hiera
+00016a80: 7263 6879 2873 656c 662c 202a 6172 6773  rchy(self, *args
+00016a90: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00016aa0: 7374 696e 6720 7468 6520 636f 6e73 7472  sting the constr
+00016ab0: 7563 7469 6f6e 2061 6e64 2070 7269 6e74  uction and print
+00016ac0: 206f 6620 7468 6520 6361 7465 676f 7279   of the category
+00016ad0: 2068 6965 7261 7263 6869 6573 2222 220a   hierarchies""".
+00016ae0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00016af0: 6572 7454 7275 6528 0a20 2020 2020 2020  ertTrue(.       
+00016b00: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
+00016b10: 6174 732e 696e 7365 7274 280a 2020 2020  ats.insert(.    
+00016b20: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00016b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b40: 2020 226e 616d 6522 3a20 2263 222c 0a20    "name": "c",. 
+00016b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b60: 2020 2022 636f 6d6d 656e 7473 223a 2022     "comments": "
+00016b70: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00016b80: 2020 2020 2020 2022 6465 7363 7269 7074         "descript
+00016b90: 696f 6e22 3a20 2231 222c 0a20 2020 2020  ion": "1",.     
+00016ba0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00016bb0: 7061 7265 6e74 4361 7422 3a20 2231 222c  parentCat": "1",
+00016bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016bd0: 2020 2020 2022 6f72 6422 3a20 2230 222c       "ord": "0",
+00016be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016bf0: 207d 0a20 2020 2020 2020 2020 2020 2029   }.            )
+00016c00: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00016c10: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+00016c20: 7565 280a 2020 2020 2020 2020 2020 2020  ue(.            
+00016c30: 7365 6c66 2e70 4244 422e 6361 7473 2e69  self.pBDB.cats.i
+00016c40: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
+00016c50: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+00016c60: 2020 2020 2020 2020 2020 2020 2022 6e61               "na
+00016c70: 6d65 223a 2022 6422 2c0a 2020 2020 2020  me": "d",.      
+00016c80: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00016c90: 6f6d 6d65 6e74 7322 3a20 2222 2c0a 2020  omments": "",.  
+00016ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cb0: 2020 2264 6573 6372 6970 7469 6f6e 223a    "description":
+00016cc0: 2022 3222 2c0a 2020 2020 2020 2020 2020   "2",.          
+00016cd0: 2020 2020 2020 2020 2020 2270 6172 656e            "paren
+00016ce0: 7443 6174 223a 2022 3222 2c0a 2020 2020  tCat": "2",.    
+00016cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d00: 226f 7264 223a 2022 3022 2c0a 2020 2020  "ord": "0",.    
+00016d10: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00016d20: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00016d30: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00016d40: 6c66 2e61 7373 6572 7454 7275 6528 0a20  lf.assertTrue(. 
+00016d50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00016d60: 7042 4442 2e63 6174 732e 696e 7365 7274  pBDB.cats.insert
+00016d70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00016d80: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00016d90: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
+00016da0: 2265 222c 0a20 2020 2020 2020 2020 2020  "e",.           
+00016db0: 2020 2020 2020 2020 2022 636f 6d6d 656e           "commen
+00016dc0: 7473 223a 2022 222c 0a20 2020 2020 2020  ts": "",.       
+00016dd0: 2020 2020 2020 2020 2020 2020 2022 6465               "de
+00016de0: 7363 7269 7074 696f 6e22 3a20 2233 222c  scription": "3",
+00016df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016e00: 2020 2020 2022 7061 7265 6e74 4361 7422       "parentCat"
+00016e10: 3a20 2231 222c 0a20 2020 2020 2020 2020  : "1",.         
+00016e20: 2020 2020 2020 2020 2020 2022 6f72 6422             "ord"
+00016e30: 3a20 2230 222c 0a20 2020 2020 2020 2020  : "0",.         
+00016e40: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00016e50: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+00016e60: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00016e70: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00016e80: 4244 422e 6361 7473 2e67 6574 4869 6572  BDB.cats.getHier
+00016e90: 2829 2c20 7b30 3a20 7b31 3a20 7b32 3a20  (), {0: {1: {2: 
+00016ea0: 7b33 3a20 7b7d 7d2c 2034 3a20 7b7d 7d7d  {3: {}}, 4: {}}}
+00016eb0: 7d29 0a20 2020 2020 2020 2073 656c 662e  }).        self.
+00016ec0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00016ed0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00016ee0: 4442 2e63 6174 732e 6765 7448 6965 7228  DB.cats.getHier(
+00016ef0: 7265 706c 6163 653d 4661 6c73 6529 2c20  replace=False), 
+00016f00: 7b30 3a20 7b31 3a20 7b32 3a20 7b33 3a20  {0: {1: {2: {3: 
+00016f10: 7b7d 7d2c 2034 3a20 7b7d 7d7d 7d0a 2020  {}}, 4: {}}}}.  
+00016f20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00016f30: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00016f40: 2873 656c 662e 7042 4442 2e63 6174 732e  (self.pBDB.cats.
+00016f50: 6765 7448 6965 7228 7374 6172 7446 726f  getHier(startFro
+00016f60: 6d3d 3229 2c20 7b32 3a20 7b33 3a20 7b7d  m=2), {2: {3: {}
+00016f70: 7d7d 290a 2020 2020 2020 2020 7365 6c66  }}).        self
+00016f80: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
+00016f90: 662e 7042 4442 2e63 6174 732e 6765 7448  f.pBDB.cats.getH
+00016fa0: 6965 7228 7365 6c66 2e70 4244 422e 6361  ier(self.pBDB.ca
+00016fb0: 7473 2e67 6574 4368 696c 6428 3229 292c  ts.getChild(2)),
+00016fc0: 207b 303a 207b 7d7d 290a 2020 2020 2020   {0: {}}).      
+00016fd0: 2020 2320 6173 2030 2069 7320 6e6f 7420    # as 0 is not 
+00016fe0: 696e 2074 6865 206f 7269 6769 6e61 6c20  in the original 
+00016ff0: 6c69 7374 210a 2020 2020 2020 2020 7365  list!.        se
+00017000: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00017010: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017020: 2e70 4244 422e 6361 7473 2e67 6574 4869  .pBDB.cats.getHi
+00017030: 6572 2873 656c 662e 7042 4442 2e63 6174  er(self.pBDB.cat
+00017040: 732e 6765 7443 6869 6c64 2832 292c 2073  s.getChild(2), s
+00017050: 7461 7274 4672 6f6d 3d32 292c 0a20 2020  tartFrom=2),.   
+00017060: 2020 2020 2020 2020 207b 323a 207b 333a           {2: {3:
+00017070: 207b 7d7d 7d2c 0a20 2020 2020 2020 2029   {}}},.        )
+00017080: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00017090: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+000170a0: 4244 422e 6361 7473 2e67 6574 4869 6572  BDB.cats.getHier
+000170b0: 2829 2c20 7b30 3a20 7b31 3a20 7b32 3a20  (), {0: {1: {2: 
+000170c0: 7b33 3a20 7b7d 7d2c 2034 3a20 7b7d 7d7d  {3: {}}, 4: {}}}
+000170d0: 7d29 0a20 2020 2020 2020 2073 656c 662e  }).        self.
+000170e0: 6173 7365 7274 5f73 7464 6f75 7428 0a20  assert_stdout(. 
+000170f0: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
+00017100: 613a 2073 656c 662e 7042 4442 2e63 6174  a: self.pBDB.cat
+00017110: 732e 7072 696e 7448 6965 7228 7265 706c  s.printHier(repl
+00017120: 6163 653d 5472 7565 292c 0a20 2020 2020  ace=True),.     
+00017130: 2020 2020 2020 2022 2020 2030 3a20 4d61         "   0: Ma
+00017140: 696e 5c6e 2020 2020 2020 2020 313a 2054  in\n        1: T
+00017150: 6167 735c 6e20 2020 2020 2020 2020 2020  ags\n           
+00017160: 2020 220a 2020 2020 2020 2020 2020 2020    ".            
+00017170: 2b20 2232 3a20 635c 6e20 2020 2020 2020  + "2: c\n       
+00017180: 2020 2020 2020 2020 2020 2033 3a20 645c             3: d\
+00017190: 6e20 2020 2020 2020 2020 2020 2020 343a  n             4:
+000171a0: 2065 5c6e 222c 0a20 2020 2020 2020 2029   e\n",.        )
+000171b0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000171c0: 7365 7274 5f73 7464 6f75 7428 0a20 2020  sert_stdout(.   
+000171d0: 2020 2020 2020 2020 206c 616d 6264 613a           lambda:
+000171e0: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
+000171f0: 7072 696e 7448 6965 7228 7265 706c 6163  printHier(replac
+00017200: 653d 5472 7565 2c20 7370 3d33 202a 2022  e=True, sp=3 * "
+00017210: 2022 292c 0a20 2020 2020 2020 2020 2020   "),.           
+00017220: 2022 2020 2030 3a20 4d61 696e 5c6e 2020   "   0: Main\n  
+00017230: 2020 2020 313a 2054 6167 735c 6e20 2020      1: Tags\n   
+00017240: 2020 2020 2020 323a 2063 5c6e 2020 2020        2: c\n    
+00017250: 2020 2020 2020 2020 220a 2020 2020 2020          ".      
+00017260: 2020 2020 2020 2b20 2233 3a20 645c 6e20        + "3: d\n 
+00017270: 2020 2020 2020 2020 343a 2065 5c6e 222c          4: e\n",
+00017280: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00017290: 2020 2073 656c 662e 6173 7365 7274 5f73     self.assert_s
+000172a0: 7464 6f75 7428 0a20 2020 2020 2020 2020  tdout(.         
+000172b0: 2020 206c 616d 6264 613a 2073 656c 662e     lambda: self.
+000172c0: 7042 4442 2e63 6174 732e 7072 696e 7448  pBDB.cats.printH
+000172d0: 6965 7228 7265 706c 6163 653d 5472 7565  ier(replace=True
+000172e0: 2c20 7374 6172 7446 726f 6d3d 322c 2077  , startFrom=2, w
+000172f0: 6974 6844 6573 633d 5472 7565 292c 0a20  ithDesc=True),. 
+00017300: 2020 2020 2020 2020 2020 2022 2020 2032             "   2
+00017310: 3a20 6320 2d20 3c69 3e31 3c2f 693e 5c6e  : c - <i>1</i>\n
+00017320: 2020 2020 2020 2020 333a 2064 202d 203c          3: d - <
+00017330: 693e 323c 2f69 3e5c 6e22 2c0a 2020 2020  i>2</i>\n",.    
+00017340: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00017350: 6c66 2e61 7373 6572 745f 7374 646f 7574  lf.assert_stdout
+00017360: 280a 2020 2020 2020 2020 2020 2020 6c61  (.            la
+00017370: 6d62 6461 3a20 7365 6c66 2e70 4244 422e  mbda: self.pBDB.
+00017380: 6361 7473 2e70 7269 6e74 4869 6572 2872  cats.printHier(r
+00017390: 6570 6c61 6365 3d54 7275 652c 2064 6570  eplace=True, dep
+000173a0: 7468 3d32 292c 0a20 2020 2020 2020 2020  th=2),.         
+000173b0: 2020 2022 2020 2030 3a20 4d61 696e 5c6e     "   0: Main\n
+000173c0: 2020 2020 2020 2020 313a 2054 6167 735c          1: Tags\
+000173d0: 6e20 2020 2020 2020 2020 2020 2020 323a  n             2:
+000173e0: 2063 5c6e 2020 2020 2020 2020 2020 2020   c\n            
+000173f0: 2034 3a20 655c 6e22 2c0a 2020 2020 2020   4: e\n",.      
+00017400: 2020 290a 0a0a 4075 6e69 7474 6573 742e    )...@unittest.
+00017410: 736b 6970 4966 2873 6b69 7054 6573 7473  skipIf(skipTests
+00017420: 5365 7474 696e 6773 2e64 622c 2022 4461  Settings.db, "Da
+00017430: 7461 6261 7365 2074 6573 7473 2229 0a40  tabase tests").@
+00017440: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
+00017450: 6f67 6765 722e 6465 6275 6722 290a 4070  ogger.debug").@p
+00017460: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
+00017470: 6767 6572 2e69 6e66 6f22 290a 4070 6174  gger.info").@pat
+00017480: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
+00017490: 6572 2e77 6172 6e69 6e67 2229 0a40 7061  er.warning").@pa
+000174a0: 7463 6828 226c 6f67 6769 6e67 2e4c 6f67  tch("logging.Log
+000174b0: 6765 722e 6572 726f 7222 290a 4070 6174  ger.error").@pat
+000174c0: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
+000174d0: 6572 2e65 7863 6570 7469 6f6e 2229 0a63  er.exception").c
+000174e0: 6c61 7373 2054 6573 7444 6174 6162 6173  lass TestDatabas
+000174f0: 6545 6e74 7269 6573 2844 4254 6573 7443  eEntries(DBTestC
+00017500: 6173 6529 3a0a 2020 2020 2222 2254 6573  ase):.    """Tes
+00017510: 7473 2066 6f72 2074 6865 206d 6574 686f  ts for the metho
+00017520: 6473 2069 6e20 7468 6520 656e 7472 6965  ds in the entrie
+00017530: 7320 7375 6263 6c61 7373 2222 220a 0a20  s subclass""".. 
+00017540: 2020 2064 6566 2069 6e73 6572 745f 7468     def insert_th
+00017550: 7265 6528 7365 6c66 293a 0a20 2020 2020  ree(self):.     
+00017560: 2020 2022 2222 496e 7365 7274 2074 6872     """Insert thr
+00017570: 6565 2065 6c65 6d65 6e74 7320 696e 2074  ee elements in t
+00017580: 6865 2044 4220 666f 7220 7465 7374 696e  he DB for testin
+00017590: 6722 2222 0a20 2020 2020 2020 2064 6174  g""".        dat
+000175a0: 6120 3d20 7365 6c66 2e70 4244 422e 6269  a = self.pBDB.bi
+000175b0: 6273 2e70 7265 7061 7265 496e 7365 7274  bs.prepareInsert
+000175c0: 280a 2020 2020 2020 2020 2020 2020 2740  (.            '@
+000175d0: 6172 7469 636c 657b 6162 632c 5c6e 6175  article{abc,\nau
+000175e0: 7468 6f72 203d 2022 6d65 222c 5c6e 7469  thor = "me",\nti
+000175f0: 746c 6520 3d20 2261 6263 222c 7d27 2c20  tle = "abc",}', 
+00017600: 6172 7869 763d 2261 6263 220a 2020 2020  arxiv="abc".    
+00017610: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00017620: 6c66 2e61 7373 6572 7454 7275 6528 7365  lf.assertTrue(se
+00017630: 6c66 2e70 4244 422e 6269 6273 2e69 6e73  lf.pBDB.bibs.ins
+00017640: 6572 7428 6461 7461 2929 0a20 2020 2020  ert(data)).     
+00017650: 2020 2064 6174 6120 3d20 7365 6c66 2e70     data = self.p
+00017660: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
+00017670: 496e 7365 7274 280a 2020 2020 2020 2020  Insert(.        
+00017680: 2020 2020 2740 6172 7469 636c 657b 6465      '@article{de
+00017690: 662c 5c6e 6175 7468 6f72 203d 2022 6d65  f,\nauthor = "me
+000176a0: 222c 5c6e 7469 746c 6520 3d20 2264 6566  ",\ntitle = "def
+000176b0: 222c 7d27 2c20 6172 7869 763d 2264 6566  ",}', arxiv="def
+000176c0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
+000176d0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+000176e0: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
+000176f0: 6273 2e69 6e73 6572 7428 6461 7461 2929  bs.insert(data))
+00017700: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+00017710: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
+00017720: 7265 7061 7265 496e 7365 7274 280a 2020  repareInsert(.  
+00017730: 2020 2020 2020 2020 2020 2740 6172 7469            '@arti
+00017740: 636c 657b 6768 692c 5c6e 6175 7468 6f72  cle{ghi,\nauthor
+00017750: 203d 2022 6d65 222c 5c6e 7469 746c 6520   = "me",\ntitle 
+00017760: 3d20 2267 6869 222c 7d27 2c20 6172 7869  = "ghi",}', arxi
+00017770: 763d 2267 6869 220a 2020 2020 2020 2020  v="ghi".        
+00017780: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00017790: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
+000177a0: 4244 422e 6269 6273 2e69 6e73 6572 7428  BDB.bibs.insert(
+000177b0: 6461 7461 2929 0a0a 2020 2020 6465 6620  data))..    def 
+000177c0: 7465 7374 5f63 6174 4578 7053 7472 696e  test_catExpStrin
+000177d0: 6773 2873 656c 662c 202a 6172 6773 293a  gs(self, *args):
+000177e0: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
+000177f0: 205f 6361 7445 7870 5374 7269 6e67 7322   _catExpStrings"
+00017800: 2222 0a20 2020 2020 2020 206a 432c 2077  "".        jC, w
+00017810: 432c 2076 4320 3d20 7365 6c66 2e70 4244  C, vC = self.pBD
+00017820: 422e 6269 6273 2e5f 6361 7445 7870 5374  B.bibs._catExpSt
+00017830: 7269 6e67 7328 0a20 2020 2020 2020 2020  rings(.         
+00017840: 2020 205b 312c 2032 5d2c 2022 616c 6c20     [1, 2], "all 
+00017850: 7468 6520 666f 6c6c 6f77 696e 6722 2c20  the following", 
+00017860: 2265 6e74 7279 4361 7473 222c 2022 6964  "entryCats", "id
+00017870: 4361 7422 0a20 2020 2020 2020 2029 0a20  Cat".        ). 
+00017880: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00017890: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000178a0: 2020 2020 206a 432c 0a20 2020 2020 2020       jC,.       
+000178b0: 2020 2020 2022 206c 6566 7420 6a6f 696e       " left join
+000178c0: 2065 6e74 7279 4361 7473 2065 6e74 7279   entryCats entry
+000178d0: 4361 7473 3020 6f6e 2065 6e74 7269 6573  Cats0 on entries
+000178e0: 2e62 6962 6b65 793d 656e 7472 7943 6174  .bibkey=entryCat
+000178f0: 7330 2e62 6962 6b65 7922 0a20 2020 2020  s0.bibkey".     
+00017900: 2020 2020 2020 202b 2022 2020 6c65 6674         + "  left
+00017910: 206a 6f69 6e20 656e 7472 7943 6174 7320   join entryCats 
+00017920: 656e 7472 7943 6174 7331 206f 6e20 656e  entryCats1 on en
+00017930: 7472 6965 732e 6269 626b 6579 3d65 6e74  tries.bibkey=ent
+00017940: 7279 4361 7473 312e 6269 626b 6579 222c  ryCats1.bibkey",
+00017950: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00017960: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00017970: 7561 6c28 7743 2c20 2228 656e 7472 7943  ual(wC, "(entryC
+00017980: 6174 7330 2e69 6443 6174 203d 203f 2061  ats0.idCat = ? a
+00017990: 6e64 2065 6e74 7279 4361 7473 312e 6964  nd entryCats1.id
+000179a0: 4361 7420 3d20 3f29 2229 0a20 2020 2020  Cat = ?)").     
+000179b0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+000179c0: 7561 6c28 7643 2c20 2822 3122 2c20 2232  ual(vC, ("1", "2
+000179d0: 2229 290a 2020 2020 2020 2020 6a43 2c20  ")).        jC, 
+000179e0: 7743 2c20 7643 203d 2073 656c 662e 7042  wC, vC = self.pB
+000179f0: 4442 2e62 6962 732e 5f63 6174 4578 7053  DB.bibs._catExpS
+00017a00: 7472 696e 6773 280a 2020 2020 2020 2020  trings(.        
+00017a10: 2020 2020 5b31 2c20 325d 2c20 2261 7420      [1, 2], "at 
+00017a20: 6c65 6173 7420 6f6e 6520 616d 6f6e 6722  least one among"
+00017a30: 2c20 2265 6e74 7279 4361 7473 222c 2022  , "entryCats", "
+00017a40: 6964 4361 7422 0a20 2020 2020 2020 2029  idCat".        )
+00017a50: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00017a60: 7365 7274 4571 7561 6c28 6a43 2c20 2220  sertEqual(jC, " 
+00017a70: 6c65 6674 206a 6f69 6e20 656e 7472 7943  left join entryC
+00017a80: 6174 7320 6f6e 2065 6e74 7269 6573 2e62  ats on entries.b
+00017a90: 6962 6b65 793d 656e 7472 7943 6174 732e  ibkey=entryCats.
+00017aa0: 6269 626b 6579 2229 0a20 2020 2020 2020  bibkey").       
+00017ab0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00017ac0: 6c28 7743 2c20 2228 2065 6e74 7279 4361  l(wC, "( entryCa
+00017ad0: 7473 2e69 6443 6174 203d 203f 206f 7220  ts.idCat = ? or 
+00017ae0: 656e 7472 7943 6174 732e 6964 4361 7420  entryCats.idCat 
+00017af0: 3d20 3f20 2922 290a 2020 2020 2020 2020  = ? )").        
+00017b00: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00017b10: 2876 432c 2028 2231 222c 2022 3222 2929  (vC, ("1", "2"))
+00017b20: 0a20 2020 2020 2020 206a 432c 2077 432c  .        jC, wC,
+00017b30: 2076 4320 3d20 7365 6c66 2e70 4244 422e   vC = self.pBDB.
+00017b40: 6269 6273 2e5f 6361 7445 7870 5374 7269  bibs._catExpStri
+00017b50: 6e67 7328 0a20 2020 2020 2020 2020 2020  ngs(.           
+00017b60: 205b 312c 2032 5d2c 2022 7261 6e64 6f6d   [1, 2], "random
+00017b70: 222c 2022 656e 7472 7943 6174 7322 2c20  ", "entryCats", 
+00017b80: 2269 6443 6174 220a 2020 2020 2020 2020  "idCat".        
+00017b90: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00017ba0: 7373 6572 7445 7175 616c 286a 432c 2022  ssertEqual(jC, "
+00017bb0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00017bc0: 6173 7365 7274 4571 7561 6c28 7743 2c20  assertEqual(wC, 
+00017bd0: 2222 290a 2020 2020 2020 2020 7365 6c66  "").        self
+00017be0: 2e61 7373 6572 7445 7175 616c 2876 432c  .assertEqual(vC,
+00017bf0: 2028 2929 0a20 2020 2020 2020 206a 432c   ()).        jC,
+00017c00: 2077 432c 2076 4320 3d20 7365 6c66 2e70   wC, vC = self.p
+00017c10: 4244 422e 6269 6273 2e5f 6361 7445 7870  BDB.bibs._catExp
+00017c20: 5374 7269 6e67 7328 312c 2022 7261 6e64  Strings(1, "rand
+00017c30: 6f6d 222c 2022 656e 7472 7945 7870 7322  om", "entryExps"
+00017c40: 2c20 2269 6445 7870 2229 0a20 2020 2020  , "idExp").     
+00017c50: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00017c60: 7561 6c28 6a43 2c20 2220 6c65 6674 206a  ual(jC, " left j
+00017c70: 6f69 6e20 656e 7472 7945 7870 7320 6f6e  oin entryExps on
+00017c80: 2065 6e74 7269 6573 2e62 6962 6b65 793d   entries.bibkey=
+00017c90: 656e 7472 7945 7870 732e 6269 626b 6579  entryExps.bibkey
+00017ca0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00017cb0: 6173 7365 7274 4571 7561 6c28 7743 2c20  assertEqual(wC, 
+00017cc0: 2265 6e74 7279 4578 7073 2e69 6445 7870  "entryExps.idExp
+00017cd0: 203d 203f 2022 290a 2020 2020 2020 2020   = ? ").        
+00017ce0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00017cf0: 2876 432c 2028 2231 222c 2929 0a0a 2020  (vC, ("1",))..  
+00017d00: 2020 6465 6620 7465 7374 5f67 6574 5175    def test_getQu
+00017d10: 6572 7953 7472 2873 656c 662c 202a 6172  eryStr(self, *ar
+00017d20: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+00017d30: 7465 7374 205f 6765 7451 7565 7279 5374  test _getQuerySt
+00017d40: 7222 2222 0a20 2020 2020 2020 2073 656c  r""".        sel
+00017d50: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00017d60: 6c66 2e70 4244 422e 6269 6273 2e5f 6765  lf.pBDB.bibs._ge
+00017d70: 7451 7565 7279 5374 7228 2261 6263 222c  tQueryStr("abc",
+00017d80: 2022 6e6f 6122 292c 2022 6162 6322 290a   "noa"), "abc").
+00017d90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00017da0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+00017db0: 4442 2e62 6962 732e 5f67 6574 5175 6572  DB.bibs._getQuer
+00017dc0: 7953 7472 2822 6162 6322 2c20 226c 6f67  yStr("abc", "log
+00017dd0: 6c69 6b65 6d22 292c 2022 2561 6263 2522  likem"), "%abc%"
+00017de0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+00017df0: 7072 6570 6172 6549 6e73 6572 7441 7278  prepareInsertArx
+00017e00: 6976 2873 656c 662c 202a 6172 6773 293a  iv(self, *args):
+00017e10: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
+00017e20: 205f 7072 6570 6172 6549 6e73 6572 7441   _prepareInsertA
+00017e30: 7278 6976 2222 220a 2020 2020 2020 2020  rxiv""".        
+00017e40: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00017e50: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00017e60: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
+00017e70: 6570 6172 6549 6e73 6572 7441 7278 6976  epareInsertArxiv
+00017e80: 287b 7d2c 207b 7d2c 204e 6f6e 6529 2c20  ({}, {}, None), 
+00017e90: 7b22 6172 7869 7622 3a20 2222 7d0a 2020  {"arxiv": ""}.  
+00017ea0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00017eb0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00017ec0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00017ed0: 5f70 7265 7061 7265 496e 7365 7274 4172  _prepareInsertAr
+00017ee0: 7869 7628 7b7d 2c20 7b7d 2c20 2222 292c  xiv({}, {}, ""),
+00017ef0: 207b 2261 7278 6976 223a 2022 227d 290a   {"arxiv": ""}).
+00017f00: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00017f10: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00017f20: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00017f30: 6269 6273 2e5f 7072 6570 6172 6549 6e73  bibs._prepareIns
+00017f40: 6572 7441 7278 6976 280a 2020 2020 2020  ertArxiv(.      
+00017f50: 2020 2020 2020 2020 2020 7b22 6172 7869            {"arxi
+00017f60: 7622 3a20 2231 3233 227d 2c20 7b22 6172  v": "123"}, {"ar
+00017f70: 7869 7622 3a20 2231 3131 222c 2022 6570  xiv": "111", "ep
+00017f80: 7269 6e74 223a 2022 3232 3222 7d2c 2022  rint": "222"}, "
+00017f90: 6162 6322 0a20 2020 2020 2020 2020 2020  abc".           
+00017fa0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+00017fb0: 7b22 6172 7869 7622 3a20 2261 6263 227d  {"arxiv": "abc"}
+00017fc0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00017fd0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00017fe0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00017ff0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00018000: 2e5f 7072 6570 6172 6549 6e73 6572 7441  ._prepareInsertA
+00018010: 7278 6976 280a 2020 2020 2020 2020 2020  rxiv(.          
+00018020: 2020 2020 2020 7b22 6172 7869 7622 3a20        {"arxiv": 
+00018030: 2231 3233 227d 2c20 7b22 6172 7869 7622  "123"}, {"arxiv"
+00018040: 3a20 2231 3131 222c 2022 6570 7269 6e74  : "111", "eprint
+00018050: 223a 2022 3232 3222 7d2c 204e 6f6e 650a  ": "222"}, None.
+00018060: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00018070: 2020 2020 2020 2020 2020 207b 2261 7278             {"arx
+00018080: 6976 223a 2022 3131 3122 7d2c 0a20 2020  iv": "111"},.   
+00018090: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+000180a0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000180b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000180c0: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
+000180d0: 7061 7265 496e 7365 7274 4172 7869 7628  pareInsertArxiv(
+000180e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000180f0: 207b 2261 7278 6976 223a 2022 3132 3322   {"arxiv": "123"
+00018100: 7d2c 207b 2265 7072 696e 7422 3a20 2232  }, {"eprint": "2
+00018110: 3232 227d 2c20 6172 7869 763d 4e6f 6e65  22"}, arxiv=None
+00018120: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00018130: 2020 2020 2020 2020 2020 2020 7b22 6172              {"ar
+00018140: 7869 7622 3a20 2232 3232 227d 2c0a 2020  xiv": "222"},.  
+00018150: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00018160: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00018170: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00018180: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
+00018190: 6570 6172 6549 6e73 6572 7441 7278 6976  epareInsertArxiv
+000181a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000181b0: 2020 7b22 6172 7869 7622 3a20 2231 3233    {"arxiv": "123
+000181c0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
+000181d0: 2020 2020 7b22 6570 7269 6e74 223a 2022      {"eprint": "
+000181e0: 3232 3222 7d2c 0a20 2020 2020 2020 2020  222"},.         
+000181f0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+00018200: 2020 7b22 6172 7869 7622 3a20 2232 3232    {"arxiv": "222
+00018210: 227d 2c0a 2020 2020 2020 2020 290a 0a20  "},.        ).. 
+00018220: 2020 2064 6566 2074 6573 745f 7072 6570     def test_prep
+00018230: 6172 6549 6e73 6572 7442 6173 6963 2873  areInsertBasic(s
+00018240: 656c 662c 202a 6172 6773 293a 0a20 2020  elf, *args):.   
+00018250: 2020 2020 2022 2222 7465 7374 205f 7072       """test _pr
+00018260: 6570 6172 6549 6e73 6572 7442 6173 6963  epareInsertBasic
+00018270: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+00018280: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00018290: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000182a0: 4244 422e 6269 6273 2e5f 7072 6570 6172  BDB.bibs._prepar
+000182b0: 6549 6e73 6572 7442 6173 6963 287b 7d2c  eInsertBasic({},
+000182c0: 207b 7d2c 204e 6f6e 6529 2c0a 2020 2020   {}, None),.    
+000182d0: 2020 2020 2020 2020 287b 2262 6962 6b65          ({"bibke
+000182e0: 7922 3a20 2222 7d2c 207b 2249 4422 3a20  y": ""}, {"ID": 
+000182f0: 2222 7d29 2c0a 2020 2020 2020 2020 290a  ""}),.        ).
+00018300: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00018310: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00018320: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00018330: 6269 6273 2e5f 7072 6570 6172 6549 6e73  bibs._prepareIns
+00018340: 6572 7442 6173 6963 287b 7d2c 207b 2249  ertBasic({}, {"I
+00018350: 4422 3a20 4e6f 6e65 7d2c 204e 6f6e 6529  D": None}, None)
+00018360: 2c0a 2020 2020 2020 2020 2020 2020 287b  ,.            ({
+00018370: 2262 6962 6b65 7922 3a20 2222 7d2c 207b  "bibkey": ""}, {
+00018380: 2249 4422 3a20 2222 7d29 2c0a 2020 2020  "ID": ""}),.    
+00018390: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+000183a0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+000183b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000183c0: 2e70 4244 422e 6269 6273 2e5f 7072 6570  .pBDB.bibs._prep
+000183d0: 6172 6549 6e73 6572 7442 6173 6963 287b  areInsertBasic({
+000183e0: 7d2c 207b 2249 4422 3a20 2261 6263 227d  }, {"ID": "abc"}
+000183f0: 2c20 6269 626b 6579 3d4e 6f6e 6529 2c0a  , bibkey=None),.
+00018400: 2020 2020 2020 2020 2020 2020 287b 2262              ({"b
+00018410: 6962 6b65 7922 3a20 2261 6263 227d 2c20  ibkey": "abc"}, 
+00018420: 7b22 4944 223a 2022 6162 6322 7d29 2c0a  {"ID": "abc"}),.
+00018430: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00018440: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00018450: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00018460: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
+00018470: 7072 6570 6172 6549 6e73 6572 7442 6173  prepareInsertBas
+00018480: 6963 287b 7d2c 207b 2249 4422 3a20 2261  ic({}, {"ID": "a
+00018490: 6263 227d 292c 0a20 2020 2020 2020 2020  bc"}),.         
+000184a0: 2020 2028 7b22 6269 626b 6579 223a 2022     ({"bibkey": "
+000184b0: 6162 6322 7d2c 207b 2249 4422 3a20 2261  abc"}, {"ID": "a
+000184c0: 6263 227d 292c 0a20 2020 2020 2020 2029  bc"}),.        )
+000184d0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000184e0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+000184f0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00018500: 2e62 6962 732e 5f70 7265 7061 7265 496e  .bibs._prepareIn
+00018510: 7365 7274 4261 7369 6328 7b7d 2c20 7b22  sertBasic({}, {"
+00018520: 4944 223a 2022 6162 6322 7d2c 2022 2229  ID": "abc"}, "")
+00018530: 2c0a 2020 2020 2020 2020 2020 2020 287b  ,.            ({
+00018540: 2262 6962 6b65 7922 3a20 2261 6263 227d  "bibkey": "abc"}
+00018550: 2c20 7b22 4944 223a 2022 6162 6322 7d29  , {"ID": "abc"})
+00018560: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00018570: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00018580: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00018590: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+000185a0: 2e5f 7072 6570 6172 6549 6e73 6572 7442  ._prepareInsertB
+000185b0: 6173 6963 287b 7d2c 207b 2249 4422 3a20  asic({}, {"ID": 
+000185c0: 2261 6263 227d 2c20 2264 6566 2229 2c0a  "abc"}, "def"),.
+000185d0: 2020 2020 2020 2020 2020 2020 287b 2262              ({"b
+000185e0: 6962 6b65 7922 3a20 2264 6566 227d 2c20  ibkey": "def"}, 
+000185f0: 7b22 4944 223a 2022 6465 6622 7d29 2c0a  {"ID": "def"}),.
+00018600: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00018610: 6566 2074 6573 745f 7072 6570 6172 6549  ef test_prepareI
+00018620: 6e73 6572 7443 6974 2873 656c 662c 202a  nsertCit(self, *
+00018630: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+00018640: 2222 7465 7374 205f 7072 6570 6172 6549  ""test _prepareI
+00018650: 6e73 6572 7443 6974 2222 220a 2020 2020  nsertCit""".    
+00018660: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00018670: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00018680: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00018690: 2e5f 7072 6570 6172 6549 6e73 6572 7443  ._prepareInsertC
+000186a0: 6974 287b 7d2c 204e 6f6e 652c 204e 6f6e  it({}, None, Non
+000186b0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+000186c0: 7b22 6369 7461 7469 6f6e 7322 3a20 302c  {"citations": 0,
+000186d0: 2022 6369 7461 7469 6f6e 735f 6e6f 5f73   "citations_no_s
+000186e0: 656c 6622 3a20 307d 2c0a 2020 2020 2020  elf": 0},.      
+000186f0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00018700: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00018710: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00018720: 4244 422e 6269 6273 2e5f 7072 6570 6172  BDB.bibs._prepar
+00018730: 6549 6e73 6572 7443 6974 287b 7d2c 2022  eInsertCit({}, "
+00018740: 222c 204e 6f6e 6529 2c0a 2020 2020 2020  ", None),.      
+00018750: 2020 2020 2020 7b22 6369 7461 7469 6f6e        {"citation
+00018760: 7322 3a20 302c 2022 6369 7461 7469 6f6e  s": 0, "citation
+00018770: 735f 6e6f 5f73 656c 6622 3a20 307d 2c0a  s_no_self": 0},.
+00018780: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00018790: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000187a0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+000187b0: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
+000187c0: 7072 6570 6172 6549 6e73 6572 7443 6974  prepareInsertCit
+000187d0: 287b 7d2c 204e 6f6e 652c 2022 2229 2c0a  ({}, None, ""),.
+000187e0: 2020 2020 2020 2020 2020 2020 7b22 6369              {"ci
+000187f0: 7461 7469 6f6e 7322 3a20 302c 2022 6369  tations": 0, "ci
+00018800: 7461 7469 6f6e 735f 6e6f 5f73 656c 6622  tations_no_self"
+00018810: 3a20 307d 2c0a 2020 2020 2020 2020 290a  : 0},.        ).
+00018820: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00018830: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00018840: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00018850: 6269 6273 2e5f 7072 6570 6172 6549 6e73  bibs._prepareIns
+00018860: 6572 7443 6974 287b 7d2c 2022 3122 2c20  ertCit({}, "1", 
+00018870: 4e6f 6e65 292c 0a20 2020 2020 2020 2020  None),.         
+00018880: 2020 207b 2263 6974 6174 696f 6e73 223a     {"citations":
+00018890: 2031 2c20 2263 6974 6174 696f 6e73 5f6e   1, "citations_n
+000188a0: 6f5f 7365 6c66 223a 2030 7d2c 0a20 2020  o_self": 0},.   
+000188b0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+000188c0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000188d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000188e0: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
+000188f0: 7061 7265 496e 7365 7274 4369 7428 7b7d  pareInsertCit({}
+00018900: 2c20 4e6f 6e65 2c20 2231 3222 292c 0a20  , None, "12"),. 
+00018910: 2020 2020 2020 2020 2020 207b 2263 6974             {"cit
+00018920: 6174 696f 6e73 223a 2030 2c20 2263 6974  ations": 0, "cit
+00018930: 6174 696f 6e73 5f6e 6f5f 7365 6c66 223a  ations_no_self":
+00018940: 2031 327d 2c0a 2020 2020 2020 2020 290a   12},.        ).
+00018950: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00018960: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00018970: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00018980: 6269 6273 2e5f 7072 6570 6172 6549 6e73  bibs._prepareIns
+00018990: 6572 7443 6974 287b 7d2c 2022 6122 2c20  ertCit({}, "a", 
+000189a0: 3131 2e33 292c 0a20 2020 2020 2020 2020  11.3),.         
+000189b0: 2020 207b 2263 6974 6174 696f 6e73 223a     {"citations":
+000189c0: 2030 2c20 2263 6974 6174 696f 6e73 5f6e   0, "citations_n
+000189d0: 6f5f 7365 6c66 223a 2031 317d 2c0a 2020  o_self": 11},.  
+000189e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000189f0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00018a00: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00018a10: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
+00018a20: 6570 6172 6549 6e73 6572 7443 6974 287b  epareInsertCit({
+00018a30: 7d2c 2031 322c 2022 3131 6122 292c 0a20  }, 12, "11a"),. 
+00018a40: 2020 2020 2020 2020 2020 207b 2263 6974             {"cit
+00018a50: 6174 696f 6e73 223a 2031 322c 2022 6369  ations": 12, "ci
+00018a60: 7461 7469 6f6e 735f 6e6f 5f73 656c 6622  tations_no_self"
+00018a70: 3a20 307d 2c0a 2020 2020 2020 2020 290a  : 0},.        ).
+00018a80: 0a20 2020 2064 6566 2074 6573 745f 7072  .    def test_pr
+00018a90: 6570 6172 6549 6e73 6572 7444 6963 7428  epareInsertDict(
+00018aa0: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+00018ab0: 2020 2020 2020 2222 2274 6573 7420 5f70        """test _p
+00018ac0: 7265 7061 7265 496e 7365 7274 4469 6374  repareInsertDict
+00018ad0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+00018ae0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00018af0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00018b00: 4244 422e 6269 6273 2e5f 7072 6570 6172  BDB.bibs._prepar
+00018b10: 6549 6e73 6572 7444 6963 7428 7b7d 292c  eInsertDict({}),
+00018b20: 0a20 2020 2020 2020 2020 2020 207b 2262  .            {"b
+00018b30: 6962 6469 6374 223a 207b 7d7d 2c0a 2020  ibdict": {}},.  
+00018b40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00018b50: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00018b60: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00018b70: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
+00018b80: 6570 6172 6549 6e73 6572 7444 6963 7428  epareInsertDict(
+00018b90: 7b22 6269 6274 6578 223a 2022 227d 292c  {"bibtex": ""}),
+00018ba0: 0a20 2020 2020 2020 2020 2020 207b 2262  .            {"b
+00018bb0: 6962 6469 6374 223a 207b 7d2c 2022 6269  ibdict": {}, "bi
+00018bc0: 6274 6578 223a 2022 227d 2c0a 2020 2020  btex": ""},.    
+00018bd0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00018be0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00018bf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00018c00: 2e70 4244 422e 6269 6273 2e5f 7072 6570  .pBDB.bibs._prep
+00018c10: 6172 6549 6e73 6572 7444 6963 7428 7b22  areInsertDict({"
+00018c20: 6269 6274 6578 223a 2022 4061 7274 6963  bibtex": "@artic
+00018c30: 6c65 7b2c 227d 292c 0a20 2020 2020 2020  le{,"}),.       
+00018c40: 2020 2020 207b 2262 6962 6469 6374 223a       {"bibdict":
+00018c50: 207b 7d2c 2022 6269 6274 6578 223a 2022   {}, "bibtex": "
+00018c60: 4061 7274 6963 6c65 7b2c 227d 2c0a 2020  @article{,"},.  
+00018c70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00018c80: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00018c90: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00018ca0: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
+00018cb0: 6570 6172 6549 6e73 6572 7444 6963 7428  epareInsertDict(
+00018cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018cd0: 207b 2262 6962 7465 7822 3a20 2740 6172   {"bibtex": '@ar
+00018ce0: 7469 636c 657b 6162 632c 5c6e 6175 7468  ticle{abc,\nauth
+00018cf0: 6f72 3d22 6d65 222c 5c6e 7469 746c 653d  or="me",\ntitle=
+00018d00: 2274 6974 6c65 222c 5c6e 7d5c 6e27 7d0a  "title",\n}\n'}.
+00018d10: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00018d20: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00018d30: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+00018d40: 6264 6963 7422 3a20 7b0a 2020 2020 2020  bdict": {.      
+00018d50: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+00018d60: 4e54 5259 5459 5045 223a 2022 6172 7469  NTRYTYPE": "arti
+00018d70: 636c 6522 2c0a 2020 2020 2020 2020 2020  cle",.          
+00018d80: 2020 2020 2020 2020 2020 2249 4422 3a20            "ID": 
+00018d90: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
+00018da0: 2020 2020 2020 2020 2020 2022 6175 7468             "auth
+00018db0: 6f72 223a 2022 6d65 222c 0a20 2020 2020  or": "me",.     
+00018dc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00018dd0: 7469 746c 6522 3a20 2274 6974 6c65 222c  title": "title",
+00018de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018df0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00018e00: 2020 2020 2262 6962 7465 7822 3a20 2740      "bibtex": '@
+00018e10: 6172 7469 636c 657b 6162 632c 5c6e 6175  article{abc,\nau
+00018e20: 7468 6f72 3d22 6d65 222c 5c6e 7469 746c  thor="me",\ntitl
+00018e30: 653d 2274 6974 6c65 222c 5c6e 7d5c 6e27  e="title",\n}\n'
+00018e40: 2c0a 2020 2020 2020 2020 2020 2020 7d2c  ,.            },
+00018e50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00018e60: 6465 6620 7465 7374 5f70 7265 7061 7265  def test_prepare
+00018e70: 496e 7365 7274 4669 6c6c 2873 656c 662c  InsertFill(self,
+00018e80: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
+00018e90: 2022 2222 7465 7374 205f 7072 6570 6172   """test _prepar
+00018ea0: 6549 6e73 6572 7446 696c 6c22 2222 0a20  eInsertFill""". 
+00018eb0: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
+00018ec0: 2e61 7373 6572 7452 6169 7365 7328 4b65  .assertRaises(Ke
+00018ed0: 7945 7272 6f72 293a 0a20 2020 2020 2020  yError):.       
+00018ee0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00018ef0: 6962 732e 5f70 7265 7061 7265 496e 7365  ibs._prepareInse
+00018f00: 7274 4669 6c6c 287b 7d29 0a20 2020 2020  rtFill({}).     
+00018f10: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00018f20: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00018f30: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00018f40: 5f70 7265 7061 7265 496e 7365 7274 4669  _prepareInsertFi
+00018f50: 6c6c 287b 2262 6962 6469 6374 223a 207b  ll({"bibdict": {
+00018f60: 7d7d 292c 0a20 2020 2020 2020 2020 2020  }}),.           
+00018f70: 207b 2262 6962 6469 6374 223a 207b 7d7d   {"bibdict": {}}
+00018f80: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00018f90: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00018fa0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00018fb0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00018fc0: 2e5f 7072 6570 6172 6549 6e73 6572 7446  ._prepareInsertF
+00018fd0: 696c 6c28 7b22 6269 6264 6963 7422 3a20  ill({"bibdict": 
+00018fe0: 7b7d 2c20 2261 7278 6976 223a 2022 227d  {}, "arxiv": ""}
+00018ff0: 292c 0a20 2020 2020 2020 2020 2020 207b  ),.            {
+00019000: 2262 6962 6469 6374 223a 207b 7d2c 2022  "bibdict": {}, "
+00019010: 6172 7869 7622 3a20 2222 7d2c 0a20 2020  arxiv": ""},.   
+00019020: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00019030: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00019040: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019050: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
+00019060: 7061 7265 496e 7365 7274 4669 6c6c 280a  pareInsertFill(.
+00019070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019080: 7b22 6269 6264 6963 7422 3a20 7b22 6172  {"bibdict": {"ar
+00019090: 7869 7622 3a20 2231 3233 227d 2c20 2261  xiv": "123"}, "a
+000190a0: 7278 6976 223a 2022 227d 0a20 2020 2020  rxiv": ""}.     
+000190b0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+000190c0: 2020 2020 2020 7b22 6269 6264 6963 7422        {"bibdict"
+000190d0: 3a20 7b22 6172 7869 7622 3a20 2231 3233  : {"arxiv": "123
+000190e0: 227d 2c20 2261 7278 6976 223a 2022 3132  "}, "arxiv": "12
+000190f0: 3322 7d2c 0a20 2020 2020 2020 2029 0a20  3"},.        ). 
+00019100: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00019110: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00019120: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00019130: 6962 732e 5f70 7265 7061 7265 496e 7365  ibs._prepareInse
+00019140: 7274 4669 6c6c 280a 2020 2020 2020 2020  rtFill(.        
+00019150: 2020 2020 2020 2020 7b22 6269 6264 6963          {"bibdic
+00019160: 7422 3a20 7b22 6570 7269 6e74 223a 2022  t": {"eprint": "
+00019170: 3132 3322 7d2c 2022 6172 7869 7622 3a20  123"}, "arxiv": 
+00019180: 2222 7d0a 2020 2020 2020 2020 2020 2020  ""}.            
+00019190: 292c 0a20 2020 2020 2020 2020 2020 207b  ),.            {
+000191a0: 2262 6962 6469 6374 223a 207b 2265 7072  "bibdict": {"epr
+000191b0: 696e 7422 3a20 2231 3233 227d 2c20 2261  int": "123"}, "a
+000191c0: 7278 6976 223a 2022 3132 3322 7d2c 0a20  rxiv": "123"},. 
+000191d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000191e0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000191f0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
+00019200: 656c 662e 7042 4442 2e62 6962 732e 5f70  elf.pBDB.bibs._p
+00019210: 7265 7061 7265 496e 7365 7274 4669 6c6c  repareInsertFill
+00019220: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00019230: 2020 7b22 6269 6264 6963 7422 3a20 7b22    {"bibdict": {"
+00019240: 6172 7869 7622 3a20 2234 3536 222c 2022  arxiv": "456", "
+00019250: 6570 7269 6e74 223a 2022 3132 3322 7d2c  eprint": "123"},
+00019260: 2022 6172 7869 7622 3a20 2222 7d0a 2020   "arxiv": ""}.  
+00019270: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00019280: 2020 2020 2020 2020 207b 2262 6962 6469           {"bibdi
+00019290: 6374 223a 207b 2261 7278 6976 223a 2022  ct": {"arxiv": "
+000192a0: 3435 3622 2c20 2265 7072 696e 7422 3a20  456", "eprint": 
+000192b0: 2231 3233 227d 2c20 2261 7278 6976 223a  "123"}, "arxiv":
+000192c0: 2022 3435 3622 7d2c 0a20 2020 2020 2020   "456"},.       
+000192d0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+000192e0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+000192f0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00019300: 4442 2e62 6962 732e 5f70 7265 7061 7265  DB.bibs._prepare
+00019310: 496e 7365 7274 4669 6c6c 280a 2020 2020  InsertFill(.    
+00019320: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
+00019330: 6264 6963 7422 3a20 7b22 6172 7869 7622  bdict": {"arxiv"
+00019340: 3a20 2234 3536 222c 2022 6570 7269 6e74  : "456", "eprint
+00019350: 223a 2022 3132 3322 7d2c 2022 6172 7869  ": "123"}, "arxi
+00019360: 7622 3a20 2237 3839 227d 0a20 2020 2020  v": "789"}.     
+00019370: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00019380: 2020 2020 2020 7b22 6269 6264 6963 7422        {"bibdict"
+00019390: 3a20 7b22 6172 7869 7622 3a20 2234 3536  : {"arxiv": "456
+000193a0: 222c 2022 6570 7269 6e74 223a 2022 3132  ", "eprint": "12
+000193b0: 3322 7d2c 2022 6172 7869 7622 3a20 2237  3"}, "arxiv": "7
+000193c0: 3839 227d 2c0a 2020 2020 2020 2020 290a  89"},.        ).
+000193d0: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
+000193e0: 2028 2279 6561 7222 2c20 2264 6f69 222c   ("year", "doi",
+000193f0: 2022 6973 626e 2229 3a0a 2020 2020 2020   "isbn"):.      
+00019400: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00019410: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00019420: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00019430: 422e 6269 6273 2e5f 7072 6570 6172 6549  B.bibs._prepareI
+00019440: 6e73 6572 7446 696c 6c28 7b22 6269 6264  nsertFill({"bibd
+00019450: 6963 7422 3a20 7b6b 3a20 2222 7d7d 292c  ict": {k: ""}}),
+00019460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019470: 207b 2262 6962 6469 6374 223a 207b 6b3a   {"bibdict": {k:
+00019480: 2022 227d 7d2c 0a20 2020 2020 2020 2020   ""}},.         
+00019490: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+000194a0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000194b0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+000194c0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+000194d0: 732e 5f70 7265 7061 7265 496e 7365 7274  s._prepareInsert
+000194e0: 4669 6c6c 287b 2262 6962 6469 6374 223a  Fill({"bibdict":
+000194f0: 207b 6b3a 2022 6162 6322 7d7d 292c 0a20   {k: "abc"}}),. 
+00019500: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00019510: 2262 6962 6469 6374 223a 207b 6b3a 2022  "bibdict": {k: "
+00019520: 6162 6322 7d2c 206b 3a20 2261 6263 227d  abc"}, k: "abc"}
+00019530: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00019540: 0a20 2020 2064 6566 2074 6573 745f 7072  .    def test_pr
+00019550: 6570 6172 6549 6e73 6572 7446 6972 7374  epareInsertFirst
+00019560: 6461 7465 2873 656c 662c 202a 6172 6773  date(self, *args
+00019570: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
+00019580: 7374 205f 7072 6570 6172 6549 6e73 6572  st _prepareInser
+00019590: 7446 6972 7374 6461 7465 2222 220a 2020  tFirstdate""".  
+000195a0: 2020 2020 2020 746f 6461 7920 3d20 6461        today = da
+000195b0: 7465 7469 6d65 2e64 6174 652e 746f 6461  tetime.date.toda
+000195c0: 7928 292e 7374 7266 7469 6d65 2822 2559  y().strftime("%Y
+000195d0: 2d25 6d2d 2564 2229 0a20 2020 2020 2020  -%m-%d").       
+000195e0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000195f0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
+00019600: 656c 662e 7042 4442 2e62 6962 732e 5f70  elf.pBDB.bibs._p
+00019610: 7265 7061 7265 496e 7365 7274 4669 7273  repareInsertFirs
+00019620: 7464 6174 6528 7b7d 292c 0a20 2020 2020  tdate({}),.     
+00019630: 2020 2020 2020 207b 2266 6972 7374 6461         {"firstda
+00019640: 7465 223a 2074 6f64 6179 7d2c 0a20 2020  te": today},.   
+00019650: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00019660: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00019670: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019680: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
+00019690: 7061 7265 496e 7365 7274 4669 7273 7464  pareInsertFirstd
+000196a0: 6174 6528 7b7d 2c20 6669 7273 7464 6174  ate({}, firstdat
+000196b0: 653d 2222 292c 0a20 2020 2020 2020 2020  e=""),.         
+000196c0: 2020 207b 2266 6972 7374 6461 7465 223a     {"firstdate":
+000196d0: 2074 6f64 6179 7d2c 0a20 2020 2020 2020   today},.       
+000196e0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+000196f0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00019700: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00019710: 4442 2e62 6962 732e 5f70 7265 7061 7265  DB.bibs._prepare
+00019720: 496e 7365 7274 4669 7273 7464 6174 6528  InsertFirstdate(
+00019730: 7b7d 2c20 6669 7273 7464 6174 653d 2232  {}, firstdate="2
+00019740: 3032 312d 3037 2d32 3622 292c 0a20 2020  021-07-26"),.   
+00019750: 2020 2020 2020 2020 207b 2266 6972 7374           {"first
+00019760: 6461 7465 223a 2022 3230 3231 2d30 372d  date": "2021-07-
+00019770: 3236 227d 2c0a 2020 2020 2020 2020 290a  26"},.        ).
+00019780: 0a20 2020 2064 6566 2074 6573 745f 7072  .    def test_pr
+00019790: 6570 6172 6549 6e73 6572 744c 696e 6b28  epareInsertLink(
+000197a0: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+000197b0: 2020 2020 2020 2222 2274 6573 7420 5f70        """test _p
+000197c0: 7265 7061 7265 496e 7365 7274 4c69 6e6b  repareInsertLink
+000197d0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+000197e0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+000197f0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00019800: 4244 422e 6269 6273 2e5f 7072 6570 6172  BDB.bibs._prepar
+00019810: 6549 6e73 6572 744c 696e 6b28 7b7d 2c20  eInsertLink({}, 
+00019820: 4e6f 6e65 292c 0a20 2020 2020 2020 2020  None),.         
+00019830: 2020 207b 226c 696e 6b22 3a20 2222 7d2c     {"link": ""},
+00019840: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00019850: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00019860: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00019870: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00019880: 5f70 7265 7061 7265 496e 7365 7274 4c69  _prepareInsertLi
+00019890: 6e6b 287b 7d2c 206c 696e 6b3d 2222 292c  nk({}, link=""),
+000198a0: 0a20 2020 2020 2020 2020 2020 207b 226c  .            {"l
+000198b0: 696e 6b22 3a20 2222 7d2c 0a20 2020 2020  ink": ""},.     
+000198c0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+000198d0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+000198e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000198f0: 7042 4442 2e62 6962 732e 5f70 7265 7061  pBDB.bibs._prepa
+00019900: 7265 496e 7365 7274 4c69 6e6b 287b 7d2c  reInsertLink({},
+00019910: 2022 6162 6322 292c 0a20 2020 2020 2020   "abc"),.       
+00019920: 2020 2020 207b 226c 696e 6b22 3a20 2261       {"link": "a
+00019930: 6263 227d 2c0a 2020 2020 2020 2020 290a  bc"},.        ).
+00019940: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00019950: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00019960: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00019970: 6269 6273 2e5f 7072 6570 6172 6549 6e73  bibs._prepareIns
+00019980: 6572 744c 696e 6b28 7b22 6172 7869 7622  ertLink({"arxiv"
+00019990: 3a20 2222 7d2c 204e 6f6e 6529 2c0a 2020  : ""}, None),.  
+000199a0: 2020 2020 2020 2020 2020 7b22 6172 7869            {"arxi
+000199b0: 7622 3a20 2222 2c20 226c 696e 6b22 3a20  v": "", "link": 
+000199c0: 2222 7d2c 0a20 2020 2020 2020 2029 0a20  ""},.        ). 
+000199d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000199e0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000199f0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00019a00: 6962 732e 5f70 7265 7061 7265 496e 7365  ibs._prepareInse
+00019a10: 7274 4c69 6e6b 287b 2261 7278 6976 223a  rtLink({"arxiv":
+00019a20: 2022 3132 3334 227d 2c20 4e6f 6e65 292c   "1234"}, None),
+00019a30: 0a20 2020 2020 2020 2020 2020 207b 2261  .            {"a
+00019a40: 7278 6976 223a 2022 3132 3334 222c 2022  rxiv": "1234", "
+00019a50: 6c69 6e6b 223a 2070 6243 6f6e 6669 672e  link": pbConfig.
+00019a60: 6172 7869 7655 726c 202b 2022 2f61 6273  arxivUrl + "/abs
+00019a70: 2f31 3233 3422 7d2c 0a20 2020 2020 2020  /1234"},.       
+00019a80: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00019a90: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00019aa0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00019ab0: 4442 2e62 6962 732e 5f70 7265 7061 7265  DB.bibs._prepare
+00019ac0: 496e 7365 7274 4c69 6e6b 287b 2264 6f69  InsertLink({"doi
+00019ad0: 223a 2022 227d 2c20 4e6f 6e65 292c 0a20  ": ""}, None),. 
+00019ae0: 2020 2020 2020 2020 2020 207b 2264 6f69             {"doi
+00019af0: 223a 2022 222c 2022 6c69 6e6b 223a 2022  ": "", "link": "
+00019b00: 227d 2c0a 2020 2020 2020 2020 290a 2020  "},.        ).  
+00019b10: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00019b20: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00019b30: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00019b40: 6273 2e5f 7072 6570 6172 6549 6e73 6572  bs._prepareInser
+00019b50: 744c 696e 6b28 7b22 646f 6922 3a20 2231  tLink({"doi": "1
+00019b60: 3233 3422 7d2c 204e 6f6e 6529 2c0a 2020  234"}, None),.  
+00019b70: 2020 2020 2020 2020 2020 7b22 646f 6922            {"doi"
+00019b80: 3a20 2231 3233 3422 2c20 226c 696e 6b22  : "1234", "link"
+00019b90: 3a20 7062 436f 6e66 6967 2e64 6f69 5572  : pbConfig.doiUr
+00019ba0: 6c20 2b20 2231 3233 3422 7d2c 0a20 2020  l + "1234"},.   
+00019bb0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00019bc0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00019bd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019be0: 662e 7042 4442 2e62 6962 732e 5f70 7265  f.pBDB.bibs._pre
+00019bf0: 7061 7265 496e 7365 7274 4c69 6e6b 287b  pareInsertLink({
+00019c00: 2261 7278 6976 223a 2022 3536 3738 222c  "arxiv": "5678",
+00019c10: 2022 646f 6922 3a20 2222 7d2c 204e 6f6e   "doi": ""}, Non
+00019c20: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00019c30: 7b22 6172 7869 7622 3a20 2235 3637 3822  {"arxiv": "5678"
+00019c40: 2c20 2264 6f69 223a 2022 222c 2022 6c69  , "doi": "", "li
+00019c50: 6e6b 223a 2070 6243 6f6e 6669 672e 6172  nk": pbConfig.ar
+00019c60: 7869 7655 726c 202b 2022 2f61 6273 2f35  xivUrl + "/abs/5
+00019c70: 3637 3822 7d2c 0a20 2020 2020 2020 2029  678"},.        )
+00019c80: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00019c90: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00019ca0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00019cb0: 2e62 6962 732e 5f70 7265 7061 7265 496e  .bibs._prepareIn
+00019cc0: 7365 7274 4c69 6e6b 287b 2261 7278 6976  sertLink({"arxiv
+00019cd0: 223a 2022 3536 3738 222c 2022 646f 6922  ": "5678", "doi"
+00019ce0: 3a20 2231 3233 3422 7d2c 204e 6f6e 6529  : "1234"}, None)
+00019cf0: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
+00019d00: 6172 7869 7622 3a20 2235 3637 3822 2c20  arxiv": "5678", 
+00019d10: 2264 6f69 223a 2022 3132 3334 222c 2022  "doi": "1234", "
+00019d20: 6c69 6e6b 223a 2070 6243 6f6e 6669 672e  link": pbConfig.
+00019d30: 646f 6955 726c 202b 2022 3132 3334 227d  doiUrl + "1234"}
+00019d40: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00019d50: 2064 6566 2074 6573 745f 7072 6570 6172   def test_prepar
+00019d60: 6549 6e73 6572 7453 7461 6e64 6172 6428  eInsertStandard(
+00019d70: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+00019d80: 2020 2020 2020 2222 2274 6573 7420 5f70        """test _p
+00019d90: 7265 7061 7265 496e 7365 7274 5374 616e  repareInsertStan
+00019da0: 6461 7264 2222 220a 2020 2020 2020 2020  dard""".        
+00019db0: 656d 7074 7920 3d20 7b0a 2020 2020 2020  empty = {.      
+00019dc0: 2020 2020 2020 6b3a 204e 6f6e 650a 2020        k: None.  
+00019dd0: 2020 2020 2020 2020 2020 666f 7220 6b20            for k 
+00019de0: 696e 2028 0a20 2020 2020 2020 2020 2020  in (.           
+00019df0: 2020 2020 2022 6162 7374 7261 6374 222c       "abstract",
+00019e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019e10: 2022 6372 6f73 7372 6566 222c 0a20 2020   "crossref",.   
+00019e20: 2020 2020 2020 2020 2020 2020 2022 646f               "do
+00019e30: 6922 2c0a 2020 2020 2020 2020 2020 2020  i",.            
+00019e40: 2020 2020 2269 7362 6e22 2c0a 2020 2020      "isbn",.    
+00019e50: 2020 2020 2020 2020 2020 2020 2261 6473              "ads
+00019e60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00019e70: 2020 2022 636f 6d6d 656e 7473 222c 0a20     "comments",. 
+00019e80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00019e90: 696e 7370 6972 6522 2c0a 2020 2020 2020  inspire",.      
+00019ea0: 2020 2020 2020 2020 2020 226f 6c64 5f6b            "old_k
+00019eb0: 6579 7322 2c0a 2020 2020 2020 2020 2020  eys",.          
+00019ec0: 2020 2020 2020 2273 6368 6f6c 6172 222c        "scholar",
+00019ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019ee0: 2022 6d61 726b 7322 2c0a 2020 2020 2020   "marks",.      
+00019ef0: 2020 2020 2020 2020 2020 2270 7562 6461            "pubda
+00019f00: 7465 222c 0a20 2020 2020 2020 2020 2020  te",.           
+00019f10: 2029 0a20 2020 2020 2020 207d 0a20 2020   ).        }.   
+00019f20: 2020 2020 2066 6f72 206b 2069 6e20 280a       for k in (.
+00019f30: 2020 2020 2020 2020 2020 2020 2262 6f6f              "boo
+00019f40: 6b22 2c0a 2020 2020 2020 2020 2020 2020  k",.            
+00019f50: 2265 7870 5f70 6170 6572 222c 0a20 2020  "exp_paper",.   
+00019f60: 2020 2020 2020 2020 2022 6c65 6374 7572           "lectur
+00019f70: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00019f80: 226e 6f55 7064 6174 6522 2c0a 2020 2020  "noUpdate",.    
+00019f90: 2020 2020 2020 2020 2270 6864 5f74 6865          "phd_the
+00019fa0: 7369 7322 2c0a 2020 2020 2020 2020 2020  sis",.          
+00019fb0: 2020 2270 726f 6365 6564 696e 6722 2c0a    "proceeding",.
+00019fc0: 2020 2020 2020 2020 2020 2020 2272 6576              "rev
+00019fd0: 6965 7722 2c0a 2020 2020 2020 2020 293a  iew",.        ):
+00019fe0: 0a20 2020 2020 2020 2020 2020 2065 6d70  .            emp
+00019ff0: 7479 5b6b 5d20 3d20 300a 2020 2020 2020  ty[k] = 0.      
+0001a000: 2020 666f 7220 6b20 696e 2028 226d 6172    for k in ("mar
+0001a010: 6b73 222c 2022 7075 6264 6174 6522 293a  ks", "pubdate"):
+0001a020: 0a20 2020 2020 2020 2020 2020 2065 6d70  .            emp
+0001a030: 7479 5b6b 5d20 3d20 2222 0a20 2020 2020  ty[k] = "".     
+0001a040: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001a050: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0001a060: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0001a070: 5f70 7265 7061 7265 496e 7365 7274 5374  _prepareInsertSt
+0001a080: 616e 6461 7264 287b 7d2c 207b 7d29 2c0a  andard({}, {}),.
+0001a090: 2020 2020 2020 2020 2020 2020 656d 7074              empt
+0001a0a0: 792c 0a20 2020 2020 2020 2029 0a20 2020  y,.        ).   
+0001a0b0: 2020 2020 2066 6f72 206b 2069 6e20 280a       for k in (.
+0001a0c0: 2020 2020 2020 2020 2020 2020 226d 6172              "mar
+0001a0d0: 6b73 222c 0a20 2020 2020 2020 2020 2020  ks",.           
+0001a0e0: 2022 7075 6264 6174 6522 2c0a 2020 2020   "pubdate",.    
+0001a0f0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+0001a100: 2020 2065 203d 2065 6d70 7479 2e63 6f70     e = empty.cop
+0001a110: 7928 290a 2020 2020 2020 2020 2020 2020  y().            
+0001a120: 655b 6b5d 203d 2022 6162 6322 0a20 2020  e[k] = "abc".   
+0001a130: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0001a140: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0001a150: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001a160: 7042 4442 2e62 6962 732e 5f70 7265 7061  pBDB.bibs._prepa
+0001a170: 7265 496e 7365 7274 5374 616e 6461 7264  reInsertStandard
+0001a180: 287b 7d2c 207b 7d2c 202a 2a7b 6b3a 2022  ({}, {}, **{k: "
+0001a190: 6162 6322 7d29 2c0a 2020 2020 2020 2020  abc"}),.        
+0001a1a0: 2020 2020 2020 2020 652c 0a20 2020 2020          e,.     
+0001a1b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001a1c0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001a1d0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+0001a1e0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0001a1f0: 2e62 6962 732e 5f70 7265 7061 7265 496e  .bibs._prepareIn
+0001a200: 7365 7274 5374 616e 6461 7264 287b 7d2c  sertStandard({},
+0001a210: 207b 7d2c 202a 2a7b 6b3a 2022 227d 292c   {}, **{k: ""}),
+0001a220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a230: 2065 6d70 7479 2c0a 2020 2020 2020 2020   empty,.        
+0001a240: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
+0001a250: 7220 6b20 696e 2028 0a20 2020 2020 2020  r k in (.       
+0001a260: 2020 2020 2022 626f 6f6b 222c 0a20 2020       "book",.   
+0001a270: 2020 2020 2020 2020 2022 6578 705f 7061           "exp_pa
+0001a280: 7065 7222 2c0a 2020 2020 2020 2020 2020  per",.          
+0001a290: 2020 226c 6563 7475 7265 222c 0a20 2020    "lecture",.   
+0001a2a0: 2020 2020 2020 2020 2022 6e6f 5570 6461           "noUpda
+0001a2b0: 7465 222c 0a20 2020 2020 2020 2020 2020  te",.           
+0001a2c0: 2022 7068 645f 7468 6573 6973 222c 0a20   "phd_thesis",. 
+0001a2d0: 2020 2020 2020 2020 2020 2022 7072 6f63             "proc
+0001a2e0: 6565 6469 6e67 222c 0a20 2020 2020 2020  eeding",.       
+0001a2f0: 2020 2020 2022 7265 7669 6577 222c 0a20       "review",. 
+0001a300: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+0001a310: 2020 2020 2020 6520 3d20 656d 7074 792e        e = empty.
+0001a320: 636f 7079 2829 0a20 2020 2020 2020 2020  copy().         
+0001a330: 2020 2065 5b6b 5d20 3d20 310a 2020 2020     e[k] = 1.    
+0001a340: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0001a350: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0001a360: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0001a370: 4244 422e 6269 6273 2e5f 7072 6570 6172  BDB.bibs._prepar
+0001a380: 6549 6e73 6572 7453 7461 6e64 6172 6428  eInsertStandard(
+0001a390: 7b7d 2c20 7b6b 3a20 2264 6566 227d 2c20  {}, {k: "def"}, 
+0001a3a0: 2a2a 7b6b 3a20 2261 6263 227d 292c 0a20  **{k: "abc"}),. 
+0001a3b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001a3c0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001a3d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a3e0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+0001a3f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001a400: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
+0001a410: 6570 6172 6549 6e73 6572 7453 7461 6e64  epareInsertStand
+0001a420: 6172 6428 7b7d 2c20 7b6b 3a20 2264 6566  ard({}, {k: "def
+0001a430: 227d 292c 0a20 2020 2020 2020 2020 2020  "}),.           
+0001a440: 2020 2020 2065 6d70 7479 2c0a 2020 2020       empty,.    
+0001a450: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001a460: 2020 666f 7220 6b20 696e 2028 2261 6273    for k in ("abs
+0001a470: 7472 6163 7422 2c20 2263 726f 7373 7265  tract", "crossre
+0001a480: 6622 2c20 2264 6f69 222c 2022 6973 626e  f", "doi", "isbn
+0001a490: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+0001a4a0: 6520 3d20 656d 7074 792e 636f 7079 2829  e = empty.copy()
+0001a4b0: 0a20 2020 2020 2020 2020 2020 2065 5b6b  .            e[k
+0001a4c0: 5d20 3d20 2261 6263 220a 2020 2020 2020  ] = "abc".      
+0001a4d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001a4e0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0001a4f0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0001a500: 422e 6269 6273 2e5f 7072 6570 6172 6549  B.bibs._prepareI
+0001a510: 6e73 6572 7453 7461 6e64 6172 6428 7b7d  nsertStandard({}
+0001a520: 2c20 7b6b 3a20 2264 6566 227d 2c20 2a2a  , {k: "def"}, **
+0001a530: 7b6b 3a20 2261 6263 227d 292c 0a20 2020  {k: "abc"}),.   
+0001a540: 2020 2020 2020 2020 2020 2020 2065 2c0a               e,.
+0001a550: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001a560: 2020 2020 2020 2020 2020 655b 6b5d 203d            e[k] =
+0001a570: 2022 6465 6622 0a20 2020 2020 2020 2020   "def".         
+0001a580: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001a590: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0001a5a0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0001a5b0: 6962 732e 5f70 7265 7061 7265 496e 7365  ibs._prepareInse
+0001a5c0: 7274 5374 616e 6461 7264 287b 7d2c 207b  rtStandard({}, {
+0001a5d0: 6b3a 2022 6465 6622 7d29 2c0a 2020 2020  k: "def"}),.    
+0001a5e0: 2020 2020 2020 2020 2020 2020 652c 0a20              e,. 
+0001a5f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0001a600: 2020 6465 6620 7465 7374 5f70 7265 7061    def test_prepa
+0001a610: 7265 496e 7365 7274 5965 6172 2873 656c  reInsertYear(sel
+0001a620: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
+0001a630: 2020 2022 2222 7465 7374 205f 7072 6570     """test _prep
+0001a640: 6172 6549 6e73 6572 7459 6561 7222 2222  areInsertYear"""
+0001a650: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0001a660: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0001a670: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0001a680: 2e62 6962 732e 5f70 7265 7061 7265 496e  .bibs._prepareIn
+0001a690: 7365 7274 5965 6172 287b 7d2c 207b 7d2c  sertYear({}, {},
+0001a6a0: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
+0001a6b0: 2020 2020 7b22 7965 6172 223a 204e 6f6e      {"year": Non
+0001a6c0: 657d 2c0a 2020 2020 2020 2020 290a 2020  e},.        ).  
+0001a6d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001a6e0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0001a6f0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0001a700: 6273 2e5f 7072 6570 6172 6549 6e73 6572  bs._prepareInser
+0001a710: 7459 6561 7228 7b7d 2c20 7b22 7965 6172  tYear({}, {"year
+0001a720: 223a 2022 3230 3231 227d 2c20 7965 6172  ": "2021"}, year
+0001a730: 3d4e 6f6e 6529 2c0a 2020 2020 2020 2020  =None),.        
+0001a740: 2020 2020 7b22 7965 6172 223a 2022 3230      {"year": "20
+0001a750: 3231 227d 2c0a 2020 2020 2020 2020 290a  21"},.        ).
+0001a760: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0001a770: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0001a780: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0001a790: 6269 6273 2e5f 7072 6570 6172 6549 6e73  bibs._prepareIns
+0001a7a0: 6572 7459 6561 7228 0a20 2020 2020 2020  ertYear(.       
+0001a7b0: 2020 2020 2020 2020 207b 2261 7278 6976           {"arxiv
+0001a7c0: 223a 2022 3139 3031 2e30 3132 3334 227d  ": "1901.01234"}
+0001a7d0: 2c20 7b22 7965 6172 223a 2022 3230 3231  , {"year": "2021
+0001a7e0: 227d 2c20 7965 6172 3d4e 6f6e 650a 2020  "}, year=None.  
+0001a7f0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0001a800: 2020 2020 2020 2020 207b 2261 7278 6976           {"arxiv
+0001a810: 223a 2022 3139 3031 2e30 3132 3334 222c  ": "1901.01234",
+0001a820: 2022 7965 6172 223a 2022 3230 3231 227d   "year": "2021"}
+0001a830: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0001a840: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001a850: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+0001a860: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0001a870: 2e5f 7072 6570 6172 6549 6e73 6572 7459  ._prepareInsertY
+0001a880: 6561 7228 7b22 6172 7869 7622 3a20 2231  ear({"arxiv": "1
+0001a890: 3930 312e 3031 3233 3422 7d2c 207b 7d2c  901.01234"}, {},
+0001a8a0: 2079 6561 723d 4e6f 6e65 292c 0a20 2020   year=None),.   
+0001a8b0: 2020 2020 2020 2020 207b 2261 7278 6976           {"arxiv
+0001a8c0: 223a 2022 3139 3031 2e30 3132 3334 222c  ": "1901.01234",
+0001a8d0: 2022 7965 6172 223a 2022 3230 3139 227d   "year": "2019"}
+0001a8e0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0001a8f0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001a900: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+0001a910: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0001a920: 2e5f 7072 6570 6172 6549 6e73 6572 7459  ._prepareInsertY
+0001a930: 6561 7228 0a20 2020 2020 2020 2020 2020  ear(.           
+0001a940: 2020 2020 207b 2261 7278 6976 223a 2022       {"arxiv": "
+0001a950: 3139 3031 2e30 3132 3334 227d 2c20 7b22  1901.01234"}, {"
+0001a960: 7965 6172 223a 2022 3230 3231 227d 2c20  year": "2021"}, 
+0001a970: 7965 6172 3d22 3230 3035 220a 2020 2020  year="2005".    
+0001a980: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+0001a990: 2020 2020 2020 207b 2261 7278 6976 223a         {"arxiv":
+0001a9a0: 2022 3139 3031 2e30 3132 3334 222c 2022   "1901.01234", "
+0001a9b0: 7965 6172 223a 2022 3230 3035 227d 2c0a  year": "2005"},.
+0001a9c0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0001a9d0: 6566 2074 6573 745f 7072 6f63 6573 7351  ef test_processQ
+0001a9e0: 7565 7279 4669 656c 6473 2873 656c 662c  ueryFields(self,
+0001a9f0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
+0001aa00: 2022 2222 7465 7374 205f 7072 6f63 6573   """test _proces
+0001aa10: 7351 7565 7279 4669 656c 6473 2222 220a  sQueryFields""".
+0001aa20: 2020 2020 2020 2020 2320 6661 696c 696e          # failin
+0001aa30: 670a 2020 2020 2020 2020 7365 6c66 2e61  g.        self.a
+0001aa40: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+0001aa50: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0001aa60: 422e 6269 6273 2e5f 7072 6f63 6573 7351  B.bibs._processQ
+0001aa70: 7565 7279 4669 656c 6473 280a 2020 2020  ueryFields(.    
+0001aa80: 2020 2020 2020 2020 2020 2020 7b22 6c6f              {"lo
+0001aa90: 6769 6361 6c22 3a20 2261 6263 222c 2022  gical": "abc", "
+0001aaa0: 7479 7065 223a 2022 5465 7874 222c 2022  type": "Text", "
+0001aab0: 636f 6e74 656e 7422 3a20 2222 2c20 226f  content": "", "o
+0001aac0: 7065 7261 746f 7222 3a20 2262 6222 7d2c  perator": "bb"},
+0001aad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aae0: 2054 7275 652c 0a20 2020 2020 2020 2020   True,.         
+0001aaf0: 2020 2020 2020 2022 6162 6322 2c0a 2020         "abc",.  
+0001ab00: 2020 2020 2020 2020 2020 2020 2020 2277                "w
+0001ab10: 6865 7265 222c 0a20 2020 2020 2020 2020  here",.         
+0001ab20: 2020 2020 2020 2022 6a6f 696e 222c 0a20         "join",. 
+0001ab30: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0001ab40: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
+0001ab50: 2c0a 2020 2020 2020 2020 2020 2020 2854  ,.            (T
+0001ab60: 7275 652c 2022 6162 6322 2c20 2277 6865  rue, "abc", "whe
+0001ab70: 7265 222c 2022 6a6f 696e 222c 2028 2929  re", "join", ())
+0001ab80: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0001ab90: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001aba0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+0001abb0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0001abc0: 2e5f 7072 6f63 6573 7351 7565 7279 4669  ._processQueryFi
+0001abd0: 656c 6473 280a 2020 2020 2020 2020 2020  elds(.          
+0001abe0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+0001abf0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0001ac00: 6963 616c 223a 2022 6162 6322 2c0a 2020  ical": "abc",.  
+0001ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac20: 2020 2274 7970 6522 3a20 2243 6174 6567    "type": "Categ
+0001ac30: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
+0001ac40: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+0001ac50: 7465 6e74 223a 2022 222c 0a20 2020 2020  tent": "",.     
+0001ac60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001ac70: 6f70 6572 6174 6f72 223a 2022 6262 222c  operator": "bb",
+0001ac80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ac90: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+0001aca0: 2020 2020 5472 7565 2c0a 2020 2020 2020      True,.      
+0001acb0: 2020 2020 2020 2020 2020 2261 6263 222c            "abc",
+0001acc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001acd0: 2022 7768 6572 6522 2c0a 2020 2020 2020   "where",.      
+0001ace0: 2020 2020 2020 2020 2020 226a 6f69 6e22            "join"
+0001acf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001ad00: 2020 2829 2c0a 2020 2020 2020 2020 2020    (),.          
+0001ad10: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+0001ad20: 2028 5472 7565 2c20 2261 6263 222c 2022   (True, "abc", "
+0001ad30: 7768 6572 6522 2c20 226a 6f69 6e22 2c20  where", "join", 
+0001ad40: 2829 292c 0a20 2020 2020 2020 2029 0a20  ()),.        ). 
+0001ad50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001ad60: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+0001ad70: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0001ad80: 6962 732e 5f70 726f 6365 7373 5175 6572  ibs._processQuer
+0001ad90: 7946 6965 6c64 7328 0a20 2020 2020 2020  yFields(.       
+0001ada0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+0001adb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001adc0: 6c6f 6769 6361 6c22 3a20 2261 6263 222c  logical": "abc",
+0001add0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ade0: 2020 2020 2022 7479 7065 223a 2022 4578       "type": "Ex
+0001adf0: 7065 7269 6d65 6e74 7322 2c0a 2020 2020  periments",.    
+0001ae00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae10: 2263 6f6e 7465 6e74 223a 2022 222c 0a20  "content": "",. 
+0001ae20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae30: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+0001ae40: 6262 222c 0a20 2020 2020 2020 2020 2020  bb",.           
+0001ae50: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+0001ae60: 2020 2020 2020 2020 5472 7565 2c0a 2020          True,.  
+0001ae70: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0001ae80: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+0001ae90: 2020 2020 2022 7768 6572 6522 2c0a 2020       "where",.  
+0001aea0: 2020 2020 2020 2020 2020 2020 2020 226a                "j
+0001aeb0: 6f69 6e22 2c0a 2020 2020 2020 2020 2020  oin",.          
+0001aec0: 2020 2020 2020 2829 2c0a 2020 2020 2020        (),.      
+0001aed0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001aee0: 2020 2020 2028 5472 7565 2c20 2261 6263       (True, "abc
+0001aef0: 222c 2022 7768 6572 6522 2c20 226a 6f69  ", "where", "joi
+0001af00: 6e22 2c20 2829 292c 0a20 2020 2020 2020  n", ()),.       
+0001af10: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+0001af20: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0001af30: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0001af40: 4442 2e62 6962 732e 5f70 726f 6365 7373  DB.bibs._process
+0001af50: 5175 6572 7946 6965 6c64 7328 0a20 2020  QueryFields(.   
+0001af60: 2020 2020 2020 2020 2020 2020 207b 226c               {"l
+0001af70: 6f67 6963 616c 223a 2022 6162 6322 2c20  ogical": "abc", 
+0001af80: 2274 7970 6522 3a20 224d 6172 6b73 222c  "type": "Marks",
+0001af90: 2022 636f 6e74 656e 7422 3a20 2222 2c20   "content": "", 
+0001afa0: 226f 7065 7261 746f 7222 3a20 2262 6222  "operator": "bb"
+0001afb0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0001afc0: 2020 2054 7275 652c 0a20 2020 2020 2020     True,.       
+0001afd0: 2020 2020 2020 2020 2022 6162 6322 2c0a           "abc",.
+0001afe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aff0: 2277 6865 7265 222c 0a20 2020 2020 2020  "where",.       
+0001b000: 2020 2020 2020 2020 2022 6a6f 696e 222c           "join",
+0001b010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b020: 2028 292c 0a20 2020 2020 2020 2020 2020   (),.           
+0001b030: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0001b040: 2854 7275 652c 2022 6162 6322 2c20 2277  (True, "abc", "w
+0001b050: 6865 7265 222c 2022 6a6f 696e 222c 2028  here", "join", (
+0001b060: 2929 2c0a 2020 2020 2020 2020 290a 2020  )),.        ).  
+0001b070: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001b080: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0001b090: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0001b0a0: 6273 2e5f 7072 6f63 6573 7351 7565 7279  bs._processQuery
+0001b0b0: 4669 656c 6473 280a 2020 2020 2020 2020  Fields(.        
+0001b0c0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0001b0d0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+0001b0e0: 6f67 6963 616c 223a 2022 6162 6322 2c0a  ogical": "abc",.
+0001b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b100: 2020 2020 2274 7970 6522 3a20 224d 6172      "type": "Mar
+0001b110: 6b73 222c 0a20 2020 2020 2020 2020 2020  ks",.           
+0001b120: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
+0001b130: 7422 3a20 5b22 6122 2c20 2262 225d 2c0a  t": ["a", "b"],.
+0001b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b150: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
+0001b160: 2262 6222 2c0a 2020 2020 2020 2020 2020  "bb",.          
+0001b170: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0001b180: 2020 2020 2020 2020 2054 7275 652c 0a20           True,. 
+0001b190: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b1a0: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
+0001b1b0: 2020 2020 2020 2277 6865 7265 222c 0a20        "where",. 
+0001b1c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b1d0: 6a6f 696e 222c 0a20 2020 2020 2020 2020  join",.         
+0001b1e0: 2020 2020 2020 2028 292c 0a20 2020 2020         (),.     
+0001b1f0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+0001b200: 2020 2020 2020 2854 7275 652c 2022 6162        (True, "ab
+0001b210: 6322 2c20 2277 6865 7265 222c 2022 6a6f  c", "where", "jo
+0001b220: 696e 222c 2028 2929 2c0a 2020 2020 2020  in", ()),.      
+0001b230: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+0001b240: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+0001b250: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0001b260: 4244 422e 6269 6273 2e5f 7072 6f63 6573  BDB.bibs._proces
+0001b270: 7351 7565 7279 4669 656c 6473 280a 2020  sQueryFields(.  
+0001b280: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+0001b290: 6c6f 6769 6361 6c22 3a20 2261 6263 222c  logical": "abc",
+0001b2a0: 2022 7479 7065 223a 2022 5479 7065 222c   "type": "Type",
+0001b2b0: 2022 636f 6e74 656e 7422 3a20 2222 2c20   "content": "", 
+0001b2c0: 226f 7065 7261 746f 7222 3a20 2262 6222  "operator": "bb"
+0001b2d0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0001b2e0: 2020 2054 7275 652c 0a20 2020 2020 2020     True,.       
+0001b2f0: 2020 2020 2020 2020 2022 6162 6322 2c0a           "abc",.
+0001b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b310: 2277 6865 7265 222c 0a20 2020 2020 2020  "where",.       
+0001b320: 2020 2020 2020 2020 2022 6a6f 696e 222c           "join",
+0001b330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b340: 2028 292c 0a20 2020 2020 2020 2020 2020   (),.           
+0001b350: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0001b360: 2854 7275 652c 2022 6162 6322 2c20 2277  (True, "abc", "w
+0001b370: 6865 7265 222c 2022 6a6f 696e 222c 2028  here", "join", (
+0001b380: 2929 2c0a 2020 2020 2020 2020 290a 2020  )),.        ).  
+0001b390: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001b3a0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0001b3b0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0001b3c0: 6273 2e5f 7072 6f63 6573 7351 7565 7279  bs._processQuery
+0001b3d0: 4669 656c 6473 280a 2020 2020 2020 2020  Fields(.        
+0001b3e0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0001b3f0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+0001b400: 6f67 6963 616c 223a 2022 6162 6322 2c0a  ogical": "abc",.
+0001b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b420: 2020 2020 2274 7970 6522 3a20 2254 7970      "type": "Typ
+0001b430: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0001b440: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
+0001b450: 223a 205b 2261 222c 2022 6222 5d2c 0a20  ": ["a", "b"],. 
+0001b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b470: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+0001b480: 6262 222c 0a20 2020 2020 2020 2020 2020  bb",.           
+0001b490: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+0001b4a0: 2020 2020 2020 2020 5472 7565 2c0a 2020          True,.  
+0001b4b0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0001b4c0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+0001b4d0: 2020 2020 2022 7768 6572 6522 2c0a 2020       "where",.  
+0001b4e0: 2020 2020 2020 2020 2020 2020 2020 226a                "j
+0001b4f0: 6f69 6e22 2c0a 2020 2020 2020 2020 2020  oin",.          
+0001b500: 2020 2020 2020 2829 2c0a 2020 2020 2020        (),.      
+0001b510: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001b520: 2020 2020 2028 5472 7565 2c20 2261 6263       (True, "abc
+0001b530: 222c 2022 7768 6572 6522 2c20 226a 6f69  ", "where", "joi
+0001b540: 6e22 2c20 2829 292c 0a20 2020 2020 2020  n", ()),.       
+0001b550: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+0001b560: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0001b570: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0001b580: 4442 2e62 6962 732e 5f70 726f 6365 7373  DB.bibs._process
+0001b590: 5175 6572 7946 6965 6c64 7328 0a20 2020  QueryFields(.   
+0001b5a0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+0001b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5c0: 2020 2022 6c6f 6769 6361 6c22 3a20 2261     "logical": "a
+0001b5d0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+0001b5e0: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+0001b5f0: 2022 7261 6e64 6f6d 222c 0a20 2020 2020   "random",.     
+0001b600: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b610: 636f 6e74 656e 7422 3a20 5b22 6122 2c20  content": ["a", 
+0001b620: 2262 225d 2c0a 2020 2020 2020 2020 2020  "b"],.          
+0001b630: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+0001b640: 746f 7222 3a20 2262 6222 2c0a 2020 2020  tor": "bb",.    
+0001b650: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0001b660: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+0001b670: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0001b680: 2020 2020 2022 6162 6322 2c0a 2020 2020       "abc",.    
+0001b690: 2020 2020 2020 2020 2020 2020 2277 6865              "whe
+0001b6a0: 7265 222c 0a20 2020 2020 2020 2020 2020  re",.           
+0001b6b0: 2020 2020 2022 6a6f 696e 222c 0a20 2020       "join",.   
+0001b6c0: 2020 2020 2020 2020 2020 2020 2028 292c               (),
+0001b6d0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+0001b6e0: 2020 2020 2020 2020 2020 2020 2846 616c              (Fal
+0001b6f0: 7365 2c20 2261 6263 222c 2022 7768 6572  se, "abc", "wher
+0001b700: 6522 2c20 226a 6f69 6e22 2c20 2829 292c  e", "join", ()),
+0001b710: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0001b720: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001b730: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0001b740: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0001b750: 5f70 726f 6365 7373 5175 6572 7946 6965  _processQueryFie
+0001b760: 6c64 7328 0a20 2020 2020 2020 2020 2020  lds(.           
+0001b770: 2020 2020 207b 226c 6f67 6963 616c 223a       {"logical":
+0001b780: 2022 6162 6322 2c20 2274 7970 6522 3a20   "abc", "type": 
+0001b790: 2254 6578 7422 2c20 2263 6f6e 7465 6e74  "Text", "content
+0001b7a0: 223a 2022 222c 2022 6f70 6572 6174 6f72  ": "", "operator
+0001b7b0: 223a 2022 6262 227d 2c0a 2020 2020 2020  ": "bb"},.      
+0001b7c0: 2020 2020 2020 2020 2020 4661 6c73 652c            False,
+0001b7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b7e0: 2022 6162 6322 2c0a 2020 2020 2020 2020   "abc",.        
+0001b7f0: 2020 2020 2020 2020 2277 6865 7265 222c          "where",
+0001b800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b810: 2022 6a6f 696e 222c 0a20 2020 2020 2020   "join",.       
+0001b820: 2020 2020 2020 2020 2028 292c 0a20 2020           (),.   
+0001b830: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+0001b840: 2020 2020 2020 2020 2846 616c 7365 2c20          (False, 
+0001b850: 2261 6263 222c 2022 7768 6572 6522 2c20  "abc", "where", 
+0001b860: 226a 6f69 6e22 2c20 2829 292c 0a20 2020  "join", ()),.   
+0001b870: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0001b880: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001b890: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001b8a0: 662e 7042 4442 2e62 6962 732e 5f70 726f  f.pBDB.bibs._pro
+0001b8b0: 6365 7373 5175 6572 7946 6965 6c64 7328  cessQueryFields(
+0001b8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b8d0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0001b8e0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+0001b8f0: 3a20 2261 6263 222c 0a20 2020 2020 2020  : "abc",.       
+0001b900: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+0001b910: 7065 223a 2022 5465 7874 222c 0a20 2020  pe": "Text",.   
+0001b920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b930: 2022 636f 6e74 656e 7422 3a20 2222 2c0a   "content": "",.
+0001b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b950: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
+0001b960: 223d 222c 0a20 2020 2020 2020 2020 2020  "=",.           
+0001b970: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
+0001b980: 3a20 2262 6222 2c0a 2020 2020 2020 2020  : "bb",.        
+0001b990: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+0001b9a0: 2020 2020 2020 2020 2020 2046 616c 7365             False
+0001b9b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001b9c0: 2020 2261 6263 222c 0a20 2020 2020 2020    "abc",.       
+0001b9d0: 2020 2020 2020 2020 2022 7768 6572 6522           "where"
+0001b9e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001b9f0: 2020 226a 6f69 6e22 2c0a 2020 2020 2020    "join",.      
+0001ba00: 2020 2020 2020 2020 2020 2829 2c0a 2020            (),.  
+0001ba10: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0001ba20: 2020 2020 2020 2020 2028 4661 6c73 652c           (False,
+0001ba30: 2022 6162 6322 2c20 2277 6865 7265 222c   "abc", "where",
+0001ba40: 2022 6a6f 696e 222c 2028 2929 2c0a 2020   "join", ()),.  
+0001ba50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001ba60: 2320 776f 726b 696e 670a 2020 2020 2020  # working.      
+0001ba70: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001ba80: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0001ba90: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
+0001baa0: 7072 6f63 6573 7351 7565 7279 4669 656c  processQueryFiel
+0001bab0: 6473 280a 2020 2020 2020 2020 2020 2020  ds(.            
+0001bac0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0001bad0: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+0001bae0: 616c 223a 2022 6162 6322 2c0a 2020 2020  al": "abc",.    
+0001baf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bb00: 2274 7970 6522 3a20 2254 6578 7422 2c0a  "type": "Text",.
+0001bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bb20: 2020 2020 2263 6f6e 7465 6e74 223a 2022      "content": "
+0001bb30: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
+0001bb40: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+0001bb50: 746f 7222 3a20 223d 222c 0a20 2020 2020  tor": "=",.     
+0001bb60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001bb70: 6669 656c 6422 3a20 2262 6962 7465 7822  field": "bibtex"
+0001bb80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001bb90: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+0001bba0: 2020 2020 2046 616c 7365 2c0a 2020 2020       False,.    
+0001bbb0: 2020 2020 2020 2020 2020 2020 2261 6263              "abc
+0001bbc0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001bbd0: 2020 2022 7768 6572 6520 222c 0a20 2020     "where ",.   
+0001bbe0: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
+0001bbf0: 696e 2022 2c0a 2020 2020 2020 2020 2020  in ",.          
+0001bc00: 2020 2020 2020 2829 2c0a 2020 2020 2020        (),.      
+0001bc10: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001bc20: 2020 2020 2028 4661 6c73 652c 2022 6162       (False, "ab
+0001bc30: 6322 2c20 2277 6865 7265 2061 6e64 2062  c", "where and b
+0001bc40: 6962 7465 7820 3d20 3f20 222c 2022 6a6f  ibtex = ? ", "jo
+0001bc50: 696e 2022 2c20 2822 6162 6322 2c29 292c  in ", ("abc",)),
+0001bc60: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0001bc70: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001bc80: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0001bc90: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0001bca0: 5f70 726f 6365 7373 5175 6572 7946 6965  _processQueryFie
+0001bcb0: 6c64 7328 0a20 2020 2020 2020 2020 2020  lds(.           
+0001bcc0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+0001bcd0: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+0001bce0: 6361 6c22 3a20 2261 6263 222c 0a20 2020  cal": "abc",.   
+0001bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd00: 2022 7479 7065 223a 2022 5465 7874 222c   "type": "Text",
+0001bd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bd20: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+0001bd30: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
+0001bd40: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
+0001bd50: 6174 6f72 223a 2022 3d22 2c0a 2020 2020  ator": "=",.    
+0001bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd70: 2266 6965 6c64 223a 2022 6269 6274 6578  "field": "bibtex
+0001bd80: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001bd90: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+0001bda0: 2020 2020 2020 4661 6c73 652c 0a20 2020        False,.   
+0001bdb0: 2020 2020 2020 2020 2020 2020 2022 6162               "ab
+0001bdc0: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
+0001bdd0: 2020 2020 2277 6865 7265 2022 2c0a 2020      "where ",.  
+0001bde0: 2020 2020 2020 2020 2020 2020 2020 226a                "j
+0001bdf0: 6f69 6e20 222c 0a20 2020 2020 2020 2020  oin ",.         
+0001be00: 2020 2020 2020 2028 292c 0a20 2020 2020         (),.     
+0001be10: 2020 2020 2020 2020 2020 2070 7265 7065             prepe
+0001be20: 6e64 5461 623d 2265 6e74 7269 6531 732e  ndTab="entrie1s.
+0001be30: 222c 0a20 2020 2020 2020 2020 2020 2029  ",.            )
+0001be40: 2c0a 2020 2020 2020 2020 2020 2020 2846  ,.            (F
+0001be50: 616c 7365 2c20 2261 6263 222c 2022 7768  alse, "abc", "wh
+0001be60: 6572 6520 616e 6420 656e 7472 6965 3173  ere and entrie1s
+0001be70: 2e62 6962 7465 7820 3d20 3f20 222c 2022  .bibtex = ? ", "
+0001be80: 6a6f 696e 2022 2c20 2822 6162 6322 2c29  join ", ("abc",)
+0001be90: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+0001bea0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001beb0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+0001bec0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0001bed0: 732e 5f70 726f 6365 7373 5175 6572 7946  s._processQueryF
+0001bee0: 6965 6c64 7328 0a20 2020 2020 2020 2020  ields(.         
+0001bef0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0001bf00: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+0001bf10: 6769 6361 6c22 3a20 2261 6263 222c 0a20  gical": "abc",. 
+0001bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf30: 2020 2022 7479 7065 223a 2022 4361 7465     "type": "Cate
+0001bf40: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
+0001bf50: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+0001bf60: 6e74 656e 7422 3a20 2231 222c 0a20 2020  ntent": "1",.   
+0001bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf80: 2022 6f70 6572 6174 6f72 223a 2022 6174   "operator": "at
+0001bf90: 206c 6561 7374 206f 6e65 2061 6d6f 6e67   least one among
+0001bfa0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001bfb0: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
+0001bfc0: 2262 6962 7465 7822 2c0a 2020 2020 2020  "bibtex",.      
+0001bfd0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+0001bfe0: 2020 2020 2020 2020 2020 2020 2046 616c               Fal
+0001bff0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+0001c000: 2020 2020 2261 6263 222c 0a20 2020 2020      "abc",.     
+0001c010: 2020 2020 2020 2020 2020 2022 7768 6572             "wher
+0001c020: 6520 222c 0a20 2020 2020 2020 2020 2020  e ",.           
+0001c030: 2020 2020 2022 6a6f 696e 2022 2c0a 2020       "join ",.  
+0001c040: 2020 2020 2020 2020 2020 2020 2020 2829                ()
+0001c050: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c060: 2020 7072 6570 656e 6454 6162 3d22 656e    prependTab="en
+0001c070: 7472 6965 3173 2e22 2c0a 2020 2020 2020  trie1s.",.      
+0001c080: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001c090: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+0001c0a0: 2020 2020 2020 2046 616c 7365 2c0a 2020         False,.  
+0001c0b0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0001c0c0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+0001c0d0: 2020 2020 2022 7768 6572 6520 616e 6420       "where and 
+0001c0e0: 656e 7472 7943 6174 732e 6964 4361 7420  entryCats.idCat 
+0001c0f0: 3d20 3f20 2022 2c0a 2020 2020 2020 2020  = ?  ",.        
+0001c100: 2020 2020 2020 2020 226a 6f69 6e20 206c          "join  l
+0001c110: 6566 7420 6a6f 696e 2065 6e74 7279 4361  eft join entryCa
+0001c120: 7473 206f 6e20 656e 7472 6965 732e 6269  ts on entries.bi
+0001c130: 626b 6579 3d65 6e74 7279 4361 7473 2e62  bkey=entryCats.b
+0001c140: 6962 6b65 7922 2c0a 2020 2020 2020 2020  ibkey",.        
+0001c150: 2020 2020 2020 2020 2822 3122 2c29 2c0a          ("1",),.
+0001c160: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0001c170: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001c180: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0001c190: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
+0001c1a0: 656c 662e 7042 4442 2e62 6962 732e 5f70  elf.pBDB.bibs._p
+0001c1b0: 726f 6365 7373 5175 6572 7946 6965 6c64  rocessQueryField
+0001c1c0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0001c1d0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+0001c1e0: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
+0001c1f0: 6c22 3a20 2261 6263 222c 0a20 2020 2020  l": "abc",.     
+0001c200: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001c210: 7479 7065 223a 2022 4578 7065 7269 6d65  type": "Experime
+0001c220: 6e74 7322 2c0a 2020 2020 2020 2020 2020  nts",.          
+0001c230: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+0001c240: 6e74 223a 205b 2231 222c 2022 3222 5d2c  nt": ["1", "2"],
 0001c250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c260: 2020 2020 2022 7479 7065 223a 2022 4578       "type": "Ex
-0001c270: 7065 7269 6d65 6e74 7322 2c0a 2020 2020  periments",.    
-0001c280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c290: 2263 6f6e 7465 6e74 223a 205b 2231 222c  "content": ["1",
-0001c2a0: 2022 3222 5d2c 0a20 2020 2020 2020 2020   "2"],.         
-0001c2b0: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
-0001c2c0: 6174 6f72 223a 2022 616c 6c20 7468 6520  ator": "all the 
-0001c2d0: 666f 6c6c 6f77 696e 6722 2c0a 2020 2020  following",.    
-0001c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2f0: 2266 6965 6c64 223a 2022 6269 6274 6578  "field": "bibtex
-0001c300: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001c310: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-0001c320: 2020 2020 2020 5472 7565 2c0a 2020 2020        True,.    
-0001c330: 2020 2020 2020 2020 2020 2020 2261 6263              "abc
-0001c340: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001c350: 2020 2022 7768 6572 6520 222c 0a20 2020     "where ",.   
-0001c360: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
-0001c370: 696e 2022 2c0a 2020 2020 2020 2020 2020  in ",.          
-0001c380: 2020 2020 2020 2829 2c0a 2020 2020 2020        (),.      
-0001c390: 2020 2020 2020 2020 2020 7072 6570 656e            prepen
-0001c3a0: 6454 6162 3d22 656e 7472 6965 3173 2e22  dTab="entrie1s."
-0001c3b0: 2c0a 2020 2020 2020 2020 2020 2020 292c  ,.            ),
-0001c3c0: 0a20 2020 2020 2020 2020 2020 2028 0a20  .            (. 
-0001c3d0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-0001c3e0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-0001c3f0: 2020 2020 2020 2261 6263 222c 0a20 2020        "abc",.   
-0001c400: 2020 2020 2020 2020 2020 2020 2022 7768               "wh
-0001c410: 6572 6520 2028 656e 7472 7945 7870 7330  ere  (entryExps0
-0001c420: 2e69 6445 7870 203d 203f 2061 6e64 2065  .idExp = ? and e
-0001c430: 6e74 7279 4578 7073 312e 6964 4578 7020  ntryExps1.idExp 
-0001c440: 3d20 3f29 2022 2c0a 2020 2020 2020 2020  = ?) ",.        
-0001c450: 2020 2020 2020 2020 226a 6f69 6e20 206c          "join  l
-0001c460: 6566 7420 6a6f 696e 2065 6e74 7279 4578  eft join entryEx
-0001c470: 7073 2065 6e74 7279 4578 7073 3020 6f6e  ps entryExps0 on
-0001c480: 2065 6e74 7269 6573 2e62 6962 6b65 793d   entries.bibkey=
-0001c490: 656e 7472 7945 7870 7330 2e62 6962 6b65  entryExps0.bibke
-0001c4a0: 7920 206c 6566 7420 6a6f 696e 2065 6e74  y  left join ent
-0001c4b0: 7279 4578 7073 2065 6e74 7279 4578 7073  ryExps entryExps
-0001c4c0: 3120 6f6e 2065 6e74 7269 6573 2e62 6962  1 on entries.bib
-0001c4d0: 6b65 793d 656e 7472 7945 7870 7331 2e62  key=entryExps1.b
-0001c4e0: 6962 6b65 7922 2c0a 2020 2020 2020 2020  ibkey",.        
-0001c4f0: 2020 2020 2020 2020 2822 3122 2c20 2232          ("1", "2
-0001c500: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-0001c510: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-0001c520: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001c530: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0001c540: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-0001c550: 732e 5f70 726f 6365 7373 5175 6572 7946  s._processQueryF
-0001c560: 6965 6c64 7328 0a20 2020 2020 2020 2020  ields(.         
-0001c570: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-0001c580: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-0001c590: 6769 6361 6c22 3a20 2261 6263 222c 0a20  gical": "abc",. 
-0001c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5b0: 2020 2022 7479 7065 223a 2022 4d61 726b     "type": "Mark
-0001c5c0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
-0001c5d0: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
-0001c5e0: 223a 205b 2261 6263 225d 2c0a 2020 2020  ": ["abc"],.    
-0001c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c600: 226f 7065 7261 746f 7222 3a20 223d 222c  "operator": "=",
-0001c610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c620: 2020 2020 2022 6669 656c 6422 3a20 2262       "field": "b
-0001c630: 6962 7465 7822 2c0a 2020 2020 2020 2020  ibtex",.        
-0001c640: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0001c650: 2020 2020 2020 2020 2020 2046 616c 7365             False
-0001c660: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c670: 2020 2261 6263 222c 0a20 2020 2020 2020    "abc",.       
-0001c680: 2020 2020 2020 2020 2022 7768 6572 6520           "where 
-0001c690: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001c6a0: 2020 2022 6a6f 696e 2022 2c0a 2020 2020     "join ",.    
-0001c6b0: 2020 2020 2020 2020 2020 2020 2829 2c0a              (),.
-0001c6c0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001c6d0: 2020 2020 2020 2020 2020 2028 4661 6c73             (Fals
-0001c6e0: 652c 2022 6162 6322 2c20 2277 6865 7265  e, "abc", "where
-0001c6f0: 2061 6e64 206d 6172 6b73 203d 203f 2022   and marks = ? "
-0001c700: 2c20 226a 6f69 6e20 222c 2028 2261 6263  , "join ", ("abc
-0001c710: 222c 2929 2c0a 2020 2020 2020 2020 290a  ",)),.        ).
-0001c720: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001c730: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0001c740: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0001c750: 6269 6273 2e5f 7072 6f63 6573 7351 7565  bibs._processQue
-0001c760: 7279 4669 656c 6473 280a 2020 2020 2020  ryFields(.      
-0001c770: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0001c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c790: 226c 6f67 6963 616c 223a 2022 6162 6322  "logical": "abc"
-0001c7a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c7b0: 2020 2020 2020 2274 7970 6522 3a20 224d        "type": "M
-0001c7c0: 6172 6b73 222c 0a20 2020 2020 2020 2020  arks",.         
-0001c7d0: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-0001c7e0: 656e 7422 3a20 5b22 616e 7922 5d2c 0a20  ent": ["any"],. 
-0001c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c800: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-0001c810: 3d3d 3d22 2c0a 2020 2020 2020 2020 2020  ===",.          
-0001c820: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
-0001c830: 223a 2022 6269 6274 6578 222c 0a20 2020  ": "bibtex",.   
-0001c840: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-0001c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c860: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-0001c870: 2020 2020 2020 2022 6162 6322 2c0a 2020         "abc",.  
-0001c880: 2020 2020 2020 2020 2020 2020 2020 2277                "w
-0001c890: 6865 7265 2022 2c0a 2020 2020 2020 2020  here ",.        
-0001c8a0: 2020 2020 2020 2020 226a 6f69 6e20 222c          "join ",
-0001c8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c8c0: 2028 292c 0a20 2020 2020 2020 2020 2020   (),.           
-0001c8d0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0001c8e0: 2846 616c 7365 2c20 2261 6263 222c 2022  (False, "abc", "
-0001c8f0: 7768 6572 6520 616e 6420 6d61 726b 7320  where and marks 
-0001c900: 213d 203f 2022 2c20 226a 6f69 6e20 222c  != ? ", "join ",
-0001c910: 2028 2222 2c29 292c 0a20 2020 2020 2020   ("",)),.       
-0001c920: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0001c930: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0001c940: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0001c950: 4442 2e62 6962 732e 5f70 726f 6365 7373  DB.bibs._process
-0001c960: 5175 6572 7946 6965 6c64 7328 0a20 2020  QueryFields(.   
-0001c970: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-0001c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c990: 2020 2022 6c6f 6769 6361 6c22 3a20 2261     "logical": "a
-0001c9a0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
-0001c9b0: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-0001c9c0: 2022 4d61 726b 7322 2c0a 2020 2020 2020   "Marks",.      
-0001c9d0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-0001c9e0: 6f6e 7465 6e74 223a 205b 2261 6263 225d  ontent": ["abc"]
-0001c9f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ca00: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
-0001ca10: 3a20 226c 696b 6522 2c0a 2020 2020 2020  : "like",.      
-0001ca20: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0001ca30: 6965 6c64 223a 2022 6269 6274 6578 222c  ield": "bibtex",
-0001ca40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ca50: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0001ca60: 2020 2020 4661 6c73 652c 0a20 2020 2020      False,.     
-0001ca70: 2020 2020 2020 2020 2020 2022 6162 6322             "abc"
-0001ca80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ca90: 2020 2277 6865 7265 2022 2c0a 2020 2020    "where ",.    
-0001caa0: 2020 2020 2020 2020 2020 2020 226a 6f69              "joi
-0001cab0: 6e20 222c 0a20 2020 2020 2020 2020 2020  n ",.           
-0001cac0: 2020 2020 2028 292c 0a20 2020 2020 2020       (),.       
-0001cad0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0001cae0: 2020 2020 2846 616c 7365 2c20 2261 6263      (False, "abc
-0001caf0: 222c 2022 7768 6572 6520 616e 6420 6d61  ", "where and ma
-0001cb00: 726b 7320 6c69 6b65 203f 2022 2c20 226a  rks like ? ", "j
-0001cb10: 6f69 6e20 222c 2028 2225 6162 6325 222c  oin ", ("%abc%",
-0001cb20: 2929 2c0a 2020 2020 2020 2020 290a 2020  )),.        ).  
-0001cb30: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0001cb40: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0001cb50: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-0001cb60: 6273 2e5f 7072 6f63 6573 7351 7565 7279  bs._processQuery
-0001cb70: 4669 656c 6473 280a 2020 2020 2020 2020  Fields(.        
-0001cb80: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-0001cb90: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-0001cba0: 6f67 6963 616c 223a 2022 6162 6322 2c0a  ogical": "abc",.
-0001cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cbc0: 2020 2020 2274 7970 6522 3a20 2254 7970      "type": "Typ
-0001cbd0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001cbe0: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
-0001cbf0: 223a 205b 2261 6263 225d 2c0a 2020 2020  ": ["abc"],.    
-0001cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc10: 226f 7065 7261 746f 7222 3a20 223d 222c  "operator": "=",
-0001cc20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cc30: 2020 2020 2022 6669 656c 6422 3a20 2262       "field": "b
-0001cc40: 6962 7465 7822 2c0a 2020 2020 2020 2020  ibtex",.        
-0001cc50: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0001cc60: 2020 2020 2020 2020 2020 2046 616c 7365             False
-0001cc70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001cc80: 2020 2261 6263 222c 0a20 2020 2020 2020    "abc",.       
-0001cc90: 2020 2020 2020 2020 2022 7768 6572 6520           "where 
-0001cca0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001ccb0: 2020 2022 6a6f 696e 2022 2c0a 2020 2020     "join ",.    
-0001ccc0: 2020 2020 2020 2020 2020 2020 2829 2c0a              (),.
-0001ccd0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001cce0: 2020 2020 2020 2020 2020 2028 4661 6c73             (Fals
-0001ccf0: 652c 2022 6162 6322 2c20 2277 6865 7265  e, "abc", "where
-0001cd00: 2061 6e64 2061 6263 203d 203f 2022 2c20   and abc = ? ", 
-0001cd10: 226a 6f69 6e20 222c 2028 2231 222c 2929  "join ", ("1",))
-0001cd20: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0001cd30: 2020 2020 6669 7273 7454 7970 6520 3d20      firstType = 
-0001cd40: 5472 7565 0a20 2020 2020 2020 2065 7720  True.        ew 
-0001cd50: 3d20 2222 0a20 2020 2020 2020 2065 7620  = "".        ev 
-0001cd60: 3d20 2829 0a20 2020 2020 2020 2066 6f72  = ().        for
-0001cd70: 2066 2069 6e20 7365 6c66 2e70 4244 422e   f in self.pBDB.
-0001cd80: 6269 6273 2e73 6561 7263 6850 6f73 7369  bibs.searchPossi
-0001cd90: 626c 6554 7970 6573 2e6b 6579 7328 293a  bleTypes.keys():
-0001cda0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001cdb0: 6620 213d 2022 6e6f 6e65 223a 0a20 2020  f != "none":.   
-0001cdc0: 2020 2020 2020 2020 2020 2020 2065 7720               ew 
-0001cdd0: 2b3d 2022 2573 2025 7325 7320 2573 203f  += "%s %s%s %s ?
-0001cde0: 2022 2025 2028 0a20 2020 2020 2020 2020   " % (.         
-0001cdf0: 2020 2020 2020 2020 2020 2022 2220 6966             "" if
-0001ce00: 2066 6972 7374 5479 7065 2065 6c73 6520   firstType else 
-0001ce10: 2261 6e64 222c 0a20 2020 2020 2020 2020  "and",.         
-0001ce20: 2020 2020 2020 2020 2020 2022 222c 0a20             "",. 
-0001ce30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ce40: 2020 2066 2c0a 2020 2020 2020 2020 2020     f,.          
-0001ce50: 2020 2020 2020 2020 2020 223d 222c 0a20            "=",. 
-0001ce60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001ce70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ce80: 2065 7620 2b3d 2028 2230 222c 290a 2020   ev += ("0",).  
-0001ce90: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-0001cea0: 7273 7454 7970 6520 3d20 4661 6c73 650a  rstType = False.
-0001ceb0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001cec0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0001ced0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0001cee0: 6269 6273 2e5f 7072 6f63 6573 7351 7565  bibs._processQue
-0001cef0: 7279 4669 656c 6473 280a 2020 2020 2020  ryFields(.      
-0001cf00: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0001cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf20: 226c 6f67 6963 616c 223a 2022 6162 6322  "logical": "abc"
-0001cf30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001cf40: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
-0001cf50: 7970 6522 2c0a 2020 2020 2020 2020 2020  ype",.          
-0001cf60: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-0001cf70: 6e74 223a 205b 226e 6f6e 6522 5d2c 0a20  nt": ["none"],. 
-0001cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf90: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-0001cfa0: 3d22 2c0a 2020 2020 2020 2020 2020 2020  =",.            
-0001cfb0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-0001cfc0: 2022 6269 6274 6578 222c 0a20 2020 2020   "bibtex",.     
-0001cfd0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-0001cfe0: 2020 2020 2020 2020 2020 2020 2020 5472                Tr
-0001cff0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-0001d000: 2020 2020 2261 6263 222c 0a20 2020 2020      "abc",.     
-0001d010: 2020 2020 2020 2020 2020 2022 7768 6572             "wher
-0001d020: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0001d030: 2020 2020 226a 6f69 6e20 222c 0a20 2020      "join ",.   
-0001d040: 2020 2020 2020 2020 2020 2020 2028 292c               (),
-0001d050: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-0001d060: 2020 2020 2020 2020 2020 2020 2846 616c              (Fal
-0001d070: 7365 2c20 2261 6263 222c 2022 7768 6572  se, "abc", "wher
-0001d080: 6522 202b 2065 772c 2022 6a6f 696e 2022  e" + ew, "join "
-0001d090: 2c20 6576 292c 0a20 2020 2020 2020 2029  , ev),.        )
-0001d0a0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0001d0b0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0001d0c0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0001d0d0: 2e62 6962 732e 5f70 726f 6365 7373 5175  .bibs._processQu
-0001d0e0: 6572 7946 6965 6c64 7328 0a20 2020 2020  eryFields(.     
-0001d0f0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-0001d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d110: 2022 6c6f 6769 6361 6c22 3a20 2261 6263   "logical": "abc
-0001d120: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001d130: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
-0001d140: 5479 7065 222c 0a20 2020 2020 2020 2020  Type",.         
-0001d150: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-0001d160: 656e 7422 3a20 5b22 6e6f 6e65 225d 2c0a  ent": ["none"],.
-0001d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d180: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-0001d190: 223d 222c 0a20 2020 2020 2020 2020 2020  "=",.           
-0001d1a0: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-0001d1b0: 3a20 2262 6962 7465 7822 2c0a 2020 2020  : "bibtex",.    
-0001d1c0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-0001d1d0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-0001d1e0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-0001d1f0: 2020 2020 2020 2261 6263 222c 0a20 2020        "abc",.   
-0001d200: 2020 2020 2020 2020 2020 2020 2022 7768               "wh
-0001d210: 6572 6520 736f 6d65 7468 696e 6720 3d20  ere something = 
-0001d220: 3f20 222c 0a20 2020 2020 2020 2020 2020  ? ",.           
-0001d230: 2020 2020 2022 6a6f 696e 2022 2c0a 2020       "join ",.  
-0001d240: 2020 2020 2020 2020 2020 2020 2020 7475                tu
-0001d250: 706c 6528 2261 2229 2c0a 2020 2020 2020  ple("a"),.      
-0001d260: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-0001d270: 2020 2020 2028 4661 6c73 652c 2022 6162       (False, "ab
-0001d280: 6322 2c20 2277 6865 7265 2073 6f6d 6574  c", "where somet
-0001d290: 6869 6e67 203d 203f 2061 6e64 2220 2b20  hing = ? and" + 
-0001d2a0: 6577 2c20 226a 6f69 6e20 222c 2074 7570  ew, "join ", tup
-0001d2b0: 6c65 2822 6122 2920 2b20 6576 292c 0a20  le("a") + ev),. 
-0001d2c0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-0001d2d0: 6620 7465 7374 5f62 6962 7465 7846 726f  f test_bibtexFro
-0001d2e0: 6d44 4228 7365 6c66 2c20 2a61 7267 7329  mDB(self, *args)
-0001d2f0: 3a0a 2020 2020 2020 2020 2222 2274 6573  :.        """tes
-0001d300: 7420 6269 6274 6578 4672 6f6d 4442 2222  t bibtexFromDB""
-0001d310: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-0001d320: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-0001d330: 7042 4442 2e62 6962 732e 6269 6274 6578  pBDB.bibs.bibtex
-0001d340: 4672 6f6d 4442 2822 6162 6322 292c 2022  FromDB("abc"), "
-0001d350: 2229 0a20 2020 2020 2020 2062 6173 6963  ").        basic
-0001d360: 456e 7472 7920 3d20 7b0a 2020 2020 2020  Entry = {.      
-0001d370: 2020 2020 2020 2249 4422 3a20 2274 6573        "ID": "tes
-0001d380: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-0001d390: 2245 4e54 5259 5459 5045 223a 2022 6172  "ENTRYTYPE": "ar
-0001d3a0: 7469 636c 6522 2c0a 2020 2020 2020 2020  ticle",.        
-0001d3b0: 2020 2020 2261 7574 686f 7222 3a20 226d      "author": "m
-0001d3c0: 6520 c3a0 222c 0a20 2020 2020 2020 2020  e ..",.         
-0001d3d0: 2020 2022 7469 746c 6522 3a20 224d 795c     "title": "My\
-0001d3e0: 6e20 7469 746c 6522 2c0a 2020 2020 2020  n title",.      
-0001d3f0: 2020 7d0a 2020 2020 2020 2020 6462 203d    }.        db =
-0001d400: 2062 6962 7465 7870 6172 7365 722e 6269   bibtexparser.bi
-0001d410: 6264 6174 6162 6173 652e 4269 6244 6174  bdatabase.BibDat
-0001d420: 6162 6173 6528 290a 2020 2020 2020 2020  abase().        
-0001d430: 6462 2e65 6e74 7269 6573 203d 205b 6261  db.entries = [ba
-0001d440: 7369 6345 6e74 7279 5d0a 2020 2020 2020  sicEntry].      
-0001d450: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0001d460: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-0001d470: 7365 6c66 2e70 4244 422e 6269 6273 2e62  self.pBDB.bibs.b
-0001d480: 6962 7465 7846 726f 6d44 4228 6462 292c  ibtexFromDB(db),
-0001d490: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001d4a0: 662e 7042 4442 2e62 6962 732e 726d 4269  f.pBDB.bibs.rmBi
-0001d4b0: 6274 6578 436f 6d6d 656e 7473 280a 2020  btexComments(.  
-0001d4c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001d4d0: 6c66 2e70 4244 422e 6269 6273 2e72 6d42  lf.pBDB.bibs.rmB
-0001d4e0: 6962 7465 7841 4361 706f 280a 2020 2020  ibtexACapo(.    
-0001d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d500: 7061 7273 655f 6163 6365 6e74 735f 7374  parse_accents_st
-0001d510: 7228 7062 5772 6974 6572 2e77 7269 7465  r(pbWriter.write
-0001d520: 2864 6229 2e73 7472 6970 2829 290a 2020  (db).strip()).  
-0001d530: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001d540: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001d550: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-0001d560: 6620 7465 7374 5f63 6865 636b 4578 6973  f test_checkExis
-0001d570: 7469 6e67 456e 7472 7928 7365 6c66 2c20  tingEntry(self, 
-0001d580: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
-0001d590: 2222 2274 6573 7420 6368 6563 6b45 7869  """test checkExi
-0001d5a0: 7374 696e 6745 6e74 7279 2222 220a 2020  stingEntry""".  
-0001d5b0: 2020 2020 2020 7365 6c66 2e69 6e73 6572        self.inser
-0001d5c0: 745f 7468 7265 6528 290a 2020 2020 2020  t_three().      
-0001d5d0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0001d5e0: 2e75 7064 6174 6546 6965 6c64 2822 6162  .updateField("ab
-0001d5f0: 6322 2c20 2261 7278 6976 222c 2022 3132  c", "arxiv", "12
-0001d600: 3334 2e35 3637 3822 290a 2020 2020 2020  34.5678").      
-0001d610: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0001d620: 2e75 7064 6174 6546 6965 6c64 2822 6465  .updateField("de
-0001d630: 6622 2c20 2261 7278 6976 222c 2022 3536  f", "arxiv", "56
-0001d640: 3738 2e31 3233 3422 290a 2020 2020 2020  78.1234").      
-0001d650: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0001d660: 2e75 7064 6174 6546 6965 6c64 2822 6768  .updateField("gh
-0001d670: 6922 2c20 2261 7278 6976 222c 2022 2229  i", "arxiv", "")
-0001d680: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-0001d690: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
-0001d6a0: 656c 6428 2261 6263 222c 2022 646f 6922  eld("abc", "doi"
-0001d6b0: 2c20 2231 2f32 2f33 2229 0a20 2020 2020  , "1/2/3").     
-0001d6c0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-0001d6d0: 732e 7570 6461 7465 4669 656c 6428 2264  s.updateField("d
-0001d6e0: 6566 222c 2022 646f 6922 2c20 2222 290a  ef", "doi", "").
-0001d6f0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0001d700: 422e 6269 6273 2e75 7064 6174 6546 6965  B.bibs.updateFie
-0001d710: 6c64 2822 6768 6922 2c20 2264 6f69 222c  ld("ghi", "doi",
-0001d720: 2022 322f 332f 3422 290a 2020 2020 2020   "2/3/4").      
-0001d730: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0001d740: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
-0001d750: 732e 6368 6563 6b45 7869 7374 696e 6745  s.checkExistingE
-0001d760: 6e74 7279 2822 6162 6364 2229 2c20 5b5d  ntry("abcd"), []
-0001d770: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0001d780: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-0001d790: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0001d7a0: 422e 6269 6273 2e63 6865 636b 4578 6973  B.bibs.checkExis
-0001d7b0: 7469 6e67 456e 7472 7928 2261 6263 6422  tingEntry("abcd"
-0001d7c0: 2c20 6172 7869 763d 2231 3233 342e 3433  , arxiv="1234.43
-0001d7d0: 3231 2229 2c20 5b5d 0a20 2020 2020 2020  21"), [].       
-0001d7e0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0001d7f0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-0001d800: 2e70 4244 422e 6269 6273 2e63 6865 636b  .pBDB.bibs.check
-0001d810: 4578 6973 7469 6e67 456e 7472 7928 2261  ExistingEntry("a
-0001d820: 6263 6422 2c20 6172 7869 763d 2231 2f32  bcd", arxiv="1/2
-0001d830: 2f33 2f34 2229 2c20 5b5d 290a 2020 2020  /3/4"), []).    
-0001d840: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001d850: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-0001d860: 2020 5b61 5b22 6269 626b 6579 225d 2066    [a["bibkey"] f
-0001d870: 6f72 2061 2069 6e20 7365 6c66 2e70 4244  or a in self.pBD
-0001d880: 422e 6269 6273 2e63 6865 636b 4578 6973  B.bibs.checkExis
-0001d890: 7469 6e67 456e 7472 7928 2261 6263 2229  tingEntry("abc")
-0001d8a0: 5d2c 205b 2261 6263 225d 0a20 2020 2020  ], ["abc"].     
-0001d8b0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-0001d8c0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-0001d8d0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-0001d8e0: 2020 2020 2020 2020 2020 2020 2061 5b22               a["
-0001d8f0: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
-0001d900: 2020 2020 2020 2020 2066 6f72 2061 2069           for a i
-0001d910: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-0001d920: 2e63 6865 636b 4578 6973 7469 6e67 456e  .checkExistingEn
-0001d930: 7472 7928 2261 6263 6422 2c20 6172 7869  try("abcd", arxi
-0001d940: 763d 2231 3233 342e 3536 3738 2229 0a20  v="1234.5678"). 
-0001d950: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-0001d960: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
-0001d970: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-0001d980: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001d990: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0001d9a0: 2020 205b 615b 2262 6962 6b65 7922 5d20     [a["bibkey"] 
-0001d9b0: 666f 7220 6120 696e 2073 656c 662e 7042  for a in self.pB
-0001d9c0: 4442 2e62 6962 732e 6368 6563 6b45 7869  DB.bibs.checkExi
-0001d9d0: 7374 696e 6745 6e74 7279 2822 3132 3334  stingEntry("1234
-0001d9e0: 2e35 3637 3822 295d 2c0a 2020 2020 2020  .5678")],.      
-0001d9f0: 2020 2020 2020 5b22 6162 6322 5d2c 0a20        ["abc"],. 
-0001da00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001da10: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0001da20: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
-0001da30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001da40: 2061 5b22 6269 626b 6579 225d 0a20 2020   a["bibkey"].   
-0001da50: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0001da60: 2061 2069 6e20 7365 6c66 2e70 4244 422e   a in self.pBDB.
-0001da70: 6269 6273 2e63 6865 636b 4578 6973 7469  bibs.checkExisti
-0001da80: 6e67 456e 7472 7928 2267 6869 222c 2061  ngEntry("ghi", a
-0001da90: 7278 6976 3d22 3536 3738 2e31 3233 3422  rxiv="5678.1234"
-0001daa0: 290a 2020 2020 2020 2020 2020 2020 5d2c  ).            ],
-0001dab0: 0a20 2020 2020 2020 2020 2020 205b 2267  .            ["g
-0001dac0: 6869 222c 2022 6465 6622 5d2c 0a20 2020  hi", "def"],.   
-0001dad0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-0001dae0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0001daf0: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-0001db00: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0001db10: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
-0001db20: 2020 2020 2020 2020 2020 2066 6f72 2061             for a
-0001db30: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-0001db40: 6273 2e63 6865 636b 4578 6973 7469 6e67  bs.checkExisting
-0001db50: 456e 7472 7928 2264 6566 6722 2c20 646f  Entry("defg", do
-0001db60: 693d 2231 2f32 2f33 2229 0a20 2020 2020  i="1/2/3").     
-0001db70: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-0001db80: 2020 2020 2020 5b22 6162 6322 5d2c 0a20        ["abc"],. 
-0001db90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001dba0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0001dbb0: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
-0001dbc0: 615b 2262 6962 6b65 7922 5d20 666f 7220  a["bibkey"] for 
-0001dbd0: 6120 696e 2073 656c 662e 7042 4442 2e62  a in self.pBDB.b
-0001dbe0: 6962 732e 6368 6563 6b45 7869 7374 696e  ibs.checkExistin
-0001dbf0: 6745 6e74 7279 2822 312f 322f 3322 295d  gEntry("1/2/3")]
-0001dc00: 2c20 5b22 6162 6322 5d0a 2020 2020 2020  , ["abc"].      
-0001dc10: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0001dc20: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0001dc30: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-0001dc40: 2020 2020 2020 2020 2020 2020 615b 2262              a["b
-0001dc50: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
-0001dc60: 2020 2020 2020 2020 666f 7220 6120 696e          for a in
-0001dc70: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0001dc80: 6368 6563 6b45 7869 7374 696e 6745 6e74  checkExistingEnt
-0001dc90: 7279 280a 2020 2020 2020 2020 2020 2020  ry(.            
-0001dca0: 2020 2020 2020 2020 2264 6566 222c 2064          "def", d
-0001dcb0: 6f69 3d22 322f 332f 3422 2c20 6172 7869  oi="2/3/4", arxi
-0001dcc0: 763d 2231 3233 342e 3536 3738 220a 2020  v="1234.5678".  
-0001dcd0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001dce0: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-0001dcf0: 2020 2020 2020 2020 2020 205b 2264 6566             ["def
-0001dd00: 222c 2022 6162 6322 2c20 2267 6869 225d  ", "abc", "ghi"]
-0001dd10: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0001dd20: 2064 6566 2074 6573 745f 6368 6563 6b4e   def test_checkN
-0001dd30: 6565 6473 5570 6461 7465 2873 656c 662c  eedsUpdate(self,
-0001dd40: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-0001dd50: 2022 2222 7465 7374 2063 6865 636b 4e65   """test checkNe
-0001dd60: 6564 7355 7064 6174 6522 2222 0a20 2020  edsUpdate""".   
-0001dd70: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-0001dd80: 6962 732e 7275 6e6e 696e 674f 4149 5570  ibs.runningOAIUp
-0001dd90: 6461 7465 7320 3d20 4661 6c73 650a 2020  dates = False.  
-0001dda0: 2020 2020 2020 6520 3d20 7b0a 2020 2020        e = {.    
-0001ddb0: 2020 2020 2020 2020 2270 726f 6365 6564          "proceed
-0001ddc0: 696e 6722 3a20 302c 0a20 2020 2020 2020  ing": 0,.       
-0001ddd0: 2020 2020 2022 626f 6f6b 223a 2030 2c0a       "book": 0,.
-0001dde0: 2020 2020 2020 2020 2020 2020 226c 6563              "lec
-0001ddf0: 7475 7265 223a 2030 2c0a 2020 2020 2020  ture": 0,.      
-0001de00: 2020 2020 2020 2270 6864 5f74 6865 7369        "phd_thesi
-0001de10: 7322 3a20 302c 0a20 2020 2020 2020 2020  s": 0,.         
-0001de20: 2020 2022 6e6f 5570 6461 7465 223a 2030     "noUpdate": 0
-0001de30: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
-0001de40: 6e73 7069 7265 223a 2022 3132 3322 2c0a  nspire": "123",.
-0001de50: 2020 2020 2020 2020 2020 2020 2264 6f69              "doi
-0001de60: 223a 2022 312f 322f 3322 2c0a 2020 2020  ": "1/2/3",.    
-0001de70: 2020 2020 7d0a 2020 2020 2020 2020 7769      }.        wi
-0001de80: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-0001de90: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0001dea0: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
-0001deb0: 6573 2e63 6f6d 706c 6574 6546 6574 6368  es.completeFetch
-0001dec0: 6564 222c 2072 6574 7572 6e5f 7661 6c75  ed", return_valu
-0001ded0: 653d 5b65 5d0a 2020 2020 2020 2020 2920  e=[e].        ) 
-0001dee0: 6173 205f 633a 0a20 2020 2020 2020 2020  as _c:.         
-0001def0: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-0001df00: 6c73 6528 7365 6c66 2e70 4244 422e 6269  lse(self.pBDB.bi
-0001df10: 6273 2e63 6865 636b 4e65 6564 7355 7064  bs.checkNeedsUpd
-0001df20: 6174 6528 6529 290a 2020 2020 2020 2020  ate(e)).        
-0001df30: 2020 2020 5f63 2e61 7373 6572 745f 6361      _c.assert_ca
-0001df40: 6c6c 6564 5f6f 6e63 655f 7769 7468 285b  lled_once_with([
-0001df50: 655d 290a 2020 2020 2020 2020 655b 2262  e]).        e["b
-0001df60: 6962 7465 7844 6963 7422 5d20 3d20 7b22  ibtexDict"] = {"
-0001df70: 6a6f 7572 6e61 6c22 3a20 2261 227d 0a20  journal": "a"}. 
-0001df80: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0001df90: 2e62 6962 732e 7275 6e6e 696e 674f 4149  .bibs.runningOAI
-0001dfa0: 5570 6461 7465 7320 3d20 5472 7565 0a20  Updates = True. 
-0001dfb0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0001dfc0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-0001dfd0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-0001dfe0: 6173 652e 456e 7472 6965 732e 636f 6d70  ase.Entries.comp
-0001dff0: 6c65 7465 4665 7463 6865 6422 2c20 7265  leteFetched", re
-0001e000: 7475 726e 5f76 616c 7565 3d5b 655d 0a20  turn_value=[e]. 
-0001e010: 2020 2020 2020 2029 2061 7320 5f63 3a0a         ) as _c:.
-0001e020: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001e030: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
-0001e040: 662e 7042 4442 2e62 6962 732e 6368 6563  f.pBDB.bibs.chec
-0001e050: 6b4e 6565 6473 5570 6461 7465 2865 2929  kNeedsUpdate(e))
-0001e060: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001e070: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-0001e080: 662e 7042 4442 2e62 6962 732e 6368 6563  f.pBDB.bibs.chec
-0001e090: 6b4e 6565 6473 5570 6461 7465 2865 2c20  kNeedsUpdate(e, 
-0001e0a0: 666f 7263 653d 5472 7565 2929 0a20 2020  force=True)).   
-0001e0b0: 2020 2020 2020 2020 2065 5b22 6269 6274           e["bibt
-0001e0c0: 6578 4469 6374 225d 203d 207b 2261 223a  exDict"] = {"a":
-0001e0d0: 2022 6222 7d0a 2020 2020 2020 2020 2020   "b"}.          
-0001e0e0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-0001e0f0: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
-0001e100: 2e63 6865 636b 4e65 6564 7355 7064 6174  .checkNeedsUpdat
-0001e110: 6528 6529 290a 2020 2020 2020 2020 2020  e(e)).          
-0001e120: 2020 655b 2262 6962 7465 7844 6963 7422    e["bibtexDict"
-0001e130: 5d20 3d20 7b22 6a6f 7572 6e61 6c22 3a20  ] = {"journal": 
-0001e140: 2261 227d 0a20 2020 2020 2020 2020 2020  "a"}.           
-0001e150: 2065 5b22 646f 6922 5d20 3d20 4e6f 6e65   e["doi"] = None
-0001e160: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001e170: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-0001e180: 662e 7042 4442 2e62 6962 732e 6368 6563  f.pBDB.bibs.chec
-0001e190: 6b4e 6565 6473 5570 6461 7465 2865 2929  kNeedsUpdate(e))
-0001e1a0: 0a20 2020 2020 2020 2020 2020 2065 5b22  .            e["
-0001e1b0: 646f 6922 5d20 3d20 2231 2f32 2f33 220a  doi"] = "1/2/3".
-0001e1c0: 2020 2020 2020 2020 2020 2020 655b 2269              e["i
-0001e1d0: 6e73 7069 7265 225d 203d 2022 220a 2020  nspire"] = "".  
-0001e1e0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001e1f0: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
-0001e200: 7042 4442 2e62 6962 732e 6368 6563 6b4e  pBDB.bibs.checkN
-0001e210: 6565 6473 5570 6461 7465 2865 2929 0a20  eedsUpdate(e)). 
-0001e220: 2020 2020 2020 2020 2020 2065 5b22 696e             e["in
-0001e230: 7370 6972 6522 5d20 3d20 4e6f 6e65 0a20  spire"] = None. 
-0001e240: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001e250: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
-0001e260: 2e70 4244 422e 6269 6273 2e63 6865 636b  .pBDB.bibs.check
-0001e270: 4e65 6564 7355 7064 6174 6528 6529 290a  NeedsUpdate(e)).
-0001e280: 2020 2020 2020 2020 2020 2020 655b 2269              e["i
-0001e290: 6e73 7069 7265 225d 203d 2022 3132 3322  nspire"] = "123"
-0001e2a0: 0a20 2020 2020 2020 2020 2020 2065 5b22  .            e["
-0001e2b0: 6e6f 5570 6461 7465 225d 203d 2031 0a20  noUpdate"] = 1. 
-0001e2c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001e2d0: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
-0001e2e0: 2e70 4244 422e 6269 6273 2e63 6865 636b  .pBDB.bibs.check
-0001e2f0: 4e65 6564 7355 7064 6174 6528 6529 290a  NeedsUpdate(e)).
-0001e300: 2020 2020 2020 2020 2020 2020 655b 226e              e["n
-0001e310: 6f55 7064 6174 6522 5d20 3d20 300a 2020  oUpdate"] = 0.  
-0001e320: 2020 2020 2020 2020 2020 655b 2270 6864            e["phd
-0001e330: 5f74 6865 7369 7322 5d20 3d20 310a 2020  _thesis"] = 1.  
-0001e340: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001e350: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
-0001e360: 7042 4442 2e62 6962 732e 6368 6563 6b4e  pBDB.bibs.checkN
-0001e370: 6565 6473 5570 6461 7465 2865 2929 0a20  eedsUpdate(e)). 
-0001e380: 2020 2020 2020 2020 2020 2065 5b22 7068             e["ph
-0001e390: 645f 7468 6573 6973 225d 203d 2030 0a20  d_thesis"] = 0. 
-0001e3a0: 2020 2020 2020 2020 2020 2065 5b22 6c65             e["le
-0001e3b0: 6374 7572 6522 5d20 3d20 310a 2020 2020  cture"] = 1.    
-0001e3c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001e3d0: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
-0001e3e0: 4442 2e62 6962 732e 6368 6563 6b4e 6565  DB.bibs.checkNee
-0001e3f0: 6473 5570 6461 7465 2865 2929 0a20 2020  dsUpdate(e)).   
-0001e400: 2020 2020 2020 2020 2065 5b22 6c65 6374           e["lect
-0001e410: 7572 6522 5d20 3d20 300a 2020 2020 2020  ure"] = 0.      
-0001e420: 2020 2020 2020 655b 2262 6f6f 6b22 5d20        e["book"] 
-0001e430: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-0001e440: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
-0001e450: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-0001e460: 6368 6563 6b4e 6565 6473 5570 6461 7465  checkNeedsUpdate
-0001e470: 2865 2929 0a20 2020 2020 2020 2020 2020  (e)).           
-0001e480: 2065 5b22 626f 6f6b 225d 203d 2030 0a20   e["book"] = 0. 
-0001e490: 2020 2020 2020 2020 2020 2065 5b22 7072             e["pr
-0001e4a0: 6f63 6565 6469 6e67 225d 203d 2031 0a20  oceeding"] = 1. 
-0001e4b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001e4c0: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
-0001e4d0: 2e70 4244 422e 6269 6273 2e63 6865 636b  .pBDB.bibs.check
-0001e4e0: 4e65 6564 7355 7064 6174 6528 6529 290a  NeedsUpdate(e)).
-0001e4f0: 2020 2020 2020 2020 2020 2020 655b 2270              e["p
-0001e500: 726f 6365 6564 696e 6722 5d20 3d20 300a  roceeding"] = 0.
-0001e510: 2020 2020 2020 2020 2020 2020 5f63 2e61              _c.a
-0001e520: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
-0001e530: 2829 0a0a 2020 2020 6465 6620 7465 7374  ()..    def test
-0001e540: 5f63 6974 6174 696f 6e43 6f75 6e74 2873  _citationCount(s
-0001e550: 656c 662c 202a 6172 6773 293a 0a20 2020  elf, *args):.   
-0001e560: 2020 2020 2022 2222 7465 7374 2063 6974       """test cit
-0001e570: 6174 696f 6e43 6f75 6e74 2222 220a 2020  ationCount""".  
-0001e580: 2020 2020 2020 7365 6c66 2e69 6e73 6572        self.inser
-0001e590: 745f 7468 7265 6528 290a 2020 2020 2020  t_three().      
-0001e5a0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0001e5b0: 2e75 7064 6174 6546 6965 6c64 2822 6162  .updateField("ab
-0001e5c0: 6322 2c20 2269 6e73 7069 7265 222c 2022  c", "inspire", "
-0001e5d0: 3132 3334 3522 290a 2020 2020 2020 2020  12345").        
-0001e5e0: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-0001e5f0: 7064 6174 6546 6965 6c64 2822 6465 6622  pdateField("def"
-0001e600: 2c20 2269 6e73 7069 7265 222c 2022 3233  , "inspire", "23
-0001e610: 3435 3622 290a 2020 2020 2020 2020 7365  456").        se
-0001e620: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-0001e630: 6174 6546 6965 6c64 2822 6768 6922 2c20  ateField("ghi", 
-0001e640: 2269 6e73 7069 7265 222c 2022 3334 3536  "inspire", "3456
-0001e650: 3722 290a 2020 2020 2020 2020 7769 7468  7").        with
-0001e660: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-0001e670: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-0001e680: 7765 6269 6d70 6f72 742e 696e 7370 6972  webimport.inspir
-0001e690: 652e 5765 6253 6561 7263 682e 7265 7472  e.WebSearch.retr
-0001e6a0: 6965 7665 4261 7463 6851 7565 7279 222c  ieveBatchQuery",
-0001e6b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001e6c0: 7572 6e5f 7661 6c75 653d 285b 5d2c 2030  urn_value=([], 0
-0001e6d0: 292c 0a20 2020 2020 2020 2029 2061 7320  ),.        ) as 
-0001e6e0: 5f72 623a 0a20 2020 2020 2020 2020 2020  _rb:.           
-0001e6f0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0001e700: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
-0001e710: 2e63 6974 6174 696f 6e43 6f75 6e74 2822  .citationCount("
-0001e720: 3132 3334 3522 292c 2028 302c 2030 2c20  12345"), (0, 0, 
-0001e730: 5b5d 2929 0a20 2020 2020 2020 2020 2020  [])).           
-0001e740: 205f 7262 2e61 7373 6572 745f 6361 6c6c   _rb.assert_call
-0001e750: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
-0001e760: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
-0001e770: 3132 3334 3522 5d2c 0a20 2020 2020 2020  12345"],.       
-0001e780: 2020 2020 2020 2020 2073 6561 7263 6846           searchF
-0001e790: 6f72 6d61 743d 2272 6563 6964 3a25 7322  ormat="recid:%s"
-0001e7a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e7b0: 2020 6669 656c 6473 3d70 6879 7342 6962    fields=physBib
-0001e7c0: 6c69 6f57 6562 2e77 6562 5365 6172 6368  lioWeb.webSearch
-0001e7d0: 5b22 696e 7370 6972 6522 5d2e 6d65 7461  ["inspire"].meta
-0001e7e0: 6461 7461 4369 7461 7469 6f6e 4669 656c  dataCitationFiel
-0001e7f0: 6473 2c0a 2020 2020 2020 2020 2020 2020  ds,.            
-0001e800: 290a 2020 2020 2020 2020 706d 203d 204d  ).        pm = M
-0001e810: 6167 6963 4d6f 636b 2829 0a20 2020 2020  agicMock().     
-0001e820: 2020 2070 7620 3d20 4d61 6769 634d 6f63     pv = MagicMoc
-0001e830: 6b28 290a 2020 2020 2020 2020 7769 7468  k().        with
-0001e840: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-0001e850: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-0001e860: 7765 6269 6d70 6f72 742e 696e 7370 6972  webimport.inspir
-0001e870: 652e 5765 6253 6561 7263 682e 7265 7472  e.WebSearch.retr
-0001e880: 6965 7665 4261 7463 6851 7565 7279 222c  ieveBatchQuery",
-0001e890: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001e8a0: 7572 6e5f 7661 6c75 653d 285b 2261 225d  urn_value=(["a"]
-0001e8b0: 2c20 3229 2c0a 2020 2020 2020 2020 2920  , 2),.        ) 
-0001e8c0: 6173 205f 7262 2c20 7061 7463 6828 0a20  as _rb, patch(. 
-0001e8d0: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
-0001e8e0: 6269 626c 696f 2e77 6562 696d 706f 7274  biblio.webimport
-0001e8f0: 2e69 6e73 7069 7265 2e57 6562 5365 6172  .inspire.WebSear
-0001e900: 6368 2e72 6561 6452 6563 6f72 6422 2c0a  ch.readRecord",.
-0001e910: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001e920: 726e 5f76 616c 7565 3d7b 2269 6422 3a20  rn_value={"id": 
-0001e930: 2231 3233 3435 222c 2022 6369 7422 3a20  "12345", "cit": 
-0001e940: 3132 332c 2022 6369 745f 6e6f 5f73 656c  123, "cit_no_sel
-0001e950: 6622 3a20 3132 307d 2c0a 2020 2020 2020  f": 120},.      
-0001e960: 2020 2920 6173 205f 7272 3a0a 2020 2020    ) as _rr:.    
-0001e970: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001e980: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0001e990: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0001e9a0: 4244 422e 6269 6273 2e63 6974 6174 696f  BDB.bibs.citatio
-0001e9b0: 6e43 6f75 6e74 285b 2231 3233 3435 222c  nCount(["12345",
-0001e9c0: 2022 3233 3435 3622 5d2c 2070 624d 6178   "23456"], pbMax
-0001e9d0: 3d70 6d2c 2070 6256 616c 3d70 7629 2c0a  =pm, pbVal=pv),.
-0001e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e9f0: 2831 2c20 302c 205b 2261 6263 225d 292c  (1, 0, ["abc"]),
-0001ea00: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001ea10: 2020 2020 2020 2020 2020 205f 7262 2e61             _rb.a
-0001ea20: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-0001ea30: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
-0001ea40: 2020 2020 2020 2020 5b22 3132 3334 3522          ["12345"
-0001ea50: 2c20 2232 3334 3536 225d 2c0a 2020 2020  , "23456"],.    
-0001ea60: 2020 2020 2020 2020 2020 2020 7365 6172              sear
-0001ea70: 6368 466f 726d 6174 3d22 7265 6369 643a  chFormat="recid:
-0001ea80: 2573 222c 0a20 2020 2020 2020 2020 2020  %s",.           
-0001ea90: 2020 2020 2066 6965 6c64 733d 7068 7973       fields=phys
-0001eaa0: 4269 626c 696f 5765 622e 7765 6253 6561  BiblioWeb.webSea
-0001eab0: 7263 685b 2269 6e73 7069 7265 225d 2e6d  rch["inspire"].m
-0001eac0: 6574 6164 6174 6143 6974 6174 696f 6e46  etadataCitationF
-0001ead0: 6965 6c64 732c 0a20 2020 2020 2020 2020  ields,.         
-0001eae0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001eaf0: 205f 7272 2e61 7373 6572 745f 6361 6c6c   _rr.assert_call
-0001eb00: 6564 5f6f 6e63 655f 7769 7468 2822 6122  ed_once_with("a"
-0001eb10: 2c20 6e6f 5761 726e 696e 673d 5472 7565  , noWarning=True
-0001eb20: 290a 2020 2020 2020 2020 2020 2020 706d  ).            pm
-0001eb30: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-0001eb40: 6e63 655f 7769 7468 2832 290a 2020 2020  nce_with(2).    
-0001eb50: 2020 2020 2020 2020 7076 2e61 7373 6572          pv.asser
-0001eb60: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-0001eb70: 7468 2831 290a 2020 2020 2020 2020 2020  th(1).          
-0001eb80: 2020 6120 3d20 7365 6c66 2e70 4244 422e    a = self.pBDB.
-0001eb90: 6269 6273 2e67 6574 4279 4269 626b 6579  bibs.getByBibkey
-0001eba0: 2822 6162 6322 295b 305d 0a20 2020 2020  ("abc")[0].     
-0001ebb0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001ebc0: 7274 4571 7561 6c28 615b 2263 6974 6174  rtEqual(a["citat
-0001ebd0: 696f 6e73 225d 2c20 3132 3329 0a20 2020  ions"], 123).   
-0001ebe0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001ebf0: 7365 7274 4571 7561 6c28 615b 2263 6974  sertEqual(a["cit
-0001ec00: 6174 696f 6e73 5f6e 6f5f 7365 6c66 225d  ations_no_self"]
-0001ec10: 2c20 3132 3029 0a20 2020 2020 2020 2020  , 120).         
-0001ec20: 2020 2061 203d 2073 656c 662e 7042 4442     a = self.pBDB
-0001ec30: 2e62 6962 732e 6765 7442 7942 6962 6b65  .bibs.getByBibke
-0001ec40: 7928 2264 6566 2229 5b30 5d0a 2020 2020  y("def")[0].    
-0001ec50: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001ec60: 6572 7445 7175 616c 2861 5b22 6369 7461  ertEqual(a["cita
-0001ec70: 7469 6f6e 7322 5d2c 2030 290a 2020 2020  tions"], 0).    
-0001ec80: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001ec90: 6572 7445 7175 616c 2861 5b22 6369 7461  ertEqual(a["cita
-0001eca0: 7469 6f6e 735f 6e6f 5f73 656c 6622 5d2c  tions_no_self"],
-0001ecb0: 2030 290a 2020 2020 2020 2020 7769 7468   0).        with
-0001ecc0: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-0001ecd0: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-0001ece0: 7765 6269 6d70 6f72 742e 696e 7370 6972  webimport.inspir
-0001ecf0: 652e 5765 6253 6561 7263 682e 7265 7472  e.WebSearch.retr
-0001ed00: 6965 7665 4261 7463 6851 7565 7279 222c  ieveBatchQuery",
-0001ed10: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001ed20: 7572 6e5f 7661 6c75 653d 285b 2261 222c  urn_value=(["a",
-0001ed30: 2022 6222 2c20 2263 225d 2c20 3229 2c0a   "b", "c"], 2),.
-0001ed40: 2020 2020 2020 2020 2920 6173 205f 7262          ) as _rb
-0001ed50: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-0001ed60: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-0001ed70: 2e77 6562 696d 706f 7274 2e69 6e73 7069  .webimport.inspi
-0001ed80: 7265 2e57 6562 5365 6172 6368 2e72 6561  re.WebSearch.rea
-0001ed90: 6452 6563 6f72 6422 2c0a 2020 2020 2020  dRecord",.      
-0001eda0: 2020 2020 2020 7369 6465 5f65 6666 6563        side_effec
-0001edb0: 743d 280a 2020 2020 2020 2020 2020 2020  t=(.            
-0001edc0: 2020 2020 7b22 6964 223a 2022 3334 3536      {"id": "3456
-0001edd0: 3722 2c20 2263 6974 223a 2031 2c20 2263  7", "cit": 1, "c
-0001ede0: 6974 5f6e 6f5f 7365 6c66 223a 2031 7d2c  it_no_self": 1},
-0001edf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ee00: 207b 2269 6422 3a20 2230 3132 3334 222c   {"id": "01234",
-0001ee10: 2022 6369 7422 3a20 3133 2c20 2263 6974   "cit": 13, "cit
-0001ee20: 5f6e 6f5f 7365 6c66 223a 2031 7d2c 0a20  _no_self": 1},. 
-0001ee30: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0001ee40: 2269 6422 3a20 2232 3334 3536 227d 2c0a  "id": "23456"},.
-0001ee50: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0001ee60: 2020 2020 2020 2029 2061 7320 5f72 723a         ) as _rr:
-0001ee70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001ee80: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-0001ee90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001eea0: 656c 662e 7042 4442 2e62 6962 732e 6369  elf.pBDB.bibs.ci
-0001eeb0: 7461 7469 6f6e 436f 756e 7428 5b22 3132  tationCount(["12
-0001eec0: 3334 3522 2c20 2232 3334 3536 225d 2c20  345", "23456"], 
-0001eed0: 7062 4d61 783d 706d 2c20 7062 5661 6c3d  pbMax=pm, pbVal=
-0001eee0: 7076 292c 0a20 2020 2020 2020 2020 2020  pv),.           
-0001eef0: 2020 2020 2028 332c 2031 2c20 5b22 6768       (3, 1, ["gh
-0001ef00: 6922 5d29 2c0a 2020 2020 2020 2020 2020  i"]),.          
-0001ef10: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001ef20: 5f72 622e 6173 7365 7274 5f63 616c 6c65  _rb.assert_calle
-0001ef30: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
-0001ef40: 2020 2020 2020 2020 2020 2020 205b 2231               ["1
-0001ef50: 3233 3435 222c 2022 3233 3435 3622 5d2c  2345", "23456"],
-0001ef60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ef70: 2073 6561 7263 6846 6f72 6d61 743d 2272   searchFormat="r
-0001ef80: 6563 6964 3a25 7322 2c0a 2020 2020 2020  ecid:%s",.      
-0001ef90: 2020 2020 2020 2020 2020 6669 656c 6473            fields
-0001efa0: 3d70 6879 7342 6962 6c69 6f57 6562 2e77  =physBiblioWeb.w
-0001efb0: 6562 5365 6172 6368 5b22 696e 7370 6972  ebSearch["inspir
-0001efc0: 6522 5d2e 6d65 7461 6461 7461 4369 7461  e"].metadataCita
-0001efd0: 7469 6f6e 4669 656c 6473 2c0a 2020 2020  tionFields,.    
-0001efe0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001eff0: 2020 2020 2020 5f72 722e 6173 7365 7274        _rr.assert
-0001f000: 5f61 6e79 5f63 616c 6c28 2261 222c 206e  _any_call("a", n
-0001f010: 6f57 6172 6e69 6e67 3d54 7275 6529 0a20  oWarning=True). 
-0001f020: 2020 2020 2020 2020 2020 205f 7272 2e61             _rr.a
-0001f030: 7373 6572 745f 616e 795f 6361 6c6c 2822  ssert_any_call("
-0001f040: 6222 2c20 6e6f 5761 726e 696e 673d 5472  b", noWarning=Tr
-0001f050: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-0001f060: 5f72 722e 6173 7365 7274 5f61 6e79 5f63  _rr.assert_any_c
-0001f070: 616c 6c28 2263 222c 206e 6f57 6172 6e69  all("c", noWarni
-0001f080: 6e67 3d54 7275 6529 0a20 2020 2020 2020  ng=True).       
-0001f090: 2020 2020 2061 203d 2073 656c 662e 7042       a = self.pB
-0001f0a0: 4442 2e62 6962 732e 6765 7442 7942 6962  DB.bibs.getByBib
-0001f0b0: 6b65 7928 2261 6263 2229 5b30 5d0a 2020  key("abc")[0].  
-0001f0c0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001f0d0: 7373 6572 7445 7175 616c 2861 5b22 6369  ssertEqual(a["ci
-0001f0e0: 7461 7469 6f6e 7322 5d2c 2031 3233 290a  tations"], 123).
-0001f0f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001f100: 2e61 7373 6572 7445 7175 616c 2861 5b22  .assertEqual(a["
-0001f110: 6369 7461 7469 6f6e 735f 6e6f 5f73 656c  citations_no_sel
-0001f120: 6622 5d2c 2031 3230 290a 2020 2020 2020  f"], 120).      
-0001f130: 2020 2020 2020 6120 3d20 7365 6c66 2e70        a = self.p
-0001f140: 4244 422e 6269 6273 2e67 6574 4279 4269  BDB.bibs.getByBi
-0001f150: 626b 6579 2822 6465 6622 295b 305d 0a20  bkey("def")[0]. 
-0001f160: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001f170: 6173 7365 7274 4571 7561 6c28 615b 2263  assertEqual(a["c
-0001f180: 6974 6174 696f 6e73 225d 2c20 3029 0a20  itations"], 0). 
-0001f190: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001f1a0: 6173 7365 7274 4571 7561 6c28 615b 2263  assertEqual(a["c
-0001f1b0: 6974 6174 696f 6e73 5f6e 6f5f 7365 6c66  itations_no_self
-0001f1c0: 225d 2c20 3029 0a20 2020 2020 2020 2020  "], 0).         
-0001f1d0: 2020 2061 203d 2073 656c 662e 7042 4442     a = self.pBDB
-0001f1e0: 2e62 6962 732e 6765 7442 7942 6962 6b65  .bibs.getByBibke
-0001f1f0: 7928 2267 6869 2229 5b30 5d0a 2020 2020  y("ghi")[0].    
-0001f200: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001f210: 6572 7445 7175 616c 2861 5b22 6369 7461  ertEqual(a["cita
-0001f220: 7469 6f6e 7322 5d2c 2031 290a 2020 2020  tions"], 1).    
-0001f230: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001f240: 6572 7445 7175 616c 2861 5b22 6369 7461  ertEqual(a["cita
-0001f250: 7469 6f6e 735f 6e6f 5f73 656c 6622 5d2c  tions_no_self"],
-0001f260: 2031 290a 0a20 2020 2064 6566 2074 6573   1)..    def tes
-0001f270: 745f 636c 6561 6e42 6962 7465 7828 7365  t_cleanBibtex(se
-0001f280: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
-0001f290: 2020 2020 2222 2274 6573 7420 636c 6561      """test clea
-0001f2a0: 6e42 6962 7465 7822 2222 0a20 2020 2020  nBibtex""".     
-0001f2b0: 2020 2064 6220 3d20 6269 6274 6578 7061     db = bibtexpa
-0001f2c0: 7273 6572 2e62 6962 6461 7461 6261 7365  rser.bibdatabase
-0001f2d0: 2e42 6962 4461 7461 6261 7365 2829 0a20  .BibDatabase(). 
-0001f2e0: 2020 2020 2020 2062 203d 2027 4061 7274         b = '@art
-0001f2f0: 6963 6c65 7b61 6263 2c5c 6e61 7574 686f  icle{abc,\nautho
-0001f300: 723d 226d 6522 2c5c 6e74 6974 6c65 3d22  r="me",\ntitle="
-0001f310: 7469 746c 6522 2c5c 6e7d 5c6e 270a 2020  title",\n}\n'.  
-0001f320: 2020 2020 2020 6462 2e65 6e74 7269 6573        db.entries
-0001f330: 203d 205b 7365 6c66 2e70 4244 422e 6269   = [self.pBDB.bi
-0001f340: 6273 2e72 6561 6445 6e74 7279 2862 295d  bs.readEntry(b)]
-0001f350: 0a20 2020 2020 2020 206e 203d 2073 656c  .        n = sel
-0001f360: 662e 7042 4442 2e62 6962 732e 6269 6274  f.pBDB.bibs.bibt
-0001f370: 6578 4672 6f6d 4442 2864 6229 0a20 2020  exFromDB(db).   
-0001f380: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0001f390: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-0001f3a0: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-0001f3b0: 652e 456e 7472 6965 732e 7570 6461 7465  e.Entries.update
-0001f3c0: 4669 656c 6422 2c20 7369 6465 5f65 6666  Field", side_eff
-0001f3d0: 6563 743d 5b46 616c 7365 2c20 5472 7565  ect=[False, True
-0001f3e0: 5d0a 2020 2020 2020 2020 2920 6173 205f  ].        ) as _
-0001f3f0: 752c 2070 6174 6368 280a 2020 2020 2020  u, patch(.      
-0001f400: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0001f410: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
-0001f420: 6573 2e62 6962 7465 7846 726f 6d44 4222  es.bibtexFromDB"
-0001f430: 2c20 7369 6465 5f65 6666 6563 743d 5b62  , side_effect=[b
-0001f440: 2c20 6e2c 206e 5d0a 2020 2020 2020 2020  , n, n].        
-0001f450: 2920 6173 205f 623a 0a20 2020 2020 2020  ) as _b:.       
-0001f460: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001f470: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
-0001f480: 6269 6273 2e63 6c65 616e 4269 6274 6578  bibs.cleanBibtex
-0001f490: 2822 6162 6322 2c20 622c 2064 623d 6462  ("abc", b, db=db
-0001f4a0: 2929 0a20 2020 2020 2020 2020 2020 205f  )).            _
-0001f4b0: 622e 6173 7365 7274 5f63 616c 6c65 645f  b.assert_called_
-0001f4c0: 6f6e 6365 5f77 6974 6828 6462 290a 2020  once_with(db).  
-0001f4d0: 2020 2020 2020 2020 2020 5f75 2e61 7373            _u.ass
-0001f4e0: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-0001f4f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001f500: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
-0001f510: 6c66 2e70 4244 422e 6269 6273 2e63 6c65  lf.pBDB.bibs.cle
-0001f520: 616e 4269 6274 6578 2822 6162 6322 2c20  anBibtex("abc", 
-0001f530: 622c 2064 623d 6462 2929 0a20 2020 2020  b, db=db)).     
-0001f540: 2020 2020 2020 205f 752e 6173 7365 7274         _u.assert
-0001f550: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-0001f560: 6828 2261 6263 222c 2022 6269 6274 6578  h("abc", "bibtex
-0001f570: 222c 206e 290a 2020 2020 2020 2020 2020  ", n).          
-0001f580: 2020 5f75 2e72 6573 6574 5f6d 6f63 6b28    _u.reset_mock(
-0001f590: 290a 2020 2020 2020 2020 2020 2020 5f62  ).            _b
-0001f5a0: 2e72 6573 6574 5f6d 6f63 6b28 290a 2020  .reset_mock().  
-0001f5b0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001f5c0: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-0001f5d0: 4244 422e 6269 6273 2e63 6c65 616e 4269  BDB.bibs.cleanBi
-0001f5e0: 6274 6578 2822 6162 6322 2c20 6229 290a  btex("abc", b)).
-0001f5f0: 2020 2020 2020 2020 2020 2020 5f75 2e61              _u.a
-0001f600: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-0001f610: 655f 7769 7468 2822 6162 6322 2c20 2262  e_with("abc", "b
-0001f620: 6962 7465 7822 2c20 6e29 0a20 2020 2020  ibtex", n).     
-0001f630: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
-0001f640: 2e61 7373 6572 7452 6169 7365 7328 4173  .assertRaises(As
-0001f650: 7365 7274 696f 6e45 7272 6f72 293a 0a20  sertionError):. 
-0001f660: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-0001f670: 622e 6173 7365 7274 5f63 616c 6c65 645f  b.assert_called_
-0001f680: 6f6e 6365 5f77 6974 6828 6462 290a 0a20  once_with(db).. 
-0001f690: 2020 2064 6566 2074 6573 745f 636c 6561     def test_clea
-0001f6a0: 6e42 6962 7465 7873 2873 656c 662c 202a  nBibtexs(self, *
-0001f6b0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-0001f6c0: 2222 7465 7374 2063 6c65 616e 4269 6274  ""test cleanBibt
-0001f6d0: 6578 7322 2222 0a20 2020 2020 2020 2073  exs""".        s
-0001f6e0: 656c 662e 696e 7365 7274 5f74 6872 6565  elf.insert_three
-0001f6f0: 2829 0a20 2020 2020 2020 2062 6962 7465  ().        bibte
-0001f700: 7849 6e20 3d20 280a 2020 2020 2020 2020  xIn = (.        
-0001f710: 2020 2020 2725 636f 6d6d 656e 745c 6e40      '%comment\n@
-0001f720: 6172 7469 636c 657b 6162 632c 5c6e 5c6e  article{abc,\n\n
-0001f730: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
-0001f740: 270a 2020 2020 2020 2020 2020 2020 2b20  '.            + 
-0001f750: 2774 6974 6c65 203d 2022 6162 5c6e 6322  'title = "ab\nc"
-0001f760: 2c5c 6e6a 6f75 726e 616c 3d22 6a63 6170  ,\njournal="jcap
-0001f770: 222c 5c6e 766f 6c75 6d65 3d22 3138 3033  ",\nvolume="1803
-0001f780: 222c 5c6e 270a 2020 2020 2020 2020 2020  ",\n'.          
-0001f790: 2020 2b20 2779 6561 723d 2232 3031 3822    + 'year="2018"
-0001f7a0: 2c5c 6e70 6167 6573 3d22 3122 2c5c 6e61  ,\npages="1",\na
-0001f7b0: 7278 6976 3d22 3132 3334 2e35 3637 3839  rxiv="1234.56789
-0001f7c0: 222c 5c6e 7d27 0a20 2020 2020 2020 2029  ",\n}'.        )
-0001f7d0: 0a20 2020 2020 2020 2062 6962 7465 784f  .        bibtexO
-0001f7e0: 7574 203d 2028 0a20 2020 2020 2020 2020  ut = (.         
-0001f7f0: 2020 2027 4041 7274 6963 6c65 7b61 6263     '@Article{abc
-0001f800: 2c5c 6e20 2020 2020 2020 2061 7574 686f  ,\n        autho
-0001f810: 7220 3d20 226d 6522 2c5c 6e20 2020 2020  r = "me",\n     
-0001f820: 2020 2020 270a 2020 2020 2020 2020 2020      '.          
-0001f830: 2020 2b20 2774 6974 6c65 203d 2022 7b61    + 'title = "{a
-0001f840: 6220 637d 222c 5c6e 2020 2020 2020 206a  b c}",\n       j
-0001f850: 6f75 726e 616c 203d 2022 6a63 6170 222c  ournal = "jcap",
-0001f860: 5c6e 2020 2020 2020 2020 270a 2020 2020  \n        '.    
-0001f870: 2020 2020 2020 2020 2b20 2776 6f6c 756d          + 'volum
-0001f880: 6520 3d20 2231 3830 3322 2c5c 6e20 2020  e = "1803",\n   
-0001f890: 2020 2020 2020 2079 6561 7220 3d20 2232         year = "2
-0001f8a0: 3031 3822 2c5c 6e20 2020 2020 2020 2020  018",\n         
-0001f8b0: 270a 2020 2020 2020 2020 2020 2020 2b20  '.            + 
-0001f8c0: 2770 6167 6573 203d 2022 3122 2c5c 6e20  'pages = "1",\n 
-0001f8d0: 2020 2020 2020 2020 6172 7869 7620 3d20          arxiv = 
-0001f8e0: 2231 3233 342e 3536 3738 3922 2c5c 6e7d  "1234.56789",\n}
-0001f8f0: 270a 2020 2020 2020 2020 290a 2020 2020  '.        ).    
-0001f900: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-0001f910: 6273 2e75 7064 6174 6546 6965 6c64 2822  bs.updateField("
-0001f920: 6162 6322 2c20 2262 6962 7465 7822 2c20  abc", "bibtex", 
-0001f930: 6269 6274 6578 496e 290a 2020 2020 2020  bibtexIn).      
-0001f940: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
-0001f950: 6767 696e 672e 4c6f 6767 6572 2e69 6e66  gging.Logger.inf
-0001f960: 6f22 2920 6173 205f 693a 0a20 2020 2020  o") as _i:.     
-0001f970: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0001f980: 2e62 6962 732e 636c 6561 6e42 6962 7465  .bibs.cleanBibte
-0001f990: 7873 2873 7461 7274 4672 6f6d 3d31 290a  xs(startFrom=1).
-0001f9a0: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
-0001f9b0: 7373 6572 745f 616e 795f 6361 6c6c 2822  ssert_any_call("
-0001f9c0: 436c 6561 6e42 6962 7465 7873 2077 696c  CleanBibtexs wil
-0001f9d0: 6c20 7072 6f63 6573 7320 3220 746f 7461  l process 2 tota
-0001f9e0: 6c20 656e 7472 6965 7322 290a 2020 2020  l entries").    
-0001f9f0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001fa00: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
-0001fa10: 6962 732e 6765 7446 6965 6c64 2822 6162  ibs.getField("ab
-0001fa20: 6322 2c20 2262 6962 7465 7822 292c 2062  c", "bibtex"), b
-0001fa30: 6962 7465 7849 6e29 0a20 2020 2020 2020  ibtexIn).       
-0001fa40: 2070 626d 203d 204d 6167 6963 4d6f 636b   pbm = MagicMock
-0001fa50: 2829 0a20 2020 2020 2020 2070 6276 203d  ().        pbv =
-0001fa60: 204d 6167 6963 4d6f 636b 2829 0a20 2020   MagicMock().   
-0001fa70: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0001fa80: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-0001fa90: 696e 666f 2229 2061 7320 5f69 3a0a 2020  info") as _i:.  
-0001faa0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0001fab0: 4244 422e 6269 6273 2e63 6c65 616e 4269  BDB.bibs.cleanBi
-0001fac0: 6274 6578 7328 0a20 2020 2020 2020 2020  btexs(.         
-0001fad0: 2020 2020 2020 2065 6e74 7269 6573 3d73         entries=s
-0001fae0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0001faf0: 7442 7942 6962 6b65 7928 2264 6566 2229  tByBibkey("def")
-0001fb00: 2c20 7062 4d61 783d 7062 6d2c 2070 6256  , pbMax=pbm, pbV
-0001fb10: 616c 3d70 6276 0a20 2020 2020 2020 2020  al=pbv.         
-0001fb20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001fb30: 205f 692e 6173 7365 7274 5f61 6e79 5f63   _i.assert_any_c
-0001fb40: 616c 6c28 2243 6c65 616e 4269 6274 6578  all("CleanBibtex
-0001fb50: 7320 7769 6c6c 2070 726f 6365 7373 2031  s will process 1
-0001fb60: 2074 6f74 616c 2065 6e74 7269 6573 2229   total entries")
-0001fb70: 0a20 2020 2020 2020 2070 626d 2e61 7373  .        pbm.ass
-0001fb80: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-0001fb90: 7769 7468 2831 290a 2020 2020 2020 2020  with(1).        
-0001fba0: 7062 762e 6173 7365 7274 5f68 6173 5f63  pbv.assert_has_c
-0001fbb0: 616c 6c73 285b 6361 6c6c 2831 295d 290a  alls([call(1)]).
-0001fbc0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001fbd0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-0001fbe0: 4442 2e62 6962 732e 6765 7446 6965 6c64  DB.bibs.getField
-0001fbf0: 2822 6162 6322 2c20 2262 6962 7465 7822  ("abc", "bibtex"
-0001fc00: 292c 2062 6962 7465 7849 6e29 0a20 2020  ), bibtexIn).   
-0001fc10: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0001fc20: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-0001fc30: 6578 6365 7074 696f 6e22 2920 6173 205f  exception") as _
-0001fc40: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0001fc50: 656c 662e 7042 4442 2e62 6962 732e 636c  elf.pBDB.bibs.cl
-0001fc60: 6561 6e42 6962 7465 7873 2873 7461 7274  eanBibtexs(start
-0001fc70: 4672 6f6d 3d22 6122 292c 0a20 2020 2020  From="a"),.     
-0001fc80: 2020 2020 2020 205f 652e 6173 7365 7274         _e.assert
-0001fc90: 5f61 6e79 5f63 616c 6c28 2249 6e76 616c  _any_call("Inval
-0001fca0: 6964 2073 7461 7274 4672 6f6d 2069 6e20  id startFrom in 
-0001fcb0: 636c 6561 6e42 6962 7465 7873 2229 0a20  cleanBibtexs"). 
-0001fcc0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001fcd0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-0001fce0: 422e 6269 6273 2e63 6c65 616e 4269 6274  B.bibs.cleanBibt
-0001fcf0: 6578 7328 7374 6172 7446 726f 6d3d 3529  exs(startFrom=5)
-0001fd00: 2c20 2830 2c20 302c 205b 5d29 290a 0a20  , (0, 0, [])).. 
-0001fd10: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0001fd20: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
-0001fd30: 722e 696e 666f 2229 2061 7320 5f69 3a0a  r.info") as _i:.
-0001fd40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001fd50: 2e70 4244 422e 6269 6273 2e63 6c65 616e  .pBDB.bibs.clean
-0001fd60: 4269 6274 6578 7328 290a 2020 2020 2020  Bibtexs().      
-0001fd70: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
-0001fd80: 616e 795f 6361 6c6c 2822 436c 6561 6e42  any_call("CleanB
-0001fd90: 6962 7465 7873 2077 696c 6c20 7072 6f63  ibtexs will proc
-0001fda0: 6573 7320 3320 746f 7461 6c20 656e 7472  ess 3 total entr
-0001fdb0: 6965 7322 290a 2020 2020 2020 2020 7365  ies").        se
-0001fdc0: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-0001fdd0: 6174 6546 6965 6c64 2822 6162 6322 2c20  ateField("abc", 
-0001fde0: 2262 6962 7465 7822 2c20 6269 6274 6578  "bibtex", bibtex
-0001fdf0: 496e 290a 2020 2020 2020 2020 7365 6c66  In).        self
-0001fe00: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-0001fe10: 662e 7042 4442 2e62 6962 732e 636c 6561  f.pBDB.bibs.clea
-0001fe20: 6e42 6962 7465 7873 2829 2c20 2833 2c20  nBibtexs(), (3, 
-0001fe30: 302c 205b 2261 6263 225d 2929 0a20 2020  0, ["abc"])).   
-0001fe40: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-0001fe50: 6962 732e 7570 6461 7465 4669 656c 6428  ibs.updateField(
-0001fe60: 2261 6263 222c 2022 6269 6274 6578 222c  "abc", "bibtex",
-0001fe70: 2062 6962 7465 7849 6e29 0a20 2020 2020   bibtexIn).     
-0001fe80: 2020 2070 626d 203d 204d 6167 6963 4d6f     pbm = MagicMo
-0001fe90: 636b 2829 0a20 2020 2020 2020 2070 6276  ck().        pbv
-0001fea0: 203d 204d 6167 6963 4d6f 636b 2829 0a20   = MagicMock(). 
-0001feb0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0001fec0: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
-0001fed0: 722e 696e 666f 2229 2061 7320 5f69 3a0a  r.info") as _i:.
-0001fee0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001fef0: 2e70 4244 422e 6269 6273 2e63 6c65 616e  .pBDB.bibs.clean
-0001ff00: 4269 6274 6578 7328 7062 4d61 783d 7062  Bibtexs(pbMax=pb
-0001ff10: 6d2c 2070 6256 616c 3d70 6276 290a 2020  m, pbVal=pbv).  
-0001ff20: 2020 2020 2020 2020 2020 5f69 2e61 7373            _i.ass
-0001ff30: 6572 745f 6861 735f 6361 6c6c 7328 0a20  ert_has_calls(. 
-0001ff40: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0001ff50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ff60: 2020 2020 2063 616c 6c28 2233 2065 6e74       call("3 ent
-0001ff70: 7269 6573 2070 726f 6365 7373 6564 2229  ries processed")
-0001ff80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ff90: 2020 2020 2020 6361 6c6c 2822 3020 6572        call("0 er
-0001ffa0: 726f 7273 206f 6363 7572 7265 6422 292c  rors occurred"),
-0001ffb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ffc0: 2020 2020 2063 616c 6c28 2231 2062 6962       call("1 bib
-0001ffd0: 7465 7820 656e 7472 6965 7320 6368 616e  tex entries chan
-0001ffe0: 6765 6422 292c 0a20 2020 2020 2020 2020  ged"),.         
-0001fff0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00020000: 2020 2020 2029 0a20 2020 2020 2020 2070       ).        p
-00020010: 626d 2e61 7373 6572 745f 6361 6c6c 6564  bm.assert_called
-00020020: 5f6f 6e63 655f 7769 7468 2833 290a 2020  _once_with(3).  
-00020030: 2020 2020 2020 7062 762e 6173 7365 7274        pbv.assert
-00020040: 5f68 6173 5f63 616c 6c73 285b 6361 6c6c  _has_calls([call
-00020050: 2831 292c 2063 616c 6c28 3229 2c20 6361  (1), call(2), ca
-00020060: 6c6c 2833 295d 290a 2020 2020 2020 2020  ll(3)]).        
-00020070: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00020080: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-00020090: 6765 7446 6965 6c64 2822 6162 6322 2c20  getField("abc", 
-000200a0: 2262 6962 7465 7822 292c 2062 6962 7465  "bibtex"), bibte
-000200b0: 784f 7574 290a 0a20 2020 2020 2020 2073  xOut)..        s
-000200c0: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
-000200d0: 6461 7465 4669 656c 6428 2264 6566 222c  dateField("def",
-000200e0: 2022 6269 6274 6578 222c 2027 4062 6f6f   "bibtex", '@boo
-000200f0: 6b7b 6465 662c 5c6e 7469 746c 653d 2273  k{def,\ntitle="s
-00020100: 6f6d 6522 2c27 290a 2020 2020 2020 2020  ome",').        
-00020110: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
-00020120: 696e 672e 4c6f 6767 6572 2e77 6172 6e69  ing.Logger.warni
-00020130: 6e67 2229 2061 7320 5f69 3a0a 2020 2020  ng") as _i:.    
-00020140: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00020150: 422e 6269 6273 2e63 6c65 616e 4269 6274  B.bibs.cleanBibt
-00020160: 6578 7328 290a 2020 2020 2020 2020 2020  exs().          
-00020170: 2020 5f69 2e61 7373 6572 745f 616e 795f    _i.assert_any_
-00020180: 6361 6c6c 2822 4572 726f 7220 7768 696c  call("Error whil
-00020190: 6520 636c 6561 6e69 6e67 2065 6e74 7279  e cleaning entry
-000201a0: 2027 6465 6627 222c 2065 7863 5f69 6e66   'def'", exc_inf
-000201b0: 6f3d 5472 7565 290a 2020 2020 2020 2020  o=True).        
-000201c0: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
-000201d0: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
-000201e0: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
-000201f0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00020200: 6962 732e 636c 6561 6e42 6962 7465 7873  ibs.cleanBibtexs
-00020210: 2829 0a20 2020 2020 2020 2020 2020 205f  ().            _
-00020220: 692e 6173 7365 7274 5f68 6173 5f63 616c  i.assert_has_cal
-00020230: 6c73 280a 2020 2020 2020 2020 2020 2020  ls(.            
-00020240: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00020250: 2020 2020 2020 2020 2020 6361 6c6c 2822            call("
-00020260: 3320 656e 7472 6965 7320 7072 6f63 6573  3 entries proces
-00020270: 7365 6422 292c 0a20 2020 2020 2020 2020  sed"),.         
-00020280: 2020 2020 2020 2020 2020 2063 616c 6c28             call(
-00020290: 2231 2065 7272 6f72 7320 6f63 6375 7272  "1 errors occurr
-000202a0: 6564 2229 2c0a 2020 2020 2020 2020 2020  ed"),.          
-000202b0: 2020 2020 2020 2020 2020 6361 6c6c 2822            call("
-000202c0: 3020 6269 6274 6578 2065 6e74 7269 6573  0 bibtex entries
-000202d0: 2063 6861 6e67 6564 2229 2c0a 2020 2020   changed"),.    
-000202e0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-000202f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00020300: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00020310: 6273 2e63 6c65 616e 4269 6274 6578 7328  bs.cleanBibtexs(
-00020320: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00020330: 636c 6561 6e46 6965 6c64 7328 7365 6c66  cleanFields(self
-00020340: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
-00020350: 2020 2222 2274 6573 7420 636c 6561 6e46    """test cleanF
-00020360: 6965 6c64 7322 2222 0a20 2020 2020 2020  ields""".       
-00020370: 2077 6974 6820 7061 7463 6828 2270 6879   with patch("phy
-00020380: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
-00020390: 2e45 6e74 7269 6573 2e75 7064 6174 6546  .Entries.updateF
-000203a0: 6965 6c64 2229 2061 7320 5f75 3a0a 2020  ield") as _u:.  
-000203b0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-000203c0: 4244 422e 6269 6273 2e63 6c65 616e 4669  BDB.bibs.cleanFi
-000203d0: 656c 6473 280a 2020 2020 2020 2020 2020  elds(.          
-000203e0: 2020 2020 2020 7b22 6269 626b 6579 223a        {"bibkey":
-000203f0: 2022 6162 6322 2c20 226d 6172 6b73 223a   "abc", "marks":
-00020400: 204e 6f6e 652c 2022 6f6c 645f 6b65 7973   None, "old_keys
-00020410: 223a 204e 6f6e 652c 2022 6269 6274 6578  ": None, "bibtex
-00020420: 223a 204e 6f6e 657d 0a20 2020 2020 2020  ": None}.       
-00020430: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00020440: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00020450: 7561 6c28 5f75 2e63 616c 6c5f 636f 756e  ual(_u.call_coun
-00020460: 742c 2032 290a 2020 2020 2020 2020 2020  t, 2).          
-00020470: 2020 5f75 2e61 7373 6572 745f 616e 795f    _u.assert_any_
-00020480: 6361 6c6c 2822 6162 6322 2c20 226d 6172  call("abc", "mar
-00020490: 6b73 222c 2022 2229 0a20 2020 2020 2020  ks", "").       
-000204a0: 2020 2020 205f 752e 6173 7365 7274 5f61       _u.assert_a
-000204b0: 6e79 5f63 616c 6c28 2261 6263 222c 2022  ny_call("abc", "
-000204c0: 6f6c 645f 6b65 7973 222c 2022 2229 0a20  old_keys", ""). 
-000204d0: 2020 2020 2020 2020 2020 205f 752e 7265             _u.re
-000204e0: 7365 745f 6d6f 636b 2829 0a20 2020 2020  set_mock().     
-000204f0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00020500: 2e62 6962 732e 636c 6561 6e46 6965 6c64  .bibs.cleanField
-00020510: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00020520: 2020 207b 2262 6962 6b65 7922 3a20 2261     {"bibkey": "a
-00020530: 6263 222c 2022 6d61 726b 7322 3a20 2261  bc", "marks": "a
-00020540: 6222 2c20 226f 6c64 5f6b 6579 7322 3a20  b", "old_keys": 
-00020550: 2263 6422 2c20 2262 6962 7465 7822 3a20  "cd", "bibtex": 
-00020560: 4e6f 6e65 7d0a 2020 2020 2020 2020 2020  None}.          
-00020570: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00020580: 5f75 2e61 7373 6572 745f 6e6f 745f 6361  _u.assert_not_ca
-00020590: 6c6c 6564 2829 0a20 2020 2020 2020 2020  lled().         
-000205a0: 2020 205f 752e 7265 7365 745f 6d6f 636b     _u.reset_mock
-000205b0: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-000205c0: 656c 662e 7042 4442 2e62 6962 732e 636c  elf.pBDB.bibs.cl
-000205d0: 6561 6e46 6965 6c64 7328 0a20 2020 2020  eanFields(.     
-000205e0: 2020 2020 2020 2020 2020 207b 2262 6962             {"bib
-000205f0: 6b65 7922 3a20 2261 6263 222c 2022 6d61  key": "abc", "ma
-00020600: 726b 7322 3a20 2261 2762 222c 2022 6f6c  rks": "a'b", "ol
-00020610: 645f 6b65 7973 223a 2022 6364 222c 2022  d_keys": "cd", "
-00020620: 6269 6274 6578 223a 204e 6f6e 657d 0a20  bibtex": None}. 
-00020630: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00020640: 2020 2020 2020 2020 205f 752e 6173 7365           _u.asse
-00020650: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-00020660: 6974 6828 2261 6263 222c 2022 6d61 726b  ith("abc", "mark
-00020670: 7322 2c20 2261 6222 290a 2020 2020 2020  s", "ab").      
-00020680: 2020 2020 2020 5f75 2e72 6573 6574 5f6d        _u.reset_m
-00020690: 6f63 6b28 290a 2020 2020 2020 2020 2020  ock().          
-000206a0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-000206b0: 2e63 6c65 616e 4669 656c 6473 280a 2020  .cleanFields(.  
-000206c0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+0001c260: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
+0001c270: 2022 616c 6c20 7468 6520 666f 6c6c 6f77   "all the follow
+0001c280: 696e 6722 2c0a 2020 2020 2020 2020 2020  ing",.          
+0001c290: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+0001c2a0: 223a 2022 6269 6274 6578 222c 0a20 2020  ": "bibtex",.   
+0001c2b0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+0001c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c2d0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+0001c2e0: 2020 2020 2020 2261 6263 222c 0a20 2020        "abc",.   
+0001c2f0: 2020 2020 2020 2020 2020 2020 2022 7768               "wh
+0001c300: 6572 6520 222c 0a20 2020 2020 2020 2020  ere ",.         
+0001c310: 2020 2020 2020 2022 6a6f 696e 2022 2c0a         "join ",.
+0001c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c330: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+0001c340: 2020 2020 7072 6570 656e 6454 6162 3d22      prependTab="
+0001c350: 656e 7472 6965 3173 2e22 2c0a 2020 2020  entrie1s.",.    
+0001c360: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+0001c370: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
+0001c380: 2020 2020 2020 2020 2046 616c 7365 2c0a           False,.
+0001c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3a0: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
+0001c3b0: 2020 2020 2020 2022 7768 6572 6520 2028         "where  (
+0001c3c0: 656e 7472 7945 7870 7330 2e69 6445 7870  entryExps0.idExp
+0001c3d0: 203d 203f 2061 6e64 2065 6e74 7279 4578   = ? and entryEx
+0001c3e0: 7073 312e 6964 4578 7020 3d20 3f29 2022  ps1.idExp = ?) "
+0001c3f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c400: 2020 226a 6f69 6e20 206c 6566 7420 6a6f    "join  left jo
+0001c410: 696e 2065 6e74 7279 4578 7073 2065 6e74  in entryExps ent
+0001c420: 7279 4578 7073 3020 6f6e 2065 6e74 7269  ryExps0 on entri
+0001c430: 6573 2e62 6962 6b65 793d 656e 7472 7945  es.bibkey=entryE
+0001c440: 7870 7330 2e62 6962 6b65 7920 206c 6566  xps0.bibkey  lef
+0001c450: 7420 6a6f 696e 2065 6e74 7279 4578 7073  t join entryExps
+0001c460: 2065 6e74 7279 4578 7073 3120 6f6e 2065   entryExps1 on e
+0001c470: 6e74 7269 6573 2e62 6962 6b65 793d 656e  ntries.bibkey=en
+0001c480: 7472 7945 7870 7331 2e62 6962 6b65 7922  tryExps1.bibkey"
+0001c490: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c4a0: 2020 2822 3122 2c20 2232 2229 2c0a 2020    ("1", "2"),.  
+0001c4b0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0001c4c0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0001c4d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001c4e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001c4f0: 662e 7042 4442 2e62 6962 732e 5f70 726f  f.pBDB.bibs._pro
+0001c500: 6365 7373 5175 6572 7946 6965 6c64 7328  cessQueryFields(
+0001c510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c520: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0001c530: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+0001c540: 3a20 2261 6263 222c 0a20 2020 2020 2020  : "abc",.       
+0001c550: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+0001c560: 7065 223a 2022 4d61 726b 7322 2c0a 2020  pe": "Marks",.  
+0001c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c580: 2020 2263 6f6e 7465 6e74 223a 205b 2261    "content": ["a
+0001c590: 6263 225d 2c0a 2020 2020 2020 2020 2020  bc"],.          
+0001c5a0: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+0001c5b0: 746f 7222 3a20 223d 222c 0a20 2020 2020  tor": "=",.     
+0001c5c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001c5d0: 6669 656c 6422 3a20 2262 6962 7465 7822  field": "bibtex"
+0001c5e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c5f0: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+0001c600: 2020 2020 2046 616c 7365 2c0a 2020 2020       False,.    
+0001c610: 2020 2020 2020 2020 2020 2020 2261 6263              "abc
+0001c620: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001c630: 2020 2022 7768 6572 6520 222c 0a20 2020     "where ",.   
+0001c640: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
+0001c650: 696e 2022 2c0a 2020 2020 2020 2020 2020  in ",.          
+0001c660: 2020 2020 2020 2829 2c0a 2020 2020 2020        (),.      
+0001c670: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001c680: 2020 2020 2028 4661 6c73 652c 2022 6162       (False, "ab
+0001c690: 6322 2c20 2277 6865 7265 2061 6e64 206d  c", "where and m
+0001c6a0: 6172 6b73 203d 203f 2022 2c20 226a 6f69  arks = ? ", "joi
+0001c6b0: 6e20 222c 2028 2261 6263 222c 2929 2c0a  n ", ("abc",)),.
+0001c6c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001c6d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001c6e0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0001c6f0: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
+0001c700: 7072 6f63 6573 7351 7565 7279 4669 656c  processQueryFiel
+0001c710: 6473 280a 2020 2020 2020 2020 2020 2020  ds(.            
+0001c720: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0001c730: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+0001c740: 616c 223a 2022 6162 6322 2c0a 2020 2020  al": "abc",.    
+0001c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c760: 2274 7970 6522 3a20 224d 6172 6b73 222c  "type": "Marks",
+0001c770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c780: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+0001c790: 5b22 616e 7922 5d2c 0a20 2020 2020 2020  ["any"],.       
+0001c7a0: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+0001c7b0: 6572 6174 6f72 223a 2022 3d3d 3d22 2c0a  erator": "===",.
+0001c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c7d0: 2020 2020 2266 6965 6c64 223a 2022 6269      "field": "bi
+0001c7e0: 6274 6578 222c 0a20 2020 2020 2020 2020  btex",.         
+0001c7f0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+0001c800: 2020 2020 2020 2020 2020 4661 6c73 652c            False,
+0001c810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c820: 2022 6162 6322 2c0a 2020 2020 2020 2020   "abc",.        
+0001c830: 2020 2020 2020 2020 2277 6865 7265 2022          "where "
+0001c840: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c850: 2020 226a 6f69 6e20 222c 0a20 2020 2020    "join ",.     
+0001c860: 2020 2020 2020 2020 2020 2028 292c 0a20             (),. 
+0001c870: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0001c880: 2020 2020 2020 2020 2020 2846 616c 7365            (False
+0001c890: 2c20 2261 6263 222c 2022 7768 6572 6520  , "abc", "where 
+0001c8a0: 616e 6420 6d61 726b 7320 213d 203f 2022  and marks != ? "
+0001c8b0: 2c20 226a 6f69 6e20 222c 2028 2222 2c29  , "join ", ("",)
+0001c8c0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+0001c8d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001c8e0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+0001c8f0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0001c900: 732e 5f70 726f 6365 7373 5175 6572 7946  s._processQueryF
+0001c910: 6965 6c64 7328 0a20 2020 2020 2020 2020  ields(.         
+0001c920: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0001c930: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+0001c940: 6769 6361 6c22 3a20 2261 6263 222c 0a20  gical": "abc",. 
+0001c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c960: 2020 2022 7479 7065 223a 2022 4d61 726b     "type": "Mark
+0001c970: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+0001c980: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
+0001c990: 223a 205b 2261 6263 225d 2c0a 2020 2020  ": ["abc"],.    
+0001c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9b0: 226f 7065 7261 746f 7222 3a20 226c 696b  "operator": "lik
+0001c9c0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0001c9d0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+0001c9e0: 2022 6269 6274 6578 222c 0a20 2020 2020   "bibtex",.     
+0001c9f0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+0001ca00: 2020 2020 2020 2020 2020 2020 2020 4661                Fa
+0001ca10: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+0001ca20: 2020 2020 2022 6162 6322 2c0a 2020 2020       "abc",.    
+0001ca30: 2020 2020 2020 2020 2020 2020 2277 6865              "whe
+0001ca40: 7265 2022 2c0a 2020 2020 2020 2020 2020  re ",.          
+0001ca50: 2020 2020 2020 226a 6f69 6e20 222c 0a20        "join ",. 
+0001ca60: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0001ca70: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
+0001ca80: 2c0a 2020 2020 2020 2020 2020 2020 2846  ,.            (F
+0001ca90: 616c 7365 2c20 2261 6263 222c 2022 7768  alse, "abc", "wh
+0001caa0: 6572 6520 616e 6420 6d61 726b 7320 6c69  ere and marks li
+0001cab0: 6b65 203f 2022 2c20 226a 6f69 6e20 222c  ke ? ", "join ",
+0001cac0: 2028 2225 6162 6325 222c 2929 2c0a 2020   ("%abc%",)),.  
+0001cad0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001cae0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0001caf0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0001cb00: 6c66 2e70 4244 422e 6269 6273 2e5f 7072  lf.pBDB.bibs._pr
+0001cb10: 6f63 6573 7351 7565 7279 4669 656c 6473  ocessQueryFields
+0001cb20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001cb30: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+0001cb40: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
+0001cb50: 223a 2022 6162 6322 2c0a 2020 2020 2020  ": "abc",.      
+0001cb60: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0001cb70: 7970 6522 3a20 2254 7970 6522 2c0a 2020  ype": "Type",.  
+0001cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb90: 2020 2263 6f6e 7465 6e74 223a 205b 2261    "content": ["a
+0001cba0: 6263 225d 2c0a 2020 2020 2020 2020 2020  bc"],.          
+0001cbb0: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+0001cbc0: 746f 7222 3a20 223d 222c 0a20 2020 2020  tor": "=",.     
+0001cbd0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001cbe0: 6669 656c 6422 3a20 2262 6962 7465 7822  field": "bibtex"
+0001cbf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001cc00: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+0001cc10: 2020 2020 2046 616c 7365 2c0a 2020 2020       False,.    
+0001cc20: 2020 2020 2020 2020 2020 2020 2261 6263              "abc
+0001cc30: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001cc40: 2020 2022 7768 6572 6520 222c 0a20 2020     "where ",.   
+0001cc50: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
+0001cc60: 696e 2022 2c0a 2020 2020 2020 2020 2020  in ",.          
+0001cc70: 2020 2020 2020 2829 2c0a 2020 2020 2020        (),.      
+0001cc80: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001cc90: 2020 2020 2028 4661 6c73 652c 2022 6162       (False, "ab
+0001cca0: 6322 2c20 2277 6865 7265 2061 6e64 2061  c", "where and a
+0001ccb0: 6263 203d 203f 2022 2c20 226a 6f69 6e20  bc = ? ", "join 
+0001ccc0: 222c 2028 2231 222c 2929 2c0a 2020 2020  ", ("1",)),.    
+0001ccd0: 2020 2020 290a 2020 2020 2020 2020 6669      ).        fi
+0001cce0: 7273 7454 7970 6520 3d20 5472 7565 0a20  rstType = True. 
+0001ccf0: 2020 2020 2020 2065 7720 3d20 2222 0a20         ew = "". 
+0001cd00: 2020 2020 2020 2065 7620 3d20 2829 0a20         ev = (). 
+0001cd10: 2020 2020 2020 2066 6f72 2066 2069 6e20         for f in 
+0001cd20: 7365 6c66 2e70 4244 422e 6269 6273 2e73  self.pBDB.bibs.s
+0001cd30: 6561 7263 6850 6f73 7369 626c 6554 7970  earchPossibleTyp
+0001cd40: 6573 2e6b 6579 7328 293a 0a20 2020 2020  es.keys():.     
+0001cd50: 2020 2020 2020 2069 6620 6620 213d 2022         if f != "
+0001cd60: 6e6f 6e65 223a 0a20 2020 2020 2020 2020  none":.         
+0001cd70: 2020 2020 2020 2065 7720 2b3d 2022 2573         ew += "%s
+0001cd80: 2025 7325 7320 2573 203f 2022 2025 2028   %s%s %s ? " % (
+0001cd90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cda0: 2020 2020 2022 2220 6966 2066 6972 7374       "" if first
+0001cdb0: 5479 7065 2065 6c73 6520 2261 6e64 222c  Type else "and",
+0001cdc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cdd0: 2020 2020 2022 222c 0a20 2020 2020 2020       "",.       
+0001cde0: 2020 2020 2020 2020 2020 2020 2066 2c0a               f,.
+0001cdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce00: 2020 2020 223d 222c 0a20 2020 2020 2020      "=",.       
+0001ce10: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001ce20: 2020 2020 2020 2020 2020 2065 7620 2b3d             ev +=
+0001ce30: 2028 2230 222c 290a 2020 2020 2020 2020   ("0",).        
+0001ce40: 2020 2020 2020 2020 6669 7273 7454 7970          firstTyp
+0001ce50: 6520 3d20 4661 6c73 650a 2020 2020 2020  e = False.      
+0001ce60: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001ce70: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0001ce80: 7365 6c66 2e70 4244 422e 6269 6273 2e5f  self.pBDB.bibs._
+0001ce90: 7072 6f63 6573 7351 7565 7279 4669 656c  processQueryFiel
+0001cea0: 6473 280a 2020 2020 2020 2020 2020 2020  ds(.            
+0001ceb0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0001cec0: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+0001ced0: 616c 223a 2022 6162 6322 2c0a 2020 2020  al": "abc",.    
+0001cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cef0: 2274 7970 6522 3a20 2254 7970 6522 2c0a  "type": "Type",.
+0001cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf10: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
+0001cf20: 226e 6f6e 6522 5d2c 0a20 2020 2020 2020  "none"],.       
+0001cf30: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+0001cf40: 6572 6174 6f72 223a 2022 3d22 2c0a 2020  erator": "=",.  
+0001cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf60: 2020 2266 6965 6c64 223a 2022 6269 6274    "field": "bibt
+0001cf70: 6578 222c 0a20 2020 2020 2020 2020 2020  ex",.           
+0001cf80: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+0001cf90: 2020 2020 2020 2020 5472 7565 2c0a 2020          True,.  
+0001cfa0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0001cfb0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+0001cfc0: 2020 2020 2022 7768 6572 6522 2c0a 2020       "where",.  
+0001cfd0: 2020 2020 2020 2020 2020 2020 2020 226a                "j
+0001cfe0: 6f69 6e20 222c 0a20 2020 2020 2020 2020  oin ",.         
+0001cff0: 2020 2020 2020 2028 292c 0a20 2020 2020         (),.     
+0001d000: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+0001d010: 2020 2020 2020 2846 616c 7365 2c20 2261        (False, "a
+0001d020: 6263 222c 2022 7768 6572 6522 202b 2065  bc", "where" + e
+0001d030: 772c 2022 6a6f 696e 2022 2c20 6576 292c  w, "join ", ev),
+0001d040: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0001d050: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001d060: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0001d070: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0001d080: 5f70 726f 6365 7373 5175 6572 7946 6965  _processQueryFie
+0001d090: 6c64 7328 0a20 2020 2020 2020 2020 2020  lds(.           
+0001d0a0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+0001d0b0: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+0001d0c0: 6361 6c22 3a20 2261 6263 222c 0a20 2020  cal": "abc",.   
+0001d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0e0: 2022 7479 7065 223a 2022 5479 7065 222c   "type": "Type",
+0001d0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d100: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+0001d110: 5b22 6e6f 6e65 225d 2c0a 2020 2020 2020  ["none"],.      
+0001d120: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0001d130: 7065 7261 746f 7222 3a20 223d 222c 0a20  perator": "=",. 
+0001d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d150: 2020 2022 6669 656c 6422 3a20 2262 6962     "field": "bib
+0001d160: 7465 7822 2c0a 2020 2020 2020 2020 2020  tex",.          
+0001d170: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0001d180: 2020 2020 2020 2020 2046 616c 7365 2c0a           False,.
+0001d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1a0: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
+0001d1b0: 2020 2020 2020 2022 7768 6572 6520 736f         "where so
+0001d1c0: 6d65 7468 696e 6720 3d20 3f20 222c 0a20  mething = ? ",. 
+0001d1d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001d1e0: 6a6f 696e 2022 2c0a 2020 2020 2020 2020  join ",.        
+0001d1f0: 2020 2020 2020 2020 7475 706c 6528 2261          tuple("a
+0001d200: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0001d210: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+0001d220: 4661 6c73 652c 2022 6162 6322 2c20 2277  False, "abc", "w
+0001d230: 6865 7265 2073 6f6d 6574 6869 6e67 203d  here something =
+0001d240: 203f 2061 6e64 2220 2b20 6577 2c20 226a   ? and" + ew, "j
+0001d250: 6f69 6e20 222c 2074 7570 6c65 2822 6122  oin ", tuple("a"
+0001d260: 2920 2b20 6576 292c 0a20 2020 2020 2020  ) + ev),.       
+0001d270: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+0001d280: 5f62 6962 7465 7846 726f 6d44 4228 7365  _bibtexFromDB(se
+0001d290: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
+0001d2a0: 2020 2020 2222 2274 6573 7420 6269 6274      """test bibt
+0001d2b0: 6578 4672 6f6d 4442 2222 220a 2020 2020  exFromDB""".    
+0001d2c0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001d2d0: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
+0001d2e0: 6962 732e 6269 6274 6578 4672 6f6d 4442  ibs.bibtexFromDB
+0001d2f0: 2822 6162 6322 292c 2022 2229 0a20 2020  ("abc"), "").   
+0001d300: 2020 2020 2062 6173 6963 456e 7472 7920       basicEntry 
+0001d310: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0001d320: 2249 4422 3a20 2274 6573 7422 2c0a 2020  "ID": "test",.  
+0001d330: 2020 2020 2020 2020 2020 2245 4e54 5259            "ENTRY
+0001d340: 5459 5045 223a 2022 6172 7469 636c 6522  TYPE": "article"
+0001d350: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
+0001d360: 7574 686f 7222 3a20 226d 6520 c3a0 222c  uthor": "me ..",
+0001d370: 0a20 2020 2020 2020 2020 2020 2022 7469  .            "ti
+0001d380: 746c 6522 3a20 224d 795c 6e20 7469 746c  tle": "My\n titl
+0001d390: 6522 2c0a 2020 2020 2020 2020 7d0a 2020  e",.        }.  
+0001d3a0: 2020 2020 2020 6462 203d 2062 6962 7465        db = bibte
+0001d3b0: 7870 6172 7365 722e 6269 6264 6174 6162  xparser.bibdatab
+0001d3c0: 6173 652e 4269 6244 6174 6162 6173 6528  ase.BibDatabase(
+0001d3d0: 290a 2020 2020 2020 2020 6462 2e65 6e74  ).        db.ent
+0001d3e0: 7269 6573 203d 205b 6261 7369 6345 6e74  ries = [basicEnt
+0001d3f0: 7279 5d0a 2020 2020 2020 2020 7365 6c66  ry].        self
+0001d400: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+0001d410: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0001d420: 4244 422e 6269 6273 2e62 6962 7465 7846  BDB.bibs.bibtexF
+0001d430: 726f 6d44 4228 6462 292c 0a20 2020 2020  romDB(db),.     
+0001d440: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0001d450: 2e62 6962 732e 726d 4269 6274 6578 436f  .bibs.rmBibtexCo
+0001d460: 6d6d 656e 7473 280a 2020 2020 2020 2020  mments(.        
+0001d470: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0001d480: 422e 6269 6273 2e72 6d42 6962 7465 7841  B.bibs.rmBibtexA
+0001d490: 4361 706f 280a 2020 2020 2020 2020 2020  Capo(.          
+0001d4a0: 2020 2020 2020 2020 2020 7061 7273 655f            parse_
+0001d4b0: 6163 6365 6e74 735f 7374 7228 7062 5772  accents_str(pbWr
+0001d4c0: 6974 6572 2e77 7269 7465 2864 6229 2e73  iter.write(db).s
+0001d4d0: 7472 6970 2829 290a 2020 2020 2020 2020  trip()).        
+0001d4e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001d4f0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001d500: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+0001d510: 5f63 6865 636b 4578 6973 7469 6e67 456e  _checkExistingEn
+0001d520: 7472 7928 7365 6c66 2c20 2a61 7267 7329  try(self, *args)
+0001d530: 3a0a 2020 2020 2020 2020 2222 2274 6573  :.        """tes
+0001d540: 7420 6368 6563 6b45 7869 7374 696e 6745  t checkExistingE
+0001d550: 6e74 7279 2222 220a 2020 2020 2020 2020  ntry""".        
+0001d560: 7365 6c66 2e69 6e73 6572 745f 7468 7265  self.insert_thre
+0001d570: 6528 290a 2020 2020 2020 2020 7365 6c66  e().        self
+0001d580: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+0001d590: 6546 6965 6c64 2822 6162 6322 2c20 2261  eField("abc", "a
+0001d5a0: 7278 6976 222c 2022 3132 3334 2e35 3637  rxiv", "1234.567
+0001d5b0: 3822 290a 2020 2020 2020 2020 7365 6c66  8").        self
+0001d5c0: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+0001d5d0: 6546 6965 6c64 2822 6465 6622 2c20 2261  eField("def", "a
+0001d5e0: 7278 6976 222c 2022 3536 3738 2e31 3233  rxiv", "5678.123
+0001d5f0: 3422 290a 2020 2020 2020 2020 7365 6c66  4").        self
+0001d600: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+0001d610: 6546 6965 6c64 2822 6768 6922 2c20 2261  eField("ghi", "a
+0001d620: 7278 6976 222c 2022 2229 0a20 2020 2020  rxiv", "").     
+0001d630: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0001d640: 732e 7570 6461 7465 4669 656c 6428 2261  s.updateField("a
+0001d650: 6263 222c 2022 646f 6922 2c20 2231 2f32  bc", "doi", "1/2
+0001d660: 2f33 2229 0a20 2020 2020 2020 2073 656c  /3").        sel
+0001d670: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
+0001d680: 7465 4669 656c 6428 2264 6566 222c 2022  teField("def", "
+0001d690: 646f 6922 2c20 2222 290a 2020 2020 2020  doi", "").      
+0001d6a0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0001d6b0: 2e75 7064 6174 6546 6965 6c64 2822 6768  .updateField("gh
+0001d6c0: 6922 2c20 2264 6f69 222c 2022 322f 332f  i", "doi", "2/3/
+0001d6d0: 3422 290a 2020 2020 2020 2020 7365 6c66  4").        self
+0001d6e0: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
+0001d6f0: 662e 7042 4442 2e62 6962 732e 6368 6563  f.pBDB.bibs.chec
+0001d700: 6b45 7869 7374 696e 6745 6e74 7279 2822  kExistingEntry("
+0001d710: 6162 6364 2229 2c20 5b5d 290a 2020 2020  abcd"), []).    
+0001d720: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001d730: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+0001d740: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0001d750: 2e63 6865 636b 4578 6973 7469 6e67 456e  .checkExistingEn
+0001d760: 7472 7928 2261 6263 6422 2c20 6172 7869  try("abcd", arxi
+0001d770: 763d 2231 3233 342e 3433 3231 2229 2c20  v="1234.4321"), 
+0001d780: 5b5d 0a20 2020 2020 2020 2029 0a20 2020  [].        ).   
+0001d790: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001d7a0: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+0001d7b0: 6269 6273 2e63 6865 636b 4578 6973 7469  bibs.checkExisti
+0001d7c0: 6e67 456e 7472 7928 2261 6263 6422 2c20  ngEntry("abcd", 
+0001d7d0: 6172 7869 763d 2231 2f32 2f33 2f34 2229  arxiv="1/2/3/4")
+0001d7e0: 2c20 5b5d 290a 2020 2020 2020 2020 7365  , []).        se
+0001d7f0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+0001d800: 2020 2020 2020 2020 2020 2020 5b61 5b22              [a["
+0001d810: 6269 626b 6579 225d 2066 6f72 2061 2069  bibkey"] for a i
+0001d820: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+0001d830: 2e63 6865 636b 4578 6973 7469 6e67 456e  .checkExistingEn
+0001d840: 7472 7928 2261 6263 2229 5d2c 205b 2261  try("abc")], ["a
+0001d850: 6263 225d 0a20 2020 2020 2020 2029 0a20  bc"].        ). 
+0001d860: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001d870: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+0001d880: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+0001d890: 2020 2020 2020 2061 5b22 6269 626b 6579         a["bibkey
+0001d8a0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+0001d8b0: 2020 2066 6f72 2061 2069 6e20 7365 6c66     for a in self
+0001d8c0: 2e70 4244 422e 6269 6273 2e63 6865 636b  .pBDB.bibs.check
+0001d8d0: 4578 6973 7469 6e67 456e 7472 7928 2261  ExistingEntry("a
+0001d8e0: 6263 6422 2c20 6172 7869 763d 2231 3233  bcd", arxiv="123
+0001d8f0: 342e 3536 3738 2229 0a20 2020 2020 2020  4.5678").       
+0001d900: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+0001d910: 2020 2020 5b22 6162 6322 5d2c 0a20 2020      ["abc"],.   
+0001d920: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0001d930: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001d940: 0a20 2020 2020 2020 2020 2020 205b 615b  .            [a[
+0001d950: 2262 6962 6b65 7922 5d20 666f 7220 6120  "bibkey"] for a 
+0001d960: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
+0001d970: 732e 6368 6563 6b45 7869 7374 696e 6745  s.checkExistingE
+0001d980: 6e74 7279 2822 3132 3334 2e35 3637 3822  ntry("1234.5678"
+0001d990: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
+0001d9a0: 5b22 6162 6322 5d2c 0a20 2020 2020 2020  ["abc"],.       
+0001d9b0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+0001d9c0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0001d9d0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0001d9e0: 2020 2020 2020 2020 2020 2061 5b22 6269             a["bi
+0001d9f0: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
+0001da00: 2020 2020 2020 2066 6f72 2061 2069 6e20         for a in 
+0001da10: 7365 6c66 2e70 4244 422e 6269 6273 2e63  self.pBDB.bibs.c
+0001da20: 6865 636b 4578 6973 7469 6e67 456e 7472  heckExistingEntr
+0001da30: 7928 2267 6869 222c 2061 7278 6976 3d22  y("ghi", arxiv="
+0001da40: 3536 3738 2e31 3233 3422 290a 2020 2020  5678.1234").    
+0001da50: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+0001da60: 2020 2020 2020 205b 2267 6869 222c 2022         ["ghi", "
+0001da70: 6465 6622 5d2c 0a20 2020 2020 2020 2029  def"],.        )
+0001da80: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0001da90: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0001daa0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0001dab0: 2020 2020 2020 2020 2061 5b22 6269 626b           a["bibk
+0001dac0: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
+0001dad0: 2020 2020 2066 6f72 2061 2069 6e20 7365       for a in se
+0001dae0: 6c66 2e70 4244 422e 6269 6273 2e63 6865  lf.pBDB.bibs.che
+0001daf0: 636b 4578 6973 7469 6e67 456e 7472 7928  ckExistingEntry(
+0001db00: 2264 6566 6722 2c20 646f 693d 2231 2f32  "defg", doi="1/2
+0001db10: 2f33 2229 0a20 2020 2020 2020 2020 2020  /3").           
+0001db20: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+0001db30: 5b22 6162 6322 5d2c 0a20 2020 2020 2020  ["abc"],.       
+0001db40: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+0001db50: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0001db60: 2020 2020 2020 2020 205b 615b 2262 6962           [a["bib
+0001db70: 6b65 7922 5d20 666f 7220 6120 696e 2073  key"] for a in s
+0001db80: 656c 662e 7042 4442 2e62 6962 732e 6368  elf.pBDB.bibs.ch
+0001db90: 6563 6b45 7869 7374 696e 6745 6e74 7279  eckExistingEntry
+0001dba0: 2822 312f 322f 3322 295d 2c20 5b22 6162  ("1/2/3")], ["ab
+0001dbb0: 6322 5d0a 2020 2020 2020 2020 290a 2020  c"].        ).  
+0001dbc0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001dbd0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0001dbe0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+0001dbf0: 2020 2020 2020 615b 2262 6962 6b65 7922        a["bibkey"
+0001dc00: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0001dc10: 2020 666f 7220 6120 696e 2073 656c 662e    for a in self.
+0001dc20: 7042 4442 2e62 6962 732e 6368 6563 6b45  pBDB.bibs.checkE
+0001dc30: 7869 7374 696e 6745 6e74 7279 280a 2020  xistingEntry(.  
+0001dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc50: 2020 2264 6566 222c 2064 6f69 3d22 322f    "def", doi="2/
+0001dc60: 332f 3422 2c20 6172 7869 763d 2231 3233  3/4", arxiv="123
+0001dc70: 342e 3536 3738 220a 2020 2020 2020 2020  4.5678".        
+0001dc80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001dc90: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+0001dca0: 2020 2020 205b 2264 6566 222c 2022 6162       ["def", "ab
+0001dcb0: 6322 2c20 2267 6869 225d 2c0a 2020 2020  c", "ghi"],.    
+0001dcc0: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
+0001dcd0: 6573 745f 6368 6563 6b4e 6565 6473 5570  est_checkNeedsUp
+0001dce0: 6461 7465 2873 656c 662c 202a 6172 6773  date(self, *args
+0001dcf0: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
+0001dd00: 7374 2063 6865 636b 4e65 6564 7355 7064  st checkNeedsUpd
+0001dd10: 6174 6522 2222 0a20 2020 2020 2020 2073  ate""".        s
+0001dd20: 656c 662e 7042 4442 2e62 6962 732e 7275  elf.pBDB.bibs.ru
+0001dd30: 6e6e 696e 674f 4149 5570 6461 7465 7320  nningOAIUpdates 
+0001dd40: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+0001dd50: 6520 3d20 7b0a 2020 2020 2020 2020 2020  e = {.          
+0001dd60: 2020 2270 726f 6365 6564 696e 6722 3a20    "proceeding": 
+0001dd70: 302c 0a20 2020 2020 2020 2020 2020 2022  0,.            "
+0001dd80: 626f 6f6b 223a 2030 2c0a 2020 2020 2020  book": 0,.      
+0001dd90: 2020 2020 2020 226c 6563 7475 7265 223a        "lecture":
+0001dda0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+0001ddb0: 2270 6864 5f74 6865 7369 7322 3a20 302c  "phd_thesis": 0,
+0001ddc0: 0a20 2020 2020 2020 2020 2020 2022 6e6f  .            "no
+0001ddd0: 5570 6461 7465 223a 2030 2c0a 2020 2020  Update": 0,.    
+0001dde0: 2020 2020 2020 2020 2269 6e73 7069 7265          "inspire
+0001ddf0: 223a 2022 3132 3322 2c0a 2020 2020 2020  ": "123",.      
+0001de00: 2020 2020 2020 2264 6f69 223a 2022 312f        "doi": "1/
+0001de10: 322f 3322 2c0a 2020 2020 2020 2020 7d0a  2/3",.        }.
+0001de20: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0001de30: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0001de40: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0001de50: 6261 7365 2e45 6e74 7269 6573 2e63 6f6d  base.Entries.com
+0001de60: 706c 6574 6546 6574 6368 6564 222c 2072  pleteFetched", r
+0001de70: 6574 7572 6e5f 7661 6c75 653d 5b65 5d0a  eturn_value=[e].
+0001de80: 2020 2020 2020 2020 2920 6173 205f 633a          ) as _c:
+0001de90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001dea0: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
+0001deb0: 6c66 2e70 4244 422e 6269 6273 2e63 6865  lf.pBDB.bibs.che
+0001dec0: 636b 4e65 6564 7355 7064 6174 6528 6529  ckNeedsUpdate(e)
+0001ded0: 290a 2020 2020 2020 2020 2020 2020 5f63  ).            _c
+0001dee0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+0001def0: 6e63 655f 7769 7468 285b 655d 290a 2020  nce_with([e]).  
+0001df00: 2020 2020 2020 655b 2262 6962 7465 7844        e["bibtexD
+0001df10: 6963 7422 5d20 3d20 7b22 6a6f 7572 6e61  ict"] = {"journa
+0001df20: 6c22 3a20 2261 227d 0a20 2020 2020 2020  l": "a"}.       
+0001df30: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0001df40: 7275 6e6e 696e 674f 4149 5570 6461 7465  runningOAIUpdate
+0001df50: 7320 3d20 5472 7565 0a20 2020 2020 2020  s = True.       
+0001df60: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
+0001df70: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+0001df80: 626c 696f 2e64 6174 6162 6173 652e 456e  blio.database.En
+0001df90: 7472 6965 732e 636f 6d70 6c65 7465 4665  tries.completeFe
+0001dfa0: 7463 6865 6422 2c20 7265 7475 726e 5f76  tched", return_v
+0001dfb0: 616c 7565 3d5b 655d 0a20 2020 2020 2020  alue=[e].       
+0001dfc0: 2029 2061 7320 5f63 3a0a 2020 2020 2020   ) as _c:.      
+0001dfd0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001dfe0: 7446 616c 7365 2873 656c 662e 7042 4442  tFalse(self.pBDB
+0001dff0: 2e62 6962 732e 6368 6563 6b4e 6565 6473  .bibs.checkNeeds
+0001e000: 5570 6461 7465 2865 2929 0a20 2020 2020  Update(e)).     
+0001e010: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001e020: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
+0001e030: 2e62 6962 732e 6368 6563 6b4e 6565 6473  .bibs.checkNeeds
+0001e040: 5570 6461 7465 2865 2c20 666f 7263 653d  Update(e, force=
+0001e050: 5472 7565 2929 0a20 2020 2020 2020 2020  True)).         
+0001e060: 2020 2065 5b22 6269 6274 6578 4469 6374     e["bibtexDict
+0001e070: 225d 203d 207b 2261 223a 2022 6222 7d0a  "] = {"a": "b"}.
+0001e080: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001e090: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+0001e0a0: 2e70 4244 422e 6269 6273 2e63 6865 636b  .pBDB.bibs.check
+0001e0b0: 4e65 6564 7355 7064 6174 6528 6529 290a  NeedsUpdate(e)).
+0001e0c0: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
+0001e0d0: 6962 7465 7844 6963 7422 5d20 3d20 7b22  ibtexDict"] = {"
+0001e0e0: 6a6f 7572 6e61 6c22 3a20 2261 227d 0a20  journal": "a"}. 
+0001e0f0: 2020 2020 2020 2020 2020 2065 5b22 646f             e["do
+0001e100: 6922 5d20 3d20 4e6f 6e65 0a20 2020 2020  i"] = None.     
+0001e110: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001e120: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
+0001e130: 2e62 6962 732e 6368 6563 6b4e 6565 6473  .bibs.checkNeeds
+0001e140: 5570 6461 7465 2865 2929 0a20 2020 2020  Update(e)).     
+0001e150: 2020 2020 2020 2065 5b22 646f 6922 5d20         e["doi"] 
+0001e160: 3d20 2231 2f32 2f33 220a 2020 2020 2020  = "1/2/3".      
+0001e170: 2020 2020 2020 655b 2269 6e73 7069 7265        e["inspire
+0001e180: 225d 203d 2022 220a 2020 2020 2020 2020  "] = "".        
+0001e190: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+0001e1a0: 616c 7365 2873 656c 662e 7042 4442 2e62  alse(self.pBDB.b
+0001e1b0: 6962 732e 6368 6563 6b4e 6565 6473 5570  ibs.checkNeedsUp
+0001e1c0: 6461 7465 2865 2929 0a20 2020 2020 2020  date(e)).       
+0001e1d0: 2020 2020 2065 5b22 696e 7370 6972 6522       e["inspire"
+0001e1e0: 5d20 3d20 4e6f 6e65 0a20 2020 2020 2020  ] = None.       
+0001e1f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001e200: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
+0001e210: 6269 6273 2e63 6865 636b 4e65 6564 7355  bibs.checkNeedsU
+0001e220: 7064 6174 6528 6529 290a 2020 2020 2020  pdate(e)).      
+0001e230: 2020 2020 2020 655b 2269 6e73 7069 7265        e["inspire
+0001e240: 225d 203d 2022 3132 3322 0a20 2020 2020  "] = "123".     
+0001e250: 2020 2020 2020 2065 5b22 6e6f 5570 6461         e["noUpda
+0001e260: 7465 225d 203d 2031 0a20 2020 2020 2020  te"] = 1.       
+0001e270: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001e280: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
+0001e290: 6269 6273 2e63 6865 636b 4e65 6564 7355  bibs.checkNeedsU
+0001e2a0: 7064 6174 6528 6529 290a 2020 2020 2020  pdate(e)).      
+0001e2b0: 2020 2020 2020 655b 226e 6f55 7064 6174        e["noUpdat
+0001e2c0: 6522 5d20 3d20 300a 2020 2020 2020 2020  e"] = 0.        
+0001e2d0: 2020 2020 655b 2270 6864 5f74 6865 7369      e["phd_thesi
+0001e2e0: 7322 5d20 3d20 310a 2020 2020 2020 2020  s"] = 1.        
+0001e2f0: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+0001e300: 616c 7365 2873 656c 662e 7042 4442 2e62  alse(self.pBDB.b
+0001e310: 6962 732e 6368 6563 6b4e 6565 6473 5570  ibs.checkNeedsUp
+0001e320: 6461 7465 2865 2929 0a20 2020 2020 2020  date(e)).       
+0001e330: 2020 2020 2065 5b22 7068 645f 7468 6573       e["phd_thes
+0001e340: 6973 225d 203d 2030 0a20 2020 2020 2020  is"] = 0.       
+0001e350: 2020 2020 2065 5b22 6c65 6374 7572 6522       e["lecture"
+0001e360: 5d20 3d20 310a 2020 2020 2020 2020 2020  ] = 1.          
+0001e370: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
+0001e380: 7365 2873 656c 662e 7042 4442 2e62 6962  se(self.pBDB.bib
+0001e390: 732e 6368 6563 6b4e 6565 6473 5570 6461  s.checkNeedsUpda
+0001e3a0: 7465 2865 2929 0a20 2020 2020 2020 2020  te(e)).         
+0001e3b0: 2020 2065 5b22 6c65 6374 7572 6522 5d20     e["lecture"] 
+0001e3c0: 3d20 300a 2020 2020 2020 2020 2020 2020  = 0.            
+0001e3d0: 655b 2262 6f6f 6b22 5d20 3d20 310a 2020  e["book"] = 1.  
+0001e3e0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0001e3f0: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
+0001e400: 7042 4442 2e62 6962 732e 6368 6563 6b4e  pBDB.bibs.checkN
+0001e410: 6565 6473 5570 6461 7465 2865 2929 0a20  eedsUpdate(e)). 
+0001e420: 2020 2020 2020 2020 2020 2065 5b22 626f             e["bo
+0001e430: 6f6b 225d 203d 2030 0a20 2020 2020 2020  ok"] = 0.       
+0001e440: 2020 2020 2065 5b22 7072 6f63 6565 6469       e["proceedi
+0001e450: 6e67 225d 203d 2031 0a20 2020 2020 2020  ng"] = 1.       
+0001e460: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001e470: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
+0001e480: 6269 6273 2e63 6865 636b 4e65 6564 7355  bibs.checkNeedsU
+0001e490: 7064 6174 6528 6529 290a 2020 2020 2020  pdate(e)).      
+0001e4a0: 2020 2020 2020 655b 2270 726f 6365 6564        e["proceed
+0001e4b0: 696e 6722 5d20 3d20 300a 2020 2020 2020  ing"] = 0.      
+0001e4c0: 2020 2020 2020 5f63 2e61 7373 6572 745f        _c.assert_
+0001e4d0: 6e6f 745f 6361 6c6c 6564 2829 0a0a 2020  not_called()..  
+0001e4e0: 2020 6465 6620 7465 7374 5f63 6974 6174    def test_citat
+0001e4f0: 696f 6e43 6f75 6e74 2873 656c 662c 202a  ionCount(self, *
+0001e500: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+0001e510: 2222 7465 7374 2063 6974 6174 696f 6e43  ""test citationC
+0001e520: 6f75 6e74 2222 220a 2020 2020 2020 2020  ount""".        
+0001e530: 7365 6c66 2e69 6e73 6572 745f 7468 7265  self.insert_thre
+0001e540: 6528 290a 2020 2020 2020 2020 7365 6c66  e().        self
+0001e550: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+0001e560: 6546 6965 6c64 2822 6162 6322 2c20 2269  eField("abc", "i
+0001e570: 6e73 7069 7265 222c 2022 3132 3334 3522  nspire", "12345"
+0001e580: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
+0001e590: 4244 422e 6269 6273 2e75 7064 6174 6546  BDB.bibs.updateF
+0001e5a0: 6965 6c64 2822 6465 6622 2c20 2269 6e73  ield("def", "ins
+0001e5b0: 7069 7265 222c 2022 3233 3435 3622 290a  pire", "23456").
+0001e5c0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0001e5d0: 422e 6269 6273 2e75 7064 6174 6546 6965  B.bibs.updateFie
+0001e5e0: 6c64 2822 6768 6922 2c20 2269 6e73 7069  ld("ghi", "inspi
+0001e5f0: 7265 222c 2022 3334 3536 3722 290a 2020  re", "34567").  
+0001e600: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+0001e610: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
+0001e620: 6879 7362 6962 6c69 6f2e 7765 6269 6d70  hysbiblio.webimp
+0001e630: 6f72 742e 696e 7370 6972 652e 5765 6253  ort.inspire.WebS
+0001e640: 6561 7263 682e 7265 7472 6965 7665 4261  earch.retrieveBa
+0001e650: 7463 6851 7565 7279 222c 0a20 2020 2020  tchQuery",.     
+0001e660: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
+0001e670: 6c75 653d 285b 5d2c 2030 292c 0a20 2020  lue=([], 0),.   
+0001e680: 2020 2020 2029 2061 7320 5f72 623a 0a20       ) as _rb:. 
+0001e690: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001e6a0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+0001e6b0: 2e70 4244 422e 6269 6273 2e63 6974 6174  .pBDB.bibs.citat
+0001e6c0: 696f 6e43 6f75 6e74 2822 3132 3334 3522  ionCount("12345"
+0001e6d0: 292c 2028 302c 2030 2c20 5b5d 2929 0a20  ), (0, 0, [])). 
+0001e6e0: 2020 2020 2020 2020 2020 205f 7262 2e61             _rb.a
+0001e6f0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+0001e700: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
+0001e710: 2020 2020 2020 2020 5b22 3132 3334 3522          ["12345"
+0001e720: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001e730: 2020 2073 6561 7263 6846 6f72 6d61 743d     searchFormat=
+0001e740: 2272 6563 6964 3a25 7322 2c0a 2020 2020  "recid:%s",.    
+0001e750: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
+0001e760: 6473 3d70 6879 7342 6962 6c69 6f57 6562  ds=physBiblioWeb
+0001e770: 2e77 6562 5365 6172 6368 5b22 696e 7370  .webSearch["insp
+0001e780: 6972 6522 5d2e 6d65 7461 6461 7461 4369  ire"].metadataCi
+0001e790: 7461 7469 6f6e 4669 656c 6473 2c0a 2020  tationFields,.  
+0001e7a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001e7b0: 2020 2020 706d 203d 204d 6167 6963 4d6f      pm = MagicMo
+0001e7c0: 636b 2829 0a20 2020 2020 2020 2070 7620  ck().        pv 
+0001e7d0: 3d20 4d61 6769 634d 6f63 6b28 290a 2020  = MagicMock().  
+0001e7e0: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+0001e7f0: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
+0001e800: 6879 7362 6962 6c69 6f2e 7765 6269 6d70  hysbiblio.webimp
+0001e810: 6f72 742e 696e 7370 6972 652e 5765 6253  ort.inspire.WebS
+0001e820: 6561 7263 682e 7265 7472 6965 7665 4261  earch.retrieveBa
+0001e830: 7463 6851 7565 7279 222c 0a20 2020 2020  tchQuery",.     
+0001e840: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
+0001e850: 6c75 653d 285b 2261 225d 2c20 3229 2c0a  lue=(["a"], 2),.
+0001e860: 2020 2020 2020 2020 2920 6173 205f 7262          ) as _rb
+0001e870: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
+0001e880: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+0001e890: 2e77 6562 696d 706f 7274 2e69 6e73 7069  .webimport.inspi
+0001e8a0: 7265 2e57 6562 5365 6172 6368 2e72 6561  re.WebSearch.rea
+0001e8b0: 6452 6563 6f72 6422 2c0a 2020 2020 2020  dRecord",.      
+0001e8c0: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
+0001e8d0: 7565 3d7b 2269 6422 3a20 2231 3233 3435  ue={"id": "12345
+0001e8e0: 222c 2022 6369 7422 3a20 3132 332c 2022  ", "cit": 123, "
+0001e8f0: 6369 745f 6e6f 5f73 656c 6622 3a20 3132  cit_no_self": 12
+0001e900: 307d 2c0a 2020 2020 2020 2020 2920 6173  0},.        ) as
+0001e910: 205f 7272 3a0a 2020 2020 2020 2020 2020   _rr:.          
+0001e920: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001e930: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0001e940: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0001e950: 6273 2e63 6974 6174 696f 6e43 6f75 6e74  bs.citationCount
+0001e960: 285b 2231 3233 3435 222c 2022 3233 3435  (["12345", "2345
+0001e970: 3622 5d2c 2070 624d 6178 3d70 6d2c 2070  6"], pbMax=pm, p
+0001e980: 6256 616c 3d70 7629 2c0a 2020 2020 2020  bVal=pv),.      
+0001e990: 2020 2020 2020 2020 2020 2831 2c20 302c            (1, 0,
+0001e9a0: 205b 2261 6263 225d 292c 0a20 2020 2020   ["abc"]),.     
+0001e9b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001e9c0: 2020 2020 205f 7262 2e61 7373 6572 745f       _rb.assert_
+0001e9d0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+0001e9e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001e9f0: 2020 5b22 3132 3334 3522 2c20 2232 3334    ["12345", "234
+0001ea00: 3536 225d 2c0a 2020 2020 2020 2020 2020  56"],.          
+0001ea10: 2020 2020 2020 7365 6172 6368 466f 726d        searchForm
+0001ea20: 6174 3d22 7265 6369 643a 2573 222c 0a20  at="recid:%s",. 
+0001ea30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001ea40: 6965 6c64 733d 7068 7973 4269 626c 696f  ields=physBiblio
+0001ea50: 5765 622e 7765 6253 6561 7263 685b 2269  Web.webSearch["i
+0001ea60: 6e73 7069 7265 225d 2e6d 6574 6164 6174  nspire"].metadat
+0001ea70: 6143 6974 6174 696f 6e46 6965 6c64 732c  aCitationFields,
+0001ea80: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001ea90: 2020 2020 2020 2020 2020 205f 7272 2e61             _rr.a
+0001eaa0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+0001eab0: 655f 7769 7468 2822 6122 2c20 6e6f 5761  e_with("a", noWa
+0001eac0: 726e 696e 673d 5472 7565 290a 2020 2020  rning=True).    
+0001ead0: 2020 2020 2020 2020 706d 2e61 7373 6572          pm.asser
+0001eae0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+0001eaf0: 7468 2832 290a 2020 2020 2020 2020 2020  th(2).          
+0001eb00: 2020 7076 2e61 7373 6572 745f 6361 6c6c    pv.assert_call
+0001eb10: 6564 5f6f 6e63 655f 7769 7468 2831 290a  ed_once_with(1).
+0001eb20: 2020 2020 2020 2020 2020 2020 6120 3d20              a = 
+0001eb30: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+0001eb40: 6574 4279 4269 626b 6579 2822 6162 6322  etByBibkey("abc"
+0001eb50: 295b 305d 0a20 2020 2020 2020 2020 2020  )[0].           
+0001eb60: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0001eb70: 6c28 615b 2263 6974 6174 696f 6e73 225d  l(a["citations"]
+0001eb80: 2c20 3132 3329 0a20 2020 2020 2020 2020  , 123).         
+0001eb90: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001eba0: 7561 6c28 615b 2263 6974 6174 696f 6e73  ual(a["citations
+0001ebb0: 5f6e 6f5f 7365 6c66 225d 2c20 3132 3029  _no_self"], 120)
+0001ebc0: 0a20 2020 2020 2020 2020 2020 2061 203d  .            a =
+0001ebd0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0001ebe0: 6765 7442 7942 6962 6b65 7928 2264 6566  getByBibkey("def
+0001ebf0: 2229 5b30 5d0a 2020 2020 2020 2020 2020  ")[0].          
+0001ec00: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001ec10: 616c 2861 5b22 6369 7461 7469 6f6e 7322  al(a["citations"
+0001ec20: 5d2c 2030 290a 2020 2020 2020 2020 2020  ], 0).          
+0001ec30: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001ec40: 616c 2861 5b22 6369 7461 7469 6f6e 735f  al(a["citations_
+0001ec50: 6e6f 5f73 656c 6622 5d2c 2030 290a 2020  no_self"], 0).  
+0001ec60: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+0001ec70: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
+0001ec80: 6879 7362 6962 6c69 6f2e 7765 6269 6d70  hysbiblio.webimp
+0001ec90: 6f72 742e 696e 7370 6972 652e 5765 6253  ort.inspire.WebS
+0001eca0: 6561 7263 682e 7265 7472 6965 7665 4261  earch.retrieveBa
+0001ecb0: 7463 6851 7565 7279 222c 0a20 2020 2020  tchQuery",.     
+0001ecc0: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
+0001ecd0: 6c75 653d 285b 2261 222c 2022 6222 2c20  lue=(["a", "b", 
+0001ece0: 2263 225d 2c20 3229 2c0a 2020 2020 2020  "c"], 2),.      
+0001ecf0: 2020 2920 6173 205f 7262 2c20 7061 7463    ) as _rb, patc
+0001ed00: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+0001ed10: 7068 7973 6269 626c 696f 2e77 6562 696d  physbiblio.webim
+0001ed20: 706f 7274 2e69 6e73 7069 7265 2e57 6562  port.inspire.Web
+0001ed30: 5365 6172 6368 2e72 6561 6452 6563 6f72  Search.readRecor
+0001ed40: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+0001ed50: 7369 6465 5f65 6666 6563 743d 280a 2020  side_effect=(.  
+0001ed60: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+0001ed70: 6964 223a 2022 3334 3536 3722 2c20 2263  id": "34567", "c
+0001ed80: 6974 223a 2031 2c20 2263 6974 5f6e 6f5f  it": 1, "cit_no_
+0001ed90: 7365 6c66 223a 2031 7d2c 0a20 2020 2020  self": 1},.     
+0001eda0: 2020 2020 2020 2020 2020 207b 2269 6422             {"id"
+0001edb0: 3a20 2230 3132 3334 222c 2022 6369 7422  : "01234", "cit"
+0001edc0: 3a20 3133 2c20 2263 6974 5f6e 6f5f 7365  : 13, "cit_no_se
+0001edd0: 6c66 223a 2031 7d2c 0a20 2020 2020 2020  lf": 1},.       
+0001ede0: 2020 2020 2020 2020 207b 2269 6422 3a20           {"id": 
+0001edf0: 2232 3334 3536 227d 2c0a 2020 2020 2020  "23456"},.      
+0001ee00: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0001ee10: 2029 2061 7320 5f72 723a 0a20 2020 2020   ) as _rr:.     
+0001ee20: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001ee30: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+0001ee40: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0001ee50: 4442 2e62 6962 732e 6369 7461 7469 6f6e  DB.bibs.citation
+0001ee60: 436f 756e 7428 5b22 3132 3334 3522 2c20  Count(["12345", 
+0001ee70: 2232 3334 3536 225d 2c20 7062 4d61 783d  "23456"], pbMax=
+0001ee80: 706d 2c20 7062 5661 6c3d 7076 292c 0a20  pm, pbVal=pv),. 
+0001ee90: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0001eea0: 332c 2031 2c20 5b22 6768 6922 5d29 2c0a  3, 1, ["ghi"]),.
+0001eeb0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001eec0: 2020 2020 2020 2020 2020 5f72 622e 6173            _rb.as
+0001eed0: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+0001eee0: 5f77 6974 6828 0a20 2020 2020 2020 2020  _with(.         
+0001eef0: 2020 2020 2020 205b 2231 3233 3435 222c         ["12345",
+0001ef00: 2022 3233 3435 3622 5d2c 0a20 2020 2020   "23456"],.     
+0001ef10: 2020 2020 2020 2020 2020 2073 6561 7263             searc
+0001ef20: 6846 6f72 6d61 743d 2272 6563 6964 3a25  hFormat="recid:%
+0001ef30: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+0001ef40: 2020 2020 6669 656c 6473 3d70 6879 7342      fields=physB
+0001ef50: 6962 6c69 6f57 6562 2e77 6562 5365 6172  iblioWeb.webSear
+0001ef60: 6368 5b22 696e 7370 6972 6522 5d2e 6d65  ch["inspire"].me
+0001ef70: 7461 6461 7461 4369 7461 7469 6f6e 4669  tadataCitationFi
+0001ef80: 656c 6473 2c0a 2020 2020 2020 2020 2020  elds,.          
+0001ef90: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001efa0: 5f72 722e 6173 7365 7274 5f61 6e79 5f63  _rr.assert_any_c
+0001efb0: 616c 6c28 2261 222c 206e 6f57 6172 6e69  all("a", noWarni
+0001efc0: 6e67 3d54 7275 6529 0a20 2020 2020 2020  ng=True).       
+0001efd0: 2020 2020 205f 7272 2e61 7373 6572 745f       _rr.assert_
+0001efe0: 616e 795f 6361 6c6c 2822 6222 2c20 6e6f  any_call("b", no
+0001eff0: 5761 726e 696e 673d 5472 7565 290a 2020  Warning=True).  
+0001f000: 2020 2020 2020 2020 2020 5f72 722e 6173            _rr.as
+0001f010: 7365 7274 5f61 6e79 5f63 616c 6c28 2263  sert_any_call("c
+0001f020: 222c 206e 6f57 6172 6e69 6e67 3d54 7275  ", noWarning=Tru
+0001f030: 6529 0a20 2020 2020 2020 2020 2020 2061  e).            a
+0001f040: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
+0001f050: 732e 6765 7442 7942 6962 6b65 7928 2261  s.getByBibkey("a
+0001f060: 6263 2229 5b30 5d0a 2020 2020 2020 2020  bc")[0].        
+0001f070: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001f080: 7175 616c 2861 5b22 6369 7461 7469 6f6e  qual(a["citation
+0001f090: 7322 5d2c 2031 3233 290a 2020 2020 2020  s"], 123).      
+0001f0a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001f0b0: 7445 7175 616c 2861 5b22 6369 7461 7469  tEqual(a["citati
+0001f0c0: 6f6e 735f 6e6f 5f73 656c 6622 5d2c 2031  ons_no_self"], 1
+0001f0d0: 3230 290a 2020 2020 2020 2020 2020 2020  20).            
+0001f0e0: 6120 3d20 7365 6c66 2e70 4244 422e 6269  a = self.pBDB.bi
+0001f0f0: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
+0001f100: 6465 6622 295b 305d 0a20 2020 2020 2020  def")[0].       
+0001f110: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001f120: 4571 7561 6c28 615b 2263 6974 6174 696f  Equal(a["citatio
+0001f130: 6e73 225d 2c20 3029 0a20 2020 2020 2020  ns"], 0).       
+0001f140: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001f150: 4571 7561 6c28 615b 2263 6974 6174 696f  Equal(a["citatio
+0001f160: 6e73 5f6e 6f5f 7365 6c66 225d 2c20 3029  ns_no_self"], 0)
+0001f170: 0a20 2020 2020 2020 2020 2020 2061 203d  .            a =
+0001f180: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0001f190: 6765 7442 7942 6962 6b65 7928 2267 6869  getByBibkey("ghi
+0001f1a0: 2229 5b30 5d0a 2020 2020 2020 2020 2020  ")[0].          
+0001f1b0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001f1c0: 616c 2861 5b22 6369 7461 7469 6f6e 7322  al(a["citations"
+0001f1d0: 5d2c 2031 290a 2020 2020 2020 2020 2020  ], 1).          
+0001f1e0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001f1f0: 616c 2861 5b22 6369 7461 7469 6f6e 735f  al(a["citations_
+0001f200: 6e6f 5f73 656c 6622 5d2c 2031 290a 0a20  no_self"], 1).. 
+0001f210: 2020 2064 6566 2074 6573 745f 636c 6561     def test_clea
+0001f220: 6e42 6962 7465 7828 7365 6c66 2c20 2a61  nBibtex(self, *a
+0001f230: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+0001f240: 2274 6573 7420 636c 6561 6e42 6962 7465  "test cleanBibte
+0001f250: 7822 2222 0a20 2020 2020 2020 2064 6220  x""".        db 
+0001f260: 3d20 6269 6274 6578 7061 7273 6572 2e62  = bibtexparser.b
+0001f270: 6962 6461 7461 6261 7365 2e42 6962 4461  ibdatabase.BibDa
+0001f280: 7461 6261 7365 2829 0a20 2020 2020 2020  tabase().       
+0001f290: 2062 203d 2027 4061 7274 6963 6c65 7b61   b = '@article{a
+0001f2a0: 6263 2c5c 6e61 7574 686f 723d 226d 6522  bc,\nauthor="me"
+0001f2b0: 2c5c 6e74 6974 6c65 3d22 7469 746c 6522  ,\ntitle="title"
+0001f2c0: 2c5c 6e7d 5c6e 270a 2020 2020 2020 2020  ,\n}\n'.        
+0001f2d0: 6462 2e65 6e74 7269 6573 203d 205b 7365  db.entries = [se
+0001f2e0: 6c66 2e70 4244 422e 6269 6273 2e72 6561  lf.pBDB.bibs.rea
+0001f2f0: 6445 6e74 7279 2862 295d 0a20 2020 2020  dEntry(b)].     
+0001f300: 2020 206e 203d 2073 656c 662e 7042 4442     n = self.pBDB
+0001f310: 2e62 6962 732e 6269 6274 6578 4672 6f6d  .bibs.bibtexFrom
+0001f320: 4442 2864 6229 0a20 2020 2020 2020 2077  DB(db).        w
+0001f330: 6974 6820 7061 7463 6828 0a20 2020 2020  ith patch(.     
+0001f340: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
+0001f350: 696f 2e64 6174 6162 6173 652e 456e 7472  io.database.Entr
+0001f360: 6965 732e 7570 6461 7465 4669 656c 6422  ies.updateField"
+0001f370: 2c20 7369 6465 5f65 6666 6563 743d 5b46  , side_effect=[F
+0001f380: 616c 7365 2c20 5472 7565 5d0a 2020 2020  alse, True].    
+0001f390: 2020 2020 2920 6173 205f 752c 2070 6174      ) as _u, pat
+0001f3a0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0001f3b0: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0001f3c0: 6261 7365 2e45 6e74 7269 6573 2e62 6962  base.Entries.bib
+0001f3d0: 7465 7846 726f 6d44 4222 2c20 7369 6465  texFromDB", side
+0001f3e0: 5f65 6666 6563 743d 5b62 2c20 6e2c 206e  _effect=[b, n, n
+0001f3f0: 5d0a 2020 2020 2020 2020 2920 6173 205f  ].        ) as _
+0001f400: 623a 0a20 2020 2020 2020 2020 2020 2073  b:.            s
+0001f410: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+0001f420: 7365 6c66 2e70 4244 422e 6269 6273 2e63  self.pBDB.bibs.c
+0001f430: 6c65 616e 4269 6274 6578 2822 6162 6322  leanBibtex("abc"
+0001f440: 2c20 622c 2064 623d 6462 2929 0a20 2020  , b, db=db)).   
+0001f450: 2020 2020 2020 2020 205f 622e 6173 7365           _b.asse
+0001f460: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+0001f470: 6974 6828 6462 290a 2020 2020 2020 2020  ith(db).        
+0001f480: 2020 2020 5f75 2e61 7373 6572 745f 6e6f      _u.assert_no
+0001f490: 745f 6361 6c6c 6564 2829 0a20 2020 2020  t_called().     
+0001f4a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001f4b0: 7274 4661 6c73 6528 7365 6c66 2e70 4244  rtFalse(self.pBD
+0001f4c0: 422e 6269 6273 2e63 6c65 616e 4269 6274  B.bibs.cleanBibt
+0001f4d0: 6578 2822 6162 6322 2c20 622c 2064 623d  ex("abc", b, db=
+0001f4e0: 6462 2929 0a20 2020 2020 2020 2020 2020  db)).           
+0001f4f0: 205f 752e 6173 7365 7274 5f63 616c 6c65   _u.assert_calle
+0001f500: 645f 6f6e 6365 5f77 6974 6828 2261 6263  d_once_with("abc
+0001f510: 222c 2022 6269 6274 6578 222c 206e 290a  ", "bibtex", n).
+0001f520: 2020 2020 2020 2020 2020 2020 5f75 2e72              _u.r
+0001f530: 6573 6574 5f6d 6f63 6b28 290a 2020 2020  eset_mock().    
+0001f540: 2020 2020 2020 2020 5f62 2e72 6573 6574          _b.reset
+0001f550: 5f6d 6f63 6b28 290a 2020 2020 2020 2020  _mock().        
+0001f560: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+0001f570: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
+0001f580: 6273 2e63 6c65 616e 4269 6274 6578 2822  bs.cleanBibtex("
+0001f590: 6162 6322 2c20 6229 290a 2020 2020 2020  abc", b)).      
+0001f5a0: 2020 2020 2020 5f75 2e61 7373 6572 745f        _u.assert_
+0001f5b0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+0001f5c0: 2822 6162 6322 2c20 2262 6962 7465 7822  ("abc", "bibtex"
+0001f5d0: 2c20 6e29 0a20 2020 2020 2020 2020 2020  , n).           
+0001f5e0: 2077 6974 6820 7365 6c66 2e61 7373 6572   with self.asser
+0001f5f0: 7452 6169 7365 7328 4173 7365 7274 696f  tRaises(Assertio
+0001f600: 6e45 7272 6f72 293a 0a20 2020 2020 2020  nError):.       
+0001f610: 2020 2020 2020 2020 205f 622e 6173 7365           _b.asse
+0001f620: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+0001f630: 6974 6828 6462 290a 0a20 2020 2064 6566  ith(db)..    def
+0001f640: 2074 6573 745f 636c 6561 6e42 6962 7465   test_cleanBibte
+0001f650: 7873 2873 656c 662c 202a 6172 6773 293a  xs(self, *args):
+0001f660: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
+0001f670: 2063 6c65 616e 4269 6274 6578 7322 2222   cleanBibtexs"""
+0001f680: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
+0001f690: 7365 7274 5f74 6872 6565 2829 0a20 2020  sert_three().   
+0001f6a0: 2020 2020 2062 6962 7465 7849 6e20 3d20       bibtexIn = 
+0001f6b0: 280a 2020 2020 2020 2020 2020 2020 2725  (.            '%
+0001f6c0: 636f 6d6d 656e 745c 6e40 6172 7469 636c  comment\n@articl
+0001f6d0: 657b 6162 632c 5c6e 5c6e 6175 7468 6f72  e{abc,\n\nauthor
+0001f6e0: 203d 2022 6d65 222c 5c6e 270a 2020 2020   = "me",\n'.    
+0001f6f0: 2020 2020 2020 2020 2b20 2774 6974 6c65          + 'title
+0001f700: 203d 2022 6162 5c6e 6322 2c5c 6e6a 6f75   = "ab\nc",\njou
+0001f710: 726e 616c 3d22 6a63 6170 222c 5c6e 766f  rnal="jcap",\nvo
+0001f720: 6c75 6d65 3d22 3138 3033 222c 5c6e 270a  lume="1803",\n'.
+0001f730: 2020 2020 2020 2020 2020 2020 2b20 2779              + 'y
+0001f740: 6561 723d 2232 3031 3822 2c5c 6e70 6167  ear="2018",\npag
+0001f750: 6573 3d22 3122 2c5c 6e61 7278 6976 3d22  es="1",\narxiv="
+0001f760: 3132 3334 2e35 3637 3839 222c 5c6e 7d27  1234.56789",\n}'
+0001f770: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0001f780: 2020 2062 6962 7465 784f 7574 203d 2028     bibtexOut = (
+0001f790: 0a20 2020 2020 2020 2020 2020 2027 4041  .            '@A
+0001f7a0: 7274 6963 6c65 7b61 6263 2c5c 6e20 2020  rticle{abc,\n   
+0001f7b0: 2020 2020 2061 7574 686f 7220 3d20 226d       author = "m
+0001f7c0: 6522 2c5c 6e20 2020 2020 2020 2020 270a  e",\n         '.
+0001f7d0: 2020 2020 2020 2020 2020 2020 2b20 2774              + 't
+0001f7e0: 6974 6c65 203d 2022 7b61 6220 637d 222c  itle = "{ab c}",
+0001f7f0: 5c6e 2020 2020 2020 206a 6f75 726e 616c  \n       journal
+0001f800: 203d 2022 6a63 6170 222c 5c6e 2020 2020   = "jcap",\n    
+0001f810: 2020 2020 270a 2020 2020 2020 2020 2020      '.          
+0001f820: 2020 2b20 2776 6f6c 756d 6520 3d20 2231    + 'volume = "1
+0001f830: 3830 3322 2c5c 6e20 2020 2020 2020 2020  803",\n         
+0001f840: 2079 6561 7220 3d20 2232 3031 3822 2c5c   year = "2018",\
+0001f850: 6e20 2020 2020 2020 2020 270a 2020 2020  n         '.    
+0001f860: 2020 2020 2020 2020 2b20 2770 6167 6573          + 'pages
+0001f870: 203d 2022 3122 2c5c 6e20 2020 2020 2020   = "1",\n       
+0001f880: 2020 6172 7869 7620 3d20 2231 3233 342e    arxiv = "1234.
+0001f890: 3536 3738 3922 2c5c 6e7d 270a 2020 2020  56789",\n}'.    
+0001f8a0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+0001f8b0: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
+0001f8c0: 6174 6546 6965 6c64 2822 6162 6322 2c20  ateField("abc", 
+0001f8d0: 2262 6962 7465 7822 2c20 6269 6274 6578  "bibtex", bibtex
+0001f8e0: 496e 290a 2020 2020 2020 2020 7769 7468  In).        with
+0001f8f0: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
+0001f900: 4c6f 6767 6572 2e69 6e66 6f22 2920 6173  Logger.info") as
+0001f910: 205f 693a 0a20 2020 2020 2020 2020 2020   _i:.           
+0001f920: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0001f930: 636c 6561 6e42 6962 7465 7873 2873 7461  cleanBibtexs(sta
+0001f940: 7274 4672 6f6d 3d31 290a 2020 2020 2020  rtFrom=1).      
+0001f950: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
+0001f960: 616e 795f 6361 6c6c 2822 436c 6561 6e42  any_call("CleanB
+0001f970: 6962 7465 7873 2077 696c 6c20 7072 6f63  ibtexs will proc
+0001f980: 6573 7320 3220 746f 7461 6c20 656e 7472  ess 2 total entr
+0001f990: 6965 7322 290a 2020 2020 2020 2020 7365  ies").        se
+0001f9a0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+0001f9b0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+0001f9c0: 7446 6965 6c64 2822 6162 6322 2c20 2262  tField("abc", "b
+0001f9d0: 6962 7465 7822 292c 2062 6962 7465 7849  ibtex"), bibtexI
+0001f9e0: 6e29 0a20 2020 2020 2020 2070 626d 203d  n).        pbm =
+0001f9f0: 204d 6167 6963 4d6f 636b 2829 0a20 2020   MagicMock().   
+0001fa00: 2020 2020 2070 6276 203d 204d 6167 6963       pbv = Magic
+0001fa10: 4d6f 636b 2829 0a20 2020 2020 2020 2077  Mock().        w
+0001fa20: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
+0001fa30: 6e67 2e4c 6f67 6765 722e 696e 666f 2229  ng.Logger.info")
+0001fa40: 2061 7320 5f69 3a0a 2020 2020 2020 2020   as _i:.        
+0001fa50: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0001fa60: 6273 2e63 6c65 616e 4269 6274 6578 7328  bs.cleanBibtexs(
+0001fa70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fa80: 2065 6e74 7269 6573 3d73 656c 662e 7042   entries=self.pB
+0001fa90: 4442 2e62 6962 732e 6765 7442 7942 6962  DB.bibs.getByBib
+0001faa0: 6b65 7928 2264 6566 2229 2c20 7062 4d61  key("def"), pbMa
+0001fab0: 783d 7062 6d2c 2070 6256 616c 3d70 6276  x=pbm, pbVal=pbv
+0001fac0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001fad0: 2020 2020 2020 2020 2020 205f 692e 6173             _i.as
+0001fae0: 7365 7274 5f61 6e79 5f63 616c 6c28 2243  sert_any_call("C
+0001faf0: 6c65 616e 4269 6274 6578 7320 7769 6c6c  leanBibtexs will
+0001fb00: 2070 726f 6365 7373 2031 2074 6f74 616c   process 1 total
+0001fb10: 2065 6e74 7269 6573 2229 0a20 2020 2020   entries").     
+0001fb20: 2020 2070 626d 2e61 7373 6572 745f 6361     pbm.assert_ca
+0001fb30: 6c6c 6564 5f6f 6e63 655f 7769 7468 2831  lled_once_with(1
+0001fb40: 290a 2020 2020 2020 2020 7062 762e 6173  ).        pbv.as
+0001fb50: 7365 7274 5f68 6173 5f63 616c 6c73 285b  sert_has_calls([
+0001fb60: 6361 6c6c 2831 295d 290a 2020 2020 2020  call(1)]).      
+0001fb70: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001fb80: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
+0001fb90: 732e 6765 7446 6965 6c64 2822 6162 6322  s.getField("abc"
+0001fba0: 2c20 2262 6962 7465 7822 292c 2062 6962  , "bibtex"), bib
+0001fbb0: 7465 7849 6e29 0a20 2020 2020 2020 2077  texIn).        w
+0001fbc0: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
+0001fbd0: 6e67 2e4c 6f67 6765 722e 6578 6365 7074  ng.Logger.except
+0001fbe0: 696f 6e22 2920 6173 205f 653a 0a20 2020  ion") as _e:.   
+0001fbf0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0001fc00: 4442 2e62 6962 732e 636c 6561 6e42 6962  DB.bibs.cleanBib
+0001fc10: 7465 7873 2873 7461 7274 4672 6f6d 3d22  texs(startFrom="
+0001fc20: 6122 292c 0a20 2020 2020 2020 2020 2020  a"),.           
+0001fc30: 205f 652e 6173 7365 7274 5f61 6e79 5f63   _e.assert_any_c
+0001fc40: 616c 6c28 2249 6e76 616c 6964 2073 7461  all("Invalid sta
+0001fc50: 7274 4672 6f6d 2069 6e20 636c 6561 6e42  rtFrom in cleanB
+0001fc60: 6962 7465 7873 2229 0a20 2020 2020 2020  ibtexs").       
+0001fc70: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0001fc80: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+0001fc90: 2e63 6c65 616e 4269 6274 6578 7328 7374  .cleanBibtexs(st
+0001fca0: 6172 7446 726f 6d3d 3529 2c20 2830 2c20  artFrom=5), (0, 
+0001fcb0: 302c 205b 5d29 290a 0a20 2020 2020 2020  0, []))..       
+0001fcc0: 2077 6974 6820 7061 7463 6828 226c 6f67   with patch("log
+0001fcd0: 6769 6e67 2e4c 6f67 6765 722e 696e 666f  ging.Logger.info
+0001fce0: 2229 2061 7320 5f69 3a0a 2020 2020 2020  ") as _i:.      
+0001fcf0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0001fd00: 6269 6273 2e63 6c65 616e 4269 6274 6578  bibs.cleanBibtex
+0001fd10: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0001fd20: 5f69 2e61 7373 6572 745f 616e 795f 6361  _i.assert_any_ca
+0001fd30: 6c6c 2822 436c 6561 6e42 6962 7465 7873  ll("CleanBibtexs
+0001fd40: 2077 696c 6c20 7072 6f63 6573 7320 3320   will process 3 
+0001fd50: 746f 7461 6c20 656e 7472 6965 7322 290a  total entries").
+0001fd60: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0001fd70: 422e 6269 6273 2e75 7064 6174 6546 6965  B.bibs.updateFie
+0001fd80: 6c64 2822 6162 6322 2c20 2262 6962 7465  ld("abc", "bibte
+0001fd90: 7822 2c20 6269 6274 6578 496e 290a 2020  x", bibtexIn).  
+0001fda0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001fdb0: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
+0001fdc0: 2e62 6962 732e 636c 6561 6e42 6962 7465  .bibs.cleanBibte
+0001fdd0: 7873 2829 2c20 2833 2c20 302c 205b 2261  xs(), (3, 0, ["a
+0001fde0: 6263 225d 2929 0a20 2020 2020 2020 2073  bc"])).        s
+0001fdf0: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
+0001fe00: 6461 7465 4669 656c 6428 2261 6263 222c  dateField("abc",
+0001fe10: 2022 6269 6274 6578 222c 2062 6962 7465   "bibtex", bibte
+0001fe20: 7849 6e29 0a20 2020 2020 2020 2070 626d  xIn).        pbm
+0001fe30: 203d 204d 6167 6963 4d6f 636b 2829 0a20   = MagicMock(). 
+0001fe40: 2020 2020 2020 2070 6276 203d 204d 6167         pbv = Mag
+0001fe50: 6963 4d6f 636b 2829 0a20 2020 2020 2020  icMock().       
+0001fe60: 2077 6974 6820 7061 7463 6828 226c 6f67   with patch("log
+0001fe70: 6769 6e67 2e4c 6f67 6765 722e 696e 666f  ging.Logger.info
+0001fe80: 2229 2061 7320 5f69 3a0a 2020 2020 2020  ") as _i:.      
+0001fe90: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0001fea0: 6269 6273 2e63 6c65 616e 4269 6274 6578  bibs.cleanBibtex
+0001feb0: 7328 7062 4d61 783d 7062 6d2c 2070 6256  s(pbMax=pbm, pbV
+0001fec0: 616c 3d70 6276 290a 2020 2020 2020 2020  al=pbv).        
+0001fed0: 2020 2020 5f69 2e61 7373 6572 745f 6861      _i.assert_ha
+0001fee0: 735f 6361 6c6c 7328 0a20 2020 2020 2020  s_calls(.       
+0001fef0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0001ff00: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001ff10: 616c 6c28 2233 2065 6e74 7269 6573 2070  all("3 entries p
+0001ff20: 726f 6365 7373 6564 2229 2c0a 2020 2020  rocessed"),.    
+0001ff30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ff40: 6361 6c6c 2822 3020 6572 726f 7273 206f  call("0 errors o
+0001ff50: 6363 7572 7265 6422 292c 0a20 2020 2020  ccurred"),.     
+0001ff60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001ff70: 616c 6c28 2231 2062 6962 7465 7820 656e  all("1 bibtex en
+0001ff80: 7472 6965 7320 6368 616e 6765 6422 292c  tries changed"),
+0001ff90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ffa0: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
+0001ffb0: 0a20 2020 2020 2020 2070 626d 2e61 7373  .        pbm.ass
+0001ffc0: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+0001ffd0: 7769 7468 2833 290a 2020 2020 2020 2020  with(3).        
+0001ffe0: 7062 762e 6173 7365 7274 5f68 6173 5f63  pbv.assert_has_c
+0001fff0: 616c 6c73 285b 6361 6c6c 2831 292c 2063  alls([call(1), c
+00020000: 616c 6c28 3229 2c20 6361 6c6c 2833 295d  all(2), call(3)]
+00020010: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00020020: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+00020030: 7042 4442 2e62 6962 732e 6765 7446 6965  pBDB.bibs.getFie
+00020040: 6c64 2822 6162 6322 2c20 2262 6962 7465  ld("abc", "bibte
+00020050: 7822 292c 2062 6962 7465 784f 7574 290a  x"), bibtexOut).
+00020060: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+00020070: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
+00020080: 656c 6428 2264 6566 222c 2022 6269 6274  eld("def", "bibt
+00020090: 6578 222c 2027 4062 6f6f 6b7b 6465 662c  ex", '@book{def,
+000200a0: 5c6e 7469 746c 653d 2273 6f6d 6522 2c27  \ntitle="some",'
+000200b0: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+000200c0: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
+000200d0: 6767 6572 2e77 6172 6e69 6e67 2229 2061  gger.warning") a
+000200e0: 7320 5f69 3a0a 2020 2020 2020 2020 2020  s _i:.          
+000200f0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00020100: 2e63 6c65 616e 4269 6274 6578 7328 290a  .cleanBibtexs().
+00020110: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
+00020120: 7373 6572 745f 616e 795f 6361 6c6c 2822  ssert_any_call("
+00020130: 4572 726f 7220 7768 696c 6520 636c 6561  Error while clea
+00020140: 6e69 6e67 2065 6e74 7279 2027 6465 6627  ning entry 'def'
+00020150: 222c 2065 7863 5f69 6e66 6f3d 5472 7565  ", exc_info=True
+00020160: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+00020170: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
+00020180: 6767 6572 2e69 6e66 6f22 2920 6173 205f  gger.info") as _
+00020190: 693a 0a20 2020 2020 2020 2020 2020 2073  i:.            s
+000201a0: 656c 662e 7042 4442 2e62 6962 732e 636c  elf.pBDB.bibs.cl
+000201b0: 6561 6e42 6962 7465 7873 2829 0a20 2020  eanBibtexs().   
+000201c0: 2020 2020 2020 2020 205f 692e 6173 7365           _i.asse
+000201d0: 7274 5f68 6173 5f63 616c 6c73 280a 2020  rt_has_calls(.  
+000201e0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+000201f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020200: 2020 2020 6361 6c6c 2822 3320 656e 7472      call("3 entr
+00020210: 6965 7320 7072 6f63 6573 7365 6422 292c  ies processed"),
+00020220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020230: 2020 2020 2063 616c 6c28 2231 2065 7272       call("1 err
+00020240: 6f72 7320 6f63 6375 7272 6564 2229 2c0a  ors occurred"),.
+00020250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020260: 2020 2020 6361 6c6c 2822 3020 6269 6274      call("0 bibt
+00020270: 6578 2065 6e74 7269 6573 2063 6861 6e67  ex entries chang
+00020280: 6564 2229 2c0a 2020 2020 2020 2020 2020  ed"),.          
+00020290: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+000202a0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+000202b0: 6c66 2e70 4244 422e 6269 6273 2e63 6c65  lf.pBDB.bibs.cle
+000202c0: 616e 4269 6274 6578 7328 290a 0a20 2020  anBibtexs()..   
+000202d0: 2064 6566 2074 6573 745f 636c 6561 6e46   def test_cleanF
+000202e0: 6965 6c64 7328 7365 6c66 2c20 2a61 7267  ields(self, *arg
+000202f0: 7329 3a0a 2020 2020 2020 2020 2222 2274  s):.        """t
+00020300: 6573 7420 636c 6561 6e46 6965 6c64 7322  est cleanFields"
+00020310: 2222 0a20 2020 2020 2020 2077 6974 6820  "".        with 
+00020320: 7061 7463 6828 2270 6879 7362 6962 6c69  patch("physbibli
+00020330: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
+00020340: 6573 2e75 7064 6174 6546 6965 6c64 2229  es.updateField")
+00020350: 2061 7320 5f75 3a0a 2020 2020 2020 2020   as _u:.        
+00020360: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00020370: 6273 2e63 6c65 616e 4669 656c 6473 280a  bs.cleanFields(.
+00020380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020390: 7b22 6269 626b 6579 223a 2022 6162 6322  {"bibkey": "abc"
+000203a0: 2c20 226d 6172 6b73 223a 204e 6f6e 652c  , "marks": None,
+000203b0: 2022 6f6c 645f 6b65 7973 223a 204e 6f6e   "old_keys": Non
+000203c0: 652c 2022 6269 6274 6578 223a 204e 6f6e  e, "bibtex": Non
+000203d0: 657d 0a20 2020 2020 2020 2020 2020 2029  e}.            )
+000203e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000203f0: 662e 6173 7365 7274 4571 7561 6c28 5f75  f.assertEqual(_u
+00020400: 2e63 616c 6c5f 636f 756e 742c 2032 290a  .call_count, 2).
+00020410: 2020 2020 2020 2020 2020 2020 5f75 2e61              _u.a
+00020420: 7373 6572 745f 616e 795f 6361 6c6c 2822  ssert_any_call("
+00020430: 6162 6322 2c20 226d 6172 6b73 222c 2022  abc", "marks", "
+00020440: 2229 0a20 2020 2020 2020 2020 2020 205f  ").            _
+00020450: 752e 6173 7365 7274 5f61 6e79 5f63 616c  u.assert_any_cal
+00020460: 6c28 2261 6263 222c 2022 6f6c 645f 6b65  l("abc", "old_ke
+00020470: 7973 222c 2022 2229 0a20 2020 2020 2020  ys", "").       
+00020480: 2020 2020 205f 752e 7265 7365 745f 6d6f       _u.reset_mo
+00020490: 636b 2829 0a20 2020 2020 2020 2020 2020  ck().           
+000204a0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+000204b0: 636c 6561 6e46 6965 6c64 7328 0a20 2020  cleanFields(.   
+000204c0: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
+000204d0: 6962 6b65 7922 3a20 2261 6263 222c 2022  ibkey": "abc", "
+000204e0: 6d61 726b 7322 3a20 2261 6222 2c20 226f  marks": "ab", "o
+000204f0: 6c64 5f6b 6579 7322 3a20 2263 6422 2c20  ld_keys": "cd", 
+00020500: 2262 6962 7465 7822 3a20 4e6f 6e65 7d0a  "bibtex": None}.
+00020510: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00020520: 2020 2020 2020 2020 2020 5f75 2e61 7373            _u.ass
+00020530: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+00020540: 0a20 2020 2020 2020 2020 2020 205f 752e  .            _u.
+00020550: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
+00020560: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00020570: 4442 2e62 6962 732e 636c 6561 6e46 6965  DB.bibs.cleanFie
+00020580: 6c64 7328 0a20 2020 2020 2020 2020 2020  lds(.           
+00020590: 2020 2020 207b 2262 6962 6b65 7922 3a20       {"bibkey": 
+000205a0: 2261 6263 222c 2022 6d61 726b 7322 3a20  "abc", "marks": 
+000205b0: 2261 2762 222c 2022 6f6c 645f 6b65 7973  "a'b", "old_keys
+000205c0: 223a 2022 6364 222c 2022 6269 6274 6578  ": "cd", "bibtex
+000205d0: 223a 204e 6f6e 657d 0a20 2020 2020 2020  ": None}.       
+000205e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000205f0: 2020 205f 752e 6173 7365 7274 5f63 616c     _u.assert_cal
+00020600: 6c65 645f 6f6e 6365 5f77 6974 6828 2261  led_once_with("a
+00020610: 6263 222c 2022 6d61 726b 7322 2c20 2261  bc", "marks", "a
+00020620: 6222 290a 2020 2020 2020 2020 2020 2020  b").            
+00020630: 5f75 2e72 6573 6574 5f6d 6f63 6b28 290a  _u.reset_mock().
+00020640: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00020650: 2e70 4244 422e 6269 6273 2e63 6c65 616e  .pBDB.bibs.clean
+00020660: 4669 656c 6473 280a 2020 2020 2020 2020  Fields(.        
+00020670: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00020680: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+00020690: 6962 6b65 7922 3a20 2261 6263 222c 0a20  ibkey": "abc",. 
+000206a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000206b0: 2020 2022 6d61 726b 7322 3a20 2261 2762     "marks": "a'b
+000206c0: 2c61 622c 6364 2c63 2764 222c 0a20 2020  ,ab,cd,c'd",.   
 000206d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000206e0: 2020 2020 2262 6962 6b65 7922 3a20 2261      "bibkey": "a
-000206f0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
-00020700: 2020 2020 2020 2020 2022 6d61 726b 7322           "marks"
-00020710: 3a20 2261 2762 2c61 622c 6364 2c63 2764  : "a'b,ab,cd,c'd
-00020720: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00020730: 2020 2020 2020 2022 6f6c 645f 6b65 7973         "old_keys
-00020740: 223a 2022 6364 222c 0a20 2020 2020 2020  ": "cd",.       
-00020750: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
-00020760: 6274 6578 223a 204e 6f6e 652c 0a20 2020  btex": None,.   
-00020770: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-00020780: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00020790: 2020 2020 2020 2020 205f 752e 6173 7365           _u.asse
-000207a0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-000207b0: 6974 6828 2261 6263 222c 2022 6d61 726b  ith("abc", "mark
-000207c0: 7322 2c20 2261 622c 6364 2229 0a0a 2020  s", "ab,cd")..  
-000207d0: 2020 6465 6620 7465 7374 5f63 6f6d 706c    def test_compl
-000207e0: 6574 6546 6574 6368 6564 2873 656c 662c  eteFetched(self,
-000207f0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-00020800: 2073 656c 662e 6d61 7844 6966 6620 3d20   self.maxDiff = 
-00020810: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
-00020820: 662e 6173 7365 7274 5472 7565 280a 2020  f.assertTrue(.  
-00020830: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00020840: 4244 422e 6269 6273 2e69 6e73 6572 7446  BDB.bibs.insertF
-00020850: 726f 6d42 6962 7465 7828 0a20 2020 2020  romBibtex(.     
-00020860: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-00020870: 6963 6c65 7b61 6263 2c5c 6e61 7574 686f  icle{abc,\nautho
-00020880: 7220 3d20 226d 6522 2c5c 6e27 0a20 2020  r = "me",\n'.   
-00020890: 2020 2020 2020 2020 2020 2020 202b 2027               + '
-000208a0: 7469 746c 6520 3d20 2261 6263 222c 5c6e  title = "abc",\n
-000208b0: 6a6f 7572 6e61 6c3d 226a 6361 7022 2c5c  journal="jcap",\
-000208c0: 6e76 6f6c 756d 653d 2233 222c 5c6e 270a  nvolume="3",\n'.
-000208d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000208e0: 2b20 2779 6561 723d 2232 3031 3822 2c5c  + 'year="2018",\
-000208f0: 6e70 6167 6573 3d22 3122 2c5c 6e61 7278  npages="1",\narx
-00020900: 6976 3d22 3132 3334 2e35 3637 3839 222c  iv="1234.56789",
-00020910: 5c6e 7d27 0a20 2020 2020 2020 2020 2020  \n}'.           
-00020920: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
-00020930: 2020 2020 2066 6574 6368 6564 203d 2073       fetched = s
-00020940: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-00020950: 7442 7942 6962 6b65 7928 2261 6263 2229  tByBibkey("abc")
-00020960: 0a20 2020 2020 2020 2063 6f6d 706c 6574  .        complet
-00020970: 6564 203d 2073 656c 662e 7042 4442 2e62  ed = self.pBDB.b
-00020980: 6962 732e 636f 6d70 6c65 7465 4665 7463  ibs.completeFetc
-00020990: 6865 6428 6665 7463 6865 6429 5b30 5d0a  hed(fetched)[0].
-000209a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000209b0: 6572 7445 7175 616c 2863 6f6d 706c 6574  ertEqual(complet
-000209c0: 6564 5b22 6175 7468 6f72 225d 2c20 226d  ed["author"], "m
-000209d0: 6522 290a 2020 2020 2020 2020 7365 6c66  e").        self
-000209e0: 2e61 7373 6572 7445 7175 616c 2863 6f6d  .assertEqual(com
-000209f0: 706c 6574 6564 5b22 7469 746c 6522 5d2c  pleted["title"],
-00020a00: 2022 7b61 6263 7d22 290a 2020 2020 2020   "{abc}").      
-00020a10: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00020a20: 616c 2863 6f6d 706c 6574 6564 5b22 6a6f  al(completed["jo
-00020a30: 7572 6e61 6c22 5d2c 2022 6a63 6170 2229  urnal"], "jcap")
-00020a40: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00020a50: 7365 7274 4571 7561 6c28 636f 6d70 6c65  sertEqual(comple
-00020a60: 7465 645b 2276 6f6c 756d 6522 5d2c 2022  ted["volume"], "
-00020a70: 3322 290a 2020 2020 2020 2020 7365 6c66  3").        self
-00020a80: 2e61 7373 6572 7445 7175 616c 2863 6f6d  .assertEqual(com
-00020a90: 706c 6574 6564 5b22 7965 6172 225d 2c20  pleted["year"], 
-00020aa0: 2232 3031 3822 290a 2020 2020 2020 2020  "2018").        
-00020ab0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00020ac0: 2863 6f6d 706c 6574 6564 5b22 7061 6765  (completed["page
-00020ad0: 7322 5d2c 2022 3122 290a 2020 2020 2020  s"], "1").      
-00020ae0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00020af0: 616c 2863 6f6d 706c 6574 6564 5b22 7075  al(completed["pu
-00020b00: 626c 6973 6865 6422 5d2c 2022 6a63 6170  blished"], "jcap
-00020b10: 2033 2028 3230 3138 2920 3122 290a 2020   3 (2018) 1").  
-00020b20: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00020b30: 7445 7175 616c 2863 6f6d 706c 6574 6564  tEqual(completed
-00020b40: 5b22 6269 6264 6963 7422 5d2c 2063 6f6d  ["bibdict"], com
-00020b50: 706c 6574 6564 5b22 6269 6274 6578 4469  pleted["bibtexDi
-00020b60: 6374 225d 290a 0a20 2020 2020 2020 2073  ct"])..        s
-00020b70: 656c 662e 7042 4442 2e75 6e64 6f28 7665  elf.pBDB.undo(ve
-00020b80: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
-00020b90: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00020ba0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00020bb0: 6c66 2e70 4244 422e 6269 6273 2e69 6e73  lf.pBDB.bibs.ins
-00020bc0: 6572 7446 726f 6d42 6962 7465 7828 0a20  ertFromBibtex(. 
-00020bd0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00020be0: 4061 7274 6963 6c65 7b61 6263 2c5c 6e61  @article{abc,\na
-00020bf0: 7574 686f 7220 3d20 226d 6520 616e 6420  uthor = "me and 
-00020c00: 796f 7520 616e 6420 6869 6d20 616e 6420  you and him and 
-00020c10: 7468 656d 222c 270a 2020 2020 2020 2020  them",'.        
-00020c20: 2020 2020 2020 2020 2b20 275c 6e74 6974          + '\ntit
-00020c30: 6c65 203d 2022 6162 6322 2c5c 6e79 6561  le = "abc",\nyea
-00020c40: 723d 2232 3032 3122 2c5c 6e7d 270a 2020  r="2021",\n}'.  
-00020c50: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00020c60: 2020 2020 290a 2020 2020 2020 2020 6665      ).        fe
-00020c70: 7463 6865 6420 3d20 7365 6c66 2e70 4244  tched = self.pBD
-00020c80: 422e 6269 6273 2e67 6574 4279 4269 626b  B.bibs.getByBibk
-00020c90: 6579 2822 6162 6322 290a 2020 2020 2020  ey("abc").      
-00020ca0: 2020 636f 6d70 6c65 7465 6420 3d20 7365    completed = se
-00020cb0: 6c66 2e70 4244 422e 6269 6273 2e63 6f6d  lf.pBDB.bibs.com
-00020cc0: 706c 6574 6546 6574 6368 6564 2866 6574  pleteFetched(fet
-00020cd0: 6368 6564 295b 305d 0a20 2020 2020 2020  ched)[0].       
-00020ce0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00020cf0: 6c28 636f 6d70 6c65 7465 645b 2261 7574  l(completed["aut
-00020d00: 686f 7222 5d2c 2022 6d65 2065 7420 616c  hor"], "me et al
-00020d10: 2e22 290a 2020 2020 2020 2020 7365 6c66  .").        self
-00020d20: 2e61 7373 6572 7445 7175 616c 2863 6f6d  .assertEqual(com
-00020d30: 706c 6574 6564 5b22 7469 746c 6522 5d2c  pleted["title"],
-00020d40: 2022 7b61 6263 7d22 290a 2020 2020 2020   "{abc}").      
-00020d50: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00020d60: 616c 2863 6f6d 706c 6574 6564 5b22 6a6f  al(completed["jo
-00020d70: 7572 6e61 6c22 5d2c 2022 2229 0a20 2020  urnal"], "").   
-00020d80: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00020d90: 4571 7561 6c28 636f 6d70 6c65 7465 645b  Equal(completed[
-00020da0: 2276 6f6c 756d 6522 5d2c 2022 2229 0a20  "volume"], ""). 
-00020db0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00020dc0: 7274 4571 7561 6c28 636f 6d70 6c65 7465  rtEqual(complete
-00020dd0: 645b 2279 6561 7222 5d2c 2022 3230 3231  d["year"], "2021
-00020de0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00020df0: 6173 7365 7274 4571 7561 6c28 636f 6d70  assertEqual(comp
-00020e00: 6c65 7465 645b 2270 6167 6573 225d 2c20  leted["pages"], 
-00020e10: 2222 290a 2020 2020 2020 2020 7365 6c66  "").        self
-00020e20: 2e61 7373 6572 7445 7175 616c 2863 6f6d  .assertEqual(com
-00020e30: 706c 6574 6564 5b22 7075 626c 6973 6865  pleted["publishe
-00020e40: 6422 5d2c 2022 2229 0a20 2020 2020 2020  d"], "").       
-00020e50: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00020e60: 6c28 636f 6d70 6c65 7465 645b 2262 6962  l(completed["bib
-00020e70: 6469 6374 225d 2c20 636f 6d70 6c65 7465  dict"], complete
-00020e80: 645b 2262 6962 7465 7844 6963 7422 5d29  d["bibtexDict"])
-00020e90: 0a0a 2020 2020 2020 2020 6461 7461 203d  ..        data =
-00020ea0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00020eb0: 7072 6570 6172 6549 6e73 6572 7428 0a20  prepareInsert(. 
-00020ec0: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-00020ed0: 6963 6c65 7b64 6566 2c5c 6e61 7574 686f  icle{def,\nautho
-00020ee0: 7220 3d20 226d 6522 2c5c 6e74 6974 6c65  r = "me",\ntitle
-00020ef0: 203d 2022 6465 6622 2c7d 270a 2020 2020   = "def",}'.    
-00020f00: 2020 2020 290a 2020 2020 2020 2020 6461      ).        da
-00020f10: 7461 5b22 6269 6274 6578 225d 203d 2027  ta["bibtex"] = '
-00020f20: 4061 7274 6963 6c65 7b61 6263 2c5c 6e61  @article{abc,\na
-00020f30: 7574 686f 7220 3d20 226d 6522 2c5c 6e74  uthor = "me",\nt
-00020f40: 6974 6c65 203d 2022 6465 2266 222c 7d27  itle = "de"f",}'
-00020f50: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00020f60: 7365 7274 5472 7565 2873 656c 662e 7042  sertTrue(self.pB
-00020f70: 4442 2e62 6962 732e 696e 7365 7274 2864  DB.bibs.insert(d
-00020f80: 6174 6129 290a 2020 2020 2020 2020 6665  ata)).        fe
-00020f90: 7463 6865 6420 3d20 7365 6c66 2e70 4244  tched = self.pBD
-00020fa0: 422e 6269 6273 2e67 6574 416c 6c28 290a  B.bibs.getAll().
-00020fb0: 2020 2020 2020 2020 636f 6d70 6c65 7465          complete
-00020fc0: 6420 3d20 7365 6c66 2e70 4244 422e 6269  d = self.pBDB.bi
-00020fd0: 6273 2e63 6f6d 706c 6574 6546 6574 6368  bs.completeFetch
-00020fe0: 6564 2866 6574 6368 6564 290a 2020 2020  ed(fetched).    
-00020ff0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00021000: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00021010: 2020 636f 6d70 6c65 7465 645b 305d 5b22    completed[0]["
-00021020: 6269 6274 6578 4469 6374 225d 2c0a 2020  bibtexDict"],.  
-00021030: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00021040: 2020 2020 2020 2020 2020 2020 2245 4e54              "ENT
-00021050: 5259 5459 5045 223a 2022 6172 7469 636c  RYTYPE": "articl
-00021060: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00021070: 2020 2020 2249 4422 3a20 2261 6263 222c      "ID": "abc",
-00021080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021090: 2022 6175 7468 6f72 223a 2022 6d65 2061   "author": "me a
-000210a0: 6e64 2079 6f75 2061 6e64 2068 696d 2061  nd you and him a
-000210b0: 6e64 2074 6865 6d22 2c0a 2020 2020 2020  nd them",.      
-000210c0: 2020 2020 2020 2020 2020 2274 6974 6c65            "title
-000210d0: 223a 2022 7b61 6263 7d22 2c0a 2020 2020  ": "{abc}",.    
-000210e0: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
-000210f0: 7222 3a20 2232 3032 3122 2c0a 2020 2020  r": "2021",.    
-00021100: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-00021110: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00021120: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00021130: 2020 2020 2020 2020 2020 2063 6f6d 706c             compl
-00021140: 6574 6564 5b31 5d5b 2262 6962 7465 7844  eted[1]["bibtexD
-00021150: 6963 7422 5d2c 0a20 2020 2020 2020 2020  ict"],.         
-00021160: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-00021170: 2020 2020 2022 454e 5452 5954 5950 4522       "ENTRYTYPE"
-00021180: 3a20 2261 7274 6963 6c65 222c 0a20 2020  : "article",.   
-00021190: 2020 2020 2020 2020 2020 2020 2022 6175               "au
-000211a0: 7468 6f72 223a 2022 6d65 222c 0a20 2020  thor": "me",.   
-000211b0: 2020 2020 2020 2020 2020 2020 2022 4944               "ID
-000211c0: 223a 2022 6465 6622 2c0a 2020 2020 2020  ": "def",.      
-000211d0: 2020 2020 2020 2020 2020 2274 6974 6c65            "title
-000211e0: 223a 2022 7b64 6566 7d22 2c0a 2020 2020  ": "{def}",.    
-000211f0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-00021200: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00021210: 662e 6173 7365 7274 4571 7561 6c28 636f  f.assertEqual(co
-00021220: 6d70 6c65 7465 645b 305d 5b22 6269 6264  mpleted[0]["bibd
-00021230: 6963 7422 5d2c 2063 6f6d 706c 6574 6564  ict"], completed
-00021240: 5b30 5d5b 2262 6962 7465 7844 6963 7422  [0]["bibtexDict"
-00021250: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
-00021260: 6173 7365 7274 4571 7561 6c28 636f 6d70  assertEqual(comp
-00021270: 6c65 7465 645b 315d 5b22 6269 6264 6963  leted[1]["bibdic
-00021280: 7422 5d2c 2063 6f6d 706c 6574 6564 5b31  t"], completed[1
-00021290: 5d5b 2262 6962 7465 7844 6963 7422 5d29  ]["bibtexDict"])
-000212a0: 0a0a 2020 2020 6465 6620 7465 7374 5f64  ..    def test_d
-000212b0: 656c 6574 6528 7365 6c66 2c20 2a61 7267  elete(self, *arg
-000212c0: 7329 3a0a 2020 2020 2020 2020 2222 2254  s):.        """T
-000212d0: 6573 7420 6465 6c65 7465 2061 2062 6962  est delete a bib
-000212e0: 7465 7820 656e 7472 7920 6672 6f6d 2074  tex entry from t
-000212f0: 6865 2044 4222 2222 0a20 2020 2020 2020  he DB""".       
-00021300: 2073 656c 662e 696e 7365 7274 5f74 6872   self.insert_thr
-00021310: 6565 2829 0a20 2020 2020 2020 2073 656c  ee().        sel
-00021320: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-00021330: 662e 7042 4442 2e63 6174 4269 622e 696e  f.pBDB.catBib.in
-00021340: 7365 7274 2831 2c20 2261 6263 2229 290a  sert(1, "abc")).
+000206e0: 2022 6f6c 645f 6b65 7973 223a 2022 6364   "old_keys": "cd
+000206f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00020700: 2020 2020 2020 2022 6269 6274 6578 223a         "bibtex":
+00020710: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00020720: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00020730: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00020740: 2020 205f 752e 6173 7365 7274 5f63 616c     _u.assert_cal
+00020750: 6c65 645f 6f6e 6365 5f77 6974 6828 2261  led_once_with("a
+00020760: 6263 222c 2022 6d61 726b 7322 2c20 2261  bc", "marks", "a
+00020770: 622c 6364 2229 0a0a 2020 2020 6465 6620  b,cd")..    def 
+00020780: 7465 7374 5f63 6f6d 706c 6574 6546 6574  test_completeFet
+00020790: 6368 6564 2873 656c 662c 202a 6172 6773  ched(self, *args
+000207a0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+000207b0: 6d61 7844 6966 6620 3d20 4e6f 6e65 0a20  maxDiff = None. 
+000207c0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000207d0: 7274 5472 7565 280a 2020 2020 2020 2020  rtTrue(.        
+000207e0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+000207f0: 6273 2e69 6e73 6572 7446 726f 6d42 6962  bs.insertFromBib
+00020800: 7465 7828 0a20 2020 2020 2020 2020 2020  tex(.           
+00020810: 2020 2020 2027 4061 7274 6963 6c65 7b61       '@article{a
+00020820: 6263 2c5c 6e61 7574 686f 7220 3d20 226d  bc,\nauthor = "m
+00020830: 6522 2c5c 6e27 0a20 2020 2020 2020 2020  e",\n'.         
+00020840: 2020 2020 2020 202b 2027 7469 746c 6520         + 'title 
+00020850: 3d20 2261 6263 222c 5c6e 6a6f 7572 6e61  = "abc",\njourna
+00020860: 6c3d 226a 6361 7022 2c5c 6e76 6f6c 756d  l="jcap",\nvolum
+00020870: 653d 2233 222c 5c6e 270a 2020 2020 2020  e="3",\n'.      
+00020880: 2020 2020 2020 2020 2020 2b20 2779 6561            + 'yea
+00020890: 723d 2232 3031 3822 2c5c 6e70 6167 6573  r="2018",\npages
+000208a0: 3d22 3122 2c5c 6e61 7278 6976 3d22 3132  ="1",\narxiv="12
+000208b0: 3334 2e35 3637 3839 222c 5c6e 7d27 0a20  34.56789",\n}'. 
+000208c0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000208d0: 2020 2020 2029 0a20 2020 2020 2020 2066       ).        f
+000208e0: 6574 6368 6564 203d 2073 656c 662e 7042  etched = self.pB
+000208f0: 4442 2e62 6962 732e 6765 7442 7942 6962  DB.bibs.getByBib
+00020900: 6b65 7928 2261 6263 2229 0a20 2020 2020  key("abc").     
+00020910: 2020 2063 6f6d 706c 6574 6564 203d 2073     completed = s
+00020920: 656c 662e 7042 4442 2e62 6962 732e 636f  elf.pBDB.bibs.co
+00020930: 6d70 6c65 7465 4665 7463 6865 6428 6665  mpleteFetched(fe
+00020940: 7463 6865 6429 5b30 5d0a 2020 2020 2020  tched)[0].      
+00020950: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00020960: 616c 2863 6f6d 706c 6574 6564 5b22 6175  al(completed["au
+00020970: 7468 6f72 225d 2c20 226d 6522 290a 2020  thor"], "me").  
+00020980: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00020990: 7445 7175 616c 2863 6f6d 706c 6574 6564  tEqual(completed
+000209a0: 5b22 7469 746c 6522 5d2c 2022 7b61 6263  ["title"], "{abc
+000209b0: 7d22 290a 2020 2020 2020 2020 7365 6c66  }").        self
+000209c0: 2e61 7373 6572 7445 7175 616c 2863 6f6d  .assertEqual(com
+000209d0: 706c 6574 6564 5b22 6a6f 7572 6e61 6c22  pleted["journal"
+000209e0: 5d2c 2022 6a63 6170 2229 0a20 2020 2020  ], "jcap").     
+000209f0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00020a00: 7561 6c28 636f 6d70 6c65 7465 645b 2276  ual(completed["v
+00020a10: 6f6c 756d 6522 5d2c 2022 3322 290a 2020  olume"], "3").  
+00020a20: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00020a30: 7445 7175 616c 2863 6f6d 706c 6574 6564  tEqual(completed
+00020a40: 5b22 7965 6172 225d 2c20 2232 3031 3822  ["year"], "2018"
+00020a50: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00020a60: 7373 6572 7445 7175 616c 2863 6f6d 706c  ssertEqual(compl
+00020a70: 6574 6564 5b22 7061 6765 7322 5d2c 2022  eted["pages"], "
+00020a80: 3122 290a 2020 2020 2020 2020 7365 6c66  1").        self
+00020a90: 2e61 7373 6572 7445 7175 616c 2863 6f6d  .assertEqual(com
+00020aa0: 706c 6574 6564 5b22 7075 626c 6973 6865  pleted["publishe
+00020ab0: 6422 5d2c 2022 6a63 6170 2033 2028 3230  d"], "jcap 3 (20
+00020ac0: 3138 2920 3122 290a 2020 2020 2020 2020  18) 1").        
+00020ad0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00020ae0: 2863 6f6d 706c 6574 6564 5b22 6269 6264  (completed["bibd
+00020af0: 6963 7422 5d2c 2063 6f6d 706c 6574 6564  ict"], completed
+00020b00: 5b22 6269 6274 6578 4469 6374 225d 290a  ["bibtexDict"]).
+00020b10: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+00020b20: 4442 2e75 6e64 6f28 7665 7262 6f73 653d  DB.undo(verbose=
+00020b30: 3029 0a20 2020 2020 2020 2073 656c 662e  0).        self.
+00020b40: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
+00020b50: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00020b60: 422e 6269 6273 2e69 6e73 6572 7446 726f  B.bibs.insertFro
+00020b70: 6d42 6962 7465 7828 0a20 2020 2020 2020  mBibtex(.       
+00020b80: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+00020b90: 6c65 7b61 6263 2c5c 6e61 7574 686f 7220  le{abc,\nauthor 
+00020ba0: 3d20 226d 6520 616e 6420 796f 7520 616e  = "me and you an
+00020bb0: 6420 6869 6d20 616e 6420 7468 656d 222c  d him and them",
+00020bc0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00020bd0: 2020 2b20 275c 6e74 6974 6c65 203d 2022    + '\ntitle = "
+00020be0: 6162 6322 2c5c 6e79 6561 723d 2232 3032  abc",\nyear="202
+00020bf0: 3122 2c5c 6e7d 270a 2020 2020 2020 2020  1",\n}'.        
+00020c00: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+00020c10: 2020 2020 2020 2020 6665 7463 6865 6420          fetched 
+00020c20: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
+00020c30: 2e67 6574 4279 4269 626b 6579 2822 6162  .getByBibkey("ab
+00020c40: 6322 290a 2020 2020 2020 2020 636f 6d70  c").        comp
+00020c50: 6c65 7465 6420 3d20 7365 6c66 2e70 4244  leted = self.pBD
+00020c60: 422e 6269 6273 2e63 6f6d 706c 6574 6546  B.bibs.completeF
+00020c70: 6574 6368 6564 2866 6574 6368 6564 295b  etched(fetched)[
+00020c80: 305d 0a20 2020 2020 2020 2073 656c 662e  0].        self.
+00020c90: 6173 7365 7274 4571 7561 6c28 636f 6d70  assertEqual(comp
+00020ca0: 6c65 7465 645b 2261 7574 686f 7222 5d2c  leted["author"],
+00020cb0: 2022 6d65 2065 7420 616c 2e22 290a 2020   "me et al.").  
+00020cc0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00020cd0: 7445 7175 616c 2863 6f6d 706c 6574 6564  tEqual(completed
+00020ce0: 5b22 7469 746c 6522 5d2c 2022 7b61 6263  ["title"], "{abc
+00020cf0: 7d22 290a 2020 2020 2020 2020 7365 6c66  }").        self
+00020d00: 2e61 7373 6572 7445 7175 616c 2863 6f6d  .assertEqual(com
+00020d10: 706c 6574 6564 5b22 6a6f 7572 6e61 6c22  pleted["journal"
+00020d20: 5d2c 2022 2229 0a20 2020 2020 2020 2073  ], "").        s
+00020d30: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00020d40: 636f 6d70 6c65 7465 645b 2276 6f6c 756d  completed["volum
+00020d50: 6522 5d2c 2022 2229 0a20 2020 2020 2020  e"], "").       
+00020d60: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00020d70: 6c28 636f 6d70 6c65 7465 645b 2279 6561  l(completed["yea
+00020d80: 7222 5d2c 2022 3230 3231 2229 0a20 2020  r"], "2021").   
+00020d90: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00020da0: 4571 7561 6c28 636f 6d70 6c65 7465 645b  Equal(completed[
+00020db0: 2270 6167 6573 225d 2c20 2222 290a 2020  "pages"], "").  
+00020dc0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00020dd0: 7445 7175 616c 2863 6f6d 706c 6574 6564  tEqual(completed
+00020de0: 5b22 7075 626c 6973 6865 6422 5d2c 2022  ["published"], "
+00020df0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00020e00: 6173 7365 7274 4571 7561 6c28 636f 6d70  assertEqual(comp
+00020e10: 6c65 7465 645b 2262 6962 6469 6374 225d  leted["bibdict"]
+00020e20: 2c20 636f 6d70 6c65 7465 645b 2262 6962  , completed["bib
+00020e30: 7465 7844 6963 7422 5d29 0a0a 2020 2020  texDict"])..    
+00020e40: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
+00020e50: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
+00020e60: 6549 6e73 6572 7428 0a20 2020 2020 2020  eInsert(.       
+00020e70: 2020 2020 2027 4061 7274 6963 6c65 7b64       '@article{d
+00020e80: 6566 2c5c 6e61 7574 686f 7220 3d20 226d  ef,\nauthor = "m
+00020e90: 6522 2c5c 6e74 6974 6c65 203d 2022 6465  e",\ntitle = "de
+00020ea0: 6622 2c7d 270a 2020 2020 2020 2020 290a  f",}'.        ).
+00020eb0: 2020 2020 2020 2020 6461 7461 5b22 6269          data["bi
+00020ec0: 6274 6578 225d 203d 2027 4061 7274 6963  btex"] = '@artic
+00020ed0: 6c65 7b61 6263 2c5c 6e61 7574 686f 7220  le{abc,\nauthor 
+00020ee0: 3d20 226d 6522 2c5c 6e74 6974 6c65 203d  = "me",\ntitle =
+00020ef0: 2022 6465 2266 222c 7d27 0a20 2020 2020   "de"f",}'.     
+00020f00: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+00020f10: 7565 2873 656c 662e 7042 4442 2e62 6962  ue(self.pBDB.bib
+00020f20: 732e 696e 7365 7274 2864 6174 6129 290a  s.insert(data)).
+00020f30: 2020 2020 2020 2020 6665 7463 6865 6420          fetched 
+00020f40: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
+00020f50: 2e67 6574 416c 6c28 290a 2020 2020 2020  .getAll().      
+00020f60: 2020 636f 6d70 6c65 7465 6420 3d20 7365    completed = se
+00020f70: 6c66 2e70 4244 422e 6269 6273 2e63 6f6d  lf.pBDB.bibs.com
+00020f80: 706c 6574 6546 6574 6368 6564 2866 6574  pleteFetched(fet
+00020f90: 6368 6564 290a 2020 2020 2020 2020 7365  ched).        se
+00020fa0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00020fb0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00020fc0: 6c65 7465 645b 305d 5b22 6269 6274 6578  leted[0]["bibtex
+00020fd0: 4469 6374 225d 2c0a 2020 2020 2020 2020  Dict"],.        
+00020fe0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00020ff0: 2020 2020 2020 2245 4e54 5259 5459 5045        "ENTRYTYPE
+00021000: 223a 2022 6172 7469 636c 6522 2c0a 2020  ": "article",.  
+00021010: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+00021020: 4422 3a20 2261 6263 222c 0a20 2020 2020  D": "abc",.     
+00021030: 2020 2020 2020 2020 2020 2022 6175 7468             "auth
+00021040: 6f72 223a 2022 6d65 2061 6e64 2079 6f75  or": "me and you
+00021050: 2061 6e64 2068 696d 2061 6e64 2074 6865   and him and the
+00021060: 6d22 2c0a 2020 2020 2020 2020 2020 2020  m",.            
+00021070: 2020 2020 2274 6974 6c65 223a 2022 7b61      "title": "{a
+00021080: 6263 7d22 2c0a 2020 2020 2020 2020 2020  bc}",.          
+00021090: 2020 2020 2020 2279 6561 7222 3a20 2232        "year": "2
+000210a0: 3032 3122 2c0a 2020 2020 2020 2020 2020  021",.          
+000210b0: 2020 7d2c 0a20 2020 2020 2020 2029 0a20    },.        ). 
+000210c0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000210d0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000210e0: 2020 2020 2063 6f6d 706c 6574 6564 5b31       completed[1
+000210f0: 5d5b 2262 6962 7465 7844 6963 7422 5d2c  ]["bibtexDict"],
+00021100: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+00021110: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00021120: 454e 5452 5954 5950 4522 3a20 2261 7274  ENTRYTYPE": "art
+00021130: 6963 6c65 222c 0a20 2020 2020 2020 2020  icle",.         
+00021140: 2020 2020 2020 2022 6175 7468 6f72 223a         "author":
+00021150: 2022 6d65 222c 0a20 2020 2020 2020 2020   "me",.         
+00021160: 2020 2020 2020 2022 4944 223a 2022 6465         "ID": "de
+00021170: 6622 2c0a 2020 2020 2020 2020 2020 2020  f",.            
+00021180: 2020 2020 2274 6974 6c65 223a 2022 7b64      "title": "{d
+00021190: 6566 7d22 2c0a 2020 2020 2020 2020 2020  ef}",.          
+000211a0: 2020 7d2c 0a20 2020 2020 2020 2029 0a20    },.        ). 
+000211b0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000211c0: 7274 4571 7561 6c28 636f 6d70 6c65 7465  rtEqual(complete
+000211d0: 645b 305d 5b22 6269 6264 6963 7422 5d2c  d[0]["bibdict"],
+000211e0: 2063 6f6d 706c 6574 6564 5b30 5d5b 2262   completed[0]["b
+000211f0: 6962 7465 7844 6963 7422 5d29 0a20 2020  ibtexDict"]).   
+00021200: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00021210: 4571 7561 6c28 636f 6d70 6c65 7465 645b  Equal(completed[
+00021220: 315d 5b22 6269 6264 6963 7422 5d2c 2063  1]["bibdict"], c
+00021230: 6f6d 706c 6574 6564 5b31 5d5b 2262 6962  ompleted[1]["bib
+00021240: 7465 7844 6963 7422 5d29 0a0a 2020 2020  texDict"])..    
+00021250: 6465 6620 7465 7374 5f64 656c 6574 6528  def test_delete(
+00021260: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+00021270: 2020 2020 2020 2222 2254 6573 7420 6465        """Test de
+00021280: 6c65 7465 2061 2062 6962 7465 7820 656e  lete a bibtex en
+00021290: 7472 7920 6672 6f6d 2074 6865 2044 4222  try from the DB"
+000212a0: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+000212b0: 696e 7365 7274 5f74 6872 6565 2829 0a20  insert_three(). 
+000212c0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000212d0: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
+000212e0: 2e63 6174 4269 622e 696e 7365 7274 2831  .catBib.insert(1
+000212f0: 2c20 2261 6263 2229 290a 2020 2020 2020  , "abc")).      
+00021300: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+00021310: 6528 7365 6c66 2e70 4244 422e 6269 6245  e(self.pBDB.bibE
+00021320: 7870 2e69 6e73 6572 7428 2261 6263 222c  xp.insert("abc",
+00021330: 2031 2929 0a20 2020 2020 2020 2064 6253   1)).        dbS
+00021340: 7461 7473 2873 656c 662e 7042 4442 290a  tats(self.pBDB).
 00021350: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00021360: 6572 7454 7275 6528 7365 6c66 2e70 4244  ertTrue(self.pBD
-00021370: 422e 6269 6245 7870 2e69 6e73 6572 7428  B.bibExp.insert(
-00021380: 2261 6263 222c 2031 2929 0a20 2020 2020  "abc", 1)).     
-00021390: 2020 2064 6253 7461 7473 2873 656c 662e     dbStats(self.
-000213a0: 7042 4442 290a 2020 2020 2020 2020 7365  pBDB).        se
-000213b0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-000213c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000213d0: 2e70 4244 422e 7374 6174 732c 0a20 2020  .pBDB.stats,.   
-000213e0: 2020 2020 2020 2020 207b 2262 6962 7322           {"bibs"
-000213f0: 3a20 332c 2022 6361 7473 223a 2032 2c20  : 3, "cats": 2, 
-00021400: 2265 7870 7322 3a20 302c 2022 6361 7442  "exps": 0, "catB
-00021410: 6962 223a 2031 2c20 2263 6174 4578 7022  ib": 1, "catExp"
-00021420: 3a20 302c 2022 6269 6245 7870 223a 2031  : 0, "bibExp": 1
-00021430: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-00021440: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00021450: 6962 732e 6465 6c65 7465 2822 6161 6122  ibs.delete("aaa"
-00021460: 290a 2020 2020 2020 2020 6462 5374 6174  ).        dbStat
-00021470: 7328 7365 6c66 2e70 4244 4229 0a20 2020  s(self.pBDB).   
-00021480: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00021490: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-000214a0: 2020 2073 656c 662e 7042 4442 2e73 7461     self.pBDB.sta
-000214b0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-000214c0: 7b22 6269 6273 223a 2033 2c20 2263 6174  {"bibs": 3, "cat
-000214d0: 7322 3a20 322c 2022 6578 7073 223a 2030  s": 2, "exps": 0
-000214e0: 2c20 2263 6174 4269 6222 3a20 312c 2022  , "catBib": 1, "
-000214f0: 6361 7445 7870 223a 2030 2c20 2262 6962  catExp": 0, "bib
-00021500: 4578 7022 3a20 317d 2c0a 2020 2020 2020  Exp": 1},.      
-00021510: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00021520: 2e70 4244 422e 6269 6273 2e64 656c 6574  .pBDB.bibs.delet
-00021530: 6528 2261 6263 2229 0a20 2020 2020 2020  e("abc").       
-00021540: 2064 6253 7461 7473 2873 656c 662e 7042   dbStats(self.pB
-00021550: 4442 290a 2020 2020 2020 2020 7365 6c66  DB).        self
-00021560: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00021570: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00021580: 4244 422e 7374 6174 732c 0a20 2020 2020  BDB.stats,.     
-00021590: 2020 2020 2020 207b 2262 6962 7322 3a20         {"bibs": 
-000215a0: 322c 2022 6361 7473 223a 2032 2c20 2265  2, "cats": 2, "e
-000215b0: 7870 7322 3a20 302c 2022 6361 7442 6962  xps": 0, "catBib
-000215c0: 223a 2030 2c20 2263 6174 4578 7022 3a20  ": 0, "catExp": 
-000215d0: 302c 2022 6269 6245 7870 223a 2030 7d2c  0, "bibExp": 0},
-000215e0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000215f0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00021600: 732e 6465 6c65 7465 285b 2264 6566 222c  s.delete(["def",
-00021610: 2022 6768 6922 5d29 0a20 2020 2020 2020   "ghi"]).       
-00021620: 2064 6253 7461 7473 2873 656c 662e 7042   dbStats(self.pB
-00021630: 4442 290a 2020 2020 2020 2020 7365 6c66  DB).        self
-00021640: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00021650: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00021660: 4244 422e 7374 6174 732c 0a20 2020 2020  BDB.stats,.     
-00021670: 2020 2020 2020 207b 2262 6962 7322 3a20         {"bibs": 
-00021680: 302c 2022 6361 7473 223a 2032 2c20 2265  0, "cats": 2, "e
-00021690: 7870 7322 3a20 302c 2022 6361 7442 6962  xps": 0, "catBib
-000216a0: 223a 2030 2c20 2263 6174 4578 7022 3a20  ": 0, "catExp": 
-000216b0: 302c 2022 6269 6245 7870 223a 2030 7d2c  0, "bibExp": 0},
-000216c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000216d0: 6465 6620 7465 7374 5f66 6574 6368 416c  def test_fetchAl
-000216e0: 6c28 7365 6c66 2c20 2a61 7267 7329 3a0a  l(self, *args):.
-000216f0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00021700: 7468 6520 6665 7463 6841 6c6c 2061 6e64  the fetchAll and
-00021710: 2067 6574 416c 6c20 6675 6e63 7469 6f6e   getAll function
-00021720: 7322 2222 0a20 2020 2020 2020 2023 2067  s""".        # g
-00021730: 656e 6572 6963 0a20 2020 2020 2020 2073  eneric.        s
-00021740: 656c 662e 696e 7365 7274 5f74 6872 6565  elf.insert_three
-00021750: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-00021760: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00021770: 2020 2020 2020 2020 205b 655b 2262 6962           [e["bib
-00021780: 6b65 7922 5d20 666f 7220 6520 696e 2073  key"] for e in s
-00021790: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-000217a0: 7441 6c6c 2829 5d2c 205b 2261 6263 222c  tAll()], ["abc",
-000217b0: 2022 6465 6622 2c20 2267 6869 225d 0a20   "def", "ghi"]. 
-000217c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000217d0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000217e0: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
-000217f0: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
-00021800: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
-00021810: 6962 732e 6665 7463 6841 6c6c 2829 2e6c  ibs.fetchAll().l
-00021820: 6173 7446 6574 6368 6564 5d2c 0a20 2020  astFetched],.   
-00021830: 2020 2020 2020 2020 205b 2261 6263 222c           ["abc",
-00021840: 2022 6465 6622 2c20 2267 6869 225d 2c0a   "def", "ghi"],.
-00021850: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00021860: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00021870: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00021880: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
-00021890: 6173 7451 7565 7279 2c20 2273 656c 6563  astQuery, "selec
-000218a0: 7420 2a20 6672 6f6d 2065 6e74 7269 6573  t * from entries
-000218b0: 2020 6f72 6465 7220 6279 2066 6972 7374    order by first
-000218c0: 6461 7465 2041 5343 220a 2020 2020 2020  date ASC".      
-000218d0: 2020 290a 2020 2020 2020 2020 2320 7361    ).        # sa
-000218e0: 7665 5175 6572 790a 2020 2020 2020 2020  veQuery.        
-000218f0: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
-00021900: 6173 7451 7565 7279 203d 2022 220a 2020  astQuery = "".  
-00021910: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00021920: 6269 6273 2e67 6574 416c 6c28 7361 7665  bibs.getAll(save
-00021930: 5175 6572 793d 4661 6c73 6529 0a20 2020  Query=False).   
-00021940: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00021950: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-00021960: 6269 6273 2e6c 6173 7451 7565 7279 2c20  bibs.lastQuery, 
-00021970: 2222 290a 2020 2020 2020 2020 7365 6c66  "").        self
-00021980: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-00021990: 416c 6c28 7361 7665 5175 6572 793d 4661  All(saveQuery=Fa
-000219a0: 6c73 6529 0a20 2020 2020 2020 2073 656c  lse).        sel
-000219b0: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-000219c0: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-000219d0: 7451 7565 7279 2c20 2222 290a 2020 2020  tQuery, "").    
-000219e0: 2020 2020 2320 6c69 6d69 7454 6f0a 2020      # limitTo.  
-000219f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00021a00: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00021a10: 2020 2020 5b65 5b22 6269 626b 6579 225d      [e["bibkey"]
-00021a20: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00021a30: 4244 422e 6269 6273 2e67 6574 416c 6c28  BDB.bibs.getAll(
-00021a40: 6c69 6d69 7454 6f3d 3129 5d2c 205b 2261  limitTo=1)], ["a
-00021a50: 6263 225d 0a20 2020 2020 2020 2029 0a20  bc"].        ). 
-00021a60: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00021a70: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00021a80: 2020 2020 205b 655b 2262 6962 6b65 7922       [e["bibkey"
-00021a90: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
-00021aa0: 7042 4442 2e62 6962 732e 6665 7463 6841  pBDB.bibs.fetchA
-00021ab0: 6c6c 286c 696d 6974 546f 3d31 292e 6c61  ll(limitTo=1).la
-00021ac0: 7374 4665 7463 6865 645d 2c0a 2020 2020  stFetched],.    
-00021ad0: 2020 2020 2020 2020 5b22 6162 6322 5d2c          ["abc"],
-00021ae0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00021af0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00021b00: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00021b10: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00021b20: 6c61 7374 5175 6572 792c 0a20 2020 2020  lastQuery,.     
-00021b30: 2020 2020 2020 2022 7365 6c65 6374 202a         "select *
-00021b40: 2066 726f 6d20 656e 7472 6965 7320 206f   from entries  o
-00021b50: 7264 6572 2062 7920 6669 7273 7464 6174  rder by firstdat
-00021b60: 6520 4153 4320 4c49 4d49 5420 3122 2c0a  e ASC LIMIT 1",.
-00021b70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00021b80: 2020 2320 6c69 6d69 7454 6f20 2b20 6c69    # limitTo + li
-00021b90: 6d69 744f 6666 7365 740a 2020 2020 2020  mitOffset.      
-00021ba0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00021bb0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00021bc0: 5b65 5b22 6269 626b 6579 225d 2066 6f72  [e["bibkey"] for
-00021bd0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00021be0: 6269 6273 2e67 6574 416c 6c28 6c69 6d69  bibs.getAll(limi
-00021bf0: 7454 6f3d 352c 206c 696d 6974 4f66 6673  tTo=5, limitOffs
-00021c00: 6574 3d31 295d 2c0a 2020 2020 2020 2020  et=1)],.        
-00021c10: 2020 2020 5b22 6465 6622 2c20 2267 6869      ["def", "ghi
-00021c20: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
-00021c30: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00021c40: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00021c50: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00021c60: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
-00021c70: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00021c80: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
-00021c90: 7042 4442 2e62 6962 732e 6665 7463 6841  pBDB.bibs.fetchA
-00021ca0: 6c6c 286c 696d 6974 546f 3d35 2c20 6c69  ll(limitTo=5, li
-00021cb0: 6d69 744f 6666 7365 743d 3129 2e6c 6173  mitOffset=1).las
-00021cc0: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-00021cd0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00021ce0: 2020 2020 5b22 6465 6622 2c20 2267 6869      ["def", "ghi
-00021cf0: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
-00021d00: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00021d10: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00021d20: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00021d30: 6273 2e6c 6173 7451 7565 7279 2c0a 2020  bs.lastQuery,.  
-00021d40: 2020 2020 2020 2020 2020 2273 656c 6563            "selec
-00021d50: 7420 2a20 6672 6f6d 2065 6e74 7269 6573  t * from entries
-00021d60: 2020 6f72 6465 7220 6279 2066 6972 7374    order by first
-00021d70: 6461 7465 2041 5343 204c 494d 4954 2035  date ASC LIMIT 5
-00021d80: 204f 4646 5345 5420 3122 2c0a 2020 2020   OFFSET 1",.    
-00021d90: 2020 2020 290a 2020 2020 2020 2020 2320      ).        # 
-00021da0: 6c69 6d69 744f 6666 7365 7420 616c 6f6e  limitOffset alon
-00021db0: 6520 286e 6f20 6566 6665 6374 290a 2020  e (no effect).  
-00021dc0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00021dd0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00021de0: 2020 2020 5b65 5b22 6269 626b 6579 225d      [e["bibkey"]
-00021df0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00021e00: 4244 422e 6269 6273 2e67 6574 416c 6c28  BDB.bibs.getAll(
-00021e10: 6c69 6d69 744f 6666 7365 743d 3129 5d2c  limitOffset=1)],
-00021e20: 0a20 2020 2020 2020 2020 2020 205b 2261  .            ["a
-00021e30: 6263 222c 2022 6465 6622 2c20 2267 6869  bc", "def", "ghi
-00021e40: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
-00021e50: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00021e60: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00021e70: 2020 2020 5b65 5b22 6269 626b 6579 225d      [e["bibkey"]
-00021e80: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00021e90: 4244 422e 6269 6273 2e66 6574 6368 416c  BDB.bibs.fetchAl
-00021ea0: 6c28 6c69 6d69 744f 6666 7365 743d 3129  l(limitOffset=1)
-00021eb0: 2e6c 6173 7446 6574 6368 6564 5d2c 0a20  .lastFetched],. 
-00021ec0: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
-00021ed0: 222c 2022 6465 6622 2c20 2267 6869 225d  ", "def", "ghi"]
-00021ee0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00021ef0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00021f00: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00021f10: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00021f20: 2e6c 6173 7451 7565 7279 2c20 2273 656c  .lastQuery, "sel
-00021f30: 6563 7420 2a20 6672 6f6d 2065 6e74 7269  ect * from entri
-00021f40: 6573 2020 6f72 6465 7220 6279 2066 6972  es  order by fir
-00021f50: 7374 6461 7465 2041 5343 220a 2020 2020  stdate ASC".    
-00021f60: 2020 2020 290a 2020 2020 2020 2020 2320      ).        # 
-00021f70: 6f72 6465 7254 7970 650a 2020 2020 2020  orderType.      
-00021f80: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00021f90: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00021fa0: 5b65 5b22 6269 626b 6579 225d 2066 6f72  [e["bibkey"] for
-00021fb0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00021fc0: 6269 6273 2e67 6574 416c 6c28 6f72 6465  bibs.getAll(orde
-00021fd0: 7254 7970 653d 2244 4553 4322 295d 2c0a  rType="DESC")],.
-00021fe0: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-00021ff0: 6322 2c20 2264 6566 222c 2022 6768 6922  c", "def", "ghi"
-00022000: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-00022010: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00022020: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00022030: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00022040: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-00022050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022060: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00022070: 4244 422e 6269 6273 2e66 6574 6368 416c  BDB.bibs.fetchAl
-00022080: 6c28 6f72 6465 7254 7970 653d 2244 4553  l(orderType="DES
-00022090: 4322 292e 6c61 7374 4665 7463 6865 640a  C").lastFetched.
-000220a0: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-000220b0: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
-000220c0: 222c 2022 6465 6622 2c20 2267 6869 225d  ", "def", "ghi"]
-000220d0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-000220e0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-000220f0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00022100: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00022110: 2e6c 6173 7451 7565 7279 2c20 2273 656c  .lastQuery, "sel
-00022120: 6563 7420 2a20 6672 6f6d 2065 6e74 7269  ect * from entri
-00022130: 6573 2020 6f72 6465 7220 6279 2066 6972  es  order by fir
-00022140: 7374 6461 7465 2044 4553 4322 0a20 2020  stdate DESC".   
-00022150: 2020 2020 2029 0a20 2020 2020 2020 2023       ).        #
-00022160: 206f 7264 6572 4279 0a20 2020 2020 2020   orderBy.       
-00022170: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00022180: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
-00022190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000221a0: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
-000221b0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000221c0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-000221d0: 6269 6273 2e67 6574 416c 6c28 6f72 6465  bibs.getAll(orde
-000221e0: 7242 793d 2262 6962 6b65 7922 2c20 6f72  rBy="bibkey", or
-000221f0: 6465 7254 7970 653d 2244 4553 4322 290a  derType="DESC").
-00022200: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-00022210: 2020 2020 2020 2020 2020 205b 2267 6869             ["ghi
-00022220: 222c 2022 6465 6622 2c20 2261 6263 225d  ", "def", "abc"]
-00022230: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00022240: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00022250: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00022260: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00022270: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
-00022280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022290: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-000222a0: 4442 2e62 6962 732e 6665 7463 6841 6c6c  DB.bibs.fetchAll
-000222b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000222c0: 2020 2020 2020 6f72 6465 7242 793d 2262        orderBy="b
-000222d0: 6962 6b65 7922 2c20 6f72 6465 7254 7970  ibkey", orderTyp
-000222e0: 653d 2244 4553 4322 0a20 2020 2020 2020  e="DESC".       
-000222f0: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
-00022300: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
-00022310: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-00022320: 2020 5b22 6768 6922 2c20 2264 6566 222c    ["ghi", "def",
-00022330: 2022 6162 6322 5d2c 0a20 2020 2020 2020   "abc"],.       
-00022340: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00022350: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00022360: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00022370: 4442 2e62 6962 732e 6c61 7374 5175 6572  DB.bibs.lastQuer
-00022380: 792c 2022 7365 6c65 6374 202a 2066 726f  y, "select * fro
-00022390: 6d20 656e 7472 6965 7320 206f 7264 6572  m entries  order
-000223a0: 2062 7920 6269 626b 6579 2044 4553 4322   by bibkey DESC"
-000223b0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000223c0: 2020 2020 2320 736f 6d65 2070 6172 616d      # some param
-000223d0: 6574 6572 2063 6f6d 6269 6e61 7469 6f6e  eter combination
-000223e0: 730a 2020 2020 2020 2020 7365 6c66 2e61  s.        self.a
-000223f0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00022400: 2020 2020 2020 2020 5b65 5b22 6269 626b          [e["bibk
-00022410: 6579 225d 2066 6f72 2065 2069 6e20 7365  ey"] for e in se
-00022420: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-00022430: 416c 6c28 7061 7261 6d73 3d7b 2262 6962  All(params={"bib
-00022440: 6b65 7922 3a20 2261 6263 227d 295d 2c0a  key": "abc"})],.
-00022450: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-00022460: 6322 5d2c 0a20 2020 2020 2020 2029 0a20  c"],.        ). 
-00022470: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00022480: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00022490: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-000224a0: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-000224b0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-000224c0: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-000224d0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-000224e0: 416c 6c28 7061 7261 6d73 3d7b 2262 6962  All(params={"bib
-000224f0: 6b65 7922 3a20 2261 6263 227d 292e 6c61  key": "abc"}).la
-00022500: 7374 4665 7463 6865 640a 2020 2020 2020  stFetched.      
-00022510: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00022520: 2020 2020 205b 2261 6263 225d 2c0a 2020       ["abc"],.  
-00022530: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00022540: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00022550: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00022560: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-00022570: 7451 7565 7279 2c0a 2020 2020 2020 2020  tQuery,.        
-00022580: 2020 2020 2273 656c 6563 7420 2a20 6672      "select * fr
-00022590: 6f6d 2065 6e74 7269 6573 2020 7768 6572  om entries  wher
-000225a0: 6520 6269 626b 6579 203d 2020 3f20 206f  e bibkey =  ?  o
-000225b0: 7264 6572 2062 7920 6669 7273 7464 6174  rder by firstdat
-000225c0: 6520 4153 4322 2c0a 2020 2020 2020 2020  e ASC",.        
-000225d0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000225e0: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-000225f0: 7042 4442 2e62 6962 732e 6c61 7374 5661  pBDB.bibs.lastVa
-00022600: 6c73 2c20 2822 6162 6322 2c29 290a 2020  ls, ("abc",)).  
-00022610: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00022620: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00022630: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00022640: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
-00022650: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00022660: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
-00022670: 7042 4442 2e62 6962 732e 6765 7441 6c6c  pBDB.bibs.getAll
-00022680: 2870 6172 616d 733d 7b22 6269 626b 6579  (params={"bibkey
-00022690: 223a 2022 6162 6322 2c20 2261 7278 6976  ": "abc", "arxiv
-000226a0: 223a 2022 6465 6622 7d29 0a20 2020 2020  ": "def"}).     
-000226b0: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-000226c0: 2020 2020 2020 5b5d 2c0a 2020 2020 2020        [],.      
-000226d0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-000226e0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-000226f0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00022700: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
-00022710: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
-00022720: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
-00022730: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00022740: 6665 7463 6841 6c6c 280a 2020 2020 2020  fetchAll(.      
-00022750: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00022760: 7261 6d73 3d7b 2262 6962 6b65 7922 3a20  rams={"bibkey": 
-00022770: 2261 6263 222c 2022 6172 7869 7622 3a20  "abc", "arxiv": 
-00022780: 2264 6566 227d 0a20 2020 2020 2020 2020  "def"}.         
-00022790: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
-000227a0: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
-000227b0: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
-000227c0: 5b5d 2c0a 2020 2020 2020 2020 290a 2020  [],.        ).  
-000227d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000227e0: 7449 6e28 0a20 2020 2020 2020 2020 2020  tIn(.           
-000227f0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00022800: 6c61 7374 5175 6572 792c 0a20 2020 2020  lastQuery,.     
-00022810: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00022820: 2020 2020 2020 2020 2022 7365 6c65 6374           "select
-00022830: 202a 2066 726f 6d20 656e 7472 6965 7320   * from entries 
-00022840: 2077 6865 7265 2062 6962 6b65 7920 3d20   where bibkey = 
-00022850: 203f 2020 220a 2020 2020 2020 2020 2020   ?  ".          
-00022860: 2020 2020 2020 2b20 2261 6e64 2061 7278        + "and arx
-00022870: 6976 203d 2020 3f20 206f 7264 6572 2062  iv =  ?  order b
-00022880: 7920 6669 7273 7464 6174 6520 4153 4322  y firstdate ASC"
-00022890: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000228a0: 2020 2273 656c 6563 7420 2a20 6672 6f6d    "select * from
-000228b0: 2065 6e74 7269 6573 2020 7768 6572 6520   entries  where 
-000228c0: 6172 7869 7620 3d20 203f 2020 616e 6420  arxiv =  ?  and 
-000228d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000228e0: 2020 2b20 2262 6962 6b65 7920 3d20 203f    + "bibkey =  ?
-000228f0: 2020 6f72 6465 7220 6279 2066 6972 7374    order by first
-00022900: 6461 7465 2041 5343 222c 0a20 2020 2020  date ASC",.     
-00022910: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00022920: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00022930: 2e61 7373 6572 7445 7175 616c 2873 6f72  .assertEqual(sor
-00022940: 7465 6428 7365 6c66 2e70 4244 422e 6269  ted(self.pBDB.bi
-00022950: 6273 2e6c 6173 7456 616c 7329 2c20 736f  bs.lastVals), so
-00022960: 7274 6564 2828 2261 6263 222c 2022 6465  rted(("abc", "de
-00022970: 6622 2929 290a 2020 2020 2020 2020 7365  f"))).        se
-00022980: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00022990: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-000229a0: 2020 2020 2020 2020 2020 2020 2020 655b                e[
-000229b0: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
-000229c0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-000229d0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-000229e0: 732e 6765 7441 6c6c 280a 2020 2020 2020  s.getAll(.      
-000229f0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00022a00: 7261 6d73 3d7b 2262 6962 6b65 7922 3a20  rams={"bibkey": 
-00022a10: 2261 6263 222c 2022 6172 7869 7622 3a20  "abc", "arxiv": 
-00022a20: 2264 6566 227d 2c20 636f 6e6e 6563 7469  "def"}, connecti
-00022a30: 6f6e 3d22 6f72 220a 2020 2020 2020 2020  on="or".        
-00022a40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00022a50: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00022a60: 2020 2020 205b 2261 6263 222c 2022 6465       ["abc", "de
-00022a70: 6622 5d2c 0a20 2020 2020 2020 2029 0a20  f"],.        ). 
-00022a80: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00022a90: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00022aa0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00022ab0: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00022ac0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00022ad0: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-00022ae0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-00022af0: 416c 6c28 0a20 2020 2020 2020 2020 2020  All(.           
-00022b00: 2020 2020 2020 2020 2070 6172 616d 733d           params=
-00022b10: 7b22 6269 626b 6579 223a 2022 6162 6322  {"bibkey": "abc"
-00022b20: 2c20 2261 7278 6976 223a 2022 6465 6622  , "arxiv": "def"
-00022b30: 7d2c 2063 6f6e 6e65 6374 696f 6e3d 226f  }, connection="o
-00022b40: 7222 0a20 2020 2020 2020 2020 2020 2020  r".             
-00022b50: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
-00022b60: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-00022b70: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-00022b80: 6322 2c20 2264 6566 225d 2c0a 2020 2020  c", "def"],.    
-00022b90: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00022ba0: 6c66 2e61 7373 6572 7449 6e28 0a20 2020  lf.assertIn(.   
-00022bb0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00022bc0: 4442 2e62 6962 732e 6c61 7374 5175 6572  DB.bibs.lastQuer
-00022bd0: 792c 0a20 2020 2020 2020 2020 2020 205b  y,.            [
-00022be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022bf0: 2022 7365 6c65 6374 202a 2066 726f 6d20   "select * from 
-00022c00: 656e 7472 6965 7320 2077 6865 7265 2062  entries  where b
-00022c10: 6962 6b65 7920 3d20 203f 2020 6f72 2022  ibkey =  ?  or "
-00022c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022c30: 202b 2022 6172 7869 7620 3d20 203f 2020   + "arxiv =  ?  
-00022c40: 6f72 6465 7220 6279 2066 6972 7374 6461  order by firstda
-00022c50: 7465 2041 5343 222c 0a20 2020 2020 2020  te ASC",.       
-00022c60: 2020 2020 2020 2020 2022 7365 6c65 6374           "select
-00022c70: 202a 2066 726f 6d20 656e 7472 6965 7320   * from entries 
-00022c80: 2077 6865 7265 2061 7278 6976 203d 2020   where arxiv =  
-00022c90: 3f20 206f 7220 220a 2020 2020 2020 2020  ?  or ".        
-00022ca0: 2020 2020 2020 2020 2b20 2262 6962 6b65          + "bibke
-00022cb0: 7920 3d20 203f 2020 6f72 6465 7220 6279  y =  ?  order by
-00022cc0: 2066 6972 7374 6461 7465 2041 5343 222c   firstdate ASC",
-00022cd0: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-00022ce0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00022cf0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00022d00: 616c 2873 6f72 7465 6428 7365 6c66 2e70  al(sorted(self.p
-00022d10: 4244 422e 6269 6273 2e6c 6173 7456 616c  BDB.bibs.lastVal
-00022d20: 7329 2c20 736f 7274 6564 2828 2261 6263  s), sorted(("abc
-00022d30: 222c 2022 6465 6622 2929 290a 2020 2020  ", "def"))).    
-00022d40: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00022d50: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00022d60: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00022d70: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
-00022d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d90: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-00022da0: 4442 2e62 6962 732e 6765 7441 6c6c 280a  DB.bibs.getAll(.
-00022db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022dc0: 2020 2020 7061 7261 6d73 3d7b 2262 6962      params={"bib
-00022dd0: 6b65 7922 3a20 2261 6222 2c20 2261 7278  key": "ab", "arx
-00022de0: 6976 223a 2022 6566 227d 2c0a 2020 2020  iv": "ef"},.    
-00022df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e00: 636f 6e6e 6563 7469 6f6e 3d22 6f72 222c  connection="or",
-00022e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022e20: 2020 2020 206f 7065 7261 746f 723d 226c       operator="l
-00022e30: 696b 6522 2c0a 2020 2020 2020 2020 2020  ike",.          
-00022e40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00022e50: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-00022e60: 2020 205b 2261 6263 222c 2022 6465 6622     ["abc", "def"
-00022e70: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-00022e80: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00022e90: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00022ea0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00022eb0: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-00022ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022ed0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00022ee0: 4244 422e 6269 6273 2e66 6574 6368 416c  BDB.bibs.fetchAl
-00022ef0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00022f00: 2020 2020 2020 2070 6172 616d 733d 7b22         params={"
-00022f10: 6269 626b 6579 223a 2022 6162 222c 2022  bibkey": "ab", "
-00022f20: 6172 7869 7622 3a20 2265 6622 7d2c 0a20  arxiv": "ef"},. 
-00022f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f40: 2020 2063 6f6e 6e65 6374 696f 6e3d 226f     connection="o
-00022f50: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00022f60: 2020 2020 2020 2020 6f70 6572 6174 6f72          operator
-00022f70: 3d22 6c69 6b65 222c 0a20 2020 2020 2020  ="like",.       
-00022f80: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
-00022f90: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
-00022fa0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-00022fb0: 2020 5b22 6162 6322 2c20 2264 6566 225d    ["abc", "def"]
-00022fc0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00022fd0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-00022fe0: 6e28 0a20 2020 2020 2020 2020 2020 2073  n(.            s
-00022ff0: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
-00023000: 7374 5175 6572 792c 0a20 2020 2020 2020  stQuery,.       
-00023010: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00023020: 2020 2020 2020 2022 7365 6c65 6374 202a         "select *
-00023030: 2066 726f 6d20 656e 7472 6965 7320 2077   from entries  w
-00023040: 6865 7265 2062 6962 6b65 7920 6c69 6b65  here bibkey like
-00023050: 2020 3f20 2022 0a20 2020 2020 2020 2020    ?  ".         
-00023060: 2020 2020 2020 202b 2022 6f72 2061 7278         + "or arx
-00023070: 6976 206c 696b 6520 203f 2020 6f72 6465  iv like  ?  orde
-00023080: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
-00023090: 5343 222c 0a20 2020 2020 2020 2020 2020  SC",.           
-000230a0: 2020 2020 2022 7365 6c65 6374 202a 2066       "select * f
-000230b0: 726f 6d20 656e 7472 6965 7320 2077 6865  rom entries  whe
-000230c0: 7265 2061 7278 6976 206c 696b 6520 203f  re arxiv like  ?
-000230d0: 2020 220a 2020 2020 2020 2020 2020 2020    ".            
-000230e0: 2020 2020 2b20 226f 7220 6269 626b 6579      + "or bibkey
-000230f0: 206c 696b 6520 203f 2020 6f72 6465 7220   like  ?  order 
-00023100: 6279 2066 6972 7374 6461 7465 2041 5343  by firstdate ASC
-00023110: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
-00023120: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00023130: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00023140: 7175 616c 2873 6f72 7465 6428 7365 6c66  qual(sorted(self
-00023150: 2e70 4244 422e 6269 6273 2e6c 6173 7456  .pBDB.bibs.lastV
-00023160: 616c 7329 2c20 736f 7274 6564 2828 2225  als), sorted(("%
-00023170: 6162 2522 2c20 2225 6566 2522 2929 290a  ab%", "%ef%"))).
-00023180: 0a20 2020 2020 2020 2023 2074 6573 7420  .        # test 
-00023190: 736f 6d65 2062 6164 2063 6f6e 6e65 6374  some bad connect
-000231a0: 696f 6e20 6f72 206f 7065 7261 746f 720a  ion or operator.
-000231b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000231c0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-000231d0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-000231e0: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
-000231f0: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
-00023200: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
-00023210: 662e 7042 4442 2e62 6962 732e 6765 7441  f.pBDB.bibs.getA
-00023220: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-00023230: 2020 2020 2020 2020 7061 7261 6d73 3d7b          params={
-00023240: 2262 6962 6b65 7922 3a20 2261 6263 222c  "bibkey": "abc",
-00023250: 2022 6172 7869 7622 3a20 2264 6566 227d   "arxiv": "def"}
-00023260: 2c20 636f 6e6e 6563 7469 6f6e 3d22 6f20  , connection="o 
-00023270: 7222 0a20 2020 2020 2020 2020 2020 2020  r".             
-00023280: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00023290: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
-000232a0: 5b5d 2c0a 2020 2020 2020 2020 290a 2020  [],.        ).  
-000232b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000232c0: 7449 6e28 0a20 2020 2020 2020 2020 2020  tIn(.           
-000232d0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-000232e0: 6c61 7374 5175 6572 792c 0a20 2020 2020  lastQuery,.     
-000232f0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00023300: 2020 2020 2020 2020 2022 7365 6c65 6374           "select
-00023310: 202a 2066 726f 6d20 656e 7472 6965 7320   * from entries 
-00023320: 2077 6865 7265 2062 6962 6b65 7920 3d20   where bibkey = 
-00023330: 203f 2020 616e 6420 220a 2020 2020 2020   ?  and ".      
-00023340: 2020 2020 2020 2020 2020 2b20 2261 7278            + "arx
-00023350: 6976 203d 2020 3f20 206f 7264 6572 2062  iv =  ?  order b
-00023360: 7920 6669 7273 7464 6174 6520 4153 4322  y firstdate ASC"
-00023370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00023380: 2020 2273 656c 6563 7420 2a20 6672 6f6d    "select * from
-00023390: 2065 6e74 7269 6573 2020 7768 6572 6520   entries  where 
-000233a0: 6172 7869 7620 3d20 203f 2020 616e 6420  arxiv =  ?  and 
-000233b0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000233c0: 2020 2b20 2262 6962 6b65 7920 3d20 203f    + "bibkey =  ?
-000233d0: 2020 6f72 6465 7220 6279 2066 6972 7374    order by first
-000233e0: 6461 7465 2041 5343 222c 0a20 2020 2020  date ASC",.     
-000233f0: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00023400: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00023410: 2e61 7373 6572 7445 7175 616c 2873 6f72  .assertEqual(sor
-00023420: 7465 6428 7365 6c66 2e70 4244 422e 6269  ted(self.pBDB.bi
-00023430: 6273 2e6c 6173 7456 616c 7329 2c20 736f  bs.lastVals), so
-00023440: 7274 6564 2828 2261 6263 222c 2022 6465  rted(("abc", "de
-00023450: 6622 2929 290a 2020 2020 2020 2020 7365  f"))).        se
-00023460: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00023470: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00023480: 2020 2020 2020 2020 2020 2020 2020 655b                e[
-00023490: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
-000234a0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-000234b0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-000234c0: 732e 6665 7463 6841 6c6c 280a 2020 2020  s.fetchAll(.    
-000234d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000234e0: 7061 7261 6d73 3d7b 2262 6962 6b65 7922  params={"bibkey"
-000234f0: 3a20 2261 6222 2c20 2261 7278 6976 223a  : "ab", "arxiv":
-00023500: 2022 6566 227d 2c0a 2020 2020 2020 2020   "ef"},.        
-00023510: 2020 2020 2020 2020 2020 2020 636f 6e6e              conn
-00023520: 6563 7469 6f6e 3d22 6f72 222c 0a20 2020  ection="or",.   
-00023530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023540: 206f 7065 7261 746f 723d 226c 696b 222c   operator="lik",
-00023550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023560: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
-00023570: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-00023580: 2020 2020 2020 2020 2020 5b5d 2c0a 2020            [],.  
-00023590: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000235a0: 7365 6c66 2e61 7373 6572 7449 6e28 0a20  self.assertIn(. 
-000235b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000235c0: 7042 4442 2e62 6962 732e 6c61 7374 5175  pBDB.bibs.lastQu
-000235d0: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-000235e0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-000235f0: 2020 2022 7365 6c65 6374 202a 2066 726f     "select * fro
-00023600: 6d20 656e 7472 6965 7320 2077 6865 7265  m entries  where
-00023610: 2062 6962 6b65 7920 3d20 203f 2020 6f72   bibkey =  ?  or
-00023620: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00023630: 2020 202b 2022 6172 7869 7620 3d20 203f     + "arxiv =  ?
-00023640: 2020 6f72 6465 7220 6279 2066 6972 7374    order by first
-00023650: 6461 7465 2041 5343 222c 0a20 2020 2020  date ASC",.     
-00023660: 2020 2020 2020 2020 2020 2022 7365 6c65             "sele
-00023670: 6374 202a 2066 726f 6d20 656e 7472 6965  ct * from entrie
-00023680: 7320 2077 6865 7265 2061 7278 6976 203d  s  where arxiv =
-00023690: 2020 3f20 206f 7220 220a 2020 2020 2020    ?  or ".      
-000236a0: 2020 2020 2020 2020 2020 2b20 2262 6962            + "bib
-000236b0: 6b65 7920 3d20 203f 2020 6f72 6465 7220  key =  ?  order 
-000236c0: 6279 2066 6972 7374 6461 7465 2041 5343  by firstdate ASC
-000236d0: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
-000236e0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-000236f0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00023700: 7175 616c 2873 6f72 7465 6428 7365 6c66  qual(sorted(self
-00023710: 2e70 4244 422e 6269 6273 2e6c 6173 7456  .pBDB.bibs.lastV
-00023720: 616c 7329 2c20 736f 7274 6564 2828 2261  als), sorted(("a
-00023730: 6222 2c20 2265 6622 2929 290a 0a20 2020  b", "ef")))..   
-00023740: 2020 2020 2023 2067 656e 6572 6174 6520       # generate 
-00023750: 736f 6d65 2065 7272 6f72 730a 2020 2020  some errors.    
-00023760: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00023770: 7175 616c 285b 655b 2262 6962 6b65 7922  qual([e["bibkey"
-00023780: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
-00023790: 7042 4442 2e62 6962 732e 6765 7441 6c6c  pBDB.bibs.getAll
-000237a0: 286c 696d 6974 546f 3d22 6122 295d 2c20  (limitTo="a")], 
-000237b0: 5b5d 290a 2020 2020 2020 2020 7365 6c66  []).        self
-000237c0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-000237d0: 2020 2020 2020 2020 2020 5b65 5b22 6269            [e["bi
-000237e0: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
-000237f0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
-00023800: 6574 416c 6c28 6c69 6d69 7454 6f3d 2262  etAll(limitTo="b
-00023810: 6962 6b65 7922 295d 2c20 5b5d 0a20 2020  ibkey")], [].   
-00023820: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00023830: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00023840: 0a20 2020 2020 2020 2020 2020 205b 655b  .            [e[
-00023850: 2262 6962 6b65 7922 5d20 666f 7220 6520  "bibkey"] for e 
-00023860: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-00023870: 732e 6765 7441 6c6c 286c 696d 6974 546f  s.getAll(limitTo
-00023880: 3d31 2c20 6c69 6d69 744f 6666 7365 743d  =1, limitOffset=
-00023890: 2261 2229 5d2c 205b 5d0a 2020 2020 2020  "a")], [].      
-000238a0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-000238b0: 2e61 7373 6572 7445 7175 616c 285b 655b  .assertEqual([e[
-000238c0: 2262 6962 6b65 7922 5d20 666f 7220 6520  "bibkey"] for e 
-000238d0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-000238e0: 732e 6765 7441 6c6c 286f 7264 6572 4279  s.getAll(orderBy
-000238f0: 3d22 6122 295d 2c20 5b5d 290a 2020 2020  ="a")], []).    
-00023900: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00023910: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00023920: 2020 5b65 5b22 6269 626b 6579 225d 2066    [e["bibkey"] f
-00023930: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-00023940: 422e 6269 6273 2e67 6574 416c 6c28 6f72  B.bibs.getAll(or
-00023950: 6465 7254 7970 653d 2261 6263 2229 5d2c  derType="abc")],
-00023960: 0a20 2020 2020 2020 2020 2020 205b 2261  .            ["a
-00023970: 6263 222c 2022 6465 6622 2c20 2267 6869  bc", "def", "ghi
-00023980: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
-00023990: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000239a0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-000239b0: 2020 2020 5b65 5b22 6269 626b 6579 225d      [e["bibkey"]
-000239c0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-000239d0: 4244 422e 6269 6273 2e67 6574 416c 6c28  BDB.bibs.getAll(
-000239e0: 7061 7261 6d73 3d7b 2261 6263 223a 2022  params={"abc": "
-000239f0: 6269 626b 6579 227d 295d 2c20 5b5d 0a20  bibkey"})], []. 
-00023a00: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00023a10: 2020 2320 7465 7374 2064 6966 6665 7265    # test differe
-00023a20: 6e74 2063 7572 736f 7273 0a20 2020 2020  nt cursors.     
-00023a30: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00023a40: 732e 6c61 7374 4665 7463 6865 6420 3d20  s.lastFetched = 
-00023a50: 2274 6573 7422 0a20 2020 2020 2020 2073  "test".        s
-00023a60: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
-00023a70: 7374 5175 6572 7920 3d20 2274 6573 7420  stQuery = "test 
-00023a80: 7175 6572 7922 0a20 2020 2020 2020 2073  query".        s
-00023a90: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
-00023aa0: 7463 6841 6c6c 2864 6f46 6574 6368 3d46  tchAll(doFetch=F
-00023ab0: 616c 7365 290a 2020 2020 2020 2020 7365  alse).        se
-00023ac0: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
-00023ad0: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
-00023ae0: 6520 696e 2073 656c 662e 7042 4442 2e63  e in self.pBDB.c
-00023af0: 7572 735d 2c20 5b5d 290a 2020 2020 2020  urs], []).      
-00023b00: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00023b10: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00023b20: 5b65 5b22 6269 626b 6579 225d 2066 6f72  [e["bibkey"] for
-00023b30: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00023b40: 6269 6273 2e66 6574 6368 4375 7273 5d2c  bibs.fetchCurs],
-00023b50: 205b 2261 6263 222c 2022 6465 6622 2c20   ["abc", "def", 
-00023b60: 2267 6869 225d 0a20 2020 2020 2020 2029  "ghi"].        )
-00023b70: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00023b80: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
-00023b90: 4244 422e 6269 6273 2e6c 6173 7446 6574  BDB.bibs.lastFet
-00023ba0: 6368 6564 2c20 2274 6573 7422 290a 2020  ched, "test").  
-00023bb0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00023bc0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00023bd0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00023be0: 6273 2e6c 6173 7451 7565 7279 2c0a 2020  bs.lastQuery,.  
-00023bf0: 2020 2020 2020 2020 2020 2273 656c 6563            "selec
-00023c00: 7420 2a20 6672 6f6d 2065 6e74 7269 6573  t * from entries
-00023c10: 2020 6f72 6465 7220 6279 2066 6972 7374    order by first
-00023c20: 6461 7465 2041 5343 222c 0a20 2020 2020  date ASC",.     
-00023c30: 2020 2029 0a0a 2020 2020 2020 2020 7465     )..        te
-00023c40: 7374 4269 624e 616d 6520 3d20 6f73 2e70  stBibName = os.p
-00023c50: 6174 682e 6a6f 696e 2870 6243 6f6e 6669  ath.join(pbConfi
-00023c60: 672e 6461 7461 5061 7468 2c20 2274 6573  g.dataPath, "tes
-00023c70: 7473 5f25 732e 6269 6222 2025 2074 6f64  ts_%s.bib" % tod
-00023c80: 6179 5f79 6d64 290a 2020 2020 2020 2020  ay_ymd).        
-00023c90: 7361 6d70 6c65 5478 7420 3d20 280a 2020  sampleTxt = (.  
-00023ca0: 2020 2020 2020 2020 2020 2740 4172 7469            '@Arti
-00023cb0: 636c 657b 6162 632c 5c6e 2020 2020 2020  cle{abc,\n      
-00023cc0: 2020 6175 7468 6f72 203d 2022 6d65 222c    author = "me",
-00023cd0: 5c6e 2020 2020 2020 2020 2027 0a20 2020  \n         '.   
-00023ce0: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
-00023cf0: 6520 3d20 227b 6162 637d 222c 5c6e 7d5c  e = "{abc}",\n}\
-00023d00: 6e40 4172 7469 636c 657b 6465 662c 5c6e  n@Article{def,\n
-00023d10: 2020 2020 2020 2020 270a 2020 2020 2020          '.      
-00023d20: 2020 2020 2020 2b20 2761 7574 686f 7220        + 'author 
+00021360: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00021370: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00021380: 7374 6174 732c 0a20 2020 2020 2020 2020  stats,.         
+00021390: 2020 207b 2262 6962 7322 3a20 332c 2022     {"bibs": 3, "
+000213a0: 6361 7473 223a 2032 2c20 2265 7870 7322  cats": 2, "exps"
+000213b0: 3a20 302c 2022 6361 7442 6962 223a 2031  : 0, "catBib": 1
+000213c0: 2c20 2263 6174 4578 7022 3a20 302c 2022  , "catExp": 0, "
+000213d0: 6269 6245 7870 223a 2031 7d2c 0a20 2020  bibExp": 1},.   
+000213e0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+000213f0: 656c 662e 7042 4442 2e62 6962 732e 6465  elf.pBDB.bibs.de
+00021400: 6c65 7465 2822 6161 6122 290a 2020 2020  lete("aaa").    
+00021410: 2020 2020 6462 5374 6174 7328 7365 6c66      dbStats(self
+00021420: 2e70 4244 4229 0a20 2020 2020 2020 2073  .pBDB).        s
+00021430: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00021440: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00021450: 662e 7042 4442 2e73 7461 7473 2c0a 2020  f.pBDB.stats,.  
+00021460: 2020 2020 2020 2020 2020 7b22 6269 6273            {"bibs
+00021470: 223a 2033 2c20 2263 6174 7322 3a20 322c  ": 3, "cats": 2,
+00021480: 2022 6578 7073 223a 2030 2c20 2263 6174   "exps": 0, "cat
+00021490: 4269 6222 3a20 312c 2022 6361 7445 7870  Bib": 1, "catExp
+000214a0: 223a 2030 2c20 2262 6962 4578 7022 3a20  ": 0, "bibExp": 
+000214b0: 317d 2c0a 2020 2020 2020 2020 290a 2020  1},.        ).  
+000214c0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+000214d0: 6269 6273 2e64 656c 6574 6528 2261 6263  bibs.delete("abc
+000214e0: 2229 0a20 2020 2020 2020 2064 6253 7461  ").        dbSta
+000214f0: 7473 2873 656c 662e 7042 4442 290a 2020  ts(self.pBDB).  
+00021500: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00021510: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00021520: 2020 2020 7365 6c66 2e70 4244 422e 7374      self.pBDB.st
+00021530: 6174 732c 0a20 2020 2020 2020 2020 2020  ats,.           
+00021540: 207b 2262 6962 7322 3a20 322c 2022 6361   {"bibs": 2, "ca
+00021550: 7473 223a 2032 2c20 2265 7870 7322 3a20  ts": 2, "exps": 
+00021560: 302c 2022 6361 7442 6962 223a 2030 2c20  0, "catBib": 0, 
+00021570: 2263 6174 4578 7022 3a20 302c 2022 6269  "catExp": 0, "bi
+00021580: 6245 7870 223a 2030 7d2c 0a20 2020 2020  bExp": 0},.     
+00021590: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+000215a0: 662e 7042 4442 2e62 6962 732e 6465 6c65  f.pBDB.bibs.dele
+000215b0: 7465 285b 2264 6566 222c 2022 6768 6922  te(["def", "ghi"
+000215c0: 5d29 0a20 2020 2020 2020 2064 6253 7461  ]).        dbSta
+000215d0: 7473 2873 656c 662e 7042 4442 290a 2020  ts(self.pBDB).  
+000215e0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000215f0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00021600: 2020 2020 7365 6c66 2e70 4244 422e 7374      self.pBDB.st
+00021610: 6174 732c 0a20 2020 2020 2020 2020 2020  ats,.           
+00021620: 207b 2262 6962 7322 3a20 302c 2022 6361   {"bibs": 0, "ca
+00021630: 7473 223a 2032 2c20 2265 7870 7322 3a20  ts": 2, "exps": 
+00021640: 302c 2022 6361 7442 6962 223a 2030 2c20  0, "catBib": 0, 
+00021650: 2263 6174 4578 7022 3a20 302c 2022 6269  "catExp": 0, "bi
+00021660: 6245 7870 223a 2030 7d2c 0a20 2020 2020  bExp": 0},.     
+00021670: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
+00021680: 7374 5f66 6574 6368 416c 6c28 7365 6c66  st_fetchAll(self
+00021690: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
+000216a0: 2020 2222 2254 6573 7420 7468 6520 6665    """Test the fe
+000216b0: 7463 6841 6c6c 2061 6e64 2067 6574 416c  tchAll and getAl
+000216c0: 6c20 6675 6e63 7469 6f6e 7322 2222 0a20  l functions""". 
+000216d0: 2020 2020 2020 2023 2067 656e 6572 6963         # generic
+000216e0: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
+000216f0: 7365 7274 5f74 6872 6565 2829 0a20 2020  sert_three().   
+00021700: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00021710: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00021720: 2020 205b 655b 2262 6962 6b65 7922 5d20     [e["bibkey"] 
+00021730: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+00021740: 4442 2e62 6962 732e 6765 7441 6c6c 2829  DB.bibs.getAll()
+00021750: 5d2c 205b 2261 6263 222c 2022 6465 6622  ], ["abc", "def"
+00021760: 2c20 2267 6869 225d 0a20 2020 2020 2020  , "ghi"].       
+00021770: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00021780: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00021790: 2020 2020 2020 2020 205b 655b 2262 6962           [e["bib
+000217a0: 6b65 7922 5d20 666f 7220 6520 696e 2073  key"] for e in s
+000217b0: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
+000217c0: 7463 6841 6c6c 2829 2e6c 6173 7446 6574  tchAll().lastFet
+000217d0: 6368 6564 5d2c 0a20 2020 2020 2020 2020  ched],.         
+000217e0: 2020 205b 2261 6263 222c 2022 6465 6622     ["abc", "def"
+000217f0: 2c20 2267 6869 225d 2c0a 2020 2020 2020  , "ghi"],.      
+00021800: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00021810: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00021820: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00021830: 4244 422e 6269 6273 2e6c 6173 7451 7565  BDB.bibs.lastQue
+00021840: 7279 2c20 2273 656c 6563 7420 2a20 6672  ry, "select * fr
+00021850: 6f6d 2065 6e74 7269 6573 2020 6f72 6465  om entries  orde
+00021860: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
+00021870: 5343 220a 2020 2020 2020 2020 290a 2020  SC".        ).  
+00021880: 2020 2020 2020 2320 7361 7665 5175 6572        # saveQuer
+00021890: 790a 2020 2020 2020 2020 7365 6c66 2e70  y.        self.p
+000218a0: 4244 422e 6269 6273 2e6c 6173 7451 7565  BDB.bibs.lastQue
+000218b0: 7279 203d 2022 220a 2020 2020 2020 2020  ry = "".        
+000218c0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+000218d0: 6574 416c 6c28 7361 7665 5175 6572 793d  etAll(saveQuery=
+000218e0: 4661 6c73 6529 0a20 2020 2020 2020 2073  False).        s
+000218f0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00021900: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
+00021910: 6173 7451 7565 7279 2c20 2222 290a 2020  astQuery, "").  
+00021920: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00021930: 6269 6273 2e66 6574 6368 416c 6c28 7361  bibs.fetchAll(sa
+00021940: 7665 5175 6572 793d 4661 6c73 6529 0a20  veQuery=False). 
+00021950: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00021960: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+00021970: 422e 6269 6273 2e6c 6173 7451 7565 7279  B.bibs.lastQuery
+00021980: 2c20 2222 290a 2020 2020 2020 2020 2320  , "").        # 
+00021990: 6c69 6d69 7454 6f0a 2020 2020 2020 2020  limitTo.        
+000219a0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+000219b0: 280a 2020 2020 2020 2020 2020 2020 5b65  (.            [e
+000219c0: 5b22 6269 626b 6579 225d 2066 6f72 2065  ["bibkey"] for e
+000219d0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+000219e0: 6273 2e67 6574 416c 6c28 6c69 6d69 7454  bs.getAll(limitT
+000219f0: 6f3d 3129 5d2c 205b 2261 6263 225d 0a20  o=1)], ["abc"]. 
+00021a00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00021a10: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00021a20: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00021a30: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
+00021a40: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+00021a50: 6962 732e 6665 7463 6841 6c6c 286c 696d  ibs.fetchAll(lim
+00021a60: 6974 546f 3d31 292e 6c61 7374 4665 7463  itTo=1).lastFetc
+00021a70: 6865 645d 2c0a 2020 2020 2020 2020 2020  hed],.          
+00021a80: 2020 5b22 6162 6322 5d2c 0a20 2020 2020    ["abc"],.     
+00021a90: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00021aa0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00021ab0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00021ac0: 7042 4442 2e62 6962 732e 6c61 7374 5175  pBDB.bibs.lastQu
+00021ad0: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+00021ae0: 2022 7365 6c65 6374 202a 2066 726f 6d20   "select * from 
+00021af0: 656e 7472 6965 7320 206f 7264 6572 2062  entries  order b
+00021b00: 7920 6669 7273 7464 6174 6520 4153 4320  y firstdate ASC 
+00021b10: 4c49 4d49 5420 3122 2c0a 2020 2020 2020  LIMIT 1",.      
+00021b20: 2020 290a 2020 2020 2020 2020 2320 6c69    ).        # li
+00021b30: 6d69 7454 6f20 2b20 6c69 6d69 744f 6666  mitTo + limitOff
+00021b40: 7365 740a 2020 2020 2020 2020 7365 6c66  set.        self
+00021b50: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00021b60: 2020 2020 2020 2020 2020 5b65 5b22 6269            [e["bi
+00021b70: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
+00021b80: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+00021b90: 6574 416c 6c28 6c69 6d69 7454 6f3d 352c  etAll(limitTo=5,
+00021ba0: 206c 696d 6974 4f66 6673 6574 3d31 295d   limitOffset=1)]
+00021bb0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+00021bc0: 6465 6622 2c20 2267 6869 225d 2c0a 2020  def", "ghi"],.  
+00021bd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00021be0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00021bf0: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
+00021c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c10: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
+00021c20: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00021c30: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+00021c40: 6962 732e 6665 7463 6841 6c6c 286c 696d  ibs.fetchAll(lim
+00021c50: 6974 546f 3d35 2c20 6c69 6d69 744f 6666  itTo=5, limitOff
+00021c60: 7365 743d 3129 2e6c 6173 7446 6574 6368  set=1).lastFetch
+00021c70: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
+00021c80: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+00021c90: 6465 6622 2c20 2267 6869 225d 2c0a 2020  def", "ghi"],.  
+00021ca0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00021cb0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00021cc0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00021cd0: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
+00021ce0: 7451 7565 7279 2c0a 2020 2020 2020 2020  tQuery,.        
+00021cf0: 2020 2020 2273 656c 6563 7420 2a20 6672      "select * fr
+00021d00: 6f6d 2065 6e74 7269 6573 2020 6f72 6465  om entries  orde
+00021d10: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
+00021d20: 5343 204c 494d 4954 2035 204f 4646 5345  SC LIMIT 5 OFFSE
+00021d30: 5420 3122 2c0a 2020 2020 2020 2020 290a  T 1",.        ).
+00021d40: 2020 2020 2020 2020 2320 6c69 6d69 744f          # limitO
+00021d50: 6666 7365 7420 616c 6f6e 6520 286e 6f20  ffset alone (no 
+00021d60: 6566 6665 6374 290a 2020 2020 2020 2020  effect).        
+00021d70: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00021d80: 280a 2020 2020 2020 2020 2020 2020 5b65  (.            [e
+00021d90: 5b22 6269 626b 6579 225d 2066 6f72 2065  ["bibkey"] for e
+00021da0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+00021db0: 6273 2e67 6574 416c 6c28 6c69 6d69 744f  bs.getAll(limitO
+00021dc0: 6666 7365 743d 3129 5d2c 0a20 2020 2020  ffset=1)],.     
+00021dd0: 2020 2020 2020 205b 2261 6263 222c 2022         ["abc", "
+00021de0: 6465 6622 2c20 2267 6869 225d 2c0a 2020  def", "ghi"],.  
+00021df0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00021e00: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00021e10: 280a 2020 2020 2020 2020 2020 2020 5b65  (.            [e
+00021e20: 5b22 6269 626b 6579 225d 2066 6f72 2065  ["bibkey"] for e
+00021e30: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+00021e40: 6273 2e66 6574 6368 416c 6c28 6c69 6d69  bs.fetchAll(limi
+00021e50: 744f 6666 7365 743d 3129 2e6c 6173 7446  tOffset=1).lastF
+00021e60: 6574 6368 6564 5d2c 0a20 2020 2020 2020  etched],.       
+00021e70: 2020 2020 205b 2261 6263 222c 2022 6465       ["abc", "de
+00021e80: 6622 2c20 2267 6869 225d 2c0a 2020 2020  f", "ghi"],.    
+00021e90: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00021ea0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00021eb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00021ec0: 2e70 4244 422e 6269 6273 2e6c 6173 7451  .pBDB.bibs.lastQ
+00021ed0: 7565 7279 2c20 2273 656c 6563 7420 2a20  uery, "select * 
+00021ee0: 6672 6f6d 2065 6e74 7269 6573 2020 6f72  from entries  or
+00021ef0: 6465 7220 6279 2066 6972 7374 6461 7465  der by firstdate
+00021f00: 2041 5343 220a 2020 2020 2020 2020 290a   ASC".        ).
+00021f10: 2020 2020 2020 2020 2320 6f72 6465 7254          # orderT
+00021f20: 7970 650a 2020 2020 2020 2020 7365 6c66  ype.        self
+00021f30: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00021f40: 2020 2020 2020 2020 2020 5b65 5b22 6269            [e["bi
+00021f50: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
+00021f60: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+00021f70: 6574 416c 6c28 6f72 6465 7254 7970 653d  etAll(orderType=
+00021f80: 2244 4553 4322 295d 2c0a 2020 2020 2020  "DESC")],.      
+00021f90: 2020 2020 2020 5b22 6162 6322 2c20 2264        ["abc", "d
+00021fa0: 6566 222c 2022 6768 6922 5d2c 0a20 2020  ef", "ghi"],.   
+00021fb0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00021fc0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00021fd0: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
+00021fe0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00021ff0: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+00022000: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+00022010: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+00022020: 6273 2e66 6574 6368 416c 6c28 6f72 6465  bs.fetchAll(orde
+00022030: 7254 7970 653d 2244 4553 4322 292e 6c61  rType="DESC").la
+00022040: 7374 4665 7463 6865 640a 2020 2020 2020  stFetched.      
+00022050: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+00022060: 2020 2020 205b 2261 6263 222c 2022 6465       ["abc", "de
+00022070: 6622 2c20 2267 6869 225d 2c0a 2020 2020  f", "ghi"],.    
+00022080: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00022090: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+000220a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000220b0: 2e70 4244 422e 6269 6273 2e6c 6173 7451  .pBDB.bibs.lastQ
+000220c0: 7565 7279 2c20 2273 656c 6563 7420 2a20  uery, "select * 
+000220d0: 6672 6f6d 2065 6e74 7269 6573 2020 6f72  from entries  or
+000220e0: 6465 7220 6279 2066 6972 7374 6461 7465  der by firstdate
+000220f0: 2044 4553 4322 0a20 2020 2020 2020 2029   DESC".        )
+00022100: 0a20 2020 2020 2020 2023 206f 7264 6572  .        # order
+00022110: 4279 0a20 2020 2020 2020 2073 656c 662e  By.        self.
+00022120: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00022130: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00022140: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
+00022150: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
+00022160: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
+00022170: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+00022180: 6574 416c 6c28 6f72 6465 7242 793d 2262  etAll(orderBy="b
+00022190: 6962 6b65 7922 2c20 6f72 6465 7254 7970  ibkey", orderTyp
+000221a0: 653d 2244 4553 4322 290a 2020 2020 2020  e="DESC").      
+000221b0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+000221c0: 2020 2020 205b 2267 6869 222c 2022 6465       ["ghi", "de
+000221d0: 6622 2c20 2261 6263 225d 2c0a 2020 2020  f", "abc"],.    
+000221e0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+000221f0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00022200: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00022210: 2020 2020 2020 2020 2020 2020 2020 655b                e[
+00022220: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
+00022230: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
+00022240: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
+00022250: 732e 6665 7463 6841 6c6c 280a 2020 2020  s.fetchAll(.    
+00022260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022270: 6f72 6465 7242 793d 2262 6962 6b65 7922  orderBy="bibkey"
+00022280: 2c20 6f72 6465 7254 7970 653d 2244 4553  , orderType="DES
+00022290: 4322 0a20 2020 2020 2020 2020 2020 2020  C".             
+000222a0: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
+000222b0: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
+000222c0: 2020 2020 2020 2020 2020 2020 5b22 6768              ["gh
+000222d0: 6922 2c20 2264 6566 222c 2022 6162 6322  i", "def", "abc"
+000222e0: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+000222f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00022300: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00022310: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+00022320: 732e 6c61 7374 5175 6572 792c 2022 7365  s.lastQuery, "se
+00022330: 6c65 6374 202a 2066 726f 6d20 656e 7472  lect * from entr
+00022340: 6965 7320 206f 7264 6572 2062 7920 6269  ies  order by bi
+00022350: 626b 6579 2044 4553 4322 0a20 2020 2020  bkey DESC".     
+00022360: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+00022370: 736f 6d65 2070 6172 616d 6574 6572 2063  some parameter c
+00022380: 6f6d 6269 6e61 7469 6f6e 730a 2020 2020  ombinations.    
+00022390: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000223a0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+000223b0: 2020 5b65 5b22 6269 626b 6579 225d 2066    [e["bibkey"] f
+000223c0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+000223d0: 422e 6269 6273 2e67 6574 416c 6c28 7061  B.bibs.getAll(pa
+000223e0: 7261 6d73 3d7b 2262 6962 6b65 7922 3a20  rams={"bibkey": 
+000223f0: 2261 6263 227d 295d 2c0a 2020 2020 2020  "abc"})],.      
+00022400: 2020 2020 2020 5b22 6162 6322 5d2c 0a20        ["abc"],. 
+00022410: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00022420: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00022430: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00022440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022450: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00022460: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00022470: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00022480: 6269 6273 2e66 6574 6368 416c 6c28 7061  bibs.fetchAll(pa
+00022490: 7261 6d73 3d7b 2262 6962 6b65 7922 3a20  rams={"bibkey": 
+000224a0: 2261 6263 227d 292e 6c61 7374 4665 7463  "abc"}).lastFetc
+000224b0: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
+000224c0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+000224d0: 2261 6263 225d 2c0a 2020 2020 2020 2020  "abc"],.        
+000224e0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000224f0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00022500: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00022510: 422e 6269 6273 2e6c 6173 7451 7565 7279  B.bibs.lastQuery
+00022520: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+00022530: 656c 6563 7420 2a20 6672 6f6d 2065 6e74  elect * from ent
+00022540: 7269 6573 2020 7768 6572 6520 6269 626b  ries  where bibk
+00022550: 6579 203d 2020 3f20 206f 7264 6572 2062  ey =  ?  order b
+00022560: 7920 6669 7273 7464 6174 6520 4153 4322  y firstdate ASC"
+00022570: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00022580: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00022590: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
+000225a0: 6962 732e 6c61 7374 5661 6c73 2c20 2822  ibs.lastVals, ("
+000225b0: 6162 6322 2c29 290a 2020 2020 2020 2020  abc",)).        
+000225c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+000225d0: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
+000225e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000225f0: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
+00022600: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00022610: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+00022620: 6962 732e 6765 7441 6c6c 2870 6172 616d  ibs.getAll(param
+00022630: 733d 7b22 6269 626b 6579 223a 2022 6162  s={"bibkey": "ab
+00022640: 6322 2c20 2261 7278 6976 223a 2022 6465  c", "arxiv": "de
+00022650: 6622 7d29 0a20 2020 2020 2020 2020 2020  f"}).           
+00022660: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+00022670: 5b5d 2c0a 2020 2020 2020 2020 290a 2020  [],.        ).  
+00022680: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00022690: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+000226a0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+000226b0: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
+000226c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000226d0: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
+000226e0: 7042 4442 2e62 6962 732e 6665 7463 6841  pBDB.bibs.fetchA
+000226f0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+00022700: 2020 2020 2020 2020 7061 7261 6d73 3d7b          params={
+00022710: 2262 6962 6b65 7922 3a20 2261 6263 222c  "bibkey": "abc",
+00022720: 2022 6172 7869 7622 3a20 2264 6566 227d   "arxiv": "def"}
+00022730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022740: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
+00022750: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+00022760: 2020 2020 2020 2020 2020 5b5d 2c0a 2020            [],.  
+00022770: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00022780: 7365 6c66 2e61 7373 6572 7449 6e28 0a20  self.assertIn(. 
+00022790: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000227a0: 7042 4442 2e62 6962 732e 6c61 7374 5175  pBDB.bibs.lastQu
+000227b0: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+000227c0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+000227d0: 2020 2022 7365 6c65 6374 202a 2066 726f     "select * fro
+000227e0: 6d20 656e 7472 6965 7320 2077 6865 7265  m entries  where
+000227f0: 2062 6962 6b65 7920 3d20 203f 2020 220a   bibkey =  ?  ".
+00022800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022810: 2b20 2261 6e64 2061 7278 6976 203d 2020  + "and arxiv =  
+00022820: 3f20 206f 7264 6572 2062 7920 6669 7273  ?  order by firs
+00022830: 7464 6174 6520 4153 4322 2c0a 2020 2020  tdate ASC",.    
+00022840: 2020 2020 2020 2020 2020 2020 2273 656c              "sel
+00022850: 6563 7420 2a20 6672 6f6d 2065 6e74 7269  ect * from entri
+00022860: 6573 2020 7768 6572 6520 6172 7869 7620  es  where arxiv 
+00022870: 3d20 203f 2020 616e 6420 220a 2020 2020  =  ?  and ".    
+00022880: 2020 2020 2020 2020 2020 2020 2b20 2262              + "b
+00022890: 6962 6b65 7920 3d20 203f 2020 6f72 6465  ibkey =  ?  orde
+000228a0: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
+000228b0: 5343 222c 0a20 2020 2020 2020 2020 2020  SC",.           
+000228c0: 205d 2c0a 2020 2020 2020 2020 290a 2020   ],.        ).  
+000228d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000228e0: 7445 7175 616c 2873 6f72 7465 6428 7365  tEqual(sorted(se
+000228f0: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
+00022900: 7456 616c 7329 2c20 736f 7274 6564 2828  tVals), sorted((
+00022910: 2261 6263 222c 2022 6465 6622 2929 290a  "abc", "def"))).
+00022920: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00022930: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00022940: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00022950: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
+00022960: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+00022970: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+00022980: 662e 7042 4442 2e62 6962 732e 6765 7441  f.pBDB.bibs.getA
+00022990: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+000229a0: 2020 2020 2020 2020 7061 7261 6d73 3d7b          params={
+000229b0: 2262 6962 6b65 7922 3a20 2261 6263 222c  "bibkey": "abc",
+000229c0: 2022 6172 7869 7622 3a20 2264 6566 227d   "arxiv": "def"}
+000229d0: 2c20 636f 6e6e 6563 7469 6f6e 3d22 6f72  , connection="or
+000229e0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000229f0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00022a00: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+00022a10: 2261 6263 222c 2022 6465 6622 5d2c 0a20  "abc", "def"],. 
+00022a20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00022a30: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00022a40: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00022a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022a60: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00022a70: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00022a80: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00022a90: 6269 6273 2e66 6574 6368 416c 6c28 0a20  bibs.fetchAll(. 
+00022aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ab0: 2020 2070 6172 616d 733d 7b22 6269 626b     params={"bibk
+00022ac0: 6579 223a 2022 6162 6322 2c20 2261 7278  ey": "abc", "arx
+00022ad0: 6976 223a 2022 6465 6622 7d2c 2063 6f6e  iv": "def"}, con
+00022ae0: 6e65 6374 696f 6e3d 226f 7222 0a20 2020  nection="or".   
+00022af0: 2020 2020 2020 2020 2020 2020 2029 2e6c               ).l
+00022b00: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
+00022b10: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+00022b20: 2020 2020 2020 5b22 6162 6322 2c20 2264        ["abc", "d
+00022b30: 6566 225d 2c0a 2020 2020 2020 2020 290a  ef"],.        ).
+00022b40: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00022b50: 6572 7449 6e28 0a20 2020 2020 2020 2020  ertIn(.         
+00022b60: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+00022b70: 732e 6c61 7374 5175 6572 792c 0a20 2020  s.lastQuery,.   
+00022b80: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00022b90: 2020 2020 2020 2020 2020 2022 7365 6c65             "sele
+00022ba0: 6374 202a 2066 726f 6d20 656e 7472 6965  ct * from entrie
+00022bb0: 7320 2077 6865 7265 2062 6962 6b65 7920  s  where bibkey 
+00022bc0: 3d20 203f 2020 6f72 2022 0a20 2020 2020  =  ?  or ".     
+00022bd0: 2020 2020 2020 2020 2020 202b 2022 6172             + "ar
+00022be0: 7869 7620 3d20 203f 2020 6f72 6465 7220  xiv =  ?  order 
+00022bf0: 6279 2066 6972 7374 6461 7465 2041 5343  by firstdate ASC
+00022c00: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00022c10: 2020 2022 7365 6c65 6374 202a 2066 726f     "select * fro
+00022c20: 6d20 656e 7472 6965 7320 2077 6865 7265  m entries  where
+00022c30: 2061 7278 6976 203d 2020 3f20 206f 7220   arxiv =  ?  or 
+00022c40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00022c50: 2020 2b20 2262 6962 6b65 7920 3d20 203f    + "bibkey =  ?
+00022c60: 2020 6f72 6465 7220 6279 2066 6972 7374    order by first
+00022c70: 6461 7465 2041 5343 222c 0a20 2020 2020  date ASC",.     
+00022c80: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+00022c90: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00022ca0: 2e61 7373 6572 7445 7175 616c 2873 6f72  .assertEqual(sor
+00022cb0: 7465 6428 7365 6c66 2e70 4244 422e 6269  ted(self.pBDB.bi
+00022cc0: 6273 2e6c 6173 7456 616c 7329 2c20 736f  bs.lastVals), so
+00022cd0: 7274 6564 2828 2261 6263 222c 2022 6465  rted(("abc", "de
+00022ce0: 6622 2929 290a 2020 2020 2020 2020 7365  f"))).        se
+00022cf0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00022d00: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00022d10: 2020 2020 2020 2020 2020 2020 2020 655b                e[
+00022d20: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
+00022d30: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
+00022d40: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
+00022d50: 732e 6765 7441 6c6c 280a 2020 2020 2020  s.getAll(.      
+00022d60: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00022d70: 7261 6d73 3d7b 2262 6962 6b65 7922 3a20  rams={"bibkey": 
+00022d80: 2261 6222 2c20 2261 7278 6976 223a 2022  "ab", "arxiv": "
+00022d90: 6566 227d 2c0a 2020 2020 2020 2020 2020  ef"},.          
+00022da0: 2020 2020 2020 2020 2020 636f 6e6e 6563            connec
+00022db0: 7469 6f6e 3d22 6f72 222c 0a20 2020 2020  tion="or",.     
+00022dc0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00022dd0: 7065 7261 746f 723d 226c 696b 6522 2c0a  perator="like",.
+00022de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022df0: 290a 2020 2020 2020 2020 2020 2020 5d2c  ).            ],
+00022e00: 0a20 2020 2020 2020 2020 2020 205b 2261  .            ["a
+00022e10: 6263 222c 2022 6465 6622 5d2c 0a20 2020  bc", "def"],.   
+00022e20: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00022e30: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00022e40: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
+00022e50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00022e60: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+00022e70: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+00022e80: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+00022e90: 6273 2e66 6574 6368 416c 6c28 0a20 2020  bs.fetchAll(.   
+00022ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022eb0: 2070 6172 616d 733d 7b22 6269 626b 6579   params={"bibkey
+00022ec0: 223a 2022 6162 222c 2022 6172 7869 7622  ": "ab", "arxiv"
+00022ed0: 3a20 2265 6622 7d2c 0a20 2020 2020 2020  : "ef"},.       
+00022ee0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+00022ef0: 6e65 6374 696f 6e3d 226f 7222 2c0a 2020  nection="or",.  
+00022f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f10: 2020 6f70 6572 6174 6f72 3d22 6c69 6b65    operator="like
+00022f20: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00022f30: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
+00022f40: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
+00022f50: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+00022f60: 6322 2c20 2264 6566 225d 2c0a 2020 2020  c", "def"],.    
+00022f70: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00022f80: 6c66 2e61 7373 6572 7449 6e28 0a20 2020  lf.assertIn(.   
+00022f90: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00022fa0: 4442 2e62 6962 732e 6c61 7374 5175 6572  DB.bibs.lastQuer
+00022fb0: 792c 0a20 2020 2020 2020 2020 2020 205b  y,.            [
+00022fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022fd0: 2022 7365 6c65 6374 202a 2066 726f 6d20   "select * from 
+00022fe0: 656e 7472 6965 7320 2077 6865 7265 2062  entries  where b
+00022ff0: 6962 6b65 7920 6c69 6b65 2020 3f20 2022  ibkey like  ?  "
+00023000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023010: 202b 2022 6f72 2061 7278 6976 206c 696b   + "or arxiv lik
+00023020: 6520 203f 2020 6f72 6465 7220 6279 2066  e  ?  order by f
+00023030: 6972 7374 6461 7465 2041 5343 222c 0a20  irstdate ASC",. 
+00023040: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00023050: 7365 6c65 6374 202a 2066 726f 6d20 656e  select * from en
+00023060: 7472 6965 7320 2077 6865 7265 2061 7278  tries  where arx
+00023070: 6976 206c 696b 6520 203f 2020 220a 2020  iv like  ?  ".  
+00023080: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+00023090: 226f 7220 6269 626b 6579 206c 696b 6520  "or bibkey like 
+000230a0: 203f 2020 6f72 6465 7220 6279 2066 6972   ?  order by fir
+000230b0: 7374 6461 7465 2041 5343 222c 0a20 2020  stdate ASC",.   
+000230c0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+000230d0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+000230e0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+000230f0: 6f72 7465 6428 7365 6c66 2e70 4244 422e  orted(self.pBDB.
+00023100: 6269 6273 2e6c 6173 7456 616c 7329 2c20  bibs.lastVals), 
+00023110: 736f 7274 6564 2828 2225 6162 2522 2c20  sorted(("%ab%", 
+00023120: 2225 6566 2522 2929 290a 0a20 2020 2020  "%ef%")))..     
+00023130: 2020 2023 2074 6573 7420 736f 6d65 2062     # test some b
+00023140: 6164 2063 6f6e 6e65 6374 696f 6e20 6f72  ad connection or
+00023150: 206f 7065 7261 746f 720a 2020 2020 2020   operator.      
+00023160: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00023170: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00023180: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00023190: 2020 655b 2262 6962 6b65 7922 5d0a 2020    e["bibkey"].  
+000231a0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+000231b0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+000231c0: 2e62 6962 732e 6765 7441 6c6c 280a 2020  .bibs.getAll(.  
+000231d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231e0: 2020 7061 7261 6d73 3d7b 2262 6962 6b65    params={"bibke
+000231f0: 7922 3a20 2261 6263 222c 2022 6172 7869  y": "abc", "arxi
+00023200: 7622 3a20 2264 6566 227d 2c20 636f 6e6e  v": "def"}, conn
+00023210: 6563 7469 6f6e 3d22 6f20 7222 0a20 2020  ection="o r".   
+00023220: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00023230: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+00023240: 2020 2020 2020 2020 2020 5b5d 2c0a 2020            [],.  
+00023250: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00023260: 7365 6c66 2e61 7373 6572 7449 6e28 0a20  self.assertIn(. 
+00023270: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00023280: 7042 4442 2e62 6962 732e 6c61 7374 5175  pBDB.bibs.lastQu
+00023290: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+000232a0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+000232b0: 2020 2022 7365 6c65 6374 202a 2066 726f     "select * fro
+000232c0: 6d20 656e 7472 6965 7320 2077 6865 7265  m entries  where
+000232d0: 2062 6962 6b65 7920 3d20 203f 2020 616e   bibkey =  ?  an
+000232e0: 6420 220a 2020 2020 2020 2020 2020 2020  d ".            
+000232f0: 2020 2020 2b20 2261 7278 6976 203d 2020      + "arxiv =  
+00023300: 3f20 206f 7264 6572 2062 7920 6669 7273  ?  order by firs
+00023310: 7464 6174 6520 4153 4322 2c0a 2020 2020  tdate ASC",.    
+00023320: 2020 2020 2020 2020 2020 2020 2273 656c              "sel
+00023330: 6563 7420 2a20 6672 6f6d 2065 6e74 7269  ect * from entri
+00023340: 6573 2020 7768 6572 6520 6172 7869 7620  es  where arxiv 
+00023350: 3d20 203f 2020 616e 6420 220a 2020 2020  =  ?  and ".    
+00023360: 2020 2020 2020 2020 2020 2020 2b20 2262              + "b
+00023370: 6962 6b65 7920 3d20 203f 2020 6f72 6465  ibkey =  ?  orde
+00023380: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
+00023390: 5343 222c 0a20 2020 2020 2020 2020 2020  SC",.           
+000233a0: 205d 2c0a 2020 2020 2020 2020 290a 2020   ],.        ).  
+000233b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000233c0: 7445 7175 616c 2873 6f72 7465 6428 7365  tEqual(sorted(se
+000233d0: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
+000233e0: 7456 616c 7329 2c20 736f 7274 6564 2828  tVals), sorted((
+000233f0: 2261 6263 222c 2022 6465 6622 2929 290a  "abc", "def"))).
+00023400: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00023410: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00023420: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00023430: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
+00023440: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+00023450: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+00023460: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+00023470: 6841 6c6c 280a 2020 2020 2020 2020 2020  hAll(.          
+00023480: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+00023490: 3d7b 2262 6962 6b65 7922 3a20 2261 6222  ={"bibkey": "ab"
+000234a0: 2c20 2261 7278 6976 223a 2022 6566 227d  , "arxiv": "ef"}
+000234b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000234c0: 2020 2020 2020 636f 6e6e 6563 7469 6f6e        connection
+000234d0: 3d22 6f72 222c 0a20 2020 2020 2020 2020  ="or",.         
+000234e0: 2020 2020 2020 2020 2020 206f 7065 7261             opera
+000234f0: 746f 723d 226c 696b 222c 0a20 2020 2020  tor="lik",.     
+00023500: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
+00023510: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
+00023520: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00023530: 2020 2020 5b5d 2c0a 2020 2020 2020 2020      [],.        
+00023540: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00023550: 7373 6572 7449 6e28 0a20 2020 2020 2020  ssertIn(.       
+00023560: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00023570: 6962 732e 6c61 7374 5175 6572 792c 0a20  ibs.lastQuery,. 
+00023580: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+00023590: 2020 2020 2020 2020 2020 2020 2022 7365               "se
+000235a0: 6c65 6374 202a 2066 726f 6d20 656e 7472  lect * from entr
+000235b0: 6965 7320 2077 6865 7265 2062 6962 6b65  ies  where bibke
+000235c0: 7920 3d20 203f 2020 6f72 2022 0a20 2020  y =  ?  or ".   
+000235d0: 2020 2020 2020 2020 2020 2020 202b 2022               + "
+000235e0: 6172 7869 7620 3d20 203f 2020 6f72 6465  arxiv =  ?  orde
+000235f0: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
+00023600: 5343 222c 0a20 2020 2020 2020 2020 2020  SC",.           
+00023610: 2020 2020 2022 7365 6c65 6374 202a 2066       "select * f
+00023620: 726f 6d20 656e 7472 6965 7320 2077 6865  rom entries  whe
+00023630: 7265 2061 7278 6976 203d 2020 3f20 206f  re arxiv =  ?  o
+00023640: 7220 220a 2020 2020 2020 2020 2020 2020  r ".            
+00023650: 2020 2020 2b20 2262 6962 6b65 7920 3d20      + "bibkey = 
+00023660: 203f 2020 6f72 6465 7220 6279 2066 6972   ?  order by fir
+00023670: 7374 6461 7465 2041 5343 222c 0a20 2020  stdate ASC",.   
+00023680: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00023690: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+000236a0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+000236b0: 6f72 7465 6428 7365 6c66 2e70 4244 422e  orted(self.pBDB.
+000236c0: 6269 6273 2e6c 6173 7456 616c 7329 2c20  bibs.lastVals), 
+000236d0: 736f 7274 6564 2828 2261 6222 2c20 2265  sorted(("ab", "e
+000236e0: 6622 2929 290a 0a20 2020 2020 2020 2023  f")))..        #
+000236f0: 2067 656e 6572 6174 6520 736f 6d65 2065   generate some e
+00023700: 7272 6f72 730a 2020 2020 2020 2020 7365  rrors.        se
+00023710: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
+00023720: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
+00023730: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+00023740: 6962 732e 6765 7441 6c6c 286c 696d 6974  ibs.getAll(limit
+00023750: 546f 3d22 6122 295d 2c20 5b5d 290a 2020  To="a")], []).  
+00023760: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00023770: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00023780: 2020 2020 5b65 5b22 6269 626b 6579 225d      [e["bibkey"]
+00023790: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+000237a0: 4244 422e 6269 6273 2e67 6574 416c 6c28  BDB.bibs.getAll(
+000237b0: 6c69 6d69 7454 6f3d 2262 6962 6b65 7922  limitTo="bibkey"
+000237c0: 295d 2c20 5b5d 0a20 2020 2020 2020 2029  )], [].        )
+000237d0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000237e0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+000237f0: 2020 2020 2020 205b 655b 2262 6962 6b65         [e["bibke
+00023800: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
+00023810: 662e 7042 4442 2e62 6962 732e 6765 7441  f.pBDB.bibs.getA
+00023820: 6c6c 286c 696d 6974 546f 3d31 2c20 6c69  ll(limitTo=1, li
+00023830: 6d69 744f 6666 7365 743d 2261 2229 5d2c  mitOffset="a")],
+00023840: 205b 5d0a 2020 2020 2020 2020 290a 2020   [].        ).  
+00023850: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00023860: 7445 7175 616c 285b 655b 2262 6962 6b65  tEqual([e["bibke
+00023870: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
+00023880: 662e 7042 4442 2e62 6962 732e 6765 7441  f.pBDB.bibs.getA
+00023890: 6c6c 286f 7264 6572 4279 3d22 6122 295d  ll(orderBy="a")]
+000238a0: 2c20 5b5d 290a 2020 2020 2020 2020 7365  , []).        se
+000238b0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+000238c0: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
+000238d0: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
+000238e0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+000238f0: 2e67 6574 416c 6c28 6f72 6465 7254 7970  .getAll(orderTyp
+00023900: 653d 2261 6263 2229 5d2c 0a20 2020 2020  e="abc")],.     
+00023910: 2020 2020 2020 205b 2261 6263 222c 2022         ["abc", "
+00023920: 6465 6622 2c20 2267 6869 225d 2c0a 2020  def", "ghi"],.  
+00023930: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00023940: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00023950: 280a 2020 2020 2020 2020 2020 2020 5b65  (.            [e
+00023960: 5b22 6269 626b 6579 225d 2066 6f72 2065  ["bibkey"] for e
+00023970: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+00023980: 6273 2e67 6574 416c 6c28 7061 7261 6d73  bs.getAll(params
+00023990: 3d7b 2261 6263 223a 2022 6269 626b 6579  ={"abc": "bibkey
+000239a0: 227d 295d 2c20 5b5d 0a20 2020 2020 2020  "})], [].       
+000239b0: 2029 0a0a 2020 2020 2020 2020 2320 7465   )..        # te
+000239c0: 7374 2064 6966 6665 7265 6e74 2063 7572  st different cur
+000239d0: 736f 7273 0a20 2020 2020 2020 2073 656c  sors.        sel
+000239e0: 662e 7042 4442 2e62 6962 732e 6c61 7374  f.pBDB.bibs.last
+000239f0: 4665 7463 6865 6420 3d20 2274 6573 7422  Fetched = "test"
+00023a00: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+00023a10: 4442 2e62 6962 732e 6c61 7374 5175 6572  DB.bibs.lastQuer
+00023a20: 7920 3d20 2274 6573 7420 7175 6572 7922  y = "test query"
+00023a30: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+00023a40: 4442 2e62 6962 732e 6665 7463 6841 6c6c  DB.bibs.fetchAll
+00023a50: 2864 6f46 6574 6368 3d46 616c 7365 290a  (doFetch=False).
+00023a60: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00023a70: 6572 7445 7175 616c 285b 655b 2262 6962  ertEqual([e["bib
+00023a80: 6b65 7922 5d20 666f 7220 6520 696e 2073  key"] for e in s
+00023a90: 656c 662e 7042 4442 2e63 7572 735d 2c20  elf.pBDB.curs], 
+00023aa0: 5b5d 290a 2020 2020 2020 2020 7365 6c66  []).        self
+00023ab0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00023ac0: 2020 2020 2020 2020 2020 5b65 5b22 6269            [e["bi
+00023ad0: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
+00023ae0: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+00023af0: 6574 6368 4375 7273 5d2c 205b 2261 6263  etchCurs], ["abc
+00023b00: 222c 2022 6465 6622 2c20 2267 6869 225d  ", "def", "ghi"]
+00023b10: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00023b20: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00023b30: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
+00023b40: 6273 2e6c 6173 7446 6574 6368 6564 2c20  bs.lastFetched, 
+00023b50: 2274 6573 7422 290a 2020 2020 2020 2020  "test").        
+00023b60: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00023b70: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00023b80: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
+00023b90: 7451 7565 7279 2c0a 2020 2020 2020 2020  tQuery,.        
+00023ba0: 2020 2020 2273 656c 6563 7420 2a20 6672      "select * fr
+00023bb0: 6f6d 2065 6e74 7269 6573 2020 6f72 6465  om entries  orde
+00023bc0: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
+00023bd0: 5343 222c 0a20 2020 2020 2020 2029 0a0a  SC",.        )..
+00023be0: 2020 2020 2020 2020 7465 7374 4269 624e          testBibN
+00023bf0: 616d 6520 3d20 6f73 2e70 6174 682e 6a6f  ame = os.path.jo
+00023c00: 696e 2870 6243 6f6e 6669 672e 6461 7461  in(pbConfig.data
+00023c10: 5061 7468 2c20 2274 6573 7473 5f25 732e  Path, "tests_%s.
+00023c20: 6269 6222 2025 2074 6f64 6179 5f79 6d64  bib" % today_ymd
+00023c30: 290a 2020 2020 2020 2020 7361 6d70 6c65  ).        sample
+00023c40: 5478 7420 3d20 280a 2020 2020 2020 2020  Txt = (.        
+00023c50: 2020 2020 2740 4172 7469 636c 657b 6162      '@Article{ab
+00023c60: 632c 5c6e 2020 2020 2020 2020 6175 7468  c,\n        auth
+00023c70: 6f72 203d 2022 6d65 222c 5c6e 2020 2020  or = "me",\n    
+00023c80: 2020 2020 2027 0a20 2020 2020 2020 2020       '.         
+00023c90: 2020 202b 2027 7469 746c 6520 3d20 227b     + 'title = "{
+00023ca0: 6162 637d 222c 5c6e 7d5c 6e40 4172 7469  abc}",\n}\n@Arti
+00023cb0: 636c 657b 6465 662c 5c6e 2020 2020 2020  cle{def,\n      
+00023cc0: 2020 270a 2020 2020 2020 2020 2020 2020    '.            
+00023cd0: 2b20 2761 7574 686f 7220 3d20 226d 6522  + 'author = "me"
+00023ce0: 2c5c 6e20 2020 2020 2020 2020 7469 746c  ,\n         titl
+00023cf0: 6520 3d20 227b 6465 667d 222c 5c6e 7d5c  e = "{def}",\n}\
+00023d00: 6e27 0a20 2020 2020 2020 2020 2020 202b  n'.            +
+00023d10: 2027 4041 7274 6963 6c65 7b67 6869 2c5c   '@Article{ghi,\
+00023d20: 6e20 2020 2020 2020 2061 7574 686f 7220  n        author 
 00023d30: 3d20 226d 6522 2c5c 6e20 2020 2020 2020  = "me",\n       
-00023d40: 2020 7469 746c 6520 3d20 227b 6465 667d    title = "{def}
-00023d50: 222c 5c6e 7d5c 6e27 0a20 2020 2020 2020  ",\n}\n'.       
-00023d60: 2020 2020 202b 2027 4041 7274 6963 6c65       + '@Article
-00023d70: 7b67 6869 2c5c 6e20 2020 2020 2020 2061  {ghi,\n        a
-00023d80: 7574 686f 7220 3d20 226d 6522 2c5c 6e20  uthor = "me",\n 
-00023d90: 2020 2020 2020 2020 270a 2020 2020 2020          '.      
-00023da0: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
-00023db0: 2022 7b67 6869 7d22 2c5c 6e7d 5c6e 270a   "{ghi}",\n}\n'.
-00023dc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00023dd0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00023de0: 2e66 6574 6368 416c 6c28 646f 4665 7463  .fetchAll(doFetc
-00023df0: 683d 4661 6c73 6529 0a20 2020 2020 2020  h=False).       
-00023e00: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
-00023e10: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
-00023e20: 626c 696f 2e64 6174 6162 6173 652e 456e  blio.database.En
-00023e30: 7472 6965 732e 6665 7463 6843 7572 736f  tries.fetchCurso
-00023e40: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00023e50: 7265 7475 726e 5f76 616c 7565 3d73 656c  return_value=sel
-00023e60: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-00023e70: 6843 7572 736f 7228 292c 0a20 2020 2020  hCursor(),.     
-00023e80: 2020 2020 2020 2061 7574 6f73 7065 633d         autospec=
-00023e90: 5472 7565 2c0a 2020 2020 2020 2020 2920  True,.        ) 
-00023ea0: 6173 205f 6375 7273 3a0a 2020 2020 2020  as _curs:.      
-00023eb0: 2020 2020 2020 7042 4578 706f 7274 2e65        pBExport.e
-00023ec0: 7870 6f72 7441 6c6c 2874 6573 7442 6962  xportAll(testBib
-00023ed0: 4e61 6d65 290a 2020 2020 2020 2020 7769  Name).        wi
-00023ee0: 7468 206f 7065 6e28 7465 7374 4269 624e  th open(testBibN
-00023ef0: 616d 6529 2061 7320 663a 0a20 2020 2020  ame) as f:.     
-00023f00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00023f10: 7274 4571 7561 6c28 662e 7265 6164 2829  rtEqual(f.read()
-00023f20: 2c20 7361 6d70 6c65 5478 7429 0a20 2020  , sampleTxt).   
-00023f30: 2020 2020 206f 732e 7265 6d6f 7665 2874       os.remove(t
-00023f40: 6573 7442 6962 4e61 6d65 290a 0a20 2020  estBibName)..   
-00023f50: 2064 6566 2074 6573 745f 6665 7463 6842   def test_fetchB
-00023f60: 7942 6962 6b65 7928 7365 6c66 2c20 2a61  yBibkey(self, *a
-00023f70: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-00023f80: 2254 6573 7420 7468 6520 6665 7463 6842  "Test the fetchB
-00023f90: 7942 6962 6b65 7920 616e 6420 6765 7442  yBibkey and getB
-00023fa0: 7942 6962 6b65 7920 6675 6e63 7469 6f6e  yBibkey function
-00023fb0: 7322 2222 0a20 2020 2020 2020 2073 656c  s""".        sel
-00023fc0: 662e 696e 7365 7274 5f74 6872 6565 2829  f.insert_three()
-00023fd0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00023fe0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00023ff0: 2020 2020 2020 205b 655b 2262 6962 6b65         [e["bibke
-00024000: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
-00024010: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-00024020: 6842 7942 6962 6b65 7928 2261 6263 6465  hByBibkey("abcde
-00024030: 6622 292e 6c61 7374 4665 7463 6865 645d  f").lastFetched]
-00024040: 2c0a 2020 2020 2020 2020 2020 2020 5b5d  ,.            []
-00024050: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00024060: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00024070: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00024080: 2020 5b65 5b22 6269 626b 6579 225d 2066    [e["bibkey"] f
-00024090: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-000240a0: 422e 6269 6273 2e67 6574 4279 4269 626b  B.bibs.getByBibk
-000240b0: 6579 2822 6162 6364 6566 2229 5d2c 205b  ey("abcdef")], [
-000240c0: 5d0a 2020 2020 2020 2020 290a 2020 2020  ].        ).    
-000240d0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-000240e0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-000240f0: 2020 5b65 5b22 6269 626b 6579 225d 2066    [e["bibkey"] f
-00024100: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-00024110: 422e 6269 6273 2e66 6574 6368 4279 4269  B.bibs.fetchByBi
-00024120: 626b 6579 2822 6162 6322 292e 6c61 7374  bkey("abc").last
-00024130: 4665 7463 6865 645d 2c0a 2020 2020 2020  Fetched],.      
-00024140: 2020 2020 2020 5b22 6162 6322 5d2c 0a20        ["abc"],. 
-00024150: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00024160: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00024170: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
-00024180: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
-00024190: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
-000241a0: 6962 732e 6765 7442 7942 6962 6b65 7928  ibs.getByBibkey(
-000241b0: 2261 6263 2229 5d2c 205b 2261 6263 225d  "abc")], ["abc"]
-000241c0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000241d0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000241e0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-000241f0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00024200: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
-00024210: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00024220: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-00024230: 422e 6269 6273 2e66 6574 6368 4279 4269  B.bibs.fetchByBi
-00024240: 626b 6579 285b 2261 6263 222c 2022 6465  bkey(["abc", "de
-00024250: 6622 5d29 2e6c 6173 7446 6574 6368 6564  f"]).lastFetched
-00024260: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-00024270: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-00024280: 6322 2c20 2264 6566 225d 2c0a 2020 2020  c", "def"],.    
-00024290: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-000242a0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-000242b0: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
-000242c0: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
-000242d0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-000242e0: 2e67 6574 4279 4269 626b 6579 285b 2261  .getByBibkey(["a
-000242f0: 6263 222c 2022 6465 6622 5d29 5d2c 0a20  bc", "def"])],. 
-00024300: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
-00024310: 222c 2022 6465 6622 5d2c 0a20 2020 2020  ", "def"],.     
-00024320: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00024330: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00024340: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00024350: 7042 4442 2e62 6962 732e 6c61 7374 5175  pBDB.bibs.lastQu
-00024360: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-00024370: 2022 7365 6c65 6374 202a 2066 726f 6d20   "select * from 
-00024380: 656e 7472 6965 7320 2077 6865 7265 2062  entries  where b
-00024390: 6962 6b65 7920 3d20 203f 2020 6f72 2062  ibkey =  ?  or b
-000243a0: 6962 6b65 7920 3d20 203f 2020 220a 2020  ibkey =  ?  ".  
-000243b0: 2020 2020 2020 2020 2020 2b20 226f 7264            + "ord
-000243c0: 6572 2062 7920 6669 7273 7464 6174 6520  er by firstdate 
-000243d0: 4153 4322 2c0a 2020 2020 2020 2020 290a  ASC",.        ).
-000243e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000243f0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-00024400: 4442 2e62 6962 732e 6c61 7374 5661 6c73  DB.bibs.lastVals
-00024410: 2c20 2822 6162 6322 2c20 2264 6566 2229  , ("abc", "def")
-00024420: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
-00024430: 4244 422e 6269 6273 2e6c 6173 7451 7565  BDB.bibs.lastQue
-00024440: 7279 203d 2022 220a 2020 2020 2020 2020  ry = "".        
-00024450: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
-00024460: 6173 7456 616c 7320 3d20 2829 0a20 2020  astVals = ().   
-00024470: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00024480: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00024490: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-000244a0: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-000244b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000244c0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-000244d0: 4244 422e 6269 6273 2e66 6574 6368 4279  BDB.bibs.fetchBy
-000244e0: 4269 626b 6579 280a 2020 2020 2020 2020  Bibkey(.        
-000244f0: 2020 2020 2020 2020 2020 2020 2261 6263              "abc
-00024500: 222c 2073 6176 6551 7565 7279 3d46 616c  ", saveQuery=Fal
-00024510: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-00024520: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
-00024530: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
-00024540: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-00024550: 6322 5d2c 0a20 2020 2020 2020 2029 0a20  c"],.        ). 
-00024560: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00024570: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00024580: 2020 2020 205b 655b 2262 6962 6b65 7922       [e["bibkey"
-00024590: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
-000245a0: 7042 4442 2e62 6962 732e 6765 7442 7942  pBDB.bibs.getByB
-000245b0: 6962 6b65 7928 2261 6263 222c 2073 6176  ibkey("abc", sav
-000245c0: 6551 7565 7279 3d46 616c 7365 295d 2c0a  eQuery=False)],.
-000245d0: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-000245e0: 6322 5d2c 0a20 2020 2020 2020 2029 0a20  c"],.        ). 
-000245f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00024600: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00024610: 422e 6269 6273 2e6c 6173 7451 7565 7279  B.bibs.lastQuery
-00024620: 2c20 2222 290a 2020 2020 2020 2020 7365  , "").        se
-00024630: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-00024640: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
-00024650: 7374 5661 6c73 2c20 2829 290a 0a20 2020  stVals, ())..   
-00024660: 2064 6566 2074 6573 745f 6665 7463 6842   def test_fetchB
-00024670: 7942 6962 7465 7828 7365 6c66 2c20 2a61  yBibtex(self, *a
-00024680: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-00024690: 2254 6573 7420 7468 6520 6665 7463 6842  "Test the fetchB
-000246a0: 7942 6962 7465 7820 616e 6420 6765 7442  yBibtex and getB
-000246b0: 7942 6962 7465 7820 6675 6e63 7469 6f6e  yBibtex function
-000246c0: 7322 2222 0a20 2020 2020 2020 2073 656c  s""".        sel
-000246d0: 662e 696e 7365 7274 5f74 6872 6565 2829  f.insert_three()
-000246e0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000246f0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00024700: 2020 2020 2020 205b 655b 2262 6962 6b65         [e["bibke
-00024710: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
-00024720: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-00024730: 6842 7942 6962 7465 7828 2261 6263 6465  hByBibtex("abcde
-00024740: 6622 292e 6c61 7374 4665 7463 6865 645d  f").lastFetched]
-00024750: 2c0a 2020 2020 2020 2020 2020 2020 5b5d  ,.            []
-00024760: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00024770: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00024780: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00024790: 2020 5b65 5b22 6269 626b 6579 225d 2066    [e["bibkey"] f
-000247a0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-000247b0: 422e 6269 6273 2e67 6574 4279 4269 6274  B.bibs.getByBibt
-000247c0: 6578 2822 6162 6364 6566 2229 5d2c 205b  ex("abcdef")], [
-000247d0: 5d0a 2020 2020 2020 2020 290a 2020 2020  ].        ).    
-000247e0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-000247f0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00024800: 2020 5b65 5b22 6269 626b 6579 225d 2066    [e["bibkey"] f
-00024810: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-00024820: 422e 6269 6273 2e66 6574 6368 4279 4269  B.bibs.fetchByBi
-00024830: 6274 6578 2822 6d65 2229 2e6c 6173 7446  btex("me").lastF
-00024840: 6574 6368 6564 5d2c 0a20 2020 2020 2020  etched],.       
-00024850: 2020 2020 205b 2261 6263 222c 2022 6465       ["abc", "de
-00024860: 6622 2c20 2267 6869 225d 2c0a 2020 2020  f", "ghi"],.    
-00024870: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00024880: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00024890: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
-000248a0: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
-000248b0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-000248c0: 2e67 6574 4279 4269 6274 6578 2822 6d65  .getByBibtex("me
-000248d0: 2229 5d2c 0a20 2020 2020 2020 2020 2020  ")],.           
-000248e0: 205b 2261 6263 222c 2022 6465 6622 2c20   ["abc", "def", 
-000248f0: 2267 6869 225d 2c0a 2020 2020 2020 2020  "ghi"],.        
-00024900: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
-00024910: 4244 422e 6269 6273 2e75 7064 6174 6546  BDB.bibs.updateF
-00024920: 6965 6c64 2822 6768 6922 2c20 226f 6c64  ield("ghi", "old
-00024930: 5f6b 6579 7322 2c20 2261 6263 2229 0a20  _keys", "abc"). 
-00024940: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00024950: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00024960: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00024970: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00024980: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00024990: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-000249a0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-000249b0: 4279 4269 6274 6578 285b 2261 6263 222c  ByBibtex(["abc",
-000249c0: 2022 6465 6622 5d29 2e6c 6173 7446 6574   "def"]).lastFet
-000249d0: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
-000249e0: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
-000249f0: 5b22 6162 6322 2c20 2264 6566 225d 2c0a  ["abc", "def"],.
-00024a00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00024a10: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00024a20: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00024a30: 5b65 5b22 6269 626b 6579 225d 2066 6f72  [e["bibkey"] for
-00024a40: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00024a50: 6269 6273 2e67 6574 4279 4269 6274 6578  bibs.getByBibtex
-00024a60: 285b 2261 6263 222c 2022 6465 6622 5d29  (["abc", "def"])
-00024a70: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
-00024a80: 2261 6263 222c 2022 6465 6622 5d2c 0a20  "abc", "def"],. 
-00024a90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00024aa0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00024ab0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-00024ac0: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
-00024ad0: 7374 5175 6572 792c 0a20 2020 2020 2020  stQuery,.       
-00024ae0: 2020 2020 2022 7365 6c65 6374 202a 2066       "select * f
-00024af0: 726f 6d20 656e 7472 6965 7320 2077 6865  rom entries  whe
-00024b00: 7265 2062 6962 7465 7820 206c 696b 6520  re bibtex  like 
-00024b10: 2020 3f20 206f 7220 220a 2020 2020 2020    ?  or ".      
-00024b20: 2020 2020 2020 2b20 2262 6962 7465 7820        + "bibtex 
-00024b30: 206c 696b 6520 2020 3f20 206f 7264 6572   like   ?  order
-00024b40: 2062 7920 6669 7273 7464 6174 6520 4153   by firstdate AS
-00024b50: 4322 2c0a 2020 2020 2020 2020 290a 2020  C",.        ).  
-00024b60: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00024b70: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
-00024b80: 2e62 6962 732e 6c61 7374 5661 6c73 2c20  .bibs.lastVals, 
-00024b90: 2822 2561 6263 2522 2c20 2225 6465 6625  ("%abc%", "%def%
-00024ba0: 2229 290a 2020 2020 2020 2020 7365 6c66  ")).        self
-00024bb0: 2e70 4244 422e 6269 6273 2e6c 6173 7451  .pBDB.bibs.lastQ
-00024bc0: 7565 7279 203d 2022 220a 2020 2020 2020  uery = "".      
-00024bd0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00024be0: 2e6c 6173 7456 616c 7320 3d20 2829 0a20  .lastVals = (). 
-00024bf0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00024c00: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00024c10: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00024c20: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00024c30: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00024c40: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-00024c50: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-00024c60: 4279 4269 6274 6578 280a 2020 2020 2020  ByBibtex(.      
-00024c70: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-00024c80: 6263 222c 2073 6176 6551 7565 7279 3d46  bc", saveQuery=F
-00024c90: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00024ca0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-00024cb0: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-00024cc0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-00024cd0: 6162 6322 5d2c 0a20 2020 2020 2020 2029  abc"],.        )
-00024ce0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00024cf0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00024d00: 2020 2020 2020 205b 655b 2262 6962 6b65         [e["bibke
-00024d10: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
-00024d20: 662e 7042 4442 2e62 6962 732e 6765 7442  f.pBDB.bibs.getB
-00024d30: 7942 6962 7465 7828 2261 6263 222c 2073  yBibtex("abc", s
-00024d40: 6176 6551 7565 7279 3d46 616c 7365 295d  aveQuery=False)]
-00024d50: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-00024d60: 6162 6322 5d2c 0a20 2020 2020 2020 2029  abc"],.        )
-00024d70: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00024d80: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
-00024d90: 4244 422e 6269 6273 2e6c 6173 7451 7565  BDB.bibs.lastQue
-00024da0: 7279 2c20 2222 290a 2020 2020 2020 2020  ry, "").        
-00024db0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00024dc0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-00024dd0: 6c61 7374 5661 6c73 2c20 2829 290a 0a20  lastVals, ()).. 
-00024de0: 2020 2064 6566 2074 6573 745f 6665 7463     def test_fetc
-00024df0: 6842 7943 6174 2873 656c 662c 202a 6172  hByCat(self, *ar
-00024e00: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
-00024e10: 7465 7374 2062 6962 732e 6665 7463 6842  test bibs.fetchB
-00024e20: 7943 6174 2065 2062 6962 732e 6765 7442  yCat e bibs.getB
-00024e30: 7943 6174 2222 220a 2020 2020 2020 2020  yCat""".        
-00024e40: 7365 6c66 2e69 6e73 6572 745f 7468 7265  self.insert_thre
-00024e50: 6528 290a 2020 2020 2020 2020 7365 6c66  e().        self
-00024e60: 2e70 4244 422e 6361 7442 6962 2e69 6e73  .pBDB.catBib.ins
-00024e70: 6572 7428 312c 205b 2261 6263 222c 2022  ert(1, ["abc", "
-00024e80: 6465 6622 5d29 0a20 2020 2020 2020 2064  def"]).        d
-00024e90: 6253 7461 7473 2873 656c 662e 7042 4442  bStats(self.pBDB
-00024ea0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00024eb0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00024ec0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00024ed0: 422e 7374 6174 732c 0a20 2020 2020 2020  B.stats,.       
-00024ee0: 2020 2020 207b 2262 6962 7322 3a20 332c       {"bibs": 3,
-00024ef0: 2022 6361 7473 223a 2032 2c20 2265 7870   "cats": 2, "exp
-00024f00: 7322 3a20 302c 2022 6361 7442 6962 223a  s": 0, "catBib":
-00024f10: 2032 2c20 2263 6174 4578 7022 3a20 302c   2, "catExp": 0,
-00024f20: 2022 6269 6245 7870 223a 2030 7d2c 0a20   "bibExp": 0},. 
-00024f30: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00024f40: 2065 6e74 7269 6573 203d 2073 656c 662e   entries = self.
-00024f50: 7042 4442 2e62 6962 732e 6665 7463 6842  pBDB.bibs.fetchB
-00024f60: 7943 6174 2831 292e 6c61 7374 4665 7463  yCat(1).lastFetc
-00024f70: 6865 640a 2020 2020 2020 2020 7365 6c66  hed.        self
-00024f80: 2e61 7373 6572 7445 7175 616c 285b 655b  .assertEqual([e[
-00024f90: 2262 6962 6b65 7922 5d20 666f 7220 6520  "bibkey"] for e 
-00024fa0: 696e 2065 6e74 7269 6573 5d2c 205b 2261  in entries], ["a
-00024fb0: 6263 222c 2022 6465 6622 5d29 0a20 2020  bc", "def"]).   
-00024fc0: 2020 2020 2065 6e74 7269 6573 203d 2073       entries = s
-00024fd0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-00024fe0: 7442 7943 6174 2831 290a 2020 2020 2020  tByCat(1).      
-00024ff0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00025000: 616c 285b 655b 2262 6962 6b65 7922 5d20  al([e["bibkey"] 
-00025010: 666f 7220 6520 696e 2065 6e74 7269 6573  for e in entries
-00025020: 5d2c 205b 2261 6263 222c 2022 6465 6622  ], ["abc", "def"
-00025030: 5d29 0a0a 2020 2020 2020 2020 656e 7472  ])..        entr
-00025040: 6965 7320 3d20 7365 6c66 2e70 4244 422e  ies = self.pBDB.
-00025050: 6269 6273 2e66 6574 6368 4279 4361 7428  bibs.fetchByCat(
-00025060: 0a20 2020 2020 2020 2020 2020 2031 2c20  .            1, 
-00025070: 6f72 6465 7242 793d 2262 6962 6b65 7922  orderBy="bibkey"
-00025080: 2c20 6f72 6465 7254 7970 653d 2244 4553  , orderType="DES
-00025090: 4322 0a20 2020 2020 2020 2029 2e6c 6173  C".        ).las
-000250a0: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-000250b0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000250c0: 6c28 5b65 5b22 6269 626b 6579 225d 2066  l([e["bibkey"] f
-000250d0: 6f72 2065 2069 6e20 656e 7472 6965 735d  or e in entries]
-000250e0: 2c20 5b22 6465 6622 2c20 2261 6263 225d  , ["def", "abc"]
-000250f0: 290a 2020 2020 2020 2020 656e 7472 6965  ).        entrie
-00025100: 7320 3d20 7365 6c66 2e70 4244 422e 6269  s = self.pBDB.bi
-00025110: 6273 2e67 6574 4279 4361 7428 312c 206f  bs.getByCat(1, o
-00025120: 7264 6572 4279 3d22 6269 626b 6579 222c  rderBy="bibkey",
-00025130: 206f 7264 6572 5479 7065 3d22 4445 5343   orderType="DESC
-00025140: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00025150: 6173 7365 7274 4571 7561 6c28 5b65 5b22  assertEqual([e["
-00025160: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
-00025170: 6e20 656e 7472 6965 735d 2c20 5b22 6465  n entries], ["de
-00025180: 6622 2c20 2261 6263 225d 290a 0a20 2020  f", "abc"])..   
-00025190: 2020 2020 2065 6e74 7269 6573 203d 2073       entries = s
-000251a0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-000251b0: 7442 7943 6174 2832 290a 2020 2020 2020  tByCat(2).      
-000251c0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000251d0: 616c 285b 655b 2262 6962 6b65 7922 5d20  al([e["bibkey"] 
-000251e0: 666f 7220 6520 696e 2065 6e74 7269 6573  for e in entries
-000251f0: 5d2c 205b 5d29 0a0a 2020 2020 6465 6620  ], [])..    def 
-00025200: 7465 7374 5f66 6574 6368 4279 4578 7028  test_fetchByExp(
-00025210: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
-00025220: 2020 2020 2020 2222 2274 6573 7420 6269        """test bi
-00025230: 6273 2e66 6574 6368 4279 4578 7020 6520  bs.fetchByExp e 
-00025240: 6269 6273 2e67 6574 4279 4578 7022 2222  bibs.getByExp"""
-00025250: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-00025260: 7365 7274 5f74 6872 6565 2829 0a20 2020  sert_three().   
-00025270: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00025280: 6962 4578 702e 696e 7365 7274 285b 2261  ibExp.insert(["a
-00025290: 6263 222c 2022 6465 6622 5d2c 2030 290a  bc", "def"], 0).
-000252a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000252b0: 6572 7454 7275 6528 0a20 2020 2020 2020  ertTrue(.       
-000252c0: 2020 2020 2073 656c 662e 7042 4442 2e65       self.pBDB.e
-000252d0: 7870 732e 696e 7365 7274 280a 2020 2020  xps.insert(.    
-000252e0: 2020 2020 2020 2020 2020 2020 7b22 6e61              {"na
-000252f0: 6d65 223a 2022 6578 7031 222c 2022 636f  me": "exp1", "co
-00025300: 6d6d 656e 7473 223a 2022 222c 2022 686f  mments": "", "ho
-00025310: 6d65 7061 6765 223a 2022 222c 2022 696e  mepage": "", "in
-00025320: 7370 6972 6522 3a20 2222 7d0a 2020 2020  spire": ""}.    
-00025330: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00025340: 2020 290a 2020 2020 2020 2020 6462 5374    ).        dbSt
-00025350: 6174 7328 7365 6c66 2e70 4244 4229 0a20  ats(self.pBDB). 
-00025360: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00025370: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00025380: 2020 2020 2073 656c 662e 7042 4442 2e73       self.pBDB.s
-00025390: 7461 7473 2c0a 2020 2020 2020 2020 2020  tats,.          
-000253a0: 2020 7b22 6269 6273 223a 2033 2c20 2263    {"bibs": 3, "c
-000253b0: 6174 7322 3a20 322c 2022 6578 7073 223a  ats": 2, "exps":
-000253c0: 2031 2c20 2263 6174 4269 6222 3a20 302c   1, "catBib": 0,
-000253d0: 2022 6361 7445 7870 223a 2030 2c20 2262   "catExp": 0, "b
-000253e0: 6962 4578 7022 3a20 327d 2c0a 2020 2020  ibExp": 2},.    
-000253f0: 2020 2020 290a 2020 2020 2020 2020 656e      ).        en
-00025400: 7472 6965 7320 3d20 7365 6c66 2e70 4244  tries = self.pBD
-00025410: 422e 6269 6273 2e66 6574 6368 4279 4578  B.bibs.fetchByEx
-00025420: 7028 3029 2e6c 6173 7446 6574 6368 6564  p(0).lastFetched
-00025430: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00025440: 7365 7274 4571 7561 6c28 5b65 5b22 6269  sertEqual([e["bi
-00025450: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
-00025460: 656e 7472 6965 735d 2c20 5b22 6162 6322  entries], ["abc"
-00025470: 2c20 2264 6566 225d 290a 2020 2020 2020  , "def"]).      
-00025480: 2020 656e 7472 6965 7320 3d20 7365 6c66    entries = self
-00025490: 2e70 4244 422e 6269 6273 2e67 6574 4279  .pBDB.bibs.getBy
-000254a0: 4578 7028 3029 0a20 2020 2020 2020 2073  Exp(0).        s
-000254b0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000254c0: 5b65 5b22 6269 626b 6579 225d 2066 6f72  [e["bibkey"] for
-000254d0: 2065 2069 6e20 656e 7472 6965 735d 2c20   e in entries], 
-000254e0: 5b22 6162 6322 2c20 2264 6566 225d 290a  ["abc", "def"]).
-000254f0: 0a20 2020 2020 2020 2065 6e74 7269 6573  .        entries
-00025500: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
-00025510: 732e 6665 7463 6842 7945 7870 280a 2020  s.fetchByExp(.  
-00025520: 2020 2020 2020 2020 2020 302c 206f 7264            0, ord
-00025530: 6572 4279 3d22 6269 626b 6579 222c 206f  erBy="bibkey", o
-00025540: 7264 6572 5479 7065 3d22 4445 5343 220a  rderType="DESC".
-00025550: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-00025560: 7463 6865 640a 2020 2020 2020 2020 7365  tched.        se
-00025570: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
-00025580: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
-00025590: 6520 696e 2065 6e74 7269 6573 5d2c 205b  e in entries], [
-000255a0: 2264 6566 222c 2022 6162 6322 5d29 0a20  "def", "abc"]). 
-000255b0: 2020 2020 2020 2065 6e74 7269 6573 203d         entries =
-000255c0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-000255d0: 6765 7442 7945 7870 2830 2c20 6f72 6465  getByExp(0, orde
-000255e0: 7242 793d 2262 6962 6b65 7922 2c20 6f72  rBy="bibkey", or
-000255f0: 6465 7254 7970 653d 2244 4553 4322 290a  derType="DESC").
-00025600: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00025610: 6572 7445 7175 616c 285b 655b 2262 6962  ertEqual([e["bib
-00025620: 6b65 7922 5d20 666f 7220 6520 696e 2065  key"] for e in e
-00025630: 6e74 7269 6573 5d2c 205b 2264 6566 222c  ntries], ["def",
-00025640: 2022 6162 6322 5d29 0a0a 2020 2020 2020   "abc"])..      
-00025650: 2020 656e 7472 6965 7320 3d20 7365 6c66    entries = self
-00025660: 2e70 4244 422e 6269 6273 2e67 6574 4279  .pBDB.bibs.getBy
-00025670: 4578 7028 3229 0a20 2020 2020 2020 2073  Exp(2).        s
-00025680: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00025690: 5b65 5b22 6269 626b 6579 225d 2066 6f72  [e["bibkey"] for
-000256a0: 2065 2069 6e20 656e 7472 6965 735d 2c20   e in entries], 
-000256b0: 5b5d 290a 0a20 2020 2064 6566 2074 6573  [])..    def tes
-000256c0: 745f 6665 7463 6842 7949 6446 726f 6d49  t_fetchByIdFromI
-000256d0: 6e73 7069 7265 5265 636f 7264 2873 656c  nspireRecord(sel
-000256e0: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
-000256f0: 2020 2022 2222 7465 7374 2066 6574 6368     """test fetch
-00025700: 4279 4964 4672 6f6d 496e 7370 6972 6552  ByIdFromInspireR
-00025710: 6563 6f72 6422 2222 0a20 2020 2020 2020  ecord""".       
-00025720: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00025730: 6c61 7374 4665 7463 6865 6420 3d20 2261  lastFetched = "a
-00025740: 220a 2020 2020 2020 2020 7769 7468 2070  ".        with p
-00025750: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-00025760: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-00025770: 7461 6261 7365 2e45 6e74 7269 6573 2e66  tabase.Entries.f
-00025780: 6574 6368 4279 4269 626b 6579 222c 2072  etchByBibkey", r
-00025790: 6574 7572 6e5f 7661 6c75 653d 2262 6962  eturn_value="bib
-000257a0: 6b22 0a20 2020 2020 2020 2029 2061 7320  k".        ) as 
-000257b0: 5f66 6262 2c20 7061 7463 6828 0a20 2020  _fbb, patch(.   
-000257c0: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
-000257d0: 626c 696f 2e64 6174 6162 6173 652e 456e  blio.database.En
-000257e0: 7472 6965 732e 6665 7463 6842 7949 6e73  tries.fetchByIns
-000257f0: 7069 7265 4944 222c 2072 6574 7572 6e5f  pireID", return_
-00025800: 7661 6c75 653d 2269 6964 220a 2020 2020  value="iid".    
-00025810: 2020 2020 2920 6173 205f 6662 692c 2070      ) as _fbi, p
-00025820: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-00025830: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-00025840: 7461 6261 7365 2e45 6e74 7269 6573 2e66  tabase.Entries.f
-00025850: 6574 6368 4279 4269 6274 6578 222c 2073  etchByBibtex", s
-00025860: 6964 655f 6566 6665 6374 3d5b 2261 7278  ide_effect=["arx
-00025870: 6976 222c 2022 646f 6922 5d0a 2020 2020  iv", "doi"].    
-00025880: 2020 2020 2920 6173 205f 6662 783a 0a20      ) as _fbx:. 
-00025890: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000258a0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-000258b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000258c0: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-000258d0: 6842 7949 6446 726f 6d49 6e73 7069 7265  hByIdFromInspire
-000258e0: 5265 636f 7264 287b 2262 6962 6b65 7922  Record({"bibkey"
-000258f0: 3a20 2261 6263 227d 292c 2022 6269 626b  : "abc"}), "bibk
-00025900: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00025910: 2020 2020 2020 2020 2020 2020 5f66 6262              _fbb
-00025920: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-00025930: 6e63 655f 7769 7468 2822 6162 6322 2c20  nce_with("abc", 
-00025940: 7361 7665 5175 6572 793d 4661 6c73 6529  saveQuery=False)
-00025950: 0a20 2020 2020 2020 2020 2020 205f 6662  .            _fb
-00025960: 692e 6173 7365 7274 5f6e 6f74 5f63 616c  i.assert_not_cal
-00025970: 6c65 6428 290a 2020 2020 2020 2020 2020  led().          
-00025980: 2020 5f66 6278 2e61 7373 6572 745f 6e6f    _fbx.assert_no
-00025990: 745f 6361 6c6c 6564 2829 0a20 2020 2020  t_called().     
-000259a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000259b0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-000259c0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-000259d0: 4442 2e62 6962 732e 6665 7463 6842 7949  DB.bibs.fetchByI
-000259e0: 6446 726f 6d49 6e73 7069 7265 5265 636f  dFromInspireReco
-000259f0: 7264 287b 2269 6422 3a20 2231 3233 227d  rd({"id": "123"}
-00025a00: 292c 2022 6969 6422 0a20 2020 2020 2020  ), "iid".       
-00025a10: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00025a20: 2020 205f 6662 622e 6173 7365 7274 5f63     _fbb.assert_c
-00025a30: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00025a40: 2261 6263 222c 2073 6176 6551 7565 7279  "abc", saveQuery
-00025a50: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-00025a60: 2020 2020 5f66 6269 2e61 7373 6572 745f      _fbi.assert_
-00025a70: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-00025a80: 2822 3132 3322 2c20 7361 7665 5175 6572  ("123", saveQuer
-00025a90: 793d 4661 6c73 6529 0a20 2020 2020 2020  y=False).       
-00025aa0: 2020 2020 205f 6662 782e 6173 7365 7274       _fbx.assert
-00025ab0: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
-00025ac0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00025ad0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00025ae0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00025af0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-00025b00: 4279 4964 4672 6f6d 496e 7370 6972 6552  ByIdFromInspireR
-00025b10: 6563 6f72 6428 7b22 6570 7269 6e74 223a  ecord({"eprint":
-00025b20: 2022 3435 3622 7d29 2c20 2261 7278 6976   "456"}), "arxiv
-00025b30: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00025b40: 2020 2020 2020 2020 2020 2020 5f66 6262              _fbb
-00025b50: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-00025b60: 6e63 655f 7769 7468 2822 6162 6322 2c20  nce_with("abc", 
-00025b70: 7361 7665 5175 6572 793d 4661 6c73 6529  saveQuery=False)
-00025b80: 0a20 2020 2020 2020 2020 2020 205f 6662  .            _fb
-00025b90: 692e 6173 7365 7274 5f63 616c 6c65 645f  i.assert_called_
-00025ba0: 6f6e 6365 5f77 6974 6828 2231 3233 222c  once_with("123",
-00025bb0: 2073 6176 6551 7565 7279 3d46 616c 7365   saveQuery=False
-00025bc0: 290a 2020 2020 2020 2020 2020 2020 5f66  ).            _f
-00025bd0: 6278 2e61 7373 6572 745f 6361 6c6c 6564  bx.assert_called
-00025be0: 5f6f 6e63 655f 7769 7468 2822 3435 3622  _once_with("456"
-00025bf0: 2c20 7361 7665 5175 6572 793d 4661 6c73  , saveQuery=Fals
-00025c00: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
-00025c10: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00025c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025c30: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00025c40: 6665 7463 6842 7949 6446 726f 6d49 6e73  fetchByIdFromIns
-00025c50: 7069 7265 5265 636f 7264 287b 2264 6f69  pireRecord({"doi
-00025c60: 223a 2022 612f 312f 322f 3322 7d29 2c20  ": "a/1/2/3"}), 
-00025c70: 2264 6f69 220a 2020 2020 2020 2020 2020  "doi".          
-00025c80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00025c90: 5f66 6262 2e61 7373 6572 745f 6361 6c6c  _fbb.assert_call
-00025ca0: 6564 5f6f 6e63 655f 7769 7468 2822 6162  ed_once_with("ab
-00025cb0: 6322 2c20 7361 7665 5175 6572 793d 4661  c", saveQuery=Fa
-00025cc0: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-00025cd0: 205f 6662 692e 6173 7365 7274 5f63 616c   _fbi.assert_cal
-00025ce0: 6c65 645f 6f6e 6365 5f77 6974 6828 2231  led_once_with("1
-00025cf0: 3233 222c 2073 6176 6551 7565 7279 3d46  23", saveQuery=F
-00025d00: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-00025d10: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00025d20: 616c 285f 6662 782e 6361 6c6c 5f63 6f75  al(_fbx.call_cou
-00025d30: 6e74 2c20 3229 0a20 2020 2020 2020 2020  nt, 2).         
-00025d40: 2020 205f 6662 782e 6173 7365 7274 5f61     _fbx.assert_a
-00025d50: 6e79 5f63 616c 6c28 2261 2f31 2f32 2f33  ny_call("a/1/2/3
-00025d60: 222c 2073 6176 6551 7565 7279 3d46 616c  ", saveQuery=Fal
-00025d70: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-00025d80: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00025d90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00025da0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00025db0: 2e66 6574 6368 4279 4964 4672 6f6d 496e  .fetchByIdFromIn
-00025dc0: 7370 6972 6552 6563 6f72 6428 7b22 7469  spireRecord({"ti
-00025dd0: 746c 6522 3a20 226d 7974 6974 6c65 227d  tle": "mytitle"}
-00025de0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00025df0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00025e00: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-00025e10: 0a20 2020 2020 2020 2020 2020 205f 6662  .            _fb
-00025e20: 622e 6173 7365 7274 5f63 616c 6c65 645f  b.assert_called_
-00025e30: 6f6e 6365 5f77 6974 6828 2261 6263 222c  once_with("abc",
-00025e40: 2073 6176 6551 7565 7279 3d46 616c 7365   saveQuery=False
-00025e50: 290a 2020 2020 2020 2020 2020 2020 5f66  ).            _f
-00025e60: 6269 2e61 7373 6572 745f 6361 6c6c 6564  bi.assert_called
-00025e70: 5f6f 6e63 655f 7769 7468 2822 3132 3322  _once_with("123"
-00025e80: 2c20 7361 7665 5175 6572 793d 4661 6c73  , saveQuery=Fals
-00025e90: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
-00025ea0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00025eb0: 5f66 6278 2e63 616c 6c5f 636f 756e 742c  _fbx.call_count,
-00025ec0: 2032 290a 2020 2020 2020 2020 2020 2020   2).            
-00025ed0: 5f66 6278 2e61 7373 6572 745f 616e 795f  _fbx.assert_any_
-00025ee0: 6361 6c6c 2822 612f 312f 322f 3322 2c20  call("a/1/2/3", 
-00025ef0: 7361 7665 5175 6572 793d 4661 6c73 6529  saveQuery=False)
-00025f00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00025f10: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-00025f20: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-00025f30: 7446 6574 6368 6564 2c20 5b5d 290a 2020  tFetched, []).  
-00025f40: 2020 2020 2020 7265 7320 3d20 4e61 6d65        res = Name
-00025f50: 5370 6163 6528 290a 2020 2020 2020 2020  Space().        
-00025f60: 7265 732e 6c61 7374 4665 7463 6865 6420  res.lastFetched 
-00025f70: 3d20 2261 6263 220a 2020 2020 2020 2020  = "abc".        
-00025f80: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
-00025f90: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-00025fa0: 6c69 6f2e 6461 7461 6261 7365 2e45 6e74  lio.database.Ent
-00025fb0: 7269 6573 2e66 6574 6368 4279 4964 4672  ries.fetchByIdFr
-00025fc0: 6f6d 496e 7370 6972 6552 6563 6f72 6422  omInspireRecord"
-00025fd0: 2c20 7265 7475 726e 5f76 616c 7565 3d72  , return_value=r
-00025fe0: 6573 0a20 2020 2020 2020 2029 2061 7320  es.        ) as 
-00025ff0: 5f66 3a0a 2020 2020 2020 2020 2020 2020  _f:.            
-00026000: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00026010: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00026020: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00026030: 2e67 6574 4279 4964 4672 6f6d 496e 7370  .getByIdFromInsp
-00026040: 6972 6552 6563 6f72 6428 7b22 6269 626b  ireRecord({"bibk
-00026050: 6579 223a 2022 6162 6322 7d29 2c20 2261  ey": "abc"}), "a
-00026060: 6263 220a 2020 2020 2020 2020 2020 2020  bc".            
-00026070: 290a 2020 2020 2020 2020 2020 2020 5f66  ).            _f
-00026080: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-00026090: 6e63 655f 7769 7468 287b 2262 6962 6b65  nce_with({"bibke
-000260a0: 7922 3a20 2261 6263 227d 290a 0a20 2020  y": "abc"})..   
-000260b0: 2064 6566 2074 6573 745f 6665 7463 6842   def test_fetchB
-000260c0: 7949 6e73 7069 7265 4944 2873 656c 662c  yInspireID(self,
-000260d0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
-000260e0: 2022 2222 5465 7374 2074 6865 2066 6574   """Test the fet
-000260f0: 6368 4279 496e 7370 6972 6549 4420 616e  chByInspireID an
-00026100: 6420 6765 7442 7949 6e73 7069 7265 4944  d getByInspireID
-00026110: 2066 756e 6374 696f 6e73 2222 220a 2020   functions""".  
-00026120: 2020 2020 2020 7365 6c66 2e69 6e73 6572        self.inser
-00026130: 745f 7468 7265 6528 290a 2020 2020 2020  t_three().      
-00026140: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00026150: 2e75 7064 6174 6546 6965 6c64 2822 6162  .updateField("ab
-00026160: 6322 2c20 2269 6e73 7069 7265 222c 2022  c", "inspire", "
-00026170: 3132 3334 3522 290a 2020 2020 2020 2020  12345").        
-00026180: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-00026190: 7064 6174 6546 6965 6c64 2822 6465 6622  pdateField("def"
-000261a0: 2c20 2269 6e73 7069 7265 222c 2022 3233  , "inspire", "23
-000261b0: 3435 3622 290a 2020 2020 2020 2020 7365  456").        se
-000261c0: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-000261d0: 6174 6546 6965 6c64 2822 6768 6922 2c20  ateField("ghi", 
-000261e0: 2269 6e73 7069 7265 222c 2022 3334 3536  "inspire", "3456
-000261f0: 3722 290a 2020 2020 2020 2020 7365 6c66  7").        self
-00026200: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00026210: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00026220: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
-00026230: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
-00026240: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
-00026250: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00026260: 6665 7463 6842 7949 6e73 7069 7265 4944  fetchByInspireID
-00026270: 2822 3132 3334 3536 2229 2e6c 6173 7446  ("123456").lastF
-00026280: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
-00026290: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-000262a0: 2020 5b5d 2c0a 2020 2020 2020 2020 290a    [],.        ).
-000262b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000262c0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-000262d0: 2020 2020 2020 5b65 5b22 6269 626b 6579        [e["bibkey
-000262e0: 225d 2066 6f72 2065 2069 6e20 7365 6c66  "] for e in self
-000262f0: 2e70 4244 422e 6269 6273 2e67 6574 4279  .pBDB.bibs.getBy
-00026300: 496e 7370 6972 6549 4428 2231 3233 3435  InspireID("12345
-00026310: 3622 295d 2c20 5b5d 0a20 2020 2020 2020  6")], [].       
-00026320: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00026330: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00026340: 2020 2020 2020 2020 205b 655b 2262 6962           [e["bib
-00026350: 6b65 7922 5d20 666f 7220 6520 696e 2073  key"] for e in s
-00026360: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
-00026370: 7463 6842 7949 6e73 7069 7265 4944 2822  tchByInspireID("
-00026380: 3334 3522 292e 6c61 7374 4665 7463 6865  345").lastFetche
-00026390: 645d 2c0a 2020 2020 2020 2020 2020 2020  d],.            
-000263a0: 5b22 6162 6322 2c20 2264 6566 222c 2022  ["abc", "def", "
-000263b0: 6768 6922 5d2c 0a20 2020 2020 2020 2029  ghi"],.        )
-000263c0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000263d0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-000263e0: 2020 2020 2020 205b 655b 2262 6962 6b65         [e["bibke
-000263f0: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
-00026400: 662e 7042 4442 2e62 6962 732e 6765 7442  f.pBDB.bibs.getB
-00026410: 7949 6e73 7069 7265 4944 2822 3334 3522  yInspireID("345"
-00026420: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
-00026430: 5b22 6162 6322 2c20 2264 6566 222c 2022  ["abc", "def", "
-00026440: 6768 6922 5d2c 0a20 2020 2020 2020 2029  ghi"],.        )
-00026450: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00026460: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00026470: 2020 2020 2020 205b 655b 2262 6962 6b65         [e["bibke
-00026480: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
-00026490: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-000264a0: 6842 7949 6e73 7069 7265 4944 2822 3132  hByInspireID("12
-000264b0: 3334 3522 292e 6c61 7374 4665 7463 6865  345").lastFetche
-000264c0: 645d 2c0a 2020 2020 2020 2020 2020 2020  d],.            
-000264d0: 5b22 6162 6322 5d2c 0a20 2020 2020 2020  ["abc"],.       
-000264e0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-000264f0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00026500: 2020 2020 2020 2020 205b 655b 2262 6962           [e["bib
-00026510: 6b65 7922 5d20 666f 7220 6520 696e 2073  key"] for e in s
-00026520: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-00026530: 7442 7949 6e73 7069 7265 4944 2822 3132  tByInspireID("12
-00026540: 3334 3522 295d 2c0a 2020 2020 2020 2020  345")],.        
-00026550: 2020 2020 5b22 6162 6322 5d2c 0a20 2020      ["abc"],.   
-00026560: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00026570: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00026580: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00026590: 662e 7042 4442 2e62 6962 732e 6c61 7374  f.pBDB.bibs.last
-000265a0: 5175 6572 792c 0a20 2020 2020 2020 2020  Query,.         
-000265b0: 2020 2022 7365 6c65 6374 202a 2066 726f     "select * fro
-000265c0: 6d20 656e 7472 6965 7320 2077 6865 7265  m entries  where
-000265d0: 2069 6e73 7069 7265 2020 6c69 6b65 2020   inspire  like  
-000265e0: 203f 2020 6f72 6465 7220 6279 2066 6972   ?  order by fir
-000265f0: 7374 6461 7465 2041 5343 222c 0a20 2020  stdate ASC",.   
-00026600: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00026610: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00026620: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
-00026630: 6173 7456 616c 732c 2028 2225 3132 3334  astVals, ("%1234
-00026640: 3525 222c 2929 0a20 2020 2020 2020 2073  5%",)).        s
-00026650: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00026660: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-00026670: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00026680: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
-00026690: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-000266a0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-000266b0: 6273 2e66 6574 6368 4279 496e 7370 6972  bs.fetchByInspir
-000266c0: 6549 4428 5b22 3132 3322 2c20 2235 3637  eID(["123", "567
-000266d0: 225d 292e 6c61 7374 4665 7463 6865 640a  "]).lastFetched.
-000266e0: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-000266f0: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
-00026700: 222c 2022 6768 6922 5d2c 0a20 2020 2020  ", "ghi"],.     
-00026710: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00026720: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00026730: 2020 2020 2020 2020 2020 205b 655b 2262             [e["b
-00026740: 6962 6b65 7922 5d20 666f 7220 6520 696e  ibkey"] for e in
-00026750: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00026760: 6765 7442 7949 6e73 7069 7265 4944 285b  getByInspireID([
-00026770: 2231 3233 222c 2022 3536 3722 5d29 5d2c  "123", "567"])],
-00026780: 0a20 2020 2020 2020 2020 2020 205b 2261  .            ["a
-00026790: 6263 222c 2022 6768 6922 5d2c 0a20 2020  bc", "ghi"],.   
-000267a0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-000267b0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000267c0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-000267d0: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-000267e0: 7451 7565 7279 2c0a 2020 2020 2020 2020  tQuery,.        
-000267f0: 2020 2020 2273 656c 6563 7420 2a20 6672      "select * fr
-00026800: 6f6d 2065 6e74 7269 6573 2020 7768 6572  om entries  wher
-00026810: 6520 696e 7370 6972 6520 206c 696b 6520  e inspire  like 
-00026820: 2020 3f20 2022 0a20 2020 2020 2020 2020    ?  ".         
-00026830: 2020 202b 2022 6f72 2069 6e73 7069 7265     + "or inspire
-00026840: 2020 6c69 6b65 2020 203f 2020 6f72 6465    like   ?  orde
-00026850: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
-00026860: 5343 222c 0a20 2020 2020 2020 2029 0a20  SC",.        ). 
-00026870: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00026880: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00026890: 422e 6269 6273 2e6c 6173 7456 616c 732c  B.bibs.lastVals,
-000268a0: 2028 2225 3132 3325 222c 2022 2535 3637   ("%123%", "%567
-000268b0: 2522 2929 0a20 2020 2020 2020 2073 656c  %")).        sel
-000268c0: 662e 7042 4442 2e62 6962 732e 6c61 7374  f.pBDB.bibs.last
-000268d0: 5175 6572 7920 3d20 2222 0a20 2020 2020  Query = "".     
-000268e0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-000268f0: 732e 6c61 7374 5661 6c73 203d 2028 290a  s.lastVals = ().
-00026900: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00026910: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00026920: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-00026930: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
-00026940: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
-00026950: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
-00026960: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-00026970: 6842 7949 6e73 7069 7265 4944 280a 2020  hByInspireID(.  
-00026980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026990: 2020 2231 3233 3422 2c20 7361 7665 5175    "1234", saveQu
-000269a0: 6572 793d 4661 6c73 650a 2020 2020 2020  ery=False.      
-000269b0: 2020 2020 2020 2020 2020 292e 6c61 7374            ).last
-000269c0: 4665 7463 6865 640a 2020 2020 2020 2020  Fetched.        
-000269d0: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-000269e0: 2020 205b 2261 6263 225d 2c0a 2020 2020     ["abc"],.    
-000269f0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00026a00: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00026a10: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00026a20: 2020 2020 2020 2020 2020 2020 2020 655b                e[
-00026a30: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
-00026a40: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-00026a50: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-00026a60: 732e 6765 7442 7949 6e73 7069 7265 4944  s.getByInspireID
-00026a70: 2822 3132 3334 222c 2073 6176 6551 7565  ("1234", saveQue
-00026a80: 7279 3d46 616c 7365 290a 2020 2020 2020  ry=False).      
-00026a90: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00026aa0: 2020 2020 205b 2261 6263 225d 2c0a 2020       ["abc"],.  
-00026ab0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026ac0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00026ad0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-00026ae0: 6c61 7374 5175 6572 792c 2022 2229 0a20  lastQuery, ""). 
-00026af0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00026b00: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00026b10: 422e 6269 6273 2e6c 6173 7456 616c 732c  B.bibs.lastVals,
-00026b20: 2028 2929 0a0a 2020 2020 6465 6620 7465   ())..    def te
-00026b30: 7374 5f66 6574 6368 4279 4b65 7928 7365  st_fetchByKey(se
-00026b40: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
-00026b50: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-00026b60: 6665 7463 6842 794b 6579 2061 6e64 2067  fetchByKey and g
-00026b70: 6574 4279 4b65 7920 6675 6e63 7469 6f6e  etByKey function
-00026b80: 7322 2222 0a20 2020 2020 2020 2073 656c  s""".        sel
-00026b90: 662e 696e 7365 7274 5f74 6872 6565 2829  f.insert_three()
-00026ba0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00026bb0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00026bc0: 2020 2020 2020 205b 655b 2262 6962 6b65         [e["bibke
-00026bd0: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
-00026be0: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-00026bf0: 6842 794b 6579 2822 6162 6364 6566 2229  hByKey("abcdef")
-00026c00: 2e6c 6173 7446 6574 6368 6564 5d2c 205b  .lastFetched], [
-00026c10: 5d0a 2020 2020 2020 2020 290a 2020 2020  ].        ).    
-00026c20: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00026c30: 7175 616c 285b 655b 2262 6962 6b65 7922  qual([e["bibkey"
-00026c40: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
-00026c50: 7042 4442 2e62 6962 732e 6765 7442 794b  pBDB.bibs.getByK
-00026c60: 6579 2822 6162 6364 6566 2229 5d2c 205b  ey("abcdef")], [
-00026c70: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
-00026c80: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00026c90: 2020 2020 2020 2020 205b 655b 2262 6962           [e["bib
-00026ca0: 6b65 7922 5d20 666f 7220 6520 696e 2073  key"] for e in s
-00026cb0: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
-00026cc0: 7463 6842 794b 6579 2822 6162 6322 292e  tchByKey("abc").
-00026cd0: 6c61 7374 4665 7463 6865 645d 2c20 5b22  lastFetched], ["
-00026ce0: 6162 6322 5d0a 2020 2020 2020 2020 290a  abc"].        ).
-00026cf0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00026d00: 6572 7445 7175 616c 285b 655b 2262 6962  ertEqual([e["bib
-00026d10: 6b65 7922 5d20 666f 7220 6520 696e 2073  key"] for e in s
-00026d20: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-00026d30: 7442 794b 6579 2822 6162 6322 295d 2c20  tByKey("abc")], 
-00026d40: 5b22 6162 6322 5d29 0a20 2020 2020 2020  ["abc"]).       
-00026d50: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00026d60: 7570 6461 7465 4669 656c 6428 2267 6869  updateField("ghi
-00026d70: 222c 2022 6f6c 645f 6b65 7973 222c 2022  ", "old_keys", "
-00026d80: 6162 6322 290a 2020 2020 2020 2020 7365  abc").        se
-00026d90: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00026da0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00026db0: 2020 2020 2020 2020 2020 2020 2020 655b                e[
-00026dc0: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
-00026dd0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-00026de0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-00026df0: 732e 6665 7463 6842 794b 6579 285b 2261  s.fetchByKey(["a
-00026e00: 6263 222c 2022 6465 6622 5d29 2e6c 6173  bc", "def"]).las
-00026e10: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-00026e20: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00026e30: 2020 2020 5b22 6162 6322 2c20 2264 6566      ["abc", "def
-00026e40: 222c 2022 6768 6922 5d2c 0a20 2020 2020  ", "ghi"],.     
-00026e50: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00026e60: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00026e70: 2020 2020 2020 2020 2020 205b 655b 2262             [e["b
-00026e80: 6962 6b65 7922 5d20 666f 7220 6520 696e  ibkey"] for e in
-00026e90: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00026ea0: 6765 7442 794b 6579 285b 2261 6263 222c  getByKey(["abc",
-00026eb0: 2022 6465 6622 5d29 5d2c 0a20 2020 2020   "def"])],.     
-00026ec0: 2020 2020 2020 205b 2261 6263 222c 2022         ["abc", "
-00026ed0: 6465 6622 2c20 2267 6869 225d 2c0a 2020  def", "ghi"],.  
-00026ee0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026ef0: 7365 6c66 2e61 7373 6572 7452 6567 6578  self.assertRegex
-00026f00: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-00026f10: 6c61 7374 5175 6572 792c 2022 7365 6c65  lastQuery, "sele
-00026f20: 6374 205c 2a20 6672 6f6d 2065 6e74 7269  ct \* from entri
-00026f30: 6573 2020 7768 6572 6520 2e2a 2229 0a20  es  where .*"). 
-00026f40: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00026f50: 7274 5265 6765 7828 0a20 2020 2020 2020  rtRegex(.       
-00026f60: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00026f70: 6962 732e 6c61 7374 5175 6572 792c 2022  ibs.lastQuery, "
-00026f80: 2e2a 6269 626b 6579 2020 6c69 6b65 2020  .*bibkey  like  
-00026f90: 205c 3f20 206f 7220 2062 6962 6b65 7920   \?  or  bibkey 
-00026fa0: 206c 696b 6520 2020 5c3f 2e2a 220a 2020   like   \?.*".  
-00026fb0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026fc0: 7365 6c66 2e61 7373 6572 7452 6567 6578  self.assertRegex
-00026fd0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00026fe0: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-00026ff0: 7451 7565 7279 2c20 222e 2a6f 6c64 5f6b  tQuery, ".*old_k
-00027000: 6579 7320 206c 696b 6520 2020 5c3f 2020  eys  like   \?  
-00027010: 6f72 2020 6f6c 645f 6b65 7973 2020 6c69  or  old_keys  li
-00027020: 6b65 2020 205c 3f2e 2a22 0a20 2020 2020  ke   \?.*".     
-00027030: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00027040: 662e 6173 7365 7274 5265 6765 7828 7365  f.assertRegex(se
-00027050: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-00027060: 7451 7565 7279 2c20 222e 2a20 6f72 6465  tQuery, ".* orde
-00027070: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
-00027080: 5343 2229 0a20 2020 2020 2020 2073 656c  SC").        sel
-00027090: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-000270a0: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-000270b0: 7456 616c 732c 2028 2225 6162 6325 222c  tVals, ("%abc%",
-000270c0: 2022 2564 6566 2522 2c20 2225 6162 6325   "%def%", "%abc%
-000270d0: 222c 2022 2564 6566 2522 2929 0a20 2020  ", "%def%")).   
-000270e0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000270f0: 6962 732e 6c61 7374 5175 6572 7920 3d20  ibs.lastQuery = 
-00027100: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
-00027110: 7042 4442 2e62 6962 732e 6c61 7374 5661  pBDB.bibs.lastVa
-00027120: 6c73 203d 2028 290a 2020 2020 2020 2020  ls = ().        
-00027130: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00027140: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
-00027150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027160: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
-00027170: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00027180: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
-00027190: 6962 732e 6665 7463 6842 794b 6579 2822  ibs.fetchByKey("
-000271a0: 6162 6322 2c20 7361 7665 5175 6572 793d  abc", saveQuery=
-000271b0: 4661 6c73 6529 2e6c 6173 7446 6574 6368  False).lastFetch
-000271c0: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-000271d0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-000271e0: 6162 6322 2c20 2267 6869 225d 2c0a 2020  abc", "ghi"],.  
-000271f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00027200: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00027210: 280a 2020 2020 2020 2020 2020 2020 5b65  (.            [e
-00027220: 5b22 6269 626b 6579 225d 2066 6f72 2065  ["bibkey"] for e
-00027230: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-00027240: 6273 2e67 6574 4279 4b65 7928 2261 6263  bs.getByKey("abc
-00027250: 222c 2073 6176 6551 7565 7279 3d46 616c  ", saveQuery=Fal
-00027260: 7365 295d 2c0a 2020 2020 2020 2020 2020  se)],.          
-00027270: 2020 5b22 6162 6322 2c20 2267 6869 225d    ["abc", "ghi"]
-00027280: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00027290: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-000272a0: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
-000272b0: 6962 732e 6c61 7374 5175 6572 792c 2022  ibs.lastQuery, "
-000272c0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-000272d0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-000272e0: 2e70 4244 422e 6269 6273 2e6c 6173 7456  .pBDB.bibs.lastV
-000272f0: 616c 732c 2028 2929 0a0a 2020 2020 6465  als, ())..    de
-00027300: 6620 7465 7374 5f66 6574 6368 4672 6f6d  f test_fetchFrom
-00027310: 4469 6374 2873 656c 662c 202a 6172 6773  Dict(self, *args
-00027320: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
-00027330: 7374 2074 6865 2070 7265 7474 7920 636f  st the pretty co
-00027340: 6d70 6c69 6361 7465 6420 6675 6e63 7469  mplicated functi
-00027350: 6f6e 2066 6574 6368 4672 6f6d 4469 6374  on fetchFromDict
-00027360: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-00027370: 2e69 6e73 6572 745f 7468 7265 6528 290a  .insert_three().
-00027380: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00027390: 422e 6269 6245 7870 2e69 6e73 6572 7428  B.bibExp.insert(
-000273a0: 5b22 6162 6322 2c20 2264 6566 225d 2c20  ["abc", "def"], 
-000273b0: 3029 0a20 2020 2020 2020 2073 656c 662e  0).        self.
-000273c0: 7042 4442 2e63 6174 4269 622e 696e 7365  pBDB.catBib.inse
-000273d0: 7274 2830 2c20 5b22 6162 6322 5d29 0a20  rt(0, ["abc"]). 
-000273e0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-000273f0: 2e63 6174 4269 622e 696e 7365 7274 2831  .catBib.insert(1
-00027400: 2c20 5b22 6465 6622 2c20 2267 6869 225d  , ["def", "ghi"]
-00027410: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00027420: 7373 6572 7454 7275 6528 0a20 2020 2020  ssertTrue(.     
-00027430: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00027440: 2e65 7870 732e 696e 7365 7274 280a 2020  .exps.insert(.  
-00027450: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
-00027460: 6e61 6d65 223a 2022 6578 7031 222c 2022  name": "exp1", "
-00027470: 636f 6d6d 656e 7473 223a 2022 222c 2022  comments": "", "
-00027480: 686f 6d65 7061 6765 223a 2022 222c 2022  homepage": "", "
-00027490: 696e 7370 6972 6522 3a20 2222 7d0a 2020  inspire": ""}.  
-000274a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000274b0: 2020 2020 290a 0a20 2020 2020 2020 2073      )..        s
-000274c0: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
-000274d0: 7374 5175 6572 7920 3d20 2274 6573 7420  stQuery = "test 
-000274e0: 7175 6572 7922 0a20 2020 2020 2020 2073  query".        s
-000274f0: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
-00027500: 7463 6846 726f 6d44 6963 7428 646f 4665  tchFromDict(doFe
-00027510: 7463 683d 4661 6c73 6529 0a20 2020 2020  tch=False).     
-00027520: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00027530: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00027540: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00027550: 6c61 7374 5175 6572 792c 0a20 2020 2020  lastQuery,.     
-00027560: 2020 2020 2020 2022 7365 6c65 6374 202a         "select *
-00027570: 2066 726f 6d20 656e 7472 6965 7320 206f   from entries  o
-00027580: 7264 6572 2062 7920 6669 7273 7464 6174  rder by firstdat
-00027590: 6520 4153 4322 2c0a 2020 2020 2020 2020  e ASC",.        
-000275a0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000275b0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-000275c0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-000275d0: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
-000275e0: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
-000275f0: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
-00027600: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-00027610: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
-00027620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027630: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00027640: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00027650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027660: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-00027670: 3a20 2254 6578 7422 2c0a 2020 2020 2020  : "Text",.      
+00023d40: 2020 270a 2020 2020 2020 2020 2020 2020    '.            
+00023d50: 2b20 2774 6974 6c65 203d 2022 7b67 6869  + 'title = "{ghi
+00023d60: 7d22 2c5c 6e7d 5c6e 270a 2020 2020 2020  }",\n}\n'.      
+00023d70: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00023d80: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+00023d90: 416c 6c28 646f 4665 7463 683d 4661 6c73  All(doFetch=Fals
+00023da0: 6529 0a20 2020 2020 2020 2077 6974 6820  e).        with 
+00023db0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
+00023dc0: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
+00023dd0: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
+00023de0: 6665 7463 6843 7572 736f 7222 2c0a 2020  fetchCursor",.  
+00023df0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00023e00: 5f76 616c 7565 3d73 656c 662e 7042 4442  _value=self.pBDB
+00023e10: 2e62 6962 732e 6665 7463 6843 7572 736f  .bibs.fetchCurso
+00023e20: 7228 292c 0a20 2020 2020 2020 2020 2020  r(),.           
+00023e30: 2061 7574 6f73 7065 633d 5472 7565 2c0a   autospec=True,.
+00023e40: 2020 2020 2020 2020 2920 6173 205f 6375          ) as _cu
+00023e50: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+00023e60: 7042 4578 706f 7274 2e65 7870 6f72 7441  pBExport.exportA
+00023e70: 6c6c 2874 6573 7442 6962 4e61 6d65 290a  ll(testBibName).
+00023e80: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
+00023e90: 6e28 7465 7374 4269 624e 616d 6529 2061  n(testBibName) a
+00023ea0: 7320 663a 0a20 2020 2020 2020 2020 2020  s f:.           
+00023eb0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00023ec0: 6c28 662e 7265 6164 2829 2c20 7361 6d70  l(f.read(), samp
+00023ed0: 6c65 5478 7429 0a20 2020 2020 2020 206f  leTxt).        o
+00023ee0: 732e 7265 6d6f 7665 2874 6573 7442 6962  s.remove(testBib
+00023ef0: 4e61 6d65 290a 0a20 2020 2064 6566 2074  Name)..    def t
+00023f00: 6573 745f 6665 7463 6842 7942 6962 6b65  est_fetchByBibke
+00023f10: 7928 7365 6c66 2c20 2a61 7267 7329 3a0a  y(self, *args):.
+00023f20: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+00023f30: 7468 6520 6665 7463 6842 7942 6962 6b65  the fetchByBibke
+00023f40: 7920 616e 6420 6765 7442 7942 6962 6b65  y and getByBibke
+00023f50: 7920 6675 6e63 7469 6f6e 7322 2222 0a20  y functions""". 
+00023f60: 2020 2020 2020 2073 656c 662e 696e 7365         self.inse
+00023f70: 7274 5f74 6872 6565 2829 0a20 2020 2020  rt_three().     
+00023f80: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00023f90: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00023fa0: 205b 655b 2262 6962 6b65 7922 5d20 666f   [e["bibkey"] fo
+00023fb0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00023fc0: 2e62 6962 732e 6665 7463 6842 7942 6962  .bibs.fetchByBib
+00023fd0: 6b65 7928 2261 6263 6465 6622 292e 6c61  key("abcdef").la
+00023fe0: 7374 4665 7463 6865 645d 2c0a 2020 2020  stFetched],.    
+00023ff0: 2020 2020 2020 2020 5b5d 2c0a 2020 2020          [],.    
+00024000: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00024010: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00024020: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
+00024030: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
+00024040: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+00024050: 2e67 6574 4279 4269 626b 6579 2822 6162  .getByBibkey("ab
+00024060: 6364 6566 2229 5d2c 205b 5d0a 2020 2020  cdef")], [].    
+00024070: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00024080: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00024090: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
+000240a0: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
+000240b0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+000240c0: 2e66 6574 6368 4279 4269 626b 6579 2822  .fetchByBibkey("
+000240d0: 6162 6322 292e 6c61 7374 4665 7463 6865  abc").lastFetche
+000240e0: 645d 2c0a 2020 2020 2020 2020 2020 2020  d],.            
+000240f0: 5b22 6162 6322 5d2c 0a20 2020 2020 2020  ["abc"],.       
+00024100: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00024110: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00024120: 2020 2020 2020 2020 205b 655b 2262 6962           [e["bib
+00024130: 6b65 7922 5d20 666f 7220 6520 696e 2073  key"] for e in s
+00024140: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+00024150: 7442 7942 6962 6b65 7928 2261 6263 2229  tByBibkey("abc")
+00024160: 5d2c 205b 2261 6263 225d 0a20 2020 2020  ], ["abc"].     
+00024170: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00024180: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00024190: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+000241a0: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
+000241b0: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
+000241c0: 2020 2020 2020 2020 2066 6f72 2065 2069           for e i
+000241d0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+000241e0: 2e66 6574 6368 4279 4269 626b 6579 285b  .fetchByBibkey([
+000241f0: 2261 6263 222c 2022 6465 6622 5d29 2e6c  "abc", "def"]).l
+00024200: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
+00024210: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+00024220: 2020 2020 2020 5b22 6162 6322 2c20 2264        ["abc", "d
+00024230: 6566 225d 2c0a 2020 2020 2020 2020 290a  ef"],.        ).
+00024240: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00024250: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00024260: 2020 2020 2020 5b65 5b22 6269 626b 6579        [e["bibkey
+00024270: 225d 2066 6f72 2065 2069 6e20 7365 6c66  "] for e in self
+00024280: 2e70 4244 422e 6269 6273 2e67 6574 4279  .pBDB.bibs.getBy
+00024290: 4269 626b 6579 285b 2261 6263 222c 2022  Bibkey(["abc", "
+000242a0: 6465 6622 5d29 5d2c 0a20 2020 2020 2020  def"])],.       
+000242b0: 2020 2020 205b 2261 6263 222c 2022 6465       ["abc", "de
+000242c0: 6622 5d2c 0a20 2020 2020 2020 2029 0a20  f"],.        ). 
+000242d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000242e0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000242f0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00024300: 6962 732e 6c61 7374 5175 6572 792c 0a20  ibs.lastQuery,. 
+00024310: 2020 2020 2020 2020 2020 2022 7365 6c65             "sele
+00024320: 6374 202a 2066 726f 6d20 656e 7472 6965  ct * from entrie
+00024330: 7320 2077 6865 7265 2062 6962 6b65 7920  s  where bibkey 
+00024340: 3d20 203f 2020 6f72 2062 6962 6b65 7920  =  ?  or bibkey 
+00024350: 3d20 203f 2020 220a 2020 2020 2020 2020  =  ?  ".        
+00024360: 2020 2020 2b20 226f 7264 6572 2062 7920      + "order by 
+00024370: 6669 7273 7464 6174 6520 4153 4322 2c0a  firstdate ASC",.
+00024380: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00024390: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000243a0: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
+000243b0: 732e 6c61 7374 5661 6c73 2c20 2822 6162  s.lastVals, ("ab
+000243c0: 6322 2c20 2264 6566 2229 290a 2020 2020  c", "def")).    
+000243d0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+000243e0: 6273 2e6c 6173 7451 7565 7279 203d 2022  bs.lastQuery = "
+000243f0: 220a 2020 2020 2020 2020 7365 6c66 2e70  ".        self.p
+00024400: 4244 422e 6269 6273 2e6c 6173 7456 616c  BDB.bibs.lastVal
+00024410: 7320 3d20 2829 0a20 2020 2020 2020 2073  s = ().        s
+00024420: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00024430: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
+00024440: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00024450: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+00024460: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+00024470: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+00024480: 6273 2e66 6574 6368 4279 4269 626b 6579  bs.fetchByBibkey
+00024490: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000244a0: 2020 2020 2020 2261 6263 222c 2073 6176        "abc", sav
+000244b0: 6551 7565 7279 3d46 616c 7365 0a20 2020  eQuery=False.   
+000244c0: 2020 2020 2020 2020 2020 2020 2029 2e6c               ).l
+000244d0: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
+000244e0: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+000244f0: 2020 2020 2020 5b22 6162 6322 5d2c 0a20        ["abc"],. 
+00024500: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00024510: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00024520: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00024530: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
+00024540: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+00024550: 6962 732e 6765 7442 7942 6962 6b65 7928  ibs.getByBibkey(
+00024560: 2261 6263 222c 2073 6176 6551 7565 7279  "abc", saveQuery
+00024570: 3d46 616c 7365 295d 2c0a 2020 2020 2020  =False)],.      
+00024580: 2020 2020 2020 5b22 6162 6322 5d2c 0a20        ["abc"],. 
+00024590: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000245a0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000245b0: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+000245c0: 2e6c 6173 7451 7565 7279 2c20 2222 290a  .lastQuery, "").
+000245d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000245e0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+000245f0: 4442 2e62 6962 732e 6c61 7374 5661 6c73  DB.bibs.lastVals
+00024600: 2c20 2829 290a 0a20 2020 2064 6566 2074  , ())..    def t
+00024610: 6573 745f 6665 7463 6842 7942 6962 7465  est_fetchByBibte
+00024620: 7828 7365 6c66 2c20 2a61 7267 7329 3a0a  x(self, *args):.
+00024630: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+00024640: 7468 6520 6665 7463 6842 7942 6962 7465  the fetchByBibte
+00024650: 7820 616e 6420 6765 7442 7942 6962 7465  x and getByBibte
+00024660: 7820 6675 6e63 7469 6f6e 7322 2222 0a20  x functions""". 
+00024670: 2020 2020 2020 2073 656c 662e 696e 7365         self.inse
+00024680: 7274 5f74 6872 6565 2829 0a20 2020 2020  rt_three().     
+00024690: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+000246a0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+000246b0: 205b 655b 2262 6962 6b65 7922 5d20 666f   [e["bibkey"] fo
+000246c0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+000246d0: 2e62 6962 732e 6665 7463 6842 7942 6962  .bibs.fetchByBib
+000246e0: 7465 7828 2261 6263 6465 6622 292e 6c61  tex("abcdef").la
+000246f0: 7374 4665 7463 6865 645d 2c0a 2020 2020  stFetched],.    
+00024700: 2020 2020 2020 2020 5b5d 2c0a 2020 2020          [],.    
+00024710: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00024720: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00024730: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
+00024740: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
+00024750: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+00024760: 2e67 6574 4279 4269 6274 6578 2822 6162  .getByBibtex("ab
+00024770: 6364 6566 2229 5d2c 205b 5d0a 2020 2020  cdef")], [].    
+00024780: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00024790: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+000247a0: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
+000247b0: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
+000247c0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+000247d0: 2e66 6574 6368 4279 4269 6274 6578 2822  .fetchByBibtex("
+000247e0: 6d65 2229 2e6c 6173 7446 6574 6368 6564  me").lastFetched
+000247f0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+00024800: 2261 6263 222c 2022 6465 6622 2c20 2267  "abc", "def", "g
+00024810: 6869 225d 2c0a 2020 2020 2020 2020 290a  hi"],.        ).
+00024820: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00024830: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00024840: 2020 2020 2020 5b65 5b22 6269 626b 6579        [e["bibkey
+00024850: 225d 2066 6f72 2065 2069 6e20 7365 6c66  "] for e in self
+00024860: 2e70 4244 422e 6269 6273 2e67 6574 4279  .pBDB.bibs.getBy
+00024870: 4269 6274 6578 2822 6d65 2229 5d2c 0a20  Bibtex("me")],. 
+00024880: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
+00024890: 222c 2022 6465 6622 2c20 2267 6869 225d  ", "def", "ghi"]
+000248a0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000248b0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+000248c0: 6273 2e75 7064 6174 6546 6965 6c64 2822  bs.updateField("
+000248d0: 6768 6922 2c20 226f 6c64 5f6b 6579 7322  ghi", "old_keys"
+000248e0: 2c20 2261 6263 2229 0a20 2020 2020 2020  , "abc").       
+000248f0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00024900: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00024910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024920: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00024930: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00024940: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00024950: 6269 6273 2e66 6574 6368 4279 4269 6274  bibs.fetchByBibt
+00024960: 6578 285b 2261 6263 222c 2022 6465 6622  ex(["abc", "def"
+00024970: 5d29 2e6c 6173 7446 6574 6368 6564 0a20  ]).lastFetched. 
+00024980: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+00024990: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
+000249a0: 2c20 2264 6566 225d 2c0a 2020 2020 2020  , "def"],.      
+000249b0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+000249c0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+000249d0: 2020 2020 2020 2020 2020 5b65 5b22 6269            [e["bi
+000249e0: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
+000249f0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+00024a00: 6574 4279 4269 6274 6578 285b 2261 6263  etByBibtex(["abc
+00024a10: 222c 2022 6465 6622 5d29 5d2c 0a20 2020  ", "def"])],.   
+00024a20: 2020 2020 2020 2020 205b 2261 6263 222c           ["abc",
+00024a30: 2022 6465 6622 5d2c 0a20 2020 2020 2020   "def"],.       
+00024a40: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00024a50: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00024a60: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00024a70: 4442 2e62 6962 732e 6c61 7374 5175 6572  DB.bibs.lastQuer
+00024a80: 792c 0a20 2020 2020 2020 2020 2020 2022  y,.            "
+00024a90: 7365 6c65 6374 202a 2066 726f 6d20 656e  select * from en
+00024aa0: 7472 6965 7320 2077 6865 7265 2062 6962  tries  where bib
+00024ab0: 7465 7820 206c 696b 6520 2020 3f20 206f  tex  like   ?  o
+00024ac0: 7220 220a 2020 2020 2020 2020 2020 2020  r ".            
+00024ad0: 2b20 2262 6962 7465 7820 206c 696b 6520  + "bibtex  like 
+00024ae0: 2020 3f20 206f 7264 6572 2062 7920 6669    ?  order by fi
+00024af0: 7273 7464 6174 6520 4153 4322 2c0a 2020  rstdate ASC",.  
+00024b00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00024b10: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00024b20: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00024b30: 6c61 7374 5661 6c73 2c20 2822 2561 6263  lastVals, ("%abc
+00024b40: 2522 2c20 2225 6465 6625 2229 290a 2020  %", "%def%")).  
+00024b50: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00024b60: 6269 6273 2e6c 6173 7451 7565 7279 203d  bibs.lastQuery =
+00024b70: 2022 220a 2020 2020 2020 2020 7365 6c66   "".        self
+00024b80: 2e70 4244 422e 6269 6273 2e6c 6173 7456  .pBDB.bibs.lastV
+00024b90: 616c 7320 3d20 2829 0a20 2020 2020 2020  als = ().       
+00024ba0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00024bb0: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00024bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024bd0: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00024be0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00024bf0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00024c00: 6269 6273 2e66 6574 6368 4279 4269 6274  bibs.fetchByBibt
+00024c10: 6578 280a 2020 2020 2020 2020 2020 2020  ex(.            
+00024c20: 2020 2020 2020 2020 2261 6263 222c 2073          "abc", s
+00024c30: 6176 6551 7565 7279 3d46 616c 7365 0a20  aveQuery=False. 
+00024c40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00024c50: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+00024c60: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00024c70: 2020 2020 2020 2020 5b22 6162 6322 5d2c          ["abc"],
+00024c80: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00024c90: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00024ca0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00024cb0: 205b 655b 2262 6962 6b65 7922 5d20 666f   [e["bibkey"] fo
+00024cc0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00024cd0: 2e62 6962 732e 6765 7442 7942 6962 7465  .bibs.getByBibte
+00024ce0: 7828 2261 6263 222c 2073 6176 6551 7565  x("abc", saveQue
+00024cf0: 7279 3d46 616c 7365 295d 2c0a 2020 2020  ry=False)],.    
+00024d00: 2020 2020 2020 2020 5b22 6162 6322 5d2c          ["abc"],
+00024d10: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00024d20: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00024d30: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
+00024d40: 6273 2e6c 6173 7451 7565 7279 2c20 2222  bs.lastQuery, ""
+00024d50: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00024d60: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+00024d70: 7042 4442 2e62 6962 732e 6c61 7374 5661  pBDB.bibs.lastVa
+00024d80: 6c73 2c20 2829 290a 0a20 2020 2064 6566  ls, ())..    def
+00024d90: 2074 6573 745f 6665 7463 6842 7943 6174   test_fetchByCat
+00024da0: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
+00024db0: 2020 2020 2020 2022 2222 7465 7374 2062         """test b
+00024dc0: 6962 732e 6665 7463 6842 7943 6174 2065  ibs.fetchByCat e
+00024dd0: 2062 6962 732e 6765 7442 7943 6174 2222   bibs.getByCat""
+00024de0: 220a 2020 2020 2020 2020 7365 6c66 2e69  ".        self.i
+00024df0: 6e73 6572 745f 7468 7265 6528 290a 2020  nsert_three().  
+00024e00: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00024e10: 6361 7442 6962 2e69 6e73 6572 7428 312c  catBib.insert(1,
+00024e20: 205b 2261 6263 222c 2022 6465 6622 5d29   ["abc", "def"])
+00024e30: 0a20 2020 2020 2020 2064 6253 7461 7473  .        dbStats
+00024e40: 2873 656c 662e 7042 4442 290a 2020 2020  (self.pBDB).    
+00024e50: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00024e60: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00024e70: 2020 7365 6c66 2e70 4244 422e 7374 6174    self.pBDB.stat
+00024e80: 732c 0a20 2020 2020 2020 2020 2020 207b  s,.            {
+00024e90: 2262 6962 7322 3a20 332c 2022 6361 7473  "bibs": 3, "cats
+00024ea0: 223a 2032 2c20 2265 7870 7322 3a20 302c  ": 2, "exps": 0,
+00024eb0: 2022 6361 7442 6962 223a 2032 2c20 2263   "catBib": 2, "c
+00024ec0: 6174 4578 7022 3a20 302c 2022 6269 6245  atExp": 0, "bibE
+00024ed0: 7870 223a 2030 7d2c 0a20 2020 2020 2020  xp": 0},.       
+00024ee0: 2029 0a20 2020 2020 2020 2065 6e74 7269   ).        entri
+00024ef0: 6573 203d 2073 656c 662e 7042 4442 2e62  es = self.pBDB.b
+00024f00: 6962 732e 6665 7463 6842 7943 6174 2831  ibs.fetchByCat(1
+00024f10: 292e 6c61 7374 4665 7463 6865 640a 2020  ).lastFetched.  
+00024f20: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00024f30: 7445 7175 616c 285b 655b 2262 6962 6b65  tEqual([e["bibke
+00024f40: 7922 5d20 666f 7220 6520 696e 2065 6e74  y"] for e in ent
+00024f50: 7269 6573 5d2c 205b 2261 6263 222c 2022  ries], ["abc", "
+00024f60: 6465 6622 5d29 0a20 2020 2020 2020 2065  def"]).        e
+00024f70: 6e74 7269 6573 203d 2073 656c 662e 7042  ntries = self.pB
+00024f80: 4442 2e62 6962 732e 6765 7442 7943 6174  DB.bibs.getByCat
+00024f90: 2831 290a 2020 2020 2020 2020 7365 6c66  (1).        self
+00024fa0: 2e61 7373 6572 7445 7175 616c 285b 655b  .assertEqual([e[
+00024fb0: 2262 6962 6b65 7922 5d20 666f 7220 6520  "bibkey"] for e 
+00024fc0: 696e 2065 6e74 7269 6573 5d2c 205b 2261  in entries], ["a
+00024fd0: 6263 222c 2022 6465 6622 5d29 0a0a 2020  bc", "def"])..  
+00024fe0: 2020 2020 2020 656e 7472 6965 7320 3d20        entries = 
+00024ff0: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+00025000: 6574 6368 4279 4361 7428 0a20 2020 2020  etchByCat(.     
+00025010: 2020 2020 2020 2031 2c20 6f72 6465 7242         1, orderB
+00025020: 793d 2262 6962 6b65 7922 2c20 6f72 6465  y="bibkey", orde
+00025030: 7254 7970 653d 2244 4553 4322 0a20 2020  rType="DESC".   
+00025040: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+00025050: 6564 0a20 2020 2020 2020 2073 656c 662e  ed.        self.
+00025060: 6173 7365 7274 4571 7561 6c28 5b65 5b22  assertEqual([e["
+00025070: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
+00025080: 6e20 656e 7472 6965 735d 2c20 5b22 6465  n entries], ["de
+00025090: 6622 2c20 2261 6263 225d 290a 2020 2020  f", "abc"]).    
+000250a0: 2020 2020 656e 7472 6965 7320 3d20 7365      entries = se
+000250b0: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+000250c0: 4279 4361 7428 312c 206f 7264 6572 4279  ByCat(1, orderBy
+000250d0: 3d22 6269 626b 6579 222c 206f 7264 6572  ="bibkey", order
+000250e0: 5479 7065 3d22 4445 5343 2229 0a20 2020  Type="DESC").   
+000250f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00025100: 4571 7561 6c28 5b65 5b22 6269 626b 6579  Equal([e["bibkey
+00025110: 225d 2066 6f72 2065 2069 6e20 656e 7472  "] for e in entr
+00025120: 6965 735d 2c20 5b22 6465 6622 2c20 2261  ies], ["def", "a
+00025130: 6263 225d 290a 0a20 2020 2020 2020 2065  bc"])..        e
+00025140: 6e74 7269 6573 203d 2073 656c 662e 7042  ntries = self.pB
+00025150: 4442 2e62 6962 732e 6765 7442 7943 6174  DB.bibs.getByCat
+00025160: 2832 290a 2020 2020 2020 2020 7365 6c66  (2).        self
+00025170: 2e61 7373 6572 7445 7175 616c 285b 655b  .assertEqual([e[
+00025180: 2262 6962 6b65 7922 5d20 666f 7220 6520  "bibkey"] for e 
+00025190: 696e 2065 6e74 7269 6573 5d2c 205b 5d29  in entries], [])
+000251a0: 0a0a 2020 2020 6465 6620 7465 7374 5f66  ..    def test_f
+000251b0: 6574 6368 4279 4578 7028 7365 6c66 2c20  etchByExp(self, 
+000251c0: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
+000251d0: 2222 2274 6573 7420 6269 6273 2e66 6574  """test bibs.fet
+000251e0: 6368 4279 4578 7020 6520 6269 6273 2e67  chByExp e bibs.g
+000251f0: 6574 4279 4578 7022 2222 0a20 2020 2020  etByExp""".     
+00025200: 2020 2073 656c 662e 696e 7365 7274 5f74     self.insert_t
+00025210: 6872 6565 2829 0a20 2020 2020 2020 2073  hree().        s
+00025220: 656c 662e 7042 4442 2e62 6962 4578 702e  elf.pBDB.bibExp.
+00025230: 696e 7365 7274 285b 2261 6263 222c 2022  insert(["abc", "
+00025240: 6465 6622 5d2c 2030 290a 2020 2020 2020  def"], 0).      
+00025250: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+00025260: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
+00025270: 656c 662e 7042 4442 2e65 7870 732e 696e  elf.pBDB.exps.in
+00025280: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
+00025290: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
+000252a0: 6578 7031 222c 2022 636f 6d6d 656e 7473  exp1", "comments
+000252b0: 223a 2022 222c 2022 686f 6d65 7061 6765  ": "", "homepage
+000252c0: 223a 2022 222c 2022 696e 7370 6972 6522  ": "", "inspire"
+000252d0: 3a20 2222 7d0a 2020 2020 2020 2020 2020  : ""}.          
+000252e0: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
+000252f0: 2020 2020 2020 6462 5374 6174 7328 7365        dbStats(se
+00025300: 6c66 2e70 4244 4229 0a20 2020 2020 2020  lf.pBDB).       
+00025310: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00025320: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
+00025330: 656c 662e 7042 4442 2e73 7461 7473 2c0a  elf.pBDB.stats,.
+00025340: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
+00025350: 6273 223a 2033 2c20 2263 6174 7322 3a20  bs": 3, "cats": 
+00025360: 322c 2022 6578 7073 223a 2031 2c20 2263  2, "exps": 1, "c
+00025370: 6174 4269 6222 3a20 302c 2022 6361 7445  atBib": 0, "catE
+00025380: 7870 223a 2030 2c20 2262 6962 4578 7022  xp": 0, "bibExp"
+00025390: 3a20 327d 2c0a 2020 2020 2020 2020 290a  : 2},.        ).
+000253a0: 2020 2020 2020 2020 656e 7472 6965 7320          entries 
+000253b0: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
+000253c0: 2e66 6574 6368 4279 4578 7028 3029 2e6c  .fetchByExp(0).l
+000253d0: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
+000253e0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+000253f0: 7561 6c28 5b65 5b22 6269 626b 6579 225d  ual([e["bibkey"]
+00025400: 2066 6f72 2065 2069 6e20 656e 7472 6965   for e in entrie
+00025410: 735d 2c20 5b22 6162 6322 2c20 2264 6566  s], ["abc", "def
+00025420: 225d 290a 2020 2020 2020 2020 656e 7472  "]).        entr
+00025430: 6965 7320 3d20 7365 6c66 2e70 4244 422e  ies = self.pBDB.
+00025440: 6269 6273 2e67 6574 4279 4578 7028 3029  bibs.getByExp(0)
+00025450: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00025460: 7365 7274 4571 7561 6c28 5b65 5b22 6269  sertEqual([e["bi
+00025470: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
+00025480: 656e 7472 6965 735d 2c20 5b22 6162 6322  entries], ["abc"
+00025490: 2c20 2264 6566 225d 290a 0a20 2020 2020  , "def"])..     
+000254a0: 2020 2065 6e74 7269 6573 203d 2073 656c     entries = sel
+000254b0: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+000254c0: 6842 7945 7870 280a 2020 2020 2020 2020  hByExp(.        
+000254d0: 2020 2020 302c 206f 7264 6572 4279 3d22      0, orderBy="
+000254e0: 6269 626b 6579 222c 206f 7264 6572 5479  bibkey", orderTy
+000254f0: 7065 3d22 4445 5343 220a 2020 2020 2020  pe="DESC".      
+00025500: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
+00025510: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00025520: 6572 7445 7175 616c 285b 655b 2262 6962  ertEqual([e["bib
+00025530: 6b65 7922 5d20 666f 7220 6520 696e 2065  key"] for e in e
+00025540: 6e74 7269 6573 5d2c 205b 2264 6566 222c  ntries], ["def",
+00025550: 2022 6162 6322 5d29 0a20 2020 2020 2020   "abc"]).       
+00025560: 2065 6e74 7269 6573 203d 2073 656c 662e   entries = self.
+00025570: 7042 4442 2e62 6962 732e 6765 7442 7945  pBDB.bibs.getByE
+00025580: 7870 2830 2c20 6f72 6465 7242 793d 2262  xp(0, orderBy="b
+00025590: 6962 6b65 7922 2c20 6f72 6465 7254 7970  ibkey", orderTyp
+000255a0: 653d 2244 4553 4322 290a 2020 2020 2020  e="DESC").      
+000255b0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000255c0: 616c 285b 655b 2262 6962 6b65 7922 5d20  al([e["bibkey"] 
+000255d0: 666f 7220 6520 696e 2065 6e74 7269 6573  for e in entries
+000255e0: 5d2c 205b 2264 6566 222c 2022 6162 6322  ], ["def", "abc"
+000255f0: 5d29 0a0a 2020 2020 2020 2020 656e 7472  ])..        entr
+00025600: 6965 7320 3d20 7365 6c66 2e70 4244 422e  ies = self.pBDB.
+00025610: 6269 6273 2e67 6574 4279 4578 7028 3229  bibs.getByExp(2)
+00025620: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00025630: 7365 7274 4571 7561 6c28 5b65 5b22 6269  sertEqual([e["bi
+00025640: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
+00025650: 656e 7472 6965 735d 2c20 5b5d 290a 0a20  entries], []).. 
+00025660: 2020 2064 6566 2074 6573 745f 6665 7463     def test_fetc
+00025670: 6842 7949 6446 726f 6d49 6e73 7069 7265  hByIdFromInspire
+00025680: 5265 636f 7264 2873 656c 662c 202a 6172  Record(self, *ar
+00025690: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+000256a0: 7465 7374 2066 6574 6368 4279 4964 4672  test fetchByIdFr
+000256b0: 6f6d 496e 7370 6972 6552 6563 6f72 6422  omInspireRecord"
+000256c0: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+000256d0: 7042 4442 2e62 6962 732e 6c61 7374 4665  pBDB.bibs.lastFe
+000256e0: 7463 6865 6420 3d20 2261 220a 2020 2020  tched = "a".    
+000256f0: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
+00025700: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+00025710: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+00025720: 2e45 6e74 7269 6573 2e66 6574 6368 4279  .Entries.fetchBy
+00025730: 4269 626b 6579 222c 2072 6574 7572 6e5f  Bibkey", return_
+00025740: 7661 6c75 653d 2262 6962 6b22 0a20 2020  value="bibk".   
+00025750: 2020 2020 2029 2061 7320 5f66 6262 2c20       ) as _fbb, 
+00025760: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
+00025770: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
+00025780: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
+00025790: 6665 7463 6842 7949 6e73 7069 7265 4944  fetchByInspireID
+000257a0: 222c 2072 6574 7572 6e5f 7661 6c75 653d  ", return_value=
+000257b0: 2269 6964 220a 2020 2020 2020 2020 2920  "iid".        ) 
+000257c0: 6173 205f 6662 692c 2070 6174 6368 280a  as _fbi, patch(.
+000257d0: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+000257e0: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+000257f0: 2e45 6e74 7269 6573 2e66 6574 6368 4279  .Entries.fetchBy
+00025800: 4269 6274 6578 222c 2073 6964 655f 6566  Bibtex", side_ef
+00025810: 6665 6374 3d5b 2261 7278 6976 222c 2022  fect=["arxiv", "
+00025820: 646f 6922 5d0a 2020 2020 2020 2020 2920  doi"].        ) 
+00025830: 6173 205f 6662 783a 0a20 2020 2020 2020  as _fbx:.       
+00025840: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00025850: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00025860: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00025870: 2e62 6962 732e 6665 7463 6842 7949 6446  .bibs.fetchByIdF
+00025880: 726f 6d49 6e73 7069 7265 5265 636f 7264  romInspireRecord
+00025890: 287b 2262 6962 6b65 7922 3a20 2261 6263  ({"bibkey": "abc
+000258a0: 227d 292c 2022 6269 626b 220a 2020 2020  "}), "bibk".    
+000258b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000258c0: 2020 2020 2020 5f66 6262 2e61 7373 6572        _fbb.asser
+000258d0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+000258e0: 7468 2822 6162 6322 2c20 7361 7665 5175  th("abc", saveQu
+000258f0: 6572 793d 4661 6c73 6529 0a20 2020 2020  ery=False).     
+00025900: 2020 2020 2020 205f 6662 692e 6173 7365         _fbi.asse
+00025910: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00025920: 2020 2020 2020 2020 2020 2020 5f66 6278              _fbx
+00025930: 2e61 7373 6572 745f 6e6f 745f 6361 6c6c  .assert_not_call
+00025940: 6564 2829 0a20 2020 2020 2020 2020 2020  ed().           
+00025950: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00025960: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+00025970: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+00025980: 732e 6665 7463 6842 7949 6446 726f 6d49  s.fetchByIdFromI
+00025990: 6e73 7069 7265 5265 636f 7264 287b 2269  nspireRecord({"i
+000259a0: 6422 3a20 2231 3233 227d 292c 2022 6969  d": "123"}), "ii
+000259b0: 6422 0a20 2020 2020 2020 2020 2020 2029  d".            )
+000259c0: 0a20 2020 2020 2020 2020 2020 205f 6662  .            _fb
+000259d0: 622e 6173 7365 7274 5f63 616c 6c65 645f  b.assert_called_
+000259e0: 6f6e 6365 5f77 6974 6828 2261 6263 222c  once_with("abc",
+000259f0: 2073 6176 6551 7565 7279 3d46 616c 7365   saveQuery=False
+00025a00: 290a 2020 2020 2020 2020 2020 2020 5f66  ).            _f
+00025a10: 6269 2e61 7373 6572 745f 6361 6c6c 6564  bi.assert_called
+00025a20: 5f6f 6e63 655f 7769 7468 2822 3132 3322  _once_with("123"
+00025a30: 2c20 7361 7665 5175 6572 793d 4661 6c73  , saveQuery=Fals
+00025a40: 6529 0a20 2020 2020 2020 2020 2020 205f  e).            _
+00025a50: 6662 782e 6173 7365 7274 5f6e 6f74 5f63  fbx.assert_not_c
+00025a60: 616c 6c65 6428 290a 2020 2020 2020 2020  alled().        
+00025a70: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00025a80: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00025a90: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00025aa0: 6269 6273 2e66 6574 6368 4279 4964 4672  bibs.fetchByIdFr
+00025ab0: 6f6d 496e 7370 6972 6552 6563 6f72 6428  omInspireRecord(
+00025ac0: 7b22 6570 7269 6e74 223a 2022 3435 3622  {"eprint": "456"
+00025ad0: 7d29 2c20 2261 7278 6976 220a 2020 2020  }), "arxiv".    
+00025ae0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00025af0: 2020 2020 2020 5f66 6262 2e61 7373 6572        _fbb.asser
+00025b00: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+00025b10: 7468 2822 6162 6322 2c20 7361 7665 5175  th("abc", saveQu
+00025b20: 6572 793d 4661 6c73 6529 0a20 2020 2020  ery=False).     
+00025b30: 2020 2020 2020 205f 6662 692e 6173 7365         _fbi.asse
+00025b40: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+00025b50: 6974 6828 2231 3233 222c 2073 6176 6551  ith("123", saveQ
+00025b60: 7565 7279 3d46 616c 7365 290a 2020 2020  uery=False).    
+00025b70: 2020 2020 2020 2020 5f66 6278 2e61 7373          _fbx.ass
+00025b80: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+00025b90: 7769 7468 2822 3435 3622 2c20 7361 7665  with("456", save
+00025ba0: 5175 6572 793d 4661 6c73 6529 0a20 2020  Query=False).   
+00025bb0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00025bc0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00025bd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00025be0: 7042 4442 2e62 6962 732e 6665 7463 6842  pBDB.bibs.fetchB
+00025bf0: 7949 6446 726f 6d49 6e73 7069 7265 5265  yIdFromInspireRe
+00025c00: 636f 7264 287b 2264 6f69 223a 2022 612f  cord({"doi": "a/
+00025c10: 312f 322f 3322 7d29 2c20 2264 6f69 220a  1/2/3"}), "doi".
+00025c20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00025c30: 2020 2020 2020 2020 2020 5f66 6262 2e61            _fbb.a
+00025c40: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00025c50: 655f 7769 7468 2822 6162 6322 2c20 7361  e_with("abc", sa
+00025c60: 7665 5175 6572 793d 4661 6c73 6529 0a20  veQuery=False). 
+00025c70: 2020 2020 2020 2020 2020 205f 6662 692e             _fbi.
+00025c80: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+00025c90: 6365 5f77 6974 6828 2231 3233 222c 2073  ce_with("123", s
+00025ca0: 6176 6551 7565 7279 3d46 616c 7365 290a  aveQuery=False).
+00025cb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00025cc0: 2e61 7373 6572 7445 7175 616c 285f 6662  .assertEqual(_fb
+00025cd0: 782e 6361 6c6c 5f63 6f75 6e74 2c20 3229  x.call_count, 2)
+00025ce0: 0a20 2020 2020 2020 2020 2020 205f 6662  .            _fb
+00025cf0: 782e 6173 7365 7274 5f61 6e79 5f63 616c  x.assert_any_cal
+00025d00: 6c28 2261 2f31 2f32 2f33 222c 2073 6176  l("a/1/2/3", sav
+00025d10: 6551 7565 7279 3d46 616c 7365 290a 2020  eQuery=False).  
+00025d20: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00025d30: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00025d40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00025d50: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+00025d60: 4279 4964 4672 6f6d 496e 7370 6972 6552  ByIdFromInspireR
+00025d70: 6563 6f72 6428 7b22 7469 746c 6522 3a20  ecord({"title": 
+00025d80: 226d 7974 6974 6c65 227d 292c 0a20 2020  "mytitle"}),.   
+00025d90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00025da0: 662e 7042 4442 2e62 6962 732c 0a20 2020  f.pBDB.bibs,.   
+00025db0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00025dc0: 2020 2020 2020 205f 6662 622e 6173 7365         _fbb.asse
+00025dd0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+00025de0: 6974 6828 2261 6263 222c 2073 6176 6551  ith("abc", saveQ
+00025df0: 7565 7279 3d46 616c 7365 290a 2020 2020  uery=False).    
+00025e00: 2020 2020 2020 2020 5f66 6269 2e61 7373          _fbi.ass
+00025e10: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+00025e20: 7769 7468 2822 3132 3322 2c20 7361 7665  with("123", save
+00025e30: 5175 6572 793d 4661 6c73 6529 0a20 2020  Query=False).   
+00025e40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00025e50: 7365 7274 4571 7561 6c28 5f66 6278 2e63  sertEqual(_fbx.c
+00025e60: 616c 6c5f 636f 756e 742c 2032 290a 2020  all_count, 2).  
+00025e70: 2020 2020 2020 2020 2020 5f66 6278 2e61            _fbx.a
+00025e80: 7373 6572 745f 616e 795f 6361 6c6c 2822  ssert_any_call("
+00025e90: 612f 312f 322f 3322 2c20 7361 7665 5175  a/1/2/3", saveQu
+00025ea0: 6572 793d 4661 6c73 6529 0a20 2020 2020  ery=False).     
+00025eb0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00025ec0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+00025ed0: 422e 6269 6273 2e6c 6173 7446 6574 6368  B.bibs.lastFetch
+00025ee0: 6564 2c20 5b5d 290a 2020 2020 2020 2020  ed, []).        
+00025ef0: 7265 7320 3d20 4e61 6d65 5370 6163 6528  res = NameSpace(
+00025f00: 290a 2020 2020 2020 2020 7265 732e 6c61  ).        res.la
+00025f10: 7374 4665 7463 6865 6420 3d20 2261 6263  stFetched = "abc
+00025f20: 220a 2020 2020 2020 2020 7769 7468 2070  ".        with p
+00025f30: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+00025f40: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
+00025f50: 7461 6261 7365 2e45 6e74 7269 6573 2e66  tabase.Entries.f
+00025f60: 6574 6368 4279 4964 4672 6f6d 496e 7370  etchByIdFromInsp
+00025f70: 6972 6552 6563 6f72 6422 2c20 7265 7475  ireRecord", retu
+00025f80: 726e 5f76 616c 7565 3d72 6573 0a20 2020  rn_value=res.   
+00025f90: 2020 2020 2029 2061 7320 5f66 3a0a 2020       ) as _f:.  
+00025fa0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00025fb0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00025fc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00025fd0: 2e70 4244 422e 6269 6273 2e67 6574 4279  .pBDB.bibs.getBy
+00025fe0: 4964 4672 6f6d 496e 7370 6972 6552 6563  IdFromInspireRec
+00025ff0: 6f72 6428 7b22 6269 626b 6579 223a 2022  ord({"bibkey": "
+00026000: 6162 6322 7d29 2c20 2261 6263 220a 2020  abc"}), "abc".  
+00026010: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00026020: 2020 2020 2020 2020 5f66 2e61 7373 6572          _f.asser
+00026030: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+00026040: 7468 287b 2262 6962 6b65 7922 3a20 2261  th({"bibkey": "a
+00026050: 6263 227d 290a 0a20 2020 2064 6566 2074  bc"})..    def t
+00026060: 6573 745f 6665 7463 6842 7949 6e73 7069  est_fetchByInspi
+00026070: 7265 4944 2873 656c 662c 202a 6172 6773  reID(self, *args
+00026080: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00026090: 7374 2074 6865 2066 6574 6368 4279 496e  st the fetchByIn
+000260a0: 7370 6972 6549 4420 616e 6420 6765 7442  spireID and getB
+000260b0: 7949 6e73 7069 7265 4944 2066 756e 6374  yInspireID funct
+000260c0: 696f 6e73 2222 220a 2020 2020 2020 2020  ions""".        
+000260d0: 7365 6c66 2e69 6e73 6572 745f 7468 7265  self.insert_thre
+000260e0: 6528 290a 2020 2020 2020 2020 7365 6c66  e().        self
+000260f0: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+00026100: 6546 6965 6c64 2822 6162 6322 2c20 2269  eField("abc", "i
+00026110: 6e73 7069 7265 222c 2022 3132 3334 3522  nspire", "12345"
+00026120: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
+00026130: 4244 422e 6269 6273 2e75 7064 6174 6546  BDB.bibs.updateF
+00026140: 6965 6c64 2822 6465 6622 2c20 2269 6e73  ield("def", "ins
+00026150: 7069 7265 222c 2022 3233 3435 3622 290a  pire", "23456").
+00026160: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00026170: 422e 6269 6273 2e75 7064 6174 6546 6965  B.bibs.updateFie
+00026180: 6c64 2822 6768 6922 2c20 2269 6e73 7069  ld("ghi", "inspi
+00026190: 7265 222c 2022 3334 3536 3722 290a 2020  re", "34567").  
+000261a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000261b0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+000261c0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+000261d0: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
+000261e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000261f0: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
+00026200: 7042 4442 2e62 6962 732e 6665 7463 6842  pBDB.bibs.fetchB
+00026210: 7949 6e73 7069 7265 4944 2822 3132 3334  yInspireID("1234
+00026220: 3536 2229 2e6c 6173 7446 6574 6368 6564  56").lastFetched
+00026230: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
+00026240: 2020 2020 2020 2020 2020 2020 5b5d 2c0a              [],.
+00026250: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00026260: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00026270: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00026280: 5b65 5b22 6269 626b 6579 225d 2066 6f72  [e["bibkey"] for
+00026290: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+000262a0: 6269 6273 2e67 6574 4279 496e 7370 6972  bibs.getByInspir
+000262b0: 6549 4428 2231 3233 3435 3622 295d 2c20  eID("123456")], 
+000262c0: 5b5d 0a20 2020 2020 2020 2029 0a20 2020  [].        ).   
+000262d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000262e0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+000262f0: 2020 205b 655b 2262 6962 6b65 7922 5d20     [e["bibkey"] 
+00026300: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+00026310: 4442 2e62 6962 732e 6665 7463 6842 7949  DB.bibs.fetchByI
+00026320: 6e73 7069 7265 4944 2822 3334 3522 292e  nspireID("345").
+00026330: 6c61 7374 4665 7463 6865 645d 2c0a 2020  lastFetched],.  
+00026340: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
+00026350: 2c20 2264 6566 222c 2022 6768 6922 5d2c  , "def", "ghi"],
+00026360: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00026370: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00026380: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00026390: 205b 655b 2262 6962 6b65 7922 5d20 666f   [e["bibkey"] fo
+000263a0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+000263b0: 2e62 6962 732e 6765 7442 7949 6e73 7069  .bibs.getByInspi
+000263c0: 7265 4944 2822 3334 3522 295d 2c0a 2020  reID("345")],.  
+000263d0: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
+000263e0: 2c20 2264 6566 222c 2022 6768 6922 5d2c  , "def", "ghi"],
+000263f0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00026400: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00026410: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00026420: 205b 655b 2262 6962 6b65 7922 5d20 666f   [e["bibkey"] fo
+00026430: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00026440: 2e62 6962 732e 6665 7463 6842 7949 6e73  .bibs.fetchByIns
+00026450: 7069 7265 4944 2822 3132 3334 3522 292e  pireID("12345").
+00026460: 6c61 7374 4665 7463 6865 645d 2c0a 2020  lastFetched],.  
+00026470: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
+00026480: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00026490: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000264a0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+000264b0: 2020 205b 655b 2262 6962 6b65 7922 5d20     [e["bibkey"] 
+000264c0: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+000264d0: 4442 2e62 6962 732e 6765 7442 7949 6e73  DB.bibs.getByIns
+000264e0: 7069 7265 4944 2822 3132 3334 3522 295d  pireID("12345")]
+000264f0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+00026500: 6162 6322 5d2c 0a20 2020 2020 2020 2029  abc"],.        )
+00026510: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00026520: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00026530: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00026540: 2e62 6962 732e 6c61 7374 5175 6572 792c  .bibs.lastQuery,
+00026550: 0a20 2020 2020 2020 2020 2020 2022 7365  .            "se
+00026560: 6c65 6374 202a 2066 726f 6d20 656e 7472  lect * from entr
+00026570: 6965 7320 2077 6865 7265 2069 6e73 7069  ies  where inspi
+00026580: 7265 2020 6c69 6b65 2020 203f 2020 6f72  re  like   ?  or
+00026590: 6465 7220 6279 2066 6972 7374 6461 7465  der by firstdate
+000265a0: 2041 5343 222c 0a20 2020 2020 2020 2029   ASC",.        )
+000265b0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000265c0: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+000265d0: 4244 422e 6269 6273 2e6c 6173 7456 616c  BDB.bibs.lastVal
+000265e0: 732c 2028 2225 3132 3334 3525 222c 2929  s, ("%12345%",))
+000265f0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00026600: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00026610: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00026620: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
+00026630: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
+00026640: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
+00026650: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
+00026660: 6368 4279 496e 7370 6972 6549 4428 5b22  chByInspireID(["
+00026670: 3132 3322 2c20 2235 3637 225d 292e 6c61  123", "567"]).la
+00026680: 7374 4665 7463 6865 640a 2020 2020 2020  stFetched.      
+00026690: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+000266a0: 2020 2020 205b 2261 6263 222c 2022 6768       ["abc", "gh
+000266b0: 6922 5d2c 0a20 2020 2020 2020 2029 0a20  i"],.        ). 
+000266c0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000266d0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000266e0: 2020 2020 205b 655b 2262 6962 6b65 7922       [e["bibkey"
+000266f0: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
+00026700: 7042 4442 2e62 6962 732e 6765 7442 7949  pBDB.bibs.getByI
+00026710: 6e73 7069 7265 4944 285b 2231 3233 222c  nspireID(["123",
+00026720: 2022 3536 3722 5d29 5d2c 0a20 2020 2020   "567"])],.     
+00026730: 2020 2020 2020 205b 2261 6263 222c 2022         ["abc", "
+00026740: 6768 6922 5d2c 0a20 2020 2020 2020 2029  ghi"],.        )
+00026750: 0a0a 2020 2020 2020 2020 7365 6c66 2e61  ..        self.a
+00026760: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00026770: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00026780: 422e 6269 6273 2e6c 6173 7451 7565 7279  B.bibs.lastQuery
+00026790: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+000267a0: 656c 6563 7420 2a20 6672 6f6d 2065 6e74  elect * from ent
+000267b0: 7269 6573 2020 7768 6572 6520 696e 7370  ries  where insp
+000267c0: 6972 6520 206c 696b 6520 2020 3f20 2022  ire  like   ?  "
+000267d0: 0a20 2020 2020 2020 2020 2020 202b 2022  .            + "
+000267e0: 6f72 2069 6e73 7069 7265 2020 6c69 6b65  or inspire  like
+000267f0: 2020 203f 2020 6f72 6465 7220 6279 2066     ?  order by f
+00026800: 6972 7374 6461 7465 2041 5343 222c 0a20  irstdate ASC",. 
+00026810: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00026820: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00026830: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+00026840: 2e6c 6173 7456 616c 732c 2028 2225 3132  .lastVals, ("%12
+00026850: 3325 222c 2022 2535 3637 2522 2929 0a20  3%", "%567%")). 
+00026860: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00026870: 2e62 6962 732e 6c61 7374 5175 6572 7920  .bibs.lastQuery 
+00026880: 3d20 2222 0a20 2020 2020 2020 2073 656c  = "".        sel
+00026890: 662e 7042 4442 2e62 6962 732e 6c61 7374  f.pBDB.bibs.last
+000268a0: 5661 6c73 203d 2028 290a 2020 2020 2020  Vals = ().      
+000268b0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000268c0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+000268d0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+000268e0: 2020 655b 2262 6962 6b65 7922 5d0a 2020    e["bibkey"].  
+000268f0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00026900: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00026910: 2e62 6962 732e 6665 7463 6842 7949 6e73  .bibs.fetchByIns
+00026920: 7069 7265 4944 280a 2020 2020 2020 2020  pireID(.        
+00026930: 2020 2020 2020 2020 2020 2020 2231 3233              "123
+00026940: 3422 2c20 7361 7665 5175 6572 793d 4661  4", saveQuery=Fa
+00026950: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00026960: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
+00026970: 640a 2020 2020 2020 2020 2020 2020 5d2c  d.            ],
+00026980: 0a20 2020 2020 2020 2020 2020 205b 2261  .            ["a
+00026990: 6263 225d 2c0a 2020 2020 2020 2020 290a  bc"],.        ).
+000269a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000269b0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+000269c0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+000269d0: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
+000269e0: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+000269f0: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+00026a00: 662e 7042 4442 2e62 6962 732e 6765 7442  f.pBDB.bibs.getB
+00026a10: 7949 6e73 7069 7265 4944 2822 3132 3334  yInspireID("1234
+00026a20: 222c 2073 6176 6551 7565 7279 3d46 616c  ", saveQuery=Fal
+00026a30: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
+00026a40: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+00026a50: 2261 6263 225d 2c0a 2020 2020 2020 2020  "abc"],.        
+00026a60: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00026a70: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+00026a80: 7042 4442 2e62 6962 732e 6c61 7374 5175  pBDB.bibs.lastQu
+00026a90: 6572 792c 2022 2229 0a20 2020 2020 2020  ery, "").       
+00026aa0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00026ab0: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+00026ac0: 2e6c 6173 7456 616c 732c 2028 2929 0a0a  .lastVals, ())..
+00026ad0: 2020 2020 6465 6620 7465 7374 5f66 6574      def test_fet
+00026ae0: 6368 4279 4b65 7928 7365 6c66 2c20 2a61  chByKey(self, *a
+00026af0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+00026b00: 2254 6573 7420 7468 6520 6665 7463 6842  "Test the fetchB
+00026b10: 794b 6579 2061 6e64 2067 6574 4279 4b65  yKey and getByKe
+00026b20: 7920 6675 6e63 7469 6f6e 7322 2222 0a20  y functions""". 
+00026b30: 2020 2020 2020 2073 656c 662e 696e 7365         self.inse
+00026b40: 7274 5f74 6872 6565 2829 0a20 2020 2020  rt_three().     
+00026b50: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00026b60: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00026b70: 205b 655b 2262 6962 6b65 7922 5d20 666f   [e["bibkey"] fo
+00026b80: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00026b90: 2e62 6962 732e 6665 7463 6842 794b 6579  .bibs.fetchByKey
+00026ba0: 2822 6162 6364 6566 2229 2e6c 6173 7446  ("abcdef").lastF
+00026bb0: 6574 6368 6564 5d2c 205b 5d0a 2020 2020  etched], [].    
+00026bc0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00026bd0: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
+00026be0: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
+00026bf0: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+00026c00: 6962 732e 6765 7442 794b 6579 2822 6162  ibs.getByKey("ab
+00026c10: 6364 6566 2229 5d2c 205b 5d29 0a20 2020  cdef")], []).   
+00026c20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00026c30: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00026c40: 2020 205b 655b 2262 6962 6b65 7922 5d20     [e["bibkey"] 
+00026c50: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+00026c60: 4442 2e62 6962 732e 6665 7463 6842 794b  DB.bibs.fetchByK
+00026c70: 6579 2822 6162 6322 292e 6c61 7374 4665  ey("abc").lastFe
+00026c80: 7463 6865 645d 2c20 5b22 6162 6322 5d0a  tched], ["abc"].
+00026c90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00026ca0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00026cb0: 616c 285b 655b 2262 6962 6b65 7922 5d20  al([e["bibkey"] 
+00026cc0: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+00026cd0: 4442 2e62 6962 732e 6765 7442 794b 6579  DB.bibs.getByKey
+00026ce0: 2822 6162 6322 295d 2c20 5b22 6162 6322  ("abc")], ["abc"
+00026cf0: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
+00026d00: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
+00026d10: 4669 656c 6428 2267 6869 222c 2022 6f6c  Field("ghi", "ol
+00026d20: 645f 6b65 7973 222c 2022 6162 6322 290a  d_keys", "abc").
+00026d30: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00026d40: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00026d50: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00026d60: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
+00026d70: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+00026d80: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+00026d90: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+00026da0: 6842 794b 6579 285b 2261 6263 222c 2022  hByKey(["abc", "
+00026db0: 6465 6622 5d29 2e6c 6173 7446 6574 6368  def"]).lastFetch
+00026dc0: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
+00026dd0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+00026de0: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
+00026df0: 6922 5d2c 0a20 2020 2020 2020 2029 0a20  i"],.        ). 
+00026e00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00026e10: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00026e20: 2020 2020 205b 655b 2262 6962 6b65 7922       [e["bibkey"
+00026e30: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
+00026e40: 7042 4442 2e62 6962 732e 6765 7442 794b  pBDB.bibs.getByK
+00026e50: 6579 285b 2261 6263 222c 2022 6465 6622  ey(["abc", "def"
+00026e60: 5d29 5d2c 0a20 2020 2020 2020 2020 2020  ])],.           
+00026e70: 205b 2261 6263 222c 2022 6465 6622 2c20   ["abc", "def", 
+00026e80: 2267 6869 225d 2c0a 2020 2020 2020 2020  "ghi"],.        
+00026e90: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00026ea0: 7373 6572 7452 6567 6578 2873 656c 662e  ssertRegex(self.
+00026eb0: 7042 4442 2e62 6962 732e 6c61 7374 5175  pBDB.bibs.lastQu
+00026ec0: 6572 792c 2022 7365 6c65 6374 205c 2a20  ery, "select \* 
+00026ed0: 6672 6f6d 2065 6e74 7269 6573 2020 7768  from entries  wh
+00026ee0: 6572 6520 2e2a 2229 0a20 2020 2020 2020  ere .*").       
+00026ef0: 2073 656c 662e 6173 7365 7274 5265 6765   self.assertRege
+00026f00: 7828 0a20 2020 2020 2020 2020 2020 2073  x(.            s
+00026f10: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
+00026f20: 7374 5175 6572 792c 2022 2e2a 6269 626b  stQuery, ".*bibk
+00026f30: 6579 2020 6c69 6b65 2020 205c 3f20 206f  ey  like   \?  o
+00026f40: 7220 2062 6962 6b65 7920 206c 696b 6520  r  bibkey  like 
+00026f50: 2020 5c3f 2e2a 220a 2020 2020 2020 2020    \?.*".        
+00026f60: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00026f70: 7373 6572 7452 6567 6578 280a 2020 2020  ssertRegex(.    
+00026f80: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00026f90: 422e 6269 6273 2e6c 6173 7451 7565 7279  B.bibs.lastQuery
+00026fa0: 2c20 222e 2a6f 6c64 5f6b 6579 7320 206c  , ".*old_keys  l
+00026fb0: 696b 6520 2020 5c3f 2020 6f72 2020 6f6c  ike   \?  or  ol
+00026fc0: 645f 6b65 7973 2020 6c69 6b65 2020 205c  d_keys  like   \
+00026fd0: 3f2e 2a22 0a20 2020 2020 2020 2029 0a20  ?.*".        ). 
+00026fe0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00026ff0: 7274 5265 6765 7828 7365 6c66 2e70 4244  rtRegex(self.pBD
+00027000: 422e 6269 6273 2e6c 6173 7451 7565 7279  B.bibs.lastQuery
+00027010: 2c20 222e 2a20 6f72 6465 7220 6279 2066  , ".* order by f
+00027020: 6972 7374 6461 7465 2041 5343 2229 0a20  irstdate ASC"). 
+00027030: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00027040: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+00027050: 422e 6269 6273 2e6c 6173 7456 616c 732c  B.bibs.lastVals,
+00027060: 2028 2225 6162 6325 222c 2022 2564 6566   ("%abc%", "%def
+00027070: 2522 2c20 2225 6162 6325 222c 2022 2564  %", "%abc%", "%d
+00027080: 6566 2522 2929 0a20 2020 2020 2020 2073  ef%")).        s
+00027090: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
+000270a0: 7374 5175 6572 7920 3d20 2222 0a20 2020  stQuery = "".   
+000270b0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+000270c0: 6962 732e 6c61 7374 5661 6c73 203d 2028  ibs.lastVals = (
+000270d0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000270e0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+000270f0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00027100: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
+00027110: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
+00027120: 2020 2020 2020 666f 7220 6520 696e 2073        for e in s
+00027130: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
+00027140: 7463 6842 794b 6579 2822 6162 6322 2c20  tchByKey("abc", 
+00027150: 7361 7665 5175 6572 793d 4661 6c73 6529  saveQuery=False)
+00027160: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+00027170: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00027180: 2020 2020 2020 2020 5b22 6162 6322 2c20          ["abc", 
+00027190: 2267 6869 225d 2c0a 2020 2020 2020 2020  "ghi"],.        
+000271a0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000271b0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+000271c0: 2020 2020 2020 2020 5b65 5b22 6269 626b          [e["bibk
+000271d0: 6579 225d 2066 6f72 2065 2069 6e20 7365  ey"] for e in se
+000271e0: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+000271f0: 4279 4b65 7928 2261 6263 222c 2073 6176  ByKey("abc", sav
+00027200: 6551 7565 7279 3d46 616c 7365 295d 2c0a  eQuery=False)],.
+00027210: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+00027220: 6322 2c20 2267 6869 225d 2c0a 2020 2020  c", "ghi"],.    
+00027230: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00027240: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00027250: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
+00027260: 7374 5175 6572 792c 2022 2229 0a20 2020  stQuery, "").   
+00027270: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00027280: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+00027290: 6269 6273 2e6c 6173 7456 616c 732c 2028  bibs.lastVals, (
+000272a0: 2929 0a0a 2020 2020 6465 6620 7465 7374  ))..    def test
+000272b0: 5f66 6574 6368 4672 6f6d 4469 6374 2873  _fetchFromDict(s
+000272c0: 656c 662c 202a 6172 6773 293a 0a20 2020  elf, *args):.   
+000272d0: 2020 2020 2022 2222 7465 7374 2074 6865       """test the
+000272e0: 2070 7265 7474 7920 636f 6d70 6c69 6361   pretty complica
+000272f0: 7465 6420 6675 6e63 7469 6f6e 2066 6574  ted function fet
+00027300: 6368 4672 6f6d 4469 6374 2222 220a 2020  chFromDict""".  
+00027310: 2020 2020 2020 7365 6c66 2e69 6e73 6572        self.inser
+00027320: 745f 7468 7265 6528 290a 2020 2020 2020  t_three().      
+00027330: 2020 7365 6c66 2e70 4244 422e 6269 6245    self.pBDB.bibE
+00027340: 7870 2e69 6e73 6572 7428 5b22 6162 6322  xp.insert(["abc"
+00027350: 2c20 2264 6566 225d 2c20 3029 0a20 2020  , "def"], 0).   
+00027360: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
+00027370: 6174 4269 622e 696e 7365 7274 2830 2c20  atBib.insert(0, 
+00027380: 5b22 6162 6322 5d29 0a20 2020 2020 2020  ["abc"]).       
+00027390: 2073 656c 662e 7042 4442 2e63 6174 4269   self.pBDB.catBi
+000273a0: 622e 696e 7365 7274 2831 2c20 5b22 6465  b.insert(1, ["de
+000273b0: 6622 2c20 2267 6869 225d 290a 2020 2020  f", "ghi"]).    
+000273c0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+000273d0: 7275 6528 0a20 2020 2020 2020 2020 2020  rue(.           
+000273e0: 2073 656c 662e 7042 4442 2e65 7870 732e   self.pBDB.exps.
+000273f0: 696e 7365 7274 280a 2020 2020 2020 2020  insert(.        
+00027400: 2020 2020 2020 2020 7b22 6e61 6d65 223a          {"name":
+00027410: 2022 6578 7031 222c 2022 636f 6d6d 656e   "exp1", "commen
+00027420: 7473 223a 2022 222c 2022 686f 6d65 7061  ts": "", "homepa
+00027430: 6765 223a 2022 222c 2022 696e 7370 6972  ge": "", "inspir
+00027440: 6522 3a20 2222 7d0a 2020 2020 2020 2020  e": ""}.        
+00027450: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+00027460: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+00027470: 4442 2e62 6962 732e 6c61 7374 5175 6572  DB.bibs.lastQuer
+00027480: 7920 3d20 2274 6573 7420 7175 6572 7922  y = "test query"
+00027490: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+000274a0: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
+000274b0: 6d44 6963 7428 646f 4665 7463 683d 4661  mDict(doFetch=Fa
+000274c0: 6c73 6529 0a20 2020 2020 2020 2073 656c  lse).        sel
+000274d0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+000274e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000274f0: 7042 4442 2e62 6962 732e 6c61 7374 5175  pBDB.bibs.lastQu
+00027500: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+00027510: 2022 7365 6c65 6374 202a 2066 726f 6d20   "select * from 
+00027520: 656e 7472 6965 7320 206f 7264 6572 2062  entries  order b
+00027530: 7920 6669 7273 7464 6174 6520 4153 4322  y firstdate ASC"
+00027540: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00027550: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00027560: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00027570: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00027580: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
+00027590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000275a0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+000275b0: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
+000275c0: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
+000275d0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+000275e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000275f0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00027600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027610: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
+00027620: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00027630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027640: 2266 6965 6c64 223a 2022 6269 626b 6579  "field": "bibkey
+00027650: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00027660: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00027670: 636f 6e74 656e 7422 3a20 2261 6222 2c0a  content": "ab",.
 00027680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027690: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
-000276a0: 6269 626b 6579 222c 0a20 2020 2020 2020  bibkey",.       
-000276b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000276c0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
-000276d0: 2261 6222 2c0a 2020 2020 2020 2020 2020  "ab",.          
+00027690: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+000276a0: 7261 746f 7222 3a20 2263 6f6e 7461 696e  rator": "contain
+000276b0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+000276c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000276d0: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
 000276e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000276f0: 2020 226f 7065 7261 746f 7222 3a20 2263    "operator": "c
-00027700: 6f6e 7461 696e 7322 2c0a 2020 2020 2020  ontains",.      
-00027710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027720: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-00027730: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00027740: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-00027750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027760: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00027770: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-00027780: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-00027790: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-000277a0: 6162 6322 5d2c 0a20 2020 2020 2020 2029  abc"],.        )
-000277b0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000277c0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-000277d0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-000277e0: 2e62 6962 732e 6c61 7374 5175 6572 792c  .bibs.lastQuery,
-000277f0: 0a20 2020 2020 2020 2020 2020 2022 7365  .            "se
-00027800: 6c65 6374 202a 2066 726f 6d20 656e 7472  lect * from entr
-00027810: 6965 7320 2077 6865 7265 2020 6269 626b  ies  where  bibk
-00027820: 6579 206c 696b 6520 3f20 206f 7264 6572  ey like ?  order
-00027830: 2062 7920 6669 7273 7464 6174 6520 4153   by firstdate AS
-00027840: 4322 2c0a 2020 2020 2020 2020 290a 0a20  C",.        ).. 
-00027850: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00027860: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00027870: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00027880: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00027890: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-000278a0: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-000278b0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-000278c0: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
-000278d0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+000276f0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00027700: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+00027710: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00027720: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+00027730: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00027740: 2020 2020 2020 2020 5b22 6162 6322 5d2c          ["abc"],
+00027750: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00027760: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00027770: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00027780: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00027790: 6c61 7374 5175 6572 792c 0a20 2020 2020  lastQuery,.     
+000277a0: 2020 2020 2020 2022 7365 6c65 6374 202a         "select *
+000277b0: 2066 726f 6d20 656e 7472 6965 7320 2077   from entries  w
+000277c0: 6865 7265 2020 6269 626b 6579 206c 696b  here  bibkey lik
+000277d0: 6520 3f20 206f 7264 6572 2062 7920 6669  e ?  order by fi
+000277e0: 7273 7464 6174 6520 4153 4322 2c0a 2020  rstdate ASC",.  
+000277f0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00027800: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00027810: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00027820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027830: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00027840: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00027850: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00027860: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
+00027870: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00027880: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00027890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000278a0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+000278b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000278c0: 2274 7970 6522 3a20 2245 7870 6572 696d  "type": "Experim
+000278d0: 656e 7473 222c 0a20 2020 2020 2020 2020  ents",.         
 000278e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000278f0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00027900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027910: 2020 2020 2020 2274 7970 6522 3a20 2245        "type": "E
-00027920: 7870 6572 696d 656e 7473 222c 0a20 2020  xperiments",.   
-00027930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027940: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-00027950: 6f72 223a 2022 6f6e 6522 2c0a 2020 2020  or": "one",.    
+000278f0: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+00027900: 6f6e 6522 2c0a 2020 2020 2020 2020 2020  one",.          
+00027910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027920: 2020 226c 6f67 6963 616c 223a 2022 616e    "logical": "an
+00027930: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+00027940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027950: 2263 6f6e 7465 6e74 223a 2030 2c0a 2020  "content": 0,.  
 00027960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027970: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
-00027980: 223a 2022 616e 6422 2c0a 2020 2020 2020  ": "and",.      
+00027970: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+00027980: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
 00027990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000279a0: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-000279b0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-000279c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000279d0: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
-000279e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000279f0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00027a00: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
-00027a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027a20: 2020 2020 7361 7665 5175 6572 793d 4661      saveQuery=Fa
-00027a30: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00027a40: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-00027a50: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-00027a60: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-00027a70: 6162 6322 2c20 2264 6566 225d 2c0a 2020  abc", "def"],.  
-00027a80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00027a90: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00027aa0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00027ab0: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-00027ac0: 7451 7565 7279 2c0a 2020 2020 2020 2020  tQuery,.        
-00027ad0: 2020 2020 2273 656c 6563 7420 2a20 6672      "select * fr
-00027ae0: 6f6d 2065 6e74 7269 6573 2020 7768 6572  om entries  wher
-00027af0: 6520 2062 6962 6b65 7920 6c69 6b65 203f  e  bibkey like ?
-00027b00: 2020 6f72 6465 7220 6279 2066 6972 7374    order by first
-00027b10: 6461 7465 2041 5343 222c 0a20 2020 2020  date ASC",.     
-00027b20: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
-00027b30: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00027b40: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-00027b50: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-00027b60: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00027b70: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
-00027b80: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
-00027b90: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-00027ba0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-00027bb0: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-00027bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027bd0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+000279a0: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+000279b0: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+000279c0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+000279d0: 7665 5175 6572 793d 4661 6c73 652c 0a20  veQuery=False,. 
+000279e0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000279f0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+00027a00: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00027a10: 2020 2020 2020 2020 5b22 6162 6322 2c20          ["abc", 
+00027a20: 2264 6566 225d 2c0a 2020 2020 2020 2020  "def"],.        
+00027a30: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00027a40: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00027a50: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00027a60: 422e 6269 6273 2e6c 6173 7451 7565 7279  B.bibs.lastQuery
+00027a70: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+00027a80: 656c 6563 7420 2a20 6672 6f6d 2065 6e74  elect * from ent
+00027a90: 7269 6573 2020 7768 6572 6520 2062 6962  ries  where  bib
+00027aa0: 6b65 7920 6c69 6b65 203f 2020 6f72 6465  key like ?  orde
+00027ab0: 7220 6279 2066 6972 7374 6461 7465 2041  r by firstdate A
+00027ac0: 5343 222c 0a20 2020 2020 2020 2029 0a0a  SC",.        )..
+00027ad0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00027ae0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00027af0: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
+00027b00: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00027b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b20: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+00027b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b40: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+00027b50: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+00027b60: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+00027b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b80: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00027b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ba0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00027bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027bc0: 2020 2022 7479 7065 223a 2022 696e 7661     "type": "inva
+00027bd0: 6c69 6422 2c0a 2020 2020 2020 2020 2020  lid",.          
 00027be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027bf0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00027c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027c10: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-00027c20: 2022 696e 7661 6c69 6422 2c0a 2020 2020   "invalid",.    
-00027c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027c40: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-00027c50: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
-00027c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027c70: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
-00027c80: 6174 6f72 223a 2022 3d22 2c0a 2020 2020  ator": "=",.    
-00027c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ca0: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-00027cb0: 7465 6e74 223a 2022 6e65 7722 2c0a 2020  tent": "new",.  
-00027cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027cd0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00027ce0: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
-00027cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027d00: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00027d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027d20: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00027d30: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
-00027d40: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
-00027d50: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00027d60: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00027d70: 2020 2020 5b22 6162 6322 2c20 2264 6566      ["abc", "def
-00027d80: 222c 2022 6768 6922 5d2c 0a20 2020 2020  ", "ghi"],.     
-00027d90: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00027da0: 7472 7920 7769 7468 2064 6966 6665 7265  try with differe
-00027db0: 6e74 2063 6174 7320 616e 6420 6578 7073  nt cats and exps
-00027dc0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00027dd0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00027de0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00027df0: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
-00027e00: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
-00027e10: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-00027e20: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-00027e30: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-00027e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e50: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00027e60: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00027e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e80: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-00027e90: 2245 7870 6572 696d 656e 7473 222c 0a20  "Experiments",. 
-00027ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027eb0: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
-00027ec0: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
+00027bf0: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+00027c00: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00027c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c20: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
+00027c30: 2022 3d22 2c0a 2020 2020 2020 2020 2020   "=",.          
+00027c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c50: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+00027c60: 2022 6e65 7722 2c0a 2020 2020 2020 2020   "new",.        
+00027c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c80: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+00027c90: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00027ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027cb0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00027cc0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+00027cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ce0: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
+00027cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027d00: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
+00027d10: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+00027d20: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
+00027d30: 6922 5d2c 0a20 2020 2020 2020 2029 0a0a  i"],.        )..
+00027d40: 2020 2020 2020 2020 2320 7472 7920 7769          # try wi
+00027d50: 7468 2064 6966 6665 7265 6e74 2063 6174  th different cat
+00027d60: 7320 616e 6420 6578 7073 0a20 2020 2020  s and exps.     
+00027d70: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00027d80: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00027d90: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00027da0: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
+00027db0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00027dc0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+00027dd0: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+00027de0: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+00027df0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00027e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e10: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00027e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e30: 2020 2274 7970 6522 3a20 2245 7870 6572    "type": "Exper
+00027e40: 696d 656e 7473 222c 0a20 2020 2020 2020  iments",.       
+00027e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e60: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
+00027e70: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+00027e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027e90: 226f 7065 7261 746f 7222 3a20 226f 6e65  "operator": "one
+00027ea0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00027eb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00027ec0: 636f 6e74 656e 7422 3a20 302c 0a20 2020  content": 0,.   
 00027ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ee0: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
-00027ef0: 3a20 226f 6e65 222c 0a20 2020 2020 2020  : "one",.       
+00027ee0: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
+00027ef0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
 00027f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f10: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
-00027f20: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-00027f30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00027f40: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
-00027f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f60: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-00027f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f80: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00027f90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00027fa0: 7479 7065 223a 2022 4361 7465 676f 7269  type": "Categori
-00027fb0: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
-00027fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027fd0: 2022 6f70 6572 6174 6f72 223a 2022 6174   "operator": "at
-00027fe0: 206c 6561 7374 206f 6e65 2061 6d6f 6e67   least one among
-00027ff0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00028000: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00028010: 6c6f 6769 6361 6c22 3a20 2261 6e64 222c  logical": "and",
-00028020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028030: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-00028040: 6e74 656e 7422 3a20 5b30 2c20 315d 2c0a  ntent": [0, 1],.
-00028050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028060: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-00028070: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
-00028080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028090: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-000280a0: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-000280b0: 2020 2020 2020 2020 2020 2020 292e 6c61              ).la
-000280c0: 7374 4665 7463 6865 640a 2020 2020 2020  stFetched.      
-000280d0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-000280e0: 2020 2020 205b 2261 6263 222c 2022 6465       ["abc", "de
-000280f0: 6622 5d2c 0a20 2020 2020 2020 2029 0a20  f"],.        ). 
-00028100: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00028110: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00028120: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00028130: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00028140: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00028150: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-00028160: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-00028170: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
-00028180: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00027f10: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00027f20: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00027f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027f40: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+00027f50: 2022 4361 7465 676f 7269 6573 222c 0a20   "Categories",. 
+00027f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027f70: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
+00027f80: 6174 6f72 223a 2022 6174 206c 6561 7374  ator": "at least
+00027f90: 206f 6e65 2061 6d6f 6e67 222c 0a20 2020   one among",.   
+00027fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027fb0: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
+00027fc0: 6c22 3a20 2261 6e64 222c 0a20 2020 2020  l": "and",.     
+00027fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027fe0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+00027ff0: 3a20 5b30 2c20 315d 2c0a 2020 2020 2020  : [0, 1],.      
+00028000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028010: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
+00028020: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00028030: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00028040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028050: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+00028060: 2020 2020 2020 292e 6c61 7374 4665 7463        ).lastFetc
+00028070: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
+00028080: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+00028090: 2261 6263 222c 2022 6465 6622 5d2c 0a20  "abc", "def"],. 
+000280a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000280b0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000280c0: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+000280d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000280e0: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+000280f0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00028100: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00028110: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
+00028120: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00028130: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00028140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028150: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00028160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028170: 2274 7970 6522 3a20 2245 7870 6572 696d  "type": "Experim
+00028180: 656e 7473 222c 0a20 2020 2020 2020 2020  ents",.         
 00028190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000281a0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-000281b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000281c0: 2020 2020 2020 2274 7970 6522 3a20 2245        "type": "E
-000281d0: 7870 6572 696d 656e 7473 222c 0a20 2020  xperiments",.   
-000281e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000281f0: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00028200: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
+000281a0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+000281b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000281c0: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+000281d0: 7065 7261 746f 7222 3a20 226f 6e65 222c  perator": "one",
+000281e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000281f0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+00028200: 6e74 656e 7422 3a20 302c 0a20 2020 2020  ntent": 0,.     
 00028210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028220: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-00028230: 226f 6e65 222c 0a20 2020 2020 2020 2020  "one",.         
-00028240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028250: 2020 2022 636f 6e74 656e 7422 3a20 302c     "content": 0,
-00028260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028270: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
-00028280: 656c 6422 3a20 4e6f 6e65 2c0a 2020 2020  eld": None,.    
-00028290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282a0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-000282b0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-000282c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000282d0: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-000282e0: 7065 223a 2022 4361 7465 676f 7269 6573  pe": "Categories
-000282f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00028300: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00028310: 6f70 6572 6174 6f72 223a 2022 6174 206c  operator": "at l
-00028320: 6561 7374 206f 6e65 2061 6d6f 6e67 222c  east one among",
-00028330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028340: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-00028350: 6769 6361 6c22 3a20 226f 7222 2c0a 2020  gical": "or",.  
-00028360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028370: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-00028380: 6e74 223a 205b 302c 2031 5d2c 0a20 2020  nt": [0, 1],.   
-00028390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000283a0: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-000283b0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-000283c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000283d0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-000283e0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-000283f0: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
-00028400: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
-00028410: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-00028420: 2020 5b22 6162 6322 2c20 2264 6566 222c    ["abc", "def",
-00028430: 2022 6768 6922 5d2c 0a20 2020 2020 2020   "ghi"],.       
-00028440: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00028450: 7042 4442 2e63 6174 4269 622e 696e 7365  pBDB.catBib.inse
-00028460: 7274 2830 2c20 5b22 6465 6622 5d29 0a20  rt(0, ["def"]). 
-00028470: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00028480: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00028490: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-000284a0: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-000284b0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-000284c0: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-000284d0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-000284e0: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
-000284f0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00028220: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
+00028230: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00028240: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+00028250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028260: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00028270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028280: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
+00028290: 4361 7465 676f 7269 6573 222c 0a20 2020  Categories",.   
+000282a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282b0: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
+000282c0: 6f72 223a 2022 6174 206c 6561 7374 206f  or": "at least o
+000282d0: 6e65 2061 6d6f 6e67 222c 0a20 2020 2020  ne among",.     
+000282e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282f0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+00028300: 3a20 226f 7222 2c0a 2020 2020 2020 2020  : "or",.        
+00028310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028320: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
+00028330: 302c 2031 5d2c 0a20 2020 2020 2020 2020  0, 1],.         
+00028340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028350: 2020 2022 6669 656c 6422 3a20 4e6f 6e65     "field": None
+00028360: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00028370: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00028380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028390: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+000283a0: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
+000283b0: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
+000283c0: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+000283d0: 6322 2c20 2264 6566 222c 2022 6768 6922  c", "def", "ghi"
+000283e0: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+000283f0: 2020 2020 2073 656c 662e 7042 4442 2e63       self.pBDB.c
+00028400: 6174 4269 622e 696e 7365 7274 2830 2c20  atBib.insert(0, 
+00028410: 5b22 6465 6622 5d29 0a20 2020 2020 2020  ["def"]).       
+00028420: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00028430: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00028440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028450: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00028460: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00028470: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00028480: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
+00028490: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+000284a0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+000284b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284c0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+000284d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284e0: 2274 7970 6522 3a20 2243 6174 6567 6f72  "type": "Categor
+000284f0: 6965 7322 2c0a 2020 2020 2020 2020 2020  ies",.          
 00028500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028510: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00028520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028530: 2020 2020 2020 2274 7970 6522 3a20 2243        "type": "C
-00028540: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
+00028510: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
+00028520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028530: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+00028540: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
 00028550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028560: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00028570: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00028580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028590: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
-000285a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000285b0: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-000285c0: 7065 7261 746f 7222 3a20 2261 6c6c 2074  perator": "all t
-000285d0: 6865 2066 6f6c 6c6f 7769 6e67 222c 0a20  he following",. 
-000285e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000285f0: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-00028600: 656e 7422 3a20 5b30 2c20 315d 2c0a 2020  ent": [0, 1],.  
-00028610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028620: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-00028630: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-00028640: 2020 2020 2020 2020 2020 2020 2020 292e                ).
-00028650: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
-00028660: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00028670: 2020 2020 2020 205b 2264 6566 225d 2c0a         ["def"],.
-00028680: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00028690: 2020 7365 6c66 2e70 4244 422e 6361 7442    self.pBDB.catB
-000286a0: 6962 2e64 656c 6574 6528 302c 2022 6465  ib.delete(0, "de
-000286b0: 6622 290a 0a20 2020 2020 2020 2023 2063  f")..        # c
-000286c0: 6865 636b 206c 696d 6974 546f 2c20 6c69  heck limitTo, li
-000286d0: 6d69 744f 6666 7365 740a 2020 2020 2020  mitOffset.      
-000286e0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000286f0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00028700: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00028710: 2020 655b 2262 6962 6b65 7922 5d0a 2020    e["bibkey"].  
-00028720: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00028730: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-00028740: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
-00028750: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
-00028760: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-00028770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028780: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00028560: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
+00028570: 7222 3a20 2261 6c6c 2074 6865 2066 6f6c  r": "all the fol
+00028580: 6c6f 7769 6e67 222c 0a20 2020 2020 2020  lowing",.       
+00028590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000285a0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+000285b0: 5b30 2c20 315d 2c0a 2020 2020 2020 2020  [0, 1],.        
+000285c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000285d0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+000285e0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+000285f0: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
+00028600: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
+00028610: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+00028620: 205b 2264 6566 225d 2c0a 2020 2020 2020   ["def"],.      
+00028630: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00028640: 2e70 4244 422e 6361 7442 6962 2e64 656c  .pBDB.catBib.del
+00028650: 6574 6528 302c 2022 6465 6622 290a 0a20  ete(0, "def").. 
+00028660: 2020 2020 2020 2023 2063 6865 636b 206c         # check l
+00028670: 696d 6974 546f 2c20 6c69 6d69 744f 6666  imitTo, limitOff
+00028680: 7365 740a 2020 2020 2020 2020 7365 6c66  set.        self
+00028690: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+000286a0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+000286b0: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
+000286c0: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
+000286d0: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
+000286e0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+000286f0: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
+00028700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028710: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00028720: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+00028730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028740: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+00028750: 223a 2022 4578 7065 7269 6d65 6e74 7322  ": "Experiments"
+00028760: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00028770: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+00028780: 6f67 6963 616c 223a 2022 222c 0a20 2020  ogical": "",.   
 00028790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000287a0: 2022 7479 7065 223a 2022 4578 7065 7269   "type": "Experi
-000287b0: 6d65 6e74 7322 2c0a 2020 2020 2020 2020  ments",.        
+000287a0: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
+000287b0: 6f72 223a 2022 6f6e 6522 2c0a 2020 2020  or": "one",.    
 000287c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000287d0: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
-000287e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000287f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00028800: 6f70 6572 6174 6f72 223a 2022 6f6e 6522  operator": "one"
-00028810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00028820: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00028830: 6f6e 7465 6e74 223a 2030 2c0a 2020 2020  ontent": 0,.    
-00028840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028850: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00028860: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00028870: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00028880: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00028890: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-000288a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000288b0: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-000288c0: 2243 6174 6567 6f72 6965 7322 2c0a 2020  "Categories",.  
-000288d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000288e0: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
-000288f0: 746f 7222 3a20 2261 7420 6c65 6173 7420  tor": "at least 
-00028900: 6f6e 6520 616d 6f6e 6722 2c0a 2020 2020  one among",.    
-00028910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028920: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
-00028930: 223a 2022 616e 6422 2c0a 2020 2020 2020  ": "and",.      
+000287d0: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
+000287e0: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
+000287f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028800: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
+00028810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028820: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+00028830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028840: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00028850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028860: 2020 2274 7970 6522 3a20 2243 6174 6567    "type": "Categ
+00028870: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
+00028880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028890: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
+000288a0: 2261 7420 6c65 6173 7420 6f6e 6520 616d  "at least one am
+000288b0: 6f6e 6722 2c0a 2020 2020 2020 2020 2020  ong",.          
+000288c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000288d0: 2020 226c 6f67 6963 616c 223a 2022 616e    "logical": "an
+000288e0: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+000288f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028900: 2263 6f6e 7465 6e74 223a 205b 302c 2031  "content": [0, 1
+00028910: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00028920: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00028930: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
 00028940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028950: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-00028960: 205b 302c 2031 5d2c 0a20 2020 2020 2020   [0, 1],.       
+00028950: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00028960: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
 00028970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028980: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
-00028990: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-000289a0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-000289b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000289c0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-000289d0: 2020 2020 2020 2020 2020 6c69 6d69 7454            limitT
-000289e0: 6f3d 322c 0a20 2020 2020 2020 2020 2020  o=2,.           
-000289f0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-00028a00: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-00028a10: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-00028a20: 6162 6322 2c20 2264 6566 225d 2c0a 2020  abc", "def"],.  
-00028a30: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00028a40: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00028a50: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
+00028980: 2020 2020 6c69 6d69 7454 6f3d 322c 0a20      limitTo=2,. 
+00028990: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000289a0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+000289b0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+000289c0: 2020 2020 2020 2020 5b22 6162 6322 2c20          ["abc", 
+000289d0: 2264 6566 225d 2c0a 2020 2020 2020 2020  "def"],.        
+000289e0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000289f0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00028a00: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00028a10: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
+00028a20: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
+00028a30: 2020 2020 2020 666f 7220 6520 696e 2073        for e in s
+00028a40: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
+00028a50: 7463 6846 726f 6d44 6963 7428 0a20 2020  tchFromDict(.   
 00028a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028a70: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
-00028a80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00028a90: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
-00028aa0: 6962 732e 6665 7463 6846 726f 6d44 6963  ibs.fetchFromDic
-00028ab0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00028ac0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00028ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ae0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00028af0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00028b00: 7479 7065 223a 2022 4578 7065 7269 6d65  type": "Experime
-00028b10: 6e74 7322 2c0a 2020 2020 2020 2020 2020  nts",.          
+00028a70: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00028a80: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00028a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028aa0: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+00028ab0: 2022 4578 7065 7269 6d65 6e74 7322 2c0a   "Experiments",.
+00028ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ad0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+00028ae0: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
+00028af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028b00: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
+00028b10: 223a 2022 6f6e 6522 2c0a 2020 2020 2020  ": "one",.      
 00028b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028b30: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
-00028b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028b50: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
-00028b60: 6572 6174 6f72 223a 2022 6f6e 6522 2c0a  erator": "one",.
+00028b30: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+00028b40: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+00028b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028b60: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
 00028b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028b80: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-00028b90: 7465 6e74 223a 2030 2c0a 2020 2020 2020  tent": 0,.      
-00028ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028bb0: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
-00028bc0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-00028bd0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00028b80: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00028b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ba0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00028bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028bc0: 2274 7970 6522 3a20 2243 6174 6567 6f72  "type": "Categor
+00028bd0: 6965 7322 2c0a 2020 2020 2020 2020 2020  ies",.          
 00028be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028bf0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00028c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028c10: 2020 2020 2020 2274 7970 6522 3a20 2243        "type": "C
-00028c20: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
-00028c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028c40: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-00028c50: 7222 3a20 2261 7420 6c65 6173 7420 6f6e  r": "at least on
-00028c60: 6520 616d 6f6e 6722 2c0a 2020 2020 2020  e among",.      
+00028bf0: 2020 226f 7065 7261 746f 7222 3a20 2261    "operator": "a
+00028c00: 7420 6c65 6173 7420 6f6e 6520 616d 6f6e  t least one amon
+00028c10: 6722 2c0a 2020 2020 2020 2020 2020 2020  g",.            
+00028c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c30: 226c 6f67 6963 616c 223a 2022 6f72 222c  "logical": "or",
+00028c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028c50: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+00028c60: 6e74 656e 7422 3a20 5b30 2c20 315d 2c0a  ntent": [0, 1],.
 00028c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028c80: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-00028c90: 2022 6f72 222c 0a20 2020 2020 2020 2020   "or",.         
+00028c80: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
+00028c90: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
 00028ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028cb0: 2020 2022 636f 6e74 656e 7422 3a20 5b30     "content": [0
-00028cc0: 2c20 315d 2c0a 2020 2020 2020 2020 2020  , 1],.          
+00028cb0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+00028cc0: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
 00028cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ce0: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
-00028cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028d00: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-00028d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d20: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00028d30: 2020 2020 2020 206c 696d 6974 546f 3d31         limitTo=1
-00028d40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00028d50: 2020 2020 2020 6c69 6d69 744f 6666 7365        limitOffse
-00028d60: 743d 322c 0a20 2020 2020 2020 2020 2020  t=2,.           
-00028d70: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-00028d80: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-00028d90: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-00028da0: 6768 6922 5d2c 0a20 2020 2020 2020 2029  ghi"],.        )
-00028db0: 0a0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
-00028dc0: 6b20 6f72 6465 7242 792c 206f 7264 6572  k orderBy, order
-00028dd0: 5479 7065 0a20 2020 2020 2020 2073 656c  Type.        sel
-00028de0: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
-00028df0: 7465 4669 656c 6428 2264 6566 222c 2022  teField("def", "
-00028e00: 6669 7273 7464 6174 6522 2c20 2232 3031  firstdate", "201
-00028e10: 382d 3031 2d30 3122 290a 2020 2020 2020  8-01-01").      
-00028e20: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00028e30: 2e75 7064 6174 6546 6965 6c64 2822 6162  .updateField("ab
-00028e40: 6322 2c20 2266 6972 7374 6461 7465 222c  c", "firstdate",
-00028e50: 2022 3230 3138 2d30 312d 3032 2229 0a20   "2018-01-02"). 
-00028e60: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00028e70: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00028e80: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00028e90: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00028ea0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00028eb0: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-00028ec0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-00028ed0: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
-00028ee0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00028ce0: 206c 696d 6974 546f 3d31 2c0a 2020 2020   limitTo=1,.    
+00028cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028d00: 6c69 6d69 744f 6666 7365 743d 322c 0a20  limitOffset=2,. 
+00028d10: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00028d20: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+00028d30: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00028d40: 2020 2020 2020 2020 5b22 6768 6922 5d2c          ["ghi"],
+00028d50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00028d60: 2020 2020 2320 6368 6563 6b20 6f72 6465      # check orde
+00028d70: 7242 792c 206f 7264 6572 5479 7065 0a20  rBy, orderType. 
+00028d80: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00028d90: 2e62 6962 732e 7570 6461 7465 4669 656c  .bibs.updateFiel
+00028da0: 6428 2264 6566 222c 2022 6669 7273 7464  d("def", "firstd
+00028db0: 6174 6522 2c20 2232 3031 382d 3031 2d30  ate", "2018-01-0
+00028dc0: 3122 290a 2020 2020 2020 2020 7365 6c66  1").        self
+00028dd0: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+00028de0: 6546 6965 6c64 2822 6162 6322 2c20 2266  eField("abc", "f
+00028df0: 6972 7374 6461 7465 222c 2022 3230 3138  irstdate", "2018
+00028e00: 2d30 312d 3032 2229 0a20 2020 2020 2020  -01-02").       
+00028e10: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00028e20: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
+00028e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028e40: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00028e50: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00028e60: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00028e70: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
+00028e80: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00028e90: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00028ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028eb0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00028ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ed0: 2274 7970 6522 3a20 2245 7870 6572 696d  "type": "Experim
+00028ee0: 656e 7473 222c 0a20 2020 2020 2020 2020  ents",.         
 00028ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f00: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00028f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f20: 2020 2020 2020 2274 7970 6522 3a20 2245        "type": "E
-00028f30: 7870 6572 696d 656e 7473 222c 0a20 2020  xperiments",.   
-00028f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f50: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00028f60: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
+00028f00: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+00028f10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00028f20: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+00028f30: 7065 7261 746f 7222 3a20 226f 6e65 222c  perator": "one",
+00028f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028f50: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+00028f60: 6e74 656e 7422 3a20 302c 0a20 2020 2020  ntent": 0,.     
 00028f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f80: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-00028f90: 226f 6e65 222c 0a20 2020 2020 2020 2020  "one",.         
-00028fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028fb0: 2020 2022 636f 6e74 656e 7422 3a20 302c     "content": 0,
-00028fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028fd0: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
-00028fe0: 656c 6422 3a20 2222 2c0a 2020 2020 2020  eld": "",.      
-00028ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029000: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00029010: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-00029020: 2020 2020 2020 2020 2020 292e 6c61 7374            ).last
-00029030: 4665 7463 6865 640a 2020 2020 2020 2020  Fetched.        
-00029040: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-00029050: 2020 205b 2264 6566 222c 2022 6162 6322     ["def", "abc"
-00029060: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-00029070: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00029080: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00029090: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-000290a0: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-000290b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000290c0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-000290d0: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
-000290e0: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
-000290f0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00028f80: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
+00028f90: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+00028fa0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00028fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028fc0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+00028fd0: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
+00028fe0: 640a 2020 2020 2020 2020 2020 2020 5d2c  d.            ],
+00028ff0: 0a20 2020 2020 2020 2020 2020 205b 2264  .            ["d
+00029000: 6566 222c 2022 6162 6322 5d2c 0a20 2020  ef", "abc"],.   
+00029010: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00029020: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00029030: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
+00029040: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00029050: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+00029060: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+00029070: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+00029080: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
+00029090: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000290a0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+000290b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000290c0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000290d0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+000290e0: 7970 6522 3a20 2245 7870 6572 696d 656e  ype": "Experimen
+000290f0: 7473 222c 0a20 2020 2020 2020 2020 2020  ts",.           
 00029100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029110: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00029110: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
 00029120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029130: 2020 2020 2274 7970 6522 3a20 2245 7870      "type": "Exp
-00029140: 6572 696d 656e 7473 222c 0a20 2020 2020  eriments",.     
+00029130: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+00029140: 7261 746f 7222 3a20 226f 6e65 222c 0a20  rator": "one",. 
 00029150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029160: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-00029170: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00029160: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
+00029170: 656e 7422 3a20 302c 0a20 2020 2020 2020  ent": 0,.       
 00029180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029190: 2020 226f 7065 7261 746f 7222 3a20 226f    "operator": "o
-000291a0: 6e65 222c 0a20 2020 2020 2020 2020 2020  ne",.           
-000291b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000291c0: 2022 636f 6e74 656e 7422 3a20 302c 0a20   "content": 0,. 
-000291d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000291e0: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
-000291f0: 6422 3a20 2222 2c0a 2020 2020 2020 2020  d": "",.        
-00029200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029210: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00029220: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00029230: 2020 2020 2020 2020 2020 2020 206f 7264               ord
-00029240: 6572 4279 3d22 6269 626b 6579 222c 0a20  erBy="bibkey",. 
-00029250: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00029260: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
-00029270: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00029280: 2020 2020 2020 2020 5b22 6162 6322 2c20          ["abc", 
-00029290: 2264 6566 225d 2c0a 2020 2020 2020 2020  "def"],.        
-000292a0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000292b0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-000292c0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-000292d0: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
-000292e0: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
-000292f0: 2020 2020 2020 666f 7220 6520 696e 2073        for e in s
-00029300: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
-00029310: 7463 6846 726f 6d44 6963 7428 0a20 2020  tchFromDict(.   
-00029320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029330: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00029340: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-00029350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029360: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-00029370: 2022 4578 7065 7269 6d65 6e74 7322 2c0a   "Experiments",.
-00029380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029390: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-000293a0: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
+00029190: 2020 2020 2022 6669 656c 6422 3a20 2222       "field": ""
+000291a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000291b0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+000291c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000291d0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000291e0: 2020 2020 2020 206f 7264 6572 4279 3d22         orderBy="
+000291f0: 6269 626b 6579 222c 0a20 2020 2020 2020  bibkey",.       
+00029200: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
+00029210: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
+00029220: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+00029230: 2020 5b22 6162 6322 2c20 2264 6566 225d    ["abc", "def"]
+00029240: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00029250: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00029260: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00029270: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+00029280: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+00029290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000292a0: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+000292b0: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
+000292c0: 6d44 6963 7428 0a20 2020 2020 2020 2020  mDict(.         
+000292d0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+000292e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000292f0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+00029300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029310: 2020 2022 7479 7065 223a 2022 4578 7065     "type": "Expe
+00029320: 7269 6d65 6e74 7322 2c0a 2020 2020 2020  riments",.      
+00029330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029340: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+00029350: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00029360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029370: 2022 6f70 6572 6174 6f72 223a 2022 6f6e   "operator": "on
+00029380: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00029390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293a0: 2263 6f6e 7465 6e74 223a 2030 2c0a 2020  "content": 0,.  
 000293b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000293c0: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-000293d0: 223a 2022 6f6e 6522 2c0a 2020 2020 2020  ": "one",.      
-000293e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000293f0: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-00029400: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-00029410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029420: 2266 6965 6c64 223a 2022 222c 0a20 2020  "field": "",.   
-00029430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029440: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-00029450: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-00029460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029470: 2020 6f72 6465 7254 7970 653d 2244 4553    orderType="DES
-00029480: 4322 2c0a 2020 2020 2020 2020 2020 2020  C",.            
-00029490: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
-000294a0: 640a 2020 2020 2020 2020 2020 2020 5d2c  d.            ],
-000294b0: 0a20 2020 2020 2020 2020 2020 205b 2261  .            ["a
-000294c0: 6263 222c 2022 6465 6622 5d2c 0a20 2020  bc", "def"],.   
-000294d0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-000294e0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000294f0: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-00029500: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00029510: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
-00029520: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-00029530: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-00029540: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
-00029550: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00029560: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-00029570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029580: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00029590: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-000295a0: 7970 6522 3a20 2245 7870 6572 696d 656e  ype": "Experimen
-000295b0: 7473 222c 0a20 2020 2020 2020 2020 2020  ts",.           
+000293c0: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+000293d0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+000293e0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+000293f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029400: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00029410: 2020 2020 2020 2020 2020 2020 6f72 6465              orde
+00029420: 7254 7970 653d 2244 4553 4322 2c0a 2020  rType="DESC",.  
+00029430: 2020 2020 2020 2020 2020 2020 2020 292e                ).
+00029440: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
+00029450: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+00029460: 2020 2020 2020 205b 2261 6263 222c 2022         ["abc", "
+00029470: 6465 6622 5d2c 0a20 2020 2020 2020 2029  def"],.        )
+00029480: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00029490: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+000294a0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+000294b0: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
+000294c0: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
+000294d0: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
+000294e0: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
+000294f0: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
+00029500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029510: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00029520: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00029530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029540: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
+00029550: 2245 7870 6572 696d 656e 7473 222c 0a20  "Experiments",. 
+00029560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029570: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+00029580: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
+00029590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000295a0: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
+000295b0: 3a20 226f 6e65 222c 0a20 2020 2020 2020  : "one",.       
 000295c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295d0: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
-000295e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295f0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
-00029600: 7261 746f 7222 3a20 226f 6e65 222c 0a20  rator": "one",. 
+000295d0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+000295e0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+000295f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00029600: 6669 656c 6422 3a20 2222 2c0a 2020 2020  field": "",.    
 00029610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029620: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-00029630: 656e 7422 3a20 302c 0a20 2020 2020 2020  ent": 0,.       
+00029620: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+00029630: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
 00029640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029650: 2020 2020 2022 6669 656c 6422 3a20 2222       "field": ""
-00029660: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00029670: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-00029680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029690: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-000296a0: 2020 2020 2020 206f 7264 6572 4279 3d22         orderBy="
-000296b0: 6269 626b 6579 222c 0a20 2020 2020 2020  bibkey",.       
-000296c0: 2020 2020 2020 2020 2020 2020 206f 7264               ord
-000296d0: 6572 5479 7065 3d22 4445 5343 222c 0a20  erType="DESC",. 
-000296e0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000296f0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
-00029700: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00029710: 2020 2020 2020 2020 5b22 6465 6622 2c20          ["def", 
-00029720: 2261 6263 225d 2c0a 2020 2020 2020 2020  "abc"],.        
-00029730: 290a 0a20 2020 2020 2020 2023 2063 6865  )..        # che
-00029740: 636b 2063 6f6e 6e65 6374 696f 6e20 6f70  ck connection op
-00029750: 6572 6174 6f72 2061 6e64 206d 756c 7469  erator and multi
-00029760: 706c 6520 6d61 7463 680a 2020 2020 2020  ple match.      
-00029770: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00029780: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00029790: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000297a0: 2020 655b 2262 6962 6b65 7922 5d0a 2020    e["bibkey"].  
-000297b0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000297c0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-000297d0: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
-000297e0: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
-000297f0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-00029800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029810: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00029650: 206f 7264 6572 4279 3d22 6269 626b 6579   orderBy="bibkey
+00029660: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00029670: 2020 2020 2020 206f 7264 6572 5479 7065         orderType
+00029680: 3d22 4445 5343 222c 0a20 2020 2020 2020  ="DESC",.       
+00029690: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
+000296a0: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
+000296b0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+000296c0: 2020 5b22 6465 6622 2c20 2261 6263 225d    ["def", "abc"]
+000296d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000296e0: 2020 2020 2023 2063 6865 636b 2063 6f6e       # check con
+000296f0: 6e65 6374 696f 6e20 6f70 6572 6174 6f72  nection operator
+00029700: 2061 6e64 206d 756c 7469 706c 6520 6d61   and multiple ma
+00029710: 7463 680a 2020 2020 2020 2020 7365 6c66  tch.        self
+00029720: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00029730: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00029740: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
+00029750: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
+00029760: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
+00029770: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00029780: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
+00029790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297a0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+000297b0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+000297c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297d0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+000297e0: 223a 2022 5465 7874 222c 0a20 2020 2020  ": "Text",.     
+000297f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029800: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
+00029810: 2262 6962 6b65 7922 2c0a 2020 2020 2020  "bibkey",.      
 00029820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029830: 2022 7479 7065 223a 2022 5465 7874 222c   "type": "Text",
-00029840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029850: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
-00029860: 656c 6422 3a20 2262 6962 6b65 7922 2c0a  eld": "bibkey",.
-00029870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029880: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-00029890: 7465 6e74 223a 2022 6122 2c0a 2020 2020  tent": "a",.    
-000298a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000298b0: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-000298c0: 7222 3a20 2263 6f6e 7461 696e 7322 2c0a  r": "contains",.
-000298d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000298e0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-000298f0: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
-00029900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029910: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-00029920: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00029930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029940: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00029950: 6522 3a20 2254 6578 7422 2c0a 2020 2020  e": "Text",.    
-00029960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029970: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00029980: 2022 6269 626b 6579 222c 0a20 2020 2020   "bibkey",.     
-00029990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000299a0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-000299b0: 3a20 2262 222c 0a20 2020 2020 2020 2020  : "b",.         
+00029830: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+00029840: 2022 6122 2c0a 2020 2020 2020 2020 2020   "a",.          
+00029850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029860: 2020 226f 7065 7261 746f 7222 3a20 2263    "operator": "c
+00029870: 6f6e 7461 696e 7322 2c0a 2020 2020 2020  ontains",.      
+00029880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029890: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+000298a0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+000298b0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+000298c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000298d0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+000298e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000298f0: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
+00029900: 6578 7422 2c0a 2020 2020 2020 2020 2020  ext",.          
+00029910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029920: 2020 2266 6965 6c64 223a 2022 6269 626b    "field": "bibk
+00029930: 6579 222c 0a20 2020 2020 2020 2020 2020  ey",.           
+00029940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029950: 2022 636f 6e74 656e 7422 3a20 2262 222c   "content": "b",
+00029960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029970: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+00029980: 6572 6174 6f72 223a 2022 636f 6e74 6169  erator": "contai
+00029990: 6e73 222c 0a20 2020 2020 2020 2020 2020  ns",.           
+000299a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000299b0: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
 000299c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000299d0: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-000299e0: 636f 6e74 6169 6e73 222c 0a20 2020 2020  contains",.     
-000299f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a00: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-00029a10: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-00029a20: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-00029a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029a40: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00029a50: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
-00029a60: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
-00029a70: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
-00029a80: 5b22 6162 6322 5d2c 0a20 2020 2020 2020  ["abc"],.       
-00029a90: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00029aa0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00029ab0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-00029ac0: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
-00029ad0: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
-00029ae0: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
-00029af0: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-00029b00: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
-00029b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029b20: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00029b30: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00029b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029b50: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-00029b60: 3a20 2254 6578 7422 2c0a 2020 2020 2020  : "Text",.      
-00029b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029b80: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
-00029b90: 6269 626b 6579 222c 0a20 2020 2020 2020  bibkey",.       
-00029ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bb0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
-00029bc0: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
-00029bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029be0: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-00029bf0: 6578 6163 7420 6d61 7463 6822 2c0a 2020  exact match",.  
-00029c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c10: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-00029c20: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
-00029c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c40: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-00029c50: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00029c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c70: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-00029c80: 3a20 2254 6578 7422 2c0a 2020 2020 2020  : "Text",.      
+000299d0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+000299e0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+000299f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029a00: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
+00029a10: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+00029a20: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
+00029a30: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00029a40: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00029a50: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00029a60: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00029a70: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
+00029a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029a90: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+00029aa0: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
+00029ab0: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
+00029ac0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00029ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ae0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00029af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029b00: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
+00029b10: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00029b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029b30: 2266 6965 6c64 223a 2022 6269 626b 6579  "field": "bibkey
+00029b40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00029b50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00029b60: 636f 6e74 656e 7422 3a20 2261 6263 222c  content": "abc",
+00029b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029b80: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+00029b90: 6572 6174 6f72 223a 2022 6578 6163 7420  erator": "exact 
+00029ba0: 6d61 7463 6822 2c0a 2020 2020 2020 2020  match",.        
+00029bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029bc0: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+00029bd0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00029be0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00029bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c00: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00029c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c20: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
+00029c30: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00029c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c50: 2266 6965 6c64 223a 2022 6172 7869 7622  "field": "arxiv"
+00029c60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00029c70: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00029c80: 6f6e 7465 6e74 223a 2022 6162 6322 2c0a  ontent": "abc",.
 00029c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ca0: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
-00029cb0: 6172 7869 7622 2c0a 2020 2020 2020 2020  arxiv",.        
-00029cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029cd0: 2020 2020 2263 6f6e 7465 6e74 223a 2022      "content": "
-00029ce0: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
-00029cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d00: 2020 226f 7065 7261 746f 7222 3a20 2265    "operator": "e
-00029d10: 7861 6374 206d 6174 6368 222c 0a20 2020  xact match",.   
-00029d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d30: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00029d40: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-00029d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d60: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00029d70: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00029d80: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
-00029d90: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
-00029da0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-00029db0: 2020 5b22 6162 6322 5d2c 0a20 2020 2020    ["abc"],.     
-00029dc0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00029dd0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00029de0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-00029df0: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
-00029e00: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
-00029e10: 2020 2020 2020 2020 2066 6f72 2065 2069           for e i
-00029e20: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-00029e30: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
-00029e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029e50: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00029e60: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00029e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029e80: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00029e90: 6522 3a20 2254 6578 7422 2c0a 2020 2020  e": "Text",.    
-00029ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029eb0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00029ec0: 2022 6269 626b 6579 222c 0a20 2020 2020   "bibkey",.     
-00029ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ee0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-00029ef0: 3a20 2261 222c 0a20 2020 2020 2020 2020  : "a",.         
+00029ca0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+00029cb0: 7261 746f 7222 3a20 2265 7861 6374 206d  rator": "exact m
+00029cc0: 6174 6368 222c 0a20 2020 2020 2020 2020  atch",.         
+00029cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ce0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+00029cf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00029d00: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00029d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d20: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+00029d30: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
+00029d40: 0a20 2020 2020 2020 2020 2020 205d 2c0a  .            ],.
+00029d50: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+00029d60: 6322 5d2c 0a20 2020 2020 2020 2029 0a20  c"],.        ). 
+00029d70: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00029d80: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00029d90: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+00029da0: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
+00029db0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+00029dc0: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
+00029dd0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+00029de0: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
+00029df0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00029e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e10: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00029e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e30: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
+00029e40: 6578 7422 2c0a 2020 2020 2020 2020 2020  ext",.          
+00029e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e60: 2020 2266 6965 6c64 223a 2022 6269 626b    "field": "bibk
+00029e70: 6579 222c 0a20 2020 2020 2020 2020 2020  ey",.           
+00029e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e90: 2022 636f 6e74 656e 7422 3a20 2261 222c   "content": "a",
+00029ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029eb0: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+00029ec0: 6572 6174 6f72 223a 2022 636f 6e74 6169  erator": "contai
+00029ed0: 6e73 222c 0a20 2020 2020 2020 2020 2020  ns",.           
+00029ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ef0: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
 00029f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029f10: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-00029f20: 636f 6e74 6169 6e73 222c 0a20 2020 2020  contains",.     
-00029f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029f40: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-00029f50: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-00029f60: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-00029f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029f80: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00029f10: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00029f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f30: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00029f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f50: 2022 7479 7065 223a 2022 5465 7874 222c   "type": "Text",
+00029f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029f70: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
+00029f80: 656c 6422 3a20 2262 6962 6b65 7922 2c0a  eld": "bibkey",.
 00029f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fa0: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
-00029fb0: 5465 7874 222c 0a20 2020 2020 2020 2020  Text",.         
+00029fa0: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+00029fb0: 7465 6e74 223a 2022 6422 2c0a 2020 2020  tent": "d",.    
 00029fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fd0: 2020 2022 6669 656c 6422 3a20 2262 6962     "field": "bib
-00029fe0: 6b65 7922 2c0a 2020 2020 2020 2020 2020  key",.          
+00029fd0: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
+00029fe0: 7222 3a20 2263 6f6e 7461 696e 7322 2c0a  r": "contains",.
 00029ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a000: 2020 2263 6f6e 7465 6e74 223a 2022 6422    "content": "d"
-0002a010: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a020: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-0002a030: 7065 7261 746f 7222 3a20 2263 6f6e 7461  perator": "conta
-0002a040: 696e 7322 2c0a 2020 2020 2020 2020 2020  ins",.          
-0002a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a060: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
-0002a070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a080: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-0002a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a0a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002a0b0: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
-0002a0c0: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-0002a0d0: 2020 2020 2020 2020 2020 205b 5d2c 0a20             [],. 
-0002a0e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002a0f0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0002a100: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
-0002a110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a120: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
-0002a130: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0002a140: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-0002a150: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
-0002a160: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-0002a170: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-0002a180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a190: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+0002a000: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0002a010: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
+0002a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a030: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+0002a040: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+0002a050: 2020 2020 2020 2020 2020 2020 292e 6c61              ).la
+0002a060: 7374 4665 7463 6865 640a 2020 2020 2020  stFetched.      
+0002a070: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+0002a080: 2020 2020 205b 5d2c 0a20 2020 2020 2020       [],.       
+0002a090: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+0002a0a0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0002a0b0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002a0c0: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
+0002a0d0: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
+0002a0e0: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
+0002a0f0: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+0002a100: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
+0002a110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a120: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+0002a130: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+0002a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a150: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+0002a160: 3a20 2254 6578 7422 2c0a 2020 2020 2020  : "Text",.      
+0002a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a180: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
+0002a190: 6269 626b 6579 222c 0a20 2020 2020 2020  bibkey",.       
 0002a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a1b0: 2274 7970 6522 3a20 2254 6578 7422 2c0a  "type": "Text",.
-0002a1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a1d0: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-0002a1e0: 6c64 223a 2022 6269 626b 6579 222c 0a20  ld": "bibkey",. 
-0002a1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a200: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-0002a210: 656e 7422 3a20 2261 222c 0a20 2020 2020  ent": "a",.     
-0002a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a230: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-0002a240: 223a 2022 636f 6e74 6169 6e73 222c 0a20  ": "contains",. 
-0002a250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a260: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
-0002a270: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
-0002a280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a290: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-0002a2a0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-0002a2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2c0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-0002a2d0: 223a 2022 5465 7874 222c 0a20 2020 2020  ": "Text",.     
+0002a1b0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+0002a1c0: 2261 222c 0a20 2020 2020 2020 2020 2020  "a",.           
+0002a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a1e0: 2022 6f70 6572 6174 6f72 223a 2022 636f   "operator": "co
+0002a1f0: 6e74 6169 6e73 222c 0a20 2020 2020 2020  ntains",.       
+0002a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a210: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
+0002a220: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+0002a230: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0002a240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a250: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0002a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a270: 2020 2020 2022 7479 7065 223a 2022 5465       "type": "Te
+0002a280: 7874 222c 0a20 2020 2020 2020 2020 2020  xt",.           
+0002a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a2a0: 2022 6669 656c 6422 3a20 2262 6962 6b65   "field": "bibke
+0002a2b0: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
+0002a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a2d0: 2263 6f6e 7465 6e74 223a 2022 6422 2c0a  "content": "d",.
 0002a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2f0: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-0002a300: 2262 6962 6b65 7922 2c0a 2020 2020 2020  "bibkey",.      
-0002a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a320: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-0002a330: 2022 6422 2c0a 2020 2020 2020 2020 2020   "d",.          
-0002a340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a350: 2020 226f 7065 7261 746f 7222 3a20 2263    "operator": "c
-0002a360: 6f6e 7461 696e 7322 2c0a 2020 2020 2020  ontains",.      
-0002a370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a380: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-0002a390: 2022 6f72 222c 0a20 2020 2020 2020 2020   "or",.         
-0002a3a0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0002a3b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a3c0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0002a3d0: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-0002a3e0: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
-0002a3f0: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
-0002a400: 205b 2264 6566 222c 2022 6162 6322 5d2c   ["def", "abc"],
-0002a410: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0002a420: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0002a430: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-0002a440: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0002a450: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
-0002a460: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002a470: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-0002a480: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
-0002a490: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
-0002a4a0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-0002a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a4c0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0002a2f0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+0002a300: 7261 746f 7222 3a20 2263 6f6e 7461 696e  rator": "contain
+0002a310: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+0002a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a330: 226c 6f67 6963 616c 223a 2022 6f72 222c  "logical": "or",
+0002a340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a350: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+0002a360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a370: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002a380: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
+0002a390: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
+0002a3a0: 2020 2020 2020 2020 2020 205b 2264 6566             ["def
+0002a3b0: 222c 2022 6162 6322 5d2c 0a20 2020 2020  ", "abc"],.     
+0002a3c0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+0002a3d0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0002a3e0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+0002a3f0: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
+0002a400: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
+0002a410: 2020 2020 2020 2020 2066 6f72 2065 2069           for e i
+0002a420: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+0002a430: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
+0002a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a450: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+0002a460: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+0002a470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a480: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+0002a490: 6522 3a20 2254 6578 7422 2c0a 2020 2020  e": "Text",.    
+0002a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a4b0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+0002a4c0: 2022 6269 626b 6579 222c 0a20 2020 2020   "bibkey",.     
 0002a4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a4e0: 2020 2274 7970 6522 3a20 2254 6578 7422    "type": "Text"
-0002a4f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a500: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0002a510: 6965 6c64 223a 2022 6269 626b 6579 222c  ield": "bibkey",
-0002a520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a530: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-0002a540: 6e74 656e 7422 3a20 2261 222c 0a20 2020  ntent": "a",.   
-0002a550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a560: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-0002a570: 6f72 223a 2022 636f 6e74 6169 6e73 222c  or": "contains",
-0002a580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a590: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-0002a5a0: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
-0002a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a5c0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-0002a5d0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0002a5e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a5f0: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-0002a600: 7065 223a 2022 5465 7874 222c 0a20 2020  pe": "Text",.   
-0002a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a620: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-0002a630: 3a20 2262 6962 6b65 7922 2c0a 2020 2020  : "bibkey",.    
-0002a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a650: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
-0002a660: 223a 2022 6422 2c0a 2020 2020 2020 2020  ": "d",.        
-0002a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a680: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-0002a690: 2263 6f6e 7461 696e 7322 2c0a 2020 2020  "contains",.    
-0002a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a6b0: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
-0002a6c0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-0002a6d0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0002a6e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a6f0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-0002a700: 2020 2020 2020 2020 2020 2020 2064 6566               def
-0002a710: 6175 6c74 436f 6e6e 6563 7469 6f6e 3d22  aultConnection="
-0002a720: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
-0002a730: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-0002a740: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-0002a750: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-0002a760: 6465 6622 2c20 2261 6263 225d 2c0a 2020  def", "abc"],.  
-0002a770: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0002a780: 2023 2063 6865 636b 2077 726f 6e67 2062   # check wrong b
-0002a790: 6568 6176 696f 7572 2077 6974 6820 6120  ehaviour with a 
-0002a7a0: 6c69 7374 2069 6e20 2273 7472 220a 2020  list in "str".  
-0002a7b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0002a7c0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0002a7d0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002a7e0: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
-0002a7f0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002a800: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
-0002a810: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
-0002a820: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
-0002a830: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
-0002a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a850: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0002a4e0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+0002a4f0: 3a20 2261 222c 0a20 2020 2020 2020 2020  : "a",.         
+0002a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a510: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+0002a520: 636f 6e74 6169 6e73 222c 0a20 2020 2020  contains",.     
+0002a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a540: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+0002a550: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+0002a560: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+0002a570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a580: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+0002a590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a5a0: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
+0002a5b0: 5465 7874 222c 0a20 2020 2020 2020 2020  Text",.         
+0002a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a5d0: 2020 2022 6669 656c 6422 3a20 2262 6962     "field": "bib
+0002a5e0: 6b65 7922 2c0a 2020 2020 2020 2020 2020  key",.          
+0002a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a600: 2020 2263 6f6e 7465 6e74 223a 2022 6422    "content": "d"
+0002a610: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002a620: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002a630: 7065 7261 746f 7222 3a20 2263 6f6e 7461  perator": "conta
+0002a640: 696e 7322 2c0a 2020 2020 2020 2020 2020  ins",.          
+0002a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a660: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
+0002a670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a680: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+0002a690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a6a0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002a6b0: 2020 2020 2020 2064 6566 6175 6c74 436f         defaultCo
+0002a6c0: 6e6e 6563 7469 6f6e 3d22 6f72 222c 0a20  nnection="or",. 
+0002a6d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002a6e0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+0002a6f0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+0002a700: 2020 2020 2020 2020 5b22 6465 6622 2c20          ["def", 
+0002a710: 2261 6263 225d 2c0a 2020 2020 2020 2020  "abc"],.        
+0002a720: 290a 0a20 2020 2020 2020 2023 2063 6865  )..        # che
+0002a730: 636b 2077 726f 6e67 2062 6568 6176 696f  ck wrong behavio
+0002a740: 7572 2077 6974 6820 6120 6c69 7374 2069  ur with a list i
+0002a750: 6e20 2273 7472 220a 2020 2020 2020 2020  n "str".        
+0002a760: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0002a770: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
+0002a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a790: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
+0002a7a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002a7b0: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+0002a7c0: 6962 732e 6665 7463 6846 726f 6d44 6963  ibs.fetchFromDic
+0002a7d0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0002a7e0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0002a7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a800: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0002a810: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002a820: 7479 7065 223a 2022 5465 7874 222c 0a20  type": "Text",. 
+0002a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a840: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
+0002a850: 6422 3a20 2262 6962 6b65 7922 2c0a 2020  d": "bibkey",.  
 0002a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a870: 2020 2020 2022 7479 7065 223a 2022 5465       "type": "Te
-0002a880: 7874 222c 0a20 2020 2020 2020 2020 2020  xt",.           
-0002a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8a0: 2022 6669 656c 6422 3a20 2262 6962 6b65   "field": "bibke
-0002a8b0: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
-0002a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8d0: 2263 6f6e 7465 6e74 223a 205b 2261 222c  "content": ["a",
-0002a8e0: 2022 6222 5d2c 0a20 2020 2020 2020 2020   "b"],.         
+0002a870: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+0002a880: 6e74 223a 205b 2261 222c 2022 6222 5d2c  nt": ["a", "b"],
+0002a890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a8a0: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+0002a8b0: 6572 6174 6f72 223a 2022 636f 6e74 6169  erator": "contai
+0002a8c0: 6e73 222c 0a20 2020 2020 2020 2020 2020  ns",.           
+0002a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a8e0: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
 0002a8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a900: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-0002a910: 636f 6e74 6169 6e73 222c 0a20 2020 2020  contains",.     
+0002a900: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0002a910: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
 0002a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a930: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-0002a940: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-0002a950: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-0002a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a970: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-0002a980: 2020 2020 2020 292e 6c61 7374 4665 7463        ).lastFetc
-0002a990: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
-0002a9a0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
-0002a9b0: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-0002a9c0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0002a9d0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0002a9e0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-0002a9f0: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-0002aa00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002aa10: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-0002aa20: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
-0002aa30: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
-0002aa40: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0002aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa60: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+0002a930: 292e 6c61 7374 4665 7463 6865 640a 2020  ).lastFetched.  
+0002a940: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+0002a950: 2020 2020 2020 2020 205b 5d2c 0a20 2020           [],.   
+0002a960: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0002a970: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0002a980: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
+0002a990: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002a9a0: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+0002a9b0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0002a9c0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+0002a9d0: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
+0002a9e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002a9f0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+0002aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa10: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0002aa20: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0002aa30: 7970 6522 3a20 2254 6578 7422 2c0a 2020  ype": "Text",.  
+0002aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa50: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+0002aa60: 223a 2022 6269 626b 6579 222c 0a20 2020  ": "bibkey",.   
 0002aa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa80: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
-0002aa90: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+0002aa80: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
+0002aa90: 7422 3a20 5b22 6122 2c20 2262 225d 2c0a  t": ["a", "b"],.
 0002aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aab0: 2266 6965 6c64 223a 2022 6269 626b 6579  "field": "bibkey
-0002aac0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002aad0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002aae0: 636f 6e74 656e 7422 3a20 5b22 6122 2c20  content": ["a", 
-0002aaf0: 2262 225d 2c0a 2020 2020 2020 2020 2020  "b"],.          
-0002ab00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab10: 2020 226f 7065 7261 746f 7222 3a20 2265    "operator": "e
-0002ab20: 7861 6374 206d 6174 6368 222c 0a20 2020  xact match",.   
-0002ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab40: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-0002ab50: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-0002ab60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab70: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0002ab80: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0002ab90: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-0002aba0: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
-0002abb0: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
-0002abc0: 205b 5d2c 0a20 2020 2020 2020 2029 0a20   [],.        ). 
-0002abd0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0002abe0: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
-0002abf0: 722e 6578 6365 7074 696f 6e22 2920 6173  r.exception") as
-0002ac00: 205f 653a 0a20 2020 2020 2020 2020 2020   _e:.           
-0002ac10: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0002ac20: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
-0002ac30: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002ac40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ac50: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-0002ac60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002ac70: 7479 7065 223a 2022 5465 7874 222c 0a20  type": "Text",. 
-0002ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ac90: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-0002aca0: 2262 6962 6b65 7922 2c0a 2020 2020 2020  "bibkey",.      
-0002acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002acc0: 2020 2263 6f6e 7465 6e74 223a 205b 2261    "content": ["a
-0002acd0: 222c 2022 6222 5d2c 0a20 2020 2020 2020  ", "b"],.       
+0002aab0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+0002aac0: 7261 746f 7222 3a20 2265 7861 6374 206d  rator": "exact m
+0002aad0: 6174 6368 222c 0a20 2020 2020 2020 2020  atch",.         
+0002aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aaf0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+0002ab00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002ab10: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0002ab20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab30: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002ab40: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
+0002ab50: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
+0002ab60: 2020 2020 2020 2020 2020 205b 5d2c 0a20             [],. 
+0002ab70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0002ab80: 2077 6974 6820 7061 7463 6828 226c 6f67   with patch("log
+0002ab90: 6769 6e67 2e4c 6f67 6765 722e 6578 6365  ging.Logger.exce
+0002aba0: 7074 696f 6e22 2920 6173 205f 653a 0a20  ption") as _e:. 
+0002abb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002abc0: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
+0002abd0: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
+0002abe0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002abf0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0002ac00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ac10: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+0002ac20: 2022 5465 7874 222c 0a20 2020 2020 2020   "Text",.       
+0002ac30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ac40: 2022 6669 656c 6422 3a20 2262 6962 6b65   "field": "bibke
+0002ac50: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
+0002ac60: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+0002ac70: 7465 6e74 223a 205b 2261 222c 2022 6222  tent": ["a", "b"
+0002ac80: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002ac90: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
+0002aca0: 6174 6f72 223a 2022 6578 6163 7420 6d61  ator": "exact ma
+0002acb0: 7463 6822 2c0a 2020 2020 2020 2020 2020  tch",.          
+0002acc0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+0002acd0: 6f67 6963 616c 223a 2022 222c 0a20 2020  ogical": "",.   
 0002ace0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002acf0: 2022 6f70 6572 6174 6f72 223a 2022 6578   "operator": "ex
-0002ad00: 6163 7420 6d61 7463 6822 2c0a 2020 2020  act match",.    
-0002ad10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad20: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
-0002ad30: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002ad40: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0002ad50: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-0002ad60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002ad70: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0002ad80: 496e 2822 5175 6572 7920 6661 696c 6564  In("Query failed
-0002ad90: 3a22 2c20 5f65 2e63 616c 6c5f 6172 6773  :", _e.call_args
-0002ada0: 5b30 5d5b 305d 290a 0a20 2020 2020 2020  [0][0])..       
-0002adb0: 2064 6174 6120 3d20 7365 6c66 2e70 4244   data = self.pBD
-0002adc0: 422e 6269 6273 2e70 7265 7061 7265 496e  B.bibs.prepareIn
-0002add0: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
-0002ade0: 2020 2740 6172 7469 636c 657b 6a6b 6c2c    '@article{jkl,
-0002adf0: 5c6e 6175 7468 6f72 203d 2022 6d65 222c  \nauthor = "me",
-0002ae00: 5c6e 7469 746c 6520 3d20 226a 6b6c 222c  \ntitle = "jkl",
-0002ae10: 7d27 0a20 2020 2020 2020 2029 0a20 2020  }'.        ).   
-0002ae20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0002ae30: 5472 7565 2873 656c 662e 7042 4442 2e62  True(self.pBDB.b
-0002ae40: 6962 732e 696e 7365 7274 2864 6174 6129  ibs.insert(data)
-0002ae50: 290a 2020 2020 2020 2020 6461 7461 203d  ).        data =
-0002ae60: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0002ae70: 7072 6570 6172 6549 6e73 6572 7428 0a20  prepareInsert(. 
-0002ae80: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-0002ae90: 6963 6c65 7b6d 6e6f 2c5c 6e61 7574 686f  icle{mno,\nautho
-0002aea0: 7220 3d20 226d 6522 2c5c 6e74 6974 6c65  r = "me",\ntitle
-0002aeb0: 203d 2022 6d6e 6f22 2c7d 272c 2061 7278   = "mno",}', arx
-0002aec0: 6976 3d22 6d6e 6f31 220a 2020 2020 2020  iv="mno1".      
-0002aed0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0002aee0: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
-0002aef0: 2e70 4244 422e 6269 6273 2e69 6e73 6572  .pBDB.bibs.inser
-0002af00: 7428 6461 7461 2929 0a20 2020 2020 2020  t(data)).       
-0002af10: 2064 6174 6120 3d20 7365 6c66 2e70 4244   data = self.pBD
-0002af20: 422e 6269 6273 2e70 7265 7061 7265 496e  B.bibs.prepareIn
-0002af30: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
-0002af40: 2020 2740 6172 7469 636c 657b 7071 722c    '@article{pqr,
-0002af50: 5c6e 6175 7468 6f72 203d 2022 6d65 222c  \nauthor = "me",
-0002af60: 5c6e 7469 746c 6520 3d20 2270 7172 222c  \ntitle = "pqr",
-0002af70: 7d27 2c20 6172 7869 763d 2270 712e 7222  }', arxiv="pq.r"
-0002af80: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0002af90: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-0002afa0: 7565 2873 656c 662e 7042 4442 2e62 6962  ue(self.pBDB.bib
-0002afb0: 732e 696e 7365 7274 2864 6174 6129 290a  s.insert(data)).
-0002afc0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0002afd0: 6572 7454 7275 6528 0a20 2020 2020 2020  ertTrue(.       
-0002afe0: 2020 2020 2073 656c 662e 7042 4442 2e65       self.pBDB.e
-0002aff0: 7870 732e 696e 7365 7274 280a 2020 2020  xps.insert(.    
-0002b000: 2020 2020 2020 2020 2020 2020 7b22 6e61              {"na
-0002b010: 6d65 223a 2022 6578 7032 222c 2022 636f  me": "exp2", "co
-0002b020: 6d6d 656e 7473 223a 2022 222c 2022 686f  mments": "", "ho
-0002b030: 6d65 7061 6765 223a 2022 222c 2022 696e  mepage": "", "in
-0002b040: 7370 6972 6522 3a20 2222 7d0a 2020 2020  spire": ""}.    
-0002b050: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002b060: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0002b070: 2e61 7373 6572 7454 7275 6528 0a20 2020  .assertTrue(.   
-0002b080: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0002b090: 4442 2e63 6174 732e 696e 7365 7274 280a  DB.cats.insert(.
-0002b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b0b0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0002b0c0: 2020 2020 2020 226e 616d 6522 3a20 2263        "name": "c
-0002b0d0: 6174 3222 2c0a 2020 2020 2020 2020 2020  at2",.          
-0002b0e0: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
-0002b0f0: 6e74 7322 3a20 2222 2c0a 2020 2020 2020  nts": "",.      
-0002b100: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-0002b110: 6573 6372 6970 7469 6f6e 223a 2022 222c  escription": "",
-0002b120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b130: 2020 2020 2022 7061 7265 6e74 4361 7422       "parentCat"
-0002b140: 3a20 2230 222c 0a20 2020 2020 2020 2020  : "0",.         
-0002b150: 2020 2020 2020 2020 2020 2022 6f72 6422             "ord"
-0002b160: 3a20 2230 222c 0a20 2020 2020 2020 2020  : "0",.         
-0002b170: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0002b180: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-0002b190: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-0002b1a0: 4442 2e62 6962 4578 702e 696e 7365 7274  DB.bibExp.insert
-0002b1b0: 285b 2264 6566 222c 2022 6a6b 6c22 5d2c  (["def", "jkl"],
-0002b1c0: 2031 290a 2020 2020 2020 2020 7365 6c66   1).        self
-0002b1d0: 2e70 4244 422e 6361 7442 6962 2e69 6e73  .pBDB.catBib.ins
-0002b1e0: 6572 7428 322c 205b 226d 6e6f 222c 2022  ert(2, ["mno", "
-0002b1f0: 6162 6322 5d29 0a20 2020 2020 2020 2073  abc"]).        s
-0002b200: 656c 662e 7042 4442 2e63 6174 4269 622e  elf.pBDB.catBib.
-0002b210: 696e 7365 7274 2831 2c20 5b22 6d6e 6f22  insert(1, ["mno"
-0002b220: 2c20 2270 7172 225d 290a 0a20 2020 2020  , "pqr"])..     
-0002b230: 2020 2023 2074 6573 7420 6d6f 7265 2063     # test more c
-0002b240: 6f6d 6269 6e61 7469 6f6e 7320 6f66 2063  ombinations of c
-0002b250: 6174 730a 2020 2020 2020 2020 7365 6c66  ats.        self
-0002b260: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0002b270: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-0002b280: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
-0002b290: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
-0002b2a0: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
-0002b2b0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0002b2c0: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
-0002b2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b2e0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-0002b2f0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-0002b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b310: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-0002b320: 223a 2022 4361 7465 676f 7269 6573 222c  ": "Categories",
-0002b330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b340: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-0002b350: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
-0002b360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b370: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-0002b380: 7222 3a20 2261 6c6c 206f 6620 7468 6520  r": "all of the 
-0002b390: 666f 6c6c 6f77 696e 6722 2c0a 2020 2020  following",.    
+0002acf0: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+0002ad00: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+0002ad10: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
+0002ad20: 656c 662e 6173 7365 7274 496e 2822 5175  elf.assertIn("Qu
+0002ad30: 6572 7920 6661 696c 6564 3a22 2c20 5f65  ery failed:", _e
+0002ad40: 2e63 616c 6c5f 6172 6773 5b30 5d5b 305d  .call_args[0][0]
+0002ad50: 290a 0a20 2020 2020 2020 2064 6174 6120  )..        data 
+0002ad60: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
+0002ad70: 2e70 7265 7061 7265 496e 7365 7274 280a  .prepareInsert(.
+0002ad80: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
+0002ad90: 7469 636c 657b 6a6b 6c2c 5c6e 6175 7468  ticle{jkl,\nauth
+0002ada0: 6f72 203d 2022 6d65 222c 5c6e 7469 746c  or = "me",\ntitl
+0002adb0: 6520 3d20 226a 6b6c 222c 7d27 0a20 2020  e = "jkl",}'.   
+0002adc0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0002add0: 656c 662e 6173 7365 7274 5472 7565 2873  elf.assertTrue(s
+0002ade0: 656c 662e 7042 4442 2e62 6962 732e 696e  elf.pBDB.bibs.in
+0002adf0: 7365 7274 2864 6174 6129 290a 2020 2020  sert(data)).    
+0002ae00: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
+0002ae10: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
+0002ae20: 6549 6e73 6572 7428 0a20 2020 2020 2020  eInsert(.       
+0002ae30: 2020 2020 2027 4061 7274 6963 6c65 7b6d       '@article{m
+0002ae40: 6e6f 2c5c 6e61 7574 686f 7220 3d20 226d  no,\nauthor = "m
+0002ae50: 6522 2c5c 6e74 6974 6c65 203d 2022 6d6e  e",\ntitle = "mn
+0002ae60: 6f22 2c7d 272c 2061 7278 6976 3d22 6d6e  o",}', arxiv="mn
+0002ae70: 6f31 220a 2020 2020 2020 2020 290a 2020  o1".        ).  
+0002ae80: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0002ae90: 7454 7275 6528 7365 6c66 2e70 4244 422e  tTrue(self.pBDB.
+0002aea0: 6269 6273 2e69 6e73 6572 7428 6461 7461  bibs.insert(data
+0002aeb0: 2929 0a20 2020 2020 2020 2064 6174 6120  )).        data 
+0002aec0: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
+0002aed0: 2e70 7265 7061 7265 496e 7365 7274 280a  .prepareInsert(.
+0002aee0: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
+0002aef0: 7469 636c 657b 7071 722c 5c6e 6175 7468  ticle{pqr,\nauth
+0002af00: 6f72 203d 2022 6d65 222c 5c6e 7469 746c  or = "me",\ntitl
+0002af10: 6520 3d20 2270 7172 222c 7d27 2c20 6172  e = "pqr",}', ar
+0002af20: 7869 763d 2270 712e 7222 0a20 2020 2020  xiv="pq.r".     
+0002af30: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+0002af40: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
+0002af50: 662e 7042 4442 2e62 6962 732e 696e 7365  f.pBDB.bibs.inse
+0002af60: 7274 2864 6174 6129 290a 2020 2020 2020  rt(data)).      
+0002af70: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+0002af80: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
+0002af90: 656c 662e 7042 4442 2e65 7870 732e 696e  elf.pBDB.exps.in
+0002afa0: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
+0002afb0: 2020 2020 2020 7b22 6e61 6d65 223a 2022        {"name": "
+0002afc0: 6578 7032 222c 2022 636f 6d6d 656e 7473  exp2", "comments
+0002afd0: 223a 2022 222c 2022 686f 6d65 7061 6765  ": "", "homepage
+0002afe0: 223a 2022 222c 2022 696e 7370 6972 6522  ": "", "inspire"
+0002aff0: 3a20 2222 7d0a 2020 2020 2020 2020 2020  : ""}.          
+0002b000: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
+0002b010: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0002b020: 7454 7275 6528 0a20 2020 2020 2020 2020  tTrue(.         
+0002b030: 2020 2073 656c 662e 7042 4442 2e63 6174     self.pBDB.cat
+0002b040: 732e 696e 7365 7274 280a 2020 2020 2020  s.insert(.      
+0002b050: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+0002b060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b070: 226e 616d 6522 3a20 2263 6174 3222 2c0a  "name": "cat2",.
+0002b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b090: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
+0002b0a0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+0002b0b0: 2020 2020 2020 2020 2264 6573 6372 6970          "descrip
+0002b0c0: 7469 6f6e 223a 2022 222c 0a20 2020 2020  tion": "",.     
+0002b0d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002b0e0: 7061 7265 6e74 4361 7422 3a20 2230 222c  parentCat": "0",
+0002b0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b100: 2020 2020 2022 6f72 6422 3a20 2230 222c       "ord": "0",
+0002b110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b120: 207d 0a20 2020 2020 2020 2020 2020 2029   }.            )
+0002b130: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0002b140: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0002b150: 4578 702e 696e 7365 7274 285b 2264 6566  Exp.insert(["def
+0002b160: 222c 2022 6a6b 6c22 5d2c 2031 290a 2020  ", "jkl"], 1).  
+0002b170: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0002b180: 6361 7442 6962 2e69 6e73 6572 7428 322c  catBib.insert(2,
+0002b190: 205b 226d 6e6f 222c 2022 6162 6322 5d29   ["mno", "abc"])
+0002b1a0: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+0002b1b0: 4442 2e63 6174 4269 622e 696e 7365 7274  DB.catBib.insert
+0002b1c0: 2831 2c20 5b22 6d6e 6f22 2c20 2270 7172  (1, ["mno", "pqr
+0002b1d0: 225d 290a 0a20 2020 2020 2020 2023 2074  "])..        # t
+0002b1e0: 6573 7420 6d6f 7265 2063 6f6d 6269 6e61  est more combina
+0002b1f0: 7469 6f6e 7320 6f66 2063 6174 730a 2020  tions of cats.  
+0002b200: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0002b210: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0002b220: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+0002b230: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
+0002b240: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002b250: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
+0002b260: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
+0002b270: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
+0002b280: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+0002b290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b2a0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0002b2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b2c0: 2020 2020 2022 7479 7065 223a 2022 4361       "type": "Ca
+0002b2d0: 7465 676f 7269 6573 222c 0a20 2020 2020  tegories",.     
+0002b2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b2f0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+0002b300: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+0002b310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b320: 2020 226f 7065 7261 746f 7222 3a20 2261    "operator": "a
+0002b330: 6c6c 206f 6620 7468 6520 666f 6c6c 6f77  ll of the follow
+0002b340: 696e 6722 2c0a 2020 2020 2020 2020 2020  ing",.          
+0002b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b360: 2020 2263 6f6e 7465 6e74 223a 2032 2c0a    "content": 2,.
+0002b370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b380: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
+0002b390: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
 0002b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b3b0: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
-0002b3c0: 223a 2032 2c0a 2020 2020 2020 2020 2020  ": 2,.          
-0002b3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b3e0: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
-0002b3f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b400: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-0002b410: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0002b420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b430: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
-0002b440: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-0002b450: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
-0002b460: 2c20 226d 6e6f 225d 2c0a 2020 2020 2020  , "mno"],.      
-0002b470: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-0002b480: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
-0002b490: 4c6f 6767 6572 2e77 6172 6e69 6e67 2229  Logger.warning")
-0002b4a0: 2061 7320 5f77 3a0a 2020 2020 2020 2020   as _w:.        
-0002b4b0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-0002b4c0: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
-0002b4d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002b4e0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-0002b4f0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0002b3b0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+0002b3c0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+0002b3d0: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
+0002b3e0: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
+0002b3f0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+0002b400: 2020 2020 5b22 6162 6322 2c20 226d 6e6f      ["abc", "mno
+0002b410: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
+0002b420: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+0002b430: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
+0002b440: 2e77 6172 6e69 6e67 2229 2061 7320 5f77  .warning") as _w
+0002b450: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0002b460: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
+0002b470: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
+0002b480: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+0002b490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b4a0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+0002b4b0: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+0002b4c0: 6522 3a20 2243 6174 6567 6f72 6965 7322  e": "Categories"
+0002b4d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002b4e0: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+0002b4f0: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
 0002b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b510: 2020 2274 7970 6522 3a20 2243 6174 6567    "type": "Categ
-0002b520: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
-0002b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b540: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
-0002b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b560: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-0002b570: 223a 2022 616c 6c20 6f66 2074 6865 2066  ": "all of the f
-0002b580: 6f6c 6c6f 7769 6e67 222c 0a20 2020 2020  ollowing",.     
-0002b590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b5a0: 2020 2022 636f 6e74 656e 7422 3a20 5b31     "content": [1
-0002b5b0: 2c20 325d 2c0a 2020 2020 2020 2020 2020  , 2],.          
-0002b5c0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0002b5d0: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
-0002b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b5f0: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
-0002b600: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0002b610: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0002b620: 772e 6173 7365 7274 5f63 616c 6c65 645f  w.assert_called_
-0002b630: 6f6e 6365 5f77 6974 6828 2249 6e76 616c  once_with("Inval
-0002b640: 6964 206f 7065 7261 746f 723a 2027 616c  id operator: 'al
-0002b650: 6c20 6f66 2074 6865 2066 6f6c 6c6f 7769  l of the followi
-0002b660: 6e67 2722 290a 2020 2020 2020 2020 7365  ng'").        se
-0002b670: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0002b680: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0002b690: 2020 2020 2020 2020 2020 2020 2020 655b                e[
-0002b6a0: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
-0002b6b0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-0002b6c0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-0002b6d0: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-0002b6e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b6f0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0002b700: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0002b710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b720: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-0002b730: 7065 223a 2022 4361 7465 676f 7269 6573  pe": "Categories
-0002b740: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002b750: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002b760: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
-0002b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b780: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
-0002b790: 746f 7222 3a20 2261 6c6c 2074 6865 2066  tor": "all the f
-0002b7a0: 6f6c 6c6f 7769 6e67 222c 0a20 2020 2020  ollowing",.     
+0002b510: 2022 6f70 6572 6174 6f72 223a 2022 616c   "operator": "al
+0002b520: 6c20 6f66 2074 6865 2066 6f6c 6c6f 7769  l of the followi
+0002b530: 6e67 222c 0a20 2020 2020 2020 2020 2020  ng",.           
+0002b540: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+0002b550: 6e74 656e 7422 3a20 5b31 2c20 325d 2c0a  ntent": [1, 2],.
+0002b560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b570: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+0002b580: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0002b590: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0002b5a0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002b5b0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002b5c0: 2020 2020 2020 2020 205f 772e 6173 7365           _w.asse
+0002b5d0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+0002b5e0: 6974 6828 2249 6e76 616c 6964 206f 7065  ith("Invalid ope
+0002b5f0: 7261 746f 723a 2027 616c 6c20 6f66 2074  rator: 'all of t
+0002b600: 6865 2066 6f6c 6c6f 7769 6e67 2722 290a  he following'").
+0002b610: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0002b620: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0002b630: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+0002b640: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
+0002b650: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+0002b660: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+0002b670: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+0002b680: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+0002b690: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0002b6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b6b0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+0002b6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b6d0: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
+0002b6e0: 4361 7465 676f 7269 6573 222c 0a20 2020  Categories",.   
+0002b6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b700: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
+0002b710: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
+0002b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b730: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
+0002b740: 2261 6c6c 2074 6865 2066 6f6c 6c6f 7769  "all the followi
+0002b750: 6e67 222c 0a20 2020 2020 2020 2020 2020  ng",.           
+0002b760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b770: 2022 636f 6e74 656e 7422 3a20 5b31 2c20   "content": [1, 
+0002b780: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
+0002b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b7a0: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
 0002b7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b7c0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-0002b7d0: 3a20 5b31 2c20 325d 2c0a 2020 2020 2020  : [1, 2],.      
-0002b7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b7f0: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
-0002b800: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0002b810: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-0002b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b830: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0002b840: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-0002b850: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-0002b860: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-0002b870: 6d6e 6f22 5d2c 0a20 2020 2020 2020 2029  mno"],.        )
-0002b880: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0002b890: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0002b8a0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0002b8b0: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
-0002b8c0: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
-0002b8d0: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-0002b8e0: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-0002b8f0: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-0002b900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b910: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0002b920: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0002b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b940: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-0002b950: 2243 6174 6567 6f72 6965 7322 2c0a 2020  "Categories",.  
-0002b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b970: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-0002b980: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
-0002b990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b9a0: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-0002b9b0: 2022 6174 206c 6561 7374 206f 6e65 2061   "at least one a
-0002b9c0: 6d6f 6e67 222c 0a20 2020 2020 2020 2020  mong",.         
+0002b7c0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0002b7d0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002b7e0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002b7f0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+0002b800: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+0002b810: 2020 2020 2020 2020 5b22 6d6e 6f22 5d2c          ["mno"],
+0002b820: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0002b830: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0002b840: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0002b850: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0002b860: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
+0002b870: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002b880: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+0002b890: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+0002b8a0: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+0002b8b0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+0002b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b8d0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0002b8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b8f0: 2020 2274 7970 6522 3a20 2243 6174 6567    "type": "Categ
+0002b900: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
+0002b910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b920: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+0002b930: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002b940: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002b950: 6f70 6572 6174 6f72 223a 2022 6174 206c  operator": "at l
+0002b960: 6561 7374 206f 6e65 2061 6d6f 6e67 222c  east one among",
+0002b970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b980: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+0002b990: 6e74 656e 7422 3a20 5b30 2c20 325d 2c0a  ntent": [0, 2],.
+0002b9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b9b0: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
+0002b9c0: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
 0002b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b9e0: 2020 2022 636f 6e74 656e 7422 3a20 5b30     "content": [0
-0002b9f0: 2c20 325d 2c0a 2020 2020 2020 2020 2020  , 2],.          
-0002ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ba10: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
-0002ba20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ba30: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-0002ba40: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0002ba50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ba60: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
-0002ba70: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-0002ba80: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
-0002ba90: 2c20 226d 6e6f 225d 2c0a 2020 2020 2020  , "mno"],.      
-0002baa0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0002bab0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0002bac0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-0002bad0: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
-0002bae0: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
-0002baf0: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
-0002bb00: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0002bb10: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
-0002bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb30: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-0002bb40: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-0002bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb60: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-0002bb70: 223a 2022 4361 7465 676f 7269 6573 222c  ": "Categories",
-0002bb80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002bb90: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-0002bba0: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
-0002bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bbc0: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-0002bbd0: 7222 3a20 2261 7420 6c65 6173 7420 6f6e  r": "at least on
-0002bbe0: 6520 616d 6f6e 6722 2c0a 2020 2020 2020  e among",.      
+0002b9e0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+0002b9f0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+0002ba00: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
+0002ba10: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
+0002ba20: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+0002ba30: 2020 2020 5b22 6162 6322 2c20 226d 6e6f      ["abc", "mno
+0002ba40: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
+0002ba50: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0002ba60: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0002ba70: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+0002ba80: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
+0002ba90: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002baa0: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
+0002bab0: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
+0002bac0: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
+0002bad0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+0002bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002baf0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0002bb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb10: 2020 2020 2022 7479 7065 223a 2022 4361       "type": "Ca
+0002bb20: 7465 676f 7269 6573 222c 0a20 2020 2020  tegories",.     
+0002bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb40: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+0002bb50: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+0002bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bb70: 2020 226f 7065 7261 746f 7222 3a20 2261    "operator": "a
+0002bb80: 7420 6c65 6173 7420 6f6e 6520 616d 6f6e  t least one amon
+0002bb90: 6722 2c0a 2020 2020 2020 2020 2020 2020  g",.            
+0002bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bbb0: 2263 6f6e 7465 6e74 223a 205b 305d 2c0a  "content": [0],.
+0002bbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bbd0: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
+0002bbe0: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
 0002bbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc00: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-0002bc10: 205b 305d 2c0a 2020 2020 2020 2020 2020   [0],.          
+0002bc00: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+0002bc10: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
 0002bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc30: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
-0002bc40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002bc50: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-0002bc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc70: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-0002bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bc90: 2020 2274 7970 6522 3a20 2243 6174 6567    "type": "Categ
-0002bca0: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
-0002bcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bcc0: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-0002bcd0: 2261 7420 6c65 6173 7420 6f6e 6520 616d  "at least one am
-0002bce0: 6f6e 6722 2c0a 2020 2020 2020 2020 2020  ong",.          
+0002bc30: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+0002bc40: 6522 3a20 2243 6174 6567 6f72 6965 7322  e": "Categories"
+0002bc50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002bc60: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002bc70: 7065 7261 746f 7222 3a20 2261 7420 6c65  perator": "at le
+0002bc80: 6173 7420 6f6e 6520 616d 6f6e 6722 2c0a  ast one among",.
+0002bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bca0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0002bcb0: 6963 616c 223a 2022 6f72 222c 0a20 2020  ical": "or",.   
+0002bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bcd0: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
+0002bce0: 7422 3a20 5b32 5d2c 0a20 2020 2020 2020  t": [2],.       
 0002bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd00: 2020 226c 6f67 6963 616c 223a 2022 6f72    "logical": "or
-0002bd10: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002bd20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002bd30: 636f 6e74 656e 7422 3a20 5b32 5d2c 0a20  content": [2],. 
-0002bd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd50: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
-0002bd60: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
-0002bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd80: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-0002bd90: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-0002bda0: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
-0002bdb0: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-0002bdc0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0002bdd0: 2020 2020 5b22 6162 6322 2c20 226d 6e6f      ["abc", "mno
-0002bde0: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
-0002bdf0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0002be00: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0002be10: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002be20: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
-0002be30: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002be40: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
-0002be50: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
-0002be60: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
-0002be70: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+0002bd00: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
+0002bd10: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0002bd20: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0002bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bd40: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+0002bd50: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+0002bd60: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
+0002bd70: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+0002bd80: 6162 6322 2c20 226d 6e6f 225d 2c0a 2020  abc", "mno"],.  
+0002bd90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0002bda0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0002bdb0: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
+0002bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bdd0: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
+0002bde0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002bdf0: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+0002be00: 6962 732e 6665 7463 6846 726f 6d44 6963  ibs.fetchFromDic
+0002be10: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0002be20: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0002be30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002be40: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0002be50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002be60: 7479 7065 223a 2022 4361 7465 676f 7269  type": "Categori
+0002be70: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
 0002be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be90: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0002be90: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
 0002bea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002beb0: 2020 2020 2022 7479 7065 223a 2022 4361       "type": "Ca
-0002bec0: 7465 676f 7269 6573 222c 0a20 2020 2020  tegories",.     
-0002bed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bee0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-0002bef0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-0002bf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf10: 2020 226f 7065 7261 746f 7222 3a20 2261    "operator": "a
-0002bf20: 7420 6c65 6173 7420 6f6e 6520 616d 6f6e  t least one amon
-0002bf30: 6722 2c0a 2020 2020 2020 2020 2020 2020  g",.            
-0002bf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf50: 2263 6f6e 7465 6e74 223a 205b 305d 2c0a  "content": [0],.
-0002bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf70: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-0002bf80: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
-0002bf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bfa0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-0002bfb0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-0002bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bfd0: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-0002bfe0: 6522 3a20 2243 6174 6567 6f72 6965 7322  e": "Categories"
-0002bff0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002c000: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-0002c010: 7065 7261 746f 7222 3a20 2261 7420 6c65  perator": "at le
-0002c020: 6173 7420 6f6e 6520 616d 6f6e 6722 2c0a  ast one among",.
-0002c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c040: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-0002c050: 6963 616c 223a 2022 6f72 222c 0a20 2020  ical": "or",.   
+0002beb0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+0002bec0: 7261 746f 7222 3a20 2261 7420 6c65 6173  rator": "at leas
+0002bed0: 7420 6f6e 6520 616d 6f6e 6722 2c0a 2020  t one among",.  
+0002bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bef0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+0002bf00: 6e74 223a 205b 305d 2c0a 2020 2020 2020  nt": [0],.      
+0002bf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bf20: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
+0002bf30: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0002bf40: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+0002bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bf60: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0002bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bf80: 2020 2020 2020 2274 7970 6522 3a20 2243        "type": "C
+0002bf90: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
+0002bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bfb0: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
+0002bfc0: 7222 3a20 2261 7420 6c65 6173 7420 6f6e  r": "at least on
+0002bfd0: 6520 616d 6f6e 6722 2c0a 2020 2020 2020  e among",.      
+0002bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bff0: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+0002c000: 2022 6f72 222c 0a20 2020 2020 2020 2020   "or",.         
+0002c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c020: 2020 2022 636f 6e74 656e 7422 3a20 5b33     "content": [3
+0002c030: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002c040: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002c050: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
 0002c060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c070: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
-0002c080: 7422 3a20 5b33 5d2c 0a20 2020 2020 2020  t": [3],.       
-0002c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c0a0: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
-0002c0b0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0002c0c0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-0002c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c0e0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0002c0f0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-0002c100: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-0002c110: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-0002c120: 6162 6322 5d2c 0a20 2020 2020 2020 2029  abc"],.        )
-0002c130: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-0002c140: 7463 6828 226c 6f67 6769 6e67 2e4c 6f67  tch("logging.Log
-0002c150: 6765 722e 7761 726e 696e 6722 2920 6173  ger.warning") as
-0002c160: 205f 773a 0a20 2020 2020 2020 2020 2020   _w:.           
-0002c170: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0002c180: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
-0002c190: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002c1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c1b0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-0002c1c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002c1d0: 7479 7065 223a 2022 4361 7465 676f 7269  type": "Categori
-0002c1e0: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
-0002c1f0: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-0002c200: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
-0002c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c220: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-0002c230: 2261 7420 6c65 6173 7420 6f6e 6520 616d  "at least one am
-0002c240: 6f6e 6722 2c0a 2020 2020 2020 2020 2020  ong",.          
-0002c250: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-0002c260: 6f6e 7465 6e74 223a 205b 5d2c 0a20 2020  ontent": [],.   
-0002c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c280: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
-0002c290: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0002c2a0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-0002c2b0: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-0002c2c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002c2d0: 2020 2020 2020 5f77 2e61 7373 6572 745f        _w.assert_
-0002c2e0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-0002c2f0: 2822 496e 7661 6c69 6420 6c69 7374 206f  ("Invalid list o
-0002c300: 6620 6964 733a 2027 5b5d 2722 290a 2020  f ids: '[]'").  
-0002c310: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0002c320: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0002c330: 2020 2020 736f 7274 6564 280a 2020 2020      sorted(.    
-0002c340: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0002c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c360: 2020 655b 2262 6962 6b65 7922 5d0a 2020    e["bibkey"].  
+0002c070: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0002c080: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002c090: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002c0a0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+0002c0b0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+0002c0c0: 2020 2020 2020 2020 5b22 6162 6322 5d2c          ["abc"],
+0002c0d0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0002c0e0: 2020 2077 6974 6820 7061 7463 6828 226c     with patch("l
+0002c0f0: 6f67 6769 6e67 2e4c 6f67 6765 722e 7761  ogging.Logger.wa
+0002c100: 726e 696e 6722 2920 6173 205f 773a 0a20  rning") as _w:. 
+0002c110: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002c120: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
+0002c130: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
+0002c140: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002c150: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0002c160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c170: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+0002c180: 2022 4361 7465 676f 7269 6573 222c 0a20   "Categories",. 
+0002c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c1a0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+0002c1b0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+0002c1c0: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002c1d0: 7065 7261 746f 7222 3a20 2261 7420 6c65  perator": "at le
+0002c1e0: 6173 7420 6f6e 6520 616d 6f6e 6722 2c0a  ast one among",.
+0002c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c200: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
+0002c210: 223a 205b 5d2c 0a20 2020 2020 2020 2020  ": [],.         
+0002c220: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002c230: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
+0002c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c250: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+0002c260: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+0002c270: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002c280: 5f77 2e61 7373 6572 745f 6361 6c6c 6564  _w.assert_called
+0002c290: 5f6f 6e63 655f 7769 7468 2822 496e 7661  _once_with("Inva
+0002c2a0: 6c69 6420 6c69 7374 206f 6620 6964 733a  lid list of ids:
+0002c2b0: 2027 5b5d 2722 290a 2020 2020 2020 2020   '[]'").        
+0002c2c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0002c2d0: 280a 2020 2020 2020 2020 2020 2020 736f  (.            so
+0002c2e0: 7274 6564 280a 2020 2020 2020 2020 2020  rted(.          
+0002c2f0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+0002c300: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
+0002c310: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
+0002c320: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0002c330: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+0002c340: 6962 732e 6665 7463 6846 726f 6d44 6963  ibs.fetchFromDic
+0002c350: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0002c360: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
 0002c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c380: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
-0002c390: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
-0002c3a0: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
-0002c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c3c0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0002c3d0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0002c3e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c380: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+0002c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c3a0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+0002c3b0: 223a 2022 4361 7465 676f 7269 6573 222c  ": "Categories",
+0002c3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c3e0: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
 0002c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c400: 2022 7479 7065 223a 2022 4361 7465 676f   "type": "Catego
-0002c410: 7269 6573 222c 0a20 2020 2020 2020 2020  ries",.         
+0002c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c410: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
 0002c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c430: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-0002c440: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0002c450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c460: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-0002c470: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0002c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c490: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-0002c4a0: 2022 7468 6973 206f 7220 7375 6263 6174   "this or subcat
-0002c4b0: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
-0002c4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c4d0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-0002c4e0: 6e74 223a 205b 305d 2c0a 2020 2020 2020  nt": [0],.      
-0002c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c500: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0002c510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c520: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002c530: 2020 2020 2020 292e 6c61 7374 4665 7463        ).lastFetc
-0002c540: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
-0002c550: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-0002c560: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-0002c570: 205b 2261 6263 222c 2022 6465 6622 2c20   ["abc", "def", 
-0002c580: 2267 6869 222c 2022 6d6e 6f22 2c20 2270  "ghi", "mno", "p
-0002c590: 7172 225d 2c0a 2020 2020 2020 2020 290a  qr"],.        ).
-0002c5a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0002c5b0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0002c5c0: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
-0002c5d0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
-0002c5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c5f0: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+0002c430: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002c440: 6f70 6572 6174 6f72 223a 2022 7468 6973  operator": "this
+0002c450: 206f 7220 7375 6263 6174 6567 6f72 6965   or subcategorie
+0002c460: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+0002c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c480: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
+0002c490: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
+0002c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c4b0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+0002c4c0: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+0002c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c4e0: 292e 6c61 7374 4665 7463 6865 640a 2020  ).lastFetched.  
+0002c4f0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+0002c500: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0002c510: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
+0002c520: 222c 2022 6465 6622 2c20 2267 6869 222c  ", "def", "ghi",
+0002c530: 2022 6d6e 6f22 2c20 2270 7172 225d 2c0a   "mno", "pqr"],.
+0002c540: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002c550: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0002c560: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0002c570: 736f 7274 6564 280a 2020 2020 2020 2020  sorted(.        
+0002c580: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+0002c590: 2020 2020 2020 2020 2020 2020 2020 655b                e[
+0002c5a0: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
+0002c5b0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0002c5c0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+0002c5d0: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
+0002c5e0: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
+0002c5f0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
 0002c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c610: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
-0002c620: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-0002c630: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
-0002c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c650: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+0002c610: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+0002c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c630: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+0002c640: 7065 223a 2022 4361 7465 676f 7269 6573  pe": "Categories
+0002c650: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 0002c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c670: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-0002c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c690: 2020 2022 7479 7065 223a 2022 4361 7465     "type": "Cate
-0002c6a0: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
-0002c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c6c0: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-0002c6d0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0002c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c6f0: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
-0002c700: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-0002c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c720: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-0002c730: 223a 2022 7468 6973 206f 7220 7375 6263  ": "this or subc
-0002c740: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
-0002c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c760: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-0002c770: 7465 6e74 223a 205b 315d 2c0a 2020 2020  tent": [1],.    
+0002c670: 2020 2022 6669 656c 6422 3a20 4e6f 6e65     "field": None
+0002c680: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6a0: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
+0002c6b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6d0: 2022 6f70 6572 6174 6f72 223a 2022 7468   "operator": "th
+0002c6e0: 6973 206f 7220 7375 6263 6174 6567 6f72  is or subcategor
+0002c6f0: 6965 7322 2c0a 2020 2020 2020 2020 2020  ies",.          
+0002c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c710: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+0002c720: 205b 315d 2c0a 2020 2020 2020 2020 2020   [1],.          
+0002c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c740: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+0002c750: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0002c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c770: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
 0002c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c790: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-0002c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c7b0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-0002c7c0: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-0002c7d0: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
-0002c7e0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0002c7f0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-0002c800: 2020 205b 2264 6566 222c 2022 6768 6922     ["def", "ghi"
-0002c810: 2c20 226d 6e6f 222c 2022 7071 7222 5d2c  , "mno", "pqr"],
-0002c820: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0002c830: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0002c840: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-0002c850: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0002c860: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
-0002c870: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002c880: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-0002c890: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
-0002c8a0: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
-0002c8b0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-0002c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c8d0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0002c790: 5d0a 2020 2020 2020 2020 2020 2020 292c  ].            ),
+0002c7a0: 0a20 2020 2020 2020 2020 2020 205b 2264  .            ["d
+0002c7b0: 6566 222c 2022 6768 6922 2c20 226d 6e6f  ef", "ghi", "mno
+0002c7c0: 222c 2022 7071 7222 5d2c 0a20 2020 2020  ", "pqr"],.     
+0002c7d0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+0002c7e0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0002c7f0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+0002c800: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
+0002c810: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
+0002c820: 2020 2020 2020 2020 2066 6f72 2065 2069           for e i
+0002c830: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+0002c840: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
+0002c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c860: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+0002c870: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+0002c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c890: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+0002c8a0: 6522 3a20 2243 6174 6567 6f72 6965 7322  e": "Categories"
+0002c8b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002c8c0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+0002c8d0: 6f67 6963 616c 223a 2022 222c 0a20 2020  ogical": "",.   
 0002c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c8f0: 2020 2274 7970 6522 3a20 2243 6174 6567    "type": "Categ
-0002c900: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
-0002c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c920: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
-0002c930: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002c940: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002c950: 6f70 6572 6174 6f72 223a 2022 6e6f 6e65  operator": "none
-0002c960: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
-0002c970: 6722 2c0a 2020 2020 2020 2020 2020 2020  g",.            
-0002c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c990: 2263 6f6e 7465 6e74 223a 205b 305d 2c0a  "content": [0],.
-0002c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9b0: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-0002c9c0: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
-0002c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9e0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-0002c9f0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-0002ca00: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
-0002ca10: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-0002ca20: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0002ca30: 2020 2020 5b22 6465 6622 2c20 2267 6869      ["def", "ghi
-0002ca40: 222c 2022 6a6b 6c22 2c20 226d 6e6f 222c  ", "jkl", "mno",
-0002ca50: 2022 7071 7222 5d2c 0a20 2020 2020 2020   "pqr"],.       
-0002ca60: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0002ca70: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0002ca80: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-0002ca90: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
-0002caa0: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
-0002cab0: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
-0002cac0: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-0002cad0: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
-0002cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002caf0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-0002cb00: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-0002cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb20: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-0002cb30: 3a20 2243 6174 6567 6f72 6965 7322 2c0a  : "Categories",.
-0002cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb50: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-0002cb60: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
-0002cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cb80: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-0002cb90: 223a 2022 6e6f 6e65 206f 6620 7468 6520  ": "none of the 
-0002cba0: 666f 6c6c 6f77 696e 6722 2c0a 2020 2020  following",.    
+0002c8f0: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
+0002c900: 6f72 223a 2022 6e6f 6e65 206f 6620 7468  or": "none of th
+0002c910: 6520 666f 6c6c 6f77 696e 6722 2c0a 2020  e following",.  
+0002c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c930: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+0002c940: 6e74 223a 205b 305d 2c0a 2020 2020 2020  nt": [0],.      
+0002c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c960: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
+0002c970: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0002c980: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+0002c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c9a0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+0002c9b0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+0002c9c0: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
+0002c9d0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+0002c9e0: 6465 6622 2c20 2267 6869 222c 2022 6a6b  def", "ghi", "jk
+0002c9f0: 6c22 2c20 226d 6e6f 222c 2022 7071 7222  l", "mno", "pqr"
+0002ca00: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+0002ca10: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0002ca20: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+0002ca30: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+0002ca40: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
+0002ca50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ca60: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+0002ca70: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
+0002ca80: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
+0002ca90: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+0002caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cab0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+0002cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cad0: 2020 2020 2274 7970 6522 3a20 2243 6174      "type": "Cat
+0002cae0: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
+0002caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb00: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+0002cb10: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+0002cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb30: 2022 6f70 6572 6174 6f72 223a 2022 6e6f   "operator": "no
+0002cb40: 6e65 206f 6620 7468 6520 666f 6c6c 6f77  ne of the follow
+0002cb50: 696e 6722 2c0a 2020 2020 2020 2020 2020  ing",.          
+0002cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb70: 2020 2263 6f6e 7465 6e74 223a 205b 302c    "content": [0,
+0002cb80: 2032 5d2c 0a20 2020 2020 2020 2020 2020   2],.           
+0002cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cba0: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
 0002cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cbc0: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
-0002cbd0: 223a 205b 302c 2032 5d2c 0a20 2020 2020  ": [0, 2],.     
+0002cbc0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0002cbd0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
 0002cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cbf0: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-0002cc00: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0002cc10: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-0002cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc30: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-0002cc40: 2020 2020 2020 292e 6c61 7374 4665 7463        ).lastFetc
-0002cc50: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
-0002cc60: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
-0002cc70: 2264 6566 222c 2022 6768 6922 2c20 226a  "def", "ghi", "j
-0002cc80: 6b6c 222c 2022 7071 7222 5d2c 0a20 2020  kl", "pqr"],.   
-0002cc90: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0002cca0: 2320 7465 7374 206d 6f72 6520 636f 6d62  # test more comb
-0002ccb0: 696e 6174 696f 6e73 206f 6620 6578 7073  inations of exps
-0002ccc0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0002ccd0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0002cce0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0002ccf0: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
-0002cd00: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
-0002cd10: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-0002cd20: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-0002cd30: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-0002cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cd50: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0002cd60: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0002cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cd80: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-0002cd90: 2245 7870 6572 696d 656e 7473 222c 0a20  "Experiments",. 
-0002cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cdb0: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
-0002cdc0: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
-0002cdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cde0: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
-0002cdf0: 3a20 2261 6c6c 206f 6620 7468 6520 666f  : "all of the fo
-0002ce00: 6c6c 6f77 696e 6722 2c0a 2020 2020 2020  llowing",.      
+0002cbf0: 292e 6c61 7374 4665 7463 6865 640a 2020  ).lastFetched.  
+0002cc00: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+0002cc10: 2020 2020 2020 2020 205b 2264 6566 222c           ["def",
+0002cc20: 2022 6768 6922 2c20 226a 6b6c 222c 2022   "ghi", "jkl", "
+0002cc30: 7071 7222 5d2c 0a20 2020 2020 2020 2029  pqr"],.        )
+0002cc40: 0a0a 2020 2020 2020 2020 2320 7465 7374  ..        # test
+0002cc50: 206d 6f72 6520 636f 6d62 696e 6174 696f   more combinatio
+0002cc60: 6e73 206f 6620 6578 7073 0a20 2020 2020  ns of exps.     
+0002cc70: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0002cc80: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0002cc90: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0002cca0: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
+0002ccb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002ccc0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+0002ccd0: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+0002cce0: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+0002ccf0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+0002cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd10: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0002cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd30: 2020 2274 7970 6522 3a20 2245 7870 6572    "type": "Exper
+0002cd40: 696d 656e 7473 222c 0a20 2020 2020 2020  iments",.       
+0002cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd60: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
+0002cd70: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+0002cd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cd90: 226f 7065 7261 746f 7222 3a20 2261 6c6c  "operator": "all
+0002cda0: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
+0002cdb0: 6722 2c0a 2020 2020 2020 2020 2020 2020  g",.            
+0002cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cdd0: 2263 6f6e 7465 6e74 223a 2031 2c0a 2020  "content": 1,.  
+0002cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cdf0: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+0002ce00: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
 0002ce10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce20: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-0002ce30: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
-0002ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce50: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
-0002ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ce70: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0002ce80: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-0002ce90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002cea0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
-0002ceb0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-0002cec0: 2020 2020 2020 2020 5b22 6465 6622 2c20          ["def", 
-0002ced0: 226a 6b6c 225d 2c0a 2020 2020 2020 2020  "jkl"],.        
-0002cee0: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
-0002cef0: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
-0002cf00: 6767 6572 2e77 6172 6e69 6e67 2229 2061  gger.warning") a
-0002cf10: 7320 5f77 3a0a 2020 2020 2020 2020 2020  s _w:.          
-0002cf20: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0002cf30: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
-0002cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cf50: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0002cf60: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+0002ce20: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+0002ce30: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+0002ce40: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
+0002ce50: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
+0002ce60: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+0002ce70: 2020 5b22 6465 6622 2c20 226a 6b6c 225d    ["def", "jkl"]
+0002ce80: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0002ce90: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+0002cea0: 6c6f 6767 696e 672e 4c6f 6767 6572 2e77  logging.Logger.w
+0002ceb0: 6172 6e69 6e67 2229 2061 7320 5f77 3a0a  arning") as _w:.
+0002cec0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002ced0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+0002cee0: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
+0002cef0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+0002cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf10: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0002cf20: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+0002cf30: 3a20 2245 7870 6572 696d 656e 7473 222c  : "Experiments",
+0002cf40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002cf50: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
+0002cf60: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
 0002cf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cf80: 2274 7970 6522 3a20 2245 7870 6572 696d  "type": "Experim
-0002cf90: 656e 7473 222c 0a20 2020 2020 2020 2020  ents",.         
-0002cfa0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002cfb0: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
-0002cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cfd0: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
-0002cfe0: 3a20 2261 6c6c 206f 6620 7468 6520 666f  : "all of the fo
-0002cff0: 6c6c 6f77 696e 6722 2c0a 2020 2020 2020  llowing",.      
-0002d000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d010: 2020 2263 6f6e 7465 6e74 223a 205b 312c    "content": [1,
-0002d020: 2032 5d2c 0a20 2020 2020 2020 2020 2020   2],.           
-0002d030: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
-0002d040: 656c 6422 3a20 4e6f 6e65 2c0a 2020 2020  eld": None,.    
-0002d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d060: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0002d070: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-0002d080: 290a 2020 2020 2020 2020 2020 2020 5f77  ).            _w
-0002d090: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-0002d0a0: 6e63 655f 7769 7468 2822 496e 7661 6c69  nce_with("Invali
-0002d0b0: 6420 6f70 6572 6174 6f72 3a20 2761 6c6c  d operator: 'all
-0002d0c0: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
-0002d0d0: 6727 2229 0a20 2020 2020 2020 2073 656c  g'").        sel
-0002d0e0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-0002d0f0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-0002d100: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
-0002d110: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
-0002d120: 2020 2020 2020 2020 2066 6f72 2065 2069           for e i
-0002d130: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-0002d140: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
-0002d150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d160: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002d170: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-0002d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d190: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-0002d1a0: 6522 3a20 2245 7870 6572 696d 656e 7473  e": "Experiments
-0002d1b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002d1c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002d1d0: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
-0002d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d1f0: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
-0002d200: 746f 7222 3a20 2261 6c6c 2074 6865 2066  tor": "all the f
-0002d210: 6f6c 6c6f 7769 6e67 222c 0a20 2020 2020  ollowing",.     
+0002cf80: 226f 7065 7261 746f 7222 3a20 2261 6c6c  "operator": "all
+0002cf90: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
+0002cfa0: 6722 2c0a 2020 2020 2020 2020 2020 2020  g",.            
+0002cfb0: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+0002cfc0: 7465 6e74 223a 205b 312c 2032 5d2c 0a20  tent": [1, 2],. 
+0002cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cfe0: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
+0002cff0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+0002d000: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0002d010: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0002d020: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0002d030: 2020 2020 2020 2020 5f77 2e61 7373 6572          _w.asser
+0002d040: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+0002d050: 7468 2822 496e 7661 6c69 6420 6f70 6572  th("Invalid oper
+0002d060: 6174 6f72 3a20 2761 6c6c 206f 6620 7468  ator: 'all of th
+0002d070: 6520 666f 6c6c 6f77 696e 6727 2229 0a20  e following'"). 
+0002d080: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0002d090: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+0002d0a0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+0002d0b0: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
+0002d0c0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+0002d0d0: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
+0002d0e0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+0002d0f0: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
+0002d100: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+0002d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d120: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0002d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d140: 2020 2020 2020 2274 7970 6522 3a20 2245        "type": "E
+0002d150: 7870 6572 696d 656e 7473 222c 0a20 2020  xperiments",.   
+0002d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d170: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
+0002d180: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
+0002d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d1a0: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
+0002d1b0: 2261 6c6c 2074 6865 2066 6f6c 6c6f 7769  "all the followi
+0002d1c0: 6e67 222c 0a20 2020 2020 2020 2020 2020  ng",.           
+0002d1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d1e0: 2022 636f 6e74 656e 7422 3a20 5b30 2c20   "content": [0, 
+0002d1f0: 315d 2c0a 2020 2020 2020 2020 2020 2020  1],.            
+0002d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d210: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
 0002d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d230: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-0002d240: 3a20 5b30 2c20 315d 2c0a 2020 2020 2020  : [0, 1],.      
-0002d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d260: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
-0002d270: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0002d280: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-0002d290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d2a0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0002d2b0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-0002d2c0: 6564 0a20 2020 2020 2020 2020 2020 205d  ed.            ]
-0002d2d0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-0002d2e0: 6465 6622 5d2c 0a20 2020 2020 2020 2029  def"],.        )
-0002d2f0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0002d300: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0002d310: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
-0002d320: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002d330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d340: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-0002d350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d360: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-0002d370: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-0002d380: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-0002d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3a0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+0002d230: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+0002d240: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002d250: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002d260: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+0002d270: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+0002d280: 2020 2020 2020 2020 5b22 6465 6622 5d2c          ["def"],
+0002d290: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0002d2a0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0002d2b0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0002d2c0: 2073 6f72 7465 6428 0a20 2020 2020 2020   sorted(.       
+0002d2d0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002d2e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002d2f0: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+0002d300: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002d310: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+0002d320: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+0002d330: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+0002d340: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+0002d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d360: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+0002d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d380: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0002d390: 7970 6522 3a20 2245 7870 6572 696d 656e  ype": "Experimen
+0002d3a0: 7473 222c 0a20 2020 2020 2020 2020 2020  ts",.           
 0002d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3c0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-0002d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3e0: 2020 2020 2274 7970 6522 3a20 2245 7870      "type": "Exp
-0002d3f0: 6572 696d 656e 7473 222c 0a20 2020 2020  eriments",.     
-0002d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d410: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
-0002d420: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
-0002d430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d440: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
-0002d450: 746f 7222 3a20 2261 7420 6c65 6173 7420  tor": "at least 
-0002d460: 6f6e 6520 616d 6f6e 6722 2c0a 2020 2020  one among",.    
-0002d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d480: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-0002d490: 7465 6e74 223a 205b 302c 2031 5d2c 0a20  tent": [0, 1],. 
-0002d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002d4c0: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
-0002d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4e0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-0002d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d500: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-0002d510: 2020 2020 2020 2020 2020 292e 6c61 7374            ).last
-0002d520: 4665 7463 6865 640a 2020 2020 2020 2020  Fetched.        
-0002d530: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-0002d540: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-0002d550: 2020 2020 205b 2261 6263 222c 2022 6465       ["abc", "de
-0002d560: 6622 2c20 226a 6b6c 225d 2c0a 2020 2020  f", "jkl"],.    
-0002d570: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0002d580: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0002d590: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-0002d5a0: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-0002d5b0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002d5c0: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
-0002d5d0: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
-0002d5e0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-0002d5f0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-0002d600: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-0002d610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d620: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002d3c0: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
+0002d3d0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+0002d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d3f0: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
+0002d400: 2261 7420 6c65 6173 7420 6f6e 6520 616d  "at least one am
+0002d410: 6f6e 6722 2c0a 2020 2020 2020 2020 2020  ong",.          
+0002d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d430: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+0002d440: 205b 302c 2031 5d2c 0a20 2020 2020 2020   [0, 1],.       
+0002d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d460: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
+0002d470: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+0002d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d490: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+0002d4a0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+0002d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d4c0: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
+0002d4d0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0002d4e0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+0002d4f0: 292c 0a20 2020 2020 2020 2020 2020 205b  ),.            [
+0002d500: 2261 6263 222c 2022 6465 6622 2c20 226a  "abc", "def", "j
+0002d510: 6b6c 225d 2c0a 2020 2020 2020 2020 290a  kl"],.        ).
+0002d520: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0002d530: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0002d540: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
+0002d550: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+0002d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d570: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+0002d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d590: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+0002d5a0: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+0002d5b0: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+0002d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d5d0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+0002d5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d5f0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0002d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d610: 2020 2022 7479 7065 223a 2022 4578 7065     "type": "Expe
+0002d620: 7269 6d65 6e74 7322 2c0a 2020 2020 2020  riments",.      
 0002d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d640: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-0002d650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d660: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-0002d670: 2022 4578 7065 7269 6d65 6e74 7322 2c0a   "Experiments",.
-0002d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6a0: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
-0002d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002d6d0: 6f70 6572 6174 6f72 223a 2022 6174 206c  operator": "at l
-0002d6e0: 6561 7374 206f 6e65 2061 6d6f 6e67 222c  east one among",
-0002d6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d640: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+0002d650: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
+0002d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d670: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
+0002d680: 6f72 223a 2022 6174 206c 6561 7374 206f  or": "at least o
+0002d690: 6e65 2061 6d6f 6e67 222c 0a20 2020 2020  ne among",.     
+0002d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d6b0: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
+0002d6c0: 656e 7422 3a20 5b30 5d2c 0a20 2020 2020  ent": [0],.     
+0002d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d6e0: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
+0002d6f0: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
 0002d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d710: 2022 636f 6e74 656e 7422 3a20 5b30 5d2c   "content": [0],
-0002d720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d740: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
-0002d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d760: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0002d710: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0002d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d730: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+0002d740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d750: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
+0002d760: 4578 7065 7269 6d65 6e74 7322 2c0a 2020  Experiments",.  
 0002d770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d780: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-0002d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7a0: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-0002d7b0: 7065 223a 2022 4578 7065 7269 6d65 6e74  pe": "Experiment
-0002d7c0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
-0002d7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7e0: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-0002d7f0: 2261 7420 6c65 6173 7420 6f6e 6520 616d  "at least one am
-0002d800: 6f6e 6722 2c0a 2020 2020 2020 2020 2020  ong",.          
-0002d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d820: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-0002d830: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0002d780: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002d790: 7065 7261 746f 7222 3a20 2261 7420 6c65  perator": "at le
+0002d7a0: 6173 7420 6f6e 6520 616d 6f6e 6722 2c0a  ast one among",.
+0002d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d7d0: 226c 6f67 6963 616c 223a 204e 6f6e 652c  "logical": None,
+0002d7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d800: 2022 636f 6e74 656e 7422 3a20 5b32 5d2c   "content": [2],
+0002d810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d830: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
 0002d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d850: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-0002d860: 3a20 5b32 5d2c 0a20 2020 2020 2020 2020  : [2],.         
-0002d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d880: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-0002d890: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0002d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d8b0: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-0002d8c0: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
-0002d8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d8e0: 2020 2020 2020 2020 6465 6661 756c 7443          defaultC
-0002d8f0: 6f6e 6e65 6374 696f 6e3d 226f 7222 2c0a  onnection="or",.
-0002d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d910: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
-0002d920: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0002d930: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-0002d940: 292c 0a20 2020 2020 2020 2020 2020 205b  ),.            [
-0002d950: 2261 6263 222c 2022 6465 6622 5d2c 0a20  "abc", "def"],. 
-0002d960: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002d970: 2077 6974 6820 7061 7463 6828 226c 6f67   with patch("log
-0002d980: 6769 6e67 2e4c 6f67 6765 722e 7761 726e  ging.Logger.warn
-0002d990: 696e 6722 2920 6173 205f 773a 0a20 2020  ing") as _w:.   
-0002d9a0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0002d9b0: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
-0002d9c0: 6d44 6963 7428 0a20 2020 2020 2020 2020  mDict(.         
-0002d9d0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0002d9e0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+0002d850: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0002d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d870: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+0002d880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d890: 2020 6465 6661 756c 7443 6f6e 6e65 6374    defaultConnect
+0002d8a0: 696f 6e3d 226f 7222 2c0a 2020 2020 2020  ion="or",.      
+0002d8b0: 2020 2020 2020 2020 2020 2020 2020 292e                ).
+0002d8c0: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
+0002d8d0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0002d8e0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0002d8f0: 2020 2020 2020 2020 205b 2261 6263 222c           ["abc",
+0002d900: 2022 6465 6622 5d2c 0a20 2020 2020 2020   "def"],.       
+0002d910: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
+0002d920: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
+0002d930: 6f67 6765 722e 7761 726e 696e 6722 2920  ogger.warning") 
+0002d940: 6173 205f 773a 0a20 2020 2020 2020 2020  as _w:.         
+0002d950: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0002d960: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
+0002d970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d980: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0002d990: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0002d9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d9b0: 2022 7479 7065 223a 2022 4578 7065 7269   "type": "Experi
+0002d9c0: 6d65 6e74 7322 2c0a 2020 2020 2020 2020  ments",.        
+0002d9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d9e0: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
 0002d9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da00: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
-0002da10: 4578 7065 7269 6d65 6e74 7322 2c0a 2020  Experiments",.  
-0002da20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da30: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-0002da40: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0002da50: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
-0002da60: 6572 6174 6f72 223a 2022 6174 206c 6561  erator": "at lea
-0002da70: 7374 206f 6e65 2061 6d6f 6e67 222c 0a20  st one among",. 
-0002da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da90: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-0002daa0: 3a20 5b5d 2c0a 2020 2020 2020 2020 2020  : [],.          
-0002dab0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0002dac0: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
-0002dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dae0: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
-0002daf0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0002db00: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0002db10: 772e 6173 7365 7274 5f63 616c 6c65 645f  w.assert_called_
-0002db20: 6f6e 6365 5f77 6974 6828 2249 6e76 616c  once_with("Inval
-0002db30: 6964 206c 6973 7420 6f66 2069 6473 3a20  id list of ids: 
-0002db40: 275b 5d27 2229 0a20 2020 2020 2020 2073  '[]'").        s
-0002db50: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0002db60: 0a20 2020 2020 2020 2020 2020 205b 0a20  .            [. 
-0002db70: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002db80: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
-0002db90: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-0002dba0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-0002dbb0: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
-0002dbc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002dbd0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-0002dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dbf0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0002dc00: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-0002dc10: 7970 6522 3a20 2245 7870 6572 696d 656e  ype": "Experimen
-0002dc20: 7473 222c 0a20 2020 2020 2020 2020 2020  ts",.           
-0002dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dc40: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
-0002dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dc60: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
-0002dc70: 7261 746f 7222 3a20 226e 6f6e 6520 6f66  rator": "none of
-0002dc80: 2074 6865 2066 6f6c 6c6f 7769 6e67 222c   the following",
-0002dc90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002dca0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-0002dcb0: 6e74 656e 7422 3a20 5b30 5d2c 0a20 2020  ntent": [0],.   
-0002dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dcd0: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-0002dce0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0002dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dd00: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0002dd10: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0002dd20: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-0002dd30: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
-0002dd40: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
-0002dd50: 205b 2267 6869 222c 2022 6a6b 6c22 2c20   ["ghi", "jkl", 
-0002dd60: 226d 6e6f 222c 2022 7071 7222 5d2c 0a20  "mno", "pqr"],. 
-0002dd70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002dd80: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0002dd90: 6c28 0a20 2020 2020 2020 2020 2020 205b  l(.            [
-0002dda0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ddb0: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
-0002ddc0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0002ddd0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-0002dde0: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
-0002ddf0: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-0002de00: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-0002de10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002de20: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+0002da00: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
+0002da10: 223a 2022 6174 206c 6561 7374 206f 6e65  ": "at least one
+0002da20: 2061 6d6f 6e67 222c 0a20 2020 2020 2020   among",.       
+0002da30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da40: 2022 636f 6e74 656e 7422 3a20 5b5d 2c0a   "content": [],.
+0002da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da60: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+0002da70: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0002da80: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0002da90: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002daa0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002dab0: 2020 2020 2020 2020 205f 772e 6173 7365           _w.asse
+0002dac0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+0002dad0: 6974 6828 2249 6e76 616c 6964 206c 6973  ith("Invalid lis
+0002dae0: 7420 6f66 2069 6473 3a20 275b 5d27 2229  t of ids: '[]'")
+0002daf0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0002db00: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0002db10: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0002db20: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
+0002db30: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
+0002db40: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
+0002db50: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
+0002db60: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
+0002db70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002db80: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0002db90: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+0002dba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dbb0: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
+0002dbc0: 2245 7870 6572 696d 656e 7473 222c 0a20  "Experiments",. 
+0002dbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dbe0: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+0002dbf0: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
+0002dc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dc10: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
+0002dc20: 3a20 226e 6f6e 6520 6f66 2074 6865 2066  : "none of the f
+0002dc30: 6f6c 6c6f 7769 6e67 222c 0a20 2020 2020  ollowing",.     
+0002dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dc50: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+0002dc60: 3a20 5b30 5d2c 0a20 2020 2020 2020 2020  : [0],.         
+0002dc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dc80: 2020 2022 6669 656c 6422 3a20 4e6f 6e65     "field": None
+0002dc90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002dca0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+0002dcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dcc0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002dcd0: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
+0002dce0: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
+0002dcf0: 2020 2020 2020 2020 2020 205b 2267 6869             ["ghi
+0002dd00: 222c 2022 6a6b 6c22 2c20 226d 6e6f 222c  ", "jkl", "mno",
+0002dd10: 2022 7071 7222 5d2c 0a20 2020 2020 2020   "pqr"],.       
+0002dd20: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+0002dd30: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0002dd40: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002dd50: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
+0002dd60: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
+0002dd70: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
+0002dd80: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+0002dd90: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
+0002dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ddb0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+0002ddc0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+0002ddd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dde0: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+0002ddf0: 3a20 2245 7870 6572 696d 656e 7473 222c  : "Experiments",
+0002de00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002de10: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+0002de20: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
 0002de30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002de40: 2274 7970 6522 3a20 2245 7870 6572 696d  "type": "Experim
-0002de50: 656e 7473 222c 0a20 2020 2020 2020 2020  ents",.         
-0002de60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002de70: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
-0002de80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002de90: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-0002dea0: 7065 7261 746f 7222 3a20 226e 6f6e 6520  perator": "none 
-0002deb0: 6f66 2074 6865 2066 6f6c 6c6f 7769 6e67  of the following
-0002dec0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0002ded0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002dee0: 636f 6e74 656e 7422 3a20 5b30 2c20 315d  content": [0, 1]
-0002def0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002df00: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0002df10: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
-0002df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df30: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-0002df40: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-0002df50: 2020 2020 2020 2020 2020 2020 2029 2e6c               ).l
-0002df60: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
-0002df70: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-0002df80: 2020 2020 2020 5b22 6768 6922 2c20 226d        ["ghi", "m
-0002df90: 6e6f 222c 2022 7071 7222 5d2c 0a20 2020  no", "pqr"],.   
-0002dfa0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0002dfb0: 2320 6361 7465 676f 7269 6573 2061 6e64  # categories and
-0002dfc0: 2065 7870 6572 696d 656e 7473 0a20 2020   experiments.   
-0002dfd0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0002dfe0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0002dff0: 2020 2073 6f72 7465 6428 0a20 2020 2020     sorted(.     
-0002e000: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-0002e010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e020: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+0002de40: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
+0002de50: 7222 3a20 226e 6f6e 6520 6f66 2074 6865  r": "none of the
+0002de60: 2066 6f6c 6c6f 7769 6e67 222c 0a20 2020   following",.   
+0002de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002de80: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
+0002de90: 7422 3a20 5b30 2c20 315d 2c0a 2020 2020  t": [0, 1],.    
+0002dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002deb0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+0002dec0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0002ded0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0002dee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002def0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+0002df00: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
+0002df10: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
+0002df20: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+0002df30: 5b22 6768 6922 2c20 226d 6e6f 222c 2022  ["ghi", "mno", "
+0002df40: 7071 7222 5d2c 0a20 2020 2020 2020 2029  pqr"],.        )
+0002df50: 0a0a 2020 2020 2020 2020 2320 6361 7465  ..        # cate
+0002df60: 676f 7269 6573 2061 6e64 2065 7870 6572  gories and exper
+0002df70: 696d 656e 7473 0a20 2020 2020 2020 2073  iments.        s
+0002df80: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0002df90: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
+0002dfa0: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
+0002dfb0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+0002dfc0: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
+0002dfd0: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
+0002dfe0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0002dff0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+0002e000: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
+0002e010: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002e020: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
 0002e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e040: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-0002e050: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
-0002e060: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
-0002e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e080: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0002e090: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-0002e0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e040: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0002e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e060: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+0002e070: 3a20 2243 6174 6567 6f72 6965 7322 2c0a  : "Categories",.
+0002e080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e0a0: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
 0002e0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0c0: 2274 7970 6522 3a20 2243 6174 6567 6f72  "type": "Categor
-0002e0d0: 6965 7322 2c0a 2020 2020 2020 2020 2020  ies",.          
-0002e0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e0f0: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-0002e100: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0002e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e120: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-0002e130: 2022 6c69 6b65 222c 0a20 2020 2020 2020   "like",.       
-0002e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e150: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
-0002e160: 7422 3a20 5b31 5d2c 0a20 2020 2020 2020  t": [1],.       
-0002e170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e180: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-0002e190: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0002e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1b0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+0002e0c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002e0d0: 6f70 6572 6174 6f72 223a 2022 6c69 6b65  operator": "like
+0002e0e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002e0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e100: 2020 2022 636f 6e74 656e 7422 3a20 5b31     "content": [1
+0002e110: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002e120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e130: 2020 2022 6669 656c 6422 3a20 4e6f 6e65     "field": None
+0002e140: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002e150: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+0002e160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e170: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+0002e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e190: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002e1a0: 7479 7065 223a 2022 4578 7065 7269 6d65  type": "Experime
+0002e1b0: 6e74 7322 2c0a 2020 2020 2020 2020 2020  nts",.          
 0002e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1d0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-0002e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1f0: 2020 2020 2022 7479 7065 223a 2022 4578       "type": "Ex
-0002e200: 7065 7269 6d65 6e74 7322 2c0a 2020 2020  periments",.    
-0002e210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e220: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-0002e230: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
-0002e240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e250: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
-0002e260: 6174 6f72 223a 2022 6c69 6b65 222c 0a20  ator": "like",. 
-0002e270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e280: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002e290: 636f 6e74 656e 7422 3a20 5b31 5d2c 0a20  content": [1],. 
-0002e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e2b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002e2c0: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
-0002e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e2e0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-0002e2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e300: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-0002e310: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
-0002e320: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-0002e330: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-0002e340: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0002e350: 2020 2020 2020 5b22 6465 6622 5d2c 0a20        ["def"],. 
-0002e360: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002e370: 2020 2320 7465 7374 206d 6172 6b73 0a20    # test marks. 
-0002e380: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0002e390: 2e62 6962 732e 7570 6461 7465 4669 656c  .bibs.updateFiel
-0002e3a0: 6428 226a 6b6c 222c 2022 6d61 726b 7322  d("jkl", "marks"
-0002e3b0: 2c20 226e 6577 2229 0a20 2020 2020 2020  , "new").       
-0002e3c0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0002e3d0: 7570 6461 7465 4669 656c 6428 226d 6e6f  updateField("mno
-0002e3e0: 222c 2022 6d61 726b 7322 2c20 2269 6d70  ", "marks", "imp
-0002e3f0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-0002e400: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
-0002e410: 4669 656c 6428 2270 7172 222c 2022 6d61  Field("pqr", "ma
-0002e420: 726b 7322 2c20 2266 6176 2c6e 6577 2229  rks", "fav,new")
-0002e430: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0002e440: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0002e450: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
-0002e460: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002e470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e480: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-0002e490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e4a0: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-0002e4b0: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-0002e4c0: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-0002e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e4e0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e500: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+0002e1d0: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+0002e1e0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+0002e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e200: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
+0002e210: 2022 6c69 6b65 222c 0a20 2020 2020 2020   "like",.       
+0002e220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e230: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
+0002e240: 7422 3a20 5b31 5d2c 0a20 2020 2020 2020  t": [1],.       
+0002e250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e260: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
+0002e270: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+0002e280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e290: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+0002e2a0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+0002e2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e2c0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+0002e2d0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+0002e2e0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+0002e2f0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0002e300: 5b22 6465 6622 5d2c 0a20 2020 2020 2020  ["def"],.       
+0002e310: 2029 0a0a 2020 2020 2020 2020 2320 7465   )..        # te
+0002e320: 7374 206d 6172 6b73 0a20 2020 2020 2020  st marks.       
+0002e330: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0002e340: 7570 6461 7465 4669 656c 6428 226a 6b6c  updateField("jkl
+0002e350: 222c 2022 6d61 726b 7322 2c20 226e 6577  ", "marks", "new
+0002e360: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+0002e370: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
+0002e380: 4669 656c 6428 226d 6e6f 222c 2022 6d61  Field("mno", "ma
+0002e390: 726b 7322 2c20 2269 6d70 2229 0a20 2020  rks", "imp").   
+0002e3a0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0002e3b0: 6962 732e 7570 6461 7465 4669 656c 6428  ibs.updateField(
+0002e3c0: 2270 7172 222c 2022 6d61 726b 7322 2c20  "pqr", "marks", 
+0002e3d0: 2266 6176 2c6e 6577 2229 0a20 2020 2020  "fav,new").     
+0002e3e0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0002e3f0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0002e400: 2073 6f72 7465 6428 0a20 2020 2020 2020   sorted(.       
+0002e410: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002e420: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002e430: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+0002e440: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002e450: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+0002e460: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+0002e470: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+0002e480: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+0002e490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e4a0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+0002e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e4c0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0002e4d0: 7970 6522 3a20 224d 6172 6b73 222c 0a20  ype": "Marks",. 
+0002e4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e4f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002e500: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
 0002e510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e520: 2020 2020 2274 7970 6522 3a20 224d 6172      "type": "Mar
-0002e530: 6b73 222c 0a20 2020 2020 2020 2020 2020  ks",.           
+0002e520: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002e530: 7065 7261 746f 7222 3a20 4e6f 6e65 2c0a  perator": None,.
 0002e540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e550: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-0002e560: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-0002e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e580: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-0002e590: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0002e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e5b0: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-0002e5c0: 205b 2261 6e79 225d 2c0a 2020 2020 2020   ["any"],.      
-0002e5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e5e0: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
-0002e5f0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-0002e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e610: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-0002e620: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0002e630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e640: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-0002e650: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-0002e660: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0002e670: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0002e680: 5b22 6a6b 6c22 2c20 226d 6e6f 222c 2022  ["jkl", "mno", "
-0002e690: 7071 7222 5d2c 0a20 2020 2020 2020 2029  pqr"],.        )
-0002e6a0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0002e6b0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0002e6c0: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
-0002e6d0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002e6e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e6f0: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-0002e700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e710: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-0002e720: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-0002e730: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-0002e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e750: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e770: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+0002e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e560: 2263 6f6e 7465 6e74 223a 205b 2261 6e79  "content": ["any
+0002e570: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0002e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e590: 2020 2020 2266 6965 6c64 223a 204e 6f6e      "field": Non
+0002e5a0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0002e5b0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0002e5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e5d0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+0002e5e0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002e5f0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+0002e600: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002e610: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0002e620: 2020 2020 2020 2020 2020 5b22 6a6b 6c22            ["jkl"
+0002e630: 2c20 226d 6e6f 222c 2022 7071 7222 5d2c  , "mno", "pqr"],
+0002e640: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0002e650: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0002e660: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0002e670: 2073 6f72 7465 6428 0a20 2020 2020 2020   sorted(.       
+0002e680: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002e690: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002e6a0: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+0002e6b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002e6c0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+0002e6d0: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+0002e6e0: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+0002e6f0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+0002e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e710: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+0002e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e730: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0002e740: 7970 6522 3a20 224d 6172 6b73 222c 0a20  ype": "Marks",. 
+0002e750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e760: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002e770: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
 0002e780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e790: 2020 2020 2274 7970 6522 3a20 224d 6172      "type": "Mar
-0002e7a0: 6b73 222c 0a20 2020 2020 2020 2020 2020  ks",.           
+0002e790: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002e7a0: 7065 7261 746f 7222 3a20 4e6f 6e65 2c0a  perator": None,.
 0002e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e7c0: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-0002e7d0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-0002e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e7f0: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-0002e800: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0002e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e820: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-0002e830: 205b 226e 6577 225d 2c0a 2020 2020 2020   ["new"],.      
-0002e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e850: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
-0002e860: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-0002e870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e880: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-0002e890: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0002e8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e8b0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-0002e8c0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-0002e8d0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-0002e8e0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0002e8f0: 5b22 6a6b 6c22 2c20 2270 7172 225d 2c0a  ["jkl", "pqr"],.
-0002e900: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002e910: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0002e920: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-0002e930: 736f 7274 6564 280a 2020 2020 2020 2020  sorted(.        
-0002e940: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-0002e950: 2020 2020 2020 2020 2020 2020 2020 655b                e[
-0002e960: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
-0002e970: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0002e980: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-0002e990: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
-0002e9a0: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
-0002e9b0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+0002e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e7d0: 2263 6f6e 7465 6e74 223a 205b 226e 6577  "content": ["new
+0002e7e0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0002e7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e800: 2020 2020 2266 6965 6c64 223a 204e 6f6e      "field": Non
+0002e810: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0002e820: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0002e830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e840: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+0002e850: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002e860: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+0002e870: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002e880: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0002e890: 2020 2020 2020 2020 2020 5b22 6a6b 6c22            ["jkl"
+0002e8a0: 2c20 2270 7172 225d 2c0a 2020 2020 2020  , "pqr"],.      
+0002e8b0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+0002e8c0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+0002e8d0: 2020 2020 2020 2020 2020 736f 7274 6564            sorted
+0002e8e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002e8f0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+0002e900: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
+0002e910: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+0002e920: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
+0002e930: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0002e940: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
+0002e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e960: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0002e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e980: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+0002e990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9a0: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
+0002e9b0: 4d61 726b 7322 2c0a 2020 2020 2020 2020  Marks",.        
 0002e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9d0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-0002e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e9f0: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-0002ea00: 7065 223a 2022 4d61 726b 7322 2c0a 2020  pe": "Marks",.  
-0002ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea20: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-0002ea30: 6f67 6963 616c 223a 2022 222c 0a20 2020  ogical": "",.   
-0002ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea50: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
-0002ea60: 6572 6174 6f72 223a 2022 6162 6322 2c0a  erator": "abc",.
-0002ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9d0: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
+0002e9e0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+0002e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea00: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
+0002ea10: 223a 2022 6162 6322 2c0a 2020 2020 2020  ": "abc",.      
+0002ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea30: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+0002ea40: 6e74 223a 205b 226e 6577 225d 2c0a 2020  nt": ["new"],.  
+0002ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea60: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+0002ea70: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
 0002ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea90: 2263 6f6e 7465 6e74 223a 205b 226e 6577  "content": ["new
-0002eaa0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-0002eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eac0: 2020 2020 2266 6965 6c64 223a 204e 6f6e      "field": Non
-0002ead0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0002eae0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0002eaf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002eb00: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-0002eb10: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002eb20: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
-0002eb30: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-0002eb40: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-0002eb50: 2020 2020 2020 2020 2020 5b22 6a6b 6c22            ["jkl"
-0002eb60: 2c20 2270 7172 225d 2c0a 2020 2020 2020  , "pqr"],.      
-0002eb70: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-0002eb80: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
-0002eb90: 4c6f 6767 6572 2e77 6172 6e69 6e67 2229  Logger.warning")
-0002eba0: 2061 7320 5f77 3a0a 2020 2020 2020 2020   as _w:.        
-0002ebb0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0002ebc0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-0002ebd0: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
-0002ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ebf0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-0002ec00: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
-0002ec10: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
+0002ea90: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+0002eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eab0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+0002eac0: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
+0002ead0: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
+0002eae0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+0002eaf0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+0002eb00: 2020 2020 5b22 6a6b 6c22 2c20 2270 7172      ["jkl", "pqr
+0002eb10: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
+0002eb20: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+0002eb30: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
+0002eb40: 2e77 6172 6e69 6e67 2229 2061 7320 5f77  .warning") as _w
+0002eb50: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0002eb60: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+0002eb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eb80: 736f 7274 6564 280a 2020 2020 2020 2020  sorted(.        
+0002eb90: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+0002eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ebb0: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
+0002ebc0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0002ebd0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
+0002ebe0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
+0002ebf0: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
+0002ec00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ec10: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
 0002ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec30: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-0002ec40: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
-0002ec50: 6d44 6963 7428 0a20 2020 2020 2020 2020  mDict(.         
-0002ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec70: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+0002ec30: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0002ec40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec60: 2020 2020 2022 7479 7065 223a 2022 4d61       "type": "Ma
+0002ec70: 726b 7322 2c0a 2020 2020 2020 2020 2020  rks",.          
 0002ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ec90: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-0002eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ecb0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-0002ecc0: 223a 2022 4d61 726b 7322 2c0a 2020 2020  ": "Marks",.    
-0002ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec90: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+0002eca0: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
+0002ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ecc0: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+0002ecd0: 6572 6174 6f72 223a 2022 3d22 2c0a 2020  erator": "=",.  
 0002ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ecf0: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
-0002ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed20: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-0002ed30: 3d22 2c0a 2020 2020 2020 2020 2020 2020  =",.            
-0002ed40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed50: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
-0002ed60: 223a 2022 6e65 7722 2c0a 2020 2020 2020  ": "new",.      
+0002ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ed00: 2020 2263 6f6e 7465 6e74 223a 2022 6e65    "content": "ne
+0002ed10: 7722 2c0a 2020 2020 2020 2020 2020 2020  w",.            
+0002ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ed30: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+0002ed40: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0002ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ed60: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
 0002ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed80: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-0002ed90: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
-0002eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002edb0: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-0002edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002edd0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-0002ede0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002edf0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-0002ee00: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-0002ee10: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-0002ee20: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-0002ee30: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-0002ee40: 6322 2c20 2264 6566 222c 2022 6768 6922  c", "def", "ghi"
-0002ee50: 2c20 226a 6b6c 222c 2022 6d6e 6f22 2c20  , "jkl", "mno", 
-0002ee60: 2270 7172 225d 2c0a 2020 2020 2020 2020  "pqr"],.        
-0002ee70: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0002ee80: 2020 5f77 2e61 7373 6572 745f 6361 6c6c    _w.assert_call
-0002ee90: 6564 5f6f 6e63 655f 7769 7468 2822 496e  ed_once_with("In
-0002eea0: 7661 6c69 6420 2763 6f6e 7465 6e74 2720  valid 'content' 
-0002eeb0: 696e 2073 6561 7263 683a 2027 6e65 7727  in search: 'new'
-0002eec0: 2028 4d61 726b 7329 2229 0a20 2020 2020   (Marks)").     
-0002eed0: 2020 2020 2020 205f 772e 7265 7365 745f         _w.reset_
-0002eee0: 6d6f 636b 2829 0a20 2020 2020 2020 2020  mock().         
-0002eef0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-0002ef00: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-0002ef10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ef20: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0002ef30: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-0002ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ef50: 2022 7479 7065 223a 2022 4d61 726b 7322   "type": "Marks"
-0002ef60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002ef70: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-0002ef80: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
-0002ef90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002efa0: 2022 6f70 6572 6174 6f72 223a 2022 3d22   "operator": "="
-0002efb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002efc0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-0002efd0: 6e74 223a 205b 5d2c 0a20 2020 2020 2020  nt": [],.       
-0002efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eff0: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
-0002f000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f010: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-0002f020: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0002f030: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0002f040: 2020 5f77 2e61 7373 6572 745f 6361 6c6c    _w.assert_call
-0002f050: 6564 5f6f 6e63 655f 7769 7468 2822 496e  ed_once_with("In
-0002f060: 7661 6c69 6420 2763 6f6e 7465 6e74 2720  valid 'content' 
-0002f070: 696e 2073 6561 7263 683a 2027 5b5d 2720  in search: '[]' 
-0002f080: 284d 6172 6b73 2922 290a 2020 2020 2020  (Marks)").      
-0002f090: 2020 2020 2020 5f77 2e72 6573 6574 5f6d        _w.reset_m
-0002f0a0: 6f63 6b28 290a 2020 2020 2020 2020 2020  ock().          
-0002f0b0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0002f0c0: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
+0002ed80: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+0002ed90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002eda0: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+0002edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002edc0: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+0002edd0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+0002ede0: 2020 2020 2020 5b22 6162 6322 2c20 2264        ["abc", "d
+0002edf0: 6566 222c 2022 6768 6922 2c20 226a 6b6c  ef", "ghi", "jkl
+0002ee00: 222c 2022 6d6e 6f22 2c20 2270 7172 225d  ", "mno", "pqr"]
+0002ee10: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0002ee20: 2020 2020 2020 2020 2020 2020 5f77 2e61              _w.a
+0002ee30: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+0002ee40: 655f 7769 7468 2822 496e 7661 6c69 6420  e_with("Invalid 
+0002ee50: 2763 6f6e 7465 6e74 2720 696e 2073 6561  'content' in sea
+0002ee60: 7263 683a 2027 6e65 7727 2028 4d61 726b  rch: 'new' (Mark
+0002ee70: 7329 2229 0a20 2020 2020 2020 2020 2020  s)").           
+0002ee80: 205f 772e 7265 7365 745f 6d6f 636b 2829   _w.reset_mock()
+0002ee90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002eea0: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+0002eeb0: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+0002eec0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+0002eed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002eee0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0002eef0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+0002ef00: 223a 2022 4d61 726b 7322 2c0a 2020 2020  ": "Marks",.    
+0002ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef20: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+0002ef30: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002ef40: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
+0002ef50: 6174 6f72 223a 2022 3d22 2c0a 2020 2020  ator": "=",.    
+0002ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef70: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
+0002ef80: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002ef90: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
+0002efa0: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
+0002efb0: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+0002efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002efd0: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
+0002efe0: 2020 2020 2020 2020 2020 2020 5f77 2e61              _w.a
+0002eff0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+0002f000: 655f 7769 7468 2822 496e 7661 6c69 6420  e_with("Invalid 
+0002f010: 2763 6f6e 7465 6e74 2720 696e 2073 6561  'content' in sea
+0002f020: 7263 683a 2027 5b5d 2720 284d 6172 6b73  rch: '[]' (Marks
+0002f030: 2922 290a 2020 2020 2020 2020 2020 2020  )").            
+0002f040: 5f77 2e72 6573 6574 5f6d 6f63 6b28 290a  _w.reset_mock().
+0002f050: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002f060: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+0002f070: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
+0002f080: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+0002f090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f0a0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0002f0b0: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+0002f0c0: 3a20 224d 6172 6b73 222c 0a20 2020 2020  : "Marks",.     
 0002f0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f0e0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0002f0f0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-0002f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f110: 2274 7970 6522 3a20 224d 6172 6b73 222c  "type": "Marks",
-0002f120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f130: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-0002f140: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-0002f150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f160: 226f 7065 7261 746f 7222 3a20 223d 222c  "operator": "=",
-0002f170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f180: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
-0002f190: 7422 3a20 5b31 2c20 325d 2c0a 2020 2020  t": [1, 2],.    
-0002f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f1b0: 2020 2020 2266 6965 6c64 223a 204e 6f6e      "field": Non
-0002f1c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0002f1d0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0002f1e0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-0002f1f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002f200: 2020 2020 205f 772e 6173 7365 7274 5f63       _w.assert_c
-0002f210: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-0002f220: 2249 6e76 616c 6964 2027 636f 6e74 656e  "Invalid 'conten
-0002f230: 7427 2069 6e20 7365 6172 6368 3a20 275b  t' in search: '[
-0002f240: 312c 2032 5d27 2028 4d61 726b 7329 2229  1, 2]' (Marks)")
-0002f250: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0002f260: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0002f270: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
-0002f280: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002f290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f2a0: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-0002f2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f2c0: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-0002f2d0: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-0002f2e0: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-0002f2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f300: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002f310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f320: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+0002f0e0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+0002f0f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002f100: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+0002f110: 746f 7222 3a20 223d 222c 0a20 2020 2020  tor": "=",.     
+0002f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f130: 2020 2022 636f 6e74 656e 7422 3a20 5b31     "content": [1
+0002f140: 2c20 325d 2c0a 2020 2020 2020 2020 2020  , 2],.          
+0002f150: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+0002f160: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
+0002f170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f180: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+0002f190: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+0002f1a0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
+0002f1b0: 772e 6173 7365 7274 5f63 616c 6c65 645f  w.assert_called_
+0002f1c0: 6f6e 6365 5f77 6974 6828 2249 6e76 616c  once_with("Inval
+0002f1d0: 6964 2027 636f 6e74 656e 7427 2069 6e20  id 'content' in 
+0002f1e0: 7365 6172 6368 3a20 275b 312c 2032 5d27  search: '[1, 2]'
+0002f1f0: 2028 4d61 726b 7329 2229 0a20 2020 2020   (Marks)").     
+0002f200: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0002f210: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0002f220: 2073 6f72 7465 6428 0a20 2020 2020 2020   sorted(.       
+0002f230: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002f240: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002f250: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+0002f260: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002f270: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+0002f280: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+0002f290: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+0002f2a0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+0002f2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f2c0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+0002f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f2e0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0002f2f0: 7970 6522 3a20 224d 6172 6b73 222c 0a20  ype": "Marks",. 
+0002f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f310: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002f320: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
 0002f330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f340: 2020 2020 2274 7970 6522 3a20 224d 6172      "type": "Mar
-0002f350: 6b73 222c 0a20 2020 2020 2020 2020 2020  ks",.           
-0002f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f370: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-0002f380: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-0002f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f3a0: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-0002f3b0: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
-0002f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f3d0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-0002f3e0: 3a20 5b22 696d 7022 5d2c 0a20 2020 2020  : ["imp"],.     
-0002f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f400: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
-0002f410: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
-0002f420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f430: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0002f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f450: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002f460: 2020 2020 2020 292e 6c61 7374 4665 7463        ).lastFetc
-0002f470: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
-0002f480: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-0002f490: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-0002f4a0: 205b 226d 6e6f 225d 2c0a 2020 2020 2020   ["mno"],.      
-0002f4b0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0002f4c0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0002f4d0: 2020 2020 2020 2020 2020 736f 7274 6564            sorted
-0002f4e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002f4f0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-0002f500: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
-0002f510: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
-0002f520: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
-0002f530: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0002f540: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
-0002f550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f560: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0002f340: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002f350: 7065 7261 746f 7222 3a20 2261 6263 222c  perator": "abc",
+0002f360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f380: 2022 636f 6e74 656e 7422 3a20 5b22 696d   "content": ["im
+0002f390: 7022 5d2c 0a20 2020 2020 2020 2020 2020  p"],.           
+0002f3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3b0: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
+0002f3c0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0002f3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3e0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+0002f3f0: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+0002f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f410: 292e 6c61 7374 4665 7463 6865 640a 2020  ).lastFetched.  
+0002f420: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+0002f430: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0002f440: 2020 2020 2020 2020 2020 205b 226d 6e6f             ["mno
+0002f450: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
+0002f460: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0002f470: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0002f480: 2020 2020 736f 7274 6564 280a 2020 2020      sorted(.    
+0002f490: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+0002f4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4b0: 2020 655b 2262 6962 6b65 7922 5d0a 2020    e["bibkey"].  
+0002f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4d0: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
+0002f4e0: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
+0002f4f0: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
+0002f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f510: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0002f520: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0002f530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f550: 2022 7479 7065 223a 2022 4d61 726b 7322   "type": "Marks"
+0002f560: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 0002f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f580: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-0002f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f5a0: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
-0002f5b0: 4d61 726b 7322 2c0a 2020 2020 2020 2020  Marks",.        
-0002f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f5d0: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
-0002f5e0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-0002f5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f600: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-0002f610: 223a 2022 6c69 6b65 222c 0a20 2020 2020  ": "like",.     
-0002f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f630: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-0002f640: 656e 7422 3a20 5b22 696d 7022 5d2c 0a20  ent": ["imp"],. 
+0002f580: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
+0002f590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f5b0: 2022 6f70 6572 6174 6f72 223a 2022 6c69   "operator": "li
+0002f5c0: 6b65 222c 0a20 2020 2020 2020 2020 2020  ke",.           
+0002f5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f5e0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+0002f5f0: 5b22 696d 7022 5d2c 0a20 2020 2020 2020  ["imp"],.       
+0002f600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f610: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
+0002f620: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+0002f630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f640: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
 0002f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f660: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002f670: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
-0002f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f690: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+0002f660: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+0002f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f680: 2020 2020 2022 7479 7065 223a 2022 4d61       "type": "Ma
+0002f690: 726b 7322 2c0a 2020 2020 2020 2020 2020  rks",.          
 0002f6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6b0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-0002f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6d0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-0002f6e0: 223a 2022 4d61 726b 7322 2c0a 2020 2020  ": "Marks",.    
-0002f6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f700: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-0002f710: 6963 616c 223a 2022 6f72 222c 0a20 2020  ical": "or",.   
-0002f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f730: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
-0002f740: 6572 6174 6f72 223a 2022 6c69 6b65 222c  erator": "like",
-0002f750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f6b0: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+0002f6c0: 2022 6f72 222c 0a20 2020 2020 2020 2020   "or",.         
+0002f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f6e0: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
+0002f6f0: 223a 2022 6c69 6b65 222c 0a20 2020 2020  ": "like",.     
+0002f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f710: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
+0002f720: 656e 7422 3a20 5b22 6661 7622 5d2c 0a20  ent": ["fav"],. 
+0002f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f740: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002f750: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
 0002f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f770: 2022 636f 6e74 656e 7422 3a20 5b22 6661   "content": ["fa
-0002f780: 7622 5d2c 0a20 2020 2020 2020 2020 2020  v"],.           
-0002f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f7a0: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
-0002f7b0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0002f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f7d0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0002f7e0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-0002f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f800: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
-0002f810: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0002f820: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-0002f830: 2020 2020 2020 2020 2020 2020 5b22 6d6e              ["mn
-0002f840: 6f22 2c20 2270 7172 225d 2c0a 2020 2020  o", "pqr"],.    
-0002f850: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0002f860: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0002f870: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-0002f880: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-0002f890: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0002f8a0: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
-0002f8b0: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
-0002f8c0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-0002f8d0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-0002f8e0: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-0002f8f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f900: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0002f770: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+0002f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f790: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+0002f7a0: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
+0002f7b0: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
+0002f7c0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+0002f7d0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+0002f7e0: 2020 2020 2020 5b22 6d6e 6f22 2c20 2270        ["mno", "p
+0002f7f0: 7172 225d 2c0a 2020 2020 2020 2020 290a  qr"],.        ).
+0002f800: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0002f810: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0002f820: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
+0002f830: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+0002f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f850: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+0002f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f870: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+0002f880: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+0002f890: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+0002f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8b0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+0002f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8d0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0002f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8f0: 2020 2022 7479 7065 223a 2022 4d61 726b     "type": "Mark
+0002f900: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
 0002f910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f920: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-0002f930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f940: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-0002f950: 2022 4d61 726b 7322 2c0a 2020 2020 2020   "Marks",.      
-0002f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f970: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-0002f980: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
-0002f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9a0: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-0002f9b0: 6f72 223a 2022 6c69 6b65 222c 0a20 2020  or": "like",.   
-0002f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9d0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-0002f9e0: 6e74 656e 7422 3a20 5b22 696d 7022 5d2c  ntent": ["imp"],
-0002f9f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa10: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
-0002fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa30: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0002f920: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+0002f930: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f950: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+0002f960: 6c69 6b65 222c 0a20 2020 2020 2020 2020  like",.         
+0002f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f980: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+0002f990: 3a20 5b22 696d 7022 5d2c 0a20 2020 2020  : ["imp"],.     
+0002f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f9b0: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
+0002f9c0: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
+0002f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f9e0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0002f9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa00: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+0002fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa20: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
+0002fa30: 4d61 726b 7322 2c0a 2020 2020 2020 2020  Marks",.        
 0002fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa50: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-0002fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa70: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-0002fa80: 7065 223a 2022 4d61 726b 7322 2c0a 2020  pe": "Marks",.  
-0002fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002faa0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-0002fab0: 6f67 6963 616c 223a 2022 616e 6422 2c0a  ogical": "and",.
-0002fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fae0: 226f 7065 7261 746f 7222 3a20 226c 696b  "operator": "lik
-0002faf0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0002fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb10: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
-0002fb20: 2266 6176 225d 2c0a 2020 2020 2020 2020  "fav"],.        
-0002fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb40: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-0002fb50: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0002fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb70: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-0002fb80: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-0002fb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fba0: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
-0002fbb0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0002fbc0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-0002fbd0: 292c 0a20 2020 2020 2020 2020 2020 205b  ),.            [
-0002fbe0: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-0002fbf0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0002fc00: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0002fc10: 2020 2073 6f72 7465 6428 0a20 2020 2020     sorted(.     
-0002fc20: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-0002fc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fc40: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+0002fa50: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
+0002fa60: 223a 2022 616e 6422 2c0a 2020 2020 2020  ": "and",.      
+0002fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fa80: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+0002fa90: 746f 7222 3a20 226c 696b 6522 2c0a 2020  tor": "like",.  
+0002faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fab0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+0002fac0: 6f6e 7465 6e74 223a 205b 2266 6176 225d  ontent": ["fav"]
+0002fad0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002faf0: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
+0002fb00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fb10: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+0002fb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fb30: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+0002fb40: 2020 2020 2020 2020 2020 2020 2020 292e                ).
+0002fb50: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
+0002fb60: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0002fb70: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0002fb80: 2020 2020 2020 2020 205b 5d2c 0a20 2020           [],.   
+0002fb90: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0002fba0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0002fbb0: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
+0002fbc0: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
+0002fbd0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+0002fbe0: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
+0002fbf0: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
+0002fc00: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0002fc10: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+0002fc20: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
+0002fc30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002fc40: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
 0002fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fc60: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-0002fc70: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
-0002fc80: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
-0002fc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fca0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0002fcb0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-0002fcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc60: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0002fc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc80: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+0002fc90: 3a20 224d 6172 6b73 222c 0a20 2020 2020  : "Marks",.     
+0002fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fcb0: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+0002fcc0: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
 0002fcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fce0: 2274 7970 6522 3a20 224d 6172 6b73 222c  "type": "Marks",
-0002fcf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fce0: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+0002fcf0: 746f 7222 3a20 226c 696b 6522 2c0a 2020  tor": "like",.  
 0002fd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd10: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
-0002fd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd40: 226f 7065 7261 746f 7222 3a20 226c 696b  "operator": "lik
-0002fd50: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0002fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fd70: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
-0002fd80: 226e 6577 225d 2c0a 2020 2020 2020 2020  "new"],.        
-0002fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fda0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-0002fdb0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0002fdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fdd0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-0002fde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fdf0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-0002fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fe10: 2020 2020 2274 7970 6522 3a20 224d 6172      "type": "Mar
-0002fe20: 6b73 222c 0a20 2020 2020 2020 2020 2020  ks",.           
-0002fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fe40: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-0002fe50: 2261 6e64 222c 0a20 2020 2020 2020 2020  "and",.         
-0002fe60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fe70: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-0002fe80: 223a 2022 6c69 6b65 222c 0a20 2020 2020  ": "like",.     
-0002fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fea0: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-0002feb0: 656e 7422 3a20 5b22 6661 7622 5d2c 0a20  ent": ["fav"],. 
-0002fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fed0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002fee0: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
-0002fef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff00: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-0002ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff20: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-0002ff30: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
-0002ff40: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-0002ff50: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-0002ff60: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0002ff70: 2020 2020 2020 5b22 7071 7222 5d2c 0a20        ["pqr"],. 
-0002ff80: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002ff90: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0002ffa0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-0002ffb0: 6f72 7465 6428 0a20 2020 2020 2020 2020  orted(.         
-0002ffc0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-0002ffd0: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
-0002ffe0: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
-0002fff0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00030000: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00030010: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
-00030020: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-00030030: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+0002fd10: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+0002fd20: 6f6e 7465 6e74 223a 205b 226e 6577 225d  ontent": ["new"]
+0002fd30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd50: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
+0002fd60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fd70: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+0002fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fd90: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+0002fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fdb0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0002fdc0: 7970 6522 3a20 224d 6172 6b73 222c 0a20  ype": "Marks",. 
+0002fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fde0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002fdf0: 6c6f 6769 6361 6c22 3a20 2261 6e64 222c  logical": "and",
+0002fe00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe20: 2022 6f70 6572 6174 6f72 223a 2022 6c69   "operator": "li
+0002fe30: 6b65 222c 0a20 2020 2020 2020 2020 2020  ke",.           
+0002fe40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe50: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+0002fe60: 5b22 6661 7622 5d2c 0a20 2020 2020 2020  ["fav"],.       
+0002fe70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe80: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
+0002fe90: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+0002fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002feb0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+0002fec0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+0002fed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fee0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+0002fef0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+0002ff00: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+0002ff10: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0002ff20: 5b22 7071 7222 5d2c 0a20 2020 2020 2020  ["pqr"],.       
+0002ff30: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+0002ff40: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0002ff50: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
+0002ff60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ff70: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0002ff80: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
+0002ff90: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+0002ffa0: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
+0002ffb0: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+0002ffc0: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
+0002ffd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ffe0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+0002fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030000: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00030010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030020: 2020 2020 2020 2274 7970 6522 3a20 224d        "type": "M
+00030030: 6172 6b73 222c 0a20 2020 2020 2020 2020  arks",.         
 00030040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030050: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00030060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030070: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00030080: 6522 3a20 224d 6172 6b73 222c 0a20 2020  e": "Marks",.   
-00030090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000300a0: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-000300b0: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
-000300c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000300d0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
-000300e0: 7261 746f 7222 3a20 226c 696b 6522 2c0a  rator": "like",.
-000300f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030050: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+00030060: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00030070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030080: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
+00030090: 3a20 226c 696b 6522 2c0a 2020 2020 2020  : "like",.      
+000300a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300b0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+000300c0: 6e74 223a 205b 2261 6e79 225d 2c0a 2020  nt": ["any"],.  
+000300d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300e0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+000300f0: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
 00030100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030110: 2263 6f6e 7465 6e74 223a 205b 2261 6e79  "content": ["any
-00030120: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-00030130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030140: 2020 2020 2266 6965 6c64 223a 204e 6f6e      "field": Non
-00030150: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00030160: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00030170: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00030180: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00030190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030110: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+00030120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030130: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00030140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030150: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+00030160: 3a20 224d 6172 6b73 222c 0a20 2020 2020  : "Marks",.     
+00030170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030180: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+00030190: 6361 6c22 3a20 2261 6e64 222c 0a20 2020  cal": "and",.   
 000301a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301b0: 2274 7970 6522 3a20 224d 6172 6b73 222c  "type": "Marks",
-000301c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000301d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301e0: 2022 6c6f 6769 6361 6c22 3a20 2261 6e64   "logical": "and
-000301f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00030200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030210: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-00030220: 6c69 6b65 222c 0a20 2020 2020 2020 2020  like",.         
-00030230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030240: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-00030250: 3a20 5b22 696d 7022 5d2c 0a20 2020 2020  : ["imp"],.     
-00030260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030270: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
-00030280: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
-00030290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000302a0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-000302b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000302c0: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
-000302d0: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
-000302e0: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
-000302f0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00030300: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-00030310: 2020 5b22 6d6e 6f22 5d2c 0a20 2020 2020    ["mno"],.     
-00030320: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00030330: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00030340: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
-00030350: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-00030360: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00030370: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
-00030380: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
-00030390: 2020 2020 2020 2020 2066 6f72 2065 2069           for e i
-000303a0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-000303b0: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
-000303c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000303d0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+000301b0: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+000301c0: 6572 6174 6f72 223a 2022 6c69 6b65 222c  erator": "like",
+000301d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000301e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000301f0: 2022 636f 6e74 656e 7422 3a20 5b22 696d   "content": ["im
+00030200: 7022 5d2c 0a20 2020 2020 2020 2020 2020  p"],.           
+00030210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030220: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
+00030230: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00030240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030250: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00030260: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00030270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030280: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
+00030290: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+000302a0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+000302b0: 2020 2020 2020 2020 2020 2020 5b22 6d6e              ["mn
+000302c0: 6f22 5d2c 0a20 2020 2020 2020 2029 0a20  o"],.        ). 
+000302d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000302e0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000302f0: 2020 2020 2073 6f72 7465 6428 0a20 2020       sorted(.   
+00030300: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+00030310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030320: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
+00030330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030340: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
+00030350: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+00030360: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
+00030370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030380: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+00030390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000303a0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000303b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000303c0: 2020 2274 7970 6522 3a20 224d 6172 6b73    "type": "Marks
+000303d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 000303e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000303f0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-00030400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030410: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-00030420: 224d 6172 6b73 222c 0a20 2020 2020 2020  "Marks",.       
-00030430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030440: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00030450: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-00030460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030470: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-00030480: 7222 3a20 2221 3d22 2c0a 2020 2020 2020  r": "!=",.      
-00030490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000304a0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-000304b0: 6e74 223a 205b 226e 6577 225d 2c0a 2020  nt": ["new"],.  
-000304c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000304d0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-000304e0: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
-000304f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030500: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00030510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030520: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00030530: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
-00030540: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
-00030550: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00030560: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00030570: 2020 2020 5b22 6162 6322 2c20 2264 6566      ["abc", "def
-00030580: 222c 2022 6768 6922 2c20 226d 6e6f 222c  ", "ghi", "mno",
-00030590: 2022 7071 7222 5d2c 0a20 2020 2020 2020   "pqr"],.       
-000305a0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-000305b0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-000305c0: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
-000305d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000305e0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-000305f0: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00030600: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00030610: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
-00030620: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-00030630: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
-00030640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030650: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+000303f0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+00030400: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00030410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030420: 2020 226f 7065 7261 746f 7222 3a20 2221    "operator": "!
+00030430: 3d22 2c0a 2020 2020 2020 2020 2020 2020  =",.            
+00030440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030450: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
+00030460: 226e 6577 225d 2c0a 2020 2020 2020 2020  "new"],.        
+00030470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030480: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+00030490: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+000304a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000304b0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+000304c0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+000304d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000304e0: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
+000304f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030500: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
+00030510: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+00030520: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
+00030530: 6922 2c20 226d 6e6f 222c 2022 7071 7222  i", "mno", "pqr"
+00030540: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00030550: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00030560: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00030570: 2020 2073 6f72 7465 6428 0a20 2020 2020     sorted(.     
+00030580: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+00030590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000305a0: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+000305b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000305c0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+000305d0: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
+000305e0: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
+000305f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030600: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00030610: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+00030620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030640: 2274 7970 6522 3a20 224d 6172 6b73 222c  "type": "Marks",
+00030650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00030660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030670: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00030670: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
 00030680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030690: 2020 2020 2020 2274 7970 6522 3a20 224d        "type": "M
-000306a0: 6172 6b73 222c 0a20 2020 2020 2020 2020  arks",.         
-000306b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000306c0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-000306d0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-000306e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000306f0: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
-00030700: 3a20 226c 696b 6522 2c0a 2020 2020 2020  : "like",.      
-00030710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030720: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-00030730: 6e74 223a 205b 2261 6e79 225d 2c0a 2020  nt": ["any"],.  
+00030690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000306a0: 226f 7065 7261 746f 7222 3a20 226c 696b  "operator": "lik
+000306b0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+000306c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000306d0: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
+000306e0: 2261 6e79 225d 2c0a 2020 2020 2020 2020  "any"],.        
+000306f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030700: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+00030710: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00030720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030730: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
 00030740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030750: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00030760: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
-00030770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030780: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+00030750: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00030760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030770: 2020 2020 2274 7970 6522 3a20 2243 6174      "type": "Cat
+00030780: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
 00030790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000307a0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-000307b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000307c0: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-000307d0: 3a20 2243 6174 6567 6f72 6965 7322 2c0a  : "Categories",.
-000307e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000307a0: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+000307b0: 616c 223a 2022 616e 6422 2c0a 2020 2020  al": "and",.    
+000307c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000307d0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+000307e0: 7261 746f 7222 3a20 226c 696b 6522 2c0a  rator": "like",.
 000307f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030800: 226c 6f67 6963 616c 223a 2022 616e 6422  "logical": "and"
-00030810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00030800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030810: 2263 6f6e 7465 6e74 223a 205b 325d 2c0a  "content": [2],.
 00030820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030830: 2020 226f 7065 7261 746f 7222 3a20 226c    "operator": "l
-00030840: 696b 6522 2c0a 2020 2020 2020 2020 2020  ike",.          
+00030830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030840: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
 00030850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030860: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-00030870: 205b 325d 2c0a 2020 2020 2020 2020 2020   [2],.          
-00030880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030890: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
-000308a0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-000308b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000308c0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-000308d0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-000308e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000308f0: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
-00030900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030910: 5d0a 2020 2020 2020 2020 2020 2020 292c  ].            ),
-00030920: 0a20 2020 2020 2020 2020 2020 205b 226d  .            ["m
-00030930: 6e6f 225d 2c0a 2020 2020 2020 2020 290a  no"],.        ).
-00030940: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00030950: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00030960: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
-00030970: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
-00030980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030990: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+00030860: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00030870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030880: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+00030890: 2020 2020 2020 2020 2020 2020 292e 6c61              ).la
+000308a0: 7374 4665 7463 6865 640a 2020 2020 2020  stFetched.      
+000308b0: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+000308c0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+000308d0: 2020 2020 2020 205b 226d 6e6f 225d 2c0a         ["mno"],.
+000308e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000308f0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00030900: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00030910: 736f 7274 6564 280a 2020 2020 2020 2020  sorted(.        
+00030920: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00030930: 2020 2020 2020 2020 2020 2020 2020 655b                e[
+00030940: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
+00030950: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00030960: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00030970: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
+00030980: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
+00030990: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
 000309a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000309b0: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
-000309c0: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-000309d0: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
-000309e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000309f0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+000309b0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+000309c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000309d0: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+000309e0: 7065 223a 2022 4361 7465 676f 7269 6573  pe": "Categories
+000309f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 00030a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a10: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00030a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a30: 2020 2022 7479 7065 223a 2022 4361 7465     "type": "Cate
-00030a40: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
-00030a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a60: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00030a70: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-00030a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a90: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-00030aa0: 7222 3a20 226c 696b 6522 2c0a 2020 2020  r": "like",.    
-00030ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ac0: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-00030ad0: 7465 6e74 223a 205b 325d 2c0a 2020 2020  tent": [2],.    
+00030a10: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+00030a20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00030a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a40: 2020 226f 7065 7261 746f 7222 3a20 226c    "operator": "l
+00030a50: 696b 6522 2c0a 2020 2020 2020 2020 2020  ike",.          
+00030a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a70: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+00030a80: 205b 325d 2c0a 2020 2020 2020 2020 2020   [2],.          
+00030a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030aa0: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
+00030ab0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00030ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ad0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
 00030ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030af0: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-00030b00: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
-00030b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b20: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00030af0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00030b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030b10: 2020 2274 7970 6522 3a20 224d 6172 6b73    "type": "Marks
+00030b20: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 00030b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b40: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-00030b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b60: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-00030b70: 224d 6172 6b73 222c 0a20 2020 2020 2020  "Marks",.       
-00030b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b90: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00030ba0: 6c22 3a20 2261 6e64 222c 0a20 2020 2020  l": "and",.     
-00030bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030bc0: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
-00030bd0: 6174 6f72 223a 2022 6c69 6b65 222c 0a20  ator": "like",. 
-00030be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030bf0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00030c00: 636f 6e74 656e 7422 3a20 5b22 616e 7922  content": ["any"
-00030c10: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00030c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030c30: 2020 2022 6669 656c 6422 3a20 4e6f 6e65     "field": None
-00030c40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00030c50: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-00030c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030c70: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-00030c80: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00030c90: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
-00030ca0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-00030cb0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-00030cc0: 2020 2020 2020 2020 2020 5b22 6d6e 6f22            ["mno"
-00030cd0: 5d2c 0a20 2020 2020 2020 2029 0a0a 2020  ],.        )..  
-00030ce0: 2020 2020 2020 2320 7465 7374 2074 7970        # test typ
-00030cf0: 650a 2020 2020 2020 2020 7365 6c66 2e70  e.        self.p
-00030d00: 4244 422e 6269 6273 2e73 6574 426f 6f6b  BDB.bibs.setBook
-00030d10: 2822 6162 6322 2c20 3129 0a20 2020 2020  ("abc", 1).     
-00030d20: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00030d30: 732e 7365 7442 6f6f 6b28 2264 6566 222c  s.setBook("def",
-00030d40: 2031 290a 2020 2020 2020 2020 7365 6c66   1).        self
-00030d50: 2e70 4244 422e 6269 6273 2e73 6574 4c65  .pBDB.bibs.setLe
-00030d60: 6374 7572 6528 2264 6566 222c 2031 290a  cture("def", 1).
-00030d70: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00030d80: 422e 6269 6273 2e73 6574 5265 7669 6577  B.bibs.setReview
-00030d90: 2822 6768 6922 2c20 3129 0a20 2020 2020  ("ghi", 1).     
-00030da0: 2020 2077 6974 6820 7061 7463 6828 226c     with patch("l
-00030db0: 6f67 6769 6e67 2e4c 6f67 6765 722e 7761  ogging.Logger.wa
-00030dc0: 726e 696e 6722 2920 6173 205f 773a 0a20  rning") as _w:. 
-00030dd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00030de0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00030df0: 2020 2020 2020 2020 2020 2020 2073 6f72               sor
-00030e00: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
-00030e10: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-00030e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030e30: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
-00030e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030e50: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
-00030e60: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-00030e70: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
-00030e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030e90: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00030b40: 2020 2022 6c6f 6769 6361 6c22 3a20 2261     "logical": "a
+00030b50: 6e64 222c 0a20 2020 2020 2020 2020 2020  nd",.           
+00030b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030b70: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
+00030b80: 2022 6c69 6b65 222c 0a20 2020 2020 2020   "like",.       
+00030b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ba0: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
+00030bb0: 7422 3a20 5b22 616e 7922 5d2c 0a20 2020  t": ["any"],.   
+00030bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030bd0: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
+00030be0: 656c 6422 3a20 4e6f 6e65 2c0a 2020 2020  eld": None,.    
+00030bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030c00: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00030c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030c20: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+00030c30: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
+00030c40: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
+00030c50: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+00030c60: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00030c70: 2020 2020 5b22 6d6e 6f22 5d2c 0a20 2020      ["mno"],.   
+00030c80: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00030c90: 2320 7465 7374 2074 7970 650a 2020 2020  # test type.    
+00030ca0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00030cb0: 6273 2e73 6574 426f 6f6b 2822 6162 6322  bs.setBook("abc"
+00030cc0: 2c20 3129 0a20 2020 2020 2020 2073 656c  , 1).        sel
+00030cd0: 662e 7042 4442 2e62 6962 732e 7365 7442  f.pBDB.bibs.setB
+00030ce0: 6f6f 6b28 2264 6566 222c 2031 290a 2020  ook("def", 1).  
+00030cf0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00030d00: 6269 6273 2e73 6574 4c65 6374 7572 6528  bibs.setLecture(
+00030d10: 2264 6566 222c 2031 290a 2020 2020 2020  "def", 1).      
+00030d20: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00030d30: 2e73 6574 5265 7669 6577 2822 6768 6922  .setReview("ghi"
+00030d40: 2c20 3129 0a20 2020 2020 2020 2077 6974  , 1).        wit
+00030d50: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
+00030d60: 2e4c 6f67 6765 722e 7761 726e 696e 6722  .Logger.warning"
+00030d70: 2920 6173 205f 773a 0a20 2020 2020 2020  ) as _w:.       
+00030d80: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00030d90: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00030da0: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
+00030db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030dc0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00030dd0: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
+00030de0: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
+00030df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e00: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+00030e10: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
+00030e20: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
+00030e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e40: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+00030e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e60: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00030e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030e80: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+00030e90: 6522 3a20 2254 7970 6522 2c0a 2020 2020  e": "Type",.    
 00030ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030eb0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00030ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ec0: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
 00030ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ee0: 2020 2274 7970 6522 3a20 2254 7970 6522    "type": "Type"
-00030ef0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00030f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030f10: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-00030f20: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00030f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030f40: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-00030f50: 6f72 223a 2022 3d22 2c0a 2020 2020 2020  or": "=",.      
-00030f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030f70: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00030f80: 6f6e 7465 6e74 223a 2022 6e65 7722 2c0a  ontent": "new",.
+00030ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030ef0: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+00030f00: 3d22 2c0a 2020 2020 2020 2020 2020 2020  =",.            
+00030f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f20: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
+00030f30: 223a 2022 6e65 7722 2c0a 2020 2020 2020  ": "new",.      
+00030f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f50: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+00030f60: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
+00030f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030f80: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
 00030f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030fb0: 2020 2020 2266 6965 6c64 223a 204e 6f6e      "field": Non
-00030fc0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00030fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030fe0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-00030ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031000: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
-00031010: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
-00031020: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-00031030: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-00031040: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00031050: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00031060: 2020 5b22 6162 6322 2c20 2264 6566 222c    ["abc", "def",
-00031070: 2022 6768 6922 2c20 226a 6b6c 222c 2022   "ghi", "jkl", "
-00031080: 6d6e 6f22 2c20 2270 7172 225d 2c0a 2020  mno", "pqr"],.  
-00031090: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000310a0: 2020 2020 2020 2020 5f77 2e61 7373 6572          _w.asser
-000310b0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-000310c0: 7468 2822 496e 7661 6c69 6420 2763 6f6e  th("Invalid 'con
-000310d0: 7465 6e74 2720 696e 2073 6561 7263 683a  tent' in search:
-000310e0: 2027 6e65 7727 2028 5479 7065 2922 290a   'new' (Type)").
-000310f0: 2020 2020 2020 2020 2020 2020 5f77 2e72              _w.r
-00031100: 6573 6574 5f6d 6f63 6b28 290a 2020 2020  eset_mock().    
-00031110: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00031120: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
-00031130: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
-00031140: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-00031150: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00031160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031170: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
-00031180: 7970 6522 2c0a 2020 2020 2020 2020 2020  ype",.          
-00031190: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-000311a0: 6f67 6963 616c 223a 2022 222c 0a20 2020  ogical": "",.   
-000311b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000311c0: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-000311d0: 2022 3d22 2c0a 2020 2020 2020 2020 2020   "=",.          
-000311e0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-000311f0: 6f6e 7465 6e74 223a 205b 5d2c 0a20 2020  ontent": [],.   
-00031200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031210: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
-00031220: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00031230: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00031240: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-00031250: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00031260: 2020 2020 2020 5f77 2e61 7373 6572 745f        _w.assert_
-00031270: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-00031280: 2822 496e 7661 6c69 6420 2763 6f6e 7465  ("Invalid 'conte
-00031290: 6e74 2720 696e 2073 6561 7263 683a 2027  nt' in search: '
-000312a0: 5b5d 2720 2854 7970 6529 2229 0a20 2020  []' (Type)").   
-000312b0: 2020 2020 2020 2020 205f 772e 7265 7365           _w.rese
-000312c0: 745f 6d6f 636b 2829 0a20 2020 2020 2020  t_mock().       
-000312d0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000312e0: 6962 732e 6665 7463 6846 726f 6d44 6963  ibs.fetchFromDic
-000312f0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00031300: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00031310: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-00031320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031330: 2020 2022 7479 7065 223a 2022 5479 7065     "type": "Type
-00031340: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00031350: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
-00031360: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
+00030fa0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00030fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030fc0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+00030fd0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+00030fe0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+00030ff0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+00031000: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+00031010: 6322 2c20 2264 6566 222c 2022 6768 6922  c", "def", "ghi"
+00031020: 2c20 226a 6b6c 222c 2022 6d6e 6f22 2c20  , "jkl", "mno", 
+00031030: 2270 7172 225d 2c0a 2020 2020 2020 2020  "pqr"],.        
+00031040: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00031050: 2020 5f77 2e61 7373 6572 745f 6361 6c6c    _w.assert_call
+00031060: 6564 5f6f 6e63 655f 7769 7468 2822 496e  ed_once_with("In
+00031070: 7661 6c69 6420 2763 6f6e 7465 6e74 2720  valid 'content' 
+00031080: 696e 2073 6561 7263 683a 2027 6e65 7727  in search: 'new'
+00031090: 2028 5479 7065 2922 290a 2020 2020 2020   (Type)").      
+000310a0: 2020 2020 2020 5f77 2e72 6573 6574 5f6d        _w.reset_m
+000310b0: 6f63 6b28 290a 2020 2020 2020 2020 2020  ock().          
+000310c0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+000310d0: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
+000310e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000310f0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00031100: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00031110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031120: 2274 7970 6522 3a20 2254 7970 6522 2c0a  "type": "Type",.
+00031130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031140: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
+00031150: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+00031160: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00031170: 6f70 6572 6174 6f72 223a 2022 3d22 2c0a  operator": "=",.
+00031180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031190: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
+000311a0: 223a 205b 5d2c 0a20 2020 2020 2020 2020  ": [],.         
+000311b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000311c0: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
+000311d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000311e0: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+000311f0: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+00031200: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00031210: 5f77 2e61 7373 6572 745f 6361 6c6c 6564  _w.assert_called
+00031220: 5f6f 6e63 655f 7769 7468 2822 496e 7661  _once_with("Inva
+00031230: 6c69 6420 2763 6f6e 7465 6e74 2720 696e  lid 'content' in
+00031240: 2073 6561 7263 683a 2027 5b5d 2720 2854   search: '[]' (T
+00031250: 7970 6529 2229 0a20 2020 2020 2020 2020  ype)").         
+00031260: 2020 205f 772e 7265 7365 745f 6d6f 636b     _w.reset_mock
+00031270: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00031280: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
+00031290: 7463 6846 726f 6d44 6963 7428 0a20 2020  tchFromDict(.   
+000312a0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+000312b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000312c0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+000312d0: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+000312e0: 7065 223a 2022 5479 7065 222c 0a20 2020  pe": "Type",.   
+000312f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031300: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
+00031310: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+00031320: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+00031330: 7261 746f 7222 3a20 223d 222c 0a20 2020  rator": "=",.   
+00031340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031350: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+00031360: 5b31 2c20 325d 2c0a 2020 2020 2020 2020  [1, 2],.        
 00031370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031380: 2020 226f 7065 7261 746f 7222 3a20 223d    "operator": "=
-00031390: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000313a0: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-000313b0: 656e 7422 3a20 5b31 2c20 325d 2c0a 2020  ent": [1, 2],.  
-000313c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000313d0: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
-000313e0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-000313f0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00031400: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00031410: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00031420: 2020 2020 2020 205f 772e 6173 7365 7274         _w.assert
-00031430: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-00031440: 6828 2249 6e76 616c 6964 2027 636f 6e74  h("Invalid 'cont
-00031450: 656e 7427 2069 6e20 7365 6172 6368 3a20  ent' in search: 
-00031460: 275b 312c 2032 5d27 2028 5479 7065 2922  '[1, 2]' (Type)"
-00031470: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00031480: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00031490: 2020 2020 2020 2020 736f 7274 6564 280a          sorted(.
-000314a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000314b0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000314c0: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
-000314d0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000314e0: 2020 2020 2020 666f 7220 6520 696e 2073        for e in s
-000314f0: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
-00031500: 7463 6846 726f 6d44 6963 7428 0a20 2020  tchFromDict(.   
-00031510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031520: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00031530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031540: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00031380: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
+00031390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000313a0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+000313b0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+000313c0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+000313d0: 205f 772e 6173 7365 7274 5f63 616c 6c65   _w.assert_calle
+000313e0: 645f 6f6e 6365 5f77 6974 6828 2249 6e76  d_once_with("Inv
+000313f0: 616c 6964 2027 636f 6e74 656e 7427 2069  alid 'content' i
+00031400: 6e20 7365 6172 6368 3a20 275b 312c 2032  n search: '[1, 2
+00031410: 5d27 2028 5479 7065 2922 290a 2020 2020  ]' (Type)").    
+00031420: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00031430: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00031440: 2020 736f 7274 6564 280a 2020 2020 2020    sorted(.      
+00031450: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00031460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031470: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
+00031480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031490: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+000314a0: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
+000314b0: 6d44 6963 7428 0a20 2020 2020 2020 2020  mDict(.         
+000314c0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+000314d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000314e0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+000314f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031500: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00031510: 7479 7065 223a 2022 5479 7065 222c 0a20  type": "Type",. 
+00031520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031530: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00031540: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
 00031550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031560: 2020 2020 2022 7479 7065 223a 2022 5479       "type": "Ty
-00031570: 7065 222c 0a20 2020 2020 2020 2020 2020  pe",.           
-00031580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031590: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-000315a0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-000315b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000315c0: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-000315d0: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
-000315e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000315f0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-00031600: 3a20 5b22 626f 6f6b 225d 2c0a 2020 2020  : ["book"],.    
-00031610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031620: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-00031630: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
-00031640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031650: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00031660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031670: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
-00031680: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
-00031690: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
-000316a0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-000316b0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-000316c0: 2020 5b22 6162 6322 2c20 2264 6566 225d    ["abc", "def"]
-000316d0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-000316e0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-000316f0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00031700: 2020 736f 7274 6564 280a 2020 2020 2020    sorted(.      
-00031710: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00031720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031730: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
+00031560: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+00031570: 7065 7261 746f 7222 3a20 2261 6263 222c  perator": "abc",
+00031580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000315a0: 2022 636f 6e74 656e 7422 3a20 5b22 626f   "content": ["bo
+000315b0: 6f6b 225d 2c0a 2020 2020 2020 2020 2020  ok"],.          
+000315c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000315d0: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
+000315e0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+000315f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031600: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+00031610: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00031620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031630: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
+00031640: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00031650: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00031660: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+00031670: 6322 2c20 2264 6566 225d 2c0a 2020 2020  c", "def"],.    
+00031680: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00031690: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+000316a0: 2020 2020 2020 2020 2020 2020 736f 7274              sort
+000316b0: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
+000316c0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+000316d0: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
+000316e0: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
+000316f0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
+00031700: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
+00031710: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
+00031720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031730: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
 00031740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031750: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-00031760: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
-00031770: 6d44 6963 7428 0a20 2020 2020 2020 2020  mDict(.         
-00031780: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00031790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000317a0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-000317b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000317c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000317d0: 7479 7065 223a 2022 5479 7065 222c 0a20  type": "Type",. 
-000317e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000317f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00031800: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
-00031810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031820: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-00031830: 7065 7261 746f 7222 3a20 2261 6263 222c  perator": "abc",
-00031840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031750: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+00031760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031770: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+00031780: 2022 5479 7065 222c 0a20 2020 2020 2020   "Type",.       
+00031790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000317a0: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
+000317b0: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
+000317c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000317d0: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
+000317e0: 7222 3a20 2261 6263 222c 0a20 2020 2020  r": "abc",.     
+000317f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031800: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
+00031810: 656e 7422 3a20 5b22 626f 6f6b 225d 2c0a  ent": ["book"],.
+00031820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031840: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
 00031850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031860: 2022 636f 6e74 656e 7422 3a20 5b22 626f   "content": ["bo
-00031870: 6f6b 225d 2c0a 2020 2020 2020 2020 2020  ok"],.          
-00031880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031890: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
-000318a0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-000318b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000318c0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-000318d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000318e0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00031860: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00031870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031880: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00031890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000318a0: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+000318b0: 6522 3a20 2254 7970 6522 2c0a 2020 2020  e": "Type",.    
+000318c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000318d0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+000318e0: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
 000318f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031900: 2020 2274 7970 6522 3a20 2254 7970 6522    "type": "Type"
-00031910: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00031900: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
+00031910: 6174 6f72 223a 2022 6162 6322 2c0a 2020  ator": "abc",.  
 00031920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031930: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
-00031940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031960: 2022 6f70 6572 6174 6f72 223a 2022 6162   "operator": "ab
-00031970: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
-00031980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031990: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
-000319a0: 226c 6563 7475 7265 225d 2c0a 2020 2020  "lecture"],.    
-000319b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000319c0: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-000319d0: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
+00031930: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00031940: 6f6e 7465 6e74 223a 205b 226c 6563 7475  ontent": ["lectu
+00031950: 7265 225d 2c0a 2020 2020 2020 2020 2020  re"],.          
+00031960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031970: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
+00031980: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00031990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000319a0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+000319b0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+000319c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000319d0: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
 000319e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000319f0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00031a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031a10: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00031a20: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-00031a30: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
-00031a40: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00031a50: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-00031a60: 2020 205b 2264 6566 225d 2c0a 2020 2020     ["def"],.    
-00031a70: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00031a80: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00031a90: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-00031aa0: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-00031ab0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00031ac0: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
-00031ad0: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
-00031ae0: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-00031af0: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-00031b00: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-00031b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031b20: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+000319f0: 5d0a 2020 2020 2020 2020 2020 2020 292c  ].            ),
+00031a00: 0a20 2020 2020 2020 2020 2020 205b 2264  .            ["d
+00031a10: 6566 225d 2c0a 2020 2020 2020 2020 290a  ef"],.        ).
+00031a20: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00031a30: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00031a40: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
+00031a50: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00031a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031a70: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+00031a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031a90: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+00031aa0: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+00031ab0: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+00031ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ad0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00031ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031af0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00031b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b10: 2020 2022 7479 7065 223a 2022 5479 7065     "type": "Type
+00031b20: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 00031b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b40: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00031b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b60: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-00031b70: 2022 5479 7065 222c 0a20 2020 2020 2020   "Type",.       
-00031b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b90: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00031ba0: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-00031bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031bc0: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-00031bd0: 7222 3a20 2261 6263 222c 0a20 2020 2020  r": "abc",.     
-00031be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031bf0: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-00031c00: 656e 7422 3a20 5b22 626f 6f6b 225d 2c0a  ent": ["book"],.
+00031b40: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+00031b50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00031b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b70: 2020 226f 7065 7261 746f 7222 3a20 2261    "operator": "a
+00031b80: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+00031b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ba0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+00031bb0: 5b22 626f 6f6b 225d 2c0a 2020 2020 2020  ["book"],.      
+00031bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031bd0: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+00031be0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+00031bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c00: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
 00031c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031c30: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
-00031c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031c50: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00031c20: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00031c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c40: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
+00031c50: 7970 6522 2c0a 2020 2020 2020 2020 2020  ype",.          
 00031c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031c70: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00031c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031c90: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00031ca0: 6522 3a20 2254 7970 6522 2c0a 2020 2020  e": "Type",.    
-00031cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031cc0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-00031cd0: 6963 616c 223a 2022 6f72 222c 0a20 2020  ical": "or",.   
-00031ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031cf0: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
-00031d00: 6572 6174 6f72 223a 2022 6162 6322 2c0a  erator": "abc",.
-00031d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031c70: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+00031c80: 2022 6f72 222c 0a20 2020 2020 2020 2020   "or",.         
+00031c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ca0: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
+00031cb0: 223a 2022 6162 6322 2c0a 2020 2020 2020  ": "abc",.      
+00031cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031cd0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+00031ce0: 6e74 223a 205b 2272 6576 6965 7722 5d2c  nt": ["review"],
+00031cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d10: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
 00031d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d30: 2263 6f6e 7465 6e74 223a 205b 2272 6576  "content": ["rev
-00031d40: 6965 7722 5d2c 0a20 2020 2020 2020 2020  iew"],.         
-00031d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d60: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-00031d70: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00031d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031d90: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-00031da0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-00031db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031dc0: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
-00031dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031de0: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
-00031df0: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-00031e00: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
-00031e10: 6922 5d2c 0a20 2020 2020 2020 2029 0a20  i"],.        ). 
-00031e20: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00031e30: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00031e40: 2020 2020 2073 6f72 7465 6428 0a20 2020       sorted(.   
-00031e50: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
-00031e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e70: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
+00031d30: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+00031d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d50: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+00031d60: 2020 2020 2020 2020 2020 2020 2029 2e6c               ).l
+00031d70: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
+00031d80: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00031d90: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+00031da0: 2020 2020 2020 2020 5b22 6162 6322 2c20          ["abc", 
+00031db0: 2264 6566 222c 2022 6768 6922 5d2c 0a20  "def", "ghi"],. 
+00031dc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00031dd0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00031de0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
+00031df0: 6f72 7465 6428 0a20 2020 2020 2020 2020  orted(.         
+00031e00: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00031e10: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
+00031e20: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
+00031e30: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00031e40: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00031e50: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
+00031e60: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00031e70: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
 00031e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e90: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-00031ea0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-00031eb0: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
-00031ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ed0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00031ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ef0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00031e90: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00031ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031eb0: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
+00031ec0: 6522 3a20 2254 7970 6522 2c0a 2020 2020  e": "Type",.    
+00031ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ee0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+00031ef0: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
 00031f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031f10: 2020 2274 7970 6522 3a20 2254 7970 6522    "type": "Type"
-00031f20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00031f10: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
+00031f20: 6174 6f72 223a 2022 6162 6322 2c0a 2020  ator": "abc",.  
 00031f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031f40: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
-00031f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031f70: 2022 6f70 6572 6174 6f72 223a 2022 6162   "operator": "ab
-00031f80: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
-00031f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031fa0: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
-00031fb0: 2262 6f6f 6b22 5d2c 0a20 2020 2020 2020  "book"],.       
-00031fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031fd0: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-00031fe0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-00031ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032000: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-00032010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032020: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-00032030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032040: 2020 2020 2022 7479 7065 223a 2022 5479       "type": "Ty
-00032050: 7065 222c 0a20 2020 2020 2020 2020 2020  pe",.           
-00032060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032070: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-00032080: 2261 6e64 222c 0a20 2020 2020 2020 2020  "and",.         
-00032090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000320a0: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-000320b0: 223a 2022 6162 6322 2c0a 2020 2020 2020  ": "abc",.      
-000320c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000320d0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-000320e0: 6e74 223a 205b 2272 6576 6965 7722 5d2c  nt": ["review"],
-000320f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032110: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
-00032120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032130: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-00032140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032150: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00032160: 2020 2020 2020 2020 2020 2020 2029 2e6c               ).l
-00032170: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
-00032180: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00032190: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-000321a0: 2020 2020 2020 2020 5b5d 2c0a 2020 2020          [],.    
-000321b0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-000321c0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-000321d0: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-000321e0: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-000321f0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00032200: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
-00032210: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
-00032220: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-00032230: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-00032240: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-00032250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032260: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00031f40: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00031f50: 6f6e 7465 6e74 223a 205b 2262 6f6f 6b22  ontent": ["book"
+00031f60: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00031f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f80: 2020 2022 6669 656c 6422 3a20 4e6f 6e65     "field": None
+00031f90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00031fa0: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+00031fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031fc0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+00031fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031fe0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00031ff0: 7479 7065 223a 2022 5479 7065 222c 0a20  type": "Type",. 
+00032000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032010: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00032020: 6c6f 6769 6361 6c22 3a20 2261 6e64 222c  logical": "and",
+00032030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032050: 2022 6f70 6572 6174 6f72 223a 2022 6162   "operator": "ab
+00032060: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
+00032070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032080: 2020 2020 2263 6f6e 7465 6e74 223a 205b      "content": [
+00032090: 2272 6576 6965 7722 5d2c 0a20 2020 2020  "review"],.     
+000320a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000320b0: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
+000320c0: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
+000320d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000320e0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+000320f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032100: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+00032110: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
+00032120: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
+00032130: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00032140: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+00032150: 2020 5b5d 2c0a 2020 2020 2020 2020 290a    [],.        ).
+00032160: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00032170: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00032180: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
+00032190: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+000321a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000321b0: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+000321c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000321d0: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+000321e0: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+000321f0: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+00032200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032210: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00032220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032230: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00032240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032250: 2020 2022 7479 7065 223a 2022 5479 7065     "type": "Type
+00032260: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 00032270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032280: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-00032290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000322a0: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-000322b0: 2022 5479 7065 222c 0a20 2020 2020 2020   "Type",.       
-000322c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000322d0: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-000322e0: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-000322f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032300: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-00032310: 7222 3a20 2261 6263 222c 0a20 2020 2020  r": "abc",.     
-00032320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032330: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-00032340: 656e 7422 3a20 5b22 626f 6f6b 225d 2c0a  ent": ["book"],.
+00032280: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+00032290: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000322a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000322b0: 2020 226f 7065 7261 746f 7222 3a20 2261    "operator": "a
+000322c0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+000322d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000322e0: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+000322f0: 5b22 626f 6f6b 225d 2c0a 2020 2020 2020  ["book"],.      
+00032300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032310: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+00032320: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+00032330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032340: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
 00032350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032370: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
-00032380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032390: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00032360: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00032370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032380: 2020 2020 2020 2274 7970 6522 3a20 224d        "type": "M
+00032390: 6172 6b73 222c 0a20 2020 2020 2020 2020  arks",.         
 000323a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000323b0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-000323c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000323d0: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-000323e0: 6522 3a20 224d 6172 6b73 222c 0a20 2020  e": "Marks",.   
-000323f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032400: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-00032410: 6769 6361 6c22 3a20 226f 7222 2c0a 2020  gical": "or",.  
-00032420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032430: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-00032440: 7065 7261 746f 7222 3a20 2261 6263 222c  perator": "abc",
-00032450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000323b0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+000323c0: 3a20 226f 7222 2c0a 2020 2020 2020 2020  : "or",.        
+000323d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000323e0: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
+000323f0: 7222 3a20 2261 6263 222c 0a20 2020 2020  r": "abc",.     
+00032400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032410: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
+00032420: 656e 7422 3a20 5b22 696d 7022 5d2c 0a20  ent": ["imp"],. 
+00032430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032440: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00032450: 6669 656c 6422 3a20 4e6f 6e65 2c0a 2020  field": None,.  
 00032460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032470: 2022 636f 6e74 656e 7422 3a20 5b22 696d   "content": ["im
-00032480: 7022 5d2c 0a20 2020 2020 2020 2020 2020  p"],.           
-00032490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000324a0: 2020 2020 2022 6669 656c 6422 3a20 4e6f       "field": No
-000324b0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-000324c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000324d0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-000324e0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-000324f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032500: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
-00032510: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00032520: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-00032530: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-00032540: 6322 2c20 2264 6566 222c 2022 6d6e 6f22  c", "def", "mno"
-00032550: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-00032560: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00032570: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00032580: 2020 2073 6f72 7465 6428 0a20 2020 2020     sorted(.     
-00032590: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-000325a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000325b0: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00032470: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00032480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032490: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+000324a0: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
+000324b0: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
+000324c0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+000324d0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+000324e0: 2020 2020 2020 5b22 6162 6322 2c20 2264        ["abc", "d
+000324f0: 6566 222c 2022 6d6e 6f22 5d2c 0a20 2020  ef", "mno"],.   
+00032500: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00032510: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00032520: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
+00032530: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
+00032540: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+00032550: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
+00032560: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
+00032570: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+00032580: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+00032590: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
+000325a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000325b0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
 000325c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000325d0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-000325e0: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
-000325f0: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
-00032600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032610: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00032620: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00032630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000325d0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+000325e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000325f0: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+00032600: 3a20 2254 7970 6522 2c0a 2020 2020 2020  : "Type",.      
+00032610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032620: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+00032630: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
 00032640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032650: 2274 7970 6522 3a20 2254 7970 6522 2c0a  "type": "Type",.
-00032660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032650: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
+00032660: 6f72 223a 2022 6162 6322 2c0a 2020 2020  or": "abc",.    
 00032670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032680: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
-00032690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000326a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000326b0: 6f70 6572 6174 6f72 223a 2022 6162 6322  operator": "abc"
-000326c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00032680: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+00032690: 7465 6e74 223a 205b 2262 6f6f 6b22 5d2c  tent": ["book"],
+000326a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000326b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000326c0: 2022 6669 656c 6422 3a20 4e6f 6e65 2c0a   "field": None,.
 000326d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000326e0: 2020 2263 6f6e 7465 6e74 223a 205b 2262    "content": ["b
-000326f0: 6f6f 6b22 5d2c 0a20 2020 2020 2020 2020  ook"],.         
-00032700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032710: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-00032720: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00032730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032740: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+000326e0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+000326f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032700: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00032710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032720: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+00032730: 7065 223a 2022 4361 7465 676f 7269 6573  pe": "Categories
+00032740: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 00032750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032760: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00032770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032780: 2020 2022 7479 7065 223a 2022 4361 7465     "type": "Cate
-00032790: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
-000327a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000327b0: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-000327c0: 6c22 3a20 2261 6e64 222c 0a20 2020 2020  l": "and",.     
-000327d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000327e0: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
-000327f0: 6174 6f72 223a 2022 6162 6322 2c0a 2020  ator": "abc",.  
-00032800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032810: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00032820: 6f6e 7465 6e74 223a 2031 2c0a 2020 2020  ontent": 1,.    
-00032830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032840: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-00032850: 6c64 223a 204e 6f6e 652c 0a20 2020 2020  ld": None,.     
+00032760: 2020 2022 6c6f 6769 6361 6c22 3a20 2261     "logical": "a
+00032770: 6e64 222c 0a20 2020 2020 2020 2020 2020  nd",.           
+00032780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032790: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
+000327a0: 2022 6162 6322 2c0a 2020 2020 2020 2020   "abc",.        
+000327b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000327c0: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
+000327d0: 223a 2031 2c0a 2020 2020 2020 2020 2020  ": 1,.          
+000327e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000327f0: 2020 2020 2020 2266 6965 6c64 223a 204e        "field": N
+00032800: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00032810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032820: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00032830: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00032840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032850: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
 00032860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032870: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00032880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032890: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-000328a0: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-000328b0: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
-000328c0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-000328d0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-000328e0: 2020 205b 2264 6566 225d 2c0a 2020 2020     ["def"],.    
-000328f0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00032900: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00032910: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-00032920: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-00032930: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00032940: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
-00032950: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
-00032960: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-00032970: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-00032980: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-00032990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000329a0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00032870: 5d0a 2020 2020 2020 2020 2020 2020 292c  ].            ),
+00032880: 0a20 2020 2020 2020 2020 2020 205b 2264  .            ["d
+00032890: 6566 225d 2c0a 2020 2020 2020 2020 290a  ef"],.        ).
+000328a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000328b0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+000328c0: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
+000328d0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+000328e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000328f0: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+00032900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032910: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+00032920: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+00032930: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+00032940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032950: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00032960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032970: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00032980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032990: 2020 2022 7479 7065 223a 2022 5479 7065     "type": "Type
+000329a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 000329b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000329c0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-000329d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000329e0: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-000329f0: 2022 5479 7065 222c 0a20 2020 2020 2020   "Type",.       
-00032a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032a10: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00032a20: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-00032a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032a40: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-00032a50: 7222 3a20 2261 6263 222c 0a20 2020 2020  r": "abc",.     
-00032a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032a70: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-00032a80: 656e 7422 3a20 5b22 626f 6f6b 225d 2c0a  ent": ["book"],.
+000329c0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+000329d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000329e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000329f0: 2020 226f 7065 7261 746f 7222 3a20 2261    "operator": "a
+00032a00: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+00032a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a20: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+00032a30: 5b22 626f 6f6b 225d 2c0a 2020 2020 2020  ["book"],.      
+00032a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a50: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+00032a60: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+00032a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032a80: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
 00032a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ab0: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
-00032ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ad0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00032aa0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00032ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ac0: 2020 2020 2020 2274 7970 6522 3a20 2245        "type": "E
+00032ad0: 7870 6572 696d 656e 7473 222c 0a20 2020  xperiments",.   
 00032ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032af0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00032b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b10: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00032b20: 6522 3a20 2245 7870 6572 696d 656e 7473  e": "Experiments
-00032b30: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00032b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b50: 2020 2022 6c6f 6769 6361 6c22 3a20 2261     "logical": "a
-00032b60: 6e64 222c 0a20 2020 2020 2020 2020 2020  nd",.           
-00032b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b80: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-00032b90: 2022 6162 6322 2c0a 2020 2020 2020 2020   "abc",.        
-00032ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032bb0: 2020 2020 2020 2020 2263 6f6e 7465 6e74          "content
-00032bc0: 223a 205b 315d 2c0a 2020 2020 2020 2020  ": [1],.        
-00032bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032be0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00032bf0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00032c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c10: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-00032c20: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-00032c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c40: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
-00032c50: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00032c60: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00032c70: 292c 0a20 2020 2020 2020 2020 2020 205b  ),.            [
-00032c80: 2264 6566 225d 2c0a 2020 2020 2020 2020  "def"],.        
-00032c90: 290a 0a20 2020 2020 2020 2023 2074 6573  )..        # tes
-00032ca0: 7420 7465 7874 0a20 2020 2020 2020 2077  t text.        w
-00032cb0: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
-00032cc0: 6e67 2e4c 6f67 6765 722e 7761 726e 696e  ng.Logger.warnin
-00032cd0: 6722 2920 6173 205f 773a 0a20 2020 2020  g") as _w:.     
-00032ce0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00032cf0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00032d00: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
-00032d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032d20: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00032d30: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00032d40: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
-00032d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032d60: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
-00032d70: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-00032d80: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
-00032d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032da0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00032af0: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+00032b00: 6769 6361 6c22 3a20 2261 6e64 222c 0a20  gical": "and",. 
+00032b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00032b30: 6f70 6572 6174 6f72 223a 2022 6162 6322  operator": "abc"
+00032b40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00032b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b60: 2020 2263 6f6e 7465 6e74 223a 205b 315d    "content": [1]
+00032b70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00032b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b90: 2020 2266 6965 6c64 223a 204e 6f6e 652c    "field": None,
+00032ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032bb0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00032bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032bd0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00032be0: 2020 2020 2020 2020 2020 2020 2020 292e                ).
+00032bf0: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
+00032c00: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00032c10: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00032c20: 2020 2020 2020 2020 205b 2264 6566 225d           ["def"]
+00032c30: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00032c40: 2020 2020 2023 2074 6573 7420 7465 7874       # test text
+00032c50: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
+00032c60: 7463 6828 226c 6f67 6769 6e67 2e4c 6f67  tch("logging.Log
+00032c70: 6765 722e 7761 726e 696e 6722 2920 6173  ger.warning") as
+00032c80: 205f 773a 0a20 2020 2020 2020 2020 2020   _w:.           
+00032c90: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00032ca0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+00032cb0: 2020 2073 6f72 7465 6428 0a20 2020 2020     sorted(.     
+00032cc0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00032cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032ce0: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
+00032cf0: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
+00032d00: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00032d10: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+00032d20: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
+00032d30: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00032d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032d50: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00032d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032d70: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00032d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032d90: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
+00032da0: 2254 6578 7422 2c0a 2020 2020 2020 2020  "Text",.        
 00032db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032dc0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00032dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032de0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-00032df0: 7970 6522 3a20 2254 6578 7422 2c0a 2020  ype": "Text",.  
-00032e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032e20: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
-00032e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032e50: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-00032e60: 2022 6c69 6b65 222c 0a20 2020 2020 2020   "like",.       
-00032e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032e80: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-00032e90: 6e74 656e 7422 3a20 2222 2c0a 2020 2020  ntent": "",.    
+00032dc0: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+00032dd0: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
+00032de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032df0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00032e00: 6f70 6572 6174 6f72 223a 2022 6c69 6b65  operator": "like
+00032e10: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00032e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032e30: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+00032e40: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00032e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032e60: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+00032e70: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+00032e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032e90: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
 00032ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ec0: 2266 6965 6c64 223a 204e 6f6e 652c 0a20  "field": None,. 
-00032ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ee0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00032ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032f00: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-00032f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032f20: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
-00032f30: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
-00032f40: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-00032f50: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-00032f60: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
-00032f70: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
-00032f80: 6922 2c20 226a 6b6c 222c 2022 6d6e 6f22  i", "jkl", "mno"
-00032f90: 2c20 2270 7172 225d 2c0a 2020 2020 2020  , "pqr"],.      
-00032fa0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00032fb0: 2020 2020 5f77 2e61 7373 6572 745f 6361      _w.assert_ca
-00032fc0: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
-00032fd0: 496e 7661 6c69 6420 2763 6f6e 7465 6e74  Invalid 'content
-00032fe0: 2720 696e 2073 6561 7263 683a 2027 2720  ' in search: '' 
-00032ff0: 2854 6578 7429 2229 0a20 2020 2020 2020  (Text)").       
-00033000: 2020 2020 205f 772e 7265 7365 745f 6d6f       _w.reset_mo
-00033010: 636b 2829 0a20 2020 2020 2020 2020 2020  ck().           
-00033020: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00033030: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00033040: 2020 2073 6f72 7465 6428 0a20 2020 2020     sorted(.     
-00033050: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00033060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033070: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
-00033080: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
-00033090: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000330a0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-000330b0: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
-000330c0: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-000330d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000330e0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00032eb0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+00032ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ed0: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
+00032ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032ef0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+00032f00: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00032f10: 2020 2020 2020 2020 5b22 6162 6322 2c20          ["abc", 
+00032f20: 2264 6566 222c 2022 6768 6922 2c20 226a  "def", "ghi", "j
+00032f30: 6b6c 222c 2022 6d6e 6f22 2c20 2270 7172  kl", "mno", "pqr
+00032f40: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+00032f50: 290a 2020 2020 2020 2020 2020 2020 5f77  ).            _w
+00032f60: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+00032f70: 6e63 655f 7769 7468 2822 496e 7661 6c69  nce_with("Invali
+00032f80: 6420 2763 6f6e 7465 6e74 2720 696e 2073  d 'content' in s
+00032f90: 6561 7263 683a 2027 2720 2854 6578 7429  earch: '' (Text)
+00032fa0: 2229 0a20 2020 2020 2020 2020 2020 205f  ").            _
+00032fb0: 772e 7265 7365 745f 6d6f 636b 2829 0a20  w.reset_mock(). 
+00032fc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00032fd0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00032fe0: 2020 2020 2020 2020 2020 2020 2073 6f72               sor
+00032ff0: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
+00033000: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00033010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033020: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
+00033030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033040: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
+00033050: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+00033060: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
+00033070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033080: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00033090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000330a0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+000330b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000330c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000330d0: 2020 2274 7970 6522 3a20 2254 6578 7422    "type": "Text"
+000330e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 000330f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033100: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00033110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033120: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-00033130: 2254 6578 7422 2c0a 2020 2020 2020 2020  "Text",.        
-00033140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033150: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-00033160: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
-00033170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033180: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00033190: 6f70 6572 6174 6f72 223a 2022 6e6f 7420  operator": "not 
-000331a0: 6c69 6b65 222c 0a20 2020 2020 2020 2020  like",.         
-000331b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000331c0: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-000331d0: 656e 7422 3a20 2222 2c0a 2020 2020 2020  ent": "",.      
+00033100: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+00033110: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00033120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033130: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
+00033140: 6f72 223a 2022 6e6f 7420 6c69 6b65 222c  or": "not like",
+00033150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033170: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+00033180: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+00033190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000331a0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+000331b0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+000331c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000331d0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
 000331e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000331f0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00033200: 6965 6c64 223a 204e 6f6e 652c 0a20 2020  ield": None,.   
-00033210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033220: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-00033230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033240: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00033250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033260: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-00033270: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-00033280: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00033290: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-000332a0: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
-000332b0: 6322 2c20 2264 6566 222c 2022 6768 6922  c", "def", "ghi"
-000332c0: 2c20 226a 6b6c 222c 2022 6d6e 6f22 2c20  , "jkl", "mno", 
-000332d0: 2270 7172 225d 2c0a 2020 2020 2020 2020  "pqr"],.        
-000332e0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000332f0: 2020 5f77 2e61 7373 6572 745f 6361 6c6c    _w.assert_call
-00033300: 6564 5f6f 6e63 655f 7769 7468 2822 496e  ed_once_with("In
-00033310: 7661 6c69 6420 2763 6f6e 7465 6e74 2720  valid 'content' 
-00033320: 696e 2073 6561 7263 683a 2027 2720 2854  in search: '' (T
-00033330: 6578 7429 2229 0a20 2020 2020 2020 2020  ext)").         
-00033340: 2020 205f 772e 7265 7365 745f 6d6f 636b     _w.reset_mock
-00033350: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-00033360: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00033370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033380: 2073 6f72 7465 6428 0a20 2020 2020 2020   sorted(.       
-00033390: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
-000333a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333b0: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-000333c0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-000333d0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-000333e0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-000333f0: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
-00033400: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00033410: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+000331f0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00033200: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00033210: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+00033220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033230: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+00033240: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+00033250: 2020 2020 2020 5b22 6162 6322 2c20 2264        ["abc", "d
+00033260: 6566 222c 2022 6768 6922 2c20 226a 6b6c  ef", "ghi", "jkl
+00033270: 222c 2022 6d6e 6f22 2c20 2270 7172 225d  ", "mno", "pqr"]
+00033280: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00033290: 2020 2020 2020 2020 2020 2020 5f77 2e61              _w.a
+000332a0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+000332b0: 655f 7769 7468 2822 496e 7661 6c69 6420  e_with("Invalid 
+000332c0: 2763 6f6e 7465 6e74 2720 696e 2073 6561  'content' in sea
+000332d0: 7263 683a 2027 2720 2854 6578 7429 2229  rch: '' (Text)")
+000332e0: 0a20 2020 2020 2020 2020 2020 205f 772e  .            _w.
+000332f0: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
+00033300: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00033310: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00033320: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
+00033330: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
+00033340: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00033350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033360: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00033370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033380: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
+00033390: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
+000333a0: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
+000333b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000333c0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+000333d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000333e0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+000333f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033410: 2274 7970 6522 3a20 2254 6578 7422 2c0a  "type": "Text",.
 00033420: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00033430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033440: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00033450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033460: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
-00033470: 6578 7422 2c0a 2020 2020 2020 2020 2020  ext",.          
-00033480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033490: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-000334a0: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
-000334b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334c0: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
-000334d0: 6572 6174 6f72 223a 2022 3d22 2c0a 2020  erator": "=",.  
-000334e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033500: 2020 2263 6f6e 7465 6e74 223a 2022 6162    "content": "ab
-00033510: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
+00033440: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+00033450: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00033460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033470: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
+00033480: 223a 2022 3d22 2c0a 2020 2020 2020 2020  ": "=",.        
+00033490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000334a0: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+000334b0: 7465 6e74 223a 2022 6162 6322 2c0a 2020  tent": "abc",.  
+000334c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000334d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000334e0: 2020 2266 6965 6c64 223a 2022 6162 6322    "field": "abc"
+000334f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033510: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
 00033520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033530: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00033540: 2022 6162 6322 2c0a 2020 2020 2020 2020   "abc",.        
-00033550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033560: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00033570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033580: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00033590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000335a0: 292e 6c61 7374 4665 7463 6865 640a 2020  ).lastFetched.  
-000335b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000335c0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-000335d0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-000335e0: 2020 2020 2020 205b 2261 6263 222c 2022         ["abc", "
-000335f0: 6465 6622 2c20 2267 6869 222c 2022 6a6b  def", "ghi", "jk
-00033600: 6c22 2c20 226d 6e6f 222c 2022 7071 7222  l", "mno", "pqr"
-00033610: 5d2c 0a20 2020 2020 2020 2020 2020 2029  ],.            )
-00033620: 0a20 2020 2020 2020 2020 2020 205f 772e  .            _w.
-00033630: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00033640: 6365 5f77 6974 6828 2249 6e76 616c 6964  ce_with("Invalid
-00033650: 2066 6965 6c64 3a20 2761 6263 2722 290a   field: 'abc'").
-00033660: 2020 2020 2020 2020 2020 2020 5f77 2e72              _w.r
-00033670: 6573 6574 5f6d 6f63 6b28 290a 2020 2020  eset_mock().    
-00033680: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00033690: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-000336a0: 2020 2020 2020 2020 2020 736f 7274 6564            sorted
-000336b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000336c0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-000336d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000336e0: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
-000336f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033700: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
-00033710: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-00033720: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
-00033730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033740: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00033530: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00033540: 2020 2020 2020 2020 2020 292e 6c61 7374            ).last
+00033550: 4665 7463 6865 640a 2020 2020 2020 2020  Fetched.        
+00033560: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00033570: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+00033580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033590: 205b 2261 6263 222c 2022 6465 6622 2c20   ["abc", "def", 
+000335a0: 2267 6869 222c 2022 6a6b 6c22 2c20 226d  "ghi", "jkl", "m
+000335b0: 6e6f 222c 2022 7071 7222 5d2c 0a20 2020  no", "pqr"],.   
+000335c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000335d0: 2020 2020 2020 205f 772e 6173 7365 7274         _w.assert
+000335e0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+000335f0: 6828 2249 6e76 616c 6964 2066 6965 6c64  h("Invalid field
+00033600: 3a20 2761 6263 2722 290a 2020 2020 2020  : 'abc'").      
+00033610: 2020 2020 2020 5f77 2e72 6573 6574 5f6d        _w.reset_m
+00033620: 6f63 6b28 290a 2020 2020 2020 2020 2020  ock().          
+00033630: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00033640: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00033650: 2020 2020 736f 7274 6564 280a 2020 2020      sorted(.    
+00033660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033670: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00033680: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
+00033690: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
+000336a0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+000336b0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+000336c0: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
+000336d0: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
+000336e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000336f0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00033700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033710: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00033720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033730: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+00033740: 2022 5465 7874 222c 0a20 2020 2020 2020   "Text",.       
 00033750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033760: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-00033770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033780: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00033790: 7479 7065 223a 2022 5465 7874 222c 0a20  type": "Text",. 
-000337a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000337b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000337c0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
-000337d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000337e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000337f0: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
-00033800: 3a20 2261 6263 222c 0a20 2020 2020 2020  : "abc",.       
-00033810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033820: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-00033830: 6e74 656e 7422 3a20 2261 6263 222c 0a20  ntent": "abc",. 
-00033840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033860: 2020 2022 6669 656c 6422 3a20 2261 7278     "field": "arx
-00033870: 6976 222c 0a20 2020 2020 2020 2020 2020  iv",.           
-00033880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033890: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-000338a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000338b0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-000338c0: 2020 2020 2020 2020 2020 2020 2029 2e6c               ).l
-000338d0: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
-000338e0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-000338f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033900: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-00033910: 2020 2020 5b22 6162 6322 2c20 2264 6566      ["abc", "def
-00033920: 222c 2022 6768 6922 2c20 226a 6b6c 222c  ", "ghi", "jkl",
-00033930: 2022 6d6e 6f22 2c20 2270 7172 225d 2c0a   "mno", "pqr"],.
-00033940: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00033950: 2020 2020 2020 2020 2020 5f77 2e61 7373            _w.ass
-00033960: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-00033970: 7769 7468 2822 496e 7661 6c69 6420 6f70  with("Invalid op
-00033980: 6572 6174 6f72 3a20 2761 6263 2722 290a  erator: 'abc'").
-00033990: 2020 2020 2020 2020 2320 6669 656c 6473          # fields
-000339a0: 0a20 2020 2020 2020 2066 6f72 2066 2069  .        for f i
-000339b0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-000339c0: 2e74 6162 6c65 436f 6c73 5b22 656e 7472  .tableCols["entr
-000339d0: 6965 7322 5d3a 0a20 2020 2020 2020 2020  ies"]:.         
-000339e0: 2020 2077 6974 6820 7061 7463 6828 226c     with patch("l
-000339f0: 6f67 6769 6e67 2e4c 6f67 6765 722e 7761  ogging.Logger.wa
-00033a00: 726e 696e 6722 2920 6173 205f 773a 0a20  rning") as _w:. 
-00033a10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00033a20: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
-00033a30: 7463 6846 726f 6d44 6963 7428 0a20 2020  tchFromDict(.   
-00033a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033a50: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00033a60: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00033760: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+00033770: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
+00033780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000337a0: 226f 7065 7261 746f 7222 3a20 2261 6263  "operator": "abc
+000337b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000337c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000337d0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+000337e0: 3a20 2261 6263 222c 0a20 2020 2020 2020  : "abc",.       
+000337f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033800: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
+00033810: 656c 6422 3a20 2261 7278 6976 222c 0a20  eld": "arxiv",. 
+00033820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033830: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00033840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033850: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+00033860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033870: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
+00033880: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
+00033890: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+000338a0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+000338b0: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
+000338c0: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
+000338d0: 6922 2c20 226a 6b6c 222c 2022 6d6e 6f22  i", "jkl", "mno"
+000338e0: 2c20 2270 7172 225d 2c0a 2020 2020 2020  , "pqr"],.      
+000338f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00033900: 2020 2020 5f77 2e61 7373 6572 745f 6361      _w.assert_ca
+00033910: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
+00033920: 496e 7661 6c69 6420 6f70 6572 6174 6f72  Invalid operator
+00033930: 3a20 2761 6263 2722 290a 2020 2020 2020  : 'abc'").      
+00033940: 2020 2320 6669 656c 6473 0a20 2020 2020    # fields.     
+00033950: 2020 2066 6f72 2066 2069 6e20 7365 6c66     for f in self
+00033960: 2e70 4244 422e 6269 6273 2e74 6162 6c65  .pBDB.bibs.table
+00033970: 436f 6c73 5b22 656e 7472 6965 7322 5d3a  Cols["entries"]:
+00033980: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+00033990: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
+000339a0: 2e4c 6f67 6765 722e 7761 726e 696e 6722  .Logger.warning"
+000339b0: 2920 6173 205f 773a 0a20 2020 2020 2020  ) as _w:.       
+000339c0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+000339d0: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
+000339e0: 6d44 6963 7428 0a20 2020 2020 2020 2020  mDict(.         
+000339f0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+00033a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a10: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+00033a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a30: 2020 2022 7479 7065 223a 2022 5465 7874     "type": "Text
+00033a40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00033a50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00033a60: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
 00033a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033a80: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-00033a90: 2022 5465 7874 222c 0a20 2020 2020 2020   "Text",.       
+00033a80: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+00033a90: 746f 7222 3a20 223d 222c 0a20 2020 2020  tor": "=",.     
 00033aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ab0: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-00033ac0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+00033ab0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+00033ac0: 3a20 2261 6263 222c 0a20 2020 2020 2020  : "abc",.       
 00033ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ae0: 226f 7065 7261 746f 7222 3a20 223d 222c  "operator": "=",
+00033ae0: 2020 2020 2022 6669 656c 6422 3a20 662c       "field": f,
 00033af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033b00: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-00033b10: 6e74 656e 7422 3a20 2261 6263 222c 0a20  ntent": "abc",. 
-00033b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033b30: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
-00033b40: 6422 3a20 662c 0a20 2020 2020 2020 2020  d": f,.         
-00033b50: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00033b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033b70: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00033b80: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00033b90: 2020 2020 2020 2020 205f 772e 6173 7365           _w.asse
-00033ba0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-00033bb0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00033bc0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00033bd0: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
-00033be0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
-00033bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c00: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+00033b00: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+00033b10: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00033b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033b30: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00033b40: 2020 205f 772e 6173 7365 7274 5f6e 6f74     _w.assert_not
+00033b50: 5f63 616c 6c65 6428 290a 2020 2020 2020  _called().      
+00033b60: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00033b70: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00033b80: 736f 7274 6564 280a 2020 2020 2020 2020  sorted(.        
+00033b90: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00033ba0: 2020 2020 2020 2020 2020 2020 2020 655b                e[
+00033bb0: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
+00033bc0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00033bd0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00033be0: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
+00033bf0: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
+00033c00: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
 00033c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c20: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
-00033c30: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
-00033c40: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
-00033c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c60: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00033c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c80: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00033c20: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00033c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c40: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+00033c50: 7065 223a 2022 5465 7874 222c 0a20 2020  pe": "Text",.   
+00033c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c70: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+00033c80: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
 00033c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ca0: 2020 2022 7479 7065 223a 2022 5465 7874     "type": "Text
-00033cb0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00033ca0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+00033cb0: 7261 746f 7222 3a20 223d 222c 0a20 2020  rator": "=",.   
 00033cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033cd0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
-00033ce0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033cd0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+00033ce0: 6e74 656e 7422 3a20 2270 712e 7222 2c0a  ntent": "pq.r",.
 00033cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d00: 2020 226f 7065 7261 746f 7222 3a20 223d    "operator": "=
-00033d10: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00033d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d30: 2020 2022 636f 6e74 656e 7422 3a20 2270     "content": "p
-00033d40: 712e 7222 2c0a 2020 2020 2020 2020 2020  q.r",.          
-00033d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d60: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
-00033d70: 6172 7869 7622 2c0a 2020 2020 2020 2020  arxiv",.        
-00033d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d90: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-00033da0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-00033db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033dc0: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
-00033dd0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00033de0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00033df0: 292c 0a20 2020 2020 2020 2020 2020 205b  ),.            [
-00033e00: 2270 7172 225d 2c0a 2020 2020 2020 2020  "pqr"],.        
-00033e10: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00033e20: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00033e30: 2020 2020 2020 2020 736f 7274 6564 280a          sorted(.
-00033e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033e50: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00033e60: 2020 2020 2020 655b 2262 6962 6b65 7922        e["bibkey"
-00033e70: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00033e80: 2020 2020 2020 666f 7220 6520 696e 2073        for e in s
-00033e90: 656c 662e 7042 4442 2e62 6962 732e 6665  elf.pBDB.bibs.fe
-00033ea0: 7463 6846 726f 6d44 6963 7428 0a20 2020  tchFromDict(.   
-00033eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ec0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00033ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ee0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00033d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d10: 2266 6965 6c64 223a 2022 6172 7869 7622  "field": "arxiv"
+00033d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033d30: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+00033d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d50: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00033d60: 2020 2020 2020 2020 2020 2020 2020 292e                ).
+00033d70: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
+00033d80: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00033d90: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00033da0: 2020 2020 2020 2020 205b 2270 7172 225d           ["pqr"]
+00033db0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00033dc0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00033dd0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00033de0: 2020 736f 7274 6564 280a 2020 2020 2020    sorted(.      
+00033df0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00033e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033e10: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
+00033e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033e30: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
+00033e40: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
+00033e50: 6d44 6963 7428 0a20 2020 2020 2020 2020  mDict(.         
+00033e60: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00033e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033e80: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+00033e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033ea0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00033eb0: 7479 7065 223a 2022 5465 7874 222c 0a20  type": "Text",. 
+00033ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033ed0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00033ee0: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
 00033ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033f00: 2020 2020 2022 7479 7065 223a 2022 5465       "type": "Te
-00033f10: 7874 222c 0a20 2020 2020 2020 2020 2020  xt",.           
+00033f00: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+00033f10: 7065 7261 746f 7222 3a20 223d 222c 0a20  perator": "=",. 
 00033f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033f30: 2020 2020 2022 6c6f 6769 6361 6c22 3a20       "logical": 
-00033f40: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-00033f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033f60: 2020 2020 226f 7065 7261 746f 7222 3a20      "operator": 
-00033f70: 223d 222c 0a20 2020 2020 2020 2020 2020  "=",.           
-00033f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033f90: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
-00033fa0: 2270 712e 7222 2c0a 2020 2020 2020 2020  "pq.r",.        
-00033fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033fc0: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00033fd0: 2022 6172 7869 7622 2c0a 2020 2020 2020   "arxiv",.      
-00033fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ff0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00033f30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00033f40: 636f 6e74 656e 7422 3a20 2270 712e 7222  content": "pq.r"
+00033f50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033f70: 2020 2266 6965 6c64 223a 2022 6172 7869    "field": "arxi
+00033f80: 7622 2c0a 2020 2020 2020 2020 2020 2020  v",.            
+00033f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033fa0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00033fb0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00033fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033fe0: 2022 7479 7065 223a 2022 5465 7874 222c   "type": "Text",
+00033ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00034000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034010: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00034020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034030: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
-00034040: 5465 7874 222c 0a20 2020 2020 2020 2020  Text",.         
-00034050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034060: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-00034070: 3a20 226f 7222 2c0a 2020 2020 2020 2020  : "or",.        
-00034080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034090: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-000340a0: 7222 3a20 226c 696b 6522 2c0a 2020 2020  r": "like",.    
-000340b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000340c0: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-000340d0: 7465 6e74 223a 2022 6f31 222c 0a20 2020  tent": "o1",.   
+00034010: 2022 6c6f 6769 6361 6c22 3a20 226f 7222   "logical": "or"
+00034020: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034040: 2020 226f 7065 7261 746f 7222 3a20 226c    "operator": "l
+00034050: 696b 6522 2c0a 2020 2020 2020 2020 2020  ike",.          
+00034060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034070: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+00034080: 2022 6f31 222c 0a20 2020 2020 2020 2020   "o1",.         
+00034090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000340a0: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
+000340b0: 2261 7278 6976 222c 0a20 2020 2020 2020  "arxiv",.       
+000340c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000340d0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
 000340e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000340f0: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
-00034100: 656c 6422 3a20 2261 7278 6976 222c 0a20  eld": "arxiv",. 
-00034110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034120: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-00034130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034140: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00034150: 2020 2020 2020 2020 2020 2020 292e 6c61              ).la
-00034160: 7374 4665 7463 6865 640a 2020 2020 2020  stFetched.      
-00034170: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-00034180: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00034190: 2020 2020 2020 205b 226d 6e6f 222c 2022         ["mno", "
-000341a0: 7071 7222 5d2c 0a20 2020 2020 2020 2029  pqr"],.        )
-000341b0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000341c0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-000341d0: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
-000341e0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-000341f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034200: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-00034210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034220: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-00034230: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-00034240: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-00034250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034260: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00034270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034280: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+000340f0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00034100: 2020 2020 2020 292e 6c61 7374 4665 7463        ).lastFetc
+00034110: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
+00034120: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+00034130: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00034140: 205b 226d 6e6f 222c 2022 7071 7222 5d2c   ["mno", "pqr"],
+00034150: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00034160: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00034170: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00034180: 2073 6f72 7465 6428 0a20 2020 2020 2020   sorted(.       
+00034190: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+000341a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000341b0: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+000341c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000341d0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+000341e0: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+000341f0: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+00034200: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00034210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034220: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00034230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034240: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00034250: 7970 6522 3a20 2254 6578 7422 2c0a 2020  ype": "Text",.  
+00034260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034270: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+00034280: 6f67 6963 616c 223a 2022 222c 0a20 2020  ogical": "",.   
 00034290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000342a0: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
-000342b0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+000342a0: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+000342b0: 6572 6174 6f72 223a 2022 3d22 2c0a 2020  erator": "=",.  
 000342c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000342d0: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
-000342e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000342f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034300: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-00034310: 3d22 2c0a 2020 2020 2020 2020 2020 2020  =",.            
-00034320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034330: 2020 2020 2263 6f6e 7465 6e74 223a 2022      "content": "
-00034340: 7071 2e72 222c 0a20 2020 2020 2020 2020  pq.r",.         
-00034350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034360: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-00034370: 2261 7278 6976 222c 0a20 2020 2020 2020  "arxiv",.       
-00034380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034390: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+000342d0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+000342e0: 6f6e 7465 6e74 223a 2022 7071 2e72 222c  ontent": "pq.r",
+000342f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034310: 2022 6669 656c 6422 3a20 2261 7278 6976   "field": "arxiv
+00034320: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00034330: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00034340: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034350: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+00034360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034380: 2274 7970 6522 3a20 2254 6578 7422 2c0a  "type": "Text",.
+00034390: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000343a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000343b0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-000343c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000343d0: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
-000343e0: 6578 7422 2c0a 2020 2020 2020 2020 2020  ext",.          
-000343f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034400: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-00034410: 2022 616e 6422 2c0a 2020 2020 2020 2020   "and",.        
-00034420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034430: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-00034440: 7222 3a20 226c 696b 6522 2c0a 2020 2020  r": "like",.    
-00034450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034460: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-00034470: 7465 6e74 223a 2022 7071 7222 2c0a 2020  tent": "pqr",.  
+000343b0: 226c 6f67 6963 616c 223a 2022 616e 6422  "logical": "and"
+000343c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000343d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000343e0: 2020 226f 7065 7261 746f 7222 3a20 226c    "operator": "l
+000343f0: 696b 6522 2c0a 2020 2020 2020 2020 2020  ike",.          
+00034400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034410: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+00034420: 2022 7071 7222 2c0a 2020 2020 2020 2020   "pqr",.        
+00034430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034440: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+00034450: 2022 6269 626b 6579 222c 0a20 2020 2020   "bibkey",.     
+00034460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034470: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
 00034480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034490: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-000344a0: 6965 6c64 223a 2022 6269 626b 6579 222c  ield": "bibkey",
-000344b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000344c0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-000344d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000344e0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-000344f0: 2020 2020 2020 2020 2020 2020 2020 292e                ).
-00034500: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
-00034510: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-00034520: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-00034530: 2020 2020 2020 2020 205b 2270 7172 225d           ["pqr"]
-00034540: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00034550: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00034560: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00034570: 2020 736f 7274 6564 280a 2020 2020 2020    sorted(.      
-00034580: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00034590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000345a0: 655b 2262 6962 6b65 7922 5d0a 2020 2020  e["bibkey"].    
+00034490: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+000344a0: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
+000344b0: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
+000344c0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+000344d0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
+000344e0: 2020 205b 2270 7172 225d 2c0a 2020 2020     ["pqr"],.    
+000344f0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00034500: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00034510: 2020 2020 2020 2020 2020 2020 736f 7274              sort
+00034520: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
+00034530: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+00034540: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
+00034550: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
+00034560: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
+00034570: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
+00034580: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
+00034590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000345a0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
 000345b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000345c0: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-000345d0: 4442 2e62 6962 732e 6665 7463 6846 726f  DB.bibs.fetchFro
-000345e0: 6d44 6963 7428 0a20 2020 2020 2020 2020  mDict(.         
-000345f0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00034600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034610: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-00034620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034630: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00034640: 7479 7065 223a 2022 5465 7874 222c 0a20  type": "Text",. 
-00034650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034660: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00034670: 6c6f 6769 6361 6c22 3a20 2222 2c0a 2020  logical": "",.  
-00034680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034690: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-000346a0: 7065 7261 746f 7222 3a20 223d 222c 0a20  perator": "=",. 
-000346b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000346c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000346d0: 636f 6e74 656e 7422 3a20 2270 712e 7222  content": "pq.r"
-000346e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000346f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034700: 2020 2266 6965 6c64 223a 2022 6172 7869    "field": "arxi
-00034710: 7622 2c0a 2020 2020 2020 2020 2020 2020  v",.            
-00034720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034730: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00034740: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00034750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000345c0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+000345d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000345e0: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
+000345f0: 2022 5465 7874 222c 0a20 2020 2020 2020   "Text",.       
+00034600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034610: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
+00034620: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
+00034630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034640: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
+00034650: 7222 3a20 223d 222c 0a20 2020 2020 2020  r": "=",.       
+00034660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034670: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
+00034680: 7422 3a20 2270 712e 7222 2c0a 2020 2020  t": "pq.r",.    
+00034690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000346a0: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
+000346b0: 6c64 223a 2022 6172 7869 7622 2c0a 2020  ld": "arxiv",.  
+000346c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000346d0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+000346e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000346f0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00034700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034710: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+00034720: 223a 2022 5465 7874 222c 0a20 2020 2020  ": "Text",.     
+00034730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034740: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+00034750: 6361 6c22 3a20 226f 7222 2c0a 2020 2020  cal": "or",.    
 00034760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034770: 2022 7479 7065 223a 2022 5465 7874 222c   "type": "Text",
-00034780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034770: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+00034780: 7261 746f 7222 3a20 226c 696b 6522 2c0a  rator": "like",.
 00034790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000347a0: 2022 6c6f 6769 6361 6c22 3a20 226f 7222   "logical": "or"
-000347b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000347c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000347d0: 2020 226f 7065 7261 746f 7222 3a20 226c    "operator": "l
-000347e0: 696b 6522 2c0a 2020 2020 2020 2020 2020  ike",.          
-000347f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034800: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-00034810: 2022 5051 7222 2c0a 2020 2020 2020 2020   "PQr",.        
-00034820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034830: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00034840: 2022 6269 626b 6579 222c 0a20 2020 2020   "bibkey",.     
+000347a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000347b0: 2263 6f6e 7465 6e74 223a 2022 5051 7222  "content": "PQr"
+000347c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000347d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000347e0: 2020 2266 6965 6c64 223a 2022 6269 626b    "field": "bibk
+000347f0: 6579 222c 0a20 2020 2020 2020 2020 2020  ey",.           
+00034800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034810: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00034820: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00034830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034840: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
 00034850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034860: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00034870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034880: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00034890: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-000348a0: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
-000348b0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-000348c0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-000348d0: 2020 205b 2270 7172 225d 2c0a 2020 2020     ["pqr"],.    
-000348e0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-000348f0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00034900: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-00034910: 6564 280a 2020 2020 2020 2020 2020 2020  ed(.            
-00034920: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00034930: 2020 2020 2020 2020 2020 655b 2262 6962            e["bib
-00034940: 6b65 7922 5d0a 2020 2020 2020 2020 2020  key"].          
-00034950: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-00034960: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-00034970: 732e 6665 7463 6846 726f 6d44 6963 7428  s.fetchFromDict(
-00034980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034990: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00034860: 5d0a 2020 2020 2020 2020 2020 2020 292c  ].            ),
+00034870: 0a20 2020 2020 2020 2020 2020 205b 2270  .            ["p
+00034880: 7172 225d 2c0a 2020 2020 2020 2020 290a  qr"],.        ).
+00034890: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000348a0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+000348b0: 2020 2020 2020 736f 7274 6564 280a 2020        sorted(.  
+000348c0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+000348d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000348e0: 2020 2020 655b 2262 6962 6b65 7922 5d0a      e["bibkey"].
+000348f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034900: 2020 2020 666f 7220 6520 696e 2073 656c      for e in sel
+00034910: 662e 7042 4442 2e62 6962 732e 6665 7463  f.pBDB.bibs.fetc
+00034920: 6846 726f 6d44 6963 7428 0a20 2020 2020  hFromDict(.     
+00034930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034940: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
+00034950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034960: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00034970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034980: 2020 2022 7479 7065 223a 2022 5465 7874     "type": "Text
+00034990: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 000349a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000349b0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-000349c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000349d0: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-000349e0: 2022 5465 7874 222c 0a20 2020 2020 2020   "Text",.       
-000349f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034a00: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-00034a10: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-00034a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034a30: 2020 2020 2020 2020 226f 7065 7261 746f          "operato
-00034a40: 7222 3a20 2221 3d22 2c0a 2020 2020 2020  r": "!=",.      
-00034a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034a60: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-00034a70: 6e74 223a 2022 222c 0a20 2020 2020 2020  nt": "",.       
-00034a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034a90: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-00034aa0: 3a20 2261 7278 6976 222c 0a20 2020 2020  : "arxiv",.     
-00034ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ac0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00034ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ae0: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
-00034af0: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
-00034b00: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
-00034b10: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00034b20: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-00034b30: 2020 5b22 6162 6322 2c20 2264 6566 222c    ["abc", "def",
-00034b40: 2022 6768 6922 2c20 226d 6e6f 222c 2022   "ghi", "mno", "
-00034b50: 7071 7222 5d2c 0a20 2020 2020 2020 2029  pqr"],.        )
-00034b60: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00034b70: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00034b80: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
-00034b90: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00034ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034bb0: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-00034bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034bd0: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-00034be0: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-00034bf0: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-00034c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c10: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-00034c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c30: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+000349b0: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+000349c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000349d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000349e0: 2020 226f 7065 7261 746f 7222 3a20 2221    "operator": "!
+000349f0: 3d22 2c0a 2020 2020 2020 2020 2020 2020  =",.            
+00034a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034a10: 2020 2020 2263 6f6e 7465 6e74 223a 2022      "content": "
+00034a20: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00034a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034a40: 2020 2022 6669 656c 6422 3a20 2261 7278     "field": "arx
+00034a50: 6976 222c 0a20 2020 2020 2020 2020 2020  iv",.           
+00034a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034a70: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+00034a80: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00034a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034aa0: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
+00034ab0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00034ac0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00034ad0: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+00034ae0: 6322 2c20 2264 6566 222c 2022 6768 6922  c", "def", "ghi"
+00034af0: 2c20 226d 6e6f 222c 2022 7071 7222 5d2c  , "mno", "pqr"],
+00034b00: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00034b10: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00034b20: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00034b30: 2073 6f72 7465 6428 0a20 2020 2020 2020   sorted(.       
+00034b40: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00034b50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00034b60: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+00034b70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00034b80: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+00034b90: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+00034ba0: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+00034bb0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00034bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034bd0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00034be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034bf0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00034c00: 7970 6522 3a20 2254 6578 7422 2c0a 2020  ype": "Text",.  
+00034c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034c20: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+00034c30: 6f67 6963 616c 223a 2022 222c 0a20 2020  ogical": "",.   
 00034c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c50: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
-00034c60: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00034c50: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+00034c60: 6572 6174 6f72 223a 2022 3d22 2c0a 2020  erator": "=",.  
 00034c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c80: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
-00034c90: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00034c80: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00034c90: 6f6e 7465 6e74 223a 2022 222c 0a20 2020  ontent": "",.   
 00034ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034cb0: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-00034cc0: 3d22 2c0a 2020 2020 2020 2020 2020 2020  =",.            
+00034cb0: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
+00034cc0: 656c 6422 3a20 2261 7278 6976 222c 0a20  eld": "arxiv",. 
 00034cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ce0: 2020 2020 2263 6f6e 7465 6e74 223a 2022      "content": "
-00034cf0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00034d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034d10: 2020 2022 6669 656c 6422 3a20 2261 7278     "field": "arx
-00034d20: 6976 222c 0a20 2020 2020 2020 2020 2020  iv",.           
-00034d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034d40: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
-00034d50: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00034d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034d70: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
-00034d80: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00034d90: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-00034da0: 2020 2020 2020 2020 2020 2020 5b22 6a6b              ["jk
-00034db0: 6c22 5d2c 0a20 2020 2020 2020 2029 0a20  l"],.        ). 
-00034dc0: 2020 2020 2020 2023 206f 7065 7261 746f         # operato
-00034dd0: 7273 0a20 2020 2020 2020 2066 6f72 2066  rs.        for f
-00034de0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-00034df0: 6273 2e73 6561 7263 684f 7065 7261 746f  bs.searchOperato
-00034e00: 7273 5b22 7465 7874 225d 3a0a 2020 2020  rs["text"]:.    
-00034e10: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-00034e20: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
-00034e30: 6572 2e77 6172 6e69 6e67 2229 2061 7320  er.warning") as 
-00034e40: 5f77 3a0a 2020 2020 2020 2020 2020 2020  _w:.            
-00034e50: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00034e60: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
-00034e70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00034e80: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-00034e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ea0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00034eb0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-00034ec0: 7970 6522 3a20 2254 6578 7422 2c0a 2020  ype": "Text",.  
+00034ce0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+00034cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d00: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00034d10: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
+00034d20: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
+00034d30: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+00034d40: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00034d50: 2020 2020 2020 5b22 6a6b 6c22 5d2c 0a20        ["jkl"],. 
+00034d60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00034d70: 2023 206f 7065 7261 746f 7273 0a20 2020   # operators.   
+00034d80: 2020 2020 2066 6f72 2066 2069 6e20 7365       for f in se
+00034d90: 6c66 2e70 4244 422e 6269 6273 2e73 6561  lf.pBDB.bibs.sea
+00034da0: 7263 684f 7065 7261 746f 7273 5b22 7465  rchOperators["te
+00034db0: 7874 225d 3a0a 2020 2020 2020 2020 2020  xt"]:.          
+00034dc0: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
+00034dd0: 6767 696e 672e 4c6f 6767 6572 2e77 6172  gging.Logger.war
+00034de0: 6e69 6e67 2229 2061 7320 5f77 3a0a 2020  ning") as _w:.  
+00034df0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00034e00: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
+00034e10: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
+00034e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034e30: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00034e40: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00034e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034e60: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
+00034e70: 2254 6578 7422 2c0a 2020 2020 2020 2020  "Text",.        
+00034e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034e90: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+00034ea0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00034eb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00034ec0: 6f70 6572 6174 6f72 223a 2066 2c0a 2020  operator": f,.  
 00034ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ee0: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-00034ef0: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
+00034ee0: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
+00034ef0: 6e74 223a 2022 6162 6322 2c0a 2020 2020  nt": "abc",.    
 00034f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f10: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-00034f20: 2066 2c0a 2020 2020 2020 2020 2020 2020   f,.            
+00034f10: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
+00034f20: 2022 6269 6274 6578 222c 0a20 2020 2020   "bibtex",.     
 00034f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034f40: 2263 6f6e 7465 6e74 223a 2022 6162 6322  "content": "abc"
-00034f50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00034f60: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00034f70: 6965 6c64 223a 2022 6269 6274 6578 222c  ield": "bibtex",
-00034f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034f90: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00034fa0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00034fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034fc0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00034fd0: 2020 205f 772e 6173 7365 7274 5f6e 6f74     _w.assert_not
-00034fe0: 5f63 616c 6c65 6428 290a 2020 2020 2020  _called().      
-00034ff0: 2020 666f 7220 6620 696e 205b 7620 666f    for f in [v fo
-00035000: 7220 7620 696e 2073 656c 662e 7042 4442  r v in self.pBDB
-00035010: 2e62 6962 732e 7365 6172 6368 4f70 6572  .bibs.searchOper
-00035020: 6174 6f72 735b 2274 6578 7422 5d2e 7661  ators["text"].va
-00035030: 6c75 6573 2829 5d3a 0a20 2020 2020 2020  lues()]:.       
-00035040: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-00035050: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-00035060: 7761 726e 696e 6722 2920 6173 205f 773a  warning") as _w:
-00035070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035080: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00035090: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
-000350a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000350b0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-000350c0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+00034f40: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00034f50: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+00034f60: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00034f70: 2020 2020 2020 2020 2020 2020 205f 772e               _w.
+00034f80: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
+00034f90: 6428 290a 2020 2020 2020 2020 666f 7220  d().        for 
+00034fa0: 6620 696e 205b 7620 666f 7220 7620 696e  f in [v for v in
+00034fb0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00034fc0: 7365 6172 6368 4f70 6572 6174 6f72 735b  searchOperators[
+00034fd0: 2274 6578 7422 5d2e 7661 6c75 6573 2829  "text"].values()
+00034fe0: 5d3a 0a20 2020 2020 2020 2020 2020 2077  ]:.            w
+00034ff0: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
+00035000: 6e67 2e4c 6f67 6765 722e 7761 726e 696e  ng.Logger.warnin
+00035010: 6722 2920 6173 205f 773a 0a20 2020 2020  g") as _w:.     
+00035020: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00035030: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
+00035040: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
+00035050: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+00035060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035070: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+00035080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035090: 2020 2020 2022 7479 7065 223a 2022 5465       "type": "Te
+000350a0: 7874 222c 0a20 2020 2020 2020 2020 2020  xt",.           
+000350b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000350c0: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
 000350d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000350e0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-000350f0: 223a 2022 5465 7874 222c 0a20 2020 2020  ": "Text",.     
+000350e0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+000350f0: 7261 746f 7222 3a20 662c 0a20 2020 2020  rator": f,.     
 00035100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035110: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-00035120: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00035110: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+00035120: 3a20 2261 6263 222c 0a20 2020 2020 2020  : "abc",.       
 00035130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035140: 2020 226f 7065 7261 746f 7222 3a20 662c    "operator": f,
-00035150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035160: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-00035170: 6e74 656e 7422 3a20 2261 6263 222c 0a20  ntent": "abc",. 
-00035180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035190: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
-000351a0: 6422 3a20 2262 6962 7465 7822 2c0a 2020  d": "bibtex",.  
-000351b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000351c0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000351d0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-000351e0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000351f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035200: 5f77 2e61 7373 6572 745f 6e6f 745f 6361  _w.assert_not_ca
-00035210: 6c6c 6564 2829 0a20 2020 2020 2020 2073  lled().        s
-00035220: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00035230: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
-00035240: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
-00035250: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00035260: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
-00035270: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
-00035280: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-00035290: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-000352a0: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
-000352b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000352c0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00035140: 2020 2020 2022 6669 656c 6422 3a20 2262       "field": "b
+00035150: 6962 7465 7822 2c0a 2020 2020 2020 2020  ibtex",.        
+00035160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035170: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00035180: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+00035190: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000351a0: 2020 2020 2020 2020 2020 5f77 2e61 7373            _w.ass
+000351b0: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+000351c0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000351d0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+000351e0: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
+000351f0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00035200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035210: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
+00035220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035230: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
+00035240: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
+00035250: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
+00035260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035270: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+00035280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035290: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+000352a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000352b0: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
+000352c0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
 000352d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000352e0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-000352f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035300: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-00035310: 3a20 2254 6578 7422 2c0a 2020 2020 2020  : "Text",.      
-00035320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035330: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-00035340: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
-00035350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035360: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-00035370: 6f72 223a 2022 3d22 2c0a 2020 2020 2020  or": "=",.      
-00035380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035390: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-000353a0: 6e74 223a 2022 6162 6322 2c0a 2020 2020  nt": "abc",.    
-000353b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000353c0: 2020 2020 2020 2020 2020 2020 2266 6965              "fie
-000353d0: 6c64 223a 2022 6269 626b 6579 222c 0a20  ld": "bibkey",. 
-000353e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000353f0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00035400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035410: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00035420: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
-00035430: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-00035440: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-00035450: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00035460: 2020 2020 2020 5b22 6162 6322 5d2c 0a20        ["abc"],. 
-00035470: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00035480: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00035490: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-000354a0: 6f72 7465 6428 0a20 2020 2020 2020 2020  orted(.         
-000354b0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-000354c0: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
-000354d0: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
-000354e0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000354f0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00035500: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
-00035510: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-00035520: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+000352e0: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+000352f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00035300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035310: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+00035320: 3d22 2c0a 2020 2020 2020 2020 2020 2020  =",.            
+00035330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035340: 2020 2020 2263 6f6e 7465 6e74 223a 2022      "content": "
+00035350: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
+00035360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035370: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
+00035380: 6269 626b 6579 222c 0a20 2020 2020 2020  bibkey",.       
+00035390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000353a0: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+000353b0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+000353c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000353d0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+000353e0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+000353f0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+00035400: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+00035410: 5b22 6162 6322 5d2c 0a20 2020 2020 2020  ["abc"],.       
+00035420: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00035430: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00035440: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
+00035450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035460: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00035470: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
+00035480: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+00035490: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
+000354a0: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+000354b0: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
+000354c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000354d0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+000354e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000354f0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00035500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035510: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
+00035520: 6578 7422 2c0a 2020 2020 2020 2020 2020  ext",.          
 00035530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035540: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00035550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035560: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00035570: 6522 3a20 2254 6578 7422 2c0a 2020 2020  e": "Text",.    
-00035580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035590: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-000355a0: 6963 616c 223a 2022 222c 0a20 2020 2020  ical": "",.     
-000355b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000355c0: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
-000355d0: 6174 6f72 223a 2022 6578 6163 7420 6d61  ator": "exact ma
-000355e0: 7463 6822 2c0a 2020 2020 2020 2020 2020  tch",.          
-000355f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035600: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
-00035610: 2022 6162 6322 2c0a 2020 2020 2020 2020   "abc",.        
-00035620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035630: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00035640: 2022 6269 626b 6579 222c 0a20 2020 2020   "bibkey",.     
-00035650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035660: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00035670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035680: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
-00035690: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
-000356a0: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
-000356b0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-000356c0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-000356d0: 2020 5b22 6162 6322 5d2c 0a20 2020 2020    ["abc"],.     
-000356e0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-000356f0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00035700: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
-00035710: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-00035720: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00035730: 2020 2020 2020 2020 2065 5b22 6269 626b           e["bibk
-00035740: 6579 225d 0a20 2020 2020 2020 2020 2020  ey"].           
-00035750: 2020 2020 2020 2020 2066 6f72 2065 2069           for e i
-00035760: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-00035770: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
-00035780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035790: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
+00035540: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
+00035550: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00035560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035570: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
+00035580: 2022 6578 6163 7420 6d61 7463 6822 2c0a   "exact match",.
+00035590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000355a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000355b0: 2263 6f6e 7465 6e74 223a 2022 6162 6322  "content": "abc"
+000355c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000355d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000355e0: 2020 2266 6965 6c64 223a 2022 6269 626b    "field": "bibk
+000355f0: 6579 222c 0a20 2020 2020 2020 2020 2020  ey",.           
+00035600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035610: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+00035620: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00035630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035640: 2029 2e6c 6173 7446 6574 6368 6564 0a20   ).lastFetched. 
+00035650: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00035660: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00035670: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+00035680: 6322 5d2c 0a20 2020 2020 2020 2029 0a20  c"],.        ). 
+00035690: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000356a0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000356b0: 2020 2020 2073 6f72 7465 6428 0a20 2020       sorted(.   
+000356c0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+000356d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000356e0: 2020 2065 5b22 6269 626b 6579 225d 0a20     e["bibkey"]. 
+000356f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035700: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
+00035710: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+00035720: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
+00035730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035740: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+00035750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035760: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00035770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035780: 2020 2274 7970 6522 3a20 2254 6578 7422    "type": "Text"
+00035790: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 000357a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000357b0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-000357c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000357d0: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
-000357e0: 2254 6578 7422 2c0a 2020 2020 2020 2020  "Text",.        
-000357f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035800: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
-00035810: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-00035820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035830: 2020 2020 2020 2022 6f70 6572 6174 6f72         "operator
-00035840: 223a 2022 6c69 6b65 222c 0a20 2020 2020  ": "like",.     
-00035850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035860: 2020 2020 2020 2020 2020 2022 636f 6e74             "cont
-00035870: 656e 7422 3a20 2261 6263 222c 0a20 2020  ent": "abc",.   
+000357b0: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
+000357c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000357d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000357e0: 2022 6f70 6572 6174 6f72 223a 2022 6c69   "operator": "li
+000357f0: 6b65 222c 0a20 2020 2020 2020 2020 2020  ke",.           
+00035800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035810: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
+00035820: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
+00035830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035840: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
+00035850: 2262 6962 7465 7822 2c0a 2020 2020 2020  "bibtex",.      
+00035860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035870: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
 00035880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035890: 2020 2020 2020 2020 2020 2020 2022 6669               "fi
-000358a0: 656c 6422 3a20 2262 6962 7465 7822 2c0a  eld": "bibtex",.
-000358b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000358c0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-000358d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000358e0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-000358f0: 2020 2020 2020 2020 2020 2020 292e 6c61              ).la
-00035900: 7374 4665 7463 6865 640a 2020 2020 2020  stFetched.      
-00035910: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-00035920: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00035930: 2020 2020 2020 205b 2261 6263 225d 2c0a         ["abc"],.
-00035940: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00035950: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00035960: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00035970: 736f 7274 6564 280a 2020 2020 2020 2020  sorted(.        
-00035980: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00035990: 2020 2020 2020 2020 2020 2020 2020 655b                e[
-000359a0: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
-000359b0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000359c0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-000359d0: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
-000359e0: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
-000359f0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+00035890: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000358a0: 2020 2020 2020 292e 6c61 7374 4665 7463        ).lastFetc
+000358b0: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
+000358c0: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+000358d0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+000358e0: 205b 2261 6263 225d 2c0a 2020 2020 2020   ["abc"],.      
+000358f0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00035900: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00035910: 2020 2020 2020 2020 2020 736f 7274 6564            sorted
+00035920: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00035930: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+00035940: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
+00035950: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+00035960: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
+00035970: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00035980: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
+00035990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000359a0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+000359b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000359c0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+000359d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000359e0: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
+000359f0: 5465 7874 222c 0a20 2020 2020 2020 2020  Text",.         
 00035a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a10: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-00035a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a30: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-00035a40: 7065 223a 2022 5465 7874 222c 0a20 2020  pe": "Text",.   
-00035a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a60: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-00035a70: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
-00035a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035a90: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
-00035aa0: 7261 746f 7222 3a20 2263 6f6e 7461 696e  rator": "contain
-00035ab0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
-00035ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ad0: 2020 2020 2263 6f6e 7465 6e74 223a 2022      "content": "
-00035ae0: 6162 6322 2c0a 2020 2020 2020 2020 2020  abc",.          
-00035af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035b00: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
-00035b10: 6269 6274 6578 222c 0a20 2020 2020 2020  bibtex",.       
-00035b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035b30: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-00035b40: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00035b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035b60: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-00035b70: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-00035b80: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00035b90: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-00035ba0: 5b22 6162 6322 5d2c 0a20 2020 2020 2020  ["abc"],.       
-00035bb0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00035bc0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00035bd0: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
-00035be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035bf0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00035c00: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00035c10: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00035c20: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
-00035c30: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-00035c40: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
-00035c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c60: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00035a10: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+00035a20: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00035a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035a40: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
+00035a50: 3a20 2263 6f6e 7461 696e 7322 2c0a 2020  : "contains",.  
+00035a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035a70: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00035a80: 6f6e 7465 6e74 223a 2022 6162 6322 2c0a  ontent": "abc",.
+00035a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ab0: 2266 6965 6c64 223a 2022 6269 6274 6578  "field": "bibtex
+00035ac0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00035ad0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00035ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035af0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+00035b00: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00035b10: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+00035b20: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+00035b30: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+00035b40: 2020 2020 2020 2020 2020 5b22 6162 6322            ["abc"
+00035b50: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00035b60: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00035b70: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00035b80: 2020 2073 6f72 7465 6428 0a20 2020 2020     sorted(.     
+00035b90: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+00035ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035bb0: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+00035bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035bd0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+00035be0: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
+00035bf0: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
+00035c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035c10: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00035c20: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+00035c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035c50: 2274 7970 6522 3a20 2254 6578 7422 2c0a  "type": "Text",.
+00035c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00035c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035c80: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00035c80: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
 00035c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ca0: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
-00035cb0: 6578 7422 2c0a 2020 2020 2020 2020 2020  ext",.          
-00035cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035cd0: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-00035ce0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00035cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035d00: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-00035d10: 2022 6e6f 7420 6c69 6b65 222c 0a20 2020   "not like",.   
-00035d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035d30: 2020 2020 2020 2020 2020 2020 2022 636f               "co
-00035d40: 6e74 656e 7422 3a20 226d 6e6f 222c 0a20  ntent": "mno",. 
+00035ca0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00035cb0: 6f70 6572 6174 6f72 223a 2022 6e6f 7420  operator": "not 
+00035cc0: 6c69 6b65 222c 0a20 2020 2020 2020 2020  like",.         
+00035cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ce0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
+00035cf0: 3a20 226d 6e6f 222c 0a20 2020 2020 2020  : "mno",.       
+00035d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035d10: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
+00035d20: 3a20 2261 7278 6976 222c 0a20 2020 2020  : "arxiv",.     
+00035d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035d40: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
 00035d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035d60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00035d70: 6669 656c 6422 3a20 2261 7278 6976 222c  field": "arxiv",
-00035d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035d90: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
-00035da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035db0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00035dc0: 2020 2020 2020 2020 2020 2020 2029 2e6c               ).l
-00035dd0: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
-00035de0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00035df0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-00035e00: 2020 2020 2020 2020 5b22 6162 6322 2c20          ["abc", 
-00035e10: 2264 6566 222c 2022 6768 6922 2c20 226a  "def", "ghi", "j
-00035e20: 6b6c 222c 2022 7071 7222 5d2c 0a20 2020  kl", "pqr"],.   
-00035e30: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00035e40: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00035e50: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
-00035e60: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
-00035e70: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-00035e80: 2020 2020 2020 2020 2020 2065 5b22 6269             e["bi
-00035e90: 626b 6579 225d 0a20 2020 2020 2020 2020  bkey"].         
-00035ea0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-00035eb0: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-00035ec0: 6273 2e66 6574 6368 4672 6f6d 4469 6374  bs.fetchFromDict
-00035ed0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00035ee0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00035d60: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+00035d70: 2020 2020 2020 2029 2e6c 6173 7446 6574         ).lastFet
+00035d80: 6368 6564 0a20 2020 2020 2020 2020 2020  ched.           
+00035d90: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00035da0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+00035db0: 2020 5b22 6162 6322 2c20 2264 6566 222c    ["abc", "def",
+00035dc0: 2022 6768 6922 2c20 226a 6b6c 222c 2022   "ghi", "jkl", "
+00035dd0: 7071 7222 5d2c 0a20 2020 2020 2020 2029  pqr"],.        )
+00035de0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00035df0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00035e00: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
+00035e10: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00035e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035e30: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
+00035e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035e50: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
+00035e60: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
+00035e70: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
+00035e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035e90: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+00035ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035eb0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00035ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ed0: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
+00035ee0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
 00035ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035f00: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00035f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035f20: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-00035f30: 3a20 2254 6578 7422 2c0a 2020 2020 2020  : "Text",.      
-00035f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035f50: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-00035f60: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
-00035f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035f80: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-00035f90: 6f72 223a 2022 646f 6573 206e 6f74 2063  or": "does not c
-00035fa0: 6f6e 7461 696e 222c 0a20 2020 2020 2020  ontain",.       
-00035fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035fc0: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
-00035fd0: 7422 3a20 226d 6e6f 222c 0a20 2020 2020  t": "mno",.     
-00035fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ff0: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
-00036000: 6422 3a20 2261 7278 6976 222c 0a20 2020  d": "arxiv",.   
-00036010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036020: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00036030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036040: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00036050: 2020 2020 2020 2020 2029 2e6c 6173 7446           ).lastF
-00036060: 6574 6368 6564 0a20 2020 2020 2020 2020  etched.         
-00036070: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00036080: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00036090: 2020 2020 5b22 6162 6322 2c20 2264 6566      ["abc", "def
-000360a0: 222c 2022 6768 6922 2c20 226a 6b6c 222c  ", "ghi", "jkl",
-000360b0: 2022 7071 7222 5d2c 0a20 2020 2020 2020   "pqr"],.       
-000360c0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-000360d0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-000360e0: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
-000360f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036100: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00036110: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
-00036120: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00036130: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
-00036140: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-00036150: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
-00036160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036170: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00035f00: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+00035f10: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00035f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035f30: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+00035f40: 646f 6573 206e 6f74 2063 6f6e 7461 696e  does not contain
+00035f50: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00035f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035f70: 2020 2022 636f 6e74 656e 7422 3a20 226d     "content": "m
+00035f80: 6e6f 222c 0a20 2020 2020 2020 2020 2020  no",.           
+00035f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035fa0: 2020 2020 2022 6669 656c 6422 3a20 2261       "field": "a
+00035fb0: 7278 6976 222c 0a20 2020 2020 2020 2020  rxiv",.         
+00035fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035fd0: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00035fe0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+00035ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036000: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
+00036010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036020: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
+00036030: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+00036040: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
+00036050: 6922 2c20 226a 6b6c 222c 2022 7071 7222  i", "jkl", "pqr"
+00036060: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
+00036070: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00036080: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00036090: 2020 2073 6f72 7465 6428 0a20 2020 2020     sorted(.     
+000360a0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+000360b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000360c0: 2065 5b22 6269 626b 6579 225d 0a20 2020   e["bibkey"].   
+000360d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000360e0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+000360f0: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
+00036100: 6f6d 4469 6374 280a 2020 2020 2020 2020  omDict(.        
+00036110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036120: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00036130: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+00036140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036160: 2274 7970 6522 3a20 2254 6578 7422 2c0a  "type": "Text",.
+00036170: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00036180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036190: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00036190: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
 000361a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000361b0: 2020 2020 2020 2274 7970 6522 3a20 2254        "type": "T
-000361c0: 6578 7422 2c0a 2020 2020 2020 2020 2020  ext",.          
-000361d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000361e0: 2020 2020 2020 226c 6f67 6963 616c 223a        "logical":
-000361f0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00036200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036210: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
-00036220: 2022 6469 6666 6572 656e 7420 6672 6f6d   "different from
-00036230: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00036240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036250: 2020 2022 636f 6e74 656e 7422 3a20 2270     "content": "p
-00036260: 712e 7222 2c0a 2020 2020 2020 2020 2020  q.r",.          
-00036270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036280: 2020 2020 2020 2266 6965 6c64 223a 2022        "field": "
-00036290: 6172 7869 7622 2c0a 2020 2020 2020 2020  arxiv",.        
-000362a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362b0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-000362c0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-000362d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362e0: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
-000362f0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00036300: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00036310: 292c 0a20 2020 2020 2020 2020 2020 205b  ),.            [
-00036320: 2261 6263 222c 2022 6465 6622 2c20 2267  "abc", "def", "g
-00036330: 6869 222c 2022 6a6b 6c22 2c20 226d 6e6f  hi", "jkl", "mno
-00036340: 225d 2c0a 2020 2020 2020 2020 290a 2020  "],.        ).  
-00036350: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00036360: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00036370: 2020 2020 736f 7274 6564 280a 2020 2020      sorted(.    
-00036380: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00036390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000363a0: 2020 655b 2262 6962 6b65 7922 5d0a 2020    e["bibkey"].  
+000361b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000361c0: 6f70 6572 6174 6f72 223a 2022 6469 6666  operator": "diff
+000361d0: 6572 656e 7420 6672 6f6d 222c 0a20 2020  erent from",.   
+000361e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000361f0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+00036200: 6e74 656e 7422 3a20 2270 712e 7222 2c0a  ntent": "pq.r",.
+00036210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036230: 2266 6965 6c64 223a 2022 6172 7869 7622  "field": "arxiv"
+00036240: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00036250: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+00036260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036270: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00036280: 2020 2020 2020 2020 2020 2020 2020 292e                ).
+00036290: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
+000362a0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+000362b0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+000362c0: 2020 2020 2020 2020 205b 2261 6263 222c           ["abc",
+000362d0: 2022 6465 6622 2c20 2267 6869 222c 2022   "def", "ghi", "
+000362e0: 6a6b 6c22 2c20 226d 6e6f 225d 2c0a 2020  jkl", "mno"],.  
+000362f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00036300: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00036310: 280a 2020 2020 2020 2020 2020 2020 736f  (.            so
+00036320: 7274 6564 280a 2020 2020 2020 2020 2020  rted(.          
+00036330: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00036340: 2020 2020 2020 2020 2020 2020 655b 2262              e["b
+00036350: 6962 6b65 7922 5d0a 2020 2020 2020 2020  ibkey"].        
+00036360: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00036370: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+00036380: 6962 732e 6665 7463 6846 726f 6d44 6963  ibs.fetchFromDic
+00036390: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+000363a0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
 000363b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000363c0: 2020 666f 7220 6520 696e 2073 656c 662e    for e in self.
-000363d0: 7042 4442 2e62 6962 732e 6665 7463 6846  pBDB.bibs.fetchF
-000363e0: 726f 6d44 6963 7428 0a20 2020 2020 2020  romDict(.       
-000363f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036400: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00036410: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00036420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000363c0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+000363d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000363e0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+000363f0: 223a 2022 5465 7874 222c 0a20 2020 2020  ": "Text",.     
+00036400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036410: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+00036420: 6361 6c22 3a20 2222 2c0a 2020 2020 2020  cal": "",.      
 00036430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036440: 2022 7479 7065 223a 2022 5465 7874 222c   "type": "Text",
-00036450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036440: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
+00036450: 746f 7222 3a20 2221 3d22 2c0a 2020 2020  tor": "!=",.    
 00036460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036470: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
-00036480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036470: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+00036480: 7465 6e74 223a 2022 7071 2e72 222c 0a20  tent": "pq.r",. 
 00036490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000364a0: 226f 7065 7261 746f 7222 3a20 2221 3d22  "operator": "!="
-000364b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000364c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000364d0: 2020 2263 6f6e 7465 6e74 223a 2022 7071    "content": "pq
-000364e0: 2e72 222c 0a20 2020 2020 2020 2020 2020  .r",.           
-000364f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036500: 2020 2020 2022 6669 656c 6422 3a20 2261       "field": "a
-00036510: 7278 6976 222c 0a20 2020 2020 2020 2020  rxiv",.         
-00036520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036530: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-00036540: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-00036550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036560: 2020 2029 2e6c 6173 7446 6574 6368 6564     ).lastFetched
-00036570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036580: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
-00036590: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
-000365a0: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
-000365b0: 6922 2c20 226a 6b6c 222c 2022 6d6e 6f22  i", "jkl", "mno"
-000365c0: 5d2c 0a20 2020 2020 2020 2029 0a20 2020  ],.        ).   
-000365d0: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-000365e0: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-000365f0: 7761 726e 696e 6722 2920 6173 205f 773a  warning") as _w:
-00036600: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00036610: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00036620: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00036630: 6f72 7465 6428 0a20 2020 2020 2020 2020  orted(.         
-00036640: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-00036650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036660: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-00036670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036680: 2020 2020 2020 2020 2066 6f72 2065 2069           for e i
-00036690: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
-000366a0: 2e66 6574 6368 4672 6f6d 4469 6374 280a  .fetchFromDict(.
-000366b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000366c0: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+000364a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000364b0: 6669 656c 6422 3a20 2261 7278 6976 222c  field": "arxiv",
+000364c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000364d0: 2020 2020 2020 2020 2020 2020 207d 0a20               }. 
+000364e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000364f0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+00036500: 2020 2020 2020 2020 2020 2020 2029 2e6c               ).l
+00036510: 6173 7446 6574 6368 6564 0a20 2020 2020  astFetched.     
+00036520: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00036530: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+00036540: 2020 2020 2020 2020 5b22 6162 6322 2c20          ["abc", 
+00036550: 2264 6566 222c 2022 6768 6922 2c20 226a  "def", "ghi", "j
+00036560: 6b6c 222c 2022 6d6e 6f22 5d2c 0a20 2020  kl", "mno"],.   
+00036570: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
+00036580: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
+00036590: 6e67 2e4c 6f67 6765 722e 7761 726e 696e  ng.Logger.warnin
+000365a0: 6722 2920 6173 205f 773a 0a20 2020 2020  g") as _w:.     
+000365b0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000365c0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000365d0: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
+000365e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000365f0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+00036600: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00036610: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+00036620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036630: 2020 2066 6f72 2065 2069 6e20 7365 6c66     for e in self
+00036640: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+00036650: 4672 6f6d 4469 6374 280a 2020 2020 2020  FromDict(.      
+00036660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036670: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00036680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036690: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+000366a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000366b0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+000366c0: 7970 6522 3a20 2254 6578 7422 2c0a 2020  ype": "Text",.  
 000366d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000366e0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-000366f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036710: 2020 2020 2274 7970 6522 3a20 2254 6578      "type": "Tex
-00036720: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-00036730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036740: 2020 2020 2020 2020 226c 6f67 6963 616c          "logical
-00036750: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-00036760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036770: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
-00036780: 6174 6f72 223a 2022 6c69 6b65 222c 0a20  ator": "like",. 
-00036790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000367a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000367b0: 2020 2022 636f 6e74 656e 7422 3a20 2261     "content": "a
-000367c0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+000366e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000366f0: 2020 226c 6f67 6963 616c 223a 2022 222c    "logical": "",
+00036700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036720: 2020 2020 2022 6f70 6572 6174 6f72 223a       "operator":
+00036730: 2022 6c69 6b65 222c 0a20 2020 2020 2020   "like",.       
+00036740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036750: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+00036760: 6e74 656e 7422 3a20 2261 6263 222c 0a20  ntent": "abc",. 
+00036770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036790: 2020 2022 6669 656c 6422 3a20 2262 6962     "field": "bib
+000367a0: 7465 7822 2c0a 2020 2020 2020 2020 2020  tex",.          
+000367b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000367c0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
 000367d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000367e0: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
-000367f0: 3a20 2262 6962 7465 7822 2c0a 2020 2020  : "bibtex",.    
-00036800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036810: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+000367e0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+000367f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036800: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00036810: 7479 7065 223a 2022 5465 7874 222c 0a20  type": "Text",. 
 00036820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036830: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00036840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036860: 2020 2020 2022 7479 7065 223a 2022 5465       "type": "Te
-00036870: 7874 222c 0a20 2020 2020 2020 2020 2020  xt",.           
-00036880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036890: 2020 2020 2020 2020 2022 6c6f 6769 6361           "logica
-000368a0: 6c22 3a20 2222 2c0a 2020 2020 2020 2020  l": "",.        
-000368b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000368c0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
-000368d0: 7261 746f 7222 3a20 2264 6966 6665 7265  rator": "differe
-000368e0: 6e74 222c 0a20 2020 2020 2020 2020 2020  nt",.           
-000368f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036900: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
-00036910: 7422 3a20 2261 6263 222c 0a20 2020 2020  t": "abc",.     
+00036830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036840: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
+00036850: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00036860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036870: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
+00036880: 3a20 2264 6966 6665 7265 6e74 222c 0a20  : "different",. 
+00036890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000368a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000368b0: 2020 2022 636f 6e74 656e 7422 3a20 2261     "content": "a
+000368c0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+000368d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000368e0: 2020 2020 2020 2020 2022 6669 656c 6422           "field"
+000368f0: 3a20 2262 6962 7465 7822 2c0a 2020 2020  : "bibtex",.    
+00036900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036910: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
 00036920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036930: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00036940: 6669 656c 6422 3a20 2262 6962 7465 7822  field": "bibtex"
-00036950: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00036960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036970: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-00036980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036990: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
-000369a0: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
-000369b0: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-000369c0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-000369d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000369e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000369f0: 2020 5b22 6162 6322 5d2c 0a20 2020 2020    ["abc"],.     
-00036a00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00036a10: 2020 2020 205f 772e 6173 7365 7274 5f63       _w.assert_c
-00036a20: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00036a30: 2249 6e76 616c 6964 206f 7065 7261 746f  "Invalid operato
-00036a40: 723a 2027 6469 6666 6572 656e 7427 2229  r: 'different'")
-00036a50: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00036a60: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00036a70: 2020 2020 2020 2073 6f72 7465 6428 0a20         sorted(. 
-00036a80: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00036a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036aa0: 2020 2020 2065 5b22 6269 626b 6579 225d       e["bibkey"]
-00036ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036ac0: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
-00036ad0: 6c66 2e70 4244 422e 6269 6273 2e66 6574  lf.pBDB.bibs.fet
-00036ae0: 6368 4672 6f6d 4469 6374 280a 2020 2020  chFromDict(.    
-00036af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b00: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+00036930: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00036940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036950: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+00036960: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+00036970: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+00036980: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+00036990: 2020 2020 2020 2020 2020 2020 5b22 6162              ["ab
+000369a0: 6322 5d2c 0a20 2020 2020 2020 2020 2020  c"],.           
+000369b0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
+000369c0: 772e 6173 7365 7274 5f63 616c 6c65 645f  w.assert_called_
+000369d0: 6f6e 6365 5f77 6974 6828 2249 6e76 616c  once_with("Inval
+000369e0: 6964 206f 7065 7261 746f 723a 2027 6469  id operator: 'di
+000369f0: 6666 6572 656e 7427 2229 0a20 2020 2020  fferent'").     
+00036a00: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00036a10: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00036a20: 2073 6f72 7465 6428 0a20 2020 2020 2020   sorted(.       
+00036a30: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+00036a40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00036a50: 5b22 6269 626b 6579 225d 0a20 2020 2020  ["bibkey"].     
+00036a60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00036a70: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+00036a80: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
+00036a90: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
+00036aa0: 2020 2020 2020 2020 2020 2020 2020 5b0a                [.
+00036ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ac0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00036ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ae0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00036af0: 7970 6522 3a20 2243 6174 6567 6f72 6965  ype": "Categorie
+00036b00: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
 00036b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b20: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00036b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b40: 2020 2020 2274 7970 6522 3a20 2243 6174      "type": "Cat
-00036b50: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
-00036b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b70: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
-00036b80: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
-00036b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ba0: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
-00036bb0: 6f72 223a 2022 222c 0a20 2020 2020 2020  or": "",.       
-00036bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036bd0: 2020 2020 2020 2020 2022 636f 6e74 656e           "conten
-00036be0: 7422 3a20 312c 0a20 2020 2020 2020 2020  t": 1,.         
-00036bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c00: 2020 2020 2020 2022 6669 656c 6422 3a20         "field": 
-00036c10: 2262 6962 7465 7822 2c0a 2020 2020 2020  "bibtex",.      
-00036c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c30: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00036b20: 2020 2020 226c 6f67 6963 616c 223a 2022      "logical": "
+00036b30: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00036b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b50: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
+00036b60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00036b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b80: 2020 2022 636f 6e74 656e 7422 3a20 312c     "content": 1,
+00036b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036bb0: 2022 6669 656c 6422 3a20 2262 6962 7465   "field": "bibte
+00036bc0: 7822 2c0a 2020 2020 2020 2020 2020 2020  x",.            
+00036bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036be0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00036bf0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00036c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c20: 2022 7479 7065 223a 2022 5465 7874 222c   "type": "Text",
+00036c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00036c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c50: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+00036c50: 2022 6c6f 6769 6361 6c22 3a20 2222 2c0a   "logical": "",.
 00036c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c70: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
-00036c80: 5465 7874 222c 0a20 2020 2020 2020 2020  Text",.         
-00036c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ca0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
-00036cb0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-00036cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036cd0: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
-00036ce0: 3a20 226c 696b 6522 2c0a 2020 2020 2020  : "like",.      
-00036cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d00: 2020 2020 2020 2020 2020 2263 6f6e 7465            "conte
-00036d10: 6e74 223a 2022 6465 222c 0a20 2020 2020  nt": "de",.     
-00036d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d30: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
-00036d40: 6422 3a20 2262 6962 7465 7822 2c0a 2020  d": "bibtex",.  
-00036d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d60: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-00036d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d80: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00036d90: 2020 2020 2020 2020 2020 2029 2e6c 6173             ).las
-00036da0: 7446 6574 6368 6564 0a20 2020 2020 2020  tFetched.       
-00036db0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-00036dc0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00036dd0: 2020 2020 2020 5b22 6465 6622 5d2c 0a20        ["def"],. 
-00036de0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00036df0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00036e00: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-00036e10: 6f72 7465 6428 0a20 2020 2020 2020 2020  orted(.         
-00036e20: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-00036e30: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
-00036e40: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
-00036e50: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00036e60: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00036e70: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
-00036e80: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-00036e90: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00036c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c80: 226f 7065 7261 746f 7222 3a20 226c 696b  "operator": "lik
+00036c90: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00036ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036cb0: 2020 2020 2263 6f6e 7465 6e74 223a 2022      "content": "
+00036cc0: 6465 222c 0a20 2020 2020 2020 2020 2020  de",.           
+00036cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ce0: 2020 2020 2022 6669 656c 6422 3a20 2262       "field": "b
+00036cf0: 6962 7465 7822 2c0a 2020 2020 2020 2020  ibtex",.        
+00036d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d10: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+00036d20: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00036d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036d40: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
+00036d50: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+00036d60: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+00036d70: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+00036d80: 5b22 6465 6622 5d2c 0a20 2020 2020 2020  ["def"],.       
+00036d90: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00036da0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00036db0: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
+00036dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036dd0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00036de0: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
+00036df0: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+00036e00: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
+00036e10: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+00036e20: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
+00036e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e40: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+00036e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e60: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00036e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e80: 2020 2020 2020 2274 7970 6522 3a20 2245        "type": "E
+00036e90: 7870 6572 696d 656e 7473 222c 0a20 2020  xperiments",.   
 00036ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036eb0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00036ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ed0: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00036ee0: 6522 3a20 2245 7870 6572 696d 656e 7473  e": "Experiments
-00036ef0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00036eb0: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
+00036ec0: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
+00036ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ee0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
+00036ef0: 7261 746f 7222 3a20 2222 2c0a 2020 2020  rator": "",.    
 00036f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f10: 2020 2022 6c6f 6769 6361 6c22 3a20 2222     "logical": ""
-00036f20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00036f10: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+00036f20: 7465 6e74 223a 2030 2c0a 2020 2020 2020  tent": 0,.      
 00036f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f40: 2020 226f 7065 7261 746f 7222 3a20 2222    "operator": ""
-00036f50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00036f40: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+00036f50: 223a 2022 6269 6274 6578 222c 0a20 2020  ": "bibtex",.   
 00036f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f70: 2020 2263 6f6e 7465 6e74 223a 2030 2c0a    "content": 0,.
+00036f70: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
 00036f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036fa0: 2266 6965 6c64 223a 2022 6269 6274 6578  "field": "bibtex
-00036fb0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00036fc0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00036fd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00036fe0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00036ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036f90: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00036fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036fb0: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+00036fc0: 3a20 2254 6578 7422 2c0a 2020 2020 2020  : "Text",.      
+00036fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036fe0: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+00036ff0: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
 00037000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037010: 2274 7970 6522 3a20 2254 6578 7422 2c0a  "type": "Text",.
-00037020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037010: 2020 2020 2020 2020 2022 6f70 6572 6174           "operat
+00037020: 6f72 223a 2022 6c69 6b65 222c 0a20 2020  or": "like",.   
 00037030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037040: 226c 6f67 6963 616c 223a 2022 222c 0a20  "logical": "",. 
-00037050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037060: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00037070: 6f70 6572 6174 6f72 223a 2022 6c69 6b65  operator": "like
-00037080: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00037090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000370a0: 2020 2022 636f 6e74 656e 7422 3a20 226d     "content": "m
-000370b0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-000370c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000370d0: 2020 2020 2266 6965 6c64 223a 2022 6269      "field": "bi
-000370e0: 6274 6578 222c 0a20 2020 2020 2020 2020  btex",.         
-000370f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037100: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-00037110: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-00037120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037130: 2020 2020 292e 6c61 7374 4665 7463 6865      ).lastFetche
-00037140: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00037150: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00037160: 292c 0a20 2020 2020 2020 2020 2020 205b  ),.            [
-00037170: 2261 6263 222c 2022 6465 6622 5d2c 0a20  "abc", "def"],. 
-00037180: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00037190: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000371a0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-000371b0: 6f72 7465 6428 0a20 2020 2020 2020 2020  orted(.         
-000371c0: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
-000371d0: 2020 2020 2020 2020 2020 2020 2065 5b22               e["
-000371e0: 6269 626b 6579 225d 0a20 2020 2020 2020  bibkey"].       
-000371f0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00037200: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00037210: 6269 6273 2e66 6574 6368 4672 6f6d 4469  bibs.fetchFromDi
-00037220: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-00037230: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+00037040: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+00037050: 6e74 656e 7422 3a20 226d 6522 2c0a 2020  ntent": "me",.  
+00037060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037070: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+00037080: 6965 6c64 223a 2022 6269 6274 6578 222c  ield": "bibtex",
+00037090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000370a0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+000370b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000370c0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+000370d0: 2020 2020 2020 2020 2020 2020 2020 292e                ).
+000370e0: 6c61 7374 4665 7463 6865 640a 2020 2020  lastFetched.    
+000370f0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00037100: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00037110: 2020 2020 2020 2020 205b 2261 6263 222c           ["abc",
+00037120: 2022 6465 6622 5d2c 0a20 2020 2020 2020   "def"],.       
+00037130: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00037140: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00037150: 2020 2020 2020 2020 2073 6f72 7465 6428           sorted(
+00037160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037170: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00037180: 2020 2020 2020 2065 5b22 6269 626b 6579         e["bibkey
+00037190: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+000371a0: 2020 2020 2020 2066 6f72 2065 2069 6e20         for e in 
+000371b0: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+000371c0: 6574 6368 4672 6f6d 4469 6374 280a 2020  etchFromDict(.  
+000371d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000371e0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+000371f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037200: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00037210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037220: 2020 2020 2020 2274 7970 6522 3a20 224d        "type": "M
+00037230: 6172 6b73 222c 0a20 2020 2020 2020 2020  arks",.         
 00037240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037250: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00037260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037270: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00037280: 6522 3a20 224d 6172 6b73 222c 0a20 2020  e": "Marks",.   
-00037290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000372a0: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-000372b0: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
-000372c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000372d0: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
-000372e0: 7261 746f 7222 3a20 2222 2c0a 2020 2020  rator": "",.    
-000372f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037300: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-00037310: 7465 6e74 223a 205b 2269 6d70 225d 2c0a  tent": ["imp"],.
+00037250: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+00037260: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00037270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037280: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
+00037290: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+000372a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000372b0: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+000372c0: 205b 2269 6d70 225d 2c0a 2020 2020 2020   ["imp"],.      
+000372d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000372e0: 2020 2020 2020 2020 2020 2266 6965 6c64            "field
+000372f0: 223a 2022 6269 6274 6578 222c 0a20 2020  ": "bibtex",.   
+00037300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037310: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
 00037320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037340: 2266 6965 6c64 223a 2022 6269 6274 6578  "field": "bibtex
-00037350: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00037360: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00037370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00037380: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00037390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037330: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00037340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037350: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+00037360: 3a20 2254 6578 7422 2c0a 2020 2020 2020  : "Text",.      
+00037370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037380: 2020 2020 2020 2020 2020 226c 6f67 6963            "logic
+00037390: 616c 223a 2022 6f72 222c 0a20 2020 2020  al": "or",.     
 000373a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373b0: 2274 7970 6522 3a20 2254 6578 7422 2c0a  "type": "Text",.
-000373c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000373b0: 2020 2020 2020 2020 2020 2022 6f70 6572             "oper
+000373c0: 6174 6f72 223a 2022 6c69 6b65 222c 0a20  ator": "like",. 
 000373d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373e0: 226c 6f67 6963 616c 223a 2022 6f72 222c  "logical": "or",
-000373f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000373e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000373f0: 636f 6e74 656e 7422 3a20 2264 222c 0a20  content": "d",. 
 00037400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037410: 2022 6f70 6572 6174 6f72 223a 2022 6c69   "operator": "li
-00037420: 6b65 222c 0a20 2020 2020 2020 2020 2020  ke",.           
-00037430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037440: 2020 2020 2022 636f 6e74 656e 7422 3a20       "content": 
-00037450: 2264 222c 0a20 2020 2020 2020 2020 2020  "d",.           
-00037460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037470: 2020 2020 2022 6669 656c 6422 3a20 2262       "field": "b
-00037480: 6962 7465 7822 2c0a 2020 2020 2020 2020  ibtex",.        
-00037490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000374a0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-000374b0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-000374c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000374d0: 2020 2020 2029 2e6c 6173 7446 6574 6368       ).lastFetch
-000374e0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-000374f0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00037500: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-00037510: 5b22 6465 6622 2c20 226d 6e6f 225d 2c0a  ["def", "mno"],.
-00037520: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00037530: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00037540: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00037550: 736f 7274 6564 280a 2020 2020 2020 2020  sorted(.        
-00037560: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00037570: 2020 2020 2020 2020 2020 2020 2020 655b                e[
-00037580: 2262 6962 6b65 7922 5d0a 2020 2020 2020  "bibkey"].      
-00037590: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000375a0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-000375b0: 2e62 6962 732e 6665 7463 6846 726f 6d44  .bibs.fetchFromD
-000375c0: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
-000375d0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+00037410: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00037420: 6669 656c 6422 3a20 2262 6962 7465 7822  field": "bibtex"
+00037430: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00037440: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+00037450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037460: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+00037470: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00037480: 2e6c 6173 7446 6574 6368 6564 0a20 2020  .lastFetched.   
+00037490: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+000374a0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+000374b0: 2020 2020 2020 2020 2020 5b22 6465 6622            ["def"
+000374c0: 2c20 226d 6e6f 225d 2c0a 2020 2020 2020  , "mno"],.      
+000374d0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+000374e0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+000374f0: 2020 2020 2020 2020 2020 736f 7274 6564            sorted
+00037500: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00037510: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+00037520: 2020 2020 2020 2020 655b 2262 6962 6b65          e["bibke
+00037530: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+00037540: 2020 2020 2020 2020 666f 7220 6520 696e          for e in
+00037550: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00037560: 6665 7463 6846 726f 6d44 6963 7428 0a20  fetchFromDict(. 
+00037570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037580: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+00037590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000375a0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+000375b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000375c0: 2020 2020 2020 2022 7479 7065 223a 2022         "type": "
+000375d0: 5479 7065 222c 0a20 2020 2020 2020 2020  Type",.         
 000375e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000375f0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-00037600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037610: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
-00037620: 7065 223a 2022 5479 7065 222c 0a20 2020  pe": "Type",.   
-00037630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037640: 2020 2020 2020 2020 2020 2020 2022 6c6f               "lo
-00037650: 6769 6361 6c22 3a20 2222 2c0a 2020 2020  gical": "",.    
-00037660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037670: 2020 2020 2020 2020 2020 2020 226f 7065              "ope
-00037680: 7261 746f 7222 3a20 2222 2c0a 2020 2020  rator": "",.    
-00037690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376a0: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-000376b0: 7465 6e74 223a 205b 2262 6f6f 6b22 5d2c  tent": ["book"],
-000376c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000376d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376e0: 2022 6669 656c 6422 3a20 2262 6962 7465   "field": "bibte
-000376f0: 7822 2c0a 2020 2020 2020 2020 2020 2020  x",.            
-00037700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037710: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00037720: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00037730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000375f0: 2020 2020 2020 2022 6c6f 6769 6361 6c22         "logical"
+00037600: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00037610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037620: 2020 2020 2020 226f 7065 7261 746f 7222        "operator"
+00037630: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00037640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037650: 2020 2020 2020 2263 6f6e 7465 6e74 223a        "content":
+00037660: 205b 2262 6f6f 6b22 5d2c 0a20 2020 2020   ["book"],.     
+00037670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037680: 2020 2020 2020 2020 2020 2022 6669 656c             "fiel
+00037690: 6422 3a20 2262 6962 7465 7822 2c0a 2020  d": "bibtex",.  
+000376a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000376b0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+000376c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000376d0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+000376e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000376f0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+00037700: 223a 2022 5465 7874 222c 0a20 2020 2020  ": "Text",.     
+00037710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037720: 2020 2020 2020 2020 2020 2022 6c6f 6769             "logi
+00037730: 6361 6c22 3a20 2261 6e64 222c 0a20 2020  cal": "and",.   
 00037740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037750: 2022 7479 7065 223a 2022 5465 7874 222c   "type": "Text",
-00037760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037780: 2022 6c6f 6769 6361 6c22 3a20 2261 6e64   "logical": "and
-00037790: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000377a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377b0: 2020 2022 6f70 6572 6174 6f72 223a 2022     "operator": "
-000377c0: 6c69 6b65 222c 0a20 2020 2020 2020 2020  like",.         
-000377d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377e0: 2020 2020 2020 2022 636f 6e74 656e 7422         "content"
-000377f0: 3a20 226d 6522 2c0a 2020 2020 2020 2020  : "me",.        
-00037800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037810: 2020 2020 2020 2020 2266 6965 6c64 223a          "field":
-00037820: 2022 6269 6274 6578 222c 0a20 2020 2020   "bibtex",.     
+00037750: 2020 2020 2020 2020 2020 2020 2022 6f70               "op
+00037760: 6572 6174 6f72 223a 2022 6c69 6b65 222c  erator": "like",
+00037770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037790: 2022 636f 6e74 656e 7422 3a20 226d 6522   "content": "me"
+000377a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000377b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000377c0: 2020 2266 6965 6c64 223a 2022 6269 6274    "field": "bibt
+000377d0: 6578 222c 0a20 2020 2020 2020 2020 2020  ex",.           
+000377e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000377f0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00037800: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00037810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037820: 2020 292e 6c61 7374 4665 7463 6865 640a    ).lastFetched.
 00037830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037840: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00037850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037860: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00037870: 2020 2020 2020 2020 292e 6c61 7374 4665          ).lastFe
-00037880: 7463 6865 640a 2020 2020 2020 2020 2020  tched.          
-00037890: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-000378a0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-000378b0: 2020 205b 2261 6263 222c 2022 6465 6622     ["abc", "def"
-000378c0: 5d2c 0a20 2020 2020 2020 2029 0a0a 2020  ],.        )..  
-000378d0: 2020 6465 6620 7465 7374 5f66 6574 6368    def test_fetch
-000378e0: 4672 6f6d 4c61 7374 2873 656c 662c 202a  FromLast(self, *
-000378f0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00037900: 2222 5465 7374 2074 6865 2066 756e 6374  ""Test the funct
-00037910: 696f 6e20 6665 7463 6846 726f 6d4c 6173  ion fetchFromLas
-00037920: 7420 666f 7220 7468 6520 4442 2065 6e74  t for the DB ent
-00037930: 7269 6573 2222 220a 2020 2020 2020 2020  ries""".        
-00037940: 7365 6c66 2e69 6e73 6572 745f 7468 7265  self.insert_thre
-00037950: 6528 290a 2020 2020 2020 2020 7365 6c66  e().        self
-00037960: 2e70 4244 422e 6269 6273 2e6c 6173 7451  .pBDB.bibs.lastQ
-00037970: 7565 7279 203d 2022 5345 4c45 4354 202a  uery = "SELECT *
-00037980: 2046 524f 4d20 656e 7472 6965 7322 0a20   FROM entries". 
-00037990: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-000379a0: 2e62 6962 732e 6c61 7374 5661 6c73 203d  .bibs.lastVals =
-000379b0: 2028 290a 2020 2020 2020 2020 7365 6c66   ().        self
-000379c0: 2e70 4244 422e 6269 6273 2e6c 6173 7446  .pBDB.bibs.lastF
-000379d0: 6574 6368 6564 203d 2022 6e6f 220a 2020  etched = "no".  
-000379e0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-000379f0: 6269 6273 2e66 6574 6368 4672 6f6d 4c61  bibs.fetchFromLa
-00037a00: 7374 2864 6f46 6574 6368 3d46 616c 7365  st(doFetch=False
-00037a10: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00037a20: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-00037a30: 7042 4442 2e62 6962 732e 6c61 7374 4665  pBDB.bibs.lastFe
-00037a40: 7463 6865 642c 2022 6e6f 2229 0a20 2020  tched, "no").   
-00037a50: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00037a60: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00037a70: 2020 205b 655b 2262 6962 6b65 7922 5d20     [e["bibkey"] 
-00037a80: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-00037a90: 4442 2e62 6962 732e 6665 7463 6843 7572  DB.bibs.fetchCur
-00037aa0: 735d 2c20 5b22 6162 6322 2c20 2264 6566  s], ["abc", "def
-00037ab0: 222c 2022 6768 6922 5d0a 2020 2020 2020  ", "ghi"].      
-00037ac0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00037ad0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00037ae0: 2020 2020 2020 2020 2020 5b65 5b22 6269            [e["bi
-00037af0: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
-00037b00: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-00037b10: 6574 6368 4672 6f6d 4c61 7374 2829 2e6c  etchFromLast().l
-00037b20: 6173 7446 6574 6368 6564 5d2c 0a20 2020  astFetched],.   
-00037b30: 2020 2020 2020 2020 205b 2261 6263 222c           ["abc",
-00037b40: 2022 6465 6622 2c20 2267 6869 225d 2c0a   "def", "ghi"],.
-00037b50: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00037b60: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00037b70: 2e66 6574 6368 4279 4269 626b 6579 2822  .fetchByBibkey("
-00037b80: 6465 6622 290a 2020 2020 2020 2020 7365  def").        se
-00037b90: 6c66 2e70 4244 422e 6269 6273 2e6c 6173  lf.pBDB.bibs.las
-00037ba0: 7456 616c 7320 3d20 2822 6465 6622 2c29  tVals = ("def",)
-00037bb0: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-00037bc0: 4442 2e62 6962 732e 6c61 7374 5175 6572  DB.bibs.lastQuer
-00037bd0: 7920 3d20 2273 656c 6563 7420 2a20 6672  y = "select * fr
-00037be0: 6f6d 2065 6e74 7269 6573 2020 7768 6572  om entries  wher
-00037bf0: 6520 6269 626b 6579 3d3f 220a 2020 2020  e bibkey=?".    
-00037c00: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00037c10: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00037c20: 2020 5b65 5b22 6269 626b 6579 225d 2066    [e["bibkey"] f
-00037c30: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-00037c40: 422e 6269 6273 2e66 6574 6368 4672 6f6d  B.bibs.fetchFrom
-00037c50: 4c61 7374 2829 2e6c 6173 7446 6574 6368  Last().lastFetch
-00037c60: 6564 5d2c 205b 2264 6566 225d 0a20 2020  ed], ["def"].   
-00037c70: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00037c80: 7465 7374 5f66 696e 6443 6f72 7275 7074  test_findCorrupt
-00037c90: 6564 2873 656c 662c 202a 6172 6773 293a  ed(self, *args):
-00037ca0: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
-00037cb0: 2074 6865 2066 756e 6374 696f 6e20 7468   the function th
-00037cc0: 6174 2066 696e 6473 2063 6f72 7275 7074  at finds corrupt
-00037cd0: 6564 2062 6962 7465 7873 2222 220a 2020  ed bibtexs""".  
-00037ce0: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
-00037cf0: 662e 7042 4442 2e62 6962 732e 7072 6570  f.pBDB.bibs.prep
-00037d00: 6172 6549 6e73 6572 7428 0a20 2020 2020  areInsert(.     
-00037d10: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
-00037d20: 7b61 6263 2c5c 6e61 7574 686f 7220 3d20  {abc,\nauthor = 
-00037d30: 226d 6522 2c5c 6e74 6974 6c65 203d 2022  "me",\ntitle = "
-00037d40: 6162 6322 2c7d 272c 2061 7278 6976 3d22  abc",}', arxiv="
-00037d50: 6162 6322 0a20 2020 2020 2020 2029 0a20  abc".        ). 
-00037d60: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00037d70: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
-00037d80: 2e62 6962 732e 696e 7365 7274 2864 6174  .bibs.insert(dat
-00037d90: 6129 290a 2020 2020 2020 2020 6461 7461  a)).        data
-00037da0: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
-00037db0: 732e 7072 6570 6172 6549 6e73 6572 7428  s.prepareInsert(
-00037dc0: 0a20 2020 2020 2020 2020 2020 2027 4061  .            '@a
-00037dd0: 7274 6963 6c65 7b64 6566 2c5c 6e61 7574  rticle{def,\naut
-00037de0: 686f 7220 3d20 226d 6522 2c5c 6e74 6974  hor = "me",\ntit
-00037df0: 6c65 203d 2022 6465 6622 2c7d 272c 2061  le = "def",}', a
-00037e00: 7278 6976 3d22 6465 6622 0a20 2020 2020  rxiv="def".     
-00037e10: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00037e20: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-00037e30: 662e 7042 4442 2e62 6962 732e 696e 7365  f.pBDB.bibs.inse
-00037e40: 7274 2864 6174 6129 290a 2020 2020 2020  rt(data)).      
-00037e50: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00037e60: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-00037e70: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
-00037e80: 6461 7465 4669 656c 6428 0a20 2020 2020  dateField(.     
-00037e90: 2020 2020 2020 2020 2020 2022 6465 6622             "def"
-00037ea0: 2c20 2262 6962 7465 7822 2c20 2740 6172  , "bibtex", '@ar
-00037eb0: 7469 636c 657b 6465 662c 5c6e 6175 7468  ticle{def,\nauth
-00037ec0: 6f72 203d 2022 6d22 6522 2c5c 6e74 6974  or = "m"e",\ntit
-00037ed0: 6c65 203d 2022 6465 6622 2c7d 270a 2020  le = "def",}'.  
-00037ee0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00037ef0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00037f00: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-00037f10: 656c 662e 7042 4442 2e62 6962 732e 6669  elf.pBDB.bibs.fi
-00037f20: 6e64 436f 7272 7570 7465 6442 6962 7465  ndCorruptedBibte
-00037f30: 7873 2829 2c20 5b22 6465 6622 5d29 0a20  xs(), ["def"]). 
-00037f40: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00037f50: 7274 5472 7565 280a 2020 2020 2020 2020  rtTrue(.        
-00037f60: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00037f70: 6273 2e75 7064 6174 6546 6965 6c64 280a  bs.updateField(.
-00037f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f90: 2264 6566 222c 2022 6269 6274 6578 222c  "def", "bibtex",
-00037fa0: 2027 4061 7274 6963 6c65 7b64 6566 2c5c   '@article{def,\
-00037fb0: 6e61 7574 686f 7220 3d20 226d 6522 2c74  nauthor = "me",t
-00037fc0: 6974 6c65 203d 2022 6465 6622 270a 2020  itle = "def"'.  
-00037fd0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00037fe0: 2020 2020 290a 2020 2020 2020 2020 7062      ).        pb
-00037ff0: 6d20 3d20 4d61 6769 634d 6f63 6b28 290a  m = MagicMock().
-00038000: 2020 2020 2020 2020 7062 7620 3d20 4d61          pbv = Ma
-00038010: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
-00038020: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00038030: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00038040: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
-00038050: 696e 6443 6f72 7275 7074 6564 4269 6274  indCorruptedBibt
-00038060: 6578 7328 7062 4d61 783d 7062 6d2c 2070  exs(pbMax=pbm, p
-00038070: 6256 616c 3d70 6276 292c 205b 2264 6566  bVal=pbv), ["def
-00038080: 225d 0a20 2020 2020 2020 2029 0a20 2020  "].        ).   
-00038090: 2020 2020 2070 626d 2e61 7373 6572 745f       pbm.assert_
-000380a0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-000380b0: 2832 290a 2020 2020 2020 2020 7062 762e  (2).        pbv.
-000380c0: 6173 7365 7274 5f68 6173 5f63 616c 6c73  assert_has_calls
-000380d0: 285b 6361 6c6c 2831 292c 2063 616c 6c28  ([call(1), call(
-000380e0: 3229 5d29 0a20 2020 2020 2020 2073 656c  2)]).        sel
-000380f0: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-00038100: 6c66 2e70 4244 422e 6269 6273 2e66 696e  lf.pBDB.bibs.fin
-00038110: 6443 6f72 7275 7074 6564 4269 6274 6578  dCorruptedBibtex
-00038120: 7328 7374 6172 7446 726f 6d3d 3129 2c20  s(startFrom=1), 
-00038130: 5b22 6465 6622 5d29 0a20 2020 2020 2020  ["def"]).       
-00038140: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00038150: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00038160: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-00038170: 6174 6546 6965 6c64 280a 2020 2020 2020  ateField(.      
-00038180: 2020 2020 2020 2020 2020 2264 6566 222c            "def",
-00038190: 2022 6269 6274 6578 222c 2027 4061 7274   "bibtex", '@art
-000381a0: 6963 6c65 7b64 6566 2c61 7574 686f 7220  icle{def,author 
-000381b0: 3d20 226d 6522 2c74 6974 6c65 203d 2022  = "me",title = "
-000381c0: 6465 6622 7d27 0a20 2020 2020 2020 2020  def"}'.         
-000381d0: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
-000381e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000381f0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00038200: 422e 6269 6273 2e66 696e 6443 6f72 7275  B.bibs.findCorru
-00038210: 7074 6564 4269 6274 6578 7328 292c 205b  ptedBibtexs(), [
-00038220: 5d29 0a0a 2020 2020 6465 6620 7465 7374  ])..    def test
-00038230: 5f67 6574 4461 696c 7949 6e66 6f46 726f  _getDailyInfoFro
-00038240: 6d4f 4149 2873 656c 662c 202a 6172 6773  mOAI(self, *args
-00038250: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
-00038260: 7374 2074 6865 2066 756e 6374 696f 6e20  st the function 
-00038270: 6765 7444 6169 6c79 496e 666f 4672 6f6d  getDailyInfoFrom
-00038280: 4f41 492c 0a20 2020 2020 2020 2077 6974  OAI,.        wit
-00038290: 686f 7574 2072 656c 7969 6e67 206f 6e20  hout relying on 
-000382a0: 7468 6520 7472 7565 0a20 2020 2020 2020  the true.       
-000382b0: 2070 6879 7342 6962 6c69 6f57 6562 2e77   physBiblioWeb.w
-000382c0: 6562 5365 6172 6368 5b22 696e 7370 6972  ebSearch["inspir
-000382d0: 6522 5d2e 7265 7472 6965 7665 4375 6d75  e"].retrieveCumu
-000382e0: 6c61 7469 7665 5570 6461 7465 730a 2020  lativeUpdates.  
-000382f0: 2020 2020 2020 286d 6f63 6b65 6429 0a20        (mocked). 
-00038300: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00038310: 2020 2073 656c 662e 6d61 7844 6966 6620     self.maxDiff 
-00038320: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-00038330: 656c 662e 7042 4442 2e62 6962 732e 696e  elf.pBDB.bibs.in
-00038340: 7365 7274 4672 6f6d 4269 6274 6578 280a  sertFromBibtex(.
-00038350: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
-00038360: 7469 636c 657b 4761 7269 617a 7a6f 3a32  ticle{Gariazzo:2
-00038370: 3031 3572 7261 2c5c 6e61 7278 6976 3d22  015rra,\narxiv="
-00038380: 3135 3037 2e30 3832 3034 225c 6e7d 270a  1507.08204"\n}'.
-00038390: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000383a0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-000383b0: 2e69 6e73 6572 7446 726f 6d42 6962 7465  .insertFromBibte
-000383c0: 7828 2740 6172 7469 636c 657b 4164 653a  x('@article{Ade:
-000383d0: 3230 3133 7a75 762c 5c6e 6172 7869 763d  2013zuv,\narxiv=
-000383e0: 2231 3330 332e 3530 3736 225c 6e7d 2729  "1303.5076"\n}')
-000383f0: 0a20 2020 2020 2020 2064 3120 3d20 2232  .        d1 = "2
-00038400: 3031 382d 3031 2d30 3122 0a20 2020 2020  018-01-01".     
-00038410: 2020 2064 3220 3d20 2232 3031 382d 3031     d2 = "2018-01
-00038420: 2d30 3222 0a20 2020 2020 2020 2064 3174  -02".        d1t
-00038430: 203d 2028 6461 7465 7469 6d65 2e64 6174   = (datetime.dat
-00038440: 652e 746f 6461 7928 2920 2d20 6461 7465  e.today() - date
-00038450: 7469 6d65 2e74 696d 6564 656c 7461 2831  time.timedelta(1
-00038460: 2929 2e73 7472 6674 696d 6528 2225 592d  )).strftime("%Y-
-00038470: 256d 2d25 6422 290a 2020 2020 2020 2020  %m-%d").        
-00038480: 6432 7420 3d20 6461 7465 7469 6d65 2e64  d2t = datetime.d
-00038490: 6174 652e 746f 6461 7928 292e 7374 7266  ate.today().strf
-000384a0: 7469 6d65 2822 2559 2d25 6d2d 2564 2229  time("%Y-%m-%d")
-000384b0: 0a20 2020 2020 2020 2072 6573 203d 2073  .        res = s
-000384c0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-000384d0: 7442 7942 6962 6b65 7928 2241 6465 3a32  tByBibkey("Ade:2
-000384e0: 3031 337a 7576 2229 5b30 5d0a 2020 2020  013zuv")[0].    
-000384f0: 2020 2020 6465 6c20 7265 735b 2263 6974      del res["cit
-00038500: 6174 696f 6e73 225d 0a20 2020 2020 2020  ations"].       
-00038510: 2064 656c 2072 6573 5b22 6369 7461 7469   del res["citati
-00038520: 6f6e 735f 6e6f 5f73 656c 6622 5d0a 2020  ons_no_self"].  
-00038530: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00038540: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00038550: 2020 2020 7265 732c 0a20 2020 2020 2020      res,.       
-00038560: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00038570: 2020 2020 2020 2022 6269 626b 6579 223a         "bibkey":
-00038580: 2022 4164 653a 3230 3133 7a75 7622 2c0a   "Ade:2013zuv",.
-00038590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000385a0: 2269 6e73 7069 7265 223a 204e 6f6e 652c  "inspire": None,
-000385b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000385c0: 2022 6172 7869 7622 3a20 2231 3330 332e   "arxiv": "1303.
-000385d0: 3530 3736 222c 0a20 2020 2020 2020 2020  5076",.         
-000385e0: 2020 2020 2020 2022 6164 7322 3a20 4e6f         "ads": No
-000385f0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00038600: 2020 2020 2273 6368 6f6c 6172 223a 204e      "scholar": N
-00038610: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-00038620: 2020 2020 2022 646f 6922 3a20 4e6f 6e65       "doi": None
-00038630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038640: 2020 2269 7362 6e22 3a20 4e6f 6e65 2c0a    "isbn": None,.
-00038650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038660: 2279 6561 7222 3a20 3230 3133 2c0a 2020  "year": 2013,.  
-00038670: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-00038680: 696e 6b22 3a20 2225 732f 6162 732f 3133  ink": "%s/abs/13
-00038690: 3033 2e35 3037 3622 2025 2070 6243 6f6e  03.5076" % pbCon
-000386a0: 6669 672e 6172 7869 7655 726c 2c0a 2020  fig.arxivUrl,.  
-000386b0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-000386c0: 6f6d 6d65 6e74 7322 3a20 4e6f 6e65 2c0a  omments": None,.
-000386d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000386e0: 226f 6c64 5f6b 6579 7322 3a20 4e6f 6e65  "old_keys": None
-000386f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038700: 2020 2263 726f 7373 7265 6622 3a20 4e6f    "crossref": No
-00038710: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00038720: 2020 2020 2262 6962 7465 7822 3a20 2240      "bibtex": "@
-00038730: 4172 7469 636c 657b 4164 653a 3230 3133  Article{Ade:2013
-00038740: 7a75 762c 5c6e 2020 2020 2020 2020 2022  zuv,\n         "
-00038750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038760: 202b 2027 6172 7869 7620 3d20 2231 3330   + 'arxiv = "130
-00038770: 332e 3530 3736 222c 5c6e 7d27 2c0a 2020  3.5076",\n}',.  
-00038780: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00038790: 6972 7374 6461 7465 223a 2064 3274 2c0a  irstdate": d2t,.
-000387a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000387b0: 2270 7562 6461 7465 223a 2022 222c 0a20  "pubdate": "",. 
-000387c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000387d0: 6578 705f 7061 7065 7222 3a20 302c 0a20  exp_paper": 0,. 
-000387e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000387f0: 6c65 6374 7572 6522 3a20 302c 0a20 2020  lecture": 0,.   
-00038800: 2020 2020 2020 2020 2020 2020 2022 7068               "ph
-00038810: 645f 7468 6573 6973 223a 2030 2c0a 2020  d_thesis": 0,.  
-00038820: 2020 2020 2020 2020 2020 2020 2020 2272                "r
-00038830: 6576 6965 7722 3a20 302c 0a20 2020 2020  eview": 0,.     
-00038840: 2020 2020 2020 2020 2020 2022 7072 6f63             "proc
-00038850: 6565 6469 6e67 223a 2030 2c0a 2020 2020  eeding": 0,.    
-00038860: 2020 2020 2020 2020 2020 2020 2262 6f6f              "boo
-00038870: 6b22 3a20 302c 0a20 2020 2020 2020 2020  k": 0,.         
-00038880: 2020 2020 2020 2022 6e6f 5570 6461 7465         "noUpdate
-00038890: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
-000388a0: 2020 2020 2020 226d 6172 6b73 223a 2022        "marks": "
-000388b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000388c0: 2020 2022 6162 7374 7261 6374 223a 204e     "abstract": N
-000388d0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-000388e0: 2020 2020 2022 6269 6274 6578 4469 6374       "bibtexDict
-000388f0: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
-00038900: 2020 2020 2020 2020 2022 6172 7869 7622           "arxiv"
-00038910: 3a20 2231 3330 332e 3530 3736 222c 0a20  : "1303.5076",. 
-00038920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038930: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-00038940: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-00038950: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00038960: 4944 223a 2022 4164 653a 3230 3133 7a75  ID": "Ade:2013zu
-00038970: 7622 2c0a 2020 2020 2020 2020 2020 2020  v",.            
-00038980: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-00038990: 2020 2020 2020 2022 7469 746c 6522 3a20         "title": 
-000389a0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-000389b0: 2020 2020 226a 6f75 726e 616c 223a 2022      "journal": "
-000389c0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000389d0: 2020 2022 766f 6c75 6d65 223a 2022 222c     "volume": "",
-000389e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000389f0: 2022 6e75 6d62 6572 223a 2022 222c 0a20   "number": "",. 
-00038a00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00038a10: 7061 6765 7322 3a20 2222 2c0a 2020 2020  pages": "",.    
-00038a20: 2020 2020 2020 2020 2020 2020 2270 7562              "pub
-00038a30: 6c69 7368 6564 223a 2022 222c 0a20 2020  lished": "",.   
-00038a40: 2020 2020 2020 2020 2020 2020 2022 6175               "au
-00038a50: 7468 6f72 223a 2022 222c 0a20 2020 2020  thor": "",.     
-00038a60: 2020 2020 2020 2020 2020 2022 6269 6264             "bibd
-00038a70: 6963 7422 3a20 7b0a 2020 2020 2020 2020  ict": {.        
-00038a80: 2020 2020 2020 2020 2020 2020 2261 7278              "arx
-00038a90: 6976 223a 2022 3133 3033 2e35 3037 3622  iv": "1303.5076"
-00038aa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038ab0: 2020 2020 2020 2245 4e54 5259 5459 5045        "ENTRYTYPE
-00038ac0: 223a 2022 6172 7469 636c 6522 2c0a 2020  ": "article",.  
-00038ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038ae0: 2020 2249 4422 3a20 2241 6465 3a32 3031    "ID": "Ade:201
-00038af0: 337a 7576 222c 0a20 2020 2020 2020 2020  3zuv",.         
-00038b00: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00038b10: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-00038b20: 2029 0a20 2020 2020 2020 2072 6573 203d   ).        res =
-00038b30: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00038b40: 6765 7442 7942 6962 6b65 7928 2247 6172  getByBibkey("Gar
-00038b50: 6961 7a7a 6f3a 3230 3135 7272 6122 295b  iazzo:2015rra")[
-00038b60: 305d 0a20 2020 2020 2020 2064 656c 2072  0].        del r
-00038b70: 6573 5b22 6369 7461 7469 6f6e 7322 5d0a  es["citations"].
-00038b80: 2020 2020 2020 2020 6465 6c20 7265 735b          del res[
-00038b90: 2263 6974 6174 696f 6e73 5f6e 6f5f 7365  "citations_no_se
-00038ba0: 6c66 225d 0a20 2020 2020 2020 2073 656c  lf"].        sel
-00038bb0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00038bc0: 2020 2020 2020 2020 2020 2072 6573 2c0a             res,.
-00038bd0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00038be0: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-00038bf0: 6962 6b65 7922 3a20 2247 6172 6961 7a7a  ibkey": "Gariazz
-00038c00: 6f3a 3230 3135 7272 6122 2c0a 2020 2020  o:2015rra",.    
-00038c10: 2020 2020 2020 2020 2020 2020 2269 6e73              "ins
-00038c20: 7069 7265 223a 204e 6f6e 652c 0a20 2020  pire": None,.   
-00038c30: 2020 2020 2020 2020 2020 2020 2022 6172               "ar
-00038c40: 7869 7622 3a20 2231 3530 372e 3038 3230  xiv": "1507.0820
-00038c50: 3422 2c0a 2020 2020 2020 2020 2020 2020  4",.            
-00038c60: 2020 2020 2261 6473 223a 204e 6f6e 652c      "ads": None,
-00038c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038c80: 2022 7363 686f 6c61 7222 3a20 4e6f 6e65   "scholar": None
-00038c90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038ca0: 2020 2264 6f69 223a 204e 6f6e 652c 0a20    "doi": None,. 
-00038cb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00038cc0: 6973 626e 223a 204e 6f6e 652c 0a20 2020  isbn": None,.   
-00038cd0: 2020 2020 2020 2020 2020 2020 2022 7965               "ye
-00038ce0: 6172 223a 2032 3031 352c 0a20 2020 2020  ar": 2015,.     
-00038cf0: 2020 2020 2020 2020 2020 2022 6c69 6e6b             "link
-00038d00: 223a 2022 2573 2f61 6273 2f31 3530 372e  ": "%s/abs/1507.
-00038d10: 3038 3230 3422 2025 2070 6243 6f6e 6669  08204" % pbConfi
-00038d20: 672e 6172 7869 7655 726c 2c0a 2020 2020  g.arxivUrl,.    
-00038d30: 2020 2020 2020 2020 2020 2020 2263 6f6d              "com
-00038d40: 6d65 6e74 7322 3a20 4e6f 6e65 2c0a 2020  ments": None,.  
-00038d50: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-00038d60: 6c64 5f6b 6579 7322 3a20 4e6f 6e65 2c0a  ld_keys": None,.
-00038d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038d80: 2263 726f 7373 7265 6622 3a20 4e6f 6e65  "crossref": None
-00038d90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038da0: 2020 2262 6962 7465 7822 3a20 2240 4172    "bibtex": "@Ar
-00038db0: 7469 636c 657b 4761 7269 617a 7a6f 3a32  ticle{Gariazzo:2
-00038dc0: 3031 3572 7261 2c5c 6e20 2020 2020 2020  015rra,\n       
-00038dd0: 2020 220a 2020 2020 2020 2020 2020 2020    ".            
-00038de0: 2020 2020 2b20 2761 7278 6976 203d 2022      + 'arxiv = "
-00038df0: 3135 3037 2e30 3832 3034 222c 5c6e 7d27  1507.08204",\n}'
-00038e00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038e10: 2020 2266 6972 7374 6461 7465 223a 2064    "firstdate": d
-00038e20: 3274 2c0a 2020 2020 2020 2020 2020 2020  2t,.            
-00038e30: 2020 2020 2270 7562 6461 7465 223a 2022      "pubdate": "
-00038e40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00038e50: 2020 2022 6578 705f 7061 7065 7222 3a20     "exp_paper": 
-00038e60: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-00038e70: 2020 2022 6c65 6374 7572 6522 3a20 302c     "lecture": 0,
-00038e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038e90: 2022 7068 645f 7468 6573 6973 223a 2030   "phd_thesis": 0
-00038ea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038eb0: 2020 2272 6576 6965 7722 3a20 302c 0a20    "review": 0,. 
-00038ec0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00038ed0: 7072 6f63 6565 6469 6e67 223a 2030 2c0a  proceeding": 0,.
-00038ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038ef0: 2262 6f6f 6b22 3a20 302c 0a20 2020 2020  "book": 0,.     
-00038f00: 2020 2020 2020 2020 2020 2022 6e6f 5570             "noUp
-00038f10: 6461 7465 223a 2030 2c0a 2020 2020 2020  date": 0,.      
-00038f20: 2020 2020 2020 2020 2020 226d 6172 6b73            "marks
-00038f30: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-00038f40: 2020 2020 2020 2022 6162 7374 7261 6374         "abstract
-00038f50: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-00038f60: 2020 2020 2020 2020 2022 6269 6274 6578           "bibtex
-00038f70: 4469 6374 223a 207b 0a20 2020 2020 2020  Dict": {.       
-00038f80: 2020 2020 2020 2020 2020 2020 2022 6172               "ar
-00038f90: 7869 7622 3a20 2231 3530 372e 3038 3230  xiv": "1507.0820
-00038fa0: 3422 2c0a 2020 2020 2020 2020 2020 2020  4",.            
-00038fb0: 2020 2020 2020 2020 2245 4e54 5259 5459          "ENTRYTY
-00038fc0: 5045 223a 2022 6172 7469 636c 6522 2c0a  PE": "article",.
-00038fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038fe0: 2020 2020 2249 4422 3a20 2247 6172 6961      "ID": "Garia
-00038ff0: 7a7a 6f3a 3230 3135 7272 6122 2c0a 2020  zzo:2015rra",.  
-00039000: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-00039010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039020: 2022 7469 746c 6522 3a20 2222 2c0a 2020   "title": "",.  
-00039030: 2020 2020 2020 2020 2020 2020 2020 226a                "j
-00039040: 6f75 726e 616c 223a 2022 222c 0a20 2020  ournal": "",.   
-00039050: 2020 2020 2020 2020 2020 2020 2022 766f               "vo
-00039060: 6c75 6d65 223a 2022 222c 0a20 2020 2020  lume": "",.     
-00039070: 2020 2020 2020 2020 2020 2022 6e75 6d62             "numb
-00039080: 6572 223a 2022 222c 0a20 2020 2020 2020  er": "",.       
-00039090: 2020 2020 2020 2020 2022 7061 6765 7322           "pages"
-000390a0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-000390b0: 2020 2020 2020 2270 7562 6c69 7368 6564        "published
-000390c0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-000390d0: 2020 2020 2020 2022 6175 7468 6f72 223a         "author":
-000390e0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-000390f0: 2020 2020 2022 6269 6264 6963 7422 3a20       "bibdict": 
-00039100: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00039110: 2020 2020 2020 2261 7278 6976 223a 2022        "arxiv": "
-00039120: 3135 3037 2e30 3832 3034 222c 0a20 2020  1507.08204",.   
-00039130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039140: 2022 454e 5452 5954 5950 4522 3a20 2261   "ENTRYTYPE": "a
-00039150: 7274 6963 6c65 222c 0a20 2020 2020 2020  rticle",.       
-00039160: 2020 2020 2020 2020 2020 2020 2022 4944               "ID
-00039170: 223a 2022 4761 7269 617a 7a6f 3a32 3031  ": "Gariazzo:201
-00039180: 3572 7261 222c 0a20 2020 2020 2020 2020  5rra",.         
-00039190: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-000391a0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-000391b0: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
-000391c0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-000391d0: 2020 2022 7068 7973 6269 626c 696f 2e77     "physbiblio.w
-000391e0: 6562 696d 706f 7274 2e69 6e73 7069 7265  ebimport.inspire
-000391f0: 2e57 6562 5365 6172 6368 2e72 6574 7269  .WebSearch.retri
-00039200: 6576 6543 756d 756c 6174 6976 6555 7064  eveCumulativeUpd
-00039210: 6174 6573 222c 0a20 2020 2020 2020 2020  ates",.         
-00039220: 2020 2073 6964 655f 6566 6665 6374 3d5b     side_effect=[
-00039230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039240: 205b 5d2c 0a20 2020 2020 2020 2020 2020   [],.           
-00039250: 2020 2020 205b 5d2c 0a20 2020 2020 2020       [],.       
-00039260: 2020 2020 2020 2020 205b 5d2c 0a20 2020           [],.   
-00039270: 2020 2020 2020 2020 2020 2020 205b 5d2c               [],
-00039280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039290: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-000392a0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-000392b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000392c0: 2022 646f 6922 3a20 2231 302e 3130 3838   "doi": "10.1088
-000392d0: 2f30 3935 342d 3338 3939 2f34 332f 332f  /0954-3899/43/3/
-000392e0: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
+00037840: 5d0a 2020 2020 2020 2020 2020 2020 292c  ].            ),
+00037850: 0a20 2020 2020 2020 2020 2020 205b 2261  .            ["a
+00037860: 6263 222c 2022 6465 6622 5d2c 0a20 2020  bc", "def"],.   
+00037870: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00037880: 7465 7374 5f66 6574 6368 4672 6f6d 4c61  test_fetchFromLa
+00037890: 7374 2873 656c 662c 202a 6172 6773 293a  st(self, *args):
+000378a0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+000378b0: 2074 6865 2066 756e 6374 696f 6e20 6665   the function fe
+000378c0: 7463 6846 726f 6d4c 6173 7420 666f 7220  tchFromLast for 
+000378d0: 7468 6520 4442 2065 6e74 7269 6573 2222  the DB entries""
+000378e0: 220a 2020 2020 2020 2020 7365 6c66 2e69  ".        self.i
+000378f0: 6e73 6572 745f 7468 7265 6528 290a 2020  nsert_three().  
+00037900: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00037910: 6269 6273 2e6c 6173 7451 7565 7279 203d  bibs.lastQuery =
+00037920: 2022 5345 4c45 4354 202a 2046 524f 4d20   "SELECT * FROM 
+00037930: 656e 7472 6965 7322 0a20 2020 2020 2020  entries".       
+00037940: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00037950: 6c61 7374 5661 6c73 203d 2028 290a 2020  lastVals = ().  
+00037960: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00037970: 6269 6273 2e6c 6173 7446 6574 6368 6564  bibs.lastFetched
+00037980: 203d 2022 6e6f 220a 2020 2020 2020 2020   = "no".        
+00037990: 7365 6c66 2e70 4244 422e 6269 6273 2e66  self.pBDB.bibs.f
+000379a0: 6574 6368 4672 6f6d 4c61 7374 2864 6f46  etchFromLast(doF
+000379b0: 6574 6368 3d46 616c 7365 290a 2020 2020  etch=False).    
+000379c0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000379d0: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
+000379e0: 6962 732e 6c61 7374 4665 7463 6865 642c  ibs.lastFetched,
+000379f0: 2022 6e6f 2229 0a20 2020 2020 2020 2073   "no").        s
+00037a00: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00037a10: 0a20 2020 2020 2020 2020 2020 205b 655b  .            [e[
+00037a20: 2262 6962 6b65 7922 5d20 666f 7220 6520  "bibkey"] for e 
+00037a30: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
+00037a40: 732e 6665 7463 6843 7572 735d 2c20 5b22  s.fetchCurs], ["
+00037a50: 6162 6322 2c20 2264 6566 222c 2022 6768  abc", "def", "gh
+00037a60: 6922 5d0a 2020 2020 2020 2020 290a 2020  i"].        ).  
+00037a70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00037a80: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00037a90: 2020 2020 5b65 5b22 6269 626b 6579 225d      [e["bibkey"]
+00037aa0: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
+00037ab0: 4244 422e 6269 6273 2e66 6574 6368 4672  BDB.bibs.fetchFr
+00037ac0: 6f6d 4c61 7374 2829 2e6c 6173 7446 6574  omLast().lastFet
+00037ad0: 6368 6564 5d2c 0a20 2020 2020 2020 2020  ched],.         
+00037ae0: 2020 205b 2261 6263 222c 2022 6465 6622     ["abc", "def"
+00037af0: 2c20 2267 6869 225d 2c0a 2020 2020 2020  , "ghi"],.      
+00037b00: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00037b10: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
+00037b20: 4279 4269 626b 6579 2822 6465 6622 290a  ByBibkey("def").
+00037b30: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00037b40: 422e 6269 6273 2e6c 6173 7456 616c 7320  B.bibs.lastVals 
+00037b50: 3d20 2822 6465 6622 2c29 0a20 2020 2020  = ("def",).     
+00037b60: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+00037b70: 732e 6c61 7374 5175 6572 7920 3d20 2273  s.lastQuery = "s
+00037b80: 656c 6563 7420 2a20 6672 6f6d 2065 6e74  elect * from ent
+00037b90: 7269 6573 2020 7768 6572 6520 6269 626b  ries  where bibk
+00037ba0: 6579 3d3f 220a 2020 2020 2020 2020 7365  ey=?".        se
+00037bb0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00037bc0: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
+00037bd0: 6269 626b 6579 225d 2066 6f72 2065 2069  bibkey"] for e i
+00037be0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+00037bf0: 2e66 6574 6368 4672 6f6d 4c61 7374 2829  .fetchFromLast()
+00037c00: 2e6c 6173 7446 6574 6368 6564 5d2c 205b  .lastFetched], [
+00037c10: 2264 6566 225d 0a20 2020 2020 2020 2029  "def"].        )
+00037c20: 0a0a 2020 2020 6465 6620 7465 7374 5f66  ..    def test_f
+00037c30: 696e 6443 6f72 7275 7074 6564 2873 656c  indCorrupted(sel
+00037c40: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
+00037c50: 2020 2022 2222 7465 7374 2074 6865 2066     """test the f
+00037c60: 756e 6374 696f 6e20 7468 6174 2066 696e  unction that fin
+00037c70: 6473 2063 6f72 7275 7074 6564 2062 6962  ds corrupted bib
+00037c80: 7465 7873 2222 220a 2020 2020 2020 2020  texs""".        
+00037c90: 6461 7461 203d 2073 656c 662e 7042 4442  data = self.pBDB
+00037ca0: 2e62 6962 732e 7072 6570 6172 6549 6e73  .bibs.prepareIns
+00037cb0: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
+00037cc0: 2027 4061 7274 6963 6c65 7b61 6263 2c5c   '@article{abc,\
+00037cd0: 6e61 7574 686f 7220 3d20 226d 6522 2c5c  nauthor = "me",\
+00037ce0: 6e74 6974 6c65 203d 2022 6162 6322 2c7d  ntitle = "abc",}
+00037cf0: 272c 2061 7278 6976 3d22 6162 6322 0a20  ', arxiv="abc". 
+00037d00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00037d10: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00037d20: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00037d30: 696e 7365 7274 2864 6174 6129 290a 2020  insert(data)).  
+00037d40: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
+00037d50: 662e 7042 4442 2e62 6962 732e 7072 6570  f.pBDB.bibs.prep
+00037d60: 6172 6549 6e73 6572 7428 0a20 2020 2020  areInsert(.     
+00037d70: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
+00037d80: 7b64 6566 2c5c 6e61 7574 686f 7220 3d20  {def,\nauthor = 
+00037d90: 226d 6522 2c5c 6e74 6974 6c65 203d 2022  "me",\ntitle = "
+00037da0: 6465 6622 2c7d 272c 2061 7278 6976 3d22  def",}', arxiv="
+00037db0: 6465 6622 0a20 2020 2020 2020 2029 0a20  def".        ). 
+00037dc0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00037dd0: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
+00037de0: 2e62 6962 732e 696e 7365 7274 2864 6174  .bibs.insert(dat
+00037df0: 6129 290a 2020 2020 2020 2020 7365 6c66  a)).        self
+00037e00: 2e61 7373 6572 7454 7275 6528 0a20 2020  .assertTrue(.   
+00037e10: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00037e20: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
+00037e30: 656c 6428 0a20 2020 2020 2020 2020 2020  eld(.           
+00037e40: 2020 2020 2022 6465 6622 2c20 2262 6962       "def", "bib
+00037e50: 7465 7822 2c20 2740 6172 7469 636c 657b  tex", '@article{
+00037e60: 6465 662c 5c6e 6175 7468 6f72 203d 2022  def,\nauthor = "
+00037e70: 6d22 6522 2c5c 6e74 6974 6c65 203d 2022  m"e",\ntitle = "
+00037e80: 6465 6622 2c7d 270a 2020 2020 2020 2020  def",}'.        
+00037e90: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+00037ea0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00037eb0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+00037ec0: 4442 2e62 6962 732e 6669 6e64 436f 7272  DB.bibs.findCorr
+00037ed0: 7570 7465 6442 6962 7465 7873 2829 2c20  uptedBibtexs(), 
+00037ee0: 5b22 6465 6622 5d29 0a20 2020 2020 2020  ["def"]).       
+00037ef0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00037f00: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00037f10: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
+00037f20: 6174 6546 6965 6c64 280a 2020 2020 2020  ateField(.      
+00037f30: 2020 2020 2020 2020 2020 2264 6566 222c            "def",
+00037f40: 2022 6269 6274 6578 222c 2027 4061 7274   "bibtex", '@art
+00037f50: 6963 6c65 7b64 6566 2c5c 6e61 7574 686f  icle{def,\nautho
+00037f60: 7220 3d20 226d 6522 2c74 6974 6c65 203d  r = "me",title =
+00037f70: 2022 6465 6622 270a 2020 2020 2020 2020   "def"'.        
+00037f80: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+00037f90: 2020 2020 2020 2020 7062 6d20 3d20 4d61          pbm = Ma
+00037fa0: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
+00037fb0: 2020 7062 7620 3d20 4d61 6769 634d 6f63    pbv = MagicMoc
+00037fc0: 6b28 290a 2020 2020 2020 2020 7365 6c66  k().        self
+00037fd0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00037fe0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00037ff0: 4244 422e 6269 6273 2e66 696e 6443 6f72  BDB.bibs.findCor
+00038000: 7275 7074 6564 4269 6274 6578 7328 7062  ruptedBibtexs(pb
+00038010: 4d61 783d 7062 6d2c 2070 6256 616c 3d70  Max=pbm, pbVal=p
+00038020: 6276 292c 205b 2264 6566 225d 0a20 2020  bv), ["def"].   
+00038030: 2020 2020 2029 0a20 2020 2020 2020 2070       ).        p
+00038040: 626d 2e61 7373 6572 745f 6361 6c6c 6564  bm.assert_called
+00038050: 5f6f 6e63 655f 7769 7468 2832 290a 2020  _once_with(2).  
+00038060: 2020 2020 2020 7062 762e 6173 7365 7274        pbv.assert
+00038070: 5f68 6173 5f63 616c 6c73 285b 6361 6c6c  _has_calls([call
+00038080: 2831 292c 2063 616c 6c28 3229 5d29 0a20  (1), call(2)]). 
+00038090: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000380a0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+000380b0: 422e 6269 6273 2e66 696e 6443 6f72 7275  B.bibs.findCorru
+000380c0: 7074 6564 4269 6274 6578 7328 7374 6172  ptedBibtexs(star
+000380d0: 7446 726f 6d3d 3129 2c20 5b22 6465 6622  tFrom=1), ["def"
+000380e0: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
+000380f0: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
+00038100: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00038110: 422e 6269 6273 2e75 7064 6174 6546 6965  B.bibs.updateFie
+00038120: 6c64 280a 2020 2020 2020 2020 2020 2020  ld(.            
+00038130: 2020 2020 2264 6566 222c 2022 6269 6274      "def", "bibt
+00038140: 6578 222c 2027 4061 7274 6963 6c65 7b64  ex", '@article{d
+00038150: 6566 2c61 7574 686f 7220 3d20 226d 6522  ef,author = "me"
+00038160: 2c74 6974 6c65 203d 2022 6465 6622 7d27  ,title = "def"}'
+00038170: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00038180: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00038190: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000381a0: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+000381b0: 2e66 696e 6443 6f72 7275 7074 6564 4269  .findCorruptedBi
+000381c0: 6274 6578 7328 292c 205b 5d29 0a0a 2020  btexs(), [])..  
+000381d0: 2020 6465 6620 7465 7374 5f67 6574 4461    def test_getDa
+000381e0: 696c 7949 6e66 6f46 726f 6d4f 4149 2873  ilyInfoFromOAI(s
+000381f0: 656c 662c 202a 6172 6773 293a 0a20 2020  elf, *args):.   
+00038200: 2020 2020 2022 2222 7465 7374 2074 6865       """test the
+00038210: 2066 756e 6374 696f 6e20 6765 7444 6169   function getDai
+00038220: 6c79 496e 666f 4672 6f6d 4f41 492c 0a20  lyInfoFromOAI,. 
+00038230: 2020 2020 2020 2077 6974 686f 7574 2072         without r
+00038240: 656c 7969 6e67 206f 6e20 7468 6520 7472  elying on the tr
+00038250: 7565 0a20 2020 2020 2020 2070 6879 7342  ue.        physB
+00038260: 6962 6c69 6f57 6562 2e77 6562 5365 6172  iblioWeb.webSear
+00038270: 6368 5b22 696e 7370 6972 6522 5d2e 7265  ch["inspire"].re
+00038280: 7472 6965 7665 4375 6d75 6c61 7469 7665  trieveCumulative
+00038290: 5570 6461 7465 730a 2020 2020 2020 2020  Updates.        
+000382a0: 286d 6f63 6b65 6429 0a20 2020 2020 2020  (mocked).       
+000382b0: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
+000382c0: 662e 6d61 7844 6966 6620 3d20 4e6f 6e65  f.maxDiff = None
+000382d0: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+000382e0: 4442 2e62 6962 732e 696e 7365 7274 4672  DB.bibs.insertFr
+000382f0: 6f6d 4269 6274 6578 280a 2020 2020 2020  omBibtex(.      
+00038300: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
+00038310: 4761 7269 617a 7a6f 3a32 3031 3572 7261  Gariazzo:2015rra
+00038320: 2c5c 6e61 7278 6976 3d22 3135 3037 2e30  ,\narxiv="1507.0
+00038330: 3832 3034 225c 6e7d 270a 2020 2020 2020  8204"\n}'.      
+00038340: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00038350: 2e70 4244 422e 6269 6273 2e69 6e73 6572  .pBDB.bibs.inser
+00038360: 7446 726f 6d42 6962 7465 7828 2740 6172  tFromBibtex('@ar
+00038370: 7469 636c 657b 4164 653a 3230 3133 7a75  ticle{Ade:2013zu
+00038380: 762c 5c6e 6172 7869 763d 2231 3330 332e  v,\narxiv="1303.
+00038390: 3530 3736 225c 6e7d 2729 0a20 2020 2020  5076"\n}').     
+000383a0: 2020 2064 3120 3d20 2232 3031 382d 3031     d1 = "2018-01
+000383b0: 2d30 3122 0a20 2020 2020 2020 2064 3220  -01".        d2 
+000383c0: 3d20 2232 3031 382d 3031 2d30 3222 0a20  = "2018-01-02". 
+000383d0: 2020 2020 2020 2064 3174 203d 2028 6461         d1t = (da
+000383e0: 7465 7469 6d65 2e64 6174 652e 746f 6461  tetime.date.toda
+000383f0: 7928 2920 2d20 6461 7465 7469 6d65 2e74  y() - datetime.t
+00038400: 696d 6564 656c 7461 2831 2929 2e73 7472  imedelta(1)).str
+00038410: 6674 696d 6528 2225 592d 256d 2d25 6422  ftime("%Y-%m-%d"
+00038420: 290a 2020 2020 2020 2020 6432 7420 3d20  ).        d2t = 
+00038430: 6461 7465 7469 6d65 2e64 6174 652e 746f  datetime.date.to
+00038440: 6461 7928 292e 7374 7266 7469 6d65 2822  day().strftime("
+00038450: 2559 2d25 6d2d 2564 2229 0a20 2020 2020  %Y-%m-%d").     
+00038460: 2020 2072 6573 203d 2073 656c 662e 7042     res = self.pB
+00038470: 4442 2e62 6962 732e 6765 7442 7942 6962  DB.bibs.getByBib
+00038480: 6b65 7928 2241 6465 3a32 3031 337a 7576  key("Ade:2013zuv
+00038490: 2229 5b30 5d0a 2020 2020 2020 2020 6465  ")[0].        de
+000384a0: 6c20 7265 735b 2263 6974 6174 696f 6e73  l res["citations
+000384b0: 225d 0a20 2020 2020 2020 2064 656c 2072  "].        del r
+000384c0: 6573 5b22 6369 7461 7469 6f6e 735f 6e6f  es["citations_no
+000384d0: 5f73 656c 6622 5d0a 2020 2020 2020 2020  _self"].        
+000384e0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+000384f0: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
+00038500: 732c 0a20 2020 2020 2020 2020 2020 207b  s,.            {
+00038510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038520: 2022 6269 626b 6579 223a 2022 4164 653a   "bibkey": "Ade:
+00038530: 3230 3133 7a75 7622 2c0a 2020 2020 2020  2013zuv",.      
+00038540: 2020 2020 2020 2020 2020 2269 6e73 7069            "inspi
+00038550: 7265 223a 204e 6f6e 652c 0a20 2020 2020  re": None,.     
+00038560: 2020 2020 2020 2020 2020 2022 6172 7869             "arxi
+00038570: 7622 3a20 2231 3330 332e 3530 3736 222c  v": "1303.5076",
+00038580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038590: 2022 6164 7322 3a20 4e6f 6e65 2c0a 2020   "ads": None,.  
+000385a0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+000385b0: 6368 6f6c 6172 223a 204e 6f6e 652c 0a20  cholar": None,. 
+000385c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000385d0: 646f 6922 3a20 4e6f 6e65 2c0a 2020 2020  doi": None,.    
+000385e0: 2020 2020 2020 2020 2020 2020 2269 7362              "isb
+000385f0: 6e22 3a20 4e6f 6e65 2c0a 2020 2020 2020  n": None,.      
+00038600: 2020 2020 2020 2020 2020 2279 6561 7222            "year"
+00038610: 3a20 3230 3133 2c0a 2020 2020 2020 2020  : 2013,.        
+00038620: 2020 2020 2020 2020 226c 696e 6b22 3a20          "link": 
+00038630: 2225 732f 6162 732f 3133 3033 2e35 3037  "%s/abs/1303.507
+00038640: 3622 2025 2070 6243 6f6e 6669 672e 6172  6" % pbConfig.ar
+00038650: 7869 7655 726c 2c0a 2020 2020 2020 2020  xivUrl,.        
+00038660: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
+00038670: 7322 3a20 4e6f 6e65 2c0a 2020 2020 2020  s": None,.      
+00038680: 2020 2020 2020 2020 2020 226f 6c64 5f6b            "old_k
+00038690: 6579 7322 3a20 4e6f 6e65 2c0a 2020 2020  eys": None,.    
+000386a0: 2020 2020 2020 2020 2020 2020 2263 726f              "cro
+000386b0: 7373 7265 6622 3a20 4e6f 6e65 2c0a 2020  ssref": None,.  
+000386c0: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+000386d0: 6962 7465 7822 3a20 2240 4172 7469 636c  ibtex": "@Articl
+000386e0: 657b 4164 653a 3230 3133 7a75 762c 5c6e  e{Ade:2013zuv,\n
+000386f0: 2020 2020 2020 2020 2022 0a20 2020 2020           ".     
+00038700: 2020 2020 2020 2020 2020 202b 2027 6172             + 'ar
+00038710: 7869 7620 3d20 2231 3330 332e 3530 3736  xiv = "1303.5076
+00038720: 222c 5c6e 7d27 2c0a 2020 2020 2020 2020  ",\n}',.        
+00038730: 2020 2020 2020 2020 2266 6972 7374 6461          "firstda
+00038740: 7465 223a 2064 3274 2c0a 2020 2020 2020  te": d2t,.      
+00038750: 2020 2020 2020 2020 2020 2270 7562 6461            "pubda
+00038760: 7465 223a 2022 222c 0a20 2020 2020 2020  te": "",.       
+00038770: 2020 2020 2020 2020 2022 6578 705f 7061           "exp_pa
+00038780: 7065 7222 3a20 302c 0a20 2020 2020 2020  per": 0,.       
+00038790: 2020 2020 2020 2020 2022 6c65 6374 7572           "lectur
+000387a0: 6522 3a20 302c 0a20 2020 2020 2020 2020  e": 0,.         
+000387b0: 2020 2020 2020 2022 7068 645f 7468 6573         "phd_thes
+000387c0: 6973 223a 2030 2c0a 2020 2020 2020 2020  is": 0,.        
+000387d0: 2020 2020 2020 2020 2272 6576 6965 7722          "review"
+000387e0: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
+000387f0: 2020 2020 2022 7072 6f63 6565 6469 6e67       "proceeding
+00038800: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
+00038810: 2020 2020 2020 2262 6f6f 6b22 3a20 302c        "book": 0,
+00038820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038830: 2022 6e6f 5570 6461 7465 223a 2030 2c0a   "noUpdate": 0,.
+00038840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038850: 226d 6172 6b73 223a 2022 222c 0a20 2020  "marks": "",.   
+00038860: 2020 2020 2020 2020 2020 2020 2022 6162               "ab
+00038870: 7374 7261 6374 223a 204e 6f6e 652c 0a20  stract": None,. 
+00038880: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00038890: 6269 6274 6578 4469 6374 223a 207b 0a20  bibtexDict": {. 
+000388a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000388b0: 2020 2022 6172 7869 7622 3a20 2231 3330     "arxiv": "130
+000388c0: 332e 3530 3736 222c 0a20 2020 2020 2020  3.5076",.       
+000388d0: 2020 2020 2020 2020 2020 2020 2022 454e               "EN
+000388e0: 5452 5954 5950 4522 3a20 2261 7274 6963  TRYTYPE": "artic
+000388f0: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+00038900: 2020 2020 2020 2020 2022 4944 223a 2022           "ID": "
+00038910: 4164 653a 3230 3133 7a75 7622 2c0a 2020  Ade:2013zuv",.  
+00038920: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+00038930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038940: 2022 7469 746c 6522 3a20 2222 2c0a 2020   "title": "",.  
+00038950: 2020 2020 2020 2020 2020 2020 2020 226a                "j
+00038960: 6f75 726e 616c 223a 2022 222c 0a20 2020  ournal": "",.   
+00038970: 2020 2020 2020 2020 2020 2020 2022 766f               "vo
+00038980: 6c75 6d65 223a 2022 222c 0a20 2020 2020  lume": "",.     
+00038990: 2020 2020 2020 2020 2020 2022 6e75 6d62             "numb
+000389a0: 6572 223a 2022 222c 0a20 2020 2020 2020  er": "",.       
+000389b0: 2020 2020 2020 2020 2022 7061 6765 7322           "pages"
+000389c0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+000389d0: 2020 2020 2020 2270 7562 6c69 7368 6564        "published
+000389e0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+000389f0: 2020 2020 2020 2022 6175 7468 6f72 223a         "author":
+00038a00: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00038a10: 2020 2020 2022 6269 6264 6963 7422 3a20       "bibdict": 
+00038a20: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00038a30: 2020 2020 2020 2261 7278 6976 223a 2022        "arxiv": "
+00038a40: 3133 3033 2e35 3037 3622 2c0a 2020 2020  1303.5076",.    
+00038a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a60: 2245 4e54 5259 5459 5045 223a 2022 6172  "ENTRYTYPE": "ar
+00038a70: 7469 636c 6522 2c0a 2020 2020 2020 2020  ticle",.        
+00038a80: 2020 2020 2020 2020 2020 2020 2249 4422              "ID"
+00038a90: 3a20 2241 6465 3a32 3031 337a 7576 222c  : "Ade:2013zuv",
+00038aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038ab0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00038ac0: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
+00038ad0: 2020 2020 2072 6573 203d 2073 656c 662e       res = self.
+00038ae0: 7042 4442 2e62 6962 732e 6765 7442 7942  pBDB.bibs.getByB
+00038af0: 6962 6b65 7928 2247 6172 6961 7a7a 6f3a  ibkey("Gariazzo:
+00038b00: 3230 3135 7272 6122 295b 305d 0a20 2020  2015rra")[0].   
+00038b10: 2020 2020 2064 656c 2072 6573 5b22 6369       del res["ci
+00038b20: 7461 7469 6f6e 7322 5d0a 2020 2020 2020  tations"].      
+00038b30: 2020 6465 6c20 7265 735b 2263 6974 6174    del res["citat
+00038b40: 696f 6e73 5f6e 6f5f 7365 6c66 225d 0a20  ions_no_self"]. 
+00038b50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00038b60: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00038b70: 2020 2020 2072 6573 2c0a 2020 2020 2020       res,.      
+00038b80: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00038b90: 2020 2020 2020 2020 2262 6962 6b65 7922          "bibkey"
+00038ba0: 3a20 2247 6172 6961 7a7a 6f3a 3230 3135  : "Gariazzo:2015
+00038bb0: 7272 6122 2c0a 2020 2020 2020 2020 2020  rra",.          
+00038bc0: 2020 2020 2020 2269 6e73 7069 7265 223a        "inspire":
+00038bd0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00038be0: 2020 2020 2020 2022 6172 7869 7622 3a20         "arxiv": 
+00038bf0: 2231 3530 372e 3038 3230 3422 2c0a 2020  "1507.08204",.  
+00038c00: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+00038c10: 6473 223a 204e 6f6e 652c 0a20 2020 2020  ds": None,.     
+00038c20: 2020 2020 2020 2020 2020 2022 7363 686f             "scho
+00038c30: 6c61 7222 3a20 4e6f 6e65 2c0a 2020 2020  lar": None,.    
+00038c40: 2020 2020 2020 2020 2020 2020 2264 6f69              "doi
+00038c50: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+00038c60: 2020 2020 2020 2020 2022 6973 626e 223a           "isbn":
+00038c70: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00038c80: 2020 2020 2020 2022 7965 6172 223a 2032         "year": 2
+00038c90: 3031 352c 0a20 2020 2020 2020 2020 2020  015,.           
+00038ca0: 2020 2020 2022 6c69 6e6b 223a 2022 2573       "link": "%s
+00038cb0: 2f61 6273 2f31 3530 372e 3038 3230 3422  /abs/1507.08204"
+00038cc0: 2025 2070 6243 6f6e 6669 672e 6172 7869   % pbConfig.arxi
+00038cd0: 7655 726c 2c0a 2020 2020 2020 2020 2020  vUrl,.          
+00038ce0: 2020 2020 2020 2263 6f6d 6d65 6e74 7322        "comments"
+00038cf0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+00038d00: 2020 2020 2020 2020 226f 6c64 5f6b 6579          "old_key
+00038d10: 7322 3a20 4e6f 6e65 2c0a 2020 2020 2020  s": None,.      
+00038d20: 2020 2020 2020 2020 2020 2263 726f 7373            "cross
+00038d30: 7265 6622 3a20 4e6f 6e65 2c0a 2020 2020  ref": None,.    
+00038d40: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
+00038d50: 7465 7822 3a20 2240 4172 7469 636c 657b  tex": "@Article{
+00038d60: 4761 7269 617a 7a6f 3a32 3031 3572 7261  Gariazzo:2015rra
+00038d70: 2c5c 6e20 2020 2020 2020 2020 220a 2020  ,\n         ".  
+00038d80: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+00038d90: 2761 7278 6976 203d 2022 3135 3037 2e30  'arxiv = "1507.0
+00038da0: 3832 3034 222c 5c6e 7d27 2c0a 2020 2020  8204",\n}',.    
+00038db0: 2020 2020 2020 2020 2020 2020 2266 6972              "fir
+00038dc0: 7374 6461 7465 223a 2064 3274 2c0a 2020  stdate": d2t,.  
+00038dd0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00038de0: 7562 6461 7465 223a 2022 222c 0a20 2020  ubdate": "",.   
+00038df0: 2020 2020 2020 2020 2020 2020 2022 6578               "ex
+00038e00: 705f 7061 7065 7222 3a20 302c 0a20 2020  p_paper": 0,.   
+00038e10: 2020 2020 2020 2020 2020 2020 2022 6c65               "le
+00038e20: 6374 7572 6522 3a20 302c 0a20 2020 2020  cture": 0,.     
+00038e30: 2020 2020 2020 2020 2020 2022 7068 645f             "phd_
+00038e40: 7468 6573 6973 223a 2030 2c0a 2020 2020  thesis": 0,.    
+00038e50: 2020 2020 2020 2020 2020 2020 2272 6576              "rev
+00038e60: 6965 7722 3a20 302c 0a20 2020 2020 2020  iew": 0,.       
+00038e70: 2020 2020 2020 2020 2022 7072 6f63 6565           "procee
+00038e80: 6469 6e67 223a 2030 2c0a 2020 2020 2020  ding": 0,.      
+00038e90: 2020 2020 2020 2020 2020 2262 6f6f 6b22            "book"
+00038ea0: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
+00038eb0: 2020 2020 2022 6e6f 5570 6461 7465 223a       "noUpdate":
+00038ec0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+00038ed0: 2020 2020 226d 6172 6b73 223a 2022 222c      "marks": "",
+00038ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038ef0: 2022 6162 7374 7261 6374 223a 204e 6f6e   "abstract": Non
+00038f00: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00038f10: 2020 2022 6269 6274 6578 4469 6374 223a     "bibtexDict":
+00038f20: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00038f30: 2020 2020 2020 2022 6172 7869 7622 3a20         "arxiv": 
+00038f40: 2231 3530 372e 3038 3230 3422 2c0a 2020  "1507.08204",.  
+00038f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038f60: 2020 2245 4e54 5259 5459 5045 223a 2022    "ENTRYTYPE": "
+00038f70: 6172 7469 636c 6522 2c0a 2020 2020 2020  article",.      
+00038f80: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+00038f90: 4422 3a20 2247 6172 6961 7a7a 6f3a 3230  D": "Gariazzo:20
+00038fa0: 3135 7272 6122 2c0a 2020 2020 2020 2020  15rra",.        
+00038fb0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00038fc0: 2020 2020 2020 2020 2020 2022 7469 746c             "titl
+00038fd0: 6522 3a20 2222 2c0a 2020 2020 2020 2020  e": "",.        
+00038fe0: 2020 2020 2020 2020 226a 6f75 726e 616c          "journal
+00038ff0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+00039000: 2020 2020 2020 2022 766f 6c75 6d65 223a         "volume":
+00039010: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00039020: 2020 2020 2022 6e75 6d62 6572 223a 2022       "number": "
+00039030: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00039040: 2020 2022 7061 6765 7322 3a20 2222 2c0a     "pages": "",.
+00039050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039060: 2270 7562 6c69 7368 6564 223a 2022 222c  "published": "",
+00039070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039080: 2022 6175 7468 6f72 223a 2022 222c 0a20   "author": "",. 
+00039090: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000390a0: 6269 6264 6963 7422 3a20 7b0a 2020 2020  bibdict": {.    
+000390b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000390c0: 2261 7278 6976 223a 2022 3135 3037 2e30  "arxiv": "1507.0
+000390d0: 3832 3034 222c 0a20 2020 2020 2020 2020  8204",.         
+000390e0: 2020 2020 2020 2020 2020 2022 454e 5452             "ENTR
+000390f0: 5954 5950 4522 3a20 2261 7274 6963 6c65  YTYPE": "article
+00039100: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00039110: 2020 2020 2020 2022 4944 223a 2022 4761         "ID": "Ga
+00039120: 7269 617a 7a6f 3a32 3031 3572 7261 222c  riazzo:2015rra",
+00039130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039140: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00039150: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
+00039160: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+00039170: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
+00039180: 7973 6269 626c 696f 2e77 6562 696d 706f  ysbiblio.webimpo
+00039190: 7274 2e69 6e73 7069 7265 2e57 6562 5365  rt.inspire.WebSe
+000391a0: 6172 6368 2e72 6574 7269 6576 6543 756d  arch.retrieveCum
+000391b0: 756c 6174 6976 6555 7064 6174 6573 222c  ulativeUpdates",
+000391c0: 0a20 2020 2020 2020 2020 2020 2073 6964  .            sid
+000391d0: 655f 6566 6665 6374 3d5b 0a20 2020 2020  e_effect=[.     
+000391e0: 2020 2020 2020 2020 2020 205b 5d2c 0a20             [],. 
+000391f0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00039200: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00039210: 2020 205b 5d2c 0a20 2020 2020 2020 2020     [],.         
+00039220: 2020 2020 2020 205b 5d2c 0a20 2020 2020         [],.     
+00039230: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+00039240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039250: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+00039260: 2020 2020 2020 2020 2020 2022 646f 6922             "doi"
+00039270: 3a20 2231 302e 3130 3838 2f30 3935 342d  : "10.1088/0954-
+00039280: 3338 3939 2f34 332f 332f 3033 3330 3031  3899/43/3/033001
+00039290: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000392a0: 2020 2020 2020 2020 2020 2022 6973 626e             "isbn
+000392b0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+000392c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000392d0: 2022 6164 7322 3a20 2232 3031 354a 5068   "ads": "2015JPh
+000392e0: 472e 2e2e 3433 6333 3030 3147 222c 0a20  G...43c3001G",. 
 000392f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039300: 2022 6973 626e 223a 204e 6f6e 652c 0a20   "isbn": None,. 
-00039310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039320: 2020 2020 2020 2022 6164 7322 3a20 2232         "ads": "2
-00039330: 3031 354a 5068 472e 2e2e 3433 6333 3030  015JPhG...43c300
-00039340: 3147 222c 0a20 2020 2020 2020 2020 2020  1G",.           
-00039350: 2020 2020 2020 2020 2020 2020 2022 7075               "pu
-00039360: 6264 6174 6522 3a20 2232 3031 362d 3031  bdate": "2016-01
-00039370: 2d31 3322 2c0a 2020 2020 2020 2020 2020  -13",.          
-00039380: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-00039390: 6972 7374 6461 7465 223a 2022 3230 3135  irstdate": "2015
-000393a0: 2d30 372d 3239 222c 0a20 2020 2020 2020  -07-29",.       
+00039300: 2020 2020 2020 2022 7075 6264 6174 6522         "pubdate"
+00039310: 3a20 2232 3031 362d 3031 2d31 3322 2c0a  : "2016-01-13",.
+00039320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039330: 2020 2020 2020 2020 2266 6972 7374 6461          "firstda
+00039340: 7465 223a 2022 3230 3135 2d30 372d 3239  te": "2015-07-29
+00039350: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00039360: 2020 2020 2020 2020 2020 2022 6a6f 7572             "jour
+00039370: 6e61 6c22 3a20 224a 2e50 6879 732e 222c  nal": "J.Phys.",
+00039380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039390: 2020 2020 2020 2020 2022 6172 7869 7622           "arxiv"
+000393a0: 3a20 2231 3530 372e 3038 3230 3422 2c0a  : "1507.08204",.
 000393b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000393c0: 2022 6a6f 7572 6e61 6c22 3a20 224a 2e50   "journal": "J.P
-000393d0: 6879 732e 222c 0a20 2020 2020 2020 2020  hys.",.         
-000393e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000393f0: 6172 7869 7622 3a20 2231 3530 372e 3038  arxiv": "1507.08
-00039400: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
-00039410: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00039420: 6422 3a20 2231 3338 3535 3833 222c 0a20  d": "1385583",. 
+000393c0: 2020 2020 2020 2020 2269 6422 3a20 2231          "id": "1
+000393d0: 3338 3535 3833 222c 0a20 2020 2020 2020  385583",.       
+000393e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000393f0: 2022 766f 6c75 6d65 223a 2022 4734 3322   "volume": "G43"
+00039400: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00039410: 2020 2020 2020 2020 2020 2262 6962 7465            "bibte
+00039420: 7822 3a20 4e6f 6e65 2c0a 2020 2020 2020  x": None,.      
 00039430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039440: 2020 2020 2020 2022 766f 6c75 6d65 223a         "volume":
-00039450: 2022 4734 3322 2c0a 2020 2020 2020 2020   "G43",.        
-00039460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039470: 2262 6962 7465 7822 3a20 4e6f 6e65 2c0a  "bibtex": None,.
+00039440: 2020 2279 6561 7222 3a20 2232 3031 3622    "year": "2016"
+00039450: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00039460: 2020 2020 2020 2020 2020 226f 6c64 6b65            "oldke
+00039470: 7973 223a 2022 222c 0a20 2020 2020 2020  ys": "",.       
 00039480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039490: 2020 2020 2020 2020 2279 6561 7222 3a20          "year": 
-000394a0: 2232 3031 3622 2c0a 2020 2020 2020 2020  "2016",.        
+00039490: 2022 6269 626b 6579 223a 2022 4761 7269   "bibkey": "Gari
+000394a0: 617a 7a6f 3a32 3031 3572 7261 222c 0a20  azzo:2015rra",. 
 000394b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000394c0: 226f 6c64 6b65 7973 223a 2022 222c 0a20  "oldkeys": "",. 
-000394d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000394e0: 2020 2020 2020 2022 6269 626b 6579 223a         "bibkey":
-000394f0: 2022 4761 7269 617a 7a6f 3a32 3031 3572   "Gariazzo:2015r
-00039500: 7261 222c 0a20 2020 2020 2020 2020 2020  ra",.           
-00039510: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
-00039520: 6765 7322 3a20 2230 3333 3030 3122 2c0a  ges": "033001",.
-00039530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039540: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
-00039550: 3a20 2253 2e20 4761 7269 617a 7a6f 2065  : "S. Gariazzo e
-00039560: 7420 616c 222c 0a20 2020 2020 2020 2020  t al",.         
-00039570: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00039580: 7469 746c 6522 3a20 224c 6967 6874 2073  title": "Light s
-00039590: 7465 7269 6c65 206e 6575 7472 696e 6f73  terile neutrinos
-000395a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000395b0: 2020 2020 2020 2020 2020 2022 6369 7422             "cit"
-000395c0: 3a20 3132 332c 0a20 2020 2020 2020 2020  : 123,.         
-000395d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000395e0: 6369 745f 6e6f 5f73 656c 6622 3a20 3131  cit_no_self": 11
-000395f0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-00039600: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00039610: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00039620: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00039630: 2020 2020 2020 2061 7574 6f73 7065 633d         autospec=
-00039640: 5472 7565 2c0a 2020 2020 2020 2020 2920  True,.        ) 
-00039650: 6173 205f 6d6f 636b 2c20 7061 7463 6828  as _mock, patch(
-00039660: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-00039670: 696e 666f 2229 2061 7320 5f69 3a0a 2020  info") as _i:.  
-00039680: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00039690: 4244 422e 6269 6273 2e67 6574 4461 696c  BDB.bibs.getDail
-000396a0: 7949 6e66 6f46 726f 6d4f 4149 2829 0a20  yInfoFromOAI(). 
-000396b0: 2020 2020 2020 2020 2020 205f 692e 6173             _i.as
-000396c0: 7365 7274 5f61 6e79 5f63 616c 6c28 0a20  sert_any_call(. 
-000396d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000396e0: 4361 6c6c 696e 6720 494e 5350 4952 452d  Calling INSPIRE-
-000396f0: 4845 5020 4f41 4920 6861 7276 6573 7465  HEP OAI harveste
-00039700: 7220 6265 7477 6565 6e20 6461 7465 7320  r between dates 
-00039710: 2573 2061 6e64 2025 7322 2025 2028 6431  %s and %s" % (d1
-00039720: 742c 2064 3274 290a 2020 2020 2020 2020  t, d2t).        
-00039730: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00039740: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00039750: 2e67 6574 4461 696c 7949 6e66 6f46 726f  .getDailyInfoFro
-00039760: 6d4f 4149 2864 312c 2064 3229 0a20 2020  mOAI(d1, d2).   
-00039770: 2020 2020 2020 2020 205f 692e 6173 7365           _i.asse
-00039780: 7274 5f61 6e79 5f63 616c 6c28 0a20 2020  rt_any_call(.   
-00039790: 2020 2020 2020 2020 2020 2020 2022 4361               "Ca
-000397a0: 6c6c 696e 6720 494e 5350 4952 452d 4845  lling INSPIRE-HE
-000397b0: 5020 4f41 4920 6861 7276 6573 7465 7220  P OAI harvester 
-000397c0: 6265 7477 6565 6e20 6461 7465 7320 2573  between dates %s
-000397d0: 2061 6e64 2025 7322 2025 2028 6431 2c20   and %s" % (d1, 
-000397e0: 6432 290a 2020 2020 2020 2020 2020 2020  d2).            
-000397f0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00039800: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-00039810: 4461 696c 7949 6e66 6f46 726f 6d4f 4149  DailyInfoFromOAI
-00039820: 2864 6174 6532 3d64 3229 0a20 2020 2020  (date2=d2).     
-00039830: 2020 2020 2020 205f 692e 6173 7365 7274         _i.assert
-00039840: 5f61 6e79 5f63 616c 6c28 0a20 2020 2020  _any_call(.     
-00039850: 2020 2020 2020 2020 2020 2022 4361 6c6c             "Call
-00039860: 696e 6720 494e 5350 4952 452d 4845 5020  ing INSPIRE-HEP 
-00039870: 4f41 4920 6861 7276 6573 7465 7220 6265  OAI harvester be
-00039880: 7477 6565 6e20 6461 7465 7320 2573 2061  tween dates %s a
-00039890: 6e64 2025 7322 2025 2028 6431 742c 2064  nd %s" % (d1t, d
-000398a0: 3229 0a20 2020 2020 2020 2020 2020 2029  2).            )
-000398b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000398c0: 662e 7042 4442 2e62 6962 732e 6765 7444  f.pBDB.bibs.getD
-000398d0: 6169 6c79 496e 666f 4672 6f6d 4f41 4928  ailyInfoFromOAI(
-000398e0: 6461 7465 313d 6431 290a 2020 2020 2020  date1=d1).      
-000398f0: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
-00039900: 616e 795f 6361 6c6c 280a 2020 2020 2020  any_call(.      
-00039910: 2020 2020 2020 2020 2020 2243 616c 6c69            "Calli
-00039920: 6e67 2049 4e53 5049 5245 2d48 4550 204f  ng INSPIRE-HEP O
-00039930: 4149 2068 6172 7665 7374 6572 2062 6574  AI harvester bet
-00039940: 7765 656e 2064 6174 6573 2025 7320 616e  ween dates %s an
-00039950: 6420 2573 2220 2520 2864 312c 2064 3274  d %s" % (d1, d2t
-00039960: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00039970: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00039980: 2e70 4244 422e 6269 6273 2e67 6574 4461  .pBDB.bibs.getDa
-00039990: 696c 7949 6e66 6f46 726f 6d4f 4149 2864  ilyInfoFromOAI(d
-000399a0: 6174 6531 3d64 3129 0a20 2020 2020 2020  ate1=d1).       
-000399b0: 2020 2020 2072 6573 203d 2073 656c 662e       res = self.
-000399c0: 7042 4442 2e62 6962 732e 6765 7442 7942  pBDB.bibs.getByB
-000399d0: 6962 6b65 7928 2241 6465 3a32 3031 337a  ibkey("Ade:2013z
-000399e0: 7576 2229 5b30 5d0a 2020 2020 2020 2020  uv")[0].        
-000399f0: 2020 2020 6465 6c20 7265 735b 2263 6974      del res["cit
-00039a00: 6174 696f 6e73 225d 0a20 2020 2020 2020  ations"].       
-00039a10: 2020 2020 2064 656c 2072 6573 5b22 6369       del res["ci
-00039a20: 7461 7469 6f6e 735f 6e6f 5f73 656c 6622  tations_no_self"
-00039a30: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-00039a40: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+000394c0: 2020 2020 2020 2022 7061 6765 7322 3a20         "pages": 
+000394d0: 2230 3333 3030 3122 2c0a 2020 2020 2020  "033001",.      
+000394e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000394f0: 2020 2261 7574 686f 7222 3a20 2253 2e20    "author": "S. 
+00039500: 4761 7269 617a 7a6f 2065 7420 616c 222c  Gariazzo et al",
+00039510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039520: 2020 2020 2020 2020 2022 7469 746c 6522           "title"
+00039530: 3a20 224c 6967 6874 2073 7465 7269 6c65  : "Light sterile
+00039540: 206e 6575 7472 696e 6f73 222c 0a20 2020   neutrinos",.   
+00039550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039560: 2020 2020 2022 6369 7422 3a20 3132 332c       "cit": 123,
+00039570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039580: 2020 2020 2020 2020 2022 6369 745f 6e6f           "cit_no
+00039590: 5f73 656c 6622 3a20 3131 312c 0a20 2020  _self": 111,.   
+000395a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000395b0: 207d 0a20 2020 2020 2020 2020 2020 2020   }.             
+000395c0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+000395d0: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+000395e0: 2061 7574 6f73 7065 633d 5472 7565 2c0a   autospec=True,.
+000395f0: 2020 2020 2020 2020 2920 6173 205f 6d6f          ) as _mo
+00039600: 636b 2c20 7061 7463 6828 226c 6f67 6769  ck, patch("loggi
+00039610: 6e67 2e4c 6f67 6765 722e 696e 666f 2229  ng.Logger.info")
+00039620: 2061 7320 5f69 3a0a 2020 2020 2020 2020   as _i:.        
+00039630: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00039640: 6273 2e67 6574 4461 696c 7949 6e66 6f46  bs.getDailyInfoF
+00039650: 726f 6d4f 4149 2829 0a20 2020 2020 2020  romOAI().       
+00039660: 2020 2020 205f 692e 6173 7365 7274 5f61       _i.assert_a
+00039670: 6e79 5f63 616c 6c28 0a20 2020 2020 2020  ny_call(.       
+00039680: 2020 2020 2020 2020 2022 4361 6c6c 696e           "Callin
+00039690: 6720 494e 5350 4952 452d 4845 5020 4f41  g INSPIRE-HEP OA
+000396a0: 4920 6861 7276 6573 7465 7220 6265 7477  I harvester betw
+000396b0: 6565 6e20 6461 7465 7320 2573 2061 6e64  een dates %s and
+000396c0: 2025 7322 2025 2028 6431 742c 2064 3274   %s" % (d1t, d2t
+000396d0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+000396e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000396f0: 2e70 4244 422e 6269 6273 2e67 6574 4461  .pBDB.bibs.getDa
+00039700: 696c 7949 6e66 6f46 726f 6d4f 4149 2864  ilyInfoFromOAI(d
+00039710: 312c 2064 3229 0a20 2020 2020 2020 2020  1, d2).         
+00039720: 2020 205f 692e 6173 7365 7274 5f61 6e79     _i.assert_any
+00039730: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00039740: 2020 2020 2020 2022 4361 6c6c 696e 6720         "Calling 
+00039750: 494e 5350 4952 452d 4845 5020 4f41 4920  INSPIRE-HEP OAI 
+00039760: 6861 7276 6573 7465 7220 6265 7477 6565  harvester betwee
+00039770: 6e20 6461 7465 7320 2573 2061 6e64 2025  n dates %s and %
+00039780: 7322 2025 2028 6431 2c20 6432 290a 2020  s" % (d1, d2).  
+00039790: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000397a0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+000397b0: 422e 6269 6273 2e67 6574 4461 696c 7949  B.bibs.getDailyI
+000397c0: 6e66 6f46 726f 6d4f 4149 2864 6174 6532  nfoFromOAI(date2
+000397d0: 3d64 3229 0a20 2020 2020 2020 2020 2020  =d2).           
+000397e0: 205f 692e 6173 7365 7274 5f61 6e79 5f63   _i.assert_any_c
+000397f0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+00039800: 2020 2020 2022 4361 6c6c 696e 6720 494e       "Calling IN
+00039810: 5350 4952 452d 4845 5020 4f41 4920 6861  SPIRE-HEP OAI ha
+00039820: 7276 6573 7465 7220 6265 7477 6565 6e20  rvester between 
+00039830: 6461 7465 7320 2573 2061 6e64 2025 7322  dates %s and %s"
+00039840: 2025 2028 6431 742c 2064 3229 0a20 2020   % (d1t, d2).   
+00039850: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00039860: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00039870: 2e62 6962 732e 6765 7444 6169 6c79 496e  .bibs.getDailyIn
+00039880: 666f 4672 6f6d 4f41 4928 6461 7465 313d  foFromOAI(date1=
+00039890: 6431 290a 2020 2020 2020 2020 2020 2020  d1).            
+000398a0: 5f69 2e61 7373 6572 745f 616e 795f 6361  _i.assert_any_ca
+000398b0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+000398c0: 2020 2020 2243 616c 6c69 6e67 2049 4e53      "Calling INS
+000398d0: 5049 5245 2d48 4550 204f 4149 2068 6172  PIRE-HEP OAI har
+000398e0: 7665 7374 6572 2062 6574 7765 656e 2064  vester between d
+000398f0: 6174 6573 2025 7320 616e 6420 2573 2220  ates %s and %s" 
+00039900: 2520 2864 312c 2064 3274 290a 2020 2020  % (d1, d2t).    
+00039910: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00039920: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00039930: 6269 6273 2e67 6574 4461 696c 7949 6e66  bibs.getDailyInf
+00039940: 6f46 726f 6d4f 4149 2864 6174 6531 3d64  oFromOAI(date1=d
+00039950: 3129 0a20 2020 2020 2020 2020 2020 2072  1).            r
+00039960: 6573 203d 2073 656c 662e 7042 4442 2e62  es = self.pBDB.b
+00039970: 6962 732e 6765 7442 7942 6962 6b65 7928  ibs.getByBibkey(
+00039980: 2241 6465 3a32 3031 337a 7576 2229 5b30  "Ade:2013zuv")[0
+00039990: 5d0a 2020 2020 2020 2020 2020 2020 6465  ].            de
+000399a0: 6c20 7265 735b 2263 6974 6174 696f 6e73  l res["citations
+000399b0: 225d 0a20 2020 2020 2020 2020 2020 2064  "].            d
+000399c0: 656c 2072 6573 5b22 6369 7461 7469 6f6e  el res["citation
+000399d0: 735f 6e6f 5f73 656c 6622 5d0a 2020 2020  s_no_self"].    
+000399e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000399f0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00039a00: 2020 2020 2020 2020 2020 7265 732c 0a20            res,. 
+00039a10: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00039a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039a30: 2020 2020 2022 6269 626b 6579 223a 2022       "bibkey": "
+00039a40: 4164 653a 3230 3133 7a75 7622 2c0a 2020  Ade:2013zuv",.  
 00039a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039a60: 7265 732c 0a20 2020 2020 2020 2020 2020  res,.           
-00039a70: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00039a80: 2020 2020 2020 2020 2020 2022 6269 626b             "bibk
-00039a90: 6579 223a 2022 4164 653a 3230 3133 7a75  ey": "Ade:2013zu
-00039aa0: 7622 2c0a 2020 2020 2020 2020 2020 2020  v",.            
-00039ab0: 2020 2020 2020 2020 2269 6e73 7069 7265          "inspire
-00039ac0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-00039ad0: 2020 2020 2020 2020 2020 2020 2022 6172               "ar
-00039ae0: 7869 7622 3a20 2231 3330 332e 3530 3736  xiv": "1303.5076
-00039af0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00039b00: 2020 2020 2020 2022 6164 7322 3a20 4e6f         "ads": No
-00039b10: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00039b20: 2020 2020 2020 2020 2273 6368 6f6c 6172          "scholar
-00039b30: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-00039b40: 2020 2020 2020 2020 2020 2020 2022 646f               "do
-00039b50: 6922 3a20 4e6f 6e65 2c0a 2020 2020 2020  i": None,.      
-00039b60: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00039b70: 7362 6e22 3a20 4e6f 6e65 2c0a 2020 2020  sbn": None,.    
-00039b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039b90: 2279 6561 7222 3a20 3230 3133 2c0a 2020  "year": 2013,.  
-00039ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039bb0: 2020 226c 696e 6b22 3a20 2225 732f 6162    "link": "%s/ab
-00039bc0: 732f 3133 3033 2e35 3037 3622 2025 2070  s/1303.5076" % p
-00039bd0: 6243 6f6e 6669 672e 6172 7869 7655 726c  bConfig.arxivUrl
-00039be0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00039bf0: 2020 2020 2020 2263 6f6d 6d65 6e74 7322        "comments"
-00039c00: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-00039c10: 2020 2020 2020 2020 2020 2020 226f 6c64              "old
-00039c20: 5f6b 6579 7322 3a20 4e6f 6e65 2c0a 2020  _keys": None,.  
-00039c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039c40: 2020 2263 726f 7373 7265 6622 3a20 4e6f    "crossref": No
-00039c50: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00039c60: 2020 2020 2020 2020 2262 6962 7465 7822          "bibtex"
-00039c70: 3a20 2240 4172 7469 636c 657b 4164 653a  : "@Article{Ade:
-00039c80: 3230 3133 7a75 762c 5c6e 2020 2020 2020  2013zuv,\n      
-00039c90: 2020 2022 0a20 2020 2020 2020 2020 2020     ".           
-00039ca0: 2020 2020 2020 2020 202b 2027 6172 7869           + 'arxi
-00039cb0: 7620 3d20 2231 3330 332e 3530 3736 222c  v = "1303.5076",
-00039cc0: 5c6e 7d27 2c0a 2020 2020 2020 2020 2020  \n}',.          
-00039cd0: 2020 2020 2020 2020 2020 2266 6972 7374            "first
-00039ce0: 6461 7465 223a 2064 3274 2c0a 2020 2020  date": d2t,.    
-00039cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039d00: 2270 7562 6461 7465 223a 2022 222c 0a20  "pubdate": "",. 
-00039d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039d20: 2020 2022 6578 705f 7061 7065 7222 3a20     "exp_paper": 
-00039d30: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-00039d40: 2020 2020 2020 2022 6c65 6374 7572 6522         "lecture"
-00039d50: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
-00039d60: 2020 2020 2020 2020 2022 7068 645f 7468           "phd_th
-00039d70: 6573 6973 223a 2030 2c0a 2020 2020 2020  esis": 0,.      
-00039d80: 2020 2020 2020 2020 2020 2020 2020 2272                "r
-00039d90: 6576 6965 7722 3a20 302c 0a20 2020 2020  eview": 0,.     
-00039da0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00039db0: 7072 6f63 6565 6469 6e67 223a 2030 2c0a  proceeding": 0,.
-00039dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039dd0: 2020 2020 2262 6f6f 6b22 3a20 302c 0a20      "book": 0,. 
-00039de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039df0: 2020 2022 6e6f 5570 6461 7465 223a 2030     "noUpdate": 0
-00039e00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00039e10: 2020 2020 2020 226d 6172 6b73 223a 2022        "marks": "
-00039e20: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00039e30: 2020 2020 2020 2022 6162 7374 7261 6374         "abstract
-00039e40: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-00039e50: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
-00039e60: 6274 6578 4469 6374 223a 207b 0a20 2020  btexDict": {.   
-00039e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039e80: 2020 2020 2022 6172 7869 7622 3a20 2231       "arxiv": "1
-00039e90: 3330 332e 3530 3736 222c 0a20 2020 2020  303.5076",.     
-00039ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039eb0: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-00039ec0: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-00039ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039ee0: 2020 2022 4944 223a 2022 4164 653a 3230     "ID": "Ade:20
-00039ef0: 3133 7a75 7622 2c0a 2020 2020 2020 2020  13zuv",.        
-00039f00: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-00039f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039f20: 2020 2022 7469 746c 6522 3a20 2222 2c0a     "title": "",.
-00039f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039f40: 2020 2020 226a 6f75 726e 616c 223a 2022      "journal": "
-00039f50: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00039f60: 2020 2020 2020 2022 766f 6c75 6d65 223a         "volume":
-00039f70: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00039f80: 2020 2020 2020 2020 2022 6e75 6d62 6572           "number
-00039f90: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-00039fa0: 2020 2020 2020 2020 2020 2022 7061 6765             "page
-00039fb0: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
-00039fc0: 2020 2020 2020 2020 2020 2020 2270 7562              "pub
-00039fd0: 6c69 7368 6564 223a 2022 222c 0a20 2020  lished": "",.   
-00039fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039ff0: 2022 6175 7468 6f72 223a 2022 222c 0a20   "author": "",. 
+00039a60: 2020 2269 6e73 7069 7265 223a 204e 6f6e    "inspire": Non
+00039a70: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00039a80: 2020 2020 2020 2022 6172 7869 7622 3a20         "arxiv": 
+00039a90: 2231 3330 332e 3530 3736 222c 0a20 2020  "1303.5076",.   
+00039aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ab0: 2022 6164 7322 3a20 4e6f 6e65 2c0a 2020   "ads": None,.  
+00039ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ad0: 2020 2273 6368 6f6c 6172 223a 204e 6f6e    "scholar": Non
+00039ae0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00039af0: 2020 2020 2020 2022 646f 6922 3a20 4e6f         "doi": No
+00039b00: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00039b10: 2020 2020 2020 2020 2269 7362 6e22 3a20          "isbn": 
+00039b20: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00039b30: 2020 2020 2020 2020 2020 2279 6561 7222            "year"
+00039b40: 3a20 3230 3133 2c0a 2020 2020 2020 2020  : 2013,.        
+00039b50: 2020 2020 2020 2020 2020 2020 226c 696e              "lin
+00039b60: 6b22 3a20 2225 732f 6162 732f 3133 3033  k": "%s/abs/1303
+00039b70: 2e35 3037 3622 2025 2070 6243 6f6e 6669  .5076" % pbConfi
+00039b80: 672e 6172 7869 7655 726c 2c0a 2020 2020  g.arxivUrl,.    
+00039b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ba0: 2263 6f6d 6d65 6e74 7322 3a20 4e6f 6e65  "comments": None
+00039bb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00039bc0: 2020 2020 2020 226f 6c64 5f6b 6579 7322        "old_keys"
+00039bd0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+00039be0: 2020 2020 2020 2020 2020 2020 2263 726f              "cro
+00039bf0: 7373 7265 6622 3a20 4e6f 6e65 2c0a 2020  ssref": None,.  
+00039c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039c10: 2020 2262 6962 7465 7822 3a20 2240 4172    "bibtex": "@Ar
+00039c20: 7469 636c 657b 4164 653a 3230 3133 7a75  ticle{Ade:2013zu
+00039c30: 762c 5c6e 2020 2020 2020 2020 2022 0a20  v,\n         ". 
+00039c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039c50: 2020 202b 2027 6172 7869 7620 3d20 2231     + 'arxiv = "1
+00039c60: 3330 332e 3530 3736 222c 5c6e 7d27 2c0a  303.5076",\n}',.
+00039c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039c80: 2020 2020 2266 6972 7374 6461 7465 223a      "firstdate":
+00039c90: 2064 3274 2c0a 2020 2020 2020 2020 2020   d2t,.          
+00039ca0: 2020 2020 2020 2020 2020 2270 7562 6461            "pubda
+00039cb0: 7465 223a 2022 222c 0a20 2020 2020 2020  te": "",.       
+00039cc0: 2020 2020 2020 2020 2020 2020 2022 6578               "ex
+00039cd0: 705f 7061 7065 7222 3a20 302c 0a20 2020  p_paper": 0,.   
+00039ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039cf0: 2022 6c65 6374 7572 6522 3a20 302c 0a20   "lecture": 0,. 
+00039d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039d10: 2020 2022 7068 645f 7468 6573 6973 223a     "phd_thesis":
+00039d20: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+00039d30: 2020 2020 2020 2020 2272 6576 6965 7722          "review"
+00039d40: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
+00039d50: 2020 2020 2020 2020 2022 7072 6f63 6565           "procee
+00039d60: 6469 6e67 223a 2030 2c0a 2020 2020 2020  ding": 0,.      
+00039d70: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+00039d80: 6f6f 6b22 3a20 302c 0a20 2020 2020 2020  ook": 0,.       
+00039d90: 2020 2020 2020 2020 2020 2020 2022 6e6f               "no
+00039da0: 5570 6461 7465 223a 2030 2c0a 2020 2020  Update": 0,.    
+00039db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039dc0: 226d 6172 6b73 223a 2022 222c 0a20 2020  "marks": "",.   
+00039dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039de0: 2022 6162 7374 7261 6374 223a 204e 6f6e   "abstract": Non
+00039df0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00039e00: 2020 2020 2020 2022 6269 6274 6578 4469         "bibtexDi
+00039e10: 6374 223a 207b 0a20 2020 2020 2020 2020  ct": {.         
+00039e20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00039e30: 6172 7869 7622 3a20 2231 3330 332e 3530  arxiv": "1303.50
+00039e40: 3736 222c 0a20 2020 2020 2020 2020 2020  76",.           
+00039e50: 2020 2020 2020 2020 2020 2020 2022 454e               "EN
+00039e60: 5452 5954 5950 4522 3a20 2261 7274 6963  TRYTYPE": "artic
+00039e70: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+00039e80: 2020 2020 2020 2020 2020 2020 2022 4944               "ID
+00039e90: 223a 2022 4164 653a 3230 3133 7a75 7622  ": "Ade:2013zuv"
+00039ea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00039eb0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00039ec0: 2020 2020 2020 2020 2020 2020 2022 7469               "ti
+00039ed0: 746c 6522 3a20 2222 2c0a 2020 2020 2020  tle": "",.      
+00039ee0: 2020 2020 2020 2020 2020 2020 2020 226a                "j
+00039ef0: 6f75 726e 616c 223a 2022 222c 0a20 2020  ournal": "",.   
+00039f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f10: 2022 766f 6c75 6d65 223a 2022 222c 0a20   "volume": "",. 
+00039f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f30: 2020 2022 6e75 6d62 6572 223a 2022 222c     "number": "",
+00039f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039f50: 2020 2020 2022 7061 6765 7322 3a20 2222       "pages": ""
+00039f60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00039f70: 2020 2020 2020 2270 7562 6c69 7368 6564        "published
+00039f80: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+00039f90: 2020 2020 2020 2020 2020 2022 6175 7468             "auth
+00039fa0: 6f72 223a 2022 222c 0a20 2020 2020 2020  or": "",.       
+00039fb0: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+00039fc0: 6264 6963 7422 3a20 7b0a 2020 2020 2020  bdict": {.      
+00039fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039fe0: 2020 2261 7278 6976 223a 2022 3133 3033    "arxiv": "1303
+00039ff0: 2e35 3037 3622 2c0a 2020 2020 2020 2020  .5076",.        
 0003a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a010: 2020 2022 6269 6264 6963 7422 3a20 7b0a     "bibdict": {.
-0003a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a030: 2020 2020 2020 2020 2261 7278 6976 223a          "arxiv":
-0003a040: 2022 3133 3033 2e35 3037 3622 2c0a 2020   "1303.5076",.  
-0003a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a060: 2020 2020 2020 2245 4e54 5259 5459 5045        "ENTRYTYPE
-0003a070: 223a 2022 6172 7469 636c 6522 2c0a 2020  ": "article",.  
-0003a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a090: 2020 2020 2020 2249 4422 3a20 2241 6465        "ID": "Ade
-0003a0a0: 3a32 3031 337a 7576 222c 0a20 2020 2020  :2013zuv",.     
-0003a0b0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0003a0c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003a0d0: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-0003a0e0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-0003a0f0: 6573 203d 2073 656c 662e 7042 4442 2e62  es = self.pBDB.b
-0003a100: 6962 732e 6765 7442 7942 6962 6b65 7928  ibs.getByBibkey(
-0003a110: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
-0003a120: 6122 295b 305d 0a20 2020 2020 2020 2020  a")[0].         
-0003a130: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-0003a140: 7565 2872 6573 5b22 6369 7461 7469 6f6e  ue(res["citation
-0003a150: 7322 5d20 3d3d 2031 3233 290a 2020 2020  s"] == 123).    
-0003a160: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0003a170: 6572 7454 7275 6528 7265 735b 2263 6974  ertTrue(res["cit
-0003a180: 6174 696f 6e73 5f6e 6f5f 7365 6c66 225d  ations_no_self"]
-0003a190: 203d 3d20 3131 3129 0a20 2020 2020 2020   == 111).       
-0003a1a0: 2020 2020 2064 656c 2072 6573 5b22 6369       del res["ci
-0003a1b0: 7461 7469 6f6e 7322 5d0a 2020 2020 2020  tations"].      
-0003a1c0: 2020 2020 2020 6465 6c20 7265 735b 2263        del res["c
-0003a1d0: 6974 6174 696f 6e73 5f6e 6f5f 7365 6c66  itations_no_self
-0003a1e0: 225d 0a20 2020 2020 2020 2020 2020 2073  "].            s
-0003a1f0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0003a200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a210: 2072 6573 2c0a 2020 2020 2020 2020 2020   res,.          
-0003a220: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-0003a230: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0003a240: 6b65 7922 3a20 2247 6172 6961 7a7a 6f3a  key": "Gariazzo:
-0003a250: 3230 3135 7272 6122 2c0a 2020 2020 2020  2015rra",.      
-0003a260: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-0003a270: 6e73 7069 7265 223a 2022 3133 3835 3538  nspire": "138558
-0003a280: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-0003a290: 2020 2020 2020 2020 2261 7278 6976 223a          "arxiv":
-0003a2a0: 2022 3135 3037 2e30 3832 3034 222c 0a20   "1507.08204",. 
+0003a010: 2245 4e54 5259 5459 5045 223a 2022 6172  "ENTRYTYPE": "ar
+0003a020: 7469 636c 6522 2c0a 2020 2020 2020 2020  ticle",.        
+0003a030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a040: 2249 4422 3a20 2241 6465 3a32 3031 337a  "ID": "Ade:2013z
+0003a050: 7576 222c 0a20 2020 2020 2020 2020 2020  uv",.           
+0003a060: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+0003a070: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0003a080: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0003a090: 2020 2020 2020 2020 2072 6573 203d 2073           res = s
+0003a0a0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+0003a0b0: 7442 7942 6962 6b65 7928 2247 6172 6961  tByBibkey("Garia
+0003a0c0: 7a7a 6f3a 3230 3135 7272 6122 295b 305d  zzo:2015rra")[0]
+0003a0d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003a0e0: 662e 6173 7365 7274 5472 7565 2872 6573  f.assertTrue(res
+0003a0f0: 5b22 6369 7461 7469 6f6e 7322 5d20 3d3d  ["citations"] ==
+0003a100: 2031 3233 290a 2020 2020 2020 2020 2020   123).          
+0003a110: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+0003a120: 6528 7265 735b 2263 6974 6174 696f 6e73  e(res["citations
+0003a130: 5f6e 6f5f 7365 6c66 225d 203d 3d20 3131  _no_self"] == 11
+0003a140: 3129 0a20 2020 2020 2020 2020 2020 2064  1).            d
+0003a150: 656c 2072 6573 5b22 6369 7461 7469 6f6e  el res["citation
+0003a160: 7322 5d0a 2020 2020 2020 2020 2020 2020  s"].            
+0003a170: 6465 6c20 7265 735b 2263 6974 6174 696f  del res["citatio
+0003a180: 6e73 5f6e 6f5f 7365 6c66 225d 0a20 2020  ns_no_self"].   
+0003a190: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0003a1a0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0003a1b0: 2020 2020 2020 2020 2020 2072 6573 2c0a             res,.
+0003a1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a1d0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0003a1e0: 2020 2020 2020 2262 6962 6b65 7922 3a20        "bibkey": 
+0003a1f0: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
+0003a200: 6122 2c0a 2020 2020 2020 2020 2020 2020  a",.            
+0003a210: 2020 2020 2020 2020 2269 6e73 7069 7265          "inspire
+0003a220: 223a 2022 3133 3835 3538 3322 2c0a 2020  ": "1385583",.  
+0003a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a240: 2020 2261 7278 6976 223a 2022 3135 3037    "arxiv": "1507
+0003a250: 2e30 3832 3034 222c 0a20 2020 2020 2020  .08204",.       
+0003a260: 2020 2020 2020 2020 2020 2020 2022 6164               "ad
+0003a270: 7322 3a20 2232 3031 354a 5068 472e 2e2e  s": "2015JPhG...
+0003a280: 3433 6333 3030 3147 222c 0a20 2020 2020  43c3001G",.     
+0003a290: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003a2a0: 7363 686f 6c61 7222 3a20 4e6f 6e65 2c0a  scholar": None,.
 0003a2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2c0: 2020 2022 6164 7322 3a20 2232 3031 354a     "ads": "2015J
-0003a2d0: 5068 472e 2e2e 3433 6333 3030 3147 222c  PhG...43c3001G",
-0003a2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a2f0: 2020 2020 2022 7363 686f 6c61 7222 3a20       "scholar": 
-0003a300: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0003a310: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
-0003a320: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
-0003a330: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
-0003a340: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003a350: 2020 2020 2020 2269 7362 6e22 3a20 4e6f        "isbn": No
-0003a360: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0003a370: 2020 2020 2020 2020 2279 6561 7222 3a20          "year": 
-0003a380: 2232 3031 3622 2c0a 2020 2020 2020 2020  "2016",.        
-0003a390: 2020 2020 2020 2020 2020 2020 226c 696e              "lin
-0003a3a0: 6b22 3a20 2225 732f 6162 732f 3135 3037  k": "%s/abs/1507
-0003a3b0: 2e30 3832 3034 2220 2520 7062 436f 6e66  .08204" % pbConf
-0003a3c0: 6967 2e61 7278 6976 5572 6c2c 0a20 2020  ig.arxivUrl,.   
-0003a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a3e0: 2022 636f 6d6d 656e 7473 223a 204e 6f6e   "comments": Non
-0003a3f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0003a400: 2020 2020 2020 2022 6f6c 645f 6b65 7973         "old_keys
-0003a410: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-0003a420: 2020 2020 2020 2020 2020 2020 2022 6372               "cr
-0003a430: 6f73 7372 6566 223a 204e 6f6e 652c 0a20  ossref": None,. 
-0003a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a450: 2020 2022 6269 6274 6578 223a 2022 4041     "bibtex": "@A
-0003a460: 7274 6963 6c65 7b47 6172 6961 7a7a 6f3a  rticle{Gariazzo:
-0003a470: 3230 3135 7272 612c 5c6e 220a 2020 2020  2015rra,\n".    
-0003a480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a490: 2b20 2720 2020 2020 2020 2061 7574 686f  + '        autho
-0003a4a0: 7220 3d20 2253 2e20 4761 7269 617a 7a6f  r = "S. Gariazzo
-0003a4b0: 2065 7420 616c 222c 5c6e 270a 2020 2020   et al",\n'.    
-0003a4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a4d0: 2b20 2720 2020 2020 2020 2020 7469 746c  + '         titl
-0003a4e0: 6520 3d20 227b 4c69 6768 7420 7374 6572  e = "{Light ster
-0003a4f0: 696c 6520 6e65 7574 7269 6e6f 737d 222c  ile neutrinos}",
-0003a500: 5c6e 270a 2020 2020 2020 2020 2020 2020  \n'.            
-0003a510: 2020 2020 2020 2020 2b20 2720 2020 2020          + '     
-0003a520: 2020 6a6f 7572 6e61 6c20 3d20 224a 2e50    journal = "J.P
-0003a530: 6879 732e 222c 5c6e 2020 2020 2020 2020  hys.",\n        
-0003a540: 766f 6c75 6d65 203d 2022 4734 3322 2c5c  volume = "G43",\
-0003a550: 6e20 270a 2020 2020 2020 2020 2020 2020  n '.            
-0003a560: 2020 2020 2020 2020 2b20 2720 2020 2020          + '     
-0003a570: 2020 2020 7965 6172 203d 2022 3230 3136      year = "2016
-0003a580: 222c 5c6e 2020 2020 2020 2020 2070 6167  ",\n         pag
-0003a590: 6573 203d 2027 0a20 2020 2020 2020 2020  es = '.         
-0003a5a0: 2020 2020 2020 2020 2020 202b 2027 2230             + '"0
-0003a5b0: 3333 3030 3122 2c5c 6e20 2020 2020 2020  33001",\n       
-0003a5c0: 2065 7072 696e 7420 3d20 270a 2020 2020   eprint = '.    
-0003a5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a5e0: 2b20 2722 3135 3037 2e30 3832 3034 222c  + '"1507.08204",
-0003a5f0: 5c6e 2020 2020 2020 2020 2020 2064 6f69  \n           doi
-0003a600: 203d 2027 0a20 2020 2020 2020 2020 2020   = '.           
-0003a610: 2020 2020 2020 2020 202b 2027 2231 302e           + '"10.
-0003a620: 3130 3838 2f30 3935 342d 3338 3939 2f34  1088/0954-3899/4
-0003a630: 332f 332f 3033 3330 3031 222c 5c6e 7d27  3/3/033001",\n}'
-0003a640: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003a650: 2020 2020 2020 2266 6972 7374 6461 7465        "firstdate
-0003a660: 223a 2022 3230 3135 2d30 372d 3239 222c  ": "2015-07-29",
-0003a670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a680: 2020 2020 2022 7075 6264 6174 6522 3a20       "pubdate": 
-0003a690: 2232 3031 362d 3031 2d31 3322 2c0a 2020  "2016-01-13",.  
-0003a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a6b0: 2020 2265 7870 5f70 6170 6572 223a 2030    "exp_paper": 0
-0003a6c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003a6d0: 2020 2020 2020 226c 6563 7475 7265 223a        "lecture":
-0003a6e0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-0003a6f0: 2020 2020 2020 2020 2270 6864 5f74 6865          "phd_the
-0003a700: 7369 7322 3a20 302c 0a20 2020 2020 2020  sis": 0,.       
-0003a710: 2020 2020 2020 2020 2020 2020 2022 7265               "re
-0003a720: 7669 6577 223a 2030 2c0a 2020 2020 2020  view": 0,.      
-0003a730: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-0003a740: 726f 6365 6564 696e 6722 3a20 302c 0a20  roceeding": 0,. 
-0003a750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a760: 2020 2022 626f 6f6b 223a 2030 2c0a 2020     "book": 0,.  
-0003a770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a780: 2020 226e 6f55 7064 6174 6522 3a20 302c    "noUpdate": 0,
-0003a790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a7a0: 2020 2020 2022 6d61 726b 7322 3a20 2222       "marks": ""
-0003a7b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003a7c0: 2020 2020 2020 2261 6273 7472 6163 7422        "abstract"
-0003a7d0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0003a7e0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0003a7f0: 7465 7844 6963 7422 3a20 7b0a 2020 2020  texDict": {.    
-0003a800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a810: 2020 2020 2265 7072 696e 7422 3a20 2231      "eprint": "1
-0003a820: 3530 372e 3038 3230 3422 2c0a 2020 2020  507.08204",.    
-0003a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a840: 2020 2020 2261 7574 686f 7222 3a20 2253      "author": "S
-0003a850: 2e20 4761 7269 617a 7a6f 2065 7420 616c  . Gariazzo et al
-0003a860: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0003a870: 2020 2020 2020 2020 2020 2022 646f 6922             "doi"
-0003a880: 3a20 2231 302e 3130 3838 2f30 3935 342d  : "10.1088/0954-
-0003a890: 3338 3939 2f34 332f 332f 3033 3330 3031  3899/43/3/033001
-0003a8a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0003a8b0: 2020 2020 2020 2020 2020 2022 7061 6765             "page
-0003a8c0: 7322 3a20 2230 3333 3030 3122 2c0a 2020  s": "033001",.  
-0003a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a8e0: 2020 2020 2020 2274 6974 6c65 223a 2022        "title": "
-0003a8f0: 7b4c 6967 6874 2073 7465 7269 6c65 206e  {Light sterile n
-0003a900: 6575 7472 696e 6f73 7d22 2c0a 2020 2020  eutrinos}",.    
-0003a910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a920: 2020 2020 2279 6561 7222 3a20 2232 3031      "year": "201
-0003a930: 3622 2c0a 2020 2020 2020 2020 2020 2020  6",.            
-0003a940: 2020 2020 2020 2020 2020 2020 2276 6f6c              "vol
-0003a950: 756d 6522 3a20 2247 3433 222c 0a20 2020  ume": "G43",.   
-0003a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a970: 2020 2020 2022 6a6f 7572 6e61 6c22 3a20       "journal": 
-0003a980: 224a 2e50 6879 732e 222c 0a20 2020 2020  "J.Phys.",.     
-0003a990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a9a0: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-0003a9b0: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-0003a9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a9d0: 2020 2022 4944 223a 2022 4761 7269 617a     "ID": "Gariaz
-0003a9e0: 7a6f 3a32 3031 3572 7261 222c 0a20 2020  zo:2015rra",.   
-0003a9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa00: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0003aa10: 2020 2020 2020 2020 2274 6974 6c65 223a          "title":
-0003aa20: 2022 7b4c 6967 6874 2073 7465 7269 6c65   "{Light sterile
-0003aa30: 206e 6575 7472 696e 6f73 7d22 2c0a 2020   neutrinos}",.  
-0003aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa50: 2020 226a 6f75 726e 616c 223a 2022 4a2e    "journal": "J.
-0003aa60: 5068 7973 2e22 2c0a 2020 2020 2020 2020  Phys.",.        
-0003aa70: 2020 2020 2020 2020 2020 2020 2276 6f6c              "vol
-0003aa80: 756d 6522 3a20 2247 3433 222c 0a20 2020  ume": "G43",.   
-0003aa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aaa0: 2022 6e75 6d62 6572 223a 2022 222c 0a20   "number": "",. 
-0003aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aac0: 2020 2022 7061 6765 7322 3a20 2230 3333     "pages": "033
-0003aad0: 3030 3122 2c0a 2020 2020 2020 2020 2020  001",.          
-0003aae0: 2020 2020 2020 2020 2020 2270 7562 6c69            "publi
-0003aaf0: 7368 6564 223a 2022 4a2e 5068 7973 2e20  shed": "J.Phys. 
-0003ab00: 4734 3320 2832 3031 3629 2030 3333 3030  G43 (2016) 03300
-0003ab10: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-0003ab20: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
-0003ab30: 3a20 2253 2e20 4761 7269 617a 7a6f 2065  : "S. Gariazzo e
-0003ab40: 7420 616c 222c 0a20 2020 2020 2020 2020  t al",.         
-0003ab50: 2020 2020 2020 2020 2020 2022 6269 6264             "bibd
-0003ab60: 6963 7422 3a20 7b0a 2020 2020 2020 2020  ict": {.        
-0003ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ab80: 2264 6f69 223a 2022 3130 2e31 3038 382f  "doi": "10.1088/
-0003ab90: 3039 3534 2d33 3839 392f 3433 2f33 2f30  0954-3899/43/3/0
-0003aba0: 3333 3030 3122 2c0a 2020 2020 2020 2020  33001",.        
+0003a2c0: 2020 2020 2264 6f69 223a 2022 3130 2e31      "doi": "10.1
+0003a2d0: 3038 382f 3039 3534 2d33 3839 392f 3433  088/0954-3899/43
+0003a2e0: 2f33 2f30 3333 3030 3122 2c0a 2020 2020  /3/033001",.    
+0003a2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a300: 2269 7362 6e22 3a20 4e6f 6e65 2c0a 2020  "isbn": None,.  
+0003a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a320: 2020 2279 6561 7222 3a20 2232 3031 3622    "year": "2016"
+0003a330: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003a340: 2020 2020 2020 226c 696e 6b22 3a20 2225        "link": "%
+0003a350: 732f 6162 732f 3135 3037 2e30 3832 3034  s/abs/1507.08204
+0003a360: 2220 2520 7062 436f 6e66 6967 2e61 7278  " % pbConfig.arx
+0003a370: 6976 5572 6c2c 0a20 2020 2020 2020 2020  ivUrl,.         
+0003a380: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
+0003a390: 656e 7473 223a 204e 6f6e 652c 0a20 2020  ents": None,.   
+0003a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a3b0: 2022 6f6c 645f 6b65 7973 223a 204e 6f6e   "old_keys": Non
+0003a3c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0003a3d0: 2020 2020 2020 2022 6372 6f73 7372 6566         "crossref
+0003a3e0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+0003a3f0: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+0003a400: 6274 6578 223a 2022 4041 7274 6963 6c65  btex": "@Article
+0003a410: 7b47 6172 6961 7a7a 6f3a 3230 3135 7272  {Gariazzo:2015rr
+0003a420: 612c 5c6e 220a 2020 2020 2020 2020 2020  a,\n".          
+0003a430: 2020 2020 2020 2020 2020 2b20 2720 2020            + '   
+0003a440: 2020 2020 2061 7574 686f 7220 3d20 2253       author = "S
+0003a450: 2e20 4761 7269 617a 7a6f 2065 7420 616c  . Gariazzo et al
+0003a460: 222c 5c6e 270a 2020 2020 2020 2020 2020  ",\n'.          
+0003a470: 2020 2020 2020 2020 2020 2b20 2720 2020            + '   
+0003a480: 2020 2020 2020 7469 746c 6520 3d20 227b        title = "{
+0003a490: 4c69 6768 7420 7374 6572 696c 6520 6e65  Light sterile ne
+0003a4a0: 7574 7269 6e6f 737d 222c 5c6e 270a 2020  utrinos}",\n'.  
+0003a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a4c0: 2020 2b20 2720 2020 2020 2020 6a6f 7572    + '       jour
+0003a4d0: 6e61 6c20 3d20 224a 2e50 6879 732e 222c  nal = "J.Phys.",
+0003a4e0: 5c6e 2020 2020 2020 2020 766f 6c75 6d65  \n        volume
+0003a4f0: 203d 2022 4734 3322 2c5c 6e20 270a 2020   = "G43",\n '.  
+0003a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a510: 2020 2b20 2720 2020 2020 2020 2020 7965    + '         ye
+0003a520: 6172 203d 2022 3230 3136 222c 5c6e 2020  ar = "2016",\n  
+0003a530: 2020 2020 2020 2070 6167 6573 203d 2027         pages = '
+0003a540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a550: 2020 2020 202b 2027 2230 3333 3030 3122       + '"033001"
+0003a560: 2c5c 6e20 2020 2020 2020 2065 7072 696e  ,\n        eprin
+0003a570: 7420 3d20 270a 2020 2020 2020 2020 2020  t = '.          
+0003a580: 2020 2020 2020 2020 2020 2b20 2722 3135            + '"15
+0003a590: 3037 2e30 3832 3034 222c 5c6e 2020 2020  07.08204",\n    
+0003a5a0: 2020 2020 2020 2064 6f69 203d 2027 0a20         doi = '. 
+0003a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a5c0: 2020 202b 2027 2231 302e 3130 3838 2f30     + '"10.1088/0
+0003a5d0: 3935 342d 3338 3939 2f34 332f 332f 3033  954-3899/43/3/03
+0003a5e0: 3330 3031 222c 5c6e 7d27 2c0a 2020 2020  3001",\n}',.    
+0003a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a600: 2266 6972 7374 6461 7465 223a 2022 3230  "firstdate": "20
+0003a610: 3135 2d30 372d 3239 222c 0a20 2020 2020  15-07-29",.     
+0003a620: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003a630: 7075 6264 6174 6522 3a20 2232 3031 362d  pubdate": "2016-
+0003a640: 3031 2d31 3322 2c0a 2020 2020 2020 2020  01-13",.        
+0003a650: 2020 2020 2020 2020 2020 2020 2265 7870              "exp
+0003a660: 5f70 6170 6572 223a 2030 2c0a 2020 2020  _paper": 0,.    
+0003a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a680: 226c 6563 7475 7265 223a 2030 2c0a 2020  "lecture": 0,.  
+0003a690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a6a0: 2020 2270 6864 5f74 6865 7369 7322 3a20    "phd_thesis": 
+0003a6b0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+0003a6c0: 2020 2020 2020 2022 7265 7669 6577 223a         "review":
+0003a6d0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+0003a6e0: 2020 2020 2020 2020 2270 726f 6365 6564          "proceed
+0003a6f0: 696e 6722 3a20 302c 0a20 2020 2020 2020  ing": 0,.       
+0003a700: 2020 2020 2020 2020 2020 2020 2022 626f               "bo
+0003a710: 6f6b 223a 2030 2c0a 2020 2020 2020 2020  ok": 0,.        
+0003a720: 2020 2020 2020 2020 2020 2020 226e 6f55              "noU
+0003a730: 7064 6174 6522 3a20 302c 0a20 2020 2020  pdate": 0,.     
+0003a740: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003a750: 6d61 726b 7322 3a20 2222 2c0a 2020 2020  marks": "",.    
+0003a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a770: 2261 6273 7472 6163 7422 3a20 4e6f 6e65  "abstract": None
+0003a780: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003a790: 2020 2020 2020 2262 6962 7465 7844 6963        "bibtexDic
+0003a7a0: 7422 3a20 7b0a 2020 2020 2020 2020 2020  t": {.          
+0003a7b0: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+0003a7c0: 7072 696e 7422 3a20 2231 3530 372e 3038  print": "1507.08
+0003a7d0: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
+0003a7e0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0003a7f0: 7574 686f 7222 3a20 2253 2e20 4761 7269  uthor": "S. Gari
+0003a800: 617a 7a6f 2065 7420 616c 222c 0a20 2020  azzo et al",.   
+0003a810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a820: 2020 2020 2022 646f 6922 3a20 2231 302e       "doi": "10.
+0003a830: 3130 3838 2f30 3935 342d 3338 3939 2f34  1088/0954-3899/4
+0003a840: 332f 332f 3033 3330 3031 222c 0a20 2020  3/3/033001",.   
+0003a850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a860: 2020 2020 2022 7061 6765 7322 3a20 2230       "pages": "0
+0003a870: 3333 3030 3122 2c0a 2020 2020 2020 2020  33001",.        
+0003a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a890: 2274 6974 6c65 223a 2022 7b4c 6967 6874  "title": "{Light
+0003a8a0: 2073 7465 7269 6c65 206e 6575 7472 696e   sterile neutrin
+0003a8b0: 6f73 7d22 2c0a 2020 2020 2020 2020 2020  os}",.          
+0003a8c0: 2020 2020 2020 2020 2020 2020 2020 2279                "y
+0003a8d0: 6561 7222 3a20 2232 3031 3622 2c0a 2020  ear": "2016",.  
+0003a8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a8f0: 2020 2020 2020 2276 6f6c 756d 6522 3a20        "volume": 
+0003a900: 2247 3433 222c 0a20 2020 2020 2020 2020  "G43",.         
+0003a910: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003a920: 6a6f 7572 6e61 6c22 3a20 224a 2e50 6879  journal": "J.Phy
+0003a930: 732e 222c 0a20 2020 2020 2020 2020 2020  s.",.           
+0003a940: 2020 2020 2020 2020 2020 2020 2022 454e               "EN
+0003a950: 5452 5954 5950 4522 3a20 2261 7274 6963  TRYTYPE": "artic
+0003a960: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0003a970: 2020 2020 2020 2020 2020 2020 2022 4944               "ID
+0003a980: 223a 2022 4761 7269 617a 7a6f 3a32 3031  ": "Gariazzo:201
+0003a990: 3572 7261 222c 0a20 2020 2020 2020 2020  5rra",.         
+0003a9a0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+0003a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a9c0: 2020 2274 6974 6c65 223a 2022 7b4c 6967    "title": "{Lig
+0003a9d0: 6874 2073 7465 7269 6c65 206e 6575 7472  ht sterile neutr
+0003a9e0: 696e 6f73 7d22 2c0a 2020 2020 2020 2020  inos}",.        
+0003a9f0: 2020 2020 2020 2020 2020 2020 226a 6f75              "jou
+0003aa00: 726e 616c 223a 2022 4a2e 5068 7973 2e22  rnal": "J.Phys."
+0003aa10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003aa20: 2020 2020 2020 2276 6f6c 756d 6522 3a20        "volume": 
+0003aa30: 2247 3433 222c 0a20 2020 2020 2020 2020  "G43",.         
+0003aa40: 2020 2020 2020 2020 2020 2022 6e75 6d62             "numb
+0003aa50: 6572 223a 2022 222c 0a20 2020 2020 2020  er": "",.       
+0003aa60: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
+0003aa70: 6765 7322 3a20 2230 3333 3030 3122 2c0a  ges": "033001",.
+0003aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aa90: 2020 2020 2270 7562 6c69 7368 6564 223a      "published":
+0003aaa0: 2022 4a2e 5068 7973 2e20 4734 3320 2832   "J.Phys. G43 (2
+0003aab0: 3031 3629 2030 3333 3030 3122 2c0a 2020  016) 033001",.  
+0003aac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aad0: 2020 2261 7574 686f 7222 3a20 2253 2e20    "author": "S. 
+0003aae0: 4761 7269 617a 7a6f 2065 7420 616c 222c  Gariazzo et al",
+0003aaf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ab00: 2020 2020 2022 6269 6264 6963 7422 3a20       "bibdict": 
+0003ab10: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0003ab20: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
+0003ab30: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
+0003ab40: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
+0003ab50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ab60: 2020 2020 2020 2020 2020 226a 6f75 726e            "journ
+0003ab70: 616c 223a 2022 4a2e 5068 7973 2e22 2c0a  al": "J.Phys.",.
+0003ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ab90: 2020 2020 2020 2020 2265 7072 696e 7422          "eprint"
+0003aba0: 3a20 2231 3530 372e 3038 3230 3422 2c0a  : "1507.08204",.
 0003abb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003abc0: 226a 6f75 726e 616c 223a 2022 4a2e 5068  "journal": "J.Ph
-0003abd0: 7973 2e22 2c0a 2020 2020 2020 2020 2020  ys.",.          
-0003abe0: 2020 2020 2020 2020 2020 2020 2020 2265                "e
-0003abf0: 7072 696e 7422 3a20 2231 3530 372e 3038  print": "1507.08
-0003ac00: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
-0003ac10: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-0003ac20: 7574 686f 7222 3a20 2253 2e20 4761 7269  uthor": "S. Gari
-0003ac30: 617a 7a6f 2065 7420 616c 222c 0a20 2020  azzo et al",.   
-0003ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ac50: 2020 2020 2022 7469 746c 6522 3a20 227b       "title": "{
-0003ac60: 4c69 6768 7420 7374 6572 696c 6520 6e65  Light sterile ne
-0003ac70: 7574 7269 6e6f 737d 222c 0a20 2020 2020  utrinos}",.     
+0003abc0: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
+0003abd0: 3a20 2253 2e20 4761 7269 617a 7a6f 2065  : "S. Gariazzo e
+0003abe0: 7420 616c 222c 0a20 2020 2020 2020 2020  t al",.         
+0003abf0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003ac00: 7469 746c 6522 3a20 227b 4c69 6768 7420  title": "{Light 
+0003ac10: 7374 6572 696c 6520 6e65 7574 7269 6e6f  sterile neutrino
+0003ac20: 737d 222c 0a20 2020 2020 2020 2020 2020  s}",.           
+0003ac30: 2020 2020 2020 2020 2020 2020 2022 454e               "EN
+0003ac40: 5452 5954 5950 4522 3a20 2261 7274 6963  TRYTYPE": "artic
+0003ac50: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0003ac60: 2020 2020 2020 2020 2020 2020 2022 766f               "vo
+0003ac70: 6c75 6d65 223a 2022 4734 3322 2c0a 2020  lume": "G43",.  
 0003ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ac90: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-0003aca0: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-0003acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003acc0: 2020 2022 766f 6c75 6d65 223a 2022 4734     "volume": "G4
-0003acd0: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-0003ace0: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
-0003acf0: 7222 3a20 2232 3031 3622 2c0a 2020 2020  r": "2016",.    
-0003ad00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ad10: 2020 2020 2249 4422 3a20 2247 6172 6961      "ID": "Garia
-0003ad20: 7a7a 6f3a 3230 3135 7272 6122 2c0a 2020  zzo:2015rra",.  
-0003ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ad40: 2020 2020 2020 2270 6167 6573 223a 2022        "pages": "
-0003ad50: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
-0003ad60: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-0003ad70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ad80: 7d2c 0a20 2020 2020 2020 2020 2020 2029  },.            )
-0003ad90: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-0003ada0: 4442 2e75 6e64 6f28 7665 7262 6f73 653d  DB.undo(verbose=
-0003adb0: 3029 0a20 2020 2020 2020 2073 656c 662e  0).        self.
-0003adc0: 7042 4442 2e62 6962 732e 696e 7365 7274  pBDB.bibs.insert
-0003add0: 4672 6f6d 4269 6274 6578 280a 2020 2020  FromBibtex(.    
-0003ade0: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
-0003adf0: 657b 4761 7269 617a 7a6f 3a32 3031 3572  e{Gariazzo:2015r
-0003ae00: 7261 2c5c 6e61 7278 6976 3d22 3135 3037  ra,\narxiv="1507
-0003ae10: 2e30 3832 3034 225c 6e7d 270a 2020 2020  .08204"\n}'.    
-0003ae20: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0003ae30: 6c66 2e70 4244 422e 6269 6273 2e69 6e73  lf.pBDB.bibs.ins
-0003ae40: 6572 7446 726f 6d42 6962 7465 7828 2740  ertFromBibtex('@
-0003ae50: 6172 7469 636c 657b 4164 653a 3230 3133  article{Ade:2013
-0003ae60: 7a75 762c 5c6e 6172 7869 763d 2231 3330  zuv,\narxiv="130
-0003ae70: 332e 3530 3736 225c 6e7d 2729 0a20 2020  3.5076"\n}').   
-0003ae80: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-0003ae90: 6962 732e 7365 744e 6f55 7064 6174 6528  ibs.setNoUpdate(
-0003aea0: 2241 6465 3a32 3031 337a 7576 2229 0a20  "Ade:2013zuv"). 
-0003aeb0: 2020 2020 2020 2064 3120 3d20 2232 3031         d1 = "201
-0003aec0: 382d 3031 2d30 3122 0a20 2020 2020 2020  8-01-01".       
-0003aed0: 2064 3220 3d20 2232 3031 382d 3031 2d30   d2 = "2018-01-0
-0003aee0: 3222 0a20 2020 2020 2020 2072 6573 203d  2".        res =
-0003aef0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0003af00: 6765 7442 7942 6962 6b65 7928 2241 6465  getByBibkey("Ade
-0003af10: 3a32 3031 337a 7576 2229 5b30 5d0a 2020  :2013zuv")[0].  
-0003af20: 2020 2020 2020 6465 6c20 7265 735b 2263        del res["c
-0003af30: 6974 6174 696f 6e73 225d 0a20 2020 2020  itations"].     
-0003af40: 2020 2064 656c 2072 6573 5b22 6369 7461     del res["cita
-0003af50: 7469 6f6e 735f 6e6f 5f73 656c 6622 5d0a  tions_no_self"].
-0003af60: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0003af70: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0003af80: 2020 2020 2020 7265 732c 0a20 2020 2020        res,.     
-0003af90: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-0003afa0: 2020 2020 2020 2020 2022 6269 626b 6579           "bibkey
-0003afb0: 223a 2022 4164 653a 3230 3133 7a75 7622  ": "Ade:2013zuv"
-0003afc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003afd0: 2020 2269 6e73 7069 7265 223a 204e 6f6e    "inspire": Non
-0003afe0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0003aff0: 2020 2022 6172 7869 7622 3a20 2231 3330     "arxiv": "130
-0003b000: 332e 3530 3736 222c 0a20 2020 2020 2020  3.5076",.       
-0003b010: 2020 2020 2020 2020 2022 6164 7322 3a20           "ads": 
-0003b020: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0003b030: 2020 2020 2020 2273 6368 6f6c 6172 223a        "scholar":
-0003b040: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0003b050: 2020 2020 2020 2022 646f 6922 3a20 4e6f         "doi": No
-0003b060: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0003b070: 2020 2020 2269 7362 6e22 3a20 4e6f 6e65      "isbn": None
-0003b080: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003b090: 2020 2279 6561 7222 3a20 3230 3133 2c0a    "year": 2013,.
-0003b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b0b0: 226c 696e 6b22 3a20 2225 732f 6162 732f  "link": "%s/abs/
-0003b0c0: 3133 3033 2e35 3037 3622 2025 2070 6243  1303.5076" % pbC
-0003b0d0: 6f6e 6669 672e 6172 7869 7655 726c 2c0a  onfig.arxivUrl,.
-0003b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b0f0: 2263 6f6d 6d65 6e74 7322 3a20 4e6f 6e65  "comments": None
-0003b100: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003b110: 2020 226f 6c64 5f6b 6579 7322 3a20 4e6f    "old_keys": No
-0003b120: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0003b130: 2020 2020 2263 726f 7373 7265 6622 3a20      "crossref": 
-0003b140: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0003b150: 2020 2020 2020 2262 6962 7465 7822 3a20        "bibtex": 
-0003b160: 2240 4172 7469 636c 657b 4164 653a 3230  "@Article{Ade:20
-0003b170: 3133 7a75 762c 5c6e 2020 2020 2020 2020  13zuv,\n        
-0003b180: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0003b190: 2020 202b 2027 6172 7869 7620 3d20 2231     + 'arxiv = "1
-0003b1a0: 3330 332e 3530 3736 222c 5c6e 7d27 2c0a  303.5076",\n}',.
-0003b1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b1c0: 2266 6972 7374 6461 7465 223a 2064 3274  "firstdate": d2t
-0003b1d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003b1e0: 2020 2270 7562 6461 7465 223a 2022 222c    "pubdate": "",
-0003b1f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b200: 2022 6578 705f 7061 7065 7222 3a20 302c   "exp_paper": 0,
-0003b210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b220: 2022 6c65 6374 7572 6522 3a20 302c 0a20   "lecture": 0,. 
-0003b230: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003b240: 7068 645f 7468 6573 6973 223a 2030 2c0a  phd_thesis": 0,.
-0003b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b260: 2272 6576 6965 7722 3a20 302c 0a20 2020  "review": 0,.   
-0003b270: 2020 2020 2020 2020 2020 2020 2022 7072               "pr
-0003b280: 6f63 6565 6469 6e67 223a 2030 2c0a 2020  oceeding": 0,.  
-0003b290: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-0003b2a0: 6f6f 6b22 3a20 302c 0a20 2020 2020 2020  ook": 0,.       
-0003b2b0: 2020 2020 2020 2020 2022 6e6f 5570 6461           "noUpda
-0003b2c0: 7465 223a 2031 2c0a 2020 2020 2020 2020  te": 1,.        
-0003b2d0: 2020 2020 2020 2020 226d 6172 6b73 223a          "marks":
-0003b2e0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0003b2f0: 2020 2020 2022 6162 7374 7261 6374 223a       "abstract":
-0003b300: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0003b310: 2020 2020 2020 2022 6269 6274 6578 4469         "bibtexDi
-0003b320: 6374 223a 207b 0a20 2020 2020 2020 2020  ct": {.         
-0003b330: 2020 2020 2020 2020 2020 2022 6172 7869             "arxi
-0003b340: 7622 3a20 2231 3330 332e 3530 3736 222c  v": "1303.5076",
-0003b350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b360: 2020 2020 2022 454e 5452 5954 5950 4522       "ENTRYTYPE"
-0003b370: 3a20 2261 7274 6963 6c65 222c 0a20 2020  : "article",.   
+0003ac90: 2020 2020 2020 2279 6561 7222 3a20 2232        "year": "2
+0003aca0: 3031 3622 2c0a 2020 2020 2020 2020 2020  016",.          
+0003acb0: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+0003acc0: 4422 3a20 2247 6172 6961 7a7a 6f3a 3230  D": "Gariazzo:20
+0003acd0: 3135 7272 6122 2c0a 2020 2020 2020 2020  15rra",.        
+0003ace0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003acf0: 2270 6167 6573 223a 2022 3033 3330 3031  "pages": "033001
+0003ad00: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003ad10: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+0003ad20: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+0003ad30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0003ad40: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
+0003ad50: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
+0003ad60: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0003ad70: 6962 732e 696e 7365 7274 4672 6f6d 4269  ibs.insertFromBi
+0003ad80: 6274 6578 280a 2020 2020 2020 2020 2020  btex(.          
+0003ad90: 2020 2740 6172 7469 636c 657b 4761 7269    '@article{Gari
+0003ada0: 617a 7a6f 3a32 3031 3572 7261 2c5c 6e61  azzo:2015rra,\na
+0003adb0: 7278 6976 3d22 3135 3037 2e30 3832 3034  rxiv="1507.08204
+0003adc0: 225c 6e7d 270a 2020 2020 2020 2020 290a  "\n}'.        ).
+0003add0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0003ade0: 422e 6269 6273 2e69 6e73 6572 7446 726f  B.bibs.insertFro
+0003adf0: 6d42 6962 7465 7828 2740 6172 7469 636c  mBibtex('@articl
+0003ae00: 657b 4164 653a 3230 3133 7a75 762c 5c6e  e{Ade:2013zuv,\n
+0003ae10: 6172 7869 763d 2231 3330 332e 3530 3736  arxiv="1303.5076
+0003ae20: 225c 6e7d 2729 0a20 2020 2020 2020 2073  "\n}').        s
+0003ae30: 656c 662e 7042 4442 2e62 6962 732e 7365  elf.pBDB.bibs.se
+0003ae40: 744e 6f55 7064 6174 6528 2241 6465 3a32  tNoUpdate("Ade:2
+0003ae50: 3031 337a 7576 2229 0a20 2020 2020 2020  013zuv").       
+0003ae60: 2064 3120 3d20 2232 3031 382d 3031 2d30   d1 = "2018-01-0
+0003ae70: 3122 0a20 2020 2020 2020 2064 3220 3d20  1".        d2 = 
+0003ae80: 2232 3031 382d 3031 2d30 3222 0a20 2020  "2018-01-02".   
+0003ae90: 2020 2020 2072 6573 203d 2073 656c 662e       res = self.
+0003aea0: 7042 4442 2e62 6962 732e 6765 7442 7942  pBDB.bibs.getByB
+0003aeb0: 6962 6b65 7928 2241 6465 3a32 3031 337a  ibkey("Ade:2013z
+0003aec0: 7576 2229 5b30 5d0a 2020 2020 2020 2020  uv")[0].        
+0003aed0: 6465 6c20 7265 735b 2263 6974 6174 696f  del res["citatio
+0003aee0: 6e73 225d 0a20 2020 2020 2020 2064 656c  ns"].        del
+0003aef0: 2072 6573 5b22 6369 7461 7469 6f6e 735f   res["citations_
+0003af00: 6e6f 5f73 656c 6622 5d0a 2020 2020 2020  no_self"].      
+0003af10: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0003af20: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0003af30: 7265 732c 0a20 2020 2020 2020 2020 2020  res,.           
+0003af40: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0003af50: 2020 2022 6269 626b 6579 223a 2022 4164     "bibkey": "Ad
+0003af60: 653a 3230 3133 7a75 7622 2c0a 2020 2020  e:2013zuv",.    
+0003af70: 2020 2020 2020 2020 2020 2020 2269 6e73              "ins
+0003af80: 7069 7265 223a 204e 6f6e 652c 0a20 2020  pire": None,.   
+0003af90: 2020 2020 2020 2020 2020 2020 2022 6172               "ar
+0003afa0: 7869 7622 3a20 2231 3330 332e 3530 3736  xiv": "1303.5076
+0003afb0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003afc0: 2020 2022 6164 7322 3a20 4e6f 6e65 2c0a     "ads": None,.
+0003afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003afe0: 2273 6368 6f6c 6172 223a 204e 6f6e 652c  "scholar": None,
+0003aff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b000: 2022 646f 6922 3a20 4e6f 6e65 2c0a 2020   "doi": None,.  
+0003b010: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+0003b020: 7362 6e22 3a20 4e6f 6e65 2c0a 2020 2020  sbn": None,.    
+0003b030: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
+0003b040: 7222 3a20 3230 3133 2c0a 2020 2020 2020  r": 2013,.      
+0003b050: 2020 2020 2020 2020 2020 226c 696e 6b22            "link"
+0003b060: 3a20 2225 732f 6162 732f 3133 3033 2e35  : "%s/abs/1303.5
+0003b070: 3037 3622 2025 2070 6243 6f6e 6669 672e  076" % pbConfig.
+0003b080: 6172 7869 7655 726c 2c0a 2020 2020 2020  arxivUrl,.      
+0003b090: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
+0003b0a0: 6e74 7322 3a20 4e6f 6e65 2c0a 2020 2020  nts": None,.    
+0003b0b0: 2020 2020 2020 2020 2020 2020 226f 6c64              "old
+0003b0c0: 5f6b 6579 7322 3a20 4e6f 6e65 2c0a 2020  _keys": None,.  
+0003b0d0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+0003b0e0: 726f 7373 7265 6622 3a20 4e6f 6e65 2c0a  rossref": None,.
+0003b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b100: 2262 6962 7465 7822 3a20 2240 4172 7469  "bibtex": "@Arti
+0003b110: 636c 657b 4164 653a 3230 3133 7a75 762c  cle{Ade:2013zuv,
+0003b120: 5c6e 2020 2020 2020 2020 2022 0a20 2020  \n         ".   
+0003b130: 2020 2020 2020 2020 2020 2020 202b 2027               + '
+0003b140: 6172 7869 7620 3d20 2231 3330 332e 3530  arxiv = "1303.50
+0003b150: 3736 222c 5c6e 7d27 2c0a 2020 2020 2020  76",\n}',.      
+0003b160: 2020 2020 2020 2020 2020 2266 6972 7374            "first
+0003b170: 6461 7465 223a 2064 3274 2c0a 2020 2020  date": d2t,.    
+0003b180: 2020 2020 2020 2020 2020 2020 2270 7562              "pub
+0003b190: 6461 7465 223a 2022 222c 0a20 2020 2020  date": "",.     
+0003b1a0: 2020 2020 2020 2020 2020 2022 6578 705f             "exp_
+0003b1b0: 7061 7065 7222 3a20 302c 0a20 2020 2020  paper": 0,.     
+0003b1c0: 2020 2020 2020 2020 2020 2022 6c65 6374             "lect
+0003b1d0: 7572 6522 3a20 302c 0a20 2020 2020 2020  ure": 0,.       
+0003b1e0: 2020 2020 2020 2020 2022 7068 645f 7468           "phd_th
+0003b1f0: 6573 6973 223a 2030 2c0a 2020 2020 2020  esis": 0,.      
+0003b200: 2020 2020 2020 2020 2020 2272 6576 6965            "revie
+0003b210: 7722 3a20 302c 0a20 2020 2020 2020 2020  w": 0,.         
+0003b220: 2020 2020 2020 2022 7072 6f63 6565 6469         "proceedi
+0003b230: 6e67 223a 2030 2c0a 2020 2020 2020 2020  ng": 0,.        
+0003b240: 2020 2020 2020 2020 2262 6f6f 6b22 3a20          "book": 
+0003b250: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+0003b260: 2020 2022 6e6f 5570 6461 7465 223a 2031     "noUpdate": 1
+0003b270: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003b280: 2020 226d 6172 6b73 223a 2022 222c 0a20    "marks": "",. 
+0003b290: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003b2a0: 6162 7374 7261 6374 223a 204e 6f6e 652c  abstract": None,
+0003b2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b2c0: 2022 6269 6274 6578 4469 6374 223a 207b   "bibtexDict": {
+0003b2d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b2e0: 2020 2020 2022 6172 7869 7622 3a20 2231       "arxiv": "1
+0003b2f0: 3330 332e 3530 3736 222c 0a20 2020 2020  303.5076",.     
+0003b300: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003b310: 454e 5452 5954 5950 4522 3a20 2261 7274  ENTRYTYPE": "art
+0003b320: 6963 6c65 222c 0a20 2020 2020 2020 2020  icle",.         
+0003b330: 2020 2020 2020 2020 2020 2022 4944 223a             "ID":
+0003b340: 2022 4164 653a 3230 3133 7a75 7622 2c0a   "Ade:2013zuv",.
+0003b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b360: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+0003b370: 2020 2022 7469 746c 6522 3a20 2222 2c0a     "title": "",.
 0003b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b390: 2022 4944 223a 2022 4164 653a 3230 3133   "ID": "Ade:2013
-0003b3a0: 7a75 7622 2c0a 2020 2020 2020 2020 2020  zuv",.          
-0003b3b0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-0003b3c0: 2020 2020 2020 2020 2022 7469 746c 6522           "title"
-0003b3d0: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
-0003b3e0: 2020 2020 2020 226a 6f75 726e 616c 223a        "journal":
-0003b3f0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0003b400: 2020 2020 2022 766f 6c75 6d65 223a 2022       "volume": "
-0003b410: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0003b420: 2020 2022 6e75 6d62 6572 223a 2022 222c     "number": "",
-0003b430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b440: 2022 7061 6765 7322 3a20 2222 2c0a 2020   "pages": "",.  
-0003b450: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-0003b460: 7562 6c69 7368 6564 223a 2022 222c 0a20  ublished": "",. 
-0003b470: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003b480: 6175 7468 6f72 223a 2022 222c 0a20 2020  author": "",.   
-0003b490: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
-0003b4a0: 6264 6963 7422 3a20 7b0a 2020 2020 2020  bdict": {.      
-0003b4b0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-0003b4c0: 7278 6976 223a 2022 3133 3033 2e35 3037  rxiv": "1303.507
-0003b4d0: 3622 2c0a 2020 2020 2020 2020 2020 2020  6",.            
-0003b4e0: 2020 2020 2020 2020 2245 4e54 5259 5459          "ENTRYTY
-0003b4f0: 5045 223a 2022 6172 7469 636c 6522 2c0a  PE": "article",.
-0003b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b510: 2020 2020 2249 4422 3a20 2241 6465 3a32      "ID": "Ade:2
-0003b520: 3031 337a 7576 222c 0a20 2020 2020 2020  013zuv",.       
-0003b530: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-0003b540: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0003b550: 2020 2029 0a20 2020 2020 2020 2072 6573     ).        res
-0003b560: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
-0003b570: 732e 6765 7442 7942 6962 6b65 7928 2247  s.getByBibkey("G
-0003b580: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
-0003b590: 295b 305d 0a20 2020 2020 2020 2064 656c  )[0].        del
-0003b5a0: 2072 6573 5b22 6369 7461 7469 6f6e 7322   res["citations"
-0003b5b0: 5d0a 2020 2020 2020 2020 6465 6c20 7265  ].        del re
-0003b5c0: 735b 2263 6974 6174 696f 6e73 5f6e 6f5f  s["citations_no_
-0003b5d0: 7365 6c66 225d 0a20 2020 2020 2020 2073  self"].        s
-0003b5e0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0003b5f0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0003b600: 2c0a 2020 2020 2020 2020 2020 2020 7b0a  ,.            {.
-0003b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b620: 2262 6962 6b65 7922 3a20 2247 6172 6961  "bibkey": "Garia
-0003b630: 7a7a 6f3a 3230 3135 7272 6122 2c0a 2020  zzo:2015rra",.  
-0003b640: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-0003b650: 6e73 7069 7265 223a 204e 6f6e 652c 0a20  nspire": None,. 
-0003b660: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003b670: 6172 7869 7622 3a20 2231 3530 372e 3038  arxiv": "1507.08
-0003b680: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
-0003b690: 2020 2020 2020 2261 6473 223a 204e 6f6e        "ads": Non
-0003b6a0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0003b6b0: 2020 2022 7363 686f 6c61 7222 3a20 4e6f     "scholar": No
-0003b6c0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0003b6d0: 2020 2020 2264 6f69 223a 204e 6f6e 652c      "doi": None,
-0003b6e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b6f0: 2022 6973 626e 223a 204e 6f6e 652c 0a20   "isbn": None,. 
-0003b700: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003b710: 7965 6172 223a 2032 3031 352c 0a20 2020  year": 2015,.   
-0003b720: 2020 2020 2020 2020 2020 2020 2022 6c69               "li
-0003b730: 6e6b 223a 2022 2573 2f61 6273 2f31 3530  nk": "%s/abs/150
-0003b740: 372e 3038 3230 3422 2025 2070 6243 6f6e  7.08204" % pbCon
-0003b750: 6669 672e 6172 7869 7655 726c 2c0a 2020  fig.arxivUrl,.  
-0003b760: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-0003b770: 6f6d 6d65 6e74 7322 3a20 4e6f 6e65 2c0a  omments": None,.
-0003b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b790: 226f 6c64 5f6b 6579 7322 3a20 4e6f 6e65  "old_keys": None
-0003b7a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003b7b0: 2020 2263 726f 7373 7265 6622 3a20 4e6f    "crossref": No
-0003b7c0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0003b7d0: 2020 2020 2262 6962 7465 7822 3a20 2240      "bibtex": "@
-0003b7e0: 4172 7469 636c 657b 4761 7269 617a 7a6f  Article{Gariazzo
-0003b7f0: 3a32 3031 3572 7261 2c5c 6e20 2020 2020  :2015rra,\n     
-0003b800: 2020 2020 220a 2020 2020 2020 2020 2020      ".          
-0003b810: 2020 2020 2020 2b20 2761 7278 6976 203d        + 'arxiv =
-0003b820: 2022 3135 3037 2e30 3832 3034 222c 5c6e   "1507.08204",\n
-0003b830: 7d27 2c0a 2020 2020 2020 2020 2020 2020  }',.            
-0003b840: 2020 2020 2266 6972 7374 6461 7465 223a      "firstdate":
-0003b850: 2064 3274 2c0a 2020 2020 2020 2020 2020   d2t,.          
-0003b860: 2020 2020 2020 2270 7562 6461 7465 223a        "pubdate":
-0003b870: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0003b880: 2020 2020 2022 6578 705f 7061 7065 7222       "exp_paper"
-0003b890: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
-0003b8a0: 2020 2020 2022 6c65 6374 7572 6522 3a20       "lecture": 
-0003b8b0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-0003b8c0: 2020 2022 7068 645f 7468 6573 6973 223a     "phd_thesis":
-0003b8d0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-0003b8e0: 2020 2020 2272 6576 6965 7722 3a20 302c      "review": 0,
-0003b8f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b900: 2022 7072 6f63 6565 6469 6e67 223a 2030   "proceeding": 0
-0003b910: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003b920: 2020 2262 6f6f 6b22 3a20 302c 0a20 2020    "book": 0,.   
-0003b930: 2020 2020 2020 2020 2020 2020 2022 6e6f               "no
-0003b940: 5570 6461 7465 223a 2030 2c0a 2020 2020  Update": 0,.    
-0003b950: 2020 2020 2020 2020 2020 2020 226d 6172              "mar
-0003b960: 6b73 223a 2022 222c 0a20 2020 2020 2020  ks": "",.       
-0003b970: 2020 2020 2020 2020 2022 6162 7374 7261           "abstra
-0003b980: 6374 223a 204e 6f6e 652c 0a20 2020 2020  ct": None,.     
-0003b990: 2020 2020 2020 2020 2020 2022 6269 6274             "bibt
-0003b9a0: 6578 4469 6374 223a 207b 0a20 2020 2020  exDict": {.     
-0003b9b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003b9c0: 6172 7869 7622 3a20 2231 3530 372e 3038  arxiv": "1507.08
-0003b9d0: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
-0003b9e0: 2020 2020 2020 2020 2020 2245 4e54 5259            "ENTRY
-0003b9f0: 5459 5045 223a 2022 6172 7469 636c 6522  TYPE": "article"
-0003ba00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003ba10: 2020 2020 2020 2249 4422 3a20 2247 6172        "ID": "Gar
-0003ba20: 6961 7a7a 6f3a 3230 3135 7272 6122 2c0a  iazzo:2015rra",.
-0003ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ba40: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0003ba50: 2020 2022 7469 746c 6522 3a20 2222 2c0a     "title": "",.
-0003ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ba70: 226a 6f75 726e 616c 223a 2022 222c 0a20  "journal": "",. 
-0003ba80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003ba90: 766f 6c75 6d65 223a 2022 222c 0a20 2020  volume": "",.   
-0003baa0: 2020 2020 2020 2020 2020 2020 2022 6e75               "nu
-0003bab0: 6d62 6572 223a 2022 222c 0a20 2020 2020  mber": "",.     
-0003bac0: 2020 2020 2020 2020 2020 2022 7061 6765             "page
-0003bad0: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
-0003bae0: 2020 2020 2020 2020 2270 7562 6c69 7368          "publish
-0003baf0: 6564 223a 2022 222c 0a20 2020 2020 2020  ed": "",.       
-0003bb00: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
-0003bb10: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-0003bb20: 2020 2020 2020 2022 6269 6264 6963 7422         "bibdict"
-0003bb30: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
-0003bb40: 2020 2020 2020 2020 2261 7278 6976 223a          "arxiv":
-0003bb50: 2022 3135 3037 2e30 3832 3034 222c 0a20   "1507.08204",. 
-0003bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bb70: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-0003bb80: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-0003bb90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003bba0: 4944 223a 2022 4761 7269 617a 7a6f 3a32  ID": "Gariazzo:2
-0003bbb0: 3031 3572 7261 222c 0a20 2020 2020 2020  015rra",.       
-0003bbc0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-0003bbd0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0003bbe0: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
-0003bbf0: 6820 7061 7463 6828 0a20 2020 2020 2020  h patch(.       
-0003bc00: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-0003bc10: 2e77 6562 696d 706f 7274 2e69 6e73 7069  .webimport.inspi
-0003bc20: 7265 2e57 6562 5365 6172 6368 2e72 6574  re.WebSearch.ret
-0003bc30: 7269 6576 6543 756d 756c 6174 6976 6555  rieveCumulativeU
-0003bc40: 7064 6174 6573 222c 0a20 2020 2020 2020  pdates",.       
-0003bc50: 2020 2020 2073 6964 655f 6566 6665 6374       side_effect
-0003bc60: 3d5b 0a20 2020 2020 2020 2020 2020 2020  =[.             
-0003bc70: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-0003bc80: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
-0003bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bca0: 2020 2022 646f 6922 3a20 2231 302e 3130     "doi": "10.10
-0003bcb0: 3838 2f30 3935 342d 3338 3939 2f34 332f  88/0954-3899/43/
-0003bcc0: 332f 3033 3330 3031 222c 0a20 2020 2020  3/033001",.     
-0003bcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bce0: 2020 2022 6973 626e 223a 204e 6f6e 652c     "isbn": None,
-0003bcf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bd00: 2020 2020 2020 2020 2022 6164 7322 3a20           "ads": 
-0003bd10: 2232 3031 354a 5068 472e 2e2e 3433 6333  "2015JPhG...43c3
-0003bd20: 3030 3147 222c 0a20 2020 2020 2020 2020  001G",.         
-0003bd30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003bd40: 7075 6264 6174 6522 3a20 2232 3031 362d  pubdate": "2016-
-0003bd50: 3031 2d31 3322 2c0a 2020 2020 2020 2020  01-13",.        
-0003bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bd70: 2266 6972 7374 6461 7465 223a 2022 3230  "firstdate": "20
-0003bd80: 3135 2d30 372d 3239 222c 0a20 2020 2020  15-07-29",.     
-0003bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bda0: 2020 2022 6a6f 7572 6e61 6c22 3a20 224a     "journal": "J
-0003bdb0: 2e50 6879 732e 222c 0a20 2020 2020 2020  .Phys.",.       
+0003b390: 226a 6f75 726e 616c 223a 2022 222c 0a20  "journal": "",. 
+0003b3a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003b3b0: 766f 6c75 6d65 223a 2022 222c 0a20 2020  volume": "",.   
+0003b3c0: 2020 2020 2020 2020 2020 2020 2022 6e75               "nu
+0003b3d0: 6d62 6572 223a 2022 222c 0a20 2020 2020  mber": "",.     
+0003b3e0: 2020 2020 2020 2020 2020 2022 7061 6765             "page
+0003b3f0: 7322 3a20 2222 2c0a 2020 2020 2020 2020  s": "",.        
+0003b400: 2020 2020 2020 2020 2270 7562 6c69 7368          "publish
+0003b410: 6564 223a 2022 222c 0a20 2020 2020 2020  ed": "",.       
+0003b420: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
+0003b430: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+0003b440: 2020 2020 2020 2022 6269 6264 6963 7422         "bibdict"
+0003b450: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
+0003b460: 2020 2020 2020 2020 2261 7278 6976 223a          "arxiv":
+0003b470: 2022 3133 3033 2e35 3037 3622 2c0a 2020   "1303.5076",.  
+0003b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b490: 2020 2245 4e54 5259 5459 5045 223a 2022    "ENTRYTYPE": "
+0003b4a0: 6172 7469 636c 6522 2c0a 2020 2020 2020  article",.      
+0003b4b0: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+0003b4c0: 4422 3a20 2241 6465 3a32 3031 337a 7576  D": "Ade:2013zuv
+0003b4d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003b4e0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+0003b4f0: 2020 7d2c 0a20 2020 2020 2020 2029 0a20    },.        ). 
+0003b500: 2020 2020 2020 2072 6573 203d 2073 656c         res = sel
+0003b510: 662e 7042 4442 2e62 6962 732e 6765 7442  f.pBDB.bibs.getB
+0003b520: 7942 6962 6b65 7928 2247 6172 6961 7a7a  yBibkey("Gariazz
+0003b530: 6f3a 3230 3135 7272 6122 295b 305d 0a20  o:2015rra")[0]. 
+0003b540: 2020 2020 2020 2064 656c 2072 6573 5b22         del res["
+0003b550: 6369 7461 7469 6f6e 7322 5d0a 2020 2020  citations"].    
+0003b560: 2020 2020 6465 6c20 7265 735b 2263 6974      del res["cit
+0003b570: 6174 696f 6e73 5f6e 6f5f 7365 6c66 225d  ations_no_self"]
+0003b580: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0003b590: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0003b5a0: 2020 2020 2020 2072 6573 2c0a 2020 2020         res,.    
+0003b5b0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0003b5c0: 2020 2020 2020 2020 2020 2262 6962 6b65            "bibke
+0003b5d0: 7922 3a20 2247 6172 6961 7a7a 6f3a 3230  y": "Gariazzo:20
+0003b5e0: 3135 7272 6122 2c0a 2020 2020 2020 2020  15rra",.        
+0003b5f0: 2020 2020 2020 2020 2269 6e73 7069 7265          "inspire
+0003b600: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+0003b610: 2020 2020 2020 2020 2022 6172 7869 7622           "arxiv"
+0003b620: 3a20 2231 3530 372e 3038 3230 3422 2c0a  : "1507.08204",.
+0003b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b640: 2261 6473 223a 204e 6f6e 652c 0a20 2020  "ads": None,.   
+0003b650: 2020 2020 2020 2020 2020 2020 2022 7363               "sc
+0003b660: 686f 6c61 7222 3a20 4e6f 6e65 2c0a 2020  holar": None,.  
+0003b670: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+0003b680: 6f69 223a 204e 6f6e 652c 0a20 2020 2020  oi": None,.     
+0003b690: 2020 2020 2020 2020 2020 2022 6973 626e             "isbn
+0003b6a0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+0003b6b0: 2020 2020 2020 2020 2022 7965 6172 223a           "year":
+0003b6c0: 2032 3031 352c 0a20 2020 2020 2020 2020   2015,.         
+0003b6d0: 2020 2020 2020 2022 6c69 6e6b 223a 2022         "link": "
+0003b6e0: 2573 2f61 6273 2f31 3530 372e 3038 3230  %s/abs/1507.0820
+0003b6f0: 3422 2025 2070 6243 6f6e 6669 672e 6172  4" % pbConfig.ar
+0003b700: 7869 7655 726c 2c0a 2020 2020 2020 2020  xivUrl,.        
+0003b710: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
+0003b720: 7322 3a20 4e6f 6e65 2c0a 2020 2020 2020  s": None,.      
+0003b730: 2020 2020 2020 2020 2020 226f 6c64 5f6b            "old_k
+0003b740: 6579 7322 3a20 4e6f 6e65 2c0a 2020 2020  eys": None,.    
+0003b750: 2020 2020 2020 2020 2020 2020 2263 726f              "cro
+0003b760: 7373 7265 6622 3a20 4e6f 6e65 2c0a 2020  ssref": None,.  
+0003b770: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+0003b780: 6962 7465 7822 3a20 2240 4172 7469 636c  ibtex": "@Articl
+0003b790: 657b 4761 7269 617a 7a6f 3a32 3031 3572  e{Gariazzo:2015r
+0003b7a0: 7261 2c5c 6e20 2020 2020 2020 2020 220a  ra,\n         ".
+0003b7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b7c0: 2b20 2761 7278 6976 203d 2022 3135 3037  + 'arxiv = "1507
+0003b7d0: 2e30 3832 3034 222c 5c6e 7d27 2c0a 2020  .08204",\n}',.  
+0003b7e0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+0003b7f0: 6972 7374 6461 7465 223a 2064 3274 2c0a  irstdate": d2t,.
+0003b800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b810: 2270 7562 6461 7465 223a 2022 222c 0a20  "pubdate": "",. 
+0003b820: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003b830: 6578 705f 7061 7065 7222 3a20 302c 0a20  exp_paper": 0,. 
+0003b840: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003b850: 6c65 6374 7572 6522 3a20 302c 0a20 2020  lecture": 0,.   
+0003b860: 2020 2020 2020 2020 2020 2020 2022 7068               "ph
+0003b870: 645f 7468 6573 6973 223a 2030 2c0a 2020  d_thesis": 0,.  
+0003b880: 2020 2020 2020 2020 2020 2020 2020 2272                "r
+0003b890: 6576 6965 7722 3a20 302c 0a20 2020 2020  eview": 0,.     
+0003b8a0: 2020 2020 2020 2020 2020 2022 7072 6f63             "proc
+0003b8b0: 6565 6469 6e67 223a 2030 2c0a 2020 2020  eeding": 0,.    
+0003b8c0: 2020 2020 2020 2020 2020 2020 2262 6f6f              "boo
+0003b8d0: 6b22 3a20 302c 0a20 2020 2020 2020 2020  k": 0,.         
+0003b8e0: 2020 2020 2020 2022 6e6f 5570 6461 7465         "noUpdate
+0003b8f0: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
+0003b900: 2020 2020 2020 226d 6172 6b73 223a 2022        "marks": "
+0003b910: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003b920: 2020 2022 6162 7374 7261 6374 223a 204e     "abstract": N
+0003b930: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0003b940: 2020 2020 2022 6269 6274 6578 4469 6374       "bibtexDict
+0003b950: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+0003b960: 2020 2020 2020 2020 2022 6172 7869 7622           "arxiv"
+0003b970: 3a20 2231 3530 372e 3038 3230 3422 2c0a  : "1507.08204",.
+0003b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b990: 2020 2020 2245 4e54 5259 5459 5045 223a      "ENTRYTYPE":
+0003b9a0: 2022 6172 7469 636c 6522 2c0a 2020 2020   "article",.    
+0003b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b9c0: 2249 4422 3a20 2247 6172 6961 7a7a 6f3a  "ID": "Gariazzo:
+0003b9d0: 3230 3135 7272 6122 2c0a 2020 2020 2020  2015rra",.      
+0003b9e0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+0003b9f0: 2020 2020 2020 2020 2020 2020 2022 7469               "ti
+0003ba00: 746c 6522 3a20 2222 2c0a 2020 2020 2020  tle": "",.      
+0003ba10: 2020 2020 2020 2020 2020 226a 6f75 726e            "journ
+0003ba20: 616c 223a 2022 222c 0a20 2020 2020 2020  al": "",.       
+0003ba30: 2020 2020 2020 2020 2022 766f 6c75 6d65           "volume
+0003ba40: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+0003ba50: 2020 2020 2020 2022 6e75 6d62 6572 223a         "number":
+0003ba60: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+0003ba70: 2020 2020 2022 7061 6765 7322 3a20 2222       "pages": ""
+0003ba80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ba90: 2020 2270 7562 6c69 7368 6564 223a 2022    "published": "
+0003baa0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003bab0: 2020 2022 6175 7468 6f72 223a 2022 222c     "author": "",
+0003bac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003bad0: 2022 6269 6264 6963 7422 3a20 7b0a 2020   "bibdict": {.  
+0003bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003baf0: 2020 2261 7278 6976 223a 2022 3135 3037    "arxiv": "1507
+0003bb00: 2e30 3832 3034 222c 0a20 2020 2020 2020  .08204",.       
+0003bb10: 2020 2020 2020 2020 2020 2020 2022 454e               "EN
+0003bb20: 5452 5954 5950 4522 3a20 2261 7274 6963  TRYTYPE": "artic
+0003bb30: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0003bb40: 2020 2020 2020 2020 2022 4944 223a 2022           "ID": "
+0003bb50: 4761 7269 617a 7a6f 3a32 3031 3572 7261  Gariazzo:2015rra
+0003bb60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003bb70: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+0003bb80: 2020 7d2c 0a20 2020 2020 2020 2029 0a20    },.        ). 
+0003bb90: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+0003bba0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+0003bbb0: 7068 7973 6269 626c 696f 2e77 6562 696d  physbiblio.webim
+0003bbc0: 706f 7274 2e69 6e73 7069 7265 2e57 6562  port.inspire.Web
+0003bbd0: 5365 6172 6368 2e72 6574 7269 6576 6543  Search.retrieveC
+0003bbe0: 756d 756c 6174 6976 6555 7064 6174 6573  umulativeUpdates
+0003bbf0: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+0003bc00: 6964 655f 6566 6665 6374 3d5b 0a20 2020  ide_effect=[.   
+0003bc10: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+0003bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bc30: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+0003bc40: 2020 2020 2020 2020 2020 2020 2022 646f               "do
+0003bc50: 6922 3a20 2231 302e 3130 3838 2f30 3935  i": "10.1088/095
+0003bc60: 342d 3338 3939 2f34 332f 332f 3033 3330  4-3899/43/3/0330
+0003bc70: 3031 222c 0a20 2020 2020 2020 2020 2020  01",.           
+0003bc80: 2020 2020 2020 2020 2020 2020 2022 6973               "is
+0003bc90: 626e 223a 204e 6f6e 652c 0a20 2020 2020  bn": None,.     
+0003bca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bcb0: 2020 2022 6164 7322 3a20 2232 3031 354a     "ads": "2015J
+0003bcc0: 5068 472e 2e2e 3433 6333 3030 3147 222c  PhG...43c3001G",
+0003bcd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003bce0: 2020 2020 2020 2020 2022 7075 6264 6174           "pubdat
+0003bcf0: 6522 3a20 2232 3031 362d 3031 2d31 3322  e": "2016-01-13"
+0003bd00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003bd10: 2020 2020 2020 2020 2020 2266 6972 7374            "first
+0003bd20: 6461 7465 223a 2022 3230 3135 2d30 372d  date": "2015-07-
+0003bd30: 3239 222c 0a20 2020 2020 2020 2020 2020  29",.           
+0003bd40: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
+0003bd50: 7572 6e61 6c22 3a20 224a 2e50 6879 732e  urnal": "J.Phys.
+0003bd60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003bd70: 2020 2020 2020 2020 2020 2022 6172 7869             "arxi
+0003bd80: 7622 3a20 2231 3530 372e 3038 3230 3422  v": "1507.08204"
+0003bd90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003bda0: 2020 2020 2020 2020 2020 2269 6422 3a20            "id": 
+0003bdb0: 2231 3338 3535 3833 222c 0a20 2020 2020  "1385583",.     
 0003bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bdd0: 2022 6172 7869 7622 3a20 2231 3530 372e   "arxiv": "1507.
-0003bde0: 3038 3230 3422 2c0a 2020 2020 2020 2020  08204",.        
-0003bdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003be00: 2269 6422 3a20 2231 3338 3535 3833 222c  "id": "1385583",
-0003be10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003be20: 2020 2020 2020 2020 2022 766f 6c75 6d65           "volume
-0003be30: 223a 2022 4734 3322 2c0a 2020 2020 2020  ": "G43",.      
-0003be40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003be50: 2020 2262 6962 7465 7822 3a20 4e6f 6e65    "bibtex": None
-0003be60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003be70: 2020 2020 2020 2020 2020 2279 6561 7222            "year"
-0003be80: 3a20 2232 3031 3622 2c0a 2020 2020 2020  : "2016",.      
-0003be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bea0: 2020 226f 6c64 6b65 7973 223a 2022 222c    "oldkeys": "",
-0003beb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bec0: 2020 2020 2020 2020 2022 6269 626b 6579           "bibkey
-0003bed0: 223a 2022 4761 7269 617a 7a6f 3a32 3031  ": "Gariazzo:201
-0003bee0: 3572 7261 222c 0a20 2020 2020 2020 2020  5rra",.         
-0003bef0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003bf00: 7061 6765 7322 3a20 2230 3333 3030 3122  pages": "033001"
-0003bf10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003bf20: 2020 2020 2020 2020 2020 2261 7574 686f            "autho
-0003bf30: 7222 3a20 2253 2e20 4761 7269 617a 7a6f  r": "S. Gariazzo
-0003bf40: 2065 7420 616c 222c 0a20 2020 2020 2020   et al",.       
-0003bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bf60: 2022 7469 746c 6522 3a20 224c 6967 6874   "title": "Light
-0003bf70: 2073 7465 7269 6c65 206e 6575 7472 696e   sterile neutrin
-0003bf80: 6f73 222c 0a20 2020 2020 2020 2020 2020  os",.           
-0003bf90: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-0003bfa0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-0003bfb0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-0003bfc0: 2020 2020 2020 2020 6175 746f 7370 6563          autospec
-0003bfd0: 3d54 7275 652c 0a20 2020 2020 2020 2029  =True,.        )
-0003bfe0: 2061 7320 5f6d 6f63 6b2c 2070 6174 6368   as _mock, patch
-0003bff0: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-0003c000: 2e69 6e66 6f22 2920 6173 205f 693a 0a20  .info") as _i:. 
-0003c010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003c020: 7042 4442 2e62 6962 732e 6765 7444 6169  pBDB.bibs.getDai
-0003c030: 6c79 496e 666f 4672 6f6d 4f41 4928 6431  lyInfoFromOAI(d1
-0003c040: 2c20 6432 290a 2020 2020 2020 2020 2020  , d2).          
-0003c050: 2020 5f69 2e61 7373 6572 745f 616e 795f    _i.assert_any_
-0003c060: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-0003c070: 2020 2020 2020 2243 616c 6c69 6e67 2049        "Calling I
-0003c080: 4e53 5049 5245 2d48 4550 204f 4149 2068  NSPIRE-HEP OAI h
-0003c090: 6172 7665 7374 6572 2062 6574 7765 656e  arvester between
-0003c0a0: 2064 6174 6573 2025 7320 616e 6420 2573   dates %s and %s
-0003c0b0: 2220 2520 2864 312c 2064 3229 0a20 2020  " % (d1, d2).   
-0003c0c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0003c0d0: 2020 2020 2020 2072 6573 203d 2073 656c         res = sel
-0003c0e0: 662e 7042 4442 2e62 6962 732e 6765 7442  f.pBDB.bibs.getB
-0003c0f0: 7942 6962 6b65 7928 2241 6465 3a32 3031  yBibkey("Ade:201
-0003c100: 337a 7576 2229 5b30 5d0a 2020 2020 2020  3zuv")[0].      
-0003c110: 2020 2020 2020 6465 6c20 7265 735b 2263        del res["c
-0003c120: 6974 6174 696f 6e73 225d 0a20 2020 2020  itations"].     
-0003c130: 2020 2020 2020 2064 656c 2072 6573 5b22         del res["
-0003c140: 6369 7461 7469 6f6e 735f 6e6f 5f73 656c  citations_no_sel
-0003c150: 6622 5d0a 2020 2020 2020 2020 2020 2020  f"].            
-0003c160: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0003c170: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003c180: 2020 7265 732c 0a20 2020 2020 2020 2020    res,.         
-0003c190: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
-0003c1a0: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
-0003c1b0: 626b 6579 223a 2022 4164 653a 3230 3133  bkey": "Ade:2013
-0003c1c0: 7a75 7622 2c0a 2020 2020 2020 2020 2020  zuv",.          
-0003c1d0: 2020 2020 2020 2020 2020 2269 6e73 7069            "inspi
-0003c1e0: 7265 223a 204e 6f6e 652c 0a20 2020 2020  re": None,.     
-0003c1f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003c200: 6172 7869 7622 3a20 2231 3330 332e 3530  arxiv": "1303.50
-0003c210: 3736 222c 0a20 2020 2020 2020 2020 2020  76",.           
-0003c220: 2020 2020 2020 2020 2022 6164 7322 3a20           "ads": 
-0003c230: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0003c240: 2020 2020 2020 2020 2020 2273 6368 6f6c            "schol
-0003c250: 6172 223a 204e 6f6e 652c 0a20 2020 2020  ar": None,.     
-0003c260: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003c270: 646f 6922 3a20 4e6f 6e65 2c0a 2020 2020  doi": None,.    
-0003c280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c290: 2269 7362 6e22 3a20 4e6f 6e65 2c0a 2020  "isbn": None,.  
-0003c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c2b0: 2020 2279 6561 7222 3a20 3230 3133 2c0a    "year": 2013,.
-0003c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c2d0: 2020 2020 226c 696e 6b22 3a20 2225 732f      "link": "%s/
-0003c2e0: 6162 732f 3133 3033 2e35 3037 3622 2025  abs/1303.5076" %
-0003c2f0: 2070 6243 6f6e 6669 672e 6172 7869 7655   pbConfig.arxivU
-0003c300: 726c 2c0a 2020 2020 2020 2020 2020 2020  rl,.            
-0003c310: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
-0003c320: 7322 3a20 4e6f 6e65 2c0a 2020 2020 2020  s": None,.      
-0003c330: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-0003c340: 6c64 5f6b 6579 7322 3a20 4e6f 6e65 2c0a  ld_keys": None,.
-0003c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c360: 2020 2020 2263 726f 7373 7265 6622 3a20      "crossref": 
-0003c370: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0003c380: 2020 2020 2020 2020 2020 2262 6962 7465            "bibte
-0003c390: 7822 3a20 2240 4172 7469 636c 657b 4164  x": "@Article{Ad
-0003c3a0: 653a 3230 3133 7a75 762c 5c6e 2020 2020  e:2013zuv,\n    
-0003c3b0: 2020 2020 2022 0a20 2020 2020 2020 2020       ".         
-0003c3c0: 2020 2020 2020 2020 2020 202b 2027 6172             + 'ar
-0003c3d0: 7869 7620 3d20 2231 3330 332e 3530 3736  xiv = "1303.5076
-0003c3e0: 222c 5c6e 7d27 2c0a 2020 2020 2020 2020  ",\n}',.        
-0003c3f0: 2020 2020 2020 2020 2020 2020 2266 6972              "fir
-0003c400: 7374 6461 7465 223a 2064 3274 2c0a 2020  stdate": d2t,.  
-0003c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c420: 2020 2270 7562 6461 7465 223a 2022 222c    "pubdate": "",
-0003c430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c440: 2020 2020 2022 6578 705f 7061 7065 7222       "exp_paper"
-0003c450: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
-0003c460: 2020 2020 2020 2020 2022 6c65 6374 7572           "lectur
-0003c470: 6522 3a20 302c 0a20 2020 2020 2020 2020  e": 0,.         
-0003c480: 2020 2020 2020 2020 2020 2022 7068 645f             "phd_
-0003c490: 7468 6573 6973 223a 2030 2c0a 2020 2020  thesis": 0,.    
-0003c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c4b0: 2272 6576 6965 7722 3a20 302c 0a20 2020  "review": 0,.   
-0003c4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c4d0: 2022 7072 6f63 6565 6469 6e67 223a 2030   "proceeding": 0
-0003c4e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003c4f0: 2020 2020 2020 2262 6f6f 6b22 3a20 302c        "book": 0,
-0003c500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c510: 2020 2020 2022 6e6f 5570 6461 7465 223a       "noUpdate":
-0003c520: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
-0003c530: 2020 2020 2020 2020 226d 6172 6b73 223a          "marks":
-0003c540: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0003c550: 2020 2020 2020 2020 2022 6162 7374 7261           "abstra
-0003c560: 6374 223a 204e 6f6e 652c 0a20 2020 2020  ct": None,.     
+0003bdd0: 2020 2022 766f 6c75 6d65 223a 2022 4734     "volume": "G4
+0003bde0: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
+0003bdf0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
+0003be00: 7465 7822 3a20 4e6f 6e65 2c0a 2020 2020  tex": None,.    
+0003be10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003be20: 2020 2020 2279 6561 7222 3a20 2232 3031      "year": "201
+0003be30: 3622 2c0a 2020 2020 2020 2020 2020 2020  6",.            
+0003be40: 2020 2020 2020 2020 2020 2020 226f 6c64              "old
+0003be50: 6b65 7973 223a 2022 222c 0a20 2020 2020  keys": "",.     
+0003be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003be70: 2020 2022 6269 626b 6579 223a 2022 4761     "bibkey": "Ga
+0003be80: 7269 617a 7a6f 3a32 3031 3572 7261 222c  riazzo:2015rra",
+0003be90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003bea0: 2020 2020 2020 2020 2022 7061 6765 7322           "pages"
+0003beb0: 3a20 2230 3333 3030 3122 2c0a 2020 2020  : "033001",.    
+0003bec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bed0: 2020 2020 2261 7574 686f 7222 3a20 2253      "author": "S
+0003bee0: 2e20 4761 7269 617a 7a6f 2065 7420 616c  . Gariazzo et al
+0003bef0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003bf00: 2020 2020 2020 2020 2020 2022 7469 746c             "titl
+0003bf10: 6522 3a20 224c 6967 6874 2073 7465 7269  e": "Light steri
+0003bf20: 6c65 206e 6575 7472 696e 6f73 222c 0a20  le neutrinos",. 
+0003bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bf40: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+0003bf50: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+0003bf60: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+0003bf70: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
+0003bf80: 0a20 2020 2020 2020 2029 2061 7320 5f6d  .        ) as _m
+0003bf90: 6f63 6b2c 2070 6174 6368 2822 6c6f 6767  ock, patch("logg
+0003bfa0: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
+0003bfb0: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
+0003bfc0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0003bfd0: 6962 732e 6765 7444 6169 6c79 496e 666f  ibs.getDailyInfo
+0003bfe0: 4672 6f6d 4f41 4928 6431 2c20 6432 290a  FromOAI(d1, d2).
+0003bff0: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
+0003c000: 7373 6572 745f 616e 795f 6361 6c6c 280a  ssert_any_call(.
+0003c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c020: 2243 616c 6c69 6e67 2049 4e53 5049 5245  "Calling INSPIRE
+0003c030: 2d48 4550 204f 4149 2068 6172 7665 7374  -HEP OAI harvest
+0003c040: 6572 2062 6574 7765 656e 2064 6174 6573  er between dates
+0003c050: 2025 7320 616e 6420 2573 2220 2520 2864   %s and %s" % (d
+0003c060: 312c 2064 3229 0a20 2020 2020 2020 2020  1, d2).         
+0003c070: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0003c080: 2072 6573 203d 2073 656c 662e 7042 4442   res = self.pBDB
+0003c090: 2e62 6962 732e 6765 7442 7942 6962 6b65  .bibs.getByBibke
+0003c0a0: 7928 2241 6465 3a32 3031 337a 7576 2229  y("Ade:2013zuv")
+0003c0b0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+0003c0c0: 6465 6c20 7265 735b 2263 6974 6174 696f  del res["citatio
+0003c0d0: 6e73 225d 0a20 2020 2020 2020 2020 2020  ns"].           
+0003c0e0: 2064 656c 2072 6573 5b22 6369 7461 7469   del res["citati
+0003c0f0: 6f6e 735f 6e6f 5f73 656c 6622 5d0a 2020  ons_no_self"].  
+0003c100: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0003c110: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+0003c120: 2020 2020 2020 2020 2020 2020 7265 732c              res,
+0003c130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c140: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0003c150: 2020 2020 2020 2022 6269 626b 6579 223a         "bibkey":
+0003c160: 2022 4164 653a 3230 3133 7a75 7622 2c0a   "Ade:2013zuv",.
+0003c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c180: 2020 2020 2269 6e73 7069 7265 223a 204e      "inspire": N
+0003c190: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0003c1a0: 2020 2020 2020 2020 2022 6172 7869 7622           "arxiv"
+0003c1b0: 3a20 2231 3330 332e 3530 3736 222c 0a20  : "1303.5076",. 
+0003c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c1d0: 2020 2022 6164 7322 3a20 4e6f 6e65 2c0a     "ads": None,.
+0003c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c1f0: 2020 2020 2273 6368 6f6c 6172 223a 204e      "scholar": N
+0003c200: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0003c210: 2020 2020 2020 2020 2022 646f 6922 3a20           "doi": 
+0003c220: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+0003c230: 2020 2020 2020 2020 2020 2269 7362 6e22            "isbn"
+0003c240: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+0003c250: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
+0003c260: 7222 3a20 3230 3133 2c0a 2020 2020 2020  r": 2013,.      
+0003c270: 2020 2020 2020 2020 2020 2020 2020 226c                "l
+0003c280: 696e 6b22 3a20 2225 732f 6162 732f 3133  ink": "%s/abs/13
+0003c290: 3033 2e35 3037 3622 2025 2070 6243 6f6e  03.5076" % pbCon
+0003c2a0: 6669 672e 6172 7869 7655 726c 2c0a 2020  fig.arxivUrl,.  
+0003c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c2c0: 2020 2263 6f6d 6d65 6e74 7322 3a20 4e6f    "comments": No
+0003c2d0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+0003c2e0: 2020 2020 2020 2020 226f 6c64 5f6b 6579          "old_key
+0003c2f0: 7322 3a20 4e6f 6e65 2c0a 2020 2020 2020  s": None,.      
+0003c300: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+0003c310: 726f 7373 7265 6622 3a20 4e6f 6e65 2c0a  rossref": None,.
+0003c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c330: 2020 2020 2262 6962 7465 7822 3a20 2240      "bibtex": "@
+0003c340: 4172 7469 636c 657b 4164 653a 3230 3133  Article{Ade:2013
+0003c350: 7a75 762c 5c6e 2020 2020 2020 2020 2022  zuv,\n         "
+0003c360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c370: 2020 2020 202b 2027 6172 7869 7620 3d20       + 'arxiv = 
+0003c380: 2231 3330 332e 3530 3736 222c 5c6e 7d27  "1303.5076",\n}'
+0003c390: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003c3a0: 2020 2020 2020 2266 6972 7374 6461 7465        "firstdate
+0003c3b0: 223a 2064 3274 2c0a 2020 2020 2020 2020  ": d2t,.        
+0003c3c0: 2020 2020 2020 2020 2020 2020 2270 7562              "pub
+0003c3d0: 6461 7465 223a 2022 222c 0a20 2020 2020  date": "",.     
+0003c3e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003c3f0: 6578 705f 7061 7065 7222 3a20 302c 0a20  exp_paper": 0,. 
+0003c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c410: 2020 2022 6c65 6374 7572 6522 3a20 302c     "lecture": 0,
+0003c420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c430: 2020 2020 2022 7068 645f 7468 6573 6973       "phd_thesis
+0003c440: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
+0003c450: 2020 2020 2020 2020 2020 2272 6576 6965            "revie
+0003c460: 7722 3a20 302c 0a20 2020 2020 2020 2020  w": 0,.         
+0003c470: 2020 2020 2020 2020 2020 2022 7072 6f63             "proc
+0003c480: 6565 6469 6e67 223a 2030 2c0a 2020 2020  eeding": 0,.    
+0003c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c4a0: 2262 6f6f 6b22 3a20 302c 0a20 2020 2020  "book": 0,.     
+0003c4b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003c4c0: 6e6f 5570 6461 7465 223a 2031 2c0a 2020  noUpdate": 1,.  
+0003c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c4e0: 2020 226d 6172 6b73 223a 2022 222c 0a20    "marks": "",. 
+0003c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c500: 2020 2022 6162 7374 7261 6374 223a 204e     "abstract": N
+0003c510: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0003c520: 2020 2020 2020 2020 2022 6269 6274 6578           "bibtex
+0003c530: 4469 6374 223a 207b 0a20 2020 2020 2020  Dict": {.       
+0003c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c550: 2022 6172 7869 7622 3a20 2231 3330 332e   "arxiv": "1303.
+0003c560: 3530 3736 222c 0a20 2020 2020 2020 2020  5076",.         
 0003c570: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003c580: 6269 6274 6578 4469 6374 223a 207b 0a20  bibtexDict": {. 
-0003c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c5a0: 2020 2020 2020 2022 6172 7869 7622 3a20         "arxiv": 
-0003c5b0: 2231 3330 332e 3530 3736 222c 0a20 2020  "1303.5076",.   
-0003c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c5d0: 2020 2020 2022 454e 5452 5954 5950 4522       "ENTRYTYPE"
-0003c5e0: 3a20 2261 7274 6963 6c65 222c 0a20 2020  : "article",.   
-0003c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c600: 2020 2020 2022 4944 223a 2022 4164 653a       "ID": "Ade:
-0003c610: 3230 3133 7a75 7622 2c0a 2020 2020 2020  2013zuv",.      
-0003c620: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-0003c630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c640: 2020 2020 2022 7469 746c 6522 3a20 2222       "title": ""
-0003c650: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003c660: 2020 2020 2020 226a 6f75 726e 616c 223a        "journal":
-0003c670: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-0003c680: 2020 2020 2020 2020 2022 766f 6c75 6d65           "volume
-0003c690: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
-0003c6a0: 2020 2020 2020 2020 2020 2022 6e75 6d62             "numb
-0003c6b0: 6572 223a 2022 222c 0a20 2020 2020 2020  er": "",.       
-0003c6c0: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
-0003c6d0: 6765 7322 3a20 2222 2c0a 2020 2020 2020  ges": "",.      
-0003c6e0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-0003c6f0: 7562 6c69 7368 6564 223a 2022 222c 0a20  ublished": "",. 
-0003c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c710: 2020 2022 6175 7468 6f72 223a 2022 222c     "author": "",
-0003c720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c730: 2020 2020 2022 6269 6264 6963 7422 3a20       "bibdict": 
-0003c740: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0003c750: 2020 2020 2020 2020 2020 2261 7278 6976            "arxiv
-0003c760: 223a 2022 3133 3033 2e35 3037 3622 2c0a  ": "1303.5076",.
-0003c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c780: 2020 2020 2020 2020 2245 4e54 5259 5459          "ENTRYTY
-0003c790: 5045 223a 2022 6172 7469 636c 6522 2c0a  PE": "article",.
-0003c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c7b0: 2020 2020 2020 2020 2249 4422 3a20 2241          "ID": "A
-0003c7c0: 6465 3a32 3031 337a 7576 222c 0a20 2020  de:2013zuv",.   
-0003c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c7e0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0003c7f0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-0003c800: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0003c810: 2072 6573 203d 2073 656c 662e 7042 4442   res = self.pBDB
-0003c820: 2e62 6962 732e 6765 7442 7942 6962 6b65  .bibs.getByBibke
-0003c830: 7928 2247 6172 6961 7a7a 6f3a 3230 3135  y("Gariazzo:2015
-0003c840: 7272 6122 295b 305d 0a20 2020 2020 2020  rra")[0].       
-0003c850: 2020 2020 2064 656c 2072 6573 5b22 6369       del res["ci
-0003c860: 7461 7469 6f6e 7322 5d0a 2020 2020 2020  tations"].      
-0003c870: 2020 2020 2020 6465 6c20 7265 735b 2263        del res["c
-0003c880: 6974 6174 696f 6e73 5f6e 6f5f 7365 6c66  itations_no_self
-0003c890: 225d 0a20 2020 2020 2020 2020 2020 2073  "].            s
-0003c8a0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0003c8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c8c0: 2072 6573 2c0a 2020 2020 2020 2020 2020   res,.          
-0003c8d0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-0003c8e0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0003c8f0: 6b65 7922 3a20 2247 6172 6961 7a7a 6f3a  key": "Gariazzo:
-0003c900: 3230 3135 7272 6122 2c0a 2020 2020 2020  2015rra",.      
-0003c910: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-0003c920: 6e73 7069 7265 223a 2022 3133 3835 3538  nspire": "138558
-0003c930: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-0003c940: 2020 2020 2020 2020 2261 7278 6976 223a          "arxiv":
-0003c950: 2022 3135 3037 2e30 3832 3034 222c 0a20   "1507.08204",. 
+0003c580: 454e 5452 5954 5950 4522 3a20 2261 7274  ENTRYTYPE": "art
+0003c590: 6963 6c65 222c 0a20 2020 2020 2020 2020  icle",.         
+0003c5a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003c5b0: 4944 223a 2022 4164 653a 3230 3133 7a75  ID": "Ade:2013zu
+0003c5c0: 7622 2c0a 2020 2020 2020 2020 2020 2020  v",.            
+0003c5d0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+0003c5e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003c5f0: 7469 746c 6522 3a20 2222 2c0a 2020 2020  title": "",.    
+0003c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c610: 226a 6f75 726e 616c 223a 2022 222c 0a20  "journal": "",. 
+0003c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c630: 2020 2022 766f 6c75 6d65 223a 2022 222c     "volume": "",
+0003c640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c650: 2020 2020 2022 6e75 6d62 6572 223a 2022       "number": "
+0003c660: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003c670: 2020 2020 2020 2022 7061 6765 7322 3a20         "pages": 
+0003c680: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+0003c690: 2020 2020 2020 2020 2270 7562 6c69 7368          "publish
+0003c6a0: 6564 223a 2022 222c 0a20 2020 2020 2020  ed": "",.       
+0003c6b0: 2020 2020 2020 2020 2020 2020 2022 6175               "au
+0003c6c0: 7468 6f72 223a 2022 222c 0a20 2020 2020  thor": "",.     
+0003c6d0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003c6e0: 6269 6264 6963 7422 3a20 7b0a 2020 2020  bibdict": {.    
+0003c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c700: 2020 2020 2261 7278 6976 223a 2022 3133      "arxiv": "13
+0003c710: 3033 2e35 3037 3622 2c0a 2020 2020 2020  03.5076",.      
+0003c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c730: 2020 2245 4e54 5259 5459 5045 223a 2022    "ENTRYTYPE": "
+0003c740: 6172 7469 636c 6522 2c0a 2020 2020 2020  article",.      
+0003c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c760: 2020 2249 4422 3a20 2241 6465 3a32 3031    "ID": "Ade:201
+0003c770: 337a 7576 222c 0a20 2020 2020 2020 2020  3zuv",.         
+0003c780: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+0003c790: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
+0003c7a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0003c7b0: 2020 2020 2020 2020 2020 2072 6573 203d             res =
+0003c7c0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0003c7d0: 6765 7442 7942 6962 6b65 7928 2247 6172  getByBibkey("Gar
+0003c7e0: 6961 7a7a 6f3a 3230 3135 7272 6122 295b  iazzo:2015rra")[
+0003c7f0: 305d 0a20 2020 2020 2020 2020 2020 2064  0].            d
+0003c800: 656c 2072 6573 5b22 6369 7461 7469 6f6e  el res["citation
+0003c810: 7322 5d0a 2020 2020 2020 2020 2020 2020  s"].            
+0003c820: 6465 6c20 7265 735b 2263 6974 6174 696f  del res["citatio
+0003c830: 6e73 5f6e 6f5f 7365 6c66 225d 0a20 2020  ns_no_self"].   
+0003c840: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0003c850: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0003c860: 2020 2020 2020 2020 2020 2072 6573 2c0a             res,.
+0003c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c880: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0003c890: 2020 2020 2020 2262 6962 6b65 7922 3a20        "bibkey": 
+0003c8a0: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
+0003c8b0: 6122 2c0a 2020 2020 2020 2020 2020 2020  a",.            
+0003c8c0: 2020 2020 2020 2020 2269 6e73 7069 7265          "inspire
+0003c8d0: 223a 2022 3133 3835 3538 3322 2c0a 2020  ": "1385583",.  
+0003c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c8f0: 2020 2261 7278 6976 223a 2022 3135 3037    "arxiv": "1507
+0003c900: 2e30 3832 3034 222c 0a20 2020 2020 2020  .08204",.       
+0003c910: 2020 2020 2020 2020 2020 2020 2022 6164               "ad
+0003c920: 7322 3a20 2232 3031 354a 5068 472e 2e2e  s": "2015JPhG...
+0003c930: 3433 6333 3030 3147 222c 0a20 2020 2020  43c3001G",.     
+0003c940: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003c950: 7363 686f 6c61 7222 3a20 4e6f 6e65 2c0a  scholar": None,.
 0003c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c970: 2020 2022 6164 7322 3a20 2232 3031 354a     "ads": "2015J
-0003c980: 5068 472e 2e2e 3433 6333 3030 3147 222c  PhG...43c3001G",
-0003c990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c9a0: 2020 2020 2022 7363 686f 6c61 7222 3a20       "scholar": 
-0003c9b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0003c9c0: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
-0003c9d0: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
-0003c9e0: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
-0003c9f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003ca00: 2020 2020 2020 2269 7362 6e22 3a20 4e6f        "isbn": No
-0003ca10: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0003ca20: 2020 2020 2020 2020 2279 6561 7222 3a20          "year": 
-0003ca30: 2232 3031 3622 2c0a 2020 2020 2020 2020  "2016",.        
-0003ca40: 2020 2020 2020 2020 2020 2020 226c 696e              "lin
-0003ca50: 6b22 3a20 2225 732f 6162 732f 3135 3037  k": "%s/abs/1507
-0003ca60: 2e30 3832 3034 2220 2520 7062 436f 6e66  .08204" % pbConf
-0003ca70: 6967 2e61 7278 6976 5572 6c2c 0a20 2020  ig.arxivUrl,.   
-0003ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ca90: 2022 636f 6d6d 656e 7473 223a 204e 6f6e   "comments": Non
-0003caa0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0003cab0: 2020 2020 2020 2022 6f6c 645f 6b65 7973         "old_keys
-0003cac0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-0003cad0: 2020 2020 2020 2020 2020 2020 2022 6372               "cr
-0003cae0: 6f73 7372 6566 223a 204e 6f6e 652c 0a20  ossref": None,. 
-0003caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb00: 2020 2022 6269 6274 6578 223a 2022 4041     "bibtex": "@A
-0003cb10: 7274 6963 6c65 7b47 6172 6961 7a7a 6f3a  rticle{Gariazzo:
-0003cb20: 3230 3135 7272 612c 5c6e 220a 2020 2020  2015rra,\n".    
-0003cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb40: 2b20 2720 2020 2020 2020 2061 7574 686f  + '        autho
-0003cb50: 7220 3d20 2253 2e20 4761 7269 617a 7a6f  r = "S. Gariazzo
-0003cb60: 2065 7420 616c 222c 5c6e 270a 2020 2020   et al",\n'.    
-0003cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb80: 2b20 2720 2020 2020 2020 2020 7469 746c  + '         titl
-0003cb90: 6520 3d20 227b 4c69 6768 7420 7374 6572  e = "{Light ster
-0003cba0: 696c 6520 6e65 7574 7269 6e6f 737d 222c  ile neutrinos}",
-0003cbb0: 5c6e 270a 2020 2020 2020 2020 2020 2020  \n'.            
-0003cbc0: 2020 2020 2020 2020 2b20 2720 2020 2020          + '     
-0003cbd0: 2020 6a6f 7572 6e61 6c20 3d20 224a 2e50    journal = "J.P
-0003cbe0: 6879 732e 222c 5c6e 2020 2020 2020 2020  hys.",\n        
-0003cbf0: 766f 6c75 6d65 203d 2022 4734 3322 2c5c  volume = "G43",\
-0003cc00: 6e20 270a 2020 2020 2020 2020 2020 2020  n '.            
-0003cc10: 2020 2020 2020 2020 2b20 2720 2020 2020          + '     
-0003cc20: 2020 2020 7965 6172 203d 2022 3230 3136      year = "2016
-0003cc30: 222c 5c6e 2020 2020 2020 2020 2070 6167  ",\n         pag
-0003cc40: 6573 203d 2027 0a20 2020 2020 2020 2020  es = '.         
-0003cc50: 2020 2020 2020 2020 2020 202b 2027 2230             + '"0
-0003cc60: 3333 3030 3122 2c5c 6e20 2020 2020 2020  33001",\n       
-0003cc70: 2065 7072 696e 7420 3d20 270a 2020 2020   eprint = '.    
-0003cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc90: 2b20 2722 3135 3037 2e30 3832 3034 222c  + '"1507.08204",
-0003cca0: 5c6e 2020 2020 2020 2020 2020 2064 6f69  \n           doi
-0003ccb0: 203d 2027 0a20 2020 2020 2020 2020 2020   = '.           
-0003ccc0: 2020 2020 2020 2020 202b 2027 2231 302e           + '"10.
-0003ccd0: 3130 3838 2f30 3935 342d 3338 3939 2f34  1088/0954-3899/4
-0003cce0: 332f 332f 3033 3330 3031 222c 5c6e 7d27  3/3/033001",\n}'
-0003ccf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003cd00: 2020 2020 2020 2266 6972 7374 6461 7465        "firstdate
-0003cd10: 223a 2022 3230 3135 2d30 372d 3239 222c  ": "2015-07-29",
-0003cd20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003cd30: 2020 2020 2022 7075 6264 6174 6522 3a20       "pubdate": 
-0003cd40: 2232 3031 362d 3031 2d31 3322 2c0a 2020  "2016-01-13",.  
-0003cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cd60: 2020 2265 7870 5f70 6170 6572 223a 2030    "exp_paper": 0
-0003cd70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003cd80: 2020 2020 2020 226c 6563 7475 7265 223a        "lecture":
-0003cd90: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-0003cda0: 2020 2020 2020 2020 2270 6864 5f74 6865          "phd_the
-0003cdb0: 7369 7322 3a20 302c 0a20 2020 2020 2020  sis": 0,.       
-0003cdc0: 2020 2020 2020 2020 2020 2020 2022 7265               "re
-0003cdd0: 7669 6577 223a 2030 2c0a 2020 2020 2020  view": 0,.      
-0003cde0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-0003cdf0: 726f 6365 6564 696e 6722 3a20 302c 0a20  roceeding": 0,. 
-0003ce00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ce10: 2020 2022 626f 6f6b 223a 2030 2c0a 2020     "book": 0,.  
-0003ce20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ce30: 2020 226e 6f55 7064 6174 6522 3a20 302c    "noUpdate": 0,
-0003ce40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ce50: 2020 2020 2022 6d61 726b 7322 3a20 2222       "marks": ""
-0003ce60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003ce70: 2020 2020 2020 2261 6273 7472 6163 7422        "abstract"
-0003ce80: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0003ce90: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0003cea0: 7465 7844 6963 7422 3a20 7b0a 2020 2020  texDict": {.    
-0003ceb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cec0: 2020 2020 2265 7072 696e 7422 3a20 2231      "eprint": "1
-0003ced0: 3530 372e 3038 3230 3422 2c0a 2020 2020  507.08204",.    
-0003cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cef0: 2020 2020 2261 7574 686f 7222 3a20 2253      "author": "S
-0003cf00: 2e20 4761 7269 617a 7a6f 2065 7420 616c  . Gariazzo et al
-0003cf10: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0003cf20: 2020 2020 2020 2020 2020 2022 646f 6922             "doi"
-0003cf30: 3a20 2231 302e 3130 3838 2f30 3935 342d  : "10.1088/0954-
-0003cf40: 3338 3939 2f34 332f 332f 3033 3330 3031  3899/43/3/033001
-0003cf50: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0003cf60: 2020 2020 2020 2020 2020 2022 7061 6765             "page
-0003cf70: 7322 3a20 2230 3333 3030 3122 2c0a 2020  s": "033001",.  
-0003cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cf90: 2020 2020 2020 2274 6974 6c65 223a 2022        "title": "
-0003cfa0: 7b4c 6967 6874 2073 7465 7269 6c65 206e  {Light sterile n
-0003cfb0: 6575 7472 696e 6f73 7d22 2c0a 2020 2020  eutrinos}",.    
-0003cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cfd0: 2020 2020 2279 6561 7222 3a20 2232 3031      "year": "201
-0003cfe0: 3622 2c0a 2020 2020 2020 2020 2020 2020  6",.            
-0003cff0: 2020 2020 2020 2020 2020 2020 2276 6f6c              "vol
-0003d000: 756d 6522 3a20 2247 3433 222c 0a20 2020  ume": "G43",.   
-0003d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d020: 2020 2020 2022 6a6f 7572 6e61 6c22 3a20       "journal": 
-0003d030: 224a 2e50 6879 732e 222c 0a20 2020 2020  "J.Phys.",.     
-0003d040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d050: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-0003d060: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-0003d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d080: 2020 2022 4944 223a 2022 4761 7269 617a     "ID": "Gariaz
-0003d090: 7a6f 3a32 3031 3572 7261 222c 0a20 2020  zo:2015rra",.   
-0003d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d0b0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0003d0c0: 2020 2020 2020 2020 2274 6974 6c65 223a          "title":
-0003d0d0: 2022 7b4c 6967 6874 2073 7465 7269 6c65   "{Light sterile
-0003d0e0: 206e 6575 7472 696e 6f73 7d22 2c0a 2020   neutrinos}",.  
-0003d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d100: 2020 226a 6f75 726e 616c 223a 2022 4a2e    "journal": "J.
-0003d110: 5068 7973 2e22 2c0a 2020 2020 2020 2020  Phys.",.        
-0003d120: 2020 2020 2020 2020 2020 2020 2276 6f6c              "vol
-0003d130: 756d 6522 3a20 2247 3433 222c 0a20 2020  ume": "G43",.   
-0003d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d150: 2022 6e75 6d62 6572 223a 2022 222c 0a20   "number": "",. 
-0003d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d170: 2020 2022 7061 6765 7322 3a20 2230 3333     "pages": "033
-0003d180: 3030 3122 2c0a 2020 2020 2020 2020 2020  001",.          
-0003d190: 2020 2020 2020 2020 2020 2270 7562 6c69            "publi
-0003d1a0: 7368 6564 223a 2022 4a2e 5068 7973 2e20  shed": "J.Phys. 
-0003d1b0: 4734 3320 2832 3031 3629 2030 3333 3030  G43 (2016) 03300
-0003d1c0: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-0003d1d0: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
-0003d1e0: 3a20 2253 2e20 4761 7269 617a 7a6f 2065  : "S. Gariazzo e
-0003d1f0: 7420 616c 222c 0a20 2020 2020 2020 2020  t al",.         
-0003d200: 2020 2020 2020 2020 2020 2022 6269 6264             "bibd
-0003d210: 6963 7422 3a20 7b0a 2020 2020 2020 2020  ict": {.        
-0003d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d230: 2264 6f69 223a 2022 3130 2e31 3038 382f  "doi": "10.1088/
-0003d240: 3039 3534 2d33 3839 392f 3433 2f33 2f30  0954-3899/43/3/0
-0003d250: 3333 3030 3122 2c0a 2020 2020 2020 2020  33001",.        
+0003c970: 2020 2020 2264 6f69 223a 2022 3130 2e31      "doi": "10.1
+0003c980: 3038 382f 3039 3534 2d33 3839 392f 3433  088/0954-3899/43
+0003c990: 2f33 2f30 3333 3030 3122 2c0a 2020 2020  /3/033001",.    
+0003c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c9b0: 2269 7362 6e22 3a20 4e6f 6e65 2c0a 2020  "isbn": None,.  
+0003c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c9d0: 2020 2279 6561 7222 3a20 2232 3031 3622    "year": "2016"
+0003c9e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003c9f0: 2020 2020 2020 226c 696e 6b22 3a20 2225        "link": "%
+0003ca00: 732f 6162 732f 3135 3037 2e30 3832 3034  s/abs/1507.08204
+0003ca10: 2220 2520 7062 436f 6e66 6967 2e61 7278  " % pbConfig.arx
+0003ca20: 6976 5572 6c2c 0a20 2020 2020 2020 2020  ivUrl,.         
+0003ca30: 2020 2020 2020 2020 2020 2022 636f 6d6d             "comm
+0003ca40: 656e 7473 223a 204e 6f6e 652c 0a20 2020  ents": None,.   
+0003ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ca60: 2022 6f6c 645f 6b65 7973 223a 204e 6f6e   "old_keys": Non
+0003ca70: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0003ca80: 2020 2020 2020 2022 6372 6f73 7372 6566         "crossref
+0003ca90: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+0003caa0: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+0003cab0: 6274 6578 223a 2022 4041 7274 6963 6c65  btex": "@Article
+0003cac0: 7b47 6172 6961 7a7a 6f3a 3230 3135 7272  {Gariazzo:2015rr
+0003cad0: 612c 5c6e 220a 2020 2020 2020 2020 2020  a,\n".          
+0003cae0: 2020 2020 2020 2020 2020 2b20 2720 2020            + '   
+0003caf0: 2020 2020 2061 7574 686f 7220 3d20 2253       author = "S
+0003cb00: 2e20 4761 7269 617a 7a6f 2065 7420 616c  . Gariazzo et al
+0003cb10: 222c 5c6e 270a 2020 2020 2020 2020 2020  ",\n'.          
+0003cb20: 2020 2020 2020 2020 2020 2b20 2720 2020            + '   
+0003cb30: 2020 2020 2020 7469 746c 6520 3d20 227b        title = "{
+0003cb40: 4c69 6768 7420 7374 6572 696c 6520 6e65  Light sterile ne
+0003cb50: 7574 7269 6e6f 737d 222c 5c6e 270a 2020  utrinos}",\n'.  
+0003cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cb70: 2020 2b20 2720 2020 2020 2020 6a6f 7572    + '       jour
+0003cb80: 6e61 6c20 3d20 224a 2e50 6879 732e 222c  nal = "J.Phys.",
+0003cb90: 5c6e 2020 2020 2020 2020 766f 6c75 6d65  \n        volume
+0003cba0: 203d 2022 4734 3322 2c5c 6e20 270a 2020   = "G43",\n '.  
+0003cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cbc0: 2020 2b20 2720 2020 2020 2020 2020 7965    + '         ye
+0003cbd0: 6172 203d 2022 3230 3136 222c 5c6e 2020  ar = "2016",\n  
+0003cbe0: 2020 2020 2020 2070 6167 6573 203d 2027         pages = '
+0003cbf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003cc00: 2020 2020 202b 2027 2230 3333 3030 3122       + '"033001"
+0003cc10: 2c5c 6e20 2020 2020 2020 2065 7072 696e  ,\n        eprin
+0003cc20: 7420 3d20 270a 2020 2020 2020 2020 2020  t = '.          
+0003cc30: 2020 2020 2020 2020 2020 2b20 2722 3135            + '"15
+0003cc40: 3037 2e30 3832 3034 222c 5c6e 2020 2020  07.08204",\n    
+0003cc50: 2020 2020 2020 2064 6f69 203d 2027 0a20         doi = '. 
+0003cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cc70: 2020 202b 2027 2231 302e 3130 3838 2f30     + '"10.1088/0
+0003cc80: 3935 342d 3338 3939 2f34 332f 332f 3033  954-3899/43/3/03
+0003cc90: 3330 3031 222c 5c6e 7d27 2c0a 2020 2020  3001",\n}',.    
+0003cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ccb0: 2266 6972 7374 6461 7465 223a 2022 3230  "firstdate": "20
+0003ccc0: 3135 2d30 372d 3239 222c 0a20 2020 2020  15-07-29",.     
+0003ccd0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003cce0: 7075 6264 6174 6522 3a20 2232 3031 362d  pubdate": "2016-
+0003ccf0: 3031 2d31 3322 2c0a 2020 2020 2020 2020  01-13",.        
+0003cd00: 2020 2020 2020 2020 2020 2020 2265 7870              "exp
+0003cd10: 5f70 6170 6572 223a 2030 2c0a 2020 2020  _paper": 0,.    
+0003cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cd30: 226c 6563 7475 7265 223a 2030 2c0a 2020  "lecture": 0,.  
+0003cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cd50: 2020 2270 6864 5f74 6865 7369 7322 3a20    "phd_thesis": 
+0003cd60: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+0003cd70: 2020 2020 2020 2022 7265 7669 6577 223a         "review":
+0003cd80: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+0003cd90: 2020 2020 2020 2020 2270 726f 6365 6564          "proceed
+0003cda0: 696e 6722 3a20 302c 0a20 2020 2020 2020  ing": 0,.       
+0003cdb0: 2020 2020 2020 2020 2020 2020 2022 626f               "bo
+0003cdc0: 6f6b 223a 2030 2c0a 2020 2020 2020 2020  ok": 0,.        
+0003cdd0: 2020 2020 2020 2020 2020 2020 226e 6f55              "noU
+0003cde0: 7064 6174 6522 3a20 302c 0a20 2020 2020  pdate": 0,.     
+0003cdf0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003ce00: 6d61 726b 7322 3a20 2222 2c0a 2020 2020  marks": "",.    
+0003ce10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ce20: 2261 6273 7472 6163 7422 3a20 4e6f 6e65  "abstract": None
+0003ce30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ce40: 2020 2020 2020 2262 6962 7465 7844 6963        "bibtexDic
+0003ce50: 7422 3a20 7b0a 2020 2020 2020 2020 2020  t": {.          
+0003ce60: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+0003ce70: 7072 696e 7422 3a20 2231 3530 372e 3038  print": "1507.08
+0003ce80: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
+0003ce90: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0003cea0: 7574 686f 7222 3a20 2253 2e20 4761 7269  uthor": "S. Gari
+0003ceb0: 617a 7a6f 2065 7420 616c 222c 0a20 2020  azzo et al",.   
+0003cec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ced0: 2020 2020 2022 646f 6922 3a20 2231 302e       "doi": "10.
+0003cee0: 3130 3838 2f30 3935 342d 3338 3939 2f34  1088/0954-3899/4
+0003cef0: 332f 332f 3033 3330 3031 222c 0a20 2020  3/3/033001",.   
+0003cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cf10: 2020 2020 2022 7061 6765 7322 3a20 2230       "pages": "0
+0003cf20: 3333 3030 3122 2c0a 2020 2020 2020 2020  33001",.        
+0003cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cf40: 2274 6974 6c65 223a 2022 7b4c 6967 6874  "title": "{Light
+0003cf50: 2073 7465 7269 6c65 206e 6575 7472 696e   sterile neutrin
+0003cf60: 6f73 7d22 2c0a 2020 2020 2020 2020 2020  os}",.          
+0003cf70: 2020 2020 2020 2020 2020 2020 2020 2279                "y
+0003cf80: 6561 7222 3a20 2232 3031 3622 2c0a 2020  ear": "2016",.  
+0003cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cfa0: 2020 2020 2020 2276 6f6c 756d 6522 3a20        "volume": 
+0003cfb0: 2247 3433 222c 0a20 2020 2020 2020 2020  "G43",.         
+0003cfc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003cfd0: 6a6f 7572 6e61 6c22 3a20 224a 2e50 6879  journal": "J.Phy
+0003cfe0: 732e 222c 0a20 2020 2020 2020 2020 2020  s.",.           
+0003cff0: 2020 2020 2020 2020 2020 2020 2022 454e               "EN
+0003d000: 5452 5954 5950 4522 3a20 2261 7274 6963  TRYTYPE": "artic
+0003d010: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0003d020: 2020 2020 2020 2020 2020 2020 2022 4944               "ID
+0003d030: 223a 2022 4761 7269 617a 7a6f 3a32 3031  ": "Gariazzo:201
+0003d040: 3572 7261 222c 0a20 2020 2020 2020 2020  5rra",.         
+0003d050: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+0003d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d070: 2020 2274 6974 6c65 223a 2022 7b4c 6967    "title": "{Lig
+0003d080: 6874 2073 7465 7269 6c65 206e 6575 7472  ht sterile neutr
+0003d090: 696e 6f73 7d22 2c0a 2020 2020 2020 2020  inos}",.        
+0003d0a0: 2020 2020 2020 2020 2020 2020 226a 6f75              "jou
+0003d0b0: 726e 616c 223a 2022 4a2e 5068 7973 2e22  rnal": "J.Phys."
+0003d0c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003d0d0: 2020 2020 2020 2276 6f6c 756d 6522 3a20        "volume": 
+0003d0e0: 2247 3433 222c 0a20 2020 2020 2020 2020  "G43",.         
+0003d0f0: 2020 2020 2020 2020 2020 2022 6e75 6d62             "numb
+0003d100: 6572 223a 2022 222c 0a20 2020 2020 2020  er": "",.       
+0003d110: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
+0003d120: 6765 7322 3a20 2230 3333 3030 3122 2c0a  ges": "033001",.
+0003d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d140: 2020 2020 2270 7562 6c69 7368 6564 223a      "published":
+0003d150: 2022 4a2e 5068 7973 2e20 4734 3320 2832   "J.Phys. G43 (2
+0003d160: 3031 3629 2030 3333 3030 3122 2c0a 2020  016) 033001",.  
+0003d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d180: 2020 2261 7574 686f 7222 3a20 2253 2e20    "author": "S. 
+0003d190: 4761 7269 617a 7a6f 2065 7420 616c 222c  Gariazzo et al",
+0003d1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d1b0: 2020 2020 2022 6269 6264 6963 7422 3a20       "bibdict": 
+0003d1c0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0003d1d0: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
+0003d1e0: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
+0003d1f0: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
+0003d200: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003d210: 2020 2020 2020 2020 2020 226a 6f75 726e            "journ
+0003d220: 616c 223a 2022 4a2e 5068 7973 2e22 2c0a  al": "J.Phys.",.
+0003d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d240: 2020 2020 2020 2020 2265 7072 696e 7422          "eprint"
+0003d250: 3a20 2231 3530 372e 3038 3230 3422 2c0a  : "1507.08204",.
 0003d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d270: 226a 6f75 726e 616c 223a 2022 4a2e 5068  "journal": "J.Ph
-0003d280: 7973 2e22 2c0a 2020 2020 2020 2020 2020  ys.",.          
-0003d290: 2020 2020 2020 2020 2020 2020 2020 2265                "e
-0003d2a0: 7072 696e 7422 3a20 2231 3530 372e 3038  print": "1507.08
-0003d2b0: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
-0003d2c0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-0003d2d0: 7574 686f 7222 3a20 2253 2e20 4761 7269  uthor": "S. Gari
-0003d2e0: 617a 7a6f 2065 7420 616c 222c 0a20 2020  azzo et al",.   
-0003d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d300: 2020 2020 2022 7469 746c 6522 3a20 227b       "title": "{
-0003d310: 4c69 6768 7420 7374 6572 696c 6520 6e65  Light sterile ne
-0003d320: 7574 7269 6e6f 737d 222c 0a20 2020 2020  utrinos}",.     
+0003d270: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
+0003d280: 3a20 2253 2e20 4761 7269 617a 7a6f 2065  : "S. Gariazzo e
+0003d290: 7420 616c 222c 0a20 2020 2020 2020 2020  t al",.         
+0003d2a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003d2b0: 7469 746c 6522 3a20 227b 4c69 6768 7420  title": "{Light 
+0003d2c0: 7374 6572 696c 6520 6e65 7574 7269 6e6f  sterile neutrino
+0003d2d0: 737d 222c 0a20 2020 2020 2020 2020 2020  s}",.           
+0003d2e0: 2020 2020 2020 2020 2020 2020 2022 454e               "EN
+0003d2f0: 5452 5954 5950 4522 3a20 2261 7274 6963  TRYTYPE": "artic
+0003d300: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0003d310: 2020 2020 2020 2020 2020 2020 2022 766f               "vo
+0003d320: 6c75 6d65 223a 2022 4734 3322 2c0a 2020  lume": "G43",.  
 0003d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d340: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-0003d350: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-0003d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d370: 2020 2022 766f 6c75 6d65 223a 2022 4734     "volume": "G4
-0003d380: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-0003d390: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
-0003d3a0: 7222 3a20 2232 3031 3622 2c0a 2020 2020  r": "2016",.    
-0003d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d3c0: 2020 2020 2249 4422 3a20 2247 6172 6961      "ID": "Garia
-0003d3d0: 7a7a 6f3a 3230 3135 7272 6122 2c0a 2020  zzo:2015rra",.  
-0003d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d3f0: 2020 2020 2020 2270 6167 6573 223a 2022        "pages": "
-0003d400: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
-0003d410: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-0003d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d430: 7d2c 0a20 2020 2020 2020 2020 2020 2029  },.            )
-0003d440: 0a0a 2020 2020 6465 6620 7465 7374 5f67  ..    def test_g
-0003d450: 6574 456e 7472 6965 7349 664e 6f6e 6528  etEntriesIfNone(
-0003d460: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
-0003d470: 2020 2020 2020 2222 2274 6573 7420 6765        """test ge
-0003d480: 7445 6e74 7269 6573 4966 4e6f 6e65 2222  tEntriesIfNone""
-0003d490: 220a 2020 2020 2020 2020 7365 6c66 2e69  ".        self.i
-0003d4a0: 6e73 6572 745f 7468 7265 6528 290a 2020  nsert_three().  
-0003d4b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0003d4c0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0003d4d0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-0003d4e0: 6273 2e67 6574 456e 7472 6965 7349 664e  bs.getEntriesIfN
-0003d4f0: 6f6e 6528 292c 2028 7365 6c66 2e70 4244  one(), (self.pBD
-0003d500: 422e 6269 6273 2e66 6574 6368 4375 7273  B.bibs.fetchCurs
-0003d510: 2c20 3329 0a20 2020 2020 2020 2029 0a20  , 3).        ). 
-0003d520: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0003d530: 7274 4571 7561 6c28 6c65 6e28 5b65 2066  rtEqual(len([e f
-0003d540: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
-0003d550: 422e 6269 6273 2e66 6574 6368 4375 7273  B.bibs.fetchCurs
-0003d560: 5d29 2c20 3329 0a20 2020 2020 2020 2073  ]), 3).        s
-0003d570: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0003d580: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003d590: 662e 7042 4442 2e62 6962 732e 6765 7445  f.pBDB.bibs.getE
-0003d5a0: 6e74 7269 6573 4966 4e6f 6e65 2873 7461  ntriesIfNone(sta
-0003d5b0: 7274 4672 6f6d 3d32 292c 2028 7365 6c66  rtFrom=2), (self
-0003d5c0: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-0003d5d0: 4375 7273 2c20 3129 0a20 2020 2020 2020  Curs, 1).       
-0003d5e0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0003d5f0: 6173 7365 7274 4571 7561 6c28 6c65 6e28  assertEqual(len(
-0003d600: 5b65 2066 6f72 2065 2069 6e20 7365 6c66  [e for e in self
-0003d610: 2e70 4244 422e 6269 6273 2e66 6574 6368  .pBDB.bibs.fetch
-0003d620: 4375 7273 5d29 2c20 3129 0a0a 2020 2020  Curs]), 1)..    
-0003d630: 6465 6620 7465 7374 5f67 6574 4669 656c  def test_getFiel
-0003d640: 6428 7365 6c66 2c20 2a61 7267 7329 3a0a  d(self, *args):.
-0003d650: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
-0003d660: 6765 7446 6965 6c64 2222 220a 2020 2020  getField""".    
-0003d670: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
-0003d680: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
-0003d690: 6549 6e73 6572 7428 0a20 2020 2020 2020  eInsert(.       
-0003d6a0: 2020 2020 2027 4061 7274 6963 6c65 7b61       '@article{a
-0003d6b0: 6263 2c5c 6e61 7574 686f 7220 3d20 226d  bc,\nauthor = "m
-0003d6c0: 6522 2c5c 6e74 6974 6c65 203d 2022 6162  e",\ntitle = "ab
-0003d6d0: 6322 2c7d 272c 0a20 2020 2020 2020 2020  c",}',.         
-0003d6e0: 2020 2061 7278 6976 3d22 6162 6322 2c0a     arxiv="abc",.
-0003d6f0: 2020 2020 2020 2020 2020 2020 646f 693d              doi=
-0003d700: 2231 222c 0a20 2020 2020 2020 2020 2020  "1",.           
-0003d710: 2069 7362 6e3d 392c 0a20 2020 2020 2020   isbn=9,.       
-0003d720: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0003d730: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
-0003d740: 7042 4442 2e62 6962 732e 696e 7365 7274  pBDB.bibs.insert
-0003d750: 2864 6174 6129 290a 2020 2020 2020 2020  (data)).        
-0003d760: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0003d770: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-0003d780: 6765 7446 6965 6c64 2822 6162 6322 2c20  getField("abc", 
-0003d790: 2264 6f69 2229 2c20 2231 2229 0a20 2020  "doi"), "1").   
-0003d7a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0003d7b0: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-0003d7c0: 6269 6273 2e67 6574 4669 656c 6428 2261  bibs.getField("a
-0003d7d0: 6263 222c 2022 6172 7869 7622 292c 2022  bc", "arxiv"), "
-0003d7e0: 6162 6322 290a 2020 2020 2020 2020 7365  abc").        se
-0003d7f0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-0003d800: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0003d810: 7446 6965 6c64 2822 6162 6322 2c20 2269  tField("abc", "i
-0003d820: 7362 6e22 292c 2022 3922 290a 2020 2020  sbn"), "9").    
-0003d830: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
-0003d840: 616c 7365 2873 656c 662e 7042 4442 2e62  alse(self.pBDB.b
-0003d850: 6962 732e 6765 7446 6965 6c64 2822 6465  ibs.getField("de
-0003d860: 6622 2c20 2269 7362 6e22 2929 0a20 2020  f", "isbn")).   
-0003d870: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0003d880: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-0003d890: 7761 726e 696e 6722 2920 6173 205f 693a  warning") as _i:
-0003d8a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003d8b0: 662e 7042 4442 2e62 6962 732e 6765 7446  f.pBDB.bibs.getF
-0003d8c0: 6965 6c64 2822 6465 6622 2c20 2269 7362  ield("def", "isb
-0003d8d0: 6e22 290a 2020 2020 2020 2020 2020 2020  n").            
-0003d8e0: 5f69 2e61 7373 6572 745f 6361 6c6c 6564  _i.assert_called
-0003d8f0: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
-0003d900: 2020 2020 2020 2020 2020 2020 2245 7272              "Err
-0003d910: 6f72 2069 6e20 6765 7446 6965 6c64 2827  or in getField('
-0003d920: 6465 6627 2c20 2769 7362 6e27 293a 206e  def', 'isbn'): n
-0003d930: 6f20 656c 656d 656e 7420 666f 756e 643f  o element found?
-0003d940: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0003d950: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0003d960: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
-0003d970: 4442 2e62 6962 732e 6765 7446 6965 6c64  DB.bibs.getField
-0003d980: 2822 6162 6322 2c20 2264 6566 2229 290a  ("abc", "def")).
-0003d990: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-0003d9a0: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
-0003d9b0: 6572 2e77 6172 6e69 6e67 2229 2061 7320  er.warning") as 
-0003d9c0: 5f69 3a0a 2020 2020 2020 2020 2020 2020  _i:.            
-0003d9d0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
-0003d9e0: 6574 4669 656c 6428 2261 6263 222c 2022  etField("abc", "
-0003d9f0: 6465 6622 290a 2020 2020 2020 2020 2020  def").          
-0003da00: 2020 5f69 2e61 7373 6572 745f 6361 6c6c    _i.assert_call
-0003da10: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
-0003da20: 2020 2020 2020 2020 2020 2020 2020 2245                "E
-0003da30: 7272 6f72 2069 6e20 6765 7446 6965 6c64  rror in getField
-0003da40: 2827 6162 6327 2c20 2764 6566 2729 3a20  ('abc', 'def'): 
-0003da50: 7468 6520 6669 656c 6420 6973 206d 6973  the field is mis
-0003da60: 7369 6e67 3f22 0a20 2020 2020 2020 2020  sing?".         
-0003da70: 2020 2029 0a0a 2020 2020 4075 6e69 7474     )..    @unitt
-0003da80: 6573 742e 736b 6970 4966 2873 6b69 7054  est.skipIf(skipT
-0003da90: 6573 7473 5365 7474 696e 6773 2e6f 6e6c  estsSettings.onl
-0003daa0: 696e 652c 2022 4f6e 6c69 6e65 2074 6573  ine, "Online tes
-0003dab0: 7473 2229 0a20 2020 2040 7061 7463 682e  ts").    @patch.
-0003dac0: 6469 6374 2870 6243 6f6e 6669 672e 7061  dict(pbConfig.pa
-0003dad0: 7261 6d73 2c20 7b22 6d61 7841 7574 686f  rams, {"maxAutho
-0003dae0: 7253 6176 6522 3a20 357d 2c20 636c 6561  rSave": 5}, clea
-0003daf0: 723d 4661 6c73 6529 0a20 2020 2064 6566  r=False).    def
-0003db00: 2074 6573 745f 6765 7446 6965 6c64 7346   test_getFieldsF
-0003db10: 726f 6d41 7278 6976 2873 656c 662c 202a  romArxiv(self, *
-0003db20: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-0003db30: 2222 7465 7374 7320 666f 7220 6765 7446  ""tests for getF
-0003db40: 6965 6c64 7346 726f 6d41 7278 6976 2028  ieldsFromArxiv (
-0003db50: 6f6e 6c69 6e65 2922 2222 0a20 2020 2020  online)""".     
-0003db60: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-0003db70: 732e 696e 7365 7274 4672 6f6d 4269 6274  s.insertFromBibt
-0003db80: 6578 280a 2020 2020 2020 2020 2020 2020  ex(.            
-0003db90: 2740 6172 7469 636c 657b 4761 7269 617a  '@article{Gariaz
-0003dba0: 7a6f 3a32 3031 3572 7261 2c5c 6e61 7278  zo:2015rra,\narx
-0003dbb0: 6976 3d22 3135 3037 2e30 3832 3034 225c  iv="1507.08204"\
-0003dbc0: 6e7d 270a 2020 2020 2020 2020 290a 2020  n}'.        ).  
-0003dbd0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0003dbe0: 6269 6273 2e69 6e73 6572 7446 726f 6d42  bibs.insertFromB
-0003dbf0: 6962 7465 7828 2740 6172 7469 636c 657b  ibtex('@article{
-0003dc00: 4164 653a 3230 3133 7a75 762c 5c6e 6172  Ade:2013zuv,\nar
-0003dc10: 7869 763d 2231 3330 332e 3530 3736 225c  xiv="1303.5076"\
-0003dc20: 6e7d 2729 0a20 2020 2020 2020 2073 656c  n}').        sel
-0003dc30: 662e 6173 7365 7274 4e6f 7449 6e28 2241  f.assertNotIn("A
-0003dc40: 6768 616e 696d 222c 2073 656c 662e 7042  ghanim", self.pB
-0003dc50: 4442 2e62 6962 732e 6765 7446 6965 6c64  DB.bibs.getField
-0003dc60: 2822 4164 653a 3230 3133 7a75 7622 2c20  ("Ade:2013zuv", 
-0003dc70: 2262 6962 7465 7822 2929 0a20 2020 2020  "bibtex")).     
-0003dc80: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-0003dc90: 6c73 6528 7365 6c66 2e70 4244 422e 6269  lse(self.pBDB.bi
-0003dca0: 6273 2e67 6574 4669 656c 6473 4672 6f6d  bs.getFieldsFrom
-0003dcb0: 4172 7869 7628 2261 6263 6422 2c20 2261  Arxiv("abcd", "a
-0003dcc0: 7574 686f 7273 2229 290a 2020 2020 2020  uthors")).      
-0003dcd0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-0003dce0: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
-0003dcf0: 2e67 6574 4669 656c 6473 4672 6f6d 4172  .getFieldsFromAr
-0003dd00: 7869 7628 2241 6465 3a32 3031 337a 7576  xiv("Ade:2013zuv
-0003dd10: 222c 2022 6175 7468 6f72 7322 2929 0a20  ", "authors")). 
-0003dd20: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0003dd30: 7274 496e 2822 4167 6861 6e69 6d22 2c20  rtIn("Aghanim", 
-0003dd40: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
-0003dd50: 6574 4669 656c 6428 2241 6465 3a32 3031  etField("Ade:201
-0003dd60: 337a 7576 222c 2022 6269 6274 6578 2229  3zuv", "bibtex")
-0003dd70: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0003dd80: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-0003dd90: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0003dda0: 422e 6269 6273 2e67 6574 4669 656c 6473  B.bibs.getFields
-0003ddb0: 4672 6f6d 4172 7869 7628 0a20 2020 2020  FromArxiv(.     
-0003ddc0: 2020 2020 2020 2020 2020 205b 2247 6172             ["Gar
-0003ddd0: 6961 7a7a 6f3a 3230 3135 7272 6122 2c20  iazzo:2015rra", 
-0003dde0: 2241 6465 3a32 3031 337a 7576 225d 2c20  "Ade:2013zuv"], 
-0003ddf0: 2270 7269 6d61 7279 636c 6173 7322 0a20  "primaryclass". 
-0003de00: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-0003de10: 2020 2020 2020 2020 2020 285b 2247 6172            (["Gar
-0003de20: 6961 7a7a 6f3a 3230 3135 7272 6122 2c20  iazzo:2015rra", 
-0003de30: 2241 6465 3a32 3031 337a 7576 225d 2c20  "Ade:2013zuv"], 
-0003de40: 5b5d 292c 0a20 2020 2020 2020 2029 0a20  []),.        ). 
-0003de50: 2020 2020 2020 2070 626d 203d 204d 6167         pbm = Mag
-0003de60: 6963 4d6f 636b 2829 0a20 2020 2020 2020  icMock().       
-0003de70: 2070 6276 203d 204d 6167 6963 4d6f 636b   pbv = MagicMock
-0003de80: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-0003de90: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0003dea0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0003deb0: 4442 2e62 6962 732e 6765 7446 6965 6c64  DB.bibs.getField
-0003dec0: 7346 726f 6d41 7278 6976 280a 2020 2020  sFromArxiv(.    
-0003ded0: 2020 2020 2020 2020 2020 2020 5b22 4761              ["Ga
-0003dee0: 7269 617a 7a6f 3a32 3031 3572 7261 222c  riazzo:2015rra",
-0003def0: 2022 4164 653a 3230 3133 7a75 7622 5d2c   "Ade:2013zuv"],
-0003df00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003df10: 2022 7072 696d 6172 7963 6c61 7373 222c   "primaryclass",
-0003df20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003df30: 2070 624d 6178 3d70 626d 2c0a 2020 2020   pbMax=pbm,.    
-0003df40: 2020 2020 2020 2020 2020 2020 7062 5661              pbVa
-0003df50: 6c3d 7062 762c 0a20 2020 2020 2020 2020  l=pbv,.         
-0003df60: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-0003df70: 2020 285b 2247 6172 6961 7a7a 6f3a 3230    (["Gariazzo:20
-0003df80: 3135 7272 6122 2c20 2241 6465 3a32 3031  15rra", "Ade:201
-0003df90: 337a 7576 225d 2c20 5b5d 292c 0a20 2020  3zuv"], []),.   
-0003dfa0: 2020 2020 2029 0a20 2020 2020 2020 2070       ).        p
-0003dfb0: 626d 2e61 7373 6572 745f 6361 6c6c 6564  bm.assert_called
-0003dfc0: 5f6f 6e63 655f 7769 7468 2832 290a 2020  _once_with(2).  
-0003dfd0: 2020 2020 2020 7062 762e 6173 7365 7274        pbv.assert
-0003dfe0: 5f68 6173 5f63 616c 6c73 285b 6361 6c6c  _has_calls([call
-0003dff0: 2831 292c 2063 616c 6c28 3229 5d29 0a0a  (1), call(2)])..
-0003e000: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0003e010: 6572 7449 6e28 2261 7374 726f 2d70 6822  ertIn("astro-ph"
-0003e020: 2c20 7365 6c66 2e70 4244 422e 6269 6273  , self.pBDB.bibs
-0003e030: 2e67 6574 4669 656c 6428 2241 6465 3a32  .getField("Ade:2
-0003e040: 3031 337a 7576 222c 2022 6269 6274 6578  013zuv", "bibtex
-0003e050: 2229 290a 2020 2020 2020 2020 7365 6c66  ")).        self
-0003e060: 2e61 7373 6572 7449 6e28 2268 6570 2d70  .assertIn("hep-p
-0003e070: 6822 2c20 7365 6c66 2e70 4244 422e 6269  h", self.pBDB.bi
-0003e080: 6273 2e67 6574 4669 656c 6428 2247 6172  bs.getField("Gar
-0003e090: 6961 7a7a 6f3a 3230 3135 7272 6122 2c20  iazzo:2015rra", 
-0003e0a0: 2262 6962 7465 7822 2929 0a0a 2020 2020  "bibtex"))..    
-0003e0b0: 6465 6620 7465 7374 5f67 6574 496e 7370  def test_getInsp
-0003e0c0: 6972 6549 444c 6973 7428 7365 6c66 2c20  ireIDList(self, 
-0003e0d0: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
-0003e0e0: 2222 2274 6573 7420 6765 7449 6e73 7069  """test getInspi
-0003e0f0: 7265 4944 4c69 7374 2222 220a 2020 2020  reIDList""".    
-0003e100: 2020 2020 7062 7620 3d20 4d61 6769 634d      pbv = MagicM
-0003e110: 6f63 6b28 290a 2020 2020 2020 2020 7769  ock().        wi
-0003e120: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-0003e130: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0003e140: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
-0003e150: 6573 2e63 6865 636b 4e65 6564 7355 7064  es.checkNeedsUpd
-0003e160: 6174 6522 2c0a 2020 2020 2020 2020 2020  ate",.          
-0003e170: 2020 7369 6465 5f65 6666 6563 743d 5b54    side_effect=[T
-0003e180: 7275 652c 2054 7275 652c 2046 616c 7365  rue, True, False
-0003e190: 2c20 5472 7565 5d2c 0a20 2020 2020 2020  , True],.       
-0003e1a0: 2029 2061 7320 5f63 6e75 3a0a 2020 2020   ) as _cnu:.    
-0003e1b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0003e1c0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0003e1d0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0003e1e0: 4244 422e 6269 6273 2e67 6574 496e 7370  BDB.bibs.getInsp
-0003e1f0: 6972 6549 444c 6973 7428 0a20 2020 2020  ireIDList(.     
-0003e200: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0003e210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e220: 2020 2020 2020 2020 207b 2262 6962 6b65           {"bibke
-0003e230: 7922 3a20 2261 222c 2022 696e 7370 6972  y": "a", "inspir
-0003e240: 6522 3a20 2231 227d 2c0a 2020 2020 2020  e": "1"},.      
-0003e250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e260: 2020 7b22 6269 626b 6579 223a 2022 6222    {"bibkey": "b"
-0003e270: 2c20 2269 6e73 7069 7265 223a 2022 3222  , "inspire": "2"
-0003e280: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0003e290: 2020 2020 2020 2020 2020 207b 2262 6962             {"bib
-0003e2a0: 6b65 7922 3a20 2263 222c 2022 696e 7370  key": "c", "insp
-0003e2b0: 6972 6522 3a20 2233 227d 2c0a 2020 2020  ire": "3"},.    
-0003e2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e2d0: 2020 2020 7b22 6269 626b 6579 223a 2022      {"bibkey": "
-0003e2e0: 6422 2c20 2269 6e73 7069 7265 223a 2022  d", "inspire": "
-0003e2f0: 3422 7d2c 0a20 2020 2020 2020 2020 2020  4"},.           
-0003e300: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-0003e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e320: 342c 0a20 2020 2020 2020 2020 2020 2020  4,.             
-0003e330: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-0003e340: 2020 2020 2020 285b 2231 222c 2022 3222        (["1", "2"
-0003e350: 2c20 2234 225d 2c20 3329 2c0a 2020 2020  , "4"], 3),.    
-0003e360: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0003e370: 2020 2020 2020 5f63 6e75 2e61 7373 6572        _cnu.asser
-0003e380: 745f 616e 795f 6361 6c6c 287b 2262 6962  t_any_call({"bib
-0003e390: 6b65 7922 3a20 2261 222c 2022 696e 7370  key": "a", "insp
-0003e3a0: 6972 6522 3a20 2231 227d 2c20 666f 7263  ire": "1"}, forc
-0003e3b0: 653d 4661 6c73 6529 0a20 2020 2020 2020  e=False).       
-0003e3c0: 2020 2020 205f 636e 752e 6173 7365 7274       _cnu.assert
-0003e3d0: 5f61 6e79 5f63 616c 6c28 7b22 6269 626b  _any_call({"bibk
-0003e3e0: 6579 223a 2022 6222 2c20 2269 6e73 7069  ey": "b", "inspi
-0003e3f0: 7265 223a 2022 3222 7d2c 2066 6f72 6365  re": "2"}, force
-0003e400: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-0003e410: 2020 2020 5f63 6e75 2e61 7373 6572 745f      _cnu.assert_
-0003e420: 616e 795f 6361 6c6c 287b 2262 6962 6b65  any_call({"bibke
-0003e430: 7922 3a20 2263 222c 2022 696e 7370 6972  y": "c", "inspir
-0003e440: 6522 3a20 2233 227d 2c20 666f 7263 653d  e": "3"}, force=
-0003e450: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
-0003e460: 2020 205f 636e 752e 6173 7365 7274 5f61     _cnu.assert_a
-0003e470: 6e79 5f63 616c 6c28 7b22 6269 626b 6579  ny_call({"bibkey
-0003e480: 223a 2022 6422 2c20 2269 6e73 7069 7265  ": "d", "inspire
-0003e490: 223a 2022 3422 7d2c 2066 6f72 6365 3d46  ": "4"}, force=F
-0003e4a0: 616c 7365 290a 2020 2020 2020 2020 7769  alse).        wi
-0003e4b0: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-0003e4c0: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0003e4d0: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
-0003e4e0: 6573 2e63 6865 636b 4e65 6564 7355 7064  es.checkNeedsUpd
-0003e4f0: 6174 6522 2c0a 2020 2020 2020 2020 2020  ate",.          
-0003e500: 2020 7369 6465 5f65 6666 6563 743d 5b46    side_effect=[F
-0003e510: 616c 7365 2c20 5472 7565 2c20 4661 6c73  alse, True, Fals
-0003e520: 652c 2054 7275 655d 2c0a 2020 2020 2020  e, True],.      
-0003e530: 2020 2920 6173 205f 636e 753a 0a20 2020    ) as _cnu:.   
-0003e540: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0003e550: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0003e560: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003e570: 7042 4442 2e62 6962 732e 6765 7449 6e73  pBDB.bibs.getIns
-0003e580: 7069 7265 4944 4c69 7374 280a 2020 2020  pireIDList(.    
-0003e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e5a0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0003e5b0: 2020 2020 2020 2020 2020 7b22 6269 626b            {"bibk
-0003e5c0: 6579 223a 2022 6122 2c20 2269 6e73 7069  ey": "a", "inspi
-0003e5d0: 7265 223a 2022 3122 7d2c 0a20 2020 2020  re": "1"},.     
-0003e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e5f0: 2020 207b 2262 6962 6b65 7922 3a20 2262     {"bibkey": "b
-0003e600: 222c 2022 696e 7370 6972 6522 3a20 2232  ", "inspire": "2
-0003e610: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
-0003e620: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
-0003e630: 626b 6579 223a 2022 6322 2c20 2269 6e73  bkey": "c", "ins
-0003e640: 7069 7265 223a 2022 3322 7d2c 0a20 2020  pire": "3"},.   
-0003e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e660: 2020 2020 207b 2262 6962 6b65 7922 3a20       {"bibkey": 
-0003e670: 2264 222c 2022 696e 7370 6972 6522 3a20  "d", "inspire": 
-0003e680: 2234 227d 2c0a 2020 2020 2020 2020 2020  "4"},.          
-0003e690: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0003e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e6b0: 2034 2c0a 2020 2020 2020 2020 2020 2020   4,.            
-0003e6c0: 2020 2020 2020 2020 666f 7263 653d 5472          force=Tr
-0003e6d0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-0003e6e0: 2020 2020 2020 2020 7062 5661 6c3d 7062          pbVal=pb
-0003e6f0: 762c 0a20 2020 2020 2020 2020 2020 2020  v,.             
-0003e700: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-0003e710: 2020 2020 2020 285b 2232 222c 2022 3422        (["2", "4"
-0003e720: 5d2c 2032 292c 0a20 2020 2020 2020 2020  ], 2),.         
-0003e730: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0003e740: 2070 6276 2e61 7373 6572 745f 616e 795f   pbv.assert_any_
-0003e750: 6361 6c6c 2831 290a 2020 2020 2020 2020  call(1).        
-0003e760: 2020 2020 7062 762e 6173 7365 7274 5f61      pbv.assert_a
-0003e770: 6e79 5f63 616c 6c28 3229 0a20 2020 2020  ny_call(2).     
-0003e780: 2020 2020 2020 2070 6276 2e61 7373 6572         pbv.asser
-0003e790: 745f 616e 795f 6361 6c6c 2833 290a 2020  t_any_call(3).  
-0003e7a0: 2020 2020 2020 2020 2020 7062 762e 6173            pbv.as
-0003e7b0: 7365 7274 5f61 6e79 5f63 616c 6c28 3429  sert_any_call(4)
-0003e7c0: 0a20 2020 2020 2020 2020 2020 205f 636e  .            _cn
-0003e7d0: 752e 6173 7365 7274 5f61 6e79 5f63 616c  u.assert_any_cal
-0003e7e0: 6c28 7b22 6269 626b 6579 223a 2022 6122  l({"bibkey": "a"
-0003e7f0: 2c20 2269 6e73 7069 7265 223a 2022 3122  , "inspire": "1"
-0003e800: 7d2c 2066 6f72 6365 3d54 7275 6529 0a20  }, force=True). 
-0003e810: 2020 2020 2020 2020 2020 205f 636e 752e             _cnu.
-0003e820: 6173 7365 7274 5f61 6e79 5f63 616c 6c28  assert_any_call(
-0003e830: 7b22 6269 626b 6579 223a 2022 6222 2c20  {"bibkey": "b", 
-0003e840: 2269 6e73 7069 7265 223a 2022 3222 7d2c  "inspire": "2"},
-0003e850: 2066 6f72 6365 3d54 7275 6529 0a20 2020   force=True).   
-0003e860: 2020 2020 2020 2020 205f 636e 752e 6173           _cnu.as
-0003e870: 7365 7274 5f61 6e79 5f63 616c 6c28 7b22  sert_any_call({"
-0003e880: 6269 626b 6579 223a 2022 6322 2c20 2269  bibkey": "c", "i
-0003e890: 6e73 7069 7265 223a 2022 3322 7d2c 2066  nspire": "3"}, f
-0003e8a0: 6f72 6365 3d54 7275 6529 0a20 2020 2020  orce=True).     
-0003e8b0: 2020 2020 2020 205f 636e 752e 6173 7365         _cnu.asse
-0003e8c0: 7274 5f61 6e79 5f63 616c 6c28 7b22 6269  rt_any_call({"bi
-0003e8d0: 626b 6579 223a 2022 6422 2c20 2269 6e73  bkey": "d", "ins
-0003e8e0: 7069 7265 223a 2022 3422 7d2c 2066 6f72  pire": "4"}, for
-0003e8f0: 6365 3d54 7275 6529 0a0a 2020 2020 6465  ce=True)..    de
-0003e900: 6620 7465 7374 5f67 6574 5572 6c28 7365  f test_getUrl(se
-0003e910: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
-0003e920: 2020 2020 2222 2274 6573 7420 6765 7455      """test getU
-0003e930: 726c 2222 220a 2020 2020 2020 2020 6461  rl""".        da
-0003e940: 7461 203d 2073 656c 662e 7042 4442 2e62  ta = self.pBDB.b
-0003e950: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
-0003e960: 7428 0a20 2020 2020 2020 2020 2020 2027  t(.            '
-0003e970: 4061 7274 6963 6c65 7b61 6263 2c5c 6e61  @article{abc,\na
-0003e980: 7574 686f 7220 3d20 226d 6522 2c5c 6e74  uthor = "me",\nt
-0003e990: 6974 6c65 203d 2022 6162 6322 2c7d 272c  itle = "abc",}',
-0003e9a0: 0a20 2020 2020 2020 2020 2020 2061 6473  .            ads
-0003e9b0: 3d22 6162 632e 2e2e 3132 3322 2c0a 2020  ="abc...123",.  
-0003e9c0: 2020 2020 2020 2020 2020 6172 7869 763d            arxiv=
-0003e9d0: 2231 3233 342e 3536 3738 222c 0a20 2020  "1234.5678",.   
-0003e9e0: 2020 2020 2020 2020 2064 6f69 3d22 312f           doi="1/
-0003e9f0: 322f 3322 2c0a 2020 2020 2020 2020 290a  2/3",.        ).
-0003ea00: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0003ea10: 6572 7454 7275 6528 7365 6c66 2e70 4244  ertTrue(self.pBD
-0003ea20: 422e 6269 6273 2e69 6e73 6572 7428 6461  B.bibs.insert(da
-0003ea30: 7461 2929 0a20 2020 2020 2020 2073 656c  ta)).        sel
-0003ea40: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-0003ea50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003ea60: 7042 4442 2e62 6962 732e 6765 7441 6473  pBDB.bibs.getAds
-0003ea70: 5572 6c28 2261 6263 2229 2c20 2225 7361  Url("abc"), "%sa
-0003ea80: 6263 2e2e 2e31 3233 2220 2520 7062 436f  bc...123" % pbCo
-0003ea90: 6e66 6967 2e61 6473 5572 6c0a 2020 2020  nfig.adsUrl.    
-0003eaa0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0003eab0: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
-0003eac0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0003ead0: 7441 6473 5572 6c28 2264 6566 2229 290a  tAdsUrl("def")).
-0003eae0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0003eaf0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0003eb00: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0003eb10: 6269 6273 2e67 6574 4172 7869 7655 726c  bibs.getArxivUrl
-0003eb20: 2822 6162 6322 292c 2022 2573 2f61 6273  ("abc"), "%s/abs
-0003eb30: 2f31 3233 342e 3536 3738 2220 2520 7062  /1234.5678" % pb
-0003eb40: 436f 6e66 6967 2e61 7278 6976 5572 6c0a  Config.arxivUrl.
-0003eb50: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0003eb60: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
-0003eb70: 7365 2873 656c 662e 7042 4442 2e62 6962  se(self.pBDB.bib
-0003eb80: 732e 6765 7441 7278 6976 5572 6c28 2264  s.getArxivUrl("d
-0003eb90: 6566 2229 290a 2020 2020 2020 2020 7365  ef")).        se
-0003eba0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-0003ebb0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0003ebc0: 7444 6f69 5572 6c28 2261 6263 2229 2c20  tDoiUrl("abc"), 
-0003ebd0: 2225 7331 2f32 2f33 2220 2520 7062 436f  "%s1/2/3" % pbCo
-0003ebe0: 6e66 6967 2e64 6f69 5572 6c29 0a20 2020  nfig.doiUrl).   
-0003ebf0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0003ec00: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
-0003ec10: 6269 6273 2e67 6574 446f 6955 726c 2822  bibs.getDoiUrl("
-0003ec20: 6465 6622 2929 0a20 2020 2020 2020 2073  def")).        s
-0003ec30: 656c 662e 6173 7365 7274 5472 7565 280a  elf.assertTrue(.
-0003ec40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003ec50: 2e70 4244 422e 6269 6273 2e69 6e73 6572  .pBDB.bibs.inser
-0003ec60: 7446 726f 6d42 6962 7465 7828 0a20 2020  tFromBibtex(.   
-0003ec70: 2020 2020 2020 2020 2020 2020 2027 4061               '@a
-0003ec80: 7274 6963 6c65 7b64 6566 2c5c 6e61 7574  rticle{def,\naut
-0003ec90: 686f 7220 3d20 226d 6522 2c5c 6e74 6974  hor = "me",\ntit
-0003eca0: 6c65 203d 2022 6465 6622 2c7d 270a 2020  le = "def",}'.  
-0003ecb0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0003ecc0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0003ecd0: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
-0003ece0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0003ecf0: 7441 7278 6976 5572 6c28 2264 6566 2229  tArxivUrl("def")
-0003ed00: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0003ed10: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
-0003ed20: 7042 4442 2e62 6962 732e 6765 7444 6f69  pBDB.bibs.getDoi
-0003ed30: 5572 6c28 2264 6566 2229 290a 0a20 2020  Url("def"))..   
-0003ed40: 2064 6566 2074 6573 745f 696d 706f 7274   def test_import
-0003ed50: 4672 6f6d 4269 6228 7365 6c66 2c20 2a61  FromBib(self, *a
-0003ed60: 7267 7329 3a0a 2020 2020 2020 2020 7769  rgs):.        wi
-0003ed70: 7468 206f 7065 6e28 2274 6d70 6269 622e  th open("tmpbib.
-0003ed80: 6269 6222 2c20 2277 2229 2061 7320 663a  bib", "w") as f:
-0003ed90: 0a20 2020 2020 2020 2020 2020 2066 2e77  .            f.w
-0003eda0: 7269 7465 280a 2020 2020 2020 2020 2020  rite(.          
-0003edb0: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
-0003edc0: 6162 632c 5c6e 6175 7468 6f72 203d 2022  abc,\nauthor = "
-0003edd0: 6d65 222c 5c6e 7469 746c 6520 3d20 270a  me",\ntitle = '.
-0003ede0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003edf0: 2b20 2722 6162 6322 2c7d 4061 7274 6963  + '"abc",}@artic
-0003ee00: 6c65 7b64 6566 2c5c 6e61 7574 686f 7220  le{def,\nauthor 
-0003ee10: 3d20 226d 6522 2c5c 6e74 6974 6c65 203d  = "me",\ntitle =
-0003ee20: 2022 6465 6640 6768 6922 2c7d 270a 2020   "def@ghi",}'.  
-0003ee30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0003ee40: 2020 2020 7062 6d20 3d20 4d61 6769 634d      pbm = MagicM
-0003ee50: 6f63 6b28 290a 2020 2020 2020 2020 7062  ock().        pb
-0003ee60: 7620 3d20 4d61 6769 634d 6f63 6b28 290a  v = MagicMock().
-0003ee70: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0003ee80: 422e 6269 6273 2e69 6d70 6f72 7446 726f  B.bibs.importFro
-0003ee90: 6d42 6962 280a 2020 2020 2020 2020 2020  mBib(.          
-0003eea0: 2020 2274 6d70 6269 622e 6269 6222 2c20    "tmpbib.bib", 
-0003eeb0: 636f 6d70 6c65 7465 496e 666f 3d46 616c  completeInfo=Fal
-0003eec0: 7365 2c20 7062 4d61 783d 7062 6d2c 2070  se, pbMax=pbm, p
-0003eed0: 6256 616c 3d70 6276 0a20 2020 2020 2020  bVal=pbv.       
-0003eee0: 2029 0a20 2020 2020 2020 2070 626d 2e61   ).        pbm.a
-0003eef0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-0003ef00: 655f 7769 7468 2832 290a 2020 2020 2020  e_with(2).      
-0003ef10: 2020 7062 762e 6173 7365 7274 5f68 6173    pbv.assert_has
-0003ef20: 5f63 616c 6c73 285b 6361 6c6c 2831 292c  _calls([call(1),
-0003ef30: 2063 616c 6c28 3229 5d29 0a20 2020 2020   call(2)]).     
-0003ef40: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0003ef50: 7561 6c28 5b65 5b22 6269 626b 6579 225d  ual([e["bibkey"]
-0003ef60: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-0003ef70: 4244 422e 6269 6273 2e67 6574 416c 6c28  BDB.bibs.getAll(
-0003ef80: 295d 2c20 5b22 6162 6322 2c20 2264 6566  )], ["abc", "def
-0003ef90: 225d 290a 0a20 2020 2020 2020 2073 656c  "])..        sel
-0003efa0: 662e 7042 4442 2e75 6e64 6f28 7665 7262  f.pBDB.undo(verb
-0003efb0: 6f73 653d 3029 0a20 2020 2020 2020 2077  ose=0).        w
-0003efc0: 6974 6820 6f70 656e 2822 746d 7062 6962  ith open("tmpbib
-0003efd0: 2e62 6962 222c 2022 7722 2920 6173 2066  .bib", "w") as f
-0003efe0: 3a0a 2020 2020 2020 2020 2020 2020 662e  :.            f.
-0003eff0: 7772 6974 6528 0a20 2020 2020 2020 2020  write(.         
-0003f000: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
-0003f010: 7b61 6263 2c5c 6e61 7574 686f 7220 3d20  {abc,\nauthor = 
-0003f020: 226d 6522 2c5c 6e27 0a20 2020 2020 2020  "me",\n'.       
-0003f030: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
-0003f040: 6520 3d20 2261 6263 222c 5c6e 7d5c 6e40  e = "abc",\n}\n@
-0003f050: 6172 7469 636c 657b 6465 662c 5c6e 7d5c  article{def,\n}\
-0003f060: 6e27 0a20 2020 2020 2020 2020 2020 2029  n'.            )
-0003f070: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-0003f080: 4442 2e62 6962 732e 696d 706f 7274 4672  DB.bibs.importFr
-0003f090: 6f6d 4269 6228 2274 6d70 6269 622e 6269  omBib("tmpbib.bi
-0003f0a0: 6222 2c20 636f 6d70 6c65 7465 496e 666f  b", completeInfo
-0003f0b0: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-0003f0c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0003f0d0: 285b 655b 2262 6962 6b65 7922 5d20 666f  ([e["bibkey"] fo
-0003f0e0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-0003f0f0: 2e62 6962 732e 6765 7441 6c6c 2829 5d2c  .bibs.getAll()],
-0003f100: 205b 2261 6263 225d 290a 0a20 2020 2020   ["abc"])..     
-0003f110: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
-0003f120: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
-0003f130: 2020 2020 2077 6974 6820 6f70 656e 2822       with open("
-0003f140: 746d 7062 6962 2e62 6962 222c 2022 7722  tmpbib.bib", "w"
-0003f150: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-0003f160: 2020 2020 662e 7772 6974 6528 0a20 2020      f.write(.   
-0003f170: 2020 2020 2020 2020 2020 2020 2027 4061               '@a
-0003f180: 7274 6963 6c65 7b61 6263 2c5c 6e61 7574  rticle{abc,\naut
-0003f190: 686f 7220 3d20 226d 6522 2c5c 6e27 0a20  hor = "me",\n'. 
-0003f1a0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0003f1b0: 2027 7469 746c 6520 3d20 2261 6263 222c   'title = "abc",
-0003f1c0: 5c6e 7d5c 6e40 6172 7469 636c 657b 6465  \n}\n@article{de
-0003f1d0: 662c 5c6e 7d5c 6e27 0a20 2020 2020 2020  f,\n}\n'.       
-0003f1e0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-0003f1f0: 656c 662e 7042 4442 2e62 6962 732e 696d  elf.pBDB.bibs.im
-0003f200: 706f 7274 4672 6f6d 4269 6228 2274 6d70  portFromBib("tmp
-0003f210: 6269 622e 6269 6222 2c20 636f 6d70 6c65  bib.bib", comple
-0003f220: 7465 496e 666f 3d46 616c 7365 290a 2020  teInfo=False).  
-0003f230: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0003f240: 7445 7175 616c 285b 655b 2262 6962 6b65  tEqual([e["bibke
-0003f250: 7922 5d20 666f 7220 6520 696e 2073 656c  y"] for e in sel
-0003f260: 662e 7042 4442 2e62 6962 732e 6765 7441  f.pBDB.bibs.getA
-0003f270: 6c6c 2829 5d2c 205b 2261 6263 225d 290a  ll()], ["abc"]).
-0003f280: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-0003f290: 4442 2e75 6e64 6f28 7665 7262 6f73 653d  DB.undo(verbose=
-0003f2a0: 3029 0a20 2020 2020 2020 2077 6974 6820  0).        with 
-0003f2b0: 6f70 656e 2822 746d 7062 6962 2e62 6962  open("tmpbib.bib
-0003f2c0: 222c 2022 7722 2920 6173 2066 3a0a 2020  ", "w") as f:.  
-0003f2d0: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
-0003f2e0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-0003f2f0: 2020 2027 4061 7274 6963 6c65 7b61 6263     '@article{abc
-0003f300: 2c5c 6e61 7574 686f 7220 3d20 226d 6522  ,\nauthor = "me"
-0003f310: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
-0003f320: 2020 2020 202b 2022 6d6f 6e74 6820 3d20       + "month = 
-0003f330: 6a61 6e2c 5c6e 7d5c 6e40 6172 7469 636c  jan,\n}\n@articl
-0003f340: 657b 6465 662c 5c6e 7d5c 6e22 0a20 2020  e{def,\n}\n".   
-0003f350: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0003f360: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-0003f370: 732e 696d 706f 7274 4672 6f6d 4269 6228  s.importFromBib(
-0003f380: 2274 6d70 6269 622e 6269 6222 2c20 636f  "tmpbib.bib", co
-0003f390: 6d70 6c65 7465 496e 666f 3d46 616c 7365  mpleteInfo=False
-0003f3a0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0003f3b0: 7373 6572 7445 7175 616c 285b 655b 2262  ssertEqual([e["b
-0003f3c0: 6962 6b65 7922 5d20 666f 7220 6520 696e  ibkey"] for e in
-0003f3d0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0003f3e0: 6765 7441 6c6c 2829 5d2c 205b 2261 6263  getAll()], ["abc
-0003f3f0: 225d 290a 0a20 2020 2020 2020 2073 656c  "])..        sel
-0003f400: 662e 7042 4442 2e75 6e64 6f28 7665 7262  f.pBDB.undo(verb
-0003f410: 6f73 653d 3029 0a20 2020 2020 2020 2023  ose=0).        #
-0003f420: 2074 6573 7420 7769 7468 2063 6f6d 706c   test with compl
-0003f430: 6574 6549 6e66 6f0a 2020 2020 2020 2020  eteInfo.        
-0003f440: 7769 7468 206f 7065 6e28 2274 6d70 6269  with open("tmpbi
-0003f450: 622e 6269 6222 2c20 2277 2229 2061 7320  b.bib", "w") as 
-0003f460: 663a 0a20 2020 2020 2020 2020 2020 2066  f:.            f
-0003f470: 2e77 7269 7465 280a 2020 2020 2020 2020  .write(.        
-0003f480: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
-0003f490: 657b 4761 7269 617a 7a6f 3a32 3031 3572  e{Gariazzo:2015r
-0003f4a0: 7261 2c5c 6e61 7574 686f 7220 3d20 226d  ra,\nauthor = "m
-0003f4b0: 6522 2c5c 6e27 0a20 2020 2020 2020 2020  e",\n'.         
-0003f4c0: 2020 2020 2020 202b 2027 6172 7869 7620         + 'arxiv 
-0003f4d0: 3d20 2231 3530 372e 3038 3230 3422 2c5c  = "1507.08204",\
-0003f4e0: 6e7d 5c6e 4061 7274 6963 6c65 7b27 0a20  n}\n@article{'. 
-0003f4f0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0003f500: 2027 4761 7269 617a 7a6f 3a32 3031 3472   'Gariazzo:2014r
-0003f510: 7261 2c5c 6e61 7574 686f 723d 226d 6522  ra,\nauthor="me"
-0003f520: 2c5c 6e7d 5c6e 270a 2020 2020 2020 2020  ,\n}\n'.        
-0003f530: 2020 2020 290a 2020 2020 2020 2020 7769      ).        wi
-0003f540: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-0003f550: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0003f560: 6f2e 7765 6269 6d70 6f72 742e 6172 7869  o.webimport.arxi
-0003f570: 762e 5765 6253 6561 7263 682e 7265 7472  v.WebSearch.retr
-0003f580: 6965 7665 5572 6c41 6c6c 222c 0a20 2020  ieveUrlAll",.   
-0003f590: 2020 2020 2020 2020 2073 6964 655f 6566           side_ef
-0003f5a0: 6665 6374 3d5b 2822 6269 6274 6578 5f6e  fect=[("bibtex_n
-0003f5b0: 6f74 5f75 7365 6422 2c20 7b22 6162 7374  ot_used", {"abst
-0003f5c0: 7261 6374 223a 2022 736f 6d65 2066 616b  ract": "some fak
-0003f5d0: 6520 6162 7374 7261 6374 227d 295d 2c0a  e abstract"})],.
-0003f5e0: 2020 2020 2020 2020 2020 2020 6175 746f              auto
-0003f5f0: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
-0003f600: 2020 2029 2061 7320 5f72 6574 7269 6576     ) as _retriev
-0003f610: 652c 2070 6174 6368 280a 2020 2020 2020  e, patch(.      
-0003f620: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-0003f630: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
-0003f640: 6573 2e75 7064 6174 6549 6e73 7069 7265  es.updateInspire
-0003f650: 4944 222c 0a20 2020 2020 2020 2020 2020  ID",.           
-0003f660: 2073 6964 655f 6566 6665 6374 3d5b 2231   side_effect=["1
-0003f670: 3338 3535 3833 222c 2046 616c 7365 5d2c  385583", False],
-0003f680: 0a20 2020 2020 2020 2020 2020 2061 7574  .            aut
-0003f690: 6f73 7065 633d 5472 7565 2c0a 2020 2020  ospec=True,.    
-0003f6a0: 2020 2020 2920 6173 205f 696e 7370 6972      ) as _inspir
-0003f6b0: 6569 642c 2070 6174 6368 280a 2020 2020  eid, patch(.    
-0003f6c0: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-0003f6d0: 6c69 6f2e 7765 6269 6d70 6f72 742e 696e  lio.webimport.in
-0003f6e0: 7370 6972 652e 5765 6253 6561 7263 682e  spire.WebSearch.
-0003f6f0: 7265 7472 6965 7665 4f41 4944 6174 6122  retrieveOAIData"
-0003f700: 2c0a 2020 2020 2020 2020 2020 2020 7369  ,.            si
-0003f710: 6465 5f65 6666 6563 743d 5b0a 2020 2020  de_effect=[.    
-0003f720: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-0003f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f740: 2020 2264 6f69 223a 2022 3130 2e31 3038    "doi": "10.108
-0003f750: 382f 3039 3534 2d33 3839 392f 3433 2f33  8/0954-3899/43/3
-0003f760: 2f30 3333 3030 3122 2c0a 2020 2020 2020  /033001",.      
-0003f770: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-0003f780: 7362 6e22 3a20 4e6f 6e65 2c0a 2020 2020  sbn": None,.    
-0003f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7a0: 2261 6473 223a 2022 3230 3135 4a50 6847  "ads": "2015JPhG
-0003f7b0: 2e2e 2e34 3363 3330 3031 4722 2c0a 2020  ...43c3001G",.  
-0003f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7d0: 2020 2270 7562 6461 7465 223a 2022 3230    "pubdate": "20
-0003f7e0: 3136 2d30 312d 3133 222c 0a20 2020 2020  16-01-13",.     
-0003f7f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003f800: 6669 7273 7464 6174 6522 3a20 2232 3031  firstdate": "201
-0003f810: 352d 3037 2d32 3922 2c0a 2020 2020 2020  5-07-29",.      
-0003f820: 2020 2020 2020 2020 2020 2020 2020 226a                "j
-0003f830: 6f75 726e 616c 223a 2022 4a2e 5068 7973  ournal": "J.Phys
-0003f840: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-0003f850: 2020 2020 2020 2020 2261 7278 6976 223a          "arxiv":
-0003f860: 2022 3135 3037 2e30 3832 3034 222c 0a20   "1507.08204",. 
-0003f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f880: 2020 2022 6964 223a 2022 3133 3835 3538     "id": "138558
-0003f890: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-0003f8a0: 2020 2020 2020 2020 2276 6f6c 756d 6522          "volume"
-0003f8b0: 3a20 2247 3433 222c 0a20 2020 2020 2020  : "G43",.       
-0003f8c0: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
-0003f8d0: 6274 6578 223a 204e 6f6e 652c 0a20 2020  btex": None,.   
-0003f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8f0: 2022 7965 6172 223a 2022 3230 3136 222c   "year": "2016",
-0003f900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f910: 2020 2020 2022 6f6c 646b 6579 7322 3a20       "oldkeys": 
-0003f920: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-0003f930: 2020 2020 2020 2020 2262 6962 6b65 7922          "bibkey"
-0003f940: 3a20 2247 6172 6961 7a7a 6f3a 3230 3135  : "Gariazzo:2015
-0003f950: 7272 6122 2c0a 2020 2020 2020 2020 2020  rra",.          
-0003f960: 2020 2020 2020 2020 2020 2270 6167 6573            "pages
-0003f970: 223a 2022 3033 3330 3031 222c 0a20 2020  ": "033001",.   
-0003f980: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-0003f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f9a0: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
-0003f9b0: 5d2c 0a20 2020 2020 2020 2020 2020 2061  ],.            a
-0003f9c0: 7574 6f73 7065 633d 5472 7565 2c0a 2020  utospec=True,.  
-0003f9d0: 2020 2020 2020 2920 6173 205f 6f61 692c        ) as _oai,
-0003f9e0: 2070 6174 6368 2e64 6963 7428 0a20 2020   patch.dict(.   
-0003f9f0: 2020 2020 2020 2020 2070 6243 6f6e 6669           pbConfi
-0003fa00: 672e 7061 7261 6d73 2c0a 2020 2020 2020  g.params,.      
-0003fa10: 2020 2020 2020 7b22 6665 7463 6841 6273        {"fetchAbs
-0003fa20: 7472 6163 7422 3a20 5472 7565 2c20 2264  tract": True, "d
-0003fa30: 6566 6175 6c74 4361 7465 676f 7269 6573  efaultCategories
-0003fa40: 223a 2031 7d2c 0a20 2020 2020 2020 2020  ": 1},.         
-0003fa50: 2020 2063 6c65 6172 3d46 616c 7365 2c0a     clear=False,.
-0003fa60: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-0003fa70: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0003fa80: 2e62 6962 732e 696d 706f 7274 4672 6f6d  .bibs.importFrom
-0003fa90: 4269 6228 2274 6d70 6269 622e 6269 6222  Bib("tmpbib.bib"
-0003faa0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0003fab0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0003fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fad0: 5b65 5b22 6269 626b 6579 225d 2066 6f72  [e["bibkey"] for
-0003fae0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-0003faf0: 6269 6273 2e67 6574 416c 6c28 295d 2c0a  bibs.getAll()],.
-0003fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb10: 5b22 4761 7269 617a 7a6f 3a32 3031 3572  ["Gariazzo:2015r
-0003fb20: 7261 222c 2022 4761 7269 617a 7a6f 3a32  ra", "Gariazzo:2
-0003fb30: 3031 3472 7261 225d 2c0a 2020 2020 2020  014rra"],.      
-0003fb40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0003fb50: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0003fb60: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-0003fb70: 2020 2020 2020 5b65 5b22 696e 7370 6972        [e["inspir
-0003fb80: 6522 5d20 666f 7220 6520 696e 2073 656c  e"] for e in sel
-0003fb90: 662e 7042 4442 2e62 6962 732e 6765 7441  f.pBDB.bibs.getA
-0003fba0: 6c6c 2829 5d2c 205b 2231 3338 3535 3833  ll()], ["1385583
-0003fbb0: 222c 204e 6f6e 655d 0a20 2020 2020 2020  ", None].       
-0003fbc0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0003fbd0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0003fbe0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-0003fbf0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0003fc00: 2020 2020 2020 2020 2020 206c 656e 2865             len(e
-0003fc10: 5b22 6162 7374 7261 6374 225d 2920 3e20  ["abstract"]) > 
-0003fc20: 3130 2069 6620 655b 2261 6273 7472 6163  10 if e["abstrac
-0003fc30: 7422 5d20 6973 206e 6f74 204e 6f6e 6520  t"] is not None 
-0003fc40: 656c 7365 2030 0a20 2020 2020 2020 2020  else 0.         
-0003fc50: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-0003fc60: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
-0003fc70: 6273 2e67 6574 416c 6c28 290a 2020 2020  bs.getAll().    
-0003fc80: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-0003fc90: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0003fca0: 5472 7565 2c20 4661 6c73 655d 2c0a 2020  True, False],.  
-0003fcb0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0003fcc0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0003fcd0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0003fce0: 2020 2020 2020 2020 2020 5b65 5b22 6669            [e["fi
-0003fcf0: 7273 7464 6174 6522 5d20 666f 7220 6520  rstdate"] for e 
-0003fd00: 696e 2073 656c 662e 7042 4442 2e62 6962  in self.pBDB.bib
-0003fd10: 732e 6765 7441 6c6c 2829 5d2c 0a20 2020  s.getAll()],.   
-0003fd20: 2020 2020 2020 2020 2020 2020 205b 2232               ["2
-0003fd30: 3031 352d 3037 2d32 3922 2c20 6461 7465  015-07-29", date
-0003fd40: 7469 6d65 2e64 6174 652e 746f 6461 7928  time.date.today(
-0003fd50: 292e 7374 7266 7469 6d65 2822 2559 2d25  ).strftime("%Y-%
-0003fd60: 6d2d 2564 2229 5d2c 0a20 2020 2020 2020  m-%d")],.       
-0003fd70: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0003fd80: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0003fd90: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-0003fda0: 2020 2020 205b 655b 2262 6962 6b65 7922       [e["bibkey"
-0003fdb0: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
-0003fdc0: 7042 4442 2e62 6962 732e 6765 7442 7943  pBDB.bibs.getByC
-0003fdd0: 6174 2831 295d 2c0a 2020 2020 2020 2020  at(1)],.        
-0003fde0: 2020 2020 2020 2020 5b22 4761 7269 617a          ["Gariaz
-0003fdf0: 7a6f 3a32 3031 3572 7261 222c 2022 4761  zo:2015rra", "Ga
-0003fe00: 7269 617a 7a6f 3a32 3031 3472 7261 225d  riazzo:2014rra"]
-0003fe10: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0003fe20: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-0003fe30: 4442 2e75 6e64 6f28 7665 7262 6f73 653d  DB.undo(verbose=
-0003fe40: 3029 0a20 2020 2020 2020 2077 6974 6820  0).        with 
-0003fe50: 7061 7463 682e 6469 6374 280a 2020 2020  patch.dict(.    
-0003fe60: 2020 2020 2020 2020 7062 436f 6e66 6967          pbConfig
-0003fe70: 2e70 6172 616d 732c 0a20 2020 2020 2020  .params,.       
-0003fe80: 2020 2020 207b 2266 6574 6368 4162 7374       {"fetchAbst
-0003fe90: 7261 6374 223a 2046 616c 7365 2c20 2264  ract": False, "d
-0003fea0: 6566 6175 6c74 4361 7465 676f 7269 6573  efaultCategories
-0003feb0: 223a 207b 2261 6222 7d7d 2c0a 2020 2020  ": {"ab"}},.    
-0003fec0: 2020 2020 2020 2020 636c 6561 723d 4661          clear=Fa
-0003fed0: 6c73 652c 0a20 2020 2020 2020 2029 3a0a  lse,.        ):.
-0003fee0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003fef0: 2e70 4244 422e 6269 6273 2e69 6d70 6f72  .pBDB.bibs.impor
-0003ff00: 7446 726f 6d42 6962 2822 746d 7062 6962  tFromBib("tmpbib
-0003ff10: 2e62 6962 222c 2063 6f6d 706c 6574 6549  .bib", completeI
-0003ff20: 6e66 6f3d 4661 6c73 6529 0a20 2020 2020  nfo=False).     
-0003ff30: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0003ff40: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
-0003ff50: 722e 696e 666f 2229 2061 7320 5f69 3a0a  r.info") as _i:.
-0003ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ff70: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
-0003ff80: 6d70 6f72 7446 726f 6d42 6962 2822 746d  mportFromBib("tm
-0003ff90: 7062 6962 2e62 6962 222c 2063 6f6d 706c  pbib.bib", compl
-0003ffa0: 6574 6549 6e66 6f3d 4661 6c73 6529 0a20  eteInfo=False). 
-0003ffb0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003ffc0: 656c 662e 6173 7365 7274 5472 7565 280a  elf.assertTrue(.
-0003ffd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ffe0: 2020 2020 616e 7928 0a20 2020 2020 2020      any(.       
-0003fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040000: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00040010: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00040020: 3220 656e 7472 6965 7320 7072 6f63 6573  2 entries proces
-00040030: 7365 642c 206f 6620 7768 6963 6820 3220  sed, of which 2 
-00040040: 6578 6973 7469 6e67 2220 696e 2063 0a20  existing" in c. 
-00040050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040060: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-00040070: 2069 6e20 5f69 2e63 616c 6c5f 6172 6773   in _i.call_args
-00040080: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-00040090: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-000400a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000400b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000400c0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-000400d0: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
-000400e0: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
-000400f0: 2020 2020 2020 2020 2077 6974 6820 7061           with pa
-00040100: 7463 6828 226c 6f67 6769 6e67 2e4c 6f67  tch("logging.Log
-00040110: 6765 722e 6578 6365 7074 696f 6e22 2920  ger.exception") 
-00040120: 6173 205f 653a 0a20 2020 2020 2020 2020  as _e:.         
-00040130: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00040140: 2e62 6962 732e 696d 706f 7274 4672 6f6d  .bibs.importFrom
-00040150: 4269 6228 2274 6d70 6269 622e 6269 6222  Bib("tmpbib.bib"
-00040160: 2c20 636f 6d70 6c65 7465 496e 666f 3d46  , completeInfo=F
-00040170: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-00040180: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00040190: 7449 6e28 0a20 2020 2020 2020 2020 2020  tIn(.           
-000401a0: 2020 2020 2020 2020 2022 4572 726f 7220           "Error 
-000401b0: 6269 6e64 696e 6720 7061 7261 6d65 7465  binding paramete
-000401c0: 7220 3a69 6443 6174 202d 2070 726f 6261  r :idCat - proba
-000401d0: 626c 7920 756e 7375 7070 6f72 7465 6420  bly unsupported 
-000401e0: 7479 7065 2e22 2c0a 2020 2020 2020 2020  type.",.        
-000401f0: 2020 2020 2020 2020 2020 2020 5f65 2e63              _e.c
-00040200: 616c 6c5f 6172 6773 5b30 5d5b 305d 2c0a  all_args[0][0],.
-00040210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040220: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00040230: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
-00040240: 6469 6374 2865 2920 666f 7220 6520 696e  dict(e) for e in
-00040250: 2073 656c 662e 7042 4442 2e63 6174 4269   self.pBDB.catBi
-00040260: 622e 6765 7441 6c6c 2829 5d2c 205b 5d29  b.getAll()], [])
-00040270: 0a0a 2020 2020 2020 2020 2020 2020 6f73  ..            os
-00040280: 2e72 656d 6f76 6528 2274 6d70 6269 622e  .remove("tmpbib.
-00040290: 6269 6222 290a 0a20 2020 2064 6566 2074  bib")..    def t
-000402a0: 6573 745f 696d 706f 7274 4f6e 6546 726f  est_importOneFro
-000402b0: 6d42 6962 7465 7844 6963 7428 7365 6c66  mBibtexDict(self
-000402c0: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
-000402d0: 2020 2222 2274 6573 7420 696d 706f 7274    """test import
-000402e0: 4f6e 6546 726f 6d42 6962 7465 7844 6963  OneFromBibtexDic
-000402f0: 7422 2222 0a20 2020 2020 2020 2064 6220  t""".        db 
-00040300: 3d20 6269 6274 6578 7061 7273 6572 2e62  = bibtexparser.b
-00040310: 6962 6461 7461 6261 7365 2e42 6962 4461  ibdatabase.BibDa
-00040320: 7461 6261 7365 2829 0a20 2020 2020 2020  tabase().       
-00040330: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00040340: 6c61 7374 496e 7365 7274 6564 203d 205b  lastInserted = [
-00040350: 5d0a 2020 2020 2020 2020 7769 7468 2073  ].        with s
-00040360: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
-00040370: 284b 6579 4572 726f 7229 3a0a 2020 2020  (KeyError):.    
-00040380: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00040390: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-000403a0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-000403b0: 4244 422e 6269 6273 2e69 6d70 6f72 744f  BDB.bibs.importO
-000403c0: 6e65 4672 6f6d 4269 6274 6578 4469 6374  neFromBibtexDict
-000403d0: 2830 2c20 7b7d 2c20 6462 292c 0a20 2020  (0, {}, db),.   
-000403e0: 2020 2020 2020 2020 2020 2020 2028 5b5d               ([]
-000403f0: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
-00040400: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
-00040410: 6820 7061 7463 6828 0a20 2020 2020 2020  h patch(.       
-00040420: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-00040430: 2e64 6174 6162 6173 652e 456e 7472 6965  .database.Entrie
-00040440: 732e 6765 7442 7942 6962 6b65 7922 2c20  s.getByBibkey", 
-00040450: 7265 7475 726e 5f76 616c 7565 3d5b 7b22  return_value=[{"
-00040460: 6122 3a20 2262 227d 5d0a 2020 2020 2020  a": "b"}].      
-00040470: 2020 2920 6173 205f 673a 0a20 2020 2020    ) as _g:.     
-00040480: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00040490: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-000404a0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-000404b0: 4442 2e62 6962 732e 696d 706f 7274 4f6e  DB.bibs.importOn
-000404c0: 6546 726f 6d42 6962 7465 7844 6963 7428  eFromBibtexDict(
-000404d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000404e0: 2020 2020 2031 2c0a 2020 2020 2020 2020       1,.        
-000404f0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00040500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040510: 2020 2020 2020 2245 4e54 5259 5459 5045        "ENTRYTYPE
-00040520: 223a 2022 6172 7469 636c 6522 2c0a 2020  ": "article",.  
+0003d340: 2020 2020 2020 2279 6561 7222 3a20 2232        "year": "2
+0003d350: 3031 3622 2c0a 2020 2020 2020 2020 2020  016",.          
+0003d360: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+0003d370: 4422 3a20 2247 6172 6961 7a7a 6f3a 3230  D": "Gariazzo:20
+0003d380: 3135 7272 6122 2c0a 2020 2020 2020 2020  15rra",.        
+0003d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d3a0: 2270 6167 6573 223a 2022 3033 3330 3031  "pages": "033001
+0003d3b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003d3c0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+0003d3d0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+0003d3e0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0003d3f0: 6465 6620 7465 7374 5f67 6574 456e 7472  def test_getEntr
+0003d400: 6965 7349 664e 6f6e 6528 7365 6c66 2c20  iesIfNone(self, 
+0003d410: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
+0003d420: 2222 2274 6573 7420 6765 7445 6e74 7269  """test getEntri
+0003d430: 6573 4966 4e6f 6e65 2222 220a 2020 2020  esIfNone""".    
+0003d440: 2020 2020 7365 6c66 2e69 6e73 6572 745f      self.insert_
+0003d450: 7468 7265 6528 290a 2020 2020 2020 2020  three().        
+0003d460: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0003d470: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0003d480: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+0003d490: 456e 7472 6965 7349 664e 6f6e 6528 292c  EntriesIfNone(),
+0003d4a0: 2028 7365 6c66 2e70 4244 422e 6269 6273   (self.pBDB.bibs
+0003d4b0: 2e66 6574 6368 4375 7273 2c20 3329 0a20  .fetchCurs, 3). 
+0003d4c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0003d4d0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0003d4e0: 6c28 6c65 6e28 5b65 2066 6f72 2065 2069  l(len([e for e i
+0003d4f0: 6e20 7365 6c66 2e70 4244 422e 6269 6273  n self.pBDB.bibs
+0003d500: 2e66 6574 6368 4375 7273 5d29 2c20 3329  .fetchCurs]), 3)
+0003d510: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0003d520: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0003d530: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0003d540: 2e62 6962 732e 6765 7445 6e74 7269 6573  .bibs.getEntries
+0003d550: 4966 4e6f 6e65 2873 7461 7274 4672 6f6d  IfNone(startFrom
+0003d560: 3d32 292c 2028 7365 6c66 2e70 4244 422e  =2), (self.pBDB.
+0003d570: 6269 6273 2e66 6574 6368 4375 7273 2c20  bibs.fetchCurs, 
+0003d580: 3129 0a20 2020 2020 2020 2029 0a20 2020  1).        ).   
+0003d590: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0003d5a0: 4571 7561 6c28 6c65 6e28 5b65 2066 6f72  Equal(len([e for
+0003d5b0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
+0003d5c0: 6269 6273 2e66 6574 6368 4375 7273 5d29  bibs.fetchCurs])
+0003d5d0: 2c20 3129 0a0a 2020 2020 6465 6620 7465  , 1)..    def te
+0003d5e0: 7374 5f67 6574 4669 656c 6428 7365 6c66  st_getField(self
+0003d5f0: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
+0003d600: 2020 2222 2274 6573 7420 6765 7446 6965    """test getFie
+0003d610: 6c64 2222 220a 2020 2020 2020 2020 6461  ld""".        da
+0003d620: 7461 203d 2073 656c 662e 7042 4442 2e62  ta = self.pBDB.b
+0003d630: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
+0003d640: 7428 0a20 2020 2020 2020 2020 2020 2027  t(.            '
+0003d650: 4061 7274 6963 6c65 7b61 6263 2c5c 6e61  @article{abc,\na
+0003d660: 7574 686f 7220 3d20 226d 6522 2c5c 6e74  uthor = "me",\nt
+0003d670: 6974 6c65 203d 2022 6162 6322 2c7d 272c  itle = "abc",}',
+0003d680: 0a20 2020 2020 2020 2020 2020 2061 7278  .            arx
+0003d690: 6976 3d22 6162 6322 2c0a 2020 2020 2020  iv="abc",.      
+0003d6a0: 2020 2020 2020 646f 693d 2231 222c 0a20        doi="1",. 
+0003d6b0: 2020 2020 2020 2020 2020 2069 7362 6e3d             isbn=
+0003d6c0: 392c 0a20 2020 2020 2020 2029 0a20 2020  9,.        ).   
+0003d6d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0003d6e0: 5472 7565 2873 656c 662e 7042 4442 2e62  True(self.pBDB.b
+0003d6f0: 6962 732e 696e 7365 7274 2864 6174 6129  ibs.insert(data)
+0003d700: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0003d710: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+0003d720: 7042 4442 2e62 6962 732e 6765 7446 6965  pBDB.bibs.getFie
+0003d730: 6c64 2822 6162 6322 2c20 2264 6f69 2229  ld("abc", "doi")
+0003d740: 2c20 2231 2229 0a20 2020 2020 2020 2073  , "1").        s
+0003d750: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0003d760: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+0003d770: 6574 4669 656c 6428 2261 6263 222c 2022  etField("abc", "
+0003d780: 6172 7869 7622 292c 2022 6162 6322 290a  arxiv"), "abc").
+0003d790: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0003d7a0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+0003d7b0: 4442 2e62 6962 732e 6765 7446 6965 6c64  DB.bibs.getField
+0003d7c0: 2822 6162 6322 2c20 2269 7362 6e22 292c  ("abc", "isbn"),
+0003d7d0: 2022 3922 290a 2020 2020 2020 2020 7365   "9").        se
+0003d7e0: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
+0003d7f0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+0003d800: 7446 6965 6c64 2822 6465 6622 2c20 2269  tField("def", "i
+0003d810: 7362 6e22 2929 0a20 2020 2020 2020 2077  sbn")).        w
+0003d820: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
+0003d830: 6e67 2e4c 6f67 6765 722e 7761 726e 696e  ng.Logger.warnin
+0003d840: 6722 2920 6173 205f 693a 0a20 2020 2020  g") as _i:.     
+0003d850: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0003d860: 2e62 6962 732e 6765 7446 6965 6c64 2822  .bibs.getField("
+0003d870: 6465 6622 2c20 2269 7362 6e22 290a 2020  def", "isbn").  
+0003d880: 2020 2020 2020 2020 2020 5f69 2e61 7373            _i.ass
+0003d890: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+0003d8a0: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
+0003d8b0: 2020 2020 2020 2245 7272 6f72 2069 6e20        "Error in 
+0003d8c0: 6765 7446 6965 6c64 2827 6465 6627 2c20  getField('def', 
+0003d8d0: 2769 7362 6e27 293a 206e 6f20 656c 656d  'isbn'): no elem
+0003d8e0: 656e 7420 666f 756e 643f 220a 2020 2020  ent found?".    
+0003d8f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0003d900: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
+0003d910: 7365 2873 656c 662e 7042 4442 2e62 6962  se(self.pBDB.bib
+0003d920: 732e 6765 7446 6965 6c64 2822 6162 6322  s.getField("abc"
+0003d930: 2c20 2264 6566 2229 290a 2020 2020 2020  , "def")).      
+0003d940: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
+0003d950: 6767 696e 672e 4c6f 6767 6572 2e77 6172  gging.Logger.war
+0003d960: 6e69 6e67 2229 2061 7320 5f69 3a0a 2020  ning") as _i:.  
+0003d970: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0003d980: 4244 422e 6269 6273 2e67 6574 4669 656c  BDB.bibs.getFiel
+0003d990: 6428 2261 6263 222c 2022 6465 6622 290a  d("abc", "def").
+0003d9a0: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
+0003d9b0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+0003d9c0: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
+0003d9d0: 2020 2020 2020 2020 2245 7272 6f72 2069          "Error i
+0003d9e0: 6e20 6765 7446 6965 6c64 2827 6162 6327  n getField('abc'
+0003d9f0: 2c20 2764 6566 2729 3a20 7468 6520 6669  , 'def'): the fi
+0003da00: 656c 6420 6973 206d 6973 7369 6e67 3f22  eld is missing?"
+0003da10: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0003da20: 2020 2020 4075 6e69 7474 6573 742e 736b      @unittest.sk
+0003da30: 6970 4966 2873 6b69 7054 6573 7473 5365  ipIf(skipTestsSe
+0003da40: 7474 696e 6773 2e6f 6e6c 696e 652c 2022  ttings.online, "
+0003da50: 4f6e 6c69 6e65 2074 6573 7473 2229 0a20  Online tests"). 
+0003da60: 2020 2040 7061 7463 682e 6469 6374 2870     @patch.dict(p
+0003da70: 6243 6f6e 6669 672e 7061 7261 6d73 2c20  bConfig.params, 
+0003da80: 7b22 6d61 7841 7574 686f 7253 6176 6522  {"maxAuthorSave"
+0003da90: 3a20 357d 2c20 636c 6561 723d 4661 6c73  : 5}, clear=Fals
+0003daa0: 6529 0a20 2020 2064 6566 2074 6573 745f  e).    def test_
+0003dab0: 6765 7446 6965 6c64 7346 726f 6d41 7278  getFieldsFromArx
+0003dac0: 6976 2873 656c 662c 202a 6172 6773 293a  iv(self, *args):
+0003dad0: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
+0003dae0: 7320 666f 7220 6765 7446 6965 6c64 7346  s for getFieldsF
+0003daf0: 726f 6d41 7278 6976 2028 6f6e 6c69 6e65  romArxiv (online
+0003db00: 2922 2222 0a20 2020 2020 2020 2073 656c  )""".        sel
+0003db10: 662e 7042 4442 2e62 6962 732e 696e 7365  f.pBDB.bibs.inse
+0003db20: 7274 4672 6f6d 4269 6274 6578 280a 2020  rtFromBibtex(.  
+0003db30: 2020 2020 2020 2020 2020 2740 6172 7469            '@arti
+0003db40: 636c 657b 4761 7269 617a 7a6f 3a32 3031  cle{Gariazzo:201
+0003db50: 3572 7261 2c5c 6e61 7278 6976 3d22 3135  5rra,\narxiv="15
+0003db60: 3037 2e30 3832 3034 225c 6e7d 270a 2020  07.08204"\n}'.  
+0003db70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0003db80: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
+0003db90: 6e73 6572 7446 726f 6d42 6962 7465 7828  nsertFromBibtex(
+0003dba0: 2740 6172 7469 636c 657b 4164 653a 3230  '@article{Ade:20
+0003dbb0: 3133 7a75 762c 5c6e 6172 7869 763d 2231  13zuv,\narxiv="1
+0003dbc0: 3330 332e 3530 3736 225c 6e7d 2729 0a20  303.5076"\n}'). 
+0003dbd0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0003dbe0: 7274 4e6f 7449 6e28 2241 6768 616e 696d  rtNotIn("Aghanim
+0003dbf0: 222c 2073 656c 662e 7042 4442 2e62 6962  ", self.pBDB.bib
+0003dc00: 732e 6765 7446 6965 6c64 2822 4164 653a  s.getField("Ade:
+0003dc10: 3230 3133 7a75 7622 2c20 2262 6962 7465  2013zuv", "bibte
+0003dc20: 7822 2929 0a20 2020 2020 2020 2073 656c  x")).        sel
+0003dc30: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
+0003dc40: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+0003dc50: 4669 656c 6473 4672 6f6d 4172 7869 7628  FieldsFromArxiv(
+0003dc60: 2261 6263 6422 2c20 2261 7574 686f 7273  "abcd", "authors
+0003dc70: 2229 290a 2020 2020 2020 2020 7365 6c66  ")).        self
+0003dc80: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+0003dc90: 2e70 4244 422e 6269 6273 2e67 6574 4669  .pBDB.bibs.getFi
+0003dca0: 656c 6473 4672 6f6d 4172 7869 7628 2241  eldsFromArxiv("A
+0003dcb0: 6465 3a32 3031 337a 7576 222c 2022 6175  de:2013zuv", "au
+0003dcc0: 7468 6f72 7322 2929 0a20 2020 2020 2020  thors")).       
+0003dcd0: 2073 656c 662e 6173 7365 7274 496e 2822   self.assertIn("
+0003dce0: 4167 6861 6e69 6d22 2c20 7365 6c66 2e70  Aghanim", self.p
+0003dcf0: 4244 422e 6269 6273 2e67 6574 4669 656c  BDB.bibs.getFiel
+0003dd00: 6428 2241 6465 3a32 3031 337a 7576 222c  d("Ade:2013zuv",
+0003dd10: 2022 6269 6274 6578 2229 290a 2020 2020   "bibtex")).    
+0003dd20: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0003dd30: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+0003dd40: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0003dd50: 2e67 6574 4669 656c 6473 4672 6f6d 4172  .getFieldsFromAr
+0003dd60: 7869 7628 0a20 2020 2020 2020 2020 2020  xiv(.           
+0003dd70: 2020 2020 205b 2247 6172 6961 7a7a 6f3a       ["Gariazzo:
+0003dd80: 3230 3135 7272 6122 2c20 2241 6465 3a32  2015rra", "Ade:2
+0003dd90: 3031 337a 7576 225d 2c20 2270 7269 6d61  013zuv"], "prima
+0003dda0: 7279 636c 6173 7322 0a20 2020 2020 2020  ryclass".       
+0003ddb0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+0003ddc0: 2020 2020 285b 2247 6172 6961 7a7a 6f3a      (["Gariazzo:
+0003ddd0: 3230 3135 7272 6122 2c20 2241 6465 3a32  2015rra", "Ade:2
+0003dde0: 3031 337a 7576 225d 2c20 5b5d 292c 0a20  013zuv"], []),. 
+0003ddf0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0003de00: 2070 626d 203d 204d 6167 6963 4d6f 636b   pbm = MagicMock
+0003de10: 2829 0a20 2020 2020 2020 2070 6276 203d  ().        pbv =
+0003de20: 204d 6167 6963 4d6f 636b 2829 0a20 2020   MagicMock().   
+0003de30: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0003de40: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+0003de50: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0003de60: 732e 6765 7446 6965 6c64 7346 726f 6d41  s.getFieldsFromA
+0003de70: 7278 6976 280a 2020 2020 2020 2020 2020  rxiv(.          
+0003de80: 2020 2020 2020 5b22 4761 7269 617a 7a6f        ["Gariazzo
+0003de90: 3a32 3031 3572 7261 222c 2022 4164 653a  :2015rra", "Ade:
+0003dea0: 3230 3133 7a75 7622 5d2c 0a20 2020 2020  2013zuv"],.     
+0003deb0: 2020 2020 2020 2020 2020 2022 7072 696d             "prim
+0003dec0: 6172 7963 6c61 7373 222c 0a20 2020 2020  aryclass",.     
+0003ded0: 2020 2020 2020 2020 2020 2070 624d 6178             pbMax
+0003dee0: 3d70 626d 2c0a 2020 2020 2020 2020 2020  =pbm,.          
+0003def0: 2020 2020 2020 7062 5661 6c3d 7062 762c        pbVal=pbv,
+0003df00: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+0003df10: 2020 2020 2020 2020 2020 2020 285b 2247              (["G
+0003df20: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
+0003df30: 2c20 2241 6465 3a32 3031 337a 7576 225d  , "Ade:2013zuv"]
+0003df40: 2c20 5b5d 292c 0a20 2020 2020 2020 2029  , []),.        )
+0003df50: 0a20 2020 2020 2020 2070 626d 2e61 7373  .        pbm.ass
+0003df60: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+0003df70: 7769 7468 2832 290a 2020 2020 2020 2020  with(2).        
+0003df80: 7062 762e 6173 7365 7274 5f68 6173 5f63  pbv.assert_has_c
+0003df90: 616c 6c73 285b 6361 6c6c 2831 292c 2063  alls([call(1), c
+0003dfa0: 616c 6c28 3229 5d29 0a0a 2020 2020 2020  all(2)])..      
+0003dfb0: 2020 7365 6c66 2e61 7373 6572 7449 6e28    self.assertIn(
+0003dfc0: 2261 7374 726f 2d70 6822 2c20 7365 6c66  "astro-ph", self
+0003dfd0: 2e70 4244 422e 6269 6273 2e67 6574 4669  .pBDB.bibs.getFi
+0003dfe0: 656c 6428 2241 6465 3a32 3031 337a 7576  eld("Ade:2013zuv
+0003dff0: 222c 2022 6269 6274 6578 2229 290a 2020  ", "bibtex")).  
+0003e000: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0003e010: 7449 6e28 2268 6570 2d70 6822 2c20 7365  tIn("hep-ph", se
+0003e020: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+0003e030: 4669 656c 6428 2247 6172 6961 7a7a 6f3a  Field("Gariazzo:
+0003e040: 3230 3135 7272 6122 2c20 2262 6962 7465  2015rra", "bibte
+0003e050: 7822 2929 0a0a 2020 2020 6465 6620 7465  x"))..    def te
+0003e060: 7374 5f67 6574 496e 7370 6972 6549 444c  st_getInspireIDL
+0003e070: 6973 7428 7365 6c66 2c20 2a61 7267 7329  ist(self, *args)
+0003e080: 3a0a 2020 2020 2020 2020 2222 2274 6573  :.        """tes
+0003e090: 7420 6765 7449 6e73 7069 7265 4944 4c69  t getInspireIDLi
+0003e0a0: 7374 2222 220a 2020 2020 2020 2020 7062  st""".        pb
+0003e0b0: 7620 3d20 4d61 6769 634d 6f63 6b28 290a  v = MagicMock().
+0003e0c0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0003e0d0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0003e0e0: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0003e0f0: 6261 7365 2e45 6e74 7269 6573 2e63 6865  base.Entries.che
+0003e100: 636b 4e65 6564 7355 7064 6174 6522 2c0a  ckNeedsUpdate",.
+0003e110: 2020 2020 2020 2020 2020 2020 7369 6465              side
+0003e120: 5f65 6666 6563 743d 5b54 7275 652c 2054  _effect=[True, T
+0003e130: 7275 652c 2046 616c 7365 2c20 5472 7565  rue, False, True
+0003e140: 5d2c 0a20 2020 2020 2020 2029 2061 7320  ],.        ) as 
+0003e150: 5f63 6e75 3a0a 2020 2020 2020 2020 2020  _cnu:.          
+0003e160: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0003e170: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0003e180: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0003e190: 6273 2e67 6574 496e 7370 6972 6549 444c  bs.getInspireIDL
+0003e1a0: 6973 7428 0a20 2020 2020 2020 2020 2020  ist(.           
+0003e1b0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
+0003e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e1d0: 2020 207b 2262 6962 6b65 7922 3a20 2261     {"bibkey": "a
+0003e1e0: 222c 2022 696e 7370 6972 6522 3a20 2231  ", "inspire": "1
+0003e1f0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
+0003e200: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
+0003e210: 626b 6579 223a 2022 6222 2c20 2269 6e73  bkey": "b", "ins
+0003e220: 7069 7265 223a 2022 3222 7d2c 0a20 2020  pire": "2"},.   
+0003e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e240: 2020 2020 207b 2262 6962 6b65 7922 3a20       {"bibkey": 
+0003e250: 2263 222c 2022 696e 7370 6972 6522 3a20  "c", "inspire": 
+0003e260: 2233 227d 2c0a 2020 2020 2020 2020 2020  "3"},.          
+0003e270: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+0003e280: 6269 626b 6579 223a 2022 6422 2c20 2269  bibkey": "d", "i
+0003e290: 6e73 7069 7265 223a 2022 3422 7d2c 0a20  nspire": "4"},. 
+0003e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e2b0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+0003e2c0: 2020 2020 2020 2020 2020 342c 0a20 2020            4,.   
+0003e2d0: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
+0003e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e2f0: 285b 2231 222c 2022 3222 2c20 2234 225d  (["1", "2", "4"]
+0003e300: 2c20 3329 2c0a 2020 2020 2020 2020 2020  , 3),.          
+0003e310: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0003e320: 5f63 6e75 2e61 7373 6572 745f 616e 795f  _cnu.assert_any_
+0003e330: 6361 6c6c 287b 2262 6962 6b65 7922 3a20  call({"bibkey": 
+0003e340: 2261 222c 2022 696e 7370 6972 6522 3a20  "a", "inspire": 
+0003e350: 2231 227d 2c20 666f 7263 653d 4661 6c73  "1"}, force=Fals
+0003e360: 6529 0a20 2020 2020 2020 2020 2020 205f  e).            _
+0003e370: 636e 752e 6173 7365 7274 5f61 6e79 5f63  cnu.assert_any_c
+0003e380: 616c 6c28 7b22 6269 626b 6579 223a 2022  all({"bibkey": "
+0003e390: 6222 2c20 2269 6e73 7069 7265 223a 2022  b", "inspire": "
+0003e3a0: 3222 7d2c 2066 6f72 6365 3d46 616c 7365  2"}, force=False
+0003e3b0: 290a 2020 2020 2020 2020 2020 2020 5f63  ).            _c
+0003e3c0: 6e75 2e61 7373 6572 745f 616e 795f 6361  nu.assert_any_ca
+0003e3d0: 6c6c 287b 2262 6962 6b65 7922 3a20 2263  ll({"bibkey": "c
+0003e3e0: 222c 2022 696e 7370 6972 6522 3a20 2233  ", "inspire": "3
+0003e3f0: 227d 2c20 666f 7263 653d 4661 6c73 6529  "}, force=False)
+0003e400: 0a20 2020 2020 2020 2020 2020 205f 636e  .            _cn
+0003e410: 752e 6173 7365 7274 5f61 6e79 5f63 616c  u.assert_any_cal
+0003e420: 6c28 7b22 6269 626b 6579 223a 2022 6422  l({"bibkey": "d"
+0003e430: 2c20 2269 6e73 7069 7265 223a 2022 3422  , "inspire": "4"
+0003e440: 7d2c 2066 6f72 6365 3d46 616c 7365 290a  }, force=False).
+0003e450: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0003e460: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0003e470: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0003e480: 6261 7365 2e45 6e74 7269 6573 2e63 6865  base.Entries.che
+0003e490: 636b 4e65 6564 7355 7064 6174 6522 2c0a  ckNeedsUpdate",.
+0003e4a0: 2020 2020 2020 2020 2020 2020 7369 6465              side
+0003e4b0: 5f65 6666 6563 743d 5b46 616c 7365 2c20  _effect=[False, 
+0003e4c0: 5472 7565 2c20 4661 6c73 652c 2054 7275  True, False, Tru
+0003e4d0: 655d 2c0a 2020 2020 2020 2020 2920 6173  e],.        ) as
+0003e4e0: 205f 636e 753a 0a20 2020 2020 2020 2020   _cnu:.         
+0003e4f0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0003e500: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0003e510: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0003e520: 6962 732e 6765 7449 6e73 7069 7265 4944  ibs.getInspireID
+0003e530: 4c69 7374 280a 2020 2020 2020 2020 2020  List(.          
+0003e540: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+0003e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e560: 2020 2020 7b22 6269 626b 6579 223a 2022      {"bibkey": "
+0003e570: 6122 2c20 2269 6e73 7069 7265 223a 2022  a", "inspire": "
+0003e580: 3122 7d2c 0a20 2020 2020 2020 2020 2020  1"},.           
+0003e590: 2020 2020 2020 2020 2020 2020 207b 2262               {"b
+0003e5a0: 6962 6b65 7922 3a20 2262 222c 2022 696e  ibkey": "b", "in
+0003e5b0: 7370 6972 6522 3a20 2232 227d 2c0a 2020  spire": "2"},.  
+0003e5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e5d0: 2020 2020 2020 7b22 6269 626b 6579 223a        {"bibkey":
+0003e5e0: 2022 6322 2c20 2269 6e73 7069 7265 223a   "c", "inspire":
+0003e5f0: 2022 3322 7d2c 0a20 2020 2020 2020 2020   "3"},.         
+0003e600: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0003e610: 2262 6962 6b65 7922 3a20 2264 222c 2022  "bibkey": "d", "
+0003e620: 696e 7370 6972 6522 3a20 2234 227d 2c0a  inspire": "4"},.
+0003e630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e640: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+0003e650: 2020 2020 2020 2020 2020 2034 2c0a 2020             4,.  
+0003e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e670: 2020 666f 7263 653d 5472 7565 2c0a 2020    force=True,.  
+0003e680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e690: 2020 7062 5661 6c3d 7062 762c 0a20 2020    pbVal=pbv,.   
+0003e6a0: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
+0003e6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6c0: 285b 2232 222c 2022 3422 5d2c 2032 292c  (["2", "4"], 2),
+0003e6d0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0003e6e0: 2020 2020 2020 2020 2020 2070 6276 2e61             pbv.a
+0003e6f0: 7373 6572 745f 616e 795f 6361 6c6c 2831  ssert_any_call(1
+0003e700: 290a 2020 2020 2020 2020 2020 2020 7062  ).            pb
+0003e710: 762e 6173 7365 7274 5f61 6e79 5f63 616c  v.assert_any_cal
+0003e720: 6c28 3229 0a20 2020 2020 2020 2020 2020  l(2).           
+0003e730: 2070 6276 2e61 7373 6572 745f 616e 795f   pbv.assert_any_
+0003e740: 6361 6c6c 2833 290a 2020 2020 2020 2020  call(3).        
+0003e750: 2020 2020 7062 762e 6173 7365 7274 5f61      pbv.assert_a
+0003e760: 6e79 5f63 616c 6c28 3429 0a20 2020 2020  ny_call(4).     
+0003e770: 2020 2020 2020 205f 636e 752e 6173 7365         _cnu.asse
+0003e780: 7274 5f61 6e79 5f63 616c 6c28 7b22 6269  rt_any_call({"bi
+0003e790: 626b 6579 223a 2022 6122 2c20 2269 6e73  bkey": "a", "ins
+0003e7a0: 7069 7265 223a 2022 3122 7d2c 2066 6f72  pire": "1"}, for
+0003e7b0: 6365 3d54 7275 6529 0a20 2020 2020 2020  ce=True).       
+0003e7c0: 2020 2020 205f 636e 752e 6173 7365 7274       _cnu.assert
+0003e7d0: 5f61 6e79 5f63 616c 6c28 7b22 6269 626b  _any_call({"bibk
+0003e7e0: 6579 223a 2022 6222 2c20 2269 6e73 7069  ey": "b", "inspi
+0003e7f0: 7265 223a 2022 3222 7d2c 2066 6f72 6365  re": "2"}, force
+0003e800: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
+0003e810: 2020 205f 636e 752e 6173 7365 7274 5f61     _cnu.assert_a
+0003e820: 6e79 5f63 616c 6c28 7b22 6269 626b 6579  ny_call({"bibkey
+0003e830: 223a 2022 6322 2c20 2269 6e73 7069 7265  ": "c", "inspire
+0003e840: 223a 2022 3322 7d2c 2066 6f72 6365 3d54  ": "3"}, force=T
+0003e850: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+0003e860: 205f 636e 752e 6173 7365 7274 5f61 6e79   _cnu.assert_any
+0003e870: 5f63 616c 6c28 7b22 6269 626b 6579 223a  _call({"bibkey":
+0003e880: 2022 6422 2c20 2269 6e73 7069 7265 223a   "d", "inspire":
+0003e890: 2022 3422 7d2c 2066 6f72 6365 3d54 7275   "4"}, force=Tru
+0003e8a0: 6529 0a0a 2020 2020 6465 6620 7465 7374  e)..    def test
+0003e8b0: 5f67 6574 5572 6c28 7365 6c66 2c20 2a61  _getUrl(self, *a
+0003e8c0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+0003e8d0: 2274 6573 7420 6765 7455 726c 2222 220a  "test getUrl""".
+0003e8e0: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
+0003e8f0: 656c 662e 7042 4442 2e62 6962 732e 7072  elf.pBDB.bibs.pr
+0003e900: 6570 6172 6549 6e73 6572 7428 0a20 2020  epareInsert(.   
+0003e910: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+0003e920: 6c65 7b61 6263 2c5c 6e61 7574 686f 7220  le{abc,\nauthor 
+0003e930: 3d20 226d 6522 2c5c 6e74 6974 6c65 203d  = "me",\ntitle =
+0003e940: 2022 6162 6322 2c7d 272c 0a20 2020 2020   "abc",}',.     
+0003e950: 2020 2020 2020 2061 6473 3d22 6162 632e         ads="abc.
+0003e960: 2e2e 3132 3322 2c0a 2020 2020 2020 2020  ..123",.        
+0003e970: 2020 2020 6172 7869 763d 2231 3233 342e      arxiv="1234.
+0003e980: 3536 3738 222c 0a20 2020 2020 2020 2020  5678",.         
+0003e990: 2020 2064 6f69 3d22 312f 322f 3322 2c0a     doi="1/2/3",.
+0003e9a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0003e9b0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+0003e9c0: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
+0003e9d0: 2e69 6e73 6572 7428 6461 7461 2929 0a20  .insert(data)). 
+0003e9e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0003e9f0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+0003ea00: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0003ea10: 6962 732e 6765 7441 6473 5572 6c28 2261  ibs.getAdsUrl("a
+0003ea20: 6263 2229 2c20 2225 7361 6263 2e2e 2e31  bc"), "%sabc...1
+0003ea30: 3233 2220 2520 7062 436f 6e66 6967 2e61  23" % pbConfig.a
+0003ea40: 6473 5572 6c0a 2020 2020 2020 2020 290a  dsUrl.        ).
+0003ea50: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0003ea60: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
+0003ea70: 4442 2e62 6962 732e 6765 7441 6473 5572  DB.bibs.getAdsUr
+0003ea80: 6c28 2264 6566 2229 290a 2020 2020 2020  l("def")).      
+0003ea90: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0003eaa0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0003eab0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+0003eac0: 6574 4172 7869 7655 726c 2822 6162 6322  etArxivUrl("abc"
+0003ead0: 292c 2022 2573 2f61 6273 2f31 3233 342e  ), "%s/abs/1234.
+0003eae0: 3536 3738 2220 2520 7062 436f 6e66 6967  5678" % pbConfig
+0003eaf0: 2e61 7278 6976 5572 6c0a 2020 2020 2020  .arxivUrl.      
+0003eb00: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+0003eb10: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
+0003eb20: 662e 7042 4442 2e62 6962 732e 6765 7441  f.pBDB.bibs.getA
+0003eb30: 7278 6976 5572 6c28 2264 6566 2229 290a  rxivUrl("def")).
+0003eb40: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0003eb50: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+0003eb60: 4442 2e62 6962 732e 6765 7444 6f69 5572  DB.bibs.getDoiUr
+0003eb70: 6c28 2261 6263 2229 2c20 2225 7331 2f32  l("abc"), "%s1/2
+0003eb80: 2f33 2220 2520 7062 436f 6e66 6967 2e64  /3" % pbConfig.d
+0003eb90: 6f69 5572 6c29 0a20 2020 2020 2020 2073  oiUrl).        s
+0003eba0: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+0003ebb0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+0003ebc0: 6574 446f 6955 726c 2822 6465 6622 2929  etDoiUrl("def"))
+0003ebd0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0003ebe0: 7365 7274 5472 7565 280a 2020 2020 2020  sertTrue(.      
+0003ebf0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0003ec00: 6269 6273 2e69 6e73 6572 7446 726f 6d42  bibs.insertFromB
+0003ec10: 6962 7465 7828 0a20 2020 2020 2020 2020  ibtex(.         
+0003ec20: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
+0003ec30: 7b64 6566 2c5c 6e61 7574 686f 7220 3d20  {def,\nauthor = 
+0003ec40: 226d 6522 2c5c 6e74 6974 6c65 203d 2022  "me",\ntitle = "
+0003ec50: 6465 6622 2c7d 270a 2020 2020 2020 2020  def",}'.        
+0003ec60: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+0003ec70: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0003ec80: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
+0003ec90: 4442 2e62 6962 732e 6765 7441 7278 6976  DB.bibs.getArxiv
+0003eca0: 5572 6c28 2264 6566 2229 290a 2020 2020  Url("def")).    
+0003ecb0: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+0003ecc0: 616c 7365 2873 656c 662e 7042 4442 2e62  alse(self.pBDB.b
+0003ecd0: 6962 732e 6765 7444 6f69 5572 6c28 2264  ibs.getDoiUrl("d
+0003ece0: 6566 2229 290a 0a20 2020 2064 6566 2074  ef"))..    def t
+0003ecf0: 6573 745f 696d 706f 7274 4672 6f6d 4269  est_importFromBi
+0003ed00: 6228 7365 6c66 2c20 2a61 7267 7329 3a0a  b(self, *args):.
+0003ed10: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
+0003ed20: 6e28 2274 6d70 6269 622e 6269 6222 2c20  n("tmpbib.bib", 
+0003ed30: 2277 2229 2061 7320 663a 0a20 2020 2020  "w") as f:.     
+0003ed40: 2020 2020 2020 2066 2e77 7269 7465 280a         f.write(.
+0003ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed60: 2740 6172 7469 636c 657b 6162 632c 5c6e  '@article{abc,\n
+0003ed70: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
+0003ed80: 7469 746c 6520 3d20 270a 2020 2020 2020  title = '.      
+0003ed90: 2020 2020 2020 2020 2020 2b20 2722 6162            + '"ab
+0003eda0: 6322 2c7d 4061 7274 6963 6c65 7b64 6566  c",}@article{def
+0003edb0: 2c5c 6e61 7574 686f 7220 3d20 226d 6522  ,\nauthor = "me"
+0003edc0: 2c5c 6e74 6974 6c65 203d 2022 6465 6640  ,\ntitle = "def@
+0003edd0: 6768 6922 2c7d 270a 2020 2020 2020 2020  ghi",}'.        
+0003ede0: 2020 2020 290a 2020 2020 2020 2020 7062      ).        pb
+0003edf0: 6d20 3d20 4d61 6769 634d 6f63 6b28 290a  m = MagicMock().
+0003ee00: 2020 2020 2020 2020 7062 7620 3d20 4d61          pbv = Ma
+0003ee10: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
+0003ee20: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0003ee30: 2e69 6d70 6f72 7446 726f 6d42 6962 280a  .importFromBib(.
+0003ee40: 2020 2020 2020 2020 2020 2020 2274 6d70              "tmp
+0003ee50: 6269 622e 6269 6222 2c20 636f 6d70 6c65  bib.bib", comple
+0003ee60: 7465 496e 666f 3d46 616c 7365 2c20 7062  teInfo=False, pb
+0003ee70: 4d61 783d 7062 6d2c 2070 6256 616c 3d70  Max=pbm, pbVal=p
+0003ee80: 6276 0a20 2020 2020 2020 2029 0a20 2020  bv.        ).   
+0003ee90: 2020 2020 2070 626d 2e61 7373 6572 745f       pbm.assert_
+0003eea0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+0003eeb0: 2832 290a 2020 2020 2020 2020 7062 762e  (2).        pbv.
+0003eec0: 6173 7365 7274 5f68 6173 5f63 616c 6c73  assert_has_calls
+0003eed0: 285b 6361 6c6c 2831 292c 2063 616c 6c28  ([call(1), call(
+0003eee0: 3229 5d29 0a20 2020 2020 2020 2073 656c  2)]).        sel
+0003eef0: 662e 6173 7365 7274 4571 7561 6c28 5b65  f.assertEqual([e
+0003ef00: 5b22 6269 626b 6579 225d 2066 6f72 2065  ["bibkey"] for e
+0003ef10: 2069 6e20 7365 6c66 2e70 4244 422e 6269   in self.pBDB.bi
+0003ef20: 6273 2e67 6574 416c 6c28 295d 2c20 5b22  bs.getAll()], ["
+0003ef30: 6162 6322 2c20 2264 6566 225d 290a 0a20  abc", "def"]).. 
+0003ef40: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0003ef50: 2e75 6e64 6f28 7665 7262 6f73 653d 3029  .undo(verbose=0)
+0003ef60: 0a20 2020 2020 2020 2077 6974 6820 6f70  .        with op
+0003ef70: 656e 2822 746d 7062 6962 2e62 6962 222c  en("tmpbib.bib",
+0003ef80: 2022 7722 2920 6173 2066 3a0a 2020 2020   "w") as f:.    
+0003ef90: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+0003efa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003efb0: 2027 4061 7274 6963 6c65 7b61 6263 2c5c   '@article{abc,\
+0003efc0: 6e61 7574 686f 7220 3d20 226d 6522 2c5c  nauthor = "me",\
+0003efd0: 6e27 0a20 2020 2020 2020 2020 2020 2020  n'.             
+0003efe0: 2020 202b 2027 7469 746c 6520 3d20 2261     + 'title = "a
+0003eff0: 6263 222c 5c6e 7d5c 6e40 6172 7469 636c  bc",\n}\n@articl
+0003f000: 657b 6465 662c 5c6e 7d5c 6e27 0a20 2020  e{def,\n}\n'.   
+0003f010: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0003f020: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0003f030: 732e 696d 706f 7274 4672 6f6d 4269 6228  s.importFromBib(
+0003f040: 2274 6d70 6269 622e 6269 6222 2c20 636f  "tmpbib.bib", co
+0003f050: 6d70 6c65 7465 496e 666f 3d46 616c 7365  mpleteInfo=False
+0003f060: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0003f070: 7373 6572 7445 7175 616c 285b 655b 2262  ssertEqual([e["b
+0003f080: 6962 6b65 7922 5d20 666f 7220 6520 696e  ibkey"] for e in
+0003f090: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0003f0a0: 6765 7441 6c6c 2829 5d2c 205b 2261 6263  getAll()], ["abc
+0003f0b0: 225d 290a 0a20 2020 2020 2020 2073 656c  "])..        sel
+0003f0c0: 662e 7042 4442 2e75 6e64 6f28 7665 7262  f.pBDB.undo(verb
+0003f0d0: 6f73 653d 3029 0a20 2020 2020 2020 2077  ose=0).        w
+0003f0e0: 6974 6820 6f70 656e 2822 746d 7062 6962  ith open("tmpbib
+0003f0f0: 2e62 6962 222c 2022 7722 2920 6173 2066  .bib", "w") as f
+0003f100: 3a0a 2020 2020 2020 2020 2020 2020 662e  :.            f.
+0003f110: 7772 6974 6528 0a20 2020 2020 2020 2020  write(.         
+0003f120: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
+0003f130: 7b61 6263 2c5c 6e61 7574 686f 7220 3d20  {abc,\nauthor = 
+0003f140: 226d 6522 2c5c 6e27 0a20 2020 2020 2020  "me",\n'.       
+0003f150: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
+0003f160: 6520 3d20 2261 6263 222c 5c6e 7d5c 6e40  e = "abc",\n}\n@
+0003f170: 6172 7469 636c 657b 6465 662c 5c6e 7d5c  article{def,\n}\
+0003f180: 6e27 0a20 2020 2020 2020 2020 2020 2029  n'.            )
+0003f190: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+0003f1a0: 4442 2e62 6962 732e 696d 706f 7274 4672  DB.bibs.importFr
+0003f1b0: 6f6d 4269 6228 2274 6d70 6269 622e 6269  omBib("tmpbib.bi
+0003f1c0: 6222 2c20 636f 6d70 6c65 7465 496e 666f  b", completeInfo
+0003f1d0: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
+0003f1e0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0003f1f0: 285b 655b 2262 6962 6b65 7922 5d20 666f  ([e["bibkey"] fo
+0003f200: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+0003f210: 2e62 6962 732e 6765 7441 6c6c 2829 5d2c  .bibs.getAll()],
+0003f220: 205b 2261 6263 225d 290a 0a20 2020 2020   ["abc"])..     
+0003f230: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
+0003f240: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
+0003f250: 2020 2020 2077 6974 6820 6f70 656e 2822       with open("
+0003f260: 746d 7062 6962 2e62 6962 222c 2022 7722  tmpbib.bib", "w"
+0003f270: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
+0003f280: 2020 2020 662e 7772 6974 6528 0a20 2020      f.write(.   
+0003f290: 2020 2020 2020 2020 2020 2020 2027 4061               '@a
+0003f2a0: 7274 6963 6c65 7b61 6263 2c5c 6e61 7574  rticle{abc,\naut
+0003f2b0: 686f 7220 3d20 226d 6522 2c5c 6e27 0a20  hor = "me",\n'. 
+0003f2c0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+0003f2d0: 2022 6d6f 6e74 6820 3d20 6a61 6e2c 5c6e   "month = jan,\n
+0003f2e0: 7d5c 6e40 6172 7469 636c 657b 6465 662c  }\n@article{def,
+0003f2f0: 5c6e 7d5c 6e22 0a20 2020 2020 2020 2020  \n}\n".         
+0003f300: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+0003f310: 662e 7042 4442 2e62 6962 732e 696d 706f  f.pBDB.bibs.impo
+0003f320: 7274 4672 6f6d 4269 6228 2274 6d70 6269  rtFromBib("tmpbi
+0003f330: 622e 6269 6222 2c20 636f 6d70 6c65 7465  b.bib", complete
+0003f340: 496e 666f 3d46 616c 7365 290a 2020 2020  Info=False).    
+0003f350: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0003f360: 7175 616c 285b 655b 2262 6962 6b65 7922  qual([e["bibkey"
+0003f370: 5d20 666f 7220 6520 696e 2073 656c 662e  ] for e in self.
+0003f380: 7042 4442 2e62 6962 732e 6765 7441 6c6c  pBDB.bibs.getAll
+0003f390: 2829 5d2c 205b 2261 6263 225d 290a 0a20  ()], ["abc"]).. 
+0003f3a0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0003f3b0: 2e75 6e64 6f28 7665 7262 6f73 653d 3029  .undo(verbose=0)
+0003f3c0: 0a20 2020 2020 2020 2023 2074 6573 7420  .        # test 
+0003f3d0: 7769 7468 2063 6f6d 706c 6574 6549 6e66  with completeInf
+0003f3e0: 6f0a 2020 2020 2020 2020 7769 7468 206f  o.        with o
+0003f3f0: 7065 6e28 2274 6d70 6269 622e 6269 6222  pen("tmpbib.bib"
+0003f400: 2c20 2277 2229 2061 7320 663a 0a20 2020  , "w") as f:.   
+0003f410: 2020 2020 2020 2020 2066 2e77 7269 7465           f.write
+0003f420: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003f430: 2020 2740 6172 7469 636c 657b 4761 7269    '@article{Gari
+0003f440: 617a 7a6f 3a32 3031 3572 7261 2c5c 6e61  azzo:2015rra,\na
+0003f450: 7574 686f 7220 3d20 226d 6522 2c5c 6e27  uthor = "me",\n'
+0003f460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f470: 202b 2027 6172 7869 7620 3d20 2231 3530   + 'arxiv = "150
+0003f480: 372e 3038 3230 3422 2c5c 6e7d 5c6e 4061  7.08204",\n}\n@a
+0003f490: 7274 6963 6c65 7b27 0a20 2020 2020 2020  rticle{'.       
+0003f4a0: 2020 2020 2020 2020 202b 2027 4761 7269           + 'Gari
+0003f4b0: 617a 7a6f 3a32 3031 3472 7261 2c5c 6e61  azzo:2014rra,\na
+0003f4c0: 7574 686f 723d 226d 6522 2c5c 6e7d 5c6e  uthor="me",\n}\n
+0003f4d0: 270a 2020 2020 2020 2020 2020 2020 290a  '.            ).
+0003f4e0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0003f4f0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0003f500: 2270 6879 7362 6962 6c69 6f2e 7765 6269  "physbiblio.webi
+0003f510: 6d70 6f72 742e 6172 7869 762e 5765 6253  mport.arxiv.WebS
+0003f520: 6561 7263 682e 7265 7472 6965 7665 5572  earch.retrieveUr
+0003f530: 6c41 6c6c 222c 0a20 2020 2020 2020 2020  lAll",.         
+0003f540: 2020 2073 6964 655f 6566 6665 6374 3d5b     side_effect=[
+0003f550: 2822 6269 6274 6578 5f6e 6f74 5f75 7365  ("bibtex_not_use
+0003f560: 6422 2c20 7b22 6162 7374 7261 6374 223a  d", {"abstract":
+0003f570: 2022 736f 6d65 2066 616b 6520 6162 7374   "some fake abst
+0003f580: 7261 6374 227d 295d 2c0a 2020 2020 2020  ract"})],.      
+0003f590: 2020 2020 2020 6175 746f 7370 6563 3d54        autospec=T
+0003f5a0: 7275 652c 0a20 2020 2020 2020 2029 2061  rue,.        ) a
+0003f5b0: 7320 5f72 6574 7269 6576 652c 2070 6174  s _retrieve, pat
+0003f5c0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0003f5d0: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0003f5e0: 6261 7365 2e45 6e74 7269 6573 2e75 7064  base.Entries.upd
+0003f5f0: 6174 6549 6e73 7069 7265 4944 222c 0a20  ateInspireID",. 
+0003f600: 2020 2020 2020 2020 2020 2073 6964 655f             side_
+0003f610: 6566 6665 6374 3d5b 2231 3338 3535 3833  effect=["1385583
+0003f620: 222c 2046 616c 7365 5d2c 0a20 2020 2020  ", False],.     
+0003f630: 2020 2020 2020 2061 7574 6f73 7065 633d         autospec=
+0003f640: 5472 7565 2c0a 2020 2020 2020 2020 2920  True,.        ) 
+0003f650: 6173 205f 696e 7370 6972 6569 642c 2070  as _inspireid, p
+0003f660: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+0003f670: 2020 2270 6879 7362 6962 6c69 6f2e 7765    "physbiblio.we
+0003f680: 6269 6d70 6f72 742e 696e 7370 6972 652e  bimport.inspire.
+0003f690: 5765 6253 6561 7263 682e 7265 7472 6965  WebSearch.retrie
+0003f6a0: 7665 4f41 4944 6174 6122 2c0a 2020 2020  veOAIData",.    
+0003f6b0: 2020 2020 2020 2020 7369 6465 5f65 6666          side_eff
+0003f6c0: 6563 743d 5b0a 2020 2020 2020 2020 2020  ect=[.          
+0003f6d0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+0003f6e0: 2020 2020 2020 2020 2020 2020 2264 6f69              "doi
+0003f6f0: 223a 2022 3130 2e31 3038 382f 3039 3534  ": "10.1088/0954
+0003f700: 2d33 3839 392f 3433 2f33 2f30 3333 3030  -3899/43/3/03300
+0003f710: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+0003f720: 2020 2020 2020 2020 2269 7362 6e22 3a20          "isbn": 
+0003f730: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+0003f740: 2020 2020 2020 2020 2020 2261 6473 223a            "ads":
+0003f750: 2022 3230 3135 4a50 6847 2e2e 2e34 3363   "2015JPhG...43c
+0003f760: 3330 3031 4722 2c0a 2020 2020 2020 2020  3001G",.        
+0003f770: 2020 2020 2020 2020 2020 2020 2270 7562              "pub
+0003f780: 6461 7465 223a 2022 3230 3136 2d30 312d  date": "2016-01-
+0003f790: 3133 222c 0a20 2020 2020 2020 2020 2020  13",.           
+0003f7a0: 2020 2020 2020 2020 2022 6669 7273 7464           "firstd
+0003f7b0: 6174 6522 3a20 2232 3031 352d 3037 2d32  ate": "2015-07-2
+0003f7c0: 3922 2c0a 2020 2020 2020 2020 2020 2020  9",.            
+0003f7d0: 2020 2020 2020 2020 226a 6f75 726e 616c          "journal
+0003f7e0: 223a 2022 4a2e 5068 7973 2e22 2c0a 2020  ": "J.Phys.",.  
+0003f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f800: 2020 2261 7278 6976 223a 2022 3135 3037    "arxiv": "1507
+0003f810: 2e30 3832 3034 222c 0a20 2020 2020 2020  .08204",.       
+0003f820: 2020 2020 2020 2020 2020 2020 2022 6964               "id
+0003f830: 223a 2022 3133 3835 3538 3322 2c0a 2020  ": "1385583",.  
+0003f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f850: 2020 2276 6f6c 756d 6522 3a20 2247 3433    "volume": "G43
+0003f860: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003f870: 2020 2020 2020 2022 6269 6274 6578 223a         "bibtex":
+0003f880: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0003f890: 2020 2020 2020 2020 2020 2022 7965 6172             "year
+0003f8a0: 223a 2022 3230 3136 222c 0a20 2020 2020  ": "2016",.     
+0003f8b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0003f8c0: 6f6c 646b 6579 7322 3a20 2222 2c0a 2020  oldkeys": "",.  
+0003f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f8e0: 2020 2262 6962 6b65 7922 3a20 2247 6172    "bibkey": "Gar
+0003f8f0: 6961 7a7a 6f3a 3230 3135 7272 6122 2c0a  iazzo:2015rra",.
+0003f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f910: 2020 2020 2270 6167 6573 223a 2022 3033      "pages": "03
+0003f920: 3330 3031 222c 0a20 2020 2020 2020 2020  3001",.         
+0003f930: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+0003f940: 2020 2020 2020 2020 2020 5b5d 2c0a 2020            [],.  
+0003f950: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+0003f960: 2020 2020 2020 2020 2061 7574 6f73 7065           autospe
+0003f970: 633d 5472 7565 2c0a 2020 2020 2020 2020  c=True,.        
+0003f980: 2920 6173 205f 6f61 692c 2070 6174 6368  ) as _oai, patch
+0003f990: 2e64 6963 7428 0a20 2020 2020 2020 2020  .dict(.         
+0003f9a0: 2020 2070 6243 6f6e 6669 672e 7061 7261     pbConfig.para
+0003f9b0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
+0003f9c0: 7b22 6665 7463 6841 6273 7472 6163 7422  {"fetchAbstract"
+0003f9d0: 3a20 5472 7565 2c20 2264 6566 6175 6c74  : True, "default
+0003f9e0: 4361 7465 676f 7269 6573 223a 2031 7d2c  Categories": 1},
+0003f9f0: 0a20 2020 2020 2020 2020 2020 2063 6c65  .            cle
+0003fa00: 6172 3d46 616c 7365 2c0a 2020 2020 2020  ar=False,.      
+0003fa10: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+0003fa20: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0003fa30: 696d 706f 7274 4672 6f6d 4269 6228 2274  importFromBib("t
+0003fa40: 6d70 6269 622e 6269 6222 290a 2020 2020  mpbib.bib").    
+0003fa50: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0003fa60: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0003fa70: 2020 2020 2020 2020 2020 5b65 5b22 6269            [e["bi
+0003fa80: 626b 6579 225d 2066 6f72 2065 2069 6e20  bkey"] for e in 
+0003fa90: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+0003faa0: 6574 416c 6c28 295d 2c0a 2020 2020 2020  etAll()],.      
+0003fab0: 2020 2020 2020 2020 2020 5b22 4761 7269            ["Gari
+0003fac0: 617a 7a6f 3a32 3031 3572 7261 222c 2022  azzo:2015rra", "
+0003fad0: 4761 7269 617a 7a6f 3a32 3031 3472 7261  Gariazzo:2014rra
+0003fae0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0003faf0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0003fb00: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+0003fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fb20: 5b65 5b22 696e 7370 6972 6522 5d20 666f  [e["inspire"] fo
+0003fb30: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+0003fb40: 2e62 6962 732e 6765 7441 6c6c 2829 5d2c  .bibs.getAll()],
+0003fb50: 205b 2231 3338 3535 3833 222c 204e 6f6e   ["1385583", Non
+0003fb60: 655d 0a20 2020 2020 2020 2020 2020 2029  e].            )
+0003fb70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003fb80: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0003fb90: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0003fba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003fbb0: 2020 2020 206c 656e 2865 5b22 6162 7374       len(e["abst
+0003fbc0: 7261 6374 225d 2920 3e20 3130 2069 6620  ract"]) > 10 if 
+0003fbd0: 655b 2261 6273 7472 6163 7422 5d20 6973  e["abstract"] is
+0003fbe0: 206e 6f74 204e 6f6e 6520 656c 7365 2030   not None else 0
+0003fbf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003fc00: 2020 2020 2066 6f72 2065 2069 6e20 7365       for e in se
+0003fc10: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+0003fc20: 416c 6c28 290a 2020 2020 2020 2020 2020  All().          
+0003fc30: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+0003fc40: 2020 2020 2020 2020 205b 5472 7565 2c20           [True, 
+0003fc50: 4661 6c73 655d 2c0a 2020 2020 2020 2020  False],.        
+0003fc60: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0003fc70: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0003fc80: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0003fc90: 2020 2020 5b65 5b22 6669 7273 7464 6174      [e["firstdat
+0003fca0: 6522 5d20 666f 7220 6520 696e 2073 656c  e"] for e in sel
+0003fcb0: 662e 7042 4442 2e62 6962 732e 6765 7441  f.pBDB.bibs.getA
+0003fcc0: 6c6c 2829 5d2c 0a20 2020 2020 2020 2020  ll()],.         
+0003fcd0: 2020 2020 2020 205b 2232 3031 352d 3037         ["2015-07
+0003fce0: 2d32 3922 2c20 6461 7465 7469 6d65 2e64  -29", datetime.d
+0003fcf0: 6174 652e 746f 6461 7928 292e 7374 7266  ate.today().strf
+0003fd00: 7469 6d65 2822 2559 2d25 6d2d 2564 2229  time("%Y-%m-%d")
+0003fd10: 5d2c 0a20 2020 2020 2020 2020 2020 2029  ],.            )
+0003fd20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003fd30: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0003fd40: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0003fd50: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
+0003fd60: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+0003fd70: 6962 732e 6765 7442 7943 6174 2831 295d  ibs.getByCat(1)]
+0003fd80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003fd90: 2020 5b22 4761 7269 617a 7a6f 3a32 3031    ["Gariazzo:201
+0003fda0: 3572 7261 222c 2022 4761 7269 617a 7a6f  5rra", "Gariazzo
+0003fdb0: 3a32 3031 3472 7261 225d 2c0a 2020 2020  :2014rra"],.    
+0003fdc0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0003fdd0: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
+0003fde0: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
+0003fdf0: 2020 2020 2077 6974 6820 7061 7463 682e       with patch.
+0003fe00: 6469 6374 280a 2020 2020 2020 2020 2020  dict(.          
+0003fe10: 2020 7062 436f 6e66 6967 2e70 6172 616d    pbConfig.param
+0003fe20: 732c 0a20 2020 2020 2020 2020 2020 207b  s,.            {
+0003fe30: 2266 6574 6368 4162 7374 7261 6374 223a  "fetchAbstract":
+0003fe40: 2046 616c 7365 2c20 2264 6566 6175 6c74   False, "default
+0003fe50: 4361 7465 676f 7269 6573 223a 207b 2261  Categories": {"a
+0003fe60: 6222 7d7d 2c0a 2020 2020 2020 2020 2020  b"}},.          
+0003fe70: 2020 636c 6561 723d 4661 6c73 652c 0a20    clear=False,. 
+0003fe80: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+0003fe90: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0003fea0: 6269 6273 2e69 6d70 6f72 7446 726f 6d42  bibs.importFromB
+0003feb0: 6962 2822 746d 7062 6962 2e62 6962 222c  ib("tmpbib.bib",
+0003fec0: 2063 6f6d 706c 6574 6549 6e66 6f3d 4661   completeInfo=Fa
+0003fed0: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+0003fee0: 2077 6974 6820 7061 7463 6828 226c 6f67   with patch("log
+0003fef0: 6769 6e67 2e4c 6f67 6765 722e 696e 666f  ging.Logger.info
+0003ff00: 2229 2061 7320 5f69 3a0a 2020 2020 2020  ") as _i:.      
+0003ff10: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0003ff20: 4244 422e 6269 6273 2e69 6d70 6f72 7446  BDB.bibs.importF
+0003ff30: 726f 6d42 6962 2822 746d 7062 6962 2e62  romBib("tmpbib.b
+0003ff40: 6962 222c 2063 6f6d 706c 6574 6549 6e66  ib", completeInf
+0003ff50: 6f3d 4661 6c73 6529 0a20 2020 2020 2020  o=False).       
+0003ff60: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0003ff70: 7365 7274 5472 7565 280a 2020 2020 2020  sertTrue(.      
+0003ff80: 2020 2020 2020 2020 2020 2020 2020 616e                an
+0003ff90: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
+0003ffa0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+0003ffb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ffc0: 2020 2020 2020 2020 2022 3220 656e 7472           "2 entr
+0003ffd0: 6965 7320 7072 6f63 6573 7365 642c 206f  ies processed, o
+0003ffe0: 6620 7768 6963 6820 3220 6578 6973 7469  f which 2 existi
+0003fff0: 6e67 2220 696e 2063 0a20 2020 2020 2020  ng" in c.       
+00040000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040010: 2020 2020 2066 6f72 2063 2069 6e20 5f69       for c in _i
+00040020: 2e63 616c 6c5f 6172 6773 5b30 5d0a 2020  .call_args[0].  
+00040030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040040: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+00040050: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00040060: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00040070: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00040080: 662e 7042 4442 2e75 6e64 6f28 7665 7262  f.pBDB.undo(verb
+00040090: 6f73 653d 3029 0a20 2020 2020 2020 2020  ose=0).         
+000400a0: 2020 2077 6974 6820 7061 7463 6828 226c     with patch("l
+000400b0: 6f67 6769 6e67 2e4c 6f67 6765 722e 6578  ogging.Logger.ex
+000400c0: 6365 7074 696f 6e22 2920 6173 205f 653a  ception") as _e:
+000400d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000400e0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+000400f0: 696d 706f 7274 4672 6f6d 4269 6228 2274  importFromBib("t
+00040100: 6d70 6269 622e 6269 6222 2c20 636f 6d70  mpbib.bib", comp
+00040110: 6c65 7465 496e 666f 3d46 616c 7365 290a  leteInfo=False).
+00040120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040130: 7365 6c66 2e61 7373 6572 7449 6e28 0a20  self.assertIn(. 
+00040140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040150: 2020 2022 4572 726f 7220 6269 6e64 696e     "Error bindin
+00040160: 6720 7061 7261 6d65 7465 7222 2c0a 2020  g parameter",.  
+00040170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040180: 2020 5f65 2e63 616c 6c5f 6172 6773 5b30    _e.call_args[0
+00040190: 5d5b 305d 2c0a 2020 2020 2020 2020 2020  ][0],.          
+000401a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000401b0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000401c0: 7175 616c 285b 6469 6374 2865 2920 666f  qual([dict(e) fo
+000401d0: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+000401e0: 2e63 6174 4269 622e 6765 7441 6c6c 2829  .catBib.getAll()
+000401f0: 5d2c 205b 5d29 0a0a 2020 2020 2020 2020  ], [])..        
+00040200: 2020 2020 6f73 2e72 656d 6f76 6528 2274      os.remove("t
+00040210: 6d70 6269 622e 6269 6222 290a 0a20 2020  mpbib.bib")..   
+00040220: 2064 6566 2074 6573 745f 696d 706f 7274   def test_import
+00040230: 4f6e 6546 726f 6d42 6962 7465 7844 6963  OneFromBibtexDic
+00040240: 7428 7365 6c66 2c20 2a61 7267 7329 3a0a  t(self, *args):.
+00040250: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
+00040260: 696d 706f 7274 4f6e 6546 726f 6d42 6962  importOneFromBib
+00040270: 7465 7844 6963 7422 2222 0a20 2020 2020  texDict""".     
+00040280: 2020 2064 6220 3d20 6269 6274 6578 7061     db = bibtexpa
+00040290: 7273 6572 2e62 6962 6461 7461 6261 7365  rser.bibdatabase
+000402a0: 2e42 6962 4461 7461 6261 7365 2829 0a20  .BibDatabase(). 
+000402b0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+000402c0: 2e62 6962 732e 6c61 7374 496e 7365 7274  .bibs.lastInsert
+000402d0: 6564 203d 205b 5d0a 2020 2020 2020 2020  ed = [].        
+000402e0: 7769 7468 2073 656c 662e 6173 7365 7274  with self.assert
+000402f0: 5261 6973 6573 284b 6579 4572 726f 7229  Raises(KeyError)
+00040300: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00040310: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00040320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040330: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
+00040340: 6d70 6f72 744f 6e65 4672 6f6d 4269 6274  mportOneFromBibt
+00040350: 6578 4469 6374 2830 2c20 7b7d 2c20 6462  exDict(0, {}, db
+00040360: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00040370: 2020 2028 5b5d 2c20 5b5d 292c 0a20 2020     ([], []),.   
+00040380: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00040390: 2020 2077 6974 6820 7061 7463 6828 0a20     with patch(. 
+000403a0: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+000403b0: 6269 626c 696f 2e64 6174 6162 6173 652e  biblio.database.
+000403c0: 456e 7472 6965 732e 6765 7442 7942 6962  Entries.getByBib
+000403d0: 6b65 7922 2c20 7265 7475 726e 5f76 616c  key", return_val
+000403e0: 7565 3d5b 7b22 6122 3a20 2262 227d 5d0a  ue=[{"a": "b"}].
+000403f0: 2020 2020 2020 2020 2920 6173 205f 673a          ) as _g:
+00040400: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00040410: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00040420: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00040430: 656c 662e 7042 4442 2e62 6962 732e 696d  elf.pBDB.bibs.im
+00040440: 706f 7274 4f6e 6546 726f 6d42 6962 7465  portOneFromBibte
+00040450: 7844 6963 7428 0a20 2020 2020 2020 2020  xDict(.         
+00040460: 2020 2020 2020 2020 2020 2031 2c0a 2020             1,.  
+00040470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040480: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00040490: 2020 2020 2020 2020 2020 2020 2245 4e54              "ENT
+000404a0: 5259 5459 5045 223a 2022 6172 7469 636c  RYTYPE": "articl
+000404b0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+000404c0: 2020 2020 2020 2020 2020 2020 2249 4422              "ID"
+000404d0: 3a20 2261 6263 6422 2c0a 2020 2020 2020  : "abcd",.      
+000404e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000404f0: 2020 2261 7574 686f 7222 3a20 226d 6522    "author": "me"
+00040500: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00040510: 2020 2020 2020 2020 2020 2274 6974 6c65            "title
+00040520: 223a 2022 6d79 7469 746c 6522 2c0a 2020  ": "mytitle",.  
 00040530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040540: 2020 2020 2020 2249 4422 3a20 2261 6263        "ID": "abc
-00040550: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
-00040560: 2020 2020 2020 2020 2020 2020 2261 7574              "aut
-00040570: 686f 7222 3a20 226d 6522 2c0a 2020 2020  hor": "me",.    
-00040580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040590: 2020 2020 2274 6974 6c65 223a 2022 6d79      "title": "my
-000405a0: 7469 746c 6522 2c0a 2020 2020 2020 2020  title",.        
-000405b0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-000405c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000405d0: 2020 2064 622c 0a20 2020 2020 2020 2020     db,.         
-000405e0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-000405f0: 2020 2020 2020 2020 2020 285b 5d2c 205b            ([], [
-00040600: 2261 6263 6422 5d29 2c0a 2020 2020 2020  "abcd"]),.      
-00040610: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00040620: 2020 2020 5f67 2e61 7373 6572 745f 6361      _g.assert_ca
-00040630: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
-00040640: 6162 6364 222c 2073 6176 6551 7565 7279  abcd", saveQuery
-00040650: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-00040660: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00040670: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00040680: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00040690: 6269 6273 2e69 6d70 6f72 744f 6e65 4672  bibs.importOneFr
-000406a0: 6f6d 4269 6274 6578 4469 6374 280a 2020  omBibtexDict(.  
-000406b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000406c0: 2020 312c 0a20 2020 2020 2020 2020 2020    1,.           
-000406d0: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00040540: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+00040550: 2020 2020 2020 2020 2064 622c 0a20 2020           db,.   
+00040560: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
+00040570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040580: 285b 5d2c 205b 2261 6263 6422 5d29 2c0a  ([], ["abcd"]),.
+00040590: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000405a0: 2020 2020 2020 2020 2020 5f67 2e61 7373            _g.ass
+000405b0: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+000405c0: 7769 7468 2822 6162 6364 222c 2073 6176  with("abcd", sav
+000405d0: 6551 7565 7279 3d46 616c 7365 290a 2020  eQuery=False).  
+000405e0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000405f0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00040600: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00040610: 2e70 4244 422e 6269 6273 2e69 6d70 6f72  .pBDB.bibs.impor
+00040620: 744f 6e65 4672 6f6d 4269 6274 6578 4469  tOneFromBibtexDi
+00040630: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00040640: 2020 2020 2020 2020 312c 0a20 2020 2020          1,.     
+00040650: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00040660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040670: 2020 2020 2020 2020 2022 454e 5452 5954           "ENTRYT
+00040680: 5950 4522 3a20 2261 7274 6963 6c65 222c  YPE": "article",
+00040690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000406a0: 2020 2020 2020 2020 2022 4944 223a 2022           "ID": "
+000406b0: 6162 6364 222c 0a20 2020 2020 2020 2020  abcd",.         
+000406c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000406d0: 6175 7468 6f72 223a 2022 6d65 222c 0a20  author": "me",. 
 000406e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000406f0: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-00040700: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-00040710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040720: 2020 2022 4944 223a 2022 6162 6364 222c     "ID": "abcd",
-00040730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040740: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
-00040750: 223a 2022 6d65 222c 0a20 2020 2020 2020  ": "me",.       
-00040760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040770: 2022 7469 746c 6522 3a20 226d 7974 6974   "title": "mytit
-00040780: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
-00040790: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-000407a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000407b0: 6462 2c0a 2020 2020 2020 2020 2020 2020  db,.            
-000407c0: 2020 2020 2020 2020 746f 743d 3130 302c          tot=100,
-000407d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000407e0: 2020 2020 2065 7272 6f72 733d 5b22 4141       errors=["AA
-000407f0: 4122 5d2c 0a20 2020 2020 2020 2020 2020  A"],.           
-00040800: 2020 2020 2020 2020 2065 7869 7374 696e           existin
-00040810: 673d 5b22 6566 6768 225d 2c0a 2020 2020  g=["efgh"],.    
-00040820: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-00040830: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00040840: 5b22 4141 4122 5d2c 205b 2265 6667 6822  ["AAA"], ["efgh"
-00040850: 2c20 2261 6263 6422 5d29 2c0a 2020 2020  , "abcd"]),.    
-00040860: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00040870: 2020 7769 7468 2070 6174 6368 2822 7068    with patch("ph
-00040880: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-00040890: 652e 456e 7472 6965 732e 6765 7442 7942  e.Entries.getByB
-000408a0: 6962 6b65 7922 2c20 7265 7475 726e 5f76  ibkey", return_v
-000408b0: 616c 7565 3d5b 5d29 2061 7320 5f67 3a0a  alue=[]) as _g:.
-000408c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000408d0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-000408e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000408f0: 6c66 2e70 4244 422e 6269 6273 2e69 6d70  lf.pBDB.bibs.imp
-00040900: 6f72 744f 6e65 4672 6f6d 4269 6274 6578  ortOneFromBibtex
-00040910: 4469 6374 280a 2020 2020 2020 2020 2020  Dict(.          
-00040920: 2020 2020 2020 2020 2020 312c 0a20 2020            1,.   
-00040930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040940: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00040950: 2020 2020 2020 2020 2020 2022 454e 5452             "ENTR
-00040960: 5954 5950 4522 3a20 2261 7274 6963 6c65  YTYPE": "article
-00040970: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00040980: 2020 2020 2020 2020 2020 2022 4944 223a             "ID":
-00040990: 2022 2020 222c 0a20 2020 2020 2020 2020   "  ",.         
-000409a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000409b0: 6175 7468 6f72 223a 2022 6d65 222c 0a20  author": "me",. 
-000409c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000409d0: 2020 2020 2020 2022 7469 746c 6522 3a20         "title": 
-000409e0: 226d 7974 6974 6c65 222c 0a20 2020 2020  "mytitle",.     
-000409f0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00040a00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00040a10: 2020 2020 2020 6462 2c0a 2020 2020 2020        db,.      
-00040a20: 2020 2020 2020 2020 2020 2020 2020 6572                er
-00040a30: 726f 7273 3d5b 2261 6161 225d 2c0a 2020  rors=["aaa"],.  
-00040a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a50: 2020 6578 6973 7469 6e67 3d5b 5d2c 0a20    existing=[],. 
-00040a60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00040a70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00040a80: 2020 285b 2261 6161 222c 2022 225d 2c20    (["aaa", ""], 
-00040a90: 5b5d 292c 0a20 2020 2020 2020 2020 2020  []),.           
-00040aa0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-00040ab0: 672e 6173 7365 7274 5f63 616c 6c65 645f  g.assert_called_
-00040ac0: 6f6e 6365 5f77 6974 6828 2222 2c20 7361  once_with("", sa
-00040ad0: 7665 5175 6572 793d 4661 6c73 6529 0a20  veQuery=False). 
-00040ae0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-00040af0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-00040b00: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-00040b10: 6173 652e 456e 7472 6965 732e 6765 7442  ase.Entries.getB
-00040b20: 7942 6962 6b65 7922 2c20 7265 7475 726e  yBibkey", return
-00040b30: 5f76 616c 7565 3d5b 5d0a 2020 2020 2020  _value=[].      
-00040b40: 2020 2920 6173 205f 672c 2070 6174 6368    ) as _g, patch
-00040b50: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
-00040b60: 6879 7362 6962 6c69 6f2e 7765 6269 6d70  hysbiblio.webimp
-00040b70: 6f72 742e 6172 7869 762e 5765 6253 6561  ort.arxiv.WebSea
-00040b80: 7263 682e 7265 7472 6965 7665 5572 6c41  rch.retrieveUrlA
-00040b90: 6c6c 222c 0a20 2020 2020 2020 2020 2020  ll",.           
-00040ba0: 2072 6574 7572 6e5f 7661 6c75 653d 2822   return_value=("
-00040bb0: 6269 6274 6578 222c 207b 2261 6273 7472  bibtex", {"abstr
-00040bc0: 6163 7422 3a20 226d 7920 6162 7374 7261  act": "my abstra
-00040bd0: 6374 227d 292c 0a20 2020 2020 2020 2029  ct"}),.        )
-00040be0: 2061 7320 5f72 752c 2070 6174 6368 280a   as _ru, patch(.
-00040bf0: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
-00040c00: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
-00040c10: 2e45 6e74 7269 6573 2e69 6e73 6572 7422  .Entries.insert"
-00040c20: 2c20 7265 7475 726e 5f76 616c 7565 3d46  , return_value=F
-00040c30: 616c 7365 0a20 2020 2020 2020 2029 2061  alse.        ) a
-00040c40: 7320 5f69 3a0a 2020 2020 2020 2020 2020  s _i:.          
-00040c50: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00040c60: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00040c70: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00040c80: 6273 2e69 6d70 6f72 744f 6e65 4672 6f6d  bs.importOneFrom
-00040c90: 4269 6274 6578 4469 6374 280a 2020 2020  BibtexDict(.    
-00040ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040cb0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
-00040cc0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+000406f0: 2020 2020 2020 2022 7469 746c 6522 3a20         "title": 
+00040700: 226d 7974 6974 6c65 222c 0a20 2020 2020  "mytitle",.     
+00040710: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00040720: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00040730: 2020 2020 2020 6462 2c0a 2020 2020 2020        db,.      
+00040740: 2020 2020 2020 2020 2020 2020 2020 746f                to
+00040750: 743d 3130 302c 0a20 2020 2020 2020 2020  t=100,.         
+00040760: 2020 2020 2020 2020 2020 2065 7272 6f72             error
+00040770: 733d 5b22 4141 4122 5d2c 0a20 2020 2020  s=["AAA"],.     
+00040780: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00040790: 7869 7374 696e 673d 5b22 6566 6768 225d  xisting=["efgh"]
+000407a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000407b0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+000407c0: 2020 2020 2028 5b22 4141 4122 5d2c 205b       (["AAA"], [
+000407d0: 2265 6667 6822 2c20 2261 6263 6422 5d29  "efgh", "abcd"])
+000407e0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+000407f0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+00040800: 6368 2822 7068 7973 6269 626c 696f 2e64  ch("physbiblio.d
+00040810: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
+00040820: 6765 7442 7942 6962 6b65 7922 2c20 7265  getByBibkey", re
+00040830: 7475 726e 5f76 616c 7565 3d5b 5d29 2061  turn_value=[]) a
+00040840: 7320 5f67 3a0a 2020 2020 2020 2020 2020  s _g:.          
+00040850: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00040860: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00040870: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00040880: 6273 2e69 6d70 6f72 744f 6e65 4672 6f6d  bs.importOneFrom
+00040890: 4269 6274 6578 4469 6374 280a 2020 2020  BibtexDict(.    
+000408a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000408b0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+000408c0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+000408d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000408e0: 2022 454e 5452 5954 5950 4522 3a20 2261   "ENTRYTYPE": "a
+000408f0: 7274 6963 6c65 222c 0a20 2020 2020 2020  rticle",.       
+00040900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040910: 2022 4944 223a 2022 2020 222c 0a20 2020   "ID": "  ",.   
+00040920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040930: 2020 2020 2022 6175 7468 6f72 223a 2022       "author": "
+00040940: 6d65 222c 0a20 2020 2020 2020 2020 2020  me",.           
+00040950: 2020 2020 2020 2020 2020 2020 2022 7469               "ti
+00040960: 746c 6522 3a20 226d 7974 6974 6c65 222c  tle": "mytitle",
+00040970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040980: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+00040990: 2020 2020 2020 2020 2020 2020 6462 2c0a              db,.
+000409a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000409b0: 2020 2020 6572 726f 7273 3d5b 2261 6161      errors=["aaa
+000409c0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+000409d0: 2020 2020 2020 2020 6578 6973 7469 6e67          existing
+000409e0: 3d5b 5d2c 0a20 2020 2020 2020 2020 2020  =[],.           
+000409f0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00040a00: 2020 2020 2020 2020 285b 2261 6161 222c          (["aaa",
+00040a10: 2022 225d 2c20 5b5d 292c 0a20 2020 2020   ""], []),.     
+00040a20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00040a30: 2020 2020 205f 672e 6173 7365 7274 5f63       _g.assert_c
+00040a40: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+00040a50: 2222 2c20 7361 7665 5175 6572 793d 4661  "", saveQuery=Fa
+00040a60: 6c73 6529 0a20 2020 2020 2020 2077 6974  lse).        wit
+00040a70: 6820 7061 7463 6828 0a20 2020 2020 2020  h patch(.       
+00040a80: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+00040a90: 2e64 6174 6162 6173 652e 456e 7472 6965  .database.Entrie
+00040aa0: 732e 6765 7442 7942 6962 6b65 7922 2c20  s.getByBibkey", 
+00040ab0: 7265 7475 726e 5f76 616c 7565 3d5b 5d0a  return_value=[].
+00040ac0: 2020 2020 2020 2020 2920 6173 205f 672c          ) as _g,
+00040ad0: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+00040ae0: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+00040af0: 7765 6269 6d70 6f72 742e 6172 7869 762e  webimport.arxiv.
+00040b00: 5765 6253 6561 7263 682e 7265 7472 6965  WebSearch.retrie
+00040b10: 7665 5572 6c41 6c6c 222c 0a20 2020 2020  veUrlAll",.     
+00040b20: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
+00040b30: 6c75 653d 2822 6269 6274 6578 222c 207b  lue=("bibtex", {
+00040b40: 2261 6273 7472 6163 7422 3a20 226d 7920  "abstract": "my 
+00040b50: 6162 7374 7261 6374 227d 292c 0a20 2020  abstract"}),.   
+00040b60: 2020 2020 2029 2061 7320 5f72 752c 2070       ) as _ru, p
+00040b70: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+00040b80: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
+00040b90: 7461 6261 7365 2e45 6e74 7269 6573 2e69  tabase.Entries.i
+00040ba0: 6e73 6572 7422 2c20 7265 7475 726e 5f76  nsert", return_v
+00040bb0: 616c 7565 3d46 616c 7365 0a20 2020 2020  alue=False.     
+00040bc0: 2020 2029 2061 7320 5f69 3a0a 2020 2020     ) as _i:.    
+00040bd0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00040be0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00040bf0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00040c00: 4244 422e 6269 6273 2e69 6d70 6f72 744f  BDB.bibs.importO
+00040c10: 6e65 4672 6f6d 4269 6274 6578 4469 6374  neFromBibtexDict
+00040c20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00040c30: 2020 2020 2020 312c 0a20 2020 2020 2020        1,.       
+00040c40: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+00040c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c60: 2020 2020 2020 2022 454e 5452 5954 5950         "ENTRYTYP
+00040c70: 4522 3a20 2261 7274 6963 6c65 222c 0a20  E": "article",. 
+00040c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c90: 2020 2020 2020 2022 4944 223a 2022 6162         "ID": "ab
+00040ca0: 6364 222c 0a20 2020 2020 2020 2020 2020  cd",.           
+00040cb0: 2020 2020 2020 2020 2020 2020 2022 6175               "au
+00040cc0: 7468 6f72 223a 2022 6d65 222c 0a20 2020  thor": "me",.   
 00040cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ce0: 2022 454e 5452 5954 5950 4522 3a20 2261   "ENTRYTYPE": "a
-00040cf0: 7274 6963 6c65 222c 0a20 2020 2020 2020  rticle",.       
-00040d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040d10: 2022 4944 223a 2022 6162 6364 222c 0a20   "ID": "abcd",. 
-00040d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040d30: 2020 2020 2020 2022 6175 7468 6f72 223a         "author":
-00040d40: 2022 6d65 222c 0a20 2020 2020 2020 2020   "me",.         
-00040d50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00040d60: 7469 746c 6522 3a20 226d 7974 6974 6c65  title": "mytitle
-00040d70: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00040d80: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00040d90: 2020 2020 2020 2020 2020 2020 2020 6462                db
-00040da0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00040db0: 2020 2020 2020 6572 726f 7273 3d5b 5d2c        errors=[],
-00040dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040dd0: 2020 2020 2065 7869 7374 696e 673d 5b22       existing=["
-00040de0: 6161 6122 5d2c 0a20 2020 2020 2020 2020  aaa"],.         
-00040df0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00040e00: 2020 2020 2020 2020 2020 285b 2261 6263            (["abc
-00040e10: 6422 5d2c 205b 2261 6161 225d 292c 0a20  d"], ["aaa"]),. 
-00040e20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00040e30: 2020 2020 2020 2020 205f 7275 2e61 7373           _ru.ass
-00040e40: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-00040e50: 0a20 2020 2020 2020 2020 2020 205f 692e  .            _i.
-00040e60: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00040e70: 6365 2829 0a20 2020 2020 2020 2020 2020  ce().           
-00040e80: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00040e90: 6c28 5f69 2e63 616c 6c5f 6172 6773 5b30  l(_i.call_args[0
-00040ea0: 5d5b 305d 5b22 6162 7374 7261 6374 225d  ][0]["abstract"]
-00040eb0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00040ec0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00040ed0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00040ee0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00040ef0: 6269 6273 2e69 6d70 6f72 744f 6e65 4672  bibs.importOneFr
-00040f00: 6f6d 4269 6274 6578 4469 6374 280a 2020  omBibtexDict(.  
-00040f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040f20: 2020 312c 0a20 2020 2020 2020 2020 2020    1,.           
-00040f30: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00040ce0: 2020 2020 2022 7469 746c 6522 3a20 226d       "title": "m
+00040cf0: 7974 6974 6c65 222c 0a20 2020 2020 2020  ytitle",.       
+00040d00: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00040d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d20: 2020 2020 6462 2c0a 2020 2020 2020 2020      db,.        
+00040d30: 2020 2020 2020 2020 2020 2020 6572 726f              erro
+00040d40: 7273 3d5b 5d2c 0a20 2020 2020 2020 2020  rs=[],.         
+00040d50: 2020 2020 2020 2020 2020 2065 7869 7374             exist
+00040d60: 696e 673d 5b22 6161 6122 5d2c 0a20 2020  ing=["aaa"],.   
+00040d70: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
+00040d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d90: 285b 2261 6263 6422 5d2c 205b 2261 6161  (["abcd"], ["aaa
+00040da0: 225d 292c 0a20 2020 2020 2020 2020 2020  "]),.           
+00040db0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
+00040dc0: 7275 2e61 7373 6572 745f 6e6f 745f 6361  ru.assert_not_ca
+00040dd0: 6c6c 6564 2829 0a20 2020 2020 2020 2020  lled().         
+00040de0: 2020 205f 692e 6173 7365 7274 5f63 616c     _i.assert_cal
+00040df0: 6c65 645f 6f6e 6365 2829 0a20 2020 2020  led_once().     
+00040e00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00040e10: 7274 4571 7561 6c28 5f69 2e63 616c 6c5f  rtEqual(_i.call_
+00040e20: 6172 6773 5b30 5d5b 305d 5b22 6162 7374  args[0][0]["abst
+00040e30: 7261 6374 225d 2c20 4e6f 6e65 290a 2020  ract"], None).  
+00040e40: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00040e50: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00040e60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00040e70: 2e70 4244 422e 6269 6273 2e69 6d70 6f72  .pBDB.bibs.impor
+00040e80: 744f 6e65 4672 6f6d 4269 6274 6578 4469  tOneFromBibtexDi
+00040e90: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00040ea0: 2020 2020 2020 2020 312c 0a20 2020 2020          1,.     
+00040eb0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00040ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040ed0: 2020 2020 2020 2020 2022 454e 5452 5954           "ENTRYT
+00040ee0: 5950 4522 3a20 2261 7274 6963 6c65 222c  YPE": "article",
+00040ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040f00: 2020 2020 2020 2020 2022 4944 223a 2022           "ID": "
+00040f10: 6162 6364 222c 0a20 2020 2020 2020 2020  abcd",.         
+00040f20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00040f30: 6175 7468 6f72 223a 2022 6d65 222c 0a20  author": "me",. 
 00040f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040f50: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-00040f60: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-00040f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040f80: 2020 2022 4944 223a 2022 6162 6364 222c     "ID": "abcd",
-00040f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040fa0: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
-00040fb0: 223a 2022 6d65 222c 0a20 2020 2020 2020  ": "me",.       
-00040fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040fd0: 2022 7469 746c 6522 3a20 226d 7974 6974   "title": "mytit
-00040fe0: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
-00040ff0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-00041000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041010: 6462 2c0a 2020 2020 2020 2020 2020 2020  db,.            
-00041020: 2020 2020 2020 2020 636f 6d70 6c65 7465          complete
-00041030: 496e 666f 3d54 7275 652c 0a20 2020 2020  Info=True,.     
-00041040: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00041050: 7272 6f72 733d 5b5d 2c0a 2020 2020 2020  rrors=[],.      
-00041060: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00041070: 6973 7469 6e67 3d5b 2261 6161 225d 2c0a  isting=["aaa"],.
-00041080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041090: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000410a0: 2020 2028 5b22 6162 6364 225d 2c20 5b22     (["abcd"], ["
-000410b0: 6161 6122 5d29 2c0a 2020 2020 2020 2020  aaa"]),.        
-000410c0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000410d0: 2020 5f72 752e 6173 7365 7274 5f6e 6f74    _ru.assert_not
-000410e0: 5f63 616c 6c65 6428 290a 2020 2020 2020  _called().      
-000410f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00041100: 7445 7175 616c 285f 692e 6361 6c6c 5f61  tEqual(_i.call_a
-00041110: 7267 735b 305d 5b30 5d5b 2261 6273 7472  rgs[0][0]["abstr
-00041120: 6163 7422 5d2c 204e 6f6e 6529 0a20 2020  act"], None).   
-00041130: 2020 2020 2020 2020 2077 6974 6820 7061           with pa
-00041140: 7463 682e 6469 6374 2870 6243 6f6e 6669  tch.dict(pbConfi
-00041150: 672e 7061 7261 6d73 2c20 7b22 6665 7463  g.params, {"fetc
-00041160: 6841 6273 7472 6163 7422 3a20 5472 7565  hAbstract": True
-00041170: 7d2c 2063 6c65 6172 3d46 616c 7365 293a  }, clear=False):
-00041180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00041190: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000411a0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-000411b0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-000411c0: 2e62 6962 732e 696d 706f 7274 4f6e 6546  .bibs.importOneF
-000411d0: 726f 6d42 6962 7465 7844 6963 7428 0a20  romBibtexDict(. 
-000411e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000411f0: 2020 2020 2020 2031 2c0a 2020 2020 2020         1,.      
+00040f50: 2020 2020 2020 2022 7469 746c 6522 3a20         "title": 
+00040f60: 226d 7974 6974 6c65 222c 0a20 2020 2020  "mytitle",.     
+00040f70: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00040f80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00040f90: 2020 2020 2020 6462 2c0a 2020 2020 2020        db,.      
+00040fa0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00040fb0: 6d70 6c65 7465 496e 666f 3d54 7275 652c  mpleteInfo=True,
+00040fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040fd0: 2020 2020 2065 7272 6f72 733d 5b5d 2c0a       errors=[],.
+00040fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ff0: 2020 2020 6578 6973 7469 6e67 3d5b 2261      existing=["a
+00041000: 6161 225d 2c0a 2020 2020 2020 2020 2020  aa"],.          
+00041010: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+00041020: 2020 2020 2020 2020 2028 5b22 6162 6364           (["abcd
+00041030: 225d 2c20 5b22 6161 6122 5d29 2c0a 2020  "], ["aaa"]),.  
+00041040: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00041050: 2020 2020 2020 2020 5f72 752e 6173 7365          _ru.asse
+00041060: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00041070: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00041080: 2e61 7373 6572 7445 7175 616c 285f 692e  .assertEqual(_i.
+00041090: 6361 6c6c 5f61 7267 735b 305d 5b30 5d5b  call_args[0][0][
+000410a0: 2261 6273 7472 6163 7422 5d2c 204e 6f6e  "abstract"], Non
+000410b0: 6529 0a20 2020 2020 2020 2020 2020 2077  e).            w
+000410c0: 6974 6820 7061 7463 682e 6469 6374 2870  ith patch.dict(p
+000410d0: 6243 6f6e 6669 672e 7061 7261 6d73 2c20  bConfig.params, 
+000410e0: 7b22 6665 7463 6841 6273 7472 6163 7422  {"fetchAbstract"
+000410f0: 3a20 5472 7565 7d2c 2063 6c65 6172 3d46  : True}, clear=F
+00041100: 616c 7365 293a 0a20 2020 2020 2020 2020  alse):.         
+00041110: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00041120: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00041130: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00041140: 662e 7042 4442 2e62 6962 732e 696d 706f  f.pBDB.bibs.impo
+00041150: 7274 4f6e 6546 726f 6d42 6962 7465 7844  rtOneFromBibtexD
+00041160: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
+00041170: 2020 2020 2020 2020 2020 2020 2031 2c0a               1,.
+00041180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041190: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+000411a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000411b0: 2020 2020 2020 2245 4e54 5259 5459 5045        "ENTRYTYPE
+000411c0: 223a 2022 6172 7469 636c 6522 2c0a 2020  ": "article",.  
+000411d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000411e0: 2020 2020 2020 2020 2020 2249 4422 3a20            "ID": 
+000411f0: 2261 6263 6422 2c0a 2020 2020 2020 2020  "abcd",.        
 00041200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041210: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00041220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041230: 2245 4e54 5259 5459 5045 223a 2022 6172  "ENTRYTYPE": "ar
-00041240: 7469 636c 6522 2c0a 2020 2020 2020 2020  ticle",.        
-00041250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041260: 2020 2020 2249 4422 3a20 2261 6263 6422      "ID": "abcd"
-00041270: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00041280: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-00041290: 7574 686f 7222 3a20 226d 6522 2c0a 2020  uthor": "me",.  
+00041210: 2020 2020 2261 7574 686f 7222 3a20 226d      "author": "m
+00041220: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00041230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041240: 2274 6974 6c65 223a 2022 6d79 7469 746c  "title": "mytitl
+00041250: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00041260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041270: 2265 7072 696e 7422 3a20 2231 3233 3435  "eprint": "12345
+00041280: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00041290: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
 000412a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000412b0: 2020 2020 2020 2020 2020 2274 6974 6c65            "title
-000412c0: 223a 2022 6d79 7469 746c 6522 2c0a 2020  ": "mytitle",.  
-000412d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000412e0: 2020 2020 2020 2020 2020 2265 7072 696e            "eprin
-000412f0: 7422 3a20 2231 3233 3435 222c 0a20 2020  t": "12345",.   
-00041300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041310: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00041320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041330: 6462 2c0a 2020 2020 2020 2020 2020 2020  db,.            
-00041340: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00041350: 6c65 7465 496e 666f 3d46 616c 7365 2c0a  leteInfo=False,.
-00041360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041370: 2020 2020 2020 2020 6572 726f 7273 3d5b          errors=[
-00041380: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00041390: 2020 2020 2020 2020 2020 2065 7869 7374             exist
-000413a0: 696e 673d 5b22 6161 6122 5d2c 0a20 2020  ing=["aaa"],.   
-000413b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000413c0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-000413d0: 2020 2020 2020 2020 285b 2261 6263 6422          (["abcd"
-000413e0: 5d2c 205b 2261 6161 225d 292c 0a20 2020  ], ["aaa"]),.   
-000413f0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00041400: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00041410: 7275 2e61 7373 6572 745f 6e6f 745f 6361  ru.assert_not_ca
-00041420: 6c6c 6564 2829 0a20 2020 2020 2020 2020  lled().         
-00041430: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00041440: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00041450: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00041460: 662e 7042 4442 2e62 6962 732e 696d 706f  f.pBDB.bibs.impo
-00041470: 7274 4f6e 6546 726f 6d42 6962 7465 7844  rtOneFromBibtexD
-00041480: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
-00041490: 2020 2020 2020 2020 2020 2020 2031 2c0a               1,.
+000412b0: 2020 2020 2020 6462 2c0a 2020 2020 2020        db,.      
+000412c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000412d0: 2020 636f 6d70 6c65 7465 496e 666f 3d46    completeInfo=F
+000412e0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+000412f0: 2020 2020 2020 2020 2020 2020 2020 6572                er
+00041300: 726f 7273 3d5b 5d2c 0a20 2020 2020 2020  rors=[],.       
+00041310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041320: 2065 7869 7374 696e 673d 5b22 6161 6122   existing=["aaa"
+00041330: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00041340: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00041350: 2020 2020 2020 2020 2020 2020 2020 285b                ([
+00041360: 2261 6263 6422 5d2c 205b 2261 6161 225d  "abcd"], ["aaa"]
+00041370: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00041380: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00041390: 2020 2020 205f 7275 2e61 7373 6572 745f       _ru.assert_
+000413a0: 6e6f 745f 6361 6c6c 6564 2829 0a20 2020  not_called().   
+000413b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000413c0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+000413d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000413e0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+000413f0: 732e 696d 706f 7274 4f6e 6546 726f 6d42  s.importOneFromB
+00041400: 6962 7465 7844 6963 7428 0a20 2020 2020  ibtexDict(.     
+00041410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041420: 2020 2031 2c0a 2020 2020 2020 2020 2020     1,.          
+00041430: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+00041440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041450: 2020 2020 2020 2020 2020 2020 2245 4e54              "ENT
+00041460: 5259 5459 5045 223a 2022 6172 7469 636c  RYTYPE": "articl
+00041470: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00041480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041490: 2249 4422 3a20 2261 6263 6422 2c0a 2020  "ID": "abcd",.  
 000414a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000414b0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-000414c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000414d0: 2020 2020 2020 2245 4e54 5259 5459 5045        "ENTRYTYPE
-000414e0: 223a 2022 6172 7469 636c 6522 2c0a 2020  ": "article",.  
-000414f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041500: 2020 2020 2020 2020 2020 2249 4422 3a20            "ID": 
-00041510: 2261 6263 6422 2c0a 2020 2020 2020 2020  "abcd",.        
-00041520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041530: 2020 2020 2261 7574 686f 7222 3a20 226d      "author": "m
-00041540: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00041550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041560: 2274 6974 6c65 223a 2022 6d79 7469 746c  "title": "mytitl
-00041570: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00041580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041590: 2265 7072 696e 7422 3a20 2231 3233 3435  "eprint": "12345
-000415a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000415b0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-000415c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000415d0: 2020 2020 2020 6462 2c0a 2020 2020 2020        db,.      
-000415e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000415f0: 2020 636f 6d70 6c65 7465 496e 666f 3d54    completeInfo=T
-00041600: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-00041610: 2020 2020 2020 2020 2020 2020 2065 7272               err
-00041620: 6f72 733d 5b5d 2c0a 2020 2020 2020 2020  ors=[],.        
-00041630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041640: 6578 6973 7469 6e67 3d5b 2261 6161 225d  existing=["aaa"]
-00041650: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00041660: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-00041670: 2020 2020 2020 2020 2020 2020 2028 5b22               (["
-00041680: 6162 6364 225d 2c20 5b22 6161 6122 5d29  abcd"], ["aaa"])
-00041690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000416a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000416b0: 5f72 752e 6173 7365 7274 5f63 616c 6c65  _ru.assert_calle
-000416c0: 645f 6f6e 6365 5f77 6974 6828 2231 3233  d_once_with("123
-000416d0: 3435 222c 2073 6561 7263 6854 7970 653d  45", searchType=
-000416e0: 2269 6422 2c20 6675 6c6c 4469 6374 3d54  "id", fullDict=T
-000416f0: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-00041700: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00041710: 6c28 5f69 2e63 616c 6c5f 6172 6773 5b30  l(_i.call_args[0
-00041720: 5d5b 305d 5b22 6162 7374 7261 6374 225d  ][0]["abstract"]
-00041730: 2c20 226d 7920 6162 7374 7261 6374 2229  , "my abstract")
-00041740: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00041750: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
-00041760: 4244 422e 6269 6273 2e6c 6173 7449 6e73  BDB.bibs.lastIns
-00041770: 6572 7465 642c 205b 5d29 0a20 2020 2020  erted, []).     
-00041780: 2020 2077 6974 6820 7061 7463 6828 0a20     with patch(. 
-00041790: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
-000417a0: 6269 626c 696f 2e64 6174 6162 6173 652e  biblio.database.
-000417b0: 456e 7472 6965 732e 6765 7442 7942 6962  Entries.getByBib
-000417c0: 6b65 7922 2c20 7265 7475 726e 5f76 616c  key", return_val
-000417d0: 7565 3d5b 5d0a 2020 2020 2020 2020 2920  ue=[].        ) 
-000417e0: 6173 205f 672c 2070 6174 6368 280a 2020  as _g, patch(.  
-000417f0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-00041800: 6962 6c69 6f2e 6461 7461 6261 7365 2e45  iblio.database.E
-00041810: 6e74 7269 6573 2e69 6e73 6572 7422 2c20  ntries.insert", 
-00041820: 7265 7475 726e 5f76 616c 7565 3d54 7275  return_value=Tru
-00041830: 650a 2020 2020 2020 2020 2920 6173 205f  e.        ) as _
-00041840: 692c 2070 6174 6368 280a 2020 2020 2020  i, patch(.      
-00041850: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-00041860: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
-00041870: 6573 2e75 7064 6174 6549 6e73 7069 7265  es.updateInspire
-00041880: 4944 222c 2072 6574 7572 6e5f 7661 6c75  ID", return_valu
-00041890: 653d 2231 3233 220a 2020 2020 2020 2020  e="123".        
-000418a0: 2920 6173 205f 7569 2c20 7061 7463 6828  ) as _ui, patch(
-000418b0: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-000418c0: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-000418d0: 652e 456e 7472 6965 732e 7570 6461 7465  e.Entries.update
-000418e0: 496e 666f 4672 6f6d 4f41 4922 0a20 2020  InfoFromOAI".   
-000418f0: 2020 2020 2029 2061 7320 5f75 6f2c 2070       ) as _uo, p
-00041900: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
-00041910: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
-00041920: 7461 6261 7365 2e43 6174 7345 6e74 7269  tabase.CatsEntri
-00041930: 6573 2e69 6e73 6572 7422 0a20 2020 2020  es.insert".     
-00041940: 2020 2029 2061 7320 5f63 3a0a 2020 2020     ) as _c:.    
-00041950: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00041960: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00041970: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00041980: 4244 422e 6269 6273 2e69 6d70 6f72 744f  BDB.bibs.importO
-00041990: 6e65 4672 6f6d 4269 6274 6578 4469 6374  neFromBibtexDict
-000419a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000419b0: 2020 2020 2020 312c 0a20 2020 2020 2020        1,.       
-000419c0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-000419d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000419e0: 2020 2020 2020 2022 454e 5452 5954 5950         "ENTRYTYP
-000419f0: 4522 3a20 2261 7274 6963 6c65 222c 0a20  E": "article",. 
+000414b0: 2020 2020 2020 2020 2020 2261 7574 686f            "autho
+000414c0: 7222 3a20 226d 6522 2c0a 2020 2020 2020  r": "me",.      
+000414d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000414e0: 2020 2020 2020 2274 6974 6c65 223a 2022        "title": "
+000414f0: 6d79 7469 746c 6522 2c0a 2020 2020 2020  mytitle",.      
+00041500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041510: 2020 2020 2020 2265 7072 696e 7422 3a20        "eprint": 
+00041520: 2231 3233 3435 222c 0a20 2020 2020 2020  "12345",.       
+00041530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041540: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00041550: 2020 2020 2020 2020 2020 2020 6462 2c0a              db,.
+00041560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041570: 2020 2020 2020 2020 636f 6d70 6c65 7465          complete
+00041580: 496e 666f 3d54 7275 652c 0a20 2020 2020  Info=True,.     
+00041590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000415a0: 2020 2065 7272 6f72 733d 5b5d 2c0a 2020     errors=[],.  
+000415b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000415c0: 2020 2020 2020 6578 6973 7469 6e67 3d5b        existing=[
+000415d0: 2261 6161 225d 2c0a 2020 2020 2020 2020  "aaa"],.        
+000415e0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+000415f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041600: 2020 2028 5b22 6162 6364 225d 2c20 5b22     (["abcd"], ["
+00041610: 6161 6122 5d29 2c0a 2020 2020 2020 2020  aaa"]),.        
+00041620: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00041630: 2020 2020 2020 5f72 752e 6173 7365 7274        _ru.assert
+00041640: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+00041650: 6828 2231 3233 3435 222c 2073 6561 7263  h("12345", searc
+00041660: 6854 7970 653d 2269 6422 2c20 6675 6c6c  hType="id", full
+00041670: 4469 6374 3d54 7275 6529 0a20 2020 2020  Dict=True).     
+00041680: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00041690: 7274 4571 7561 6c28 5f69 2e63 616c 6c5f  rtEqual(_i.call_
+000416a0: 6172 6773 5b30 5d5b 305d 5b22 6162 7374  args[0][0]["abst
+000416b0: 7261 6374 225d 2c20 226d 7920 6162 7374  ract"], "my abst
+000416c0: 7261 6374 2229 0a20 2020 2020 2020 2073  ract").        s
+000416d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000416e0: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
+000416f0: 6173 7449 6e73 6572 7465 642c 205b 5d29  astInserted, [])
+00041700: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
+00041710: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+00041720: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
+00041730: 6162 6173 652e 456e 7472 6965 732e 6765  abase.Entries.ge
+00041740: 7442 7942 6962 6b65 7922 2c20 7265 7475  tByBibkey", retu
+00041750: 726e 5f76 616c 7565 3d5b 5d0a 2020 2020  rn_value=[].    
+00041760: 2020 2020 2920 6173 205f 672c 2070 6174      ) as _g, pat
+00041770: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+00041780: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+00041790: 6261 7365 2e45 6e74 7269 6573 2e69 6e73  base.Entries.ins
+000417a0: 6572 7422 2c20 7265 7475 726e 5f76 616c  ert", return_val
+000417b0: 7565 3d54 7275 650a 2020 2020 2020 2020  ue=True.        
+000417c0: 2920 6173 205f 692c 2070 6174 6368 280a  ) as _i, patch(.
+000417d0: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+000417e0: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+000417f0: 2e45 6e74 7269 6573 2e75 7064 6174 6549  .Entries.updateI
+00041800: 6e73 7069 7265 4944 222c 2072 6574 7572  nspireID", retur
+00041810: 6e5f 7661 6c75 653d 2231 3233 220a 2020  n_value="123".  
+00041820: 2020 2020 2020 2920 6173 205f 7569 2c20        ) as _ui, 
+00041830: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
+00041840: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
+00041850: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
+00041860: 7570 6461 7465 496e 666f 4672 6f6d 4f41  updateInfoFromOA
+00041870: 4922 0a20 2020 2020 2020 2029 2061 7320  I".        ) as 
+00041880: 5f75 6f2c 2070 6174 6368 280a 2020 2020  _uo, patch(.    
+00041890: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
+000418a0: 6c69 6f2e 6461 7461 6261 7365 2e43 6174  lio.database.Cat
+000418b0: 7345 6e74 7269 6573 2e69 6e73 6572 7422  sEntries.insert"
+000418c0: 0a20 2020 2020 2020 2029 2061 7320 5f63  .        ) as _c
+000418d0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+000418e0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+000418f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041900: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
+00041910: 6d70 6f72 744f 6e65 4672 6f6d 4269 6274  mportOneFromBibt
+00041920: 6578 4469 6374 280a 2020 2020 2020 2020  exDict(.        
+00041930: 2020 2020 2020 2020 2020 2020 312c 0a20              1,. 
+00041940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041950: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00041960: 2020 2020 2020 2020 2020 2020 2022 454e               "EN
+00041970: 5452 5954 5950 4522 3a20 2261 7274 6963  TRYTYPE": "artic
+00041980: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+00041990: 2020 2020 2020 2020 2020 2020 2022 4944               "ID
+000419a0: 223a 2022 6162 6364 222c 0a20 2020 2020  ": "abcd",.     
+000419b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000419c0: 2020 2022 6175 7468 6f72 223a 2022 6d65     "author": "me
+000419d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000419e0: 2020 2020 2020 2020 2020 2022 7469 746c             "titl
+000419f0: 6522 3a20 226d 7974 6974 6c65 222c 0a20  e": "mytitle",. 
 00041a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041a10: 2020 2020 2020 2022 4944 223a 2022 6162         "ID": "ab
-00041a20: 6364 222c 0a20 2020 2020 2020 2020 2020  cd",.           
-00041a30: 2020 2020 2020 2020 2020 2020 2022 6175               "au
-00041a40: 7468 6f72 223a 2022 6d65 222c 0a20 2020  thor": "me",.   
-00041a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041a60: 2020 2020 2022 7469 746c 6522 3a20 226d       "title": "m
-00041a70: 7974 6974 6c65 222c 0a20 2020 2020 2020  ytitle",.       
-00041a80: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-00041a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041aa0: 2020 2020 6462 2c0a 2020 2020 2020 2020      db,.        
-00041ab0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00041ac0: 6c65 7465 496e 666f 3d46 616c 7365 2c0a  leteInfo=False,.
-00041ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041ae0: 2020 2020 6572 726f 7273 3d5b 5d2c 0a20      errors=[],. 
-00041af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041b00: 2020 2065 7869 7374 696e 673d 5b22 6161     existing=["aa
-00041b10: 6122 5d2c 0a20 2020 2020 2020 2020 2020  a"],.           
-00041b20: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00041b30: 2020 2020 2020 2020 285b 5d2c 205b 2261          ([], ["a
-00041b40: 6161 225d 292c 0a20 2020 2020 2020 2020  aa"]),.         
-00041b50: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00041b60: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00041b70: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
-00041b80: 2e6c 6173 7449 6e73 6572 7465 642c 205b  .lastInserted, [
-00041b90: 2261 6263 6422 5d29 0a20 2020 2020 2020  "abcd"]).       
-00041ba0: 2020 2020 205f 7569 2e61 7373 6572 745f       _ui.assert_
-00041bb0: 6e6f 745f 6361 6c6c 6564 2829 0a20 2020  not_called().   
-00041bc0: 2020 2020 2020 2020 205f 756f 2e61 7373           _uo.ass
-00041bd0: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-00041be0: 0a20 2020 2020 2020 2020 2020 205f 632e  .            _c.
-00041bf0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00041c00: 6365 5f77 6974 6828 5b5d 2c20 2261 6263  ce_with([], "abc
-00041c10: 6422 290a 2020 2020 2020 2020 2020 2020  d").            
-00041c20: 5f69 2e61 7373 6572 745f 6361 6c6c 6564  _i.assert_called
-00041c30: 5f6f 6e63 6528 290a 2020 2020 2020 2020  _once().        
-00041c40: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00041c50: 7175 616c 285f 692e 6361 6c6c 5f61 7267  qual(_i.call_arg
-00041c60: 735b 305d 5b30 5d5b 2261 6273 7472 6163  s[0][0]["abstrac
-00041c70: 7422 5d2c 204e 6f6e 6529 0a20 2020 2020  t"], None).     
-00041c80: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00041c90: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00041ca0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00041cb0: 4442 2e62 6962 732e 696d 706f 7274 4f6e  DB.bibs.importOn
-00041cc0: 6546 726f 6d42 6962 7465 7844 6963 7428  eFromBibtexDict(
-00041cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00041ce0: 2020 2020 2031 2c0a 2020 2020 2020 2020       1,.        
-00041cf0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00041d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041d10: 2020 2020 2020 2245 4e54 5259 5459 5045        "ENTRYTYPE
-00041d20: 223a 2022 6172 7469 636c 6522 2c0a 2020  ": "article",.  
+00041a10: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+00041a20: 2020 2020 2020 2020 2020 6462 2c0a 2020            db,.  
+00041a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041a40: 2020 636f 6d70 6c65 7465 496e 666f 3d46    completeInfo=F
+00041a50: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00041a60: 2020 2020 2020 2020 2020 6572 726f 7273            errors
+00041a70: 3d5b 5d2c 0a20 2020 2020 2020 2020 2020  =[],.           
+00041a80: 2020 2020 2020 2020 2065 7869 7374 696e           existin
+00041a90: 673d 5b22 6161 6122 5d2c 0a20 2020 2020  g=["aaa"],.     
+00041aa0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+00041ab0: 2020 2020 2020 2020 2020 2020 2020 285b                ([
+00041ac0: 5d2c 205b 2261 6161 225d 292c 0a20 2020  ], ["aaa"]),.   
+00041ad0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00041ae0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00041af0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+00041b00: 422e 6269 6273 2e6c 6173 7449 6e73 6572  B.bibs.lastInser
+00041b10: 7465 642c 205b 2261 6263 6422 5d29 0a20  ted, ["abcd"]). 
+00041b20: 2020 2020 2020 2020 2020 205f 7569 2e61             _ui.a
+00041b30: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+00041b40: 2829 0a20 2020 2020 2020 2020 2020 205f  ().            _
+00041b50: 756f 2e61 7373 6572 745f 6e6f 745f 6361  uo.assert_not_ca
+00041b60: 6c6c 6564 2829 0a20 2020 2020 2020 2020  lled().         
+00041b70: 2020 205f 632e 6173 7365 7274 5f63 616c     _c.assert_cal
+00041b80: 6c65 645f 6f6e 6365 5f77 6974 6828 5b5d  led_once_with([]
+00041b90: 2c20 2261 6263 6422 290a 2020 2020 2020  , "abcd").      
+00041ba0: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
+00041bb0: 6361 6c6c 6564 5f6f 6e63 6528 290a 2020  called_once().  
+00041bc0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00041bd0: 7373 6572 7445 7175 616c 285f 692e 6361  ssertEqual(_i.ca
+00041be0: 6c6c 5f61 7267 735b 305d 5b30 5d5b 2261  ll_args[0][0]["a
+00041bf0: 6273 7472 6163 7422 5d2c 204e 6f6e 6529  bstract"], None)
+00041c00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00041c10: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00041c20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00041c30: 656c 662e 7042 4442 2e62 6962 732e 696d  elf.pBDB.bibs.im
+00041c40: 706f 7274 4f6e 6546 726f 6d42 6962 7465  portOneFromBibte
+00041c50: 7844 6963 7428 0a20 2020 2020 2020 2020  xDict(.         
+00041c60: 2020 2020 2020 2020 2020 2031 2c0a 2020             1,.  
+00041c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041c80: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
+00041c90: 2020 2020 2020 2020 2020 2020 2245 4e54              "ENT
+00041ca0: 5259 5459 5045 223a 2022 6172 7469 636c  RYTYPE": "articl
+00041cb0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00041cc0: 2020 2020 2020 2020 2020 2020 2249 4422              "ID"
+00041cd0: 3a20 2263 6465 6622 2c0a 2020 2020 2020  : "cdef",.      
+00041ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041cf0: 2020 2261 7574 686f 7222 3a20 226d 6522    "author": "me"
+00041d00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00041d10: 2020 2020 2020 2020 2020 2274 6974 6c65            "title
+00041d20: 223a 2022 6d79 7469 746c 6522 2c0a 2020  ": "mytitle",.  
 00041d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041d40: 2020 2020 2020 2249 4422 3a20 2263 6465        "ID": "cde
-00041d50: 6622 2c0a 2020 2020 2020 2020 2020 2020  f",.            
-00041d60: 2020 2020 2020 2020 2020 2020 2261 7574              "aut
-00041d70: 686f 7222 3a20 226d 6522 2c0a 2020 2020  hor": "me",.    
-00041d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041d90: 2020 2020 2274 6974 6c65 223a 2022 6d79      "title": "my
-00041da0: 7469 746c 6522 2c0a 2020 2020 2020 2020  title",.        
-00041db0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
-00041dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041dd0: 2020 2064 622c 0a20 2020 2020 2020 2020     db,.         
-00041de0: 2020 2020 2020 2020 2020 2063 6f6d 706c             compl
-00041df0: 6574 6549 6e66 6f3d 4661 6c73 652c 0a20  eteInfo=False,. 
-00041e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e10: 2020 2065 7272 6f72 733d 5b5d 2c0a 2020     errors=[],.  
-00041e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e30: 2020 6578 6973 7469 6e67 3d5b 2261 6161    existing=["aaa
-00041e40: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-00041e50: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-00041e60: 2020 2020 2020 2028 5b5d 2c20 5b22 6161         ([], ["aa
-00041e70: 6122 5d29 2c0a 2020 2020 2020 2020 2020  a"]),.          
-00041e80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00041e90: 5f75 692e 6173 7365 7274 5f6e 6f74 5f63  _ui.assert_not_c
-00041ea0: 616c 6c65 6428 290a 2020 2020 2020 2020  alled().        
-00041eb0: 2020 2020 5f75 6f2e 6173 7365 7274 5f6e      _uo.assert_n
-00041ec0: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
-00041ed0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00041ee0: 6572 7445 7175 616c 285f 692e 6361 6c6c  ertEqual(_i.call
-00041ef0: 5f61 7267 735b 305d 5b30 5d5b 2261 6273  _args[0][0]["abs
-00041f00: 7472 6163 7422 5d2c 204e 6f6e 6529 0a20  tract"], None). 
-00041f10: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00041f20: 7061 7463 682e 6469 6374 280a 2020 2020  patch.dict(.    
-00041f30: 2020 2020 2020 2020 2020 2020 7062 436f              pbCo
-00041f40: 6e66 6967 2e70 6172 616d 732c 0a20 2020  nfig.params,.   
-00041f50: 2020 2020 2020 2020 2020 2020 207b 2266               {"f
-00041f60: 6574 6368 4162 7374 7261 6374 223a 2046  etchAbstract": F
-00041f70: 616c 7365 2c20 2264 6566 6175 6c74 4361  alse, "defaultCa
-00041f80: 7465 676f 7269 6573 223a 205b 312c 2032  tegories": [1, 2
-00041f90: 2c20 335d 7d2c 0a20 2020 2020 2020 2020  , 3]},.         
-00041fa0: 2020 2020 2020 2063 6c65 6172 3d46 616c         clear=Fal
-00041fb0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00041fc0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00041fd0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00041fe0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00041ff0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00042000: 4442 2e62 6962 732e 696d 706f 7274 4f6e  DB.bibs.importOn
-00042010: 6546 726f 6d42 6962 7465 7844 6963 7428  eFromBibtexDict(
-00042020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042030: 2020 2020 2020 2020 2031 2c0a 2020 2020           1,.    
+00041d40: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
+00041d50: 2020 2020 2020 2020 2064 622c 0a20 2020           db,.   
+00041d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041d70: 2063 6f6d 706c 6574 6549 6e66 6f3d 4661   completeInfo=Fa
+00041d80: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00041d90: 2020 2020 2020 2020 2065 7272 6f72 733d           errors=
+00041da0: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
+00041db0: 2020 2020 2020 2020 6578 6973 7469 6e67          existing
+00041dc0: 3d5b 2261 6161 225d 2c0a 2020 2020 2020  =["aaa"],.      
+00041dd0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00041de0: 2020 2020 2020 2020 2020 2020 2028 5b5d               ([]
+00041df0: 2c20 5b22 6161 6122 5d29 2c0a 2020 2020  , ["aaa"]),.    
+00041e00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00041e10: 2020 2020 2020 5f75 692e 6173 7365 7274        _ui.assert
+00041e20: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
+00041e30: 2020 2020 2020 2020 2020 5f75 6f2e 6173            _uo.as
+00041e40: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+00041e50: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00041e60: 6c66 2e61 7373 6572 7445 7175 616c 285f  lf.assertEqual(_
+00041e70: 692e 6361 6c6c 5f61 7267 735b 305d 5b30  i.call_args[0][0
+00041e80: 5d5b 2261 6273 7472 6163 7422 5d2c 204e  ]["abstract"], N
+00041e90: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
+00041ea0: 2077 6974 6820 7061 7463 682e 6469 6374   with patch.dict
+00041eb0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00041ec0: 2020 7062 436f 6e66 6967 2e70 6172 616d    pbConfig.param
+00041ed0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00041ee0: 2020 207b 2266 6574 6368 4162 7374 7261     {"fetchAbstra
+00041ef0: 6374 223a 2046 616c 7365 2c20 2264 6566  ct": False, "def
+00041f00: 6175 6c74 4361 7465 676f 7269 6573 223a  aultCategories":
+00041f10: 205b 312c 2032 2c20 335d 7d2c 0a20 2020   [1, 2, 3]},.   
+00041f20: 2020 2020 2020 2020 2020 2020 2063 6c65               cle
+00041f30: 6172 3d46 616c 7365 2c0a 2020 2020 2020  ar=False,.      
+00041f40: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00041f50: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00041f60: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00041f70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00041f80: 656c 662e 7042 4442 2e62 6962 732e 696d  elf.pBDB.bibs.im
+00041f90: 706f 7274 4f6e 6546 726f 6d42 6962 7465  portOneFromBibte
+00041fa0: 7844 6963 7428 0a20 2020 2020 2020 2020  xDict(.         
+00041fb0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
+00041fc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00041fd0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00041fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041ff0: 2020 2020 2020 2020 2245 4e54 5259 5459          "ENTRYTY
+00042000: 5045 223a 2022 6172 7469 636c 6522 2c0a  PE": "article",.
+00042010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042020: 2020 2020 2020 2020 2020 2020 2249 4422              "ID"
+00042030: 3a20 2265 6667 6822 2c0a 2020 2020 2020  : "efgh",.      
 00042040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042050: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-00042060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042070: 2020 2245 4e54 5259 5459 5045 223a 2022    "ENTRYTYPE": "
-00042080: 6172 7469 636c 6522 2c0a 2020 2020 2020  article",.      
-00042090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000420a0: 2020 2020 2020 2249 4422 3a20 2265 6667        "ID": "efg
-000420b0: 6822 2c0a 2020 2020 2020 2020 2020 2020  h",.            
-000420c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000420d0: 2261 7574 686f 7222 3a20 226d 6522 2c0a  "author": "me",.
+00042050: 2020 2020 2020 2261 7574 686f 7222 3a20        "author": 
+00042060: 226d 6522 2c0a 2020 2020 2020 2020 2020  "me",.          
+00042070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042080: 2020 2274 6974 6c65 223a 2022 6d79 7469    "title": "myti
+00042090: 746c 6522 2c0a 2020 2020 2020 2020 2020  tle",.          
+000420a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000420b0: 2020 2265 7072 696e 7422 3a20 2231 3233    "eprint": "123
+000420c0: 3435 222c 0a20 2020 2020 2020 2020 2020  45",.           
+000420d0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
 000420e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000420f0: 2020 2020 2020 2020 2020 2020 2274 6974              "tit
-00042100: 6c65 223a 2022 6d79 7469 746c 6522 2c0a  le": "mytitle",.
-00042110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042120: 2020 2020 2020 2020 2020 2020 2265 7072              "epr
-00042130: 696e 7422 3a20 2231 3233 3435 222c 0a20  int": "12345",. 
-00042140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042150: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00042160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042170: 2020 6462 2c0a 2020 2020 2020 2020 2020    db,.          
-00042180: 2020 2020 2020 2020 2020 2020 2020 6572                er
-00042190: 726f 7273 3d5b 2262 6262 225d 2c0a 2020  rors=["bbb"],.  
-000421a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000421b0: 2020 2020 2020 6578 6973 7469 6e67 3d5b        existing=[
-000421c0: 2261 6161 225d 2c0a 2020 2020 2020 2020  "aaa"],.        
-000421d0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-000421e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000421f0: 2020 2028 5b22 6262 6222 5d2c 205b 2261     (["bbb"], ["a
-00042200: 6161 225d 292c 0a20 2020 2020 2020 2020  aa"]),.         
-00042210: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00042220: 2020 2020 205f 632e 6173 7365 7274 5f63       _c.assert_c
-00042230: 616c 6c65 645f 7769 7468 285b 312c 2032  alled_with([1, 2
-00042240: 2c20 335d 2c20 2265 6667 6822 290a 2020  , 3], "efgh").  
-00042250: 2020 2020 2020 2020 2020 5f75 692e 6173            _ui.as
-00042260: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-00042270: 5f77 6974 6828 2265 6667 6822 290a 2020  _with("efgh").  
-00042280: 2020 2020 2020 2020 2020 5f75 6f2e 6173            _uo.as
-00042290: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-000422a0: 5f77 6974 6828 2231 3233 2229 0a20 2020  _with("123").   
-000422b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000422c0: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-000422d0: 6269 6273 2e6c 6173 7449 6e73 6572 7465  bibs.lastInserte
-000422e0: 642c 205b 2261 6263 6422 2c20 2263 6465  d, ["abcd", "cde
-000422f0: 6622 2c20 2265 6667 6822 5d29 0a0a 2020  f", "efgh"])..  
-00042300: 2020 6465 6620 7465 7374 5f69 6e73 6572    def test_inser
-00042310: 7428 7365 6c66 2c20 2a61 7267 7329 3a0a  t(self, *args):.
-00042320: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00042330: 696e 7365 7274 696f 6e20 616e 6420 6f66  insertion and of
-00042340: 2062 6962 7465 7820 6974 656d 7322 2222   bibtex items"""
-00042350: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00042360: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
-00042370: 4244 422e 6269 6273 2e67 6574 4669 656c  BDB.bibs.getFiel
-00042380: 6428 2261 6263 222c 2022 6269 626b 6579  d("abc", "bibkey
-00042390: 2229 290a 2020 2020 2020 2020 6461 7461  ")).        data
-000423a0: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
-000423b0: 732e 7072 6570 6172 6549 6e73 6572 7428  s.prepareInsert(
-000423c0: 0a20 2020 2020 2020 2020 2020 2027 4061  .            '@a
-000423d0: 7274 6963 6c65 7b61 6263 2c5c 6e61 7574  rticle{abc,\naut
-000423e0: 686f 7220 3d20 226d 6522 2c5c 6e74 6974  hor = "me",\ntit
-000423f0: 6c65 203d 2022 6162 6322 2c7d 272c 2061  le = "abc",}', a
-00042400: 7278 6976 3d22 6162 6322 0a20 2020 2020  rxiv="abc".     
-00042410: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00042420: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-00042430: 662e 7042 4442 2e62 6962 732e 696e 7365  f.pBDB.bibs.inse
-00042440: 7274 2864 6174 6129 290a 2020 2020 2020  rt(data)).      
-00042450: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00042460: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
-00042470: 732e 6765 7446 6965 6c64 2822 6162 6322  s.getField("abc"
-00042480: 2c20 2262 6962 6b65 7922 292c 2022 6162  , "bibkey"), "ab
-00042490: 6322 290a 2020 2020 2020 2020 7365 6c66  c").        self
-000424a0: 2e70 4244 422e 756e 646f 2876 6572 626f  .pBDB.undo(verbo
-000424b0: 7365 3d46 616c 7365 290a 2020 2020 2020  se=False).      
-000424c0: 2020 6465 6c20 6461 7461 5b22 6172 7869    del data["arxi
-000424d0: 7622 5d0a 2020 2020 2020 2020 7365 6c66  v"].        self
-000424e0: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
-000424f0: 662e 7042 4442 2e62 6962 732e 696e 7365  f.pBDB.bibs.inse
-00042500: 7274 2864 6174 6129 290a 2020 2020 2020  rt(data)).      
-00042510: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
-00042520: 6767 696e 672e 4c6f 6767 6572 2e65 7863  gging.Logger.exc
-00042530: 6570 7469 6f6e 2229 2061 7320 5f69 3a0a  eption") as _i:.
-00042540: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00042550: 2e70 4244 422e 6269 6273 2e69 6e73 6572  .pBDB.bibs.inser
-00042560: 7428 6461 7461 290a 2020 2020 2020 2020  t(data).        
-00042570: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-00042580: 6e28 2259 6f75 2064 6964 206e 6f74 2073  n("You did not s
-00042590: 7570 706c 7920 6120 7661 6c75 6520 666f  upply a value fo
-000425a0: 7220 6269 6e64 696e 6722 2c20 5f69 2e63  r binding", _i.c
-000425b0: 616c 6c5f 6172 6773 5b30 5d5b 305d 290a  all_args[0][0]).
-000425c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000425d0: 6572 7454 7275 6528 0a20 2020 2020 2020  ertTrue(.       
-000425e0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000425f0: 6962 732e 696e 7365 7274 4672 6f6d 4269  ibs.insertFromBi
-00042600: 6274 6578 280a 2020 2020 2020 2020 2020  btex(.          
-00042610: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
-00042620: 6768 692c 5c6e 6175 7468 6f72 203d 2022  ghi,\nauthor = "
-00042630: 6d65 222c 5c6e 7469 746c 6520 3d20 2267  me",\ntitle = "g
-00042640: 6869 222c 7d27 0a20 2020 2020 2020 2020  hi",}'.         
-00042650: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
-00042660: 2020 2020 4075 6e69 7474 6573 742e 736b      @unittest.sk
-00042670: 6970 4966 2873 6b69 7054 6573 7473 5365  ipIf(skipTestsSe
-00042680: 7474 696e 6773 2e6f 6e6c 696e 652c 2022  ttings.online, "
-00042690: 4f6e 6c69 6e65 2074 6573 7473 2229 0a20  Online tests"). 
-000426a0: 2020 2064 6566 2074 6573 745f 6c6f 6164     def test_load
-000426b0: 416e 6449 6e73 6572 745f 6f6e 6c69 6e65  AndInsert_online
-000426c0: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-000426d0: 2020 2020 2020 2022 2222 7465 7374 7320         """tests 
-000426e0: 666f 7220 6c6f 6164 416e 6449 6e73 6572  for loadAndInser
-000426f0: 7420 7769 7468 206f 6e6c 696e 6520 636f  t with online co
-00042700: 6e6e 6563 7469 6f6e 2222 220a 2020 2020  nnection""".    
-00042710: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00042720: 7275 6528 0a20 2020 2020 2020 2020 2020  rue(.           
-00042730: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00042740: 6c6f 6164 416e 6449 6e73 6572 7428 5b22  loadAndInsert(["
-00042750: 4761 7269 617a 7a6f 3a32 3031 3572 7261  Gariazzo:2015rra
-00042760: 222c 2022 506c 616e 636b 3a32 3031 3370  ", "Planck:2013p
-00042770: 7862 225d 290a 2020 2020 2020 2020 290a  xb"]).        ).
-00042780: 2020 2020 2020 2020 616c 6c5f 203d 2073          all_ = s
-00042790: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-000427a0: 7441 6c6c 2829 0a20 2020 2020 2020 2073  tAll().        s
-000427b0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000427c0: 6c65 6e28 616c 6c5f 292c 2032 290a 2020  len(all_), 2).  
-000427d0: 2020 2020 2020 6966 2061 6c6c 5f5b 305d        if all_[0]
-000427e0: 5b22 6269 626b 6579 225d 2021 3d20 2247  ["bibkey"] != "G
-000427f0: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
-00042800: 3a0a 2020 2020 2020 2020 2020 2020 616c  :.            al
-00042810: 6c5f 2e72 6576 6572 7365 2829 0a20 2020  l_.reverse().   
-00042820: 2020 2020 2072 6573 203d 2061 6c6c 5f5b       res = all_[
-00042830: 305d 0a20 2020 2020 2020 2073 656c 662e  0].        self.
-00042840: 6173 7365 7274 5472 7565 2872 6573 5b22  assertTrue(res["
-00042850: 6369 7461 7469 6f6e 7322 5d20 3e20 3234  citations"] > 24
-00042860: 3029 0a20 2020 2020 2020 2073 656c 662e  0).        self.
-00042870: 6173 7365 7274 5472 7565 2872 6573 5b22  assertTrue(res["
-00042880: 6369 7461 7469 6f6e 735f 6e6f 5f73 656c  citations_no_sel
-00042890: 6622 5d20 3e20 3139 3029 0a20 2020 2020  f"] > 190).     
-000428a0: 2020 2064 656c 2072 6573 5b22 6369 7461     del res["cita
-000428b0: 7469 6f6e 7322 5d0a 2020 2020 2020 2020  tions"].        
-000428c0: 6465 6c20 7265 735b 2263 6974 6174 696f  del res["citatio
-000428d0: 6e73 5f6e 6f5f 7365 6c66 225d 0a20 2020  ns_no_self"].   
-000428e0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000428f0: 4571 7561 6c28 7265 732c 2066 756c 6c52  Equal(res, fullR
-00042900: 6563 6f72 6447 6172 6961 7a7a 6f29 0a20  ecordGariazzo). 
-00042910: 2020 2020 2020 2072 6573 203d 2061 6c6c         res = all
-00042920: 5f5b 315d 0a20 2020 2020 2020 2073 656c  _[1].        sel
-00042930: 662e 6173 7365 7274 5472 7565 2872 6573  f.assertTrue(res
-00042940: 5b22 6369 7461 7469 6f6e 7322 5d20 3e20  ["citations"] > 
-00042950: 3733 3030 290a 2020 2020 2020 2020 7365  7300).        se
-00042960: 6c66 2e61 7373 6572 7454 7275 6528 7265  lf.assertTrue(re
-00042970: 735b 2263 6974 6174 696f 6e73 5f6e 6f5f  s["citations_no_
-00042980: 7365 6c66 225d 203e 2036 3930 3029 0a20  self"] > 6900). 
-00042990: 2020 2020 2020 2064 656c 2072 6573 5b22         del res["
-000429a0: 6369 7461 7469 6f6e 7322 5d0a 2020 2020  citations"].    
-000429b0: 2020 2020 6465 6c20 7265 735b 2263 6974      del res["cit
-000429c0: 6174 696f 6e73 5f6e 6f5f 7365 6c66 225d  ations_no_self"]
-000429d0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000429e0: 7365 7274 4571 7561 6c28 7265 732c 2066  sertEqual(res, f
-000429f0: 756c 6c52 6563 6f72 6441 6465 290a 0a20  ullRecordAde).. 
-00042a00: 2020 2064 6566 2074 6573 745f 6c6f 6164     def test_load
-00042a10: 416e 6449 6e73 6572 7428 7365 6c66 2c20  AndInsert(self, 
-00042a20: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
-00042a30: 2222 2274 6573 7473 2066 6f72 206c 6f61  """tests for loa
-00042a40: 6441 6e64 496e 7365 7274 2061 6e64 206c  dAndInsert and l
-00042a50: 6f61 6441 6e64 496e 7365 7274 5769 7468  oadAndInsertWith
-00042a60: 4361 7473 2028 6d6f 636b 6564 2922 2222  Cats (mocked)"""
-00042a70: 0a20 2020 2020 2020 2023 206c 6f61 6441  .        # loadA
-00042a80: 6e64 496e 7365 7274 0a20 2020 2020 2020  ndInsert.       
-00042a90: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
-00042aa0: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
-00042ab0: 2e6c 6f61 6441 6e64 496e 7365 7274 284e  .loadAndInsert(N
-00042ac0: 6f6e 6529 290a 2020 2020 2020 2020 7769  one)).        wi
-00042ad0: 7468 2070 6174 6368 2822 6c6f 6767 696e  th patch("loggin
-00042ae0: 672e 4c6f 6767 6572 2e65 7272 6f72 2229  g.Logger.error")
-00042af0: 2061 7320 5f65 3a0a 2020 2020 2020 2020   as _e:.        
-00042b00: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00042b10: 6273 2e6c 6f61 6441 6e64 496e 7365 7274  bs.loadAndInsert
-00042b20: 284e 6f6e 6529 0a20 2020 2020 2020 2020  (None).         
-00042b30: 2020 205f 652e 6173 7365 7274 5f61 6e79     _e.assert_any
-00042b40: 5f63 616c 6c28 2249 6e76 616c 6964 2061  _call("Invalid a
-00042b50: 7267 756d 656e 7473 2122 290a 2020 2020  rguments!").    
-00042b60: 2020 2020 2320 6d65 7468 6f64 730a 2020      # methods.  
-00042b70: 2020 2020 2020 666f 7220 6d65 7468 6f64        for method
-00042b80: 2069 6e20 2822 696e 7370 6972 6522 2c20   in ("inspire", 
-00042b90: 2264 6f69 222c 2022 6172 7869 7622 2c20  "doi", "arxiv", 
-00042ba0: 2269 7362 6e22 293a 0a20 2020 2020 2020  "isbn"):.       
-00042bb0: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-00042bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042bd0: 2022 7068 7973 6269 626c 696f 2e77 6562   "physbiblio.web
-00042be0: 696d 706f 7274 2e25 732e 5765 6253 6561  import.%s.WebSea
-00042bf0: 7263 682e 7265 7472 6965 7665 5572 6c41  rch.retrieveUrlA
-00042c00: 6c6c 2220 2520 6d65 7468 6f64 2c0a 2020  ll" % method,.  
-00042c10: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00042c20: 7475 726e 5f76 616c 7565 3d22 222c 0a20  turn_value="",. 
-00042c30: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00042c40: 7574 6f73 7065 633d 5472 7565 2c0a 2020  utospec=True,.  
-00042c50: 2020 2020 2020 2020 2020 2920 6173 205f            ) as _
-00042c60: 6d6f 636b 3a0a 2020 2020 2020 2020 2020  mock:.          
-00042c70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00042c80: 7446 616c 7365 2873 656c 662e 7042 4442  tFalse(self.pBDB
-00042c90: 2e62 6962 732e 6c6f 6164 416e 6449 6e73  .bibs.loadAndIns
-00042ca0: 6572 7428 2261 6263 6465 6622 2c20 6d65  ert("abcdef", me
-00042cb0: 7468 6f64 3d6d 6574 686f 6429 290a 2020  thod=method)).  
-00042cc0: 2020 2020 2020 2020 2020 2020 2020 5f6d                _m
-00042cd0: 6f63 6b2e 6173 7365 7274 5f63 616c 6c65  ock.assert_calle
-00042ce0: 645f 6f6e 6365 5f77 6974 6828 7068 7973  d_once_with(phys
-00042cf0: 4269 626c 696f 5765 622e 7765 6253 6561  BiblioWeb.webSea
-00042d00: 7263 685b 6d65 7468 6f64 5d2c 2022 6162  rch[method], "ab
-00042d10: 6364 6566 2229 0a20 2020 2020 2020 2073  cdef").        s
-00042d20: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
-00042d30: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
-00042d40: 6f61 6441 6e64 496e 7365 7274 2822 6162  oadAndInsert("ab
-00042d50: 6364 6566 222c 206d 6574 686f 643d 226e  cdef", method="n
-00042d60: 6f6e 6578 6973 7465 6e74 2229 290a 2020  onexistent")).  
-00042d70: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00042d80: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-00042d90: 2e65 7863 6570 7469 6f6e 2229 2061 7320  .exception") as 
-00042da0: 5f65 3a0a 2020 2020 2020 2020 2020 2020  _e:.            
-00042db0: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
-00042dc0: 6f61 6441 6e64 496e 7365 7274 2822 6162  oadAndInsert("ab
-00042dd0: 6364 6566 222c 206d 6574 686f 643d 226e  cdef", method="n
-00042de0: 6f6e 6578 6973 7465 6e74 2229 0a20 2020  onexistent").   
-00042df0: 2020 2020 2020 2020 205f 652e 6173 7365           _e.asse
-00042e00: 7274 5f61 6e79 5f63 616c 6c28 224d 6574  rt_any_call("Met
-00042e10: 686f 6420 6e6f 7420 7661 6c69 643a 206e  hod not valid: n
-00042e20: 6f6e 6578 6973 7465 6e74 2229 0a20 2020  onexistent").   
-00042e30: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00042e40: 5472 7565 280a 2020 2020 2020 2020 2020  True(.          
-00042e50: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00042e60: 2e6c 6f61 6441 6e64 496e 7365 7274 280a  .loadAndInsert(.
-00042e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042e80: 2740 6172 7469 636c 657b 6162 632c 5c6e  '@article{abc,\n
-00042e90: 6175 7468 6f72 3d22 6d65 222c 5c6e 7469  author="me",\nti
-00042ea0: 746c 653d 2261 6263 222c 5c6e 7d27 2c20  tle="abc",\n}', 
-00042eb0: 6d65 7468 6f64 3d22 6269 6274 6578 220a  method="bibtex".
-00042ec0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00042ed0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00042ee0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00042ef0: 285b 655b 2262 6962 6b65 7922 5d20 666f  ([e["bibkey"] fo
-00042f00: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
-00042f10: 2e62 6962 732e 6765 7441 6c6c 2829 5d2c  .bibs.getAll()],
-00042f20: 205b 2261 6263 225d 290a 2020 2020 2020   ["abc"]).      
-00042f30: 2020 2320 6368 696c 6450 726f 6365 7373    # childProcess
-00042f40: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00042f50: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
-00042f60: 4244 422e 6269 6273 2e6c 6173 7449 6e73  BDB.bibs.lastIns
-00042f70: 6572 7465 642c 205b 2261 6263 225d 290a  erted, ["abc"]).
-00042f80: 2020 2020 2020 2020 2320 696d 706f 7365          # impose
-00042f90: 4b65 790a 2020 2020 2020 2020 7365 6c66  Key.        self
-00042fa0: 2e61 7373 6572 7454 7275 6528 0a20 2020  .assertTrue(.   
-00042fb0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00042fc0: 4442 2e62 6962 732e 6c6f 6164 416e 6449  DB.bibs.loadAndI
-00042fd0: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
-00042fe0: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
-00042ff0: 7b61 6263 2c5c 6e61 7574 686f 723d 226d  {abc,\nauthor="m
-00043000: 6522 2c5c 6e74 6974 6c65 3d22 6162 6322  e",\ntitle="abc"
-00043010: 2c5c 6e7d 272c 0a20 2020 2020 2020 2020  ,\n}',.         
-00043020: 2020 2020 2020 2069 6d70 6f73 654b 6579         imposeKey
-00043030: 3d22 6465 6622 2c0a 2020 2020 2020 2020  ="def",.        
-00043040: 2020 2020 2020 2020 6d65 7468 6f64 3d22          method="
-00043050: 6269 6274 6578 222c 0a20 2020 2020 2020  bibtex",.       
-00043060: 2020 2020 2020 2020 2063 6869 6c64 5072           childPr
-00043070: 6f63 6573 733d 5472 7565 2c0a 2020 2020  ocess=True,.    
-00043080: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00043090: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-000430a0: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-000430b0: 662e 7042 4442 2e62 6962 732e 6c61 7374  f.pBDB.bibs.last
-000430c0: 496e 7365 7274 6564 2c20 5b22 6162 6322  Inserted, ["abc"
-000430d0: 2c20 2264 6566 225d 290a 2020 2020 2020  , "def"]).      
-000430e0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000430f0: 616c 285b 655b 2262 6962 6b65 7922 5d20  al([e["bibkey"] 
-00043100: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-00043110: 4442 2e62 6962 732e 6765 7441 6c6c 2829  DB.bibs.getAll()
-00043120: 5d2c 205b 2261 6263 222c 2022 6465 6622  ], ["abc", "def"
-00043130: 5d29 0a20 2020 2020 2020 2061 6c6c 4269  ]).        allBi
-00043140: 6274 6578 7320 3d20 5b65 5b22 6269 6274  btexs = [e["bibt
-00043150: 6578 225d 2066 6f72 2065 2069 6e20 7365  ex"] for e in se
-00043160: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-00043170: 416c 6c28 295d 0a20 2020 2020 2020 2073  All()].        s
-00043180: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00043190: 616c 6c42 6962 7465 7873 5b30 5d2e 7265  allBibtexs[0].re
-000431a0: 706c 6163 6528 227b 6162 632c 222c 2022  place("{abc,", "
-000431b0: 7b64 6566 2c22 292c 2061 6c6c 4269 6274  {def,"), allBibt
-000431c0: 6578 735b 315d 290a 2020 2020 2020 2020  exs[1]).        
-000431d0: 2320 6578 6973 7469 6e67 0a20 2020 2020  # existing.     
-000431e0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000431f0: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
-00043200: 6273 2e63 6f75 6e74 2829 2c20 3229 0a20  bs.count(), 2). 
-00043210: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00043220: 7274 5472 7565 280a 2020 2020 2020 2020  rtTrue(.        
-00043230: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00043240: 6273 2e6c 6f61 6441 6e64 496e 7365 7274  bs.loadAndInsert
-00043250: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00043260: 2020 2740 6172 7469 636c 657b 6162 632c    '@article{abc,
-00043270: 5c6e 6175 7468 6f72 3d22 6d65 222c 5c6e  \nauthor="me",\n
-00043280: 7469 746c 653d 2261 6263 222c 5c6e 7d27  title="abc",\n}'
-00043290: 2c20 6d65 7468 6f64 3d22 6269 6274 6578  , method="bibtex
-000432a0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-000432b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000432c0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000432d0: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
-000432e0: 732e 636f 756e 7428 292c 2032 290a 2020  s.count(), 2).  
-000432f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00043300: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00043310: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00043320: 6273 2e6c 6f61 6441 6e64 496e 7365 7274  bs.loadAndInsert
-00043330: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00043340: 2020 2740 6172 7469 636c 657b 6162 632c    '@article{abc,
-00043350: 5c6e 6175 7468 6f72 3d22 6d65 222c 5c6e  \nauthor="me",\n
-00043360: 7469 746c 653d 2261 6263 222c 5c6e 7d27  title="abc",\n}'
-00043370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00043380: 2020 6d65 7468 6f64 3d22 6269 6274 6578    method="bibtex
-00043390: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000433a0: 2020 2072 6574 7572 6e42 6962 7465 783d     returnBibtex=
-000433b0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-000433c0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-000433d0: 2027 4041 7274 6963 6c65 7b61 6263 2c5c   '@Article{abc,\
-000433e0: 6e20 2020 2020 2020 2061 7574 686f 7220  n        author 
-000433f0: 3d20 226d 6522 2c5c 6e20 2020 2020 2020  = "me",\n       
-00043400: 2020 2720 2b20 2774 6974 6c65 203d 2022    ' + 'title = "
-00043410: 7b61 6263 7d22 2c5c 6e7d 272c 0a20 2020  {abc}",\n}',.   
-00043420: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
-00043430: 6974 6820 7061 7463 6828 0a20 2020 2020  ith patch(.     
-00043440: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
-00043450: 696f 2e64 6174 6162 6173 652e 456e 7472  io.database.Entr
-00043460: 6965 732e 6368 6563 6b45 7869 7374 696e  ies.checkExistin
-00043470: 6745 6e74 7279 222c 0a20 2020 2020 2020  gEntry",.       
-00043480: 2020 2020 2073 6964 655f 6566 6665 6374       side_effect
-00043490: 3d5b 5b5d 2c20 5b7b 2262 6962 6b65 7922  =[[], [{"bibkey"
-000434a0: 3a20 2261 6263 222c 2022 6f6c 645f 6b65  : "abc", "old_ke
-000434b0: 7973 223a 204e 6f6e 657d 5d5d 2c0a 2020  ys": None}]],.  
-000434c0: 2020 2020 2020 2920 6173 205f 6365 2c20        ) as _ce, 
-000434d0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-000434e0: 2020 2022 7068 7973 6269 626c 696f 2e77     "physbiblio.w
-000434f0: 6562 696d 706f 7274 2e69 6e73 7069 7265  ebimport.inspire
-00043500: 2e57 6562 5365 6172 6368 2e72 6574 7269  .WebSearch.retri
-00043510: 6576 6555 726c 416c 6c22 2c0a 2020 2020  eveUrlAll",.    
-00043520: 2020 2020 2020 2020 7265 7475 726e 5f76          return_v
-00043530: 616c 7565 3d27 4041 7274 6963 6c65 7b61  alue='@Article{a
-00043540: 6263 2c5c 6e20 2020 2020 2020 2061 7574  bc,\n        aut
-00043550: 686f 7220 3d20 226d 6522 2c5c 6e20 2020  hor = "me",\n   
-00043560: 2020 2020 2020 270a 2020 2020 2020 2020        '.        
-00043570: 2020 2020 2b20 2774 6974 6c65 203d 2022      + 'title = "
-00043580: 7b61 6263 7d22 2c5c 6e7d 272c 0a20 2020  {abc}",\n}',.   
-00043590: 2020 2020 2029 2061 7320 5f72 753a 0a20       ) as _ru:. 
-000435a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000435b0: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
-000435c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000435d0: 2e70 4244 422e 6269 6273 2e6c 6f61 6441  .pBDB.bibs.loadA
-000435e0: 6e64 496e 7365 7274 280a 2020 2020 2020  ndInsert(.      
-000435f0: 2020 2020 2020 2020 2020 2020 2020 2278                "x
-00043600: 797a 222c 0a20 2020 2020 2020 2020 2020  yz",.           
-00043610: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00043620: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00043630: 205f 6365 2e61 7373 6572 745f 616e 795f   _ce.assert_any_
-00043640: 6361 6c6c 2822 7879 7a22 290a 2020 2020  call("xyz").    
-00043650: 2020 2020 2020 2020 5f63 652e 6173 7365          _ce.asse
-00043660: 7274 5f63 616c 6c65 645f 7769 7468 2822  rt_called_with("
-00043670: 6162 6322 2c20 6172 7869 763d 2222 2c20  abc", arxiv="", 
-00043680: 646f 693d 4e6f 6e65 290a 2020 2020 2020  doi=None).      
-00043690: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000436a0: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
-000436b0: 2e62 6962 732e 6765 7442 794b 6579 2822  .bibs.getByKey("
-000436c0: 6162 6322 295b 305d 5b22 6f6c 645f 6b65  abc")[0]["old_ke
-000436d0: 7973 225d 2c20 2278 797a 2229 0a20 2020  ys"], "xyz").   
-000436e0: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-000436f0: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-00043700: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-00043710: 652e 456e 7472 6965 732e 6368 6563 6b45  e.Entries.checkE
-00043720: 7869 7374 696e 6745 6e74 7279 222c 0a20  xistingEntry",. 
-00043730: 2020 2020 2020 2020 2020 2073 6964 655f             side_
-00043740: 6566 6665 6374 3d5b 5b5d 2c20 5b7b 2262  effect=[[], [{"b
-00043750: 6962 6b65 7922 3a20 2261 6263 222c 2022  ibkey": "abc", "
-00043760: 6f6c 645f 6b65 7973 223a 2022 7879 7a22  old_keys": "xyz"
-00043770: 7d5d 5d2c 0a20 2020 2020 2020 2029 2061  }]],.        ) a
-00043780: 7320 5f63 652c 2070 6174 6368 280a 2020  s _ce, patch(.  
-00043790: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-000437a0: 6962 6c69 6f2e 7765 6269 6d70 6f72 742e  iblio.webimport.
-000437b0: 696e 7370 6972 652e 5765 6253 6561 7263  inspire.WebSearc
-000437c0: 682e 7265 7472 6965 7665 5572 6c41 6c6c  h.retrieveUrlAll
-000437d0: 222c 0a20 2020 2020 2020 2020 2020 2072  ",.            r
-000437e0: 6574 7572 6e5f 7661 6c75 653d 2740 4172  eturn_value='@Ar
-000437f0: 7469 636c 657b 6162 632c 5c6e 2020 2020  ticle{abc,\n    
-00043800: 2020 2020 6175 7468 6f72 203d 2022 6d65      author = "me
-00043810: 222c 5c6e 2020 2020 2020 2020 2027 0a20  ",\n         '. 
-00043820: 2020 2020 2020 2020 2020 202b 2027 7469             + 'ti
-00043830: 746c 6520 3d20 227b 6162 637d 222c 5c6e  tle = "{abc}",\n
-00043840: 7d27 2c0a 2020 2020 2020 2020 2920 6173  }',.        ) as
-00043850: 205f 7275 3a0a 2020 2020 2020 2020 2020   _ru:.          
-00043860: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00043870: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00043880: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00043890: 732e 6c6f 6164 416e 6449 6e73 6572 7428  s.loadAndInsert(
-000438a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000438b0: 2020 2020 2022 7071 7222 2c0a 2020 2020       "pqr",.    
-000438c0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000438d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000438e0: 2020 2020 2020 2020 5f63 652e 6173 7365          _ce.asse
-000438f0: 7274 5f61 6e79 5f63 616c 6c28 2270 7172  rt_any_call("pqr
-00043900: 2229 0a20 2020 2020 2020 2020 2020 205f  ").            _
-00043910: 6365 2e61 7373 6572 745f 6361 6c6c 6564  ce.assert_called
-00043920: 5f77 6974 6828 2261 6263 222c 2061 7278  _with("abc", arx
-00043930: 6976 3d22 222c 2064 6f69 3d4e 6f6e 6529  iv="", doi=None)
-00043940: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00043950: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-00043960: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-00043970: 4279 4b65 7928 2261 6263 2229 5b30 5d5b  ByKey("abc")[0][
-00043980: 226f 6c64 5f6b 6579 7322 5d2c 2022 7879  "old_keys"], "xy
-00043990: 7a2c 7071 7222 290a 2020 2020 2020 2020  z,pqr").        
-000439a0: 2320 7265 7475 726e 4269 6274 6578 0a20  # returnBibtex. 
-000439b0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000439c0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-000439d0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000439e0: 6962 732e 6c6f 6164 416e 6449 6e73 6572  ibs.loadAndInser
-000439f0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00043a00: 2020 2027 4061 7274 6963 6c65 7b67 6869     '@article{ghi
-00043a10: 2c5c 6e61 7574 686f 723d 226d 6522 2c5c  ,\nauthor="me",\
-00043a20: 6e74 6974 6c65 3d22 6768 6922 2c5c 6e7d  ntitle="ghi",\n}
-00043a30: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00043a40: 2020 206d 6574 686f 643d 2262 6962 7465     method="bibte
-00043a50: 7822 2c0a 2020 2020 2020 2020 2020 2020  x",.            
-00043a60: 2020 2020 7265 7475 726e 4269 6274 6578      returnBibtex
-00043a70: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
-00043a80: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-00043a90: 2020 2740 4172 7469 636c 657b 6768 692c    '@Article{ghi,
-00043aa0: 5c6e 2020 2020 2020 2020 6175 7468 6f72  \n        author
-00043ab0: 203d 2022 6d65 222c 5c6e 2020 2020 2020   = "me",\n      
-00043ac0: 2020 2027 202b 2027 7469 746c 6520 3d20     ' + 'title = 
-00043ad0: 227b 6768 697d 222c 5c6e 7d27 2c0a 2020  "{ghi}",\n}',.  
-00043ae0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00043af0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00043b00: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-00043b10: 6c61 7374 496e 7365 7274 6564 2c20 5b22  lastInserted, ["
-00043b20: 6768 6922 5d29 0a20 2020 2020 2020 2023  ghi"]).        #
-00043b30: 2075 6e72 6561 6461 626c 6520 6269 6274   unreadable bibt
-00043b40: 6578 2028 6269 6274 6578 206d 6574 686f  ex (bibtex metho
-00043b50: 6429 0a20 2020 2020 2020 2073 656c 662e  d).        self.
-00043b60: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
-00043b70: 2e70 4244 422e 6269 6273 2e6c 6f61 6441  .pBDB.bibs.loadA
-00043b80: 6e64 496e 7365 7274 2822 4061 7274 6963  ndInsert("@artic
-00043b90: 6c65 7b6a 6b6c 2c22 2c20 6d65 7468 6f64  le{jkl,", method
-00043ba0: 3d22 6269 6274 6578 2229 290a 0a20 2020  ="bibtex"))..   
-00043bb0: 2020 2020 2073 656c 662e 7042 4442 2e75       self.pBDB.u
-00043bc0: 6e64 6f28 7665 7262 6f73 653d 3029 0a20  ndo(verbose=0). 
-00043bd0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-00043be0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-00043bf0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-00043c00: 6173 652e 456e 7472 6965 732e 7570 6461  ase.Entries.upda
-00043c10: 7465 496e 7370 6972 6549 4422 2c0a 2020  teInspireID",.  
-00043c20: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00043c30: 5f76 616c 7565 3d22 3122 2c0a 2020 2020  _value="1",.    
-00043c40: 2020 2020 2020 2020 6175 746f 7370 6563          autospec
-00043c50: 3d54 7275 652c 0a20 2020 2020 2020 2029  =True,.        )
-00043c60: 2061 7320 5f6d 6f63 6b5f 7569 6964 2c20   as _mock_uiid, 
-00043c70: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-00043c80: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
-00043c90: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
-00043ca0: 7570 6461 7465 496e 666f 4672 6f6d 4f41  updateInfoFromOA
-00043cb0: 4922 2c0a 2020 2020 2020 2020 2020 2020  I",.            
-00043cc0: 7265 7475 726e 5f76 616c 7565 3d54 7275  return_value=Tru
-00043cd0: 652c 0a20 2020 2020 2020 2020 2020 2061  e,.            a
-00043ce0: 7574 6f73 7065 633d 5472 7565 2c0a 2020  utospec=True,.  
-00043cf0: 2020 2020 2020 2920 6173 205f 6d6f 636b        ) as _mock
-00043d00: 5f75 696f 2c20 7061 7463 682e 6469 6374  _uio, patch.dict
-00043d10: 280a 2020 2020 2020 2020 2020 2020 7062  (.            pb
-00043d20: 436f 6e66 6967 2e70 6172 616d 732c 0a20  Config.params,. 
-00043d30: 2020 2020 2020 2020 2020 207b 2266 6574             {"fet
-00043d40: 6368 4162 7374 7261 6374 223a 2046 616c  chAbstract": Fal
-00043d50: 7365 2c20 2264 6566 6175 6c74 4361 7465  se, "defaultCate
-00043d60: 676f 7269 6573 223a 205b 315d 7d2c 0a20  gories": [1]},. 
-00043d70: 2020 2020 2020 2020 2020 2063 6c65 6172             clear
-00043d80: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00043d90: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-00043da0: 2074 6573 7420 6164 6420 6361 7465 676f   test add catego
-00043db0: 7269 6573 0a20 2020 2020 2020 2020 2020  ries.           
-00043dc0: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
-00043dd0: 2020 2020 2020 2020 2020 2020 2022 7068               "ph
-00043de0: 7973 6269 626c 696f 2e77 6562 696d 706f  ysbiblio.webimpo
-00043df0: 7274 2e69 6e73 7069 7265 2e57 6562 5365  rt.inspire.WebSe
-00043e00: 6172 6368 2e72 6574 7269 6576 6555 726c  arch.retrieveUrl
-00043e10: 416c 6c22 2c0a 2020 2020 2020 2020 2020  All",.          
-00043e20: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
-00043e30: 7565 3d22 5c6e 4061 7274 6963 6c65 7b6b  ue="\n@article{k
-00043e40: 6579 302c 5c6e 220a 2020 2020 2020 2020  ey0,\n".        
-00043e50: 2020 2020 2020 2020 2b20 2761 7574 686f          + 'autho
-00043e60: 7220 3d20 2247 6172 6961 7a7a 6f22 2c5c  r = "Gariazzo",\
-00043e70: 6e74 6974 6c65 203d 2022 7b74 6974 6c65  ntitle = "{title
-00043e80: 7d22 2c7d 5c6e 272c 0a20 2020 2020 2020  }",}\n',.       
-00043e90: 2020 2020 2020 2020 2061 7574 6f73 7065           autospe
-00043ea0: 633d 5472 7565 2c0a 2020 2020 2020 2020  c=True,.        
-00043eb0: 2020 2020 2920 6173 205f 6d6f 636b 3a0a      ) as _mock:.
-00043ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ed0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-00043ee0: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
-00043ef0: 6f61 6441 6e64 496e 7365 7274 2822 6b65  oadAndInsert("ke
-00043f00: 7930 2229 290a 2020 2020 2020 2020 2020  y0")).          
-00043f10: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00043f20: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00043f30: 2020 2020 2020 2020 2020 2020 5b65 5b22              [e["
-00043f40: 6964 4361 7422 5d20 666f 7220 6520 696e  idCat"] for e in
-00043f50: 2073 656c 662e 7042 4442 2e63 6174 732e   self.pBDB.cats.
-00043f60: 6765 7442 7945 6e74 7279 2822 6b65 7930  getByEntry("key0
-00043f70: 2229 5d2c 0a20 2020 2020 2020 2020 2020  ")],.           
-00043f80: 2020 2020 2020 2020 2070 6243 6f6e 6669           pbConfi
-00043f90: 672e 7061 7261 6d73 5b22 6465 6661 756c  g.params["defaul
-00043fa0: 7443 6174 6567 6f72 6965 7322 5d2c 0a20  tCategories"],. 
-00043fb0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00043fc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00043fd0: 662e 7042 4442 2e75 6e64 6f28 7665 7262  f.pBDB.undo(verb
-00043fe0: 6f73 653d 3029 0a20 2020 2020 2020 2020  ose=0).         
-00043ff0: 2020 2023 2074 6573 7420 7769 7468 206c     # test with l
-00044000: 6973 7420 656e 7472 7920 2861 6c73 6f20  ist entry (also 
-00044010: 6e65 7374 6564 206c 6973 7473 290a 2020  nested lists).  
-00044020: 2020 2020 2020 2020 2020 7062 6d20 3d20            pbm = 
-00044030: 4d61 6769 634d 6f63 6b28 290a 2020 2020  MagicMock().    
-00044040: 2020 2020 2020 2020 7062 7620 3d20 4d61          pbv = Ma
-00044050: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
-00044060: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00044070: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00044080: 2020 2270 6879 7362 6962 6c69 6f2e 7765    "physbiblio.we
-00044090: 6269 6d70 6f72 742e 696e 7370 6972 652e  bimport.inspire.
-000440a0: 5765 6253 6561 7263 682e 7265 7472 6965  WebSearch.retrie
-000440b0: 7665 5572 6c41 6c6c 222c 0a20 2020 2020  veUrlAll",.     
-000440c0: 2020 2020 2020 2020 2020 2073 6964 655f             side_
-000440d0: 6566 6665 6374 3d5b 0a20 2020 2020 2020  effect=[.       
-000440e0: 2020 2020 2020 2020 2020 2020 2027 5c6e               '\n
-000440f0: 4061 7274 6963 6c65 7b6b 6579 302c 5c6e  @article{key0,\n
-00044100: 6175 7468 6f72 203d 2022 4761 7269 617a  author = "Gariaz
-00044110: 7a6f 222c 5c6e 270a 2020 2020 2020 2020  zo",\n'.        
-00044120: 2020 2020 2020 2020 2020 2020 2b20 2774              + 't
-00044130: 6974 6c65 203d 2022 7b74 6974 6c65 7d22  itle = "{title}"
-00044140: 2c7d 5c6e 272c 0a20 2020 2020 2020 2020  ,}\n',.         
-00044150: 2020 2020 2020 2020 2020 2027 5c6e 4061             '\n@a
-00044160: 7274 6963 6c65 7b6b 6579 302c 5c6e 6175  rticle{key0,\nau
-00044170: 7468 6f72 203d 2022 4761 7269 617a 7a6f  thor = "Gariazzo
-00044180: 222c 5c6e 270a 2020 2020 2020 2020 2020  ",\n'.          
-00044190: 2020 2020 2020 2020 2020 2b20 2774 6974            + 'tit
-000441a0: 6c65 203d 2022 7b74 6974 6c65 7d22 2c7d  le = "{title}",}
-000441b0: 5c6e 272c 0a20 2020 2020 2020 2020 2020  \n',.           
-000441c0: 2020 2020 2020 2020 2027 5c6e 4061 7274           '\n@art
-000441d0: 6963 6c65 7b6b 6579 302c 5c6e 6175 7468  icle{key0,\nauth
-000441e0: 6f72 203d 2022 4761 7269 617a 7a6f 222c  or = "Gariazzo",
-000441f0: 5c6e 270a 2020 2020 2020 2020 2020 2020  \n'.            
-00044200: 2020 2020 2020 2020 2b20 2774 6974 6c65          + 'title
-00044210: 203d 2022 7b74 6974 6c65 7d22 2c7d 5c6e   = "{title}",}\n
-00044220: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00044230: 2020 2020 2020 2027 5c6e 4061 7274 6963         '\n@artic
-00044240: 6c65 7b6b 6579 302c 5c6e 6175 7468 6f72  le{key0,\nauthor
-00044250: 203d 2022 4761 7269 617a 7a6f 222c 5c6e   = "Gariazzo",\n
-00044260: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00044270: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
-00044280: 2022 7b74 6974 6c65 7d22 2c7d 5c6e 272c   "{title}",}\n',
-00044290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000442a0: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
-000442b0: 2020 2020 6175 746f 7370 6563 3d54 7275      autospec=Tru
-000442c0: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-000442d0: 2061 7320 5f6d 6f63 6b3a 0a20 2020 2020   as _mock:.     
-000442e0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-000442f0: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-00044300: 6f67 6765 722e 696e 666f 2229 2061 7320  ogger.info") as 
-00044310: 5f69 3a0a 2020 2020 2020 2020 2020 2020  _i:.            
-00044320: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00044330: 422e 6269 6273 2e6c 6f61 6441 6e64 496e  B.bibs.loadAndIn
-00044340: 7365 7274 285b 226b 6579 3022 2c20 226b  sert(["key0", "k
-00044350: 6579 3122 5d29 0a20 2020 2020 2020 2020  ey1"]).         
-00044360: 2020 2020 2020 2020 2020 205f 692e 6173             _i.as
-00044370: 7365 7274 5f61 6e79 5f63 616c 6c28 2241  sert_any_call("A
-00044380: 6c72 6561 6479 2065 7869 7374 696e 673a  lready existing:
-00044390: 206b 6579 305c 6e22 290a 2020 2020 2020   key0\n").      
-000443a0: 2020 2020 2020 2020 2020 5f6d 6f63 6b2e            _mock.
-000443b0: 6173 7365 7274 5f68 6173 5f63 616c 6c73  assert_has_calls
-000443c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000443d0: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-000443e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000443f0: 6361 6c6c 2870 6879 7342 6962 6c69 6f57  call(physBiblioW
-00044400: 6562 2e77 6562 5365 6172 6368 5b22 696e  eb.webSearch["in
-00044410: 7370 6972 6522 5d2c 2022 6b65 7930 2229  spire"], "key0")
-00044420: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00044430: 2020 2020 2020 2020 2020 6361 6c6c 2870            call(p
-00044440: 6879 7342 6962 6c69 6f57 6562 2e77 6562  hysBiblioWeb.web
-00044450: 5365 6172 6368 5b22 696e 7370 6972 6522  Search["inspire"
-00044460: 5d2c 2022 6b65 7931 2229 2c0a 2020 2020  ], "key1"),.    
-00044470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044480: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00044490: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000444a0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-000444b0: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
-000444c0: 6962 732e 636f 756e 7428 292c 2031 290a  ibs.count(), 1).
-000444d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000444e0: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
-000444f0: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
-00044500: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
-00044510: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00044520: 662e 7042 4442 2e62 6962 732e 6c6f 6164  f.pBDB.bibs.load
-00044530: 416e 6449 6e73 6572 7428 5b22 6b65 7930  AndInsert(["key0
-00044540: 222c 2022 6b65 7931 225d 2c20 7062 4d61  ", "key1"], pbMa
-00044550: 783d 7062 6d2c 2070 6256 616c 3d70 6276  x=pbm, pbVal=pbv
-00044560: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00044570: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
-00044580: 616e 795f 6361 6c6c 2822 416c 7265 6164  any_call("Alread
-00044590: 7920 6578 6973 7469 6e67 3a20 6b65 7930  y existing: key0
-000445a0: 5c6e 2229 0a20 2020 2020 2020 2020 2020  \n").           
-000445b0: 2070 626d 2e61 7373 6572 745f 6361 6c6c   pbm.assert_call
-000445c0: 6564 5f6f 6e63 655f 7769 7468 2832 290a  ed_once_with(2).
-000445d0: 2020 2020 2020 2020 2020 2020 7062 762e              pbv.
-000445e0: 6173 7365 7274 5f68 6173 5f63 616c 6c73  assert_has_calls
-000445f0: 285b 6361 6c6c 2831 292c 2063 616c 6c28  ([call(1), call(
-00044600: 3229 5d29 0a20 2020 2020 2020 2020 2020  2)]).           
-00044610: 2073 656c 662e 7042 4442 2e75 6e64 6f28   self.pBDB.undo(
-00044620: 7665 7262 6f73 653d 3029 0a20 2020 2020  verbose=0).     
-00044630: 2020 2020 2020 2023 2074 6573 7420 7769         # test wi
-00044640: 7468 206e 756d 6265 723e 300a 2020 2020  th number>0.    
-00044650: 2020 2020 2020 2020 7062 6d20 3d20 4d61          pbm = Ma
-00044660: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
-00044670: 2020 2020 2020 7062 7620 3d20 4d61 6769        pbv = Magi
-00044680: 634d 6f63 6b28 290a 2020 2020 2020 2020  cMock().        
-00044690: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
-000446a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000446b0: 2270 6879 7362 6962 6c69 6f2e 7765 6269  "physbiblio.webi
-000446c0: 6d70 6f72 742e 696e 7370 6972 652e 5765  mport.inspire.We
-000446d0: 6253 6561 7263 682e 7265 7472 6965 7665  bSearch.retrieve
-000446e0: 5572 6c41 6c6c 222c 0a20 2020 2020 2020  UrlAll",.       
-000446f0: 2020 2020 2020 2020 2073 6964 655f 6566           side_ef
-00044700: 6665 6374 3d5b 0a20 2020 2020 2020 2020  fect=[.         
-00044710: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-00044720: 6963 6c65 7b6b 6579 302c 5c6e 6175 7468  icle{key0,\nauth
-00044730: 6f72 203d 2022 4761 7269 617a 7a6f 222c  or = "Gariazzo",
-00044740: 5c6e 270a 2020 2020 2020 2020 2020 2020  \n'.            
-00044750: 2020 2020 2020 2020 2b20 2774 6974 6c65          + 'title
-00044760: 203d 2022 7b74 6974 6c65 7d22 2c7d 5c6e   = "{title}",}\n
-00044770: 4061 7274 6963 6c65 7b6b 6579 312c 5c6e  @article{key1,\n
-00044780: 6175 7468 6f72 203d 2027 0a20 2020 2020  author = '.     
-00044790: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-000447a0: 2027 2247 6172 6961 7a7a 6f22 2c5c 6e74   '"Gariazzo",\nt
-000447b0: 6974 6c65 203d 2022 7b74 6974 6c65 7d22  itle = "{title}"
-000447c0: 2c7d 5c6e 272c 0a20 2020 2020 2020 2020  ,}\n',.         
-000447d0: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-000447e0: 6963 6c65 7b6b 6579 302c 5c6e 6175 7468  icle{key0,\nauth
-000447f0: 6f72 203d 2022 4761 7269 617a 7a6f 222c  or = "Gariazzo",
-00044800: 5c6e 270a 2020 2020 2020 2020 2020 2020  \n'.            
-00044810: 2020 2020 2020 2020 2b20 2774 6974 6c65          + 'title
-00044820: 203d 2022 7b74 6974 6c65 7d22 2c7d 5c6e   = "{title}",}\n
-00044830: 4061 7274 6963 6c65 7b6b 6579 312c 5c6e  @article{key1,\n
-00044840: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00044850: 2020 2020 2020 2b20 2761 7574 686f 7220        + 'author 
-00044860: 3d20 2247 6172 6961 7a7a 6f22 2c5c 6e74  = "Gariazzo",\nt
-00044870: 6974 6c65 203d 2022 7b74 6974 6c65 7d22  itle = "{title}"
-00044880: 2c7d 5c6e 272c 0a20 2020 2020 2020 2020  ,}\n',.         
-00044890: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-000448a0: 2020 2020 2020 2020 2020 6175 746f 7370            autosp
-000448b0: 6563 3d54 7275 652c 0a20 2020 2020 2020  ec=True,.       
-000448c0: 2020 2020 2029 2061 7320 5f6d 6f63 6b3a       ) as _mock:
-000448d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000448e0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-000448f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00044900: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00044910: 6269 6273 2e6c 6f61 6441 6e64 496e 7365  bibs.loadAndInse
-00044920: 7274 2822 6b65 7930 222c 206e 756d 6265  rt("key0", numbe
-00044930: 723d 312c 2070 624d 6178 3d70 626d 2c20  r=1, pbMax=pbm, 
-00044940: 7062 5661 6c3d 7062 7629 0a20 2020 2020  pbVal=pbv).     
-00044950: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00044960: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00044970: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00044980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044990: 2020 205b 655b 2262 6962 6b65 7922 5d20     [e["bibkey"] 
-000449a0: 666f 7220 6520 696e 2073 656c 662e 7042  for e in self.pB
-000449b0: 4442 2e62 6962 732e 6765 7441 6c6c 2829  DB.bibs.getAll()
-000449c0: 5d2c 205b 226b 6579 3122 5d0a 2020 2020  ], ["key1"].    
-000449d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000449e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000449f0: 6c66 2e61 7373 6572 7454 7275 6528 7365  lf.assertTrue(se
-00044a00: 6c66 2e70 4244 422e 6269 6273 2e6c 6f61  lf.pBDB.bibs.loa
-00044a10: 6441 6e64 496e 7365 7274 2822 6b65 7930  dAndInsert("key0
-00044a20: 222c 206e 756d 6265 723d 3029 290a 2020  ", number=0)).  
-00044a30: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00044a40: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00044a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044a60: 2020 2020 5b65 5b22 6269 626b 6579 225d      [e["bibkey"]
-00044a70: 2066 6f72 2065 2069 6e20 7365 6c66 2e70   for e in self.p
-00044a80: 4244 422e 6269 6273 2e67 6574 416c 6c28  BDB.bibs.getAll(
-00044a90: 295d 2c20 5b22 6b65 7931 222c 2022 6b65  )], ["key1", "ke
-00044aa0: 7930 225d 0a20 2020 2020 2020 2020 2020  y0"].           
-00044ab0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00044ac0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00044ad0: 7561 6c28 7062 6d2e 6361 6c6c 5f63 6f75  ual(pbm.call_cou
-00044ae0: 6e74 2c20 3029 0a20 2020 2020 2020 2020  nt, 0).         
-00044af0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00044b00: 7561 6c28 7062 762e 6361 6c6c 5f63 6f75  ual(pbv.call_cou
-00044b10: 6e74 2c20 3029 0a20 2020 2020 2020 2020  nt, 0).         
-00044b20: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
-00044b30: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
-00044b40: 2020 2020 2020 2020 2023 2074 6573 7420           # test 
-00044b50: 7365 7442 6f6f 6b20 7768 656e 2075 7369  setBook when usi
-00044b60: 6e67 2069 7362 6e0a 2020 2020 2020 2020  ng isbn.        
-00044b70: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
-00044b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044b90: 2270 6879 7362 6962 6c69 6f2e 7765 6269  "physbiblio.webi
-00044ba0: 6d70 6f72 742e 6973 626e 2e57 6562 5365  mport.isbn.WebSe
-00044bb0: 6172 6368 2e72 6574 7269 6576 6555 726c  arch.retrieveUrl
-00044bc0: 416c 6c22 2c0a 2020 2020 2020 2020 2020  All",.          
-00044bd0: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
-00044be0: 7565 3d22 4061 7274 6963 6c65 7b6b 6579  ue="@article{key
-00044bf0: 302c 5c6e 220a 2020 2020 2020 2020 2020  0,\n".          
-00044c00: 2020 2020 2020 2b20 2761 7574 686f 7220        + 'author 
-00044c10: 3d20 2247 6172 6961 7a7a 6f22 2c5c 6e74  = "Gariazzo",\nt
-00044c20: 6974 6c65 203d 2022 7b74 6974 6c65 7d22  itle = "{title}"
-00044c30: 2c7d 272c 0a20 2020 2020 2020 2020 2020  ,}',.           
-00044c40: 2020 2020 2061 7574 6f73 7065 633d 5472       autospec=Tr
-00044c50: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00044c60: 2920 6173 205f 6d6f 636b 3a0a 2020 2020  ) as _mock:.    
-00044c70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00044c80: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
-00044c90: 2e70 4244 422e 6269 6273 2e6c 6f61 6441  .pBDB.bibs.loadA
-00044ca0: 6e64 496e 7365 7274 2822 6b65 7930 222c  ndInsert("key0",
-00044cb0: 206d 6574 686f 643d 2269 7362 6e22 2929   method="isbn"))
-00044cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044cd0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00044ce0: 6c28 5b65 5b22 626f 6f6b 225d 2066 6f72  l([e["book"] for
-00044cf0: 2065 2069 6e20 7365 6c66 2e70 4244 422e   e in self.pBDB.
-00044d00: 6269 6273 2e67 6574 416c 6c28 295d 2c20  bibs.getAll()], 
-00044d10: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
-00044d20: 2073 656c 662e 7042 4442 2e75 6e64 6f28   self.pBDB.undo(
-00044d30: 7665 7262 6f73 653d 3029 0a20 2020 2020  verbose=0).     
-00044d40: 2020 2020 2020 2023 2074 6573 7420 6162         # test ab
-00044d50: 7374 7261 6374 2064 6f77 6e6c 6f61 640a  stract download.
-00044d60: 2020 2020 2020 2020 2020 2020 7769 7468              with
-00044d70: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-00044d80: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-00044d90: 6c69 6f2e 7765 6269 6d70 6f72 742e 696e  lio.webimport.in
-00044da0: 7370 6972 652e 5765 6253 6561 7263 682e  spire.WebSearch.
-00044db0: 7265 7472 6965 7665 5572 6c41 6c6c 222c  retrieveUrlAll",
-00044dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044dd0: 2073 6964 655f 6566 6665 6374 3d5b 0a20   side_effect=[. 
-00044de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044df0: 2020 2027 5c6e 4061 7274 6963 6c65 7b6b     '\n@article{k
-00044e00: 6579 302c 5c6e 6175 7468 6f72 203d 2022  ey0,\nauthor = "
-00044e10: 4761 7269 617a 7a6f 222c 5c6e 270a 2020  Gariazzo",\n'.  
-00044e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e30: 2020 2b20 2774 6974 6c65 203d 2022 7b74    + 'title = "{t
-00044e40: 6974 6c65 7d22 2c7d 5c6e 272c 0a20 2020  itle}",}\n',.   
-00044e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e60: 2027 5c6e 4061 7274 6963 6c65 7b6b 6579   '\n@article{key
-00044e70: 312c 5c6e 6175 7468 6f72 203d 2022 4761  1,\nauthor = "Ga
-00044e80: 7269 617a 7a6f 222c 5c6e 270a 2020 2020  riazzo",\n'.    
-00044e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044ea0: 2b20 2774 6974 6c65 203d 2022 7b74 6974  + 'title = "{tit
-00044eb0: 6c65 7d22 2c5c 6e61 7278 6976 3d22 3132  le}",\narxiv="12
-00044ec0: 3334 2e35 3637 3822 2c7d 5c6e 272c 0a20  34.5678",}\n',. 
-00044ed0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00044ee0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00044ef0: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
-00044f00: 0a20 2020 2020 2020 2020 2020 2029 2061  .            ) a
-00044f10: 7320 5f6d 6f63 6b2c 2070 6174 6368 280a  s _mock, patch(.
-00044f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044f30: 2270 6879 7362 6962 6c69 6f2e 7765 6269  "physbiblio.webi
-00044f40: 6d70 6f72 742e 6172 7869 762e 5765 6253  mport.arxiv.WebS
-00044f50: 6561 7263 682e 7265 7472 6965 7665 5572  earch.retrieveUr
-00044f60: 6c41 6c6c 222c 0a20 2020 2020 2020 2020  lAll",.         
-00044f70: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
-00044f80: 6c75 653d 280a 2020 2020 2020 2020 2020  lue=(.          
-00044f90: 2020 2020 2020 2020 2020 225c 6e40 6172            "\n@ar
-00044fa0: 7469 636c 657b 6b65 7930 2c5c 6e22 0a20  ticle{key0,\n". 
-00044fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044fc0: 2020 202b 2027 6175 7468 6f72 203d 2022     + 'author = "
-00044fd0: 4761 7269 617a 7a6f 222c 5c6e 7469 746c  Gariazzo",\ntitl
-00044fe0: 6520 3d20 227b 7469 746c 657d 222c 7d5c  e = "{title}",}\
-00044ff0: 6e27 2c0a 2020 2020 2020 2020 2020 2020  n',.            
-00045000: 2020 2020 2020 2020 7b22 6162 7374 7261          {"abstra
-00045010: 6374 223a 2022 736f 6d65 2066 616b 6520  ct": "some fake 
-00045020: 6162 7374 7261 6374 227d 2c0a 2020 2020  abstract"},.    
-00045030: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-00045040: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00045050: 7574 6f73 7065 633d 5472 7565 2c0a 2020  utospec=True,.  
-00045060: 2020 2020 2020 2020 2020 2920 6173 205f            ) as _
-00045070: 6d6f 636b 2c20 7061 7463 682e 6469 6374  mock, patch.dict
-00045080: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00045090: 2020 7062 436f 6e66 6967 2e70 6172 616d    pbConfig.param
-000450a0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-000450b0: 2020 207b 2266 6574 6368 4162 7374 7261     {"fetchAbstra
-000450c0: 6374 223a 2054 7275 652c 2022 6465 6661  ct": True, "defa
-000450d0: 756c 7443 6174 6567 6f72 6965 7322 3a20  ultCategories": 
-000450e0: 5b31 5d7d 2c0a 2020 2020 2020 2020 2020  [1]},.          
-000450f0: 2020 2020 2020 636c 6561 723d 4661 6c73        clear=Fals
-00045100: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-00045110: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00045120: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00045130: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
-00045140: 2e6c 6f61 6441 6e64 496e 7365 7274 2822  .loadAndInsert("
-00045150: 6b65 7930 2229 290a 2020 2020 2020 2020  key0")).        
-00045160: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00045170: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00045180: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00045190: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-000451a0: 4279 4269 626b 6579 2822 6b65 7930 2229  ByBibkey("key0")
-000451b0: 5b30 5d5b 2261 6273 7472 6163 7422 5d2c  [0]["abstract"],
-000451c0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-000451d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000451e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000451f0: 6572 7454 7275 6528 7365 6c66 2e70 4244  ertTrue(self.pBD
-00045200: 422e 6269 6273 2e6c 6f61 6441 6e64 496e  B.bibs.loadAndIn
-00045210: 7365 7274 2822 6b65 7931 2229 290a 2020  sert("key1")).  
-00045220: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00045230: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00045240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045250: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00045260: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
-00045270: 6b65 7931 2229 5b30 5d5b 2261 6273 7472  key1")[0]["abstr
-00045280: 6163 7422 5d2c 0a20 2020 2020 2020 2020  act"],.         
-00045290: 2020 2020 2020 2020 2020 2022 736f 6d65             "some
-000452a0: 2066 616b 6520 6162 7374 7261 6374 222c   fake abstract",
-000452b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000452c0: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
-000452d0: 656c 662e 7042 4442 2e75 6e64 6f28 7665  elf.pBDB.undo(ve
-000452e0: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
-000452f0: 2020 2020 2023 2075 6e72 6561 6461 626c       # unreadabl
-00045300: 6520 6269 6274 6578 2c20 656d 7074 7920  e bibtex, empty 
-00045310: 6269 626b 6579 2028 616e 7920 6f74 6865  bibkey (any othe
-00045320: 7220 6d65 7468 6f64 290a 2020 2020 2020  r method).      
-00045330: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00045340: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00045350: 2020 2270 6879 7362 6962 6c69 6f2e 7765    "physbiblio.we
-00045360: 6269 6d70 6f72 742e 696e 7370 6972 652e  bimport.inspire.
-00045370: 5765 6253 6561 7263 682e 7265 7472 6965  WebSearch.retrie
-00045380: 7665 5572 6c41 6c6c 222c 0a20 2020 2020  veUrlAll",.     
-00045390: 2020 2020 2020 2020 2020 2073 6964 655f             side_
-000453a0: 6566 6665 6374 3d5b 0a20 2020 2020 2020  effect=[.       
-000453b0: 2020 2020 2020 2020 2020 2020 2022 5c6e               "\n
-000453c0: 4061 7274 6963 6c65 7b6b 6579 302c 5c6e  @article{key0,\n
-000453d0: 6175 7468 6f72 203d 2022 2c0a 2020 2020  author = ",.    
+000420f0: 2020 2020 2020 2020 6462 2c0a 2020 2020          db,.    
+00042100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042110: 2020 2020 6572 726f 7273 3d5b 2262 6262      errors=["bbb
+00042120: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+00042130: 2020 2020 2020 2020 2020 2020 6578 6973              exis
+00042140: 7469 6e67 3d5b 2261 6161 225d 2c0a 2020  ting=["aaa"],.  
+00042150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042160: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00042170: 2020 2020 2020 2020 2028 5b22 6262 6222           (["bbb"
+00042180: 5d2c 205b 2261 6161 225d 292c 0a20 2020  ], ["aaa"]),.   
+00042190: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000421a0: 2020 2020 2020 2020 2020 205f 632e 6173             _c.as
+000421b0: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+000421c0: 285b 312c 2032 2c20 335d 2c20 2265 6667  ([1, 2, 3], "efg
+000421d0: 6822 290a 2020 2020 2020 2020 2020 2020  h").            
+000421e0: 5f75 692e 6173 7365 7274 5f63 616c 6c65  _ui.assert_calle
+000421f0: 645f 6f6e 6365 5f77 6974 6828 2265 6667  d_once_with("efg
+00042200: 6822 290a 2020 2020 2020 2020 2020 2020  h").            
+00042210: 5f75 6f2e 6173 7365 7274 5f63 616c 6c65  _uo.assert_calle
+00042220: 645f 6f6e 6365 5f77 6974 6828 2231 3233  d_once_with("123
+00042230: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00042240: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+00042250: 2e70 4244 422e 6269 6273 2e6c 6173 7449  .pBDB.bibs.lastI
+00042260: 6e73 6572 7465 642c 205b 2261 6263 6422  nserted, ["abcd"
+00042270: 2c20 2263 6465 6622 2c20 2265 6667 6822  , "cdef", "efgh"
+00042280: 5d29 0a0a 2020 2020 6465 6620 7465 7374  ])..    def test
+00042290: 5f69 6e73 6572 7428 7365 6c66 2c20 2a61  _insert(self, *a
+000422a0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+000422b0: 2254 6573 7420 696e 7365 7274 696f 6e20  "Test insertion 
+000422c0: 616e 6420 6f66 2062 6962 7465 7820 6974  and of bibtex it
+000422d0: 656d 7322 2222 0a20 2020 2020 2020 2073  ems""".        s
+000422e0: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+000422f0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+00042300: 6574 4669 656c 6428 2261 6263 222c 2022  etField("abc", "
+00042310: 6269 626b 6579 2229 290a 2020 2020 2020  bibkey")).      
+00042320: 2020 6461 7461 203d 2073 656c 662e 7042    data = self.pB
+00042330: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
+00042340: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
+00042350: 2020 2027 4061 7274 6963 6c65 7b61 6263     '@article{abc
+00042360: 2c5c 6e61 7574 686f 7220 3d20 226d 6522  ,\nauthor = "me"
+00042370: 2c5c 6e74 6974 6c65 203d 2022 6162 6322  ,\ntitle = "abc"
+00042380: 2c7d 272c 2061 7278 6976 3d22 6162 6322  ,}', arxiv="abc"
+00042390: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000423a0: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+000423b0: 7565 2873 656c 662e 7042 4442 2e62 6962  ue(self.pBDB.bib
+000423c0: 732e 696e 7365 7274 2864 6174 6129 290a  s.insert(data)).
+000423d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000423e0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+000423f0: 4442 2e62 6962 732e 6765 7446 6965 6c64  DB.bibs.getField
+00042400: 2822 6162 6322 2c20 2262 6962 6b65 7922  ("abc", "bibkey"
+00042410: 292c 2022 6162 6322 290a 2020 2020 2020  ), "abc").      
+00042420: 2020 7365 6c66 2e70 4244 422e 756e 646f    self.pBDB.undo
+00042430: 2876 6572 626f 7365 3d46 616c 7365 290a  (verbose=False).
+00042440: 2020 2020 2020 2020 6465 6c20 6461 7461          del data
+00042450: 5b22 6172 7869 7622 5d0a 2020 2020 2020  ["arxiv"].      
+00042460: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
+00042470: 7365 2873 656c 662e 7042 4442 2e62 6962  se(self.pBDB.bib
+00042480: 732e 696e 7365 7274 2864 6174 6129 290a  s.insert(data)).
+00042490: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+000424a0: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
+000424b0: 6572 2e65 7863 6570 7469 6f6e 2229 2061  er.exception") a
+000424c0: 7320 5f69 3a0a 2020 2020 2020 2020 2020  s _i:.          
+000424d0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+000424e0: 2e69 6e73 6572 7428 6461 7461 290a 2020  .insert(data).  
+000424f0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00042500: 7373 6572 7449 6e28 2259 6f75 2064 6964  ssertIn("You did
+00042510: 206e 6f74 2073 7570 706c 7920 6120 7661   not supply a va
+00042520: 6c75 6520 666f 7220 6269 6e64 696e 6722  lue for binding"
+00042530: 2c20 5f69 2e63 616c 6c5f 6172 6773 5b30  , _i.call_args[0
+00042540: 5d5b 305d 290a 2020 2020 2020 2020 7365  ][0]).        se
+00042550: 6c66 2e61 7373 6572 7454 7275 6528 0a20  lf.assertTrue(. 
+00042560: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00042570: 7042 4442 2e62 6962 732e 696e 7365 7274  pBDB.bibs.insert
+00042580: 4672 6f6d 4269 6274 6578 280a 2020 2020  FromBibtex(.    
+00042590: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
+000425a0: 7469 636c 657b 6768 692c 5c6e 6175 7468  ticle{ghi,\nauth
+000425b0: 6f72 203d 2022 6d65 222c 5c6e 7469 746c  or = "me",\ntitl
+000425c0: 6520 3d20 2267 6869 222c 7d27 0a20 2020  e = "ghi",}'.   
+000425d0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000425e0: 2020 2029 0a0a 2020 2020 4075 6e69 7474     )..    @unitt
+000425f0: 6573 742e 736b 6970 4966 2873 6b69 7054  est.skipIf(skipT
+00042600: 6573 7473 5365 7474 696e 6773 2e6f 6e6c  estsSettings.onl
+00042610: 696e 652c 2022 4f6e 6c69 6e65 2074 6573  ine, "Online tes
+00042620: 7473 2229 0a20 2020 2064 6566 2074 6573  ts").    def tes
+00042630: 745f 6c6f 6164 416e 6449 6e73 6572 745f  t_loadAndInsert_
+00042640: 6f6e 6c69 6e65 2873 656c 662c 202a 6172  online(self, *ar
+00042650: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+00042660: 7465 7374 7320 666f 7220 6c6f 6164 416e  tests for loadAn
+00042670: 6449 6e73 6572 7420 7769 7468 206f 6e6c  dInsert with onl
+00042680: 696e 6520 636f 6e6e 6563 7469 6f6e 2222  ine connection""
+00042690: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+000426a0: 7373 6572 7454 7275 6528 0a20 2020 2020  ssertTrue(.     
+000426b0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+000426c0: 2e62 6962 732e 6c6f 6164 416e 6449 6e73  .bibs.loadAndIns
+000426d0: 6572 7428 5b22 4761 7269 617a 7a6f 3a32  ert(["Gariazzo:2
+000426e0: 3031 3572 7261 222c 2022 506c 616e 636b  015rra", "Planck
+000426f0: 3a32 3031 3370 7862 225d 290a 2020 2020  :2013pxb"]).    
+00042700: 2020 2020 290a 2020 2020 2020 2020 616c      ).        al
+00042710: 6c5f 203d 2073 656c 662e 7042 4442 2e62  l_ = self.pBDB.b
+00042720: 6962 732e 6765 7441 6c6c 2829 0a20 2020  ibs.getAll().   
+00042730: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00042740: 4571 7561 6c28 6c65 6e28 616c 6c5f 292c  Equal(len(all_),
+00042750: 2032 290a 2020 2020 2020 2020 6966 2061   2).        if a
+00042760: 6c6c 5f5b 305d 5b22 6269 626b 6579 225d  ll_[0]["bibkey"]
+00042770: 2021 3d20 2247 6172 6961 7a7a 6f3a 3230   != "Gariazzo:20
+00042780: 3135 7272 6122 3a0a 2020 2020 2020 2020  15rra":.        
+00042790: 2020 2020 616c 6c5f 2e72 6576 6572 7365      all_.reverse
+000427a0: 2829 0a20 2020 2020 2020 2072 6573 203d  ().        res =
+000427b0: 2061 6c6c 5f5b 305d 0a20 2020 2020 2020   all_[0].       
+000427c0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+000427d0: 2872 6573 5b22 6369 7461 7469 6f6e 7322  (res["citations"
+000427e0: 5d20 3e20 3234 3029 0a20 2020 2020 2020  ] > 240).       
+000427f0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00042800: 2872 6573 5b22 6369 7461 7469 6f6e 735f  (res["citations_
+00042810: 6e6f 5f73 656c 6622 5d20 3e20 3139 3029  no_self"] > 190)
+00042820: 0a20 2020 2020 2020 2064 656c 2072 6573  .        del res
+00042830: 5b22 6369 7461 7469 6f6e 7322 5d0a 2020  ["citations"].  
+00042840: 2020 2020 2020 6465 6c20 7265 735b 2263        del res["c
+00042850: 6974 6174 696f 6e73 5f6e 6f5f 7365 6c66  itations_no_self
+00042860: 225d 0a20 2020 2020 2020 2073 656c 662e  "].        self.
+00042870: 6173 7365 7274 4571 7561 6c28 7265 732c  assertEqual(res,
+00042880: 2066 756c 6c52 6563 6f72 6447 6172 6961   fullRecordGaria
+00042890: 7a7a 6f29 0a20 2020 2020 2020 2072 6573  zzo).        res
+000428a0: 203d 2061 6c6c 5f5b 315d 0a20 2020 2020   = all_[1].     
+000428b0: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+000428c0: 7565 2872 6573 5b22 6369 7461 7469 6f6e  ue(res["citation
+000428d0: 7322 5d20 3e20 3733 3030 290a 2020 2020  s"] > 7300).    
+000428e0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+000428f0: 7275 6528 7265 735b 2263 6974 6174 696f  rue(res["citatio
+00042900: 6e73 5f6e 6f5f 7365 6c66 225d 203e 2036  ns_no_self"] > 6
+00042910: 3930 3029 0a20 2020 2020 2020 2064 656c  900).        del
+00042920: 2072 6573 5b22 6369 7461 7469 6f6e 7322   res["citations"
+00042930: 5d0a 2020 2020 2020 2020 6465 6c20 7265  ].        del re
+00042940: 735b 2263 6974 6174 696f 6e73 5f6e 6f5f  s["citations_no_
+00042950: 7365 6c66 225d 0a20 2020 2020 2020 2073  self"].        s
+00042960: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00042970: 7265 732c 2066 756c 6c52 6563 6f72 6441  res, fullRecordA
+00042980: 6465 290a 0a20 2020 2064 6566 2074 6573  de)..    def tes
+00042990: 745f 6c6f 6164 416e 6449 6e73 6572 7428  t_loadAndInsert(
+000429a0: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+000429b0: 2020 2020 2020 2222 2274 6573 7473 2066        """tests f
+000429c0: 6f72 206c 6f61 6441 6e64 496e 7365 7274  or loadAndInsert
+000429d0: 2061 6e64 206c 6f61 6441 6e64 496e 7365   and loadAndInse
+000429e0: 7274 5769 7468 4361 7473 2028 6d6f 636b  rtWithCats (mock
+000429f0: 6564 2922 2222 0a20 2020 2020 2020 2023  ed)""".        #
+00042a00: 206c 6f61 6441 6e64 496e 7365 7274 0a20   loadAndInsert. 
+00042a10: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00042a20: 7274 4661 6c73 6528 7365 6c66 2e70 4244  rtFalse(self.pBD
+00042a30: 422e 6269 6273 2e6c 6f61 6441 6e64 496e  B.bibs.loadAndIn
+00042a40: 7365 7274 284e 6f6e 6529 290a 2020 2020  sert(None)).    
+00042a50: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+00042a60: 6c6f 6767 696e 672e 4c6f 6767 6572 2e65  logging.Logger.e
+00042a70: 7272 6f72 2229 2061 7320 5f65 3a0a 2020  rror") as _e:.  
+00042a80: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00042a90: 4244 422e 6269 6273 2e6c 6f61 6441 6e64  BDB.bibs.loadAnd
+00042aa0: 496e 7365 7274 284e 6f6e 6529 0a20 2020  Insert(None).   
+00042ab0: 2020 2020 2020 2020 205f 652e 6173 7365           _e.asse
+00042ac0: 7274 5f61 6e79 5f63 616c 6c28 2249 6e76  rt_any_call("Inv
+00042ad0: 616c 6964 2061 7267 756d 656e 7473 2122  alid arguments!"
+00042ae0: 290a 2020 2020 2020 2020 2320 6d65 7468  ).        # meth
+00042af0: 6f64 730a 2020 2020 2020 2020 666f 7220  ods.        for 
+00042b00: 6d65 7468 6f64 2069 6e20 2822 696e 7370  method in ("insp
+00042b10: 6972 6522 2c20 2264 6f69 222c 2022 6172  ire", "doi", "ar
+00042b20: 7869 7622 293a 0a20 2020 2020 2020 2020  xiv"):.         
+00042b30: 2020 2077 6974 6820 7061 7463 6828 0a20     with patch(. 
+00042b40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00042b50: 7068 7973 6269 626c 696f 2e77 6562 696d  physbiblio.webim
+00042b60: 706f 7274 2e25 732e 5765 6253 6561 7263  port.%s.WebSearc
+00042b70: 682e 7265 7472 6965 7665 5572 6c41 6c6c  h.retrieveUrlAll
+00042b80: 2220 2520 6d65 7468 6f64 2c0a 2020 2020  " % method,.    
+00042b90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00042ba0: 726e 5f76 616c 7565 3d22 222c 0a20 2020  rn_value="",.   
+00042bb0: 2020 2020 2020 2020 2020 2020 2061 7574               aut
+00042bc0: 6f73 7065 633d 5472 7565 2c0a 2020 2020  ospec=True,.    
+00042bd0: 2020 2020 2020 2020 2920 6173 205f 6d6f          ) as _mo
+00042be0: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
+00042bf0: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+00042c00: 616c 7365 2873 656c 662e 7042 4442 2e62  alse(self.pBDB.b
+00042c10: 6962 732e 6c6f 6164 416e 6449 6e73 6572  ibs.loadAndInser
+00042c20: 7428 2261 6263 6465 6622 2c20 6d65 7468  t("abcdef", meth
+00042c30: 6f64 3d6d 6574 686f 6429 290a 2020 2020  od=method)).    
+00042c40: 2020 2020 2020 2020 2020 2020 5f6d 6f63              _moc
+00042c50: 6b2e 6173 7365 7274 5f63 616c 6c65 645f  k.assert_called_
+00042c60: 6f6e 6365 5f77 6974 6828 7068 7973 4269  once_with(physBi
+00042c70: 626c 696f 5765 622e 7765 6253 6561 7263  blioWeb.webSearc
+00042c80: 685b 6d65 7468 6f64 5d2c 2022 6162 6364  h[method], "abcd
+00042c90: 6566 2229 0a20 2020 2020 2020 2073 656c  ef").        sel
+00042ca0: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
+00042cb0: 6c66 2e70 4244 422e 6269 6273 2e6c 6f61  lf.pBDB.bibs.loa
+00042cc0: 6441 6e64 496e 7365 7274 2822 6162 6364  dAndInsert("abcd
+00042cd0: 6566 222c 206d 6574 686f 643d 226e 6f6e  ef", method="non
+00042ce0: 6578 6973 7465 6e74 2229 290a 2020 2020  existent")).    
+00042cf0: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+00042d00: 6c6f 6767 696e 672e 4c6f 6767 6572 2e65  logging.Logger.e
+00042d10: 7863 6570 7469 6f6e 2229 2061 7320 5f65  xception") as _e
+00042d20: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00042d30: 6c66 2e70 4244 422e 6269 6273 2e6c 6f61  lf.pBDB.bibs.loa
+00042d40: 6441 6e64 496e 7365 7274 2822 6162 6364  dAndInsert("abcd
+00042d50: 6566 222c 206d 6574 686f 643d 226e 6f6e  ef", method="non
+00042d60: 6578 6973 7465 6e74 2229 0a20 2020 2020  existent").     
+00042d70: 2020 2020 2020 205f 652e 6173 7365 7274         _e.assert
+00042d80: 5f61 6e79 5f63 616c 6c28 224d 6574 686f  _any_call("Metho
+00042d90: 6420 6e6f 7420 7661 6c69 643a 206e 6f6e  d not valid: non
+00042da0: 6578 6973 7465 6e74 2229 0a20 2020 2020  existent").     
+00042db0: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+00042dc0: 7565 280a 2020 2020 2020 2020 2020 2020  ue(.            
+00042dd0: 7365 6c66 2e70 4244 422e 6269 6273 2e6c  self.pBDB.bibs.l
+00042de0: 6f61 6441 6e64 496e 7365 7274 280a 2020  oadAndInsert(.  
+00042df0: 2020 2020 2020 2020 2020 2020 2020 2740                '@
+00042e00: 6172 7469 636c 657b 6162 632c 5c6e 6175  article{abc,\nau
+00042e10: 7468 6f72 3d22 6d65 222c 5c6e 7469 746c  thor="me",\ntitl
+00042e20: 653d 2261 6263 222c 5c6e 7d27 2c20 6d65  e="abc",\n}', me
+00042e30: 7468 6f64 3d22 6269 6274 6578 220a 2020  thod="bibtex".  
+00042e40: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00042e50: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00042e60: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
+00042e70: 655b 2262 6962 6b65 7922 5d20 666f 7220  e["bibkey"] for 
+00042e80: 6520 696e 2073 656c 662e 7042 4442 2e62  e in self.pBDB.b
+00042e90: 6962 732e 6765 7441 6c6c 2829 5d2c 205b  ibs.getAll()], [
+00042ea0: 2261 6263 225d 290a 2020 2020 2020 2020  "abc"]).        
+00042eb0: 2320 6368 696c 6450 726f 6365 7373 0a20  # childProcess. 
+00042ec0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00042ed0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+00042ee0: 422e 6269 6273 2e6c 6173 7449 6e73 6572  B.bibs.lastInser
+00042ef0: 7465 642c 205b 2261 6263 225d 290a 2020  ted, ["abc"]).  
+00042f00: 2020 2020 2020 2320 696d 706f 7365 4b65        # imposeKe
+00042f10: 790a 2020 2020 2020 2020 7365 6c66 2e61  y.        self.a
+00042f20: 7373 6572 7454 7275 6528 0a20 2020 2020  ssertTrue(.     
+00042f30: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00042f40: 2e62 6962 732e 6c6f 6164 416e 6449 6e73  .bibs.loadAndIns
+00042f50: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
+00042f60: 2020 2020 2027 4061 7274 6963 6c65 7b61       '@article{a
+00042f70: 6263 2c5c 6e61 7574 686f 723d 226d 6522  bc,\nauthor="me"
+00042f80: 2c5c 6e74 6974 6c65 3d22 6162 6322 2c5c  ,\ntitle="abc",\
+00042f90: 6e7d 272c 0a20 2020 2020 2020 2020 2020  n}',.           
+00042fa0: 2020 2020 2069 6d70 6f73 654b 6579 3d22       imposeKey="
+00042fb0: 6465 6622 2c0a 2020 2020 2020 2020 2020  def",.          
+00042fc0: 2020 2020 2020 6d65 7468 6f64 3d22 6269        method="bi
+00042fd0: 6274 6578 222c 0a20 2020 2020 2020 2020  btex",.         
+00042fe0: 2020 2020 2020 2063 6869 6c64 5072 6f63         childProc
+00042ff0: 6573 733d 5472 7565 2c0a 2020 2020 2020  ess=True,.      
+00043000: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00043010: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00043020: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+00043030: 7042 4442 2e62 6962 732e 6c61 7374 496e  pBDB.bibs.lastIn
+00043040: 7365 7274 6564 2c20 5b22 6162 6322 2c20  serted, ["abc", 
+00043050: 2264 6566 225d 290a 2020 2020 2020 2020  "def"]).        
+00043060: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00043070: 285b 655b 2262 6962 6b65 7922 5d20 666f  ([e["bibkey"] fo
+00043080: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00043090: 2e62 6962 732e 6765 7441 6c6c 2829 5d2c  .bibs.getAll()],
+000430a0: 205b 2261 6263 222c 2022 6465 6622 5d29   ["abc", "def"])
+000430b0: 0a20 2020 2020 2020 2061 6c6c 4269 6274  .        allBibt
+000430c0: 6578 7320 3d20 5b65 5b22 6269 6274 6578  exs = [e["bibtex
+000430d0: 225d 2066 6f72 2065 2069 6e20 7365 6c66  "] for e in self
+000430e0: 2e70 4244 422e 6269 6273 2e67 6574 416c  .pBDB.bibs.getAl
+000430f0: 6c28 295d 0a20 2020 2020 2020 2073 656c  l()].        sel
+00043100: 662e 6173 7365 7274 4571 7561 6c28 616c  f.assertEqual(al
+00043110: 6c42 6962 7465 7873 5b30 5d2e 7265 706c  lBibtexs[0].repl
+00043120: 6163 6528 227b 6162 632c 222c 2022 7b64  ace("{abc,", "{d
+00043130: 6566 2c22 292c 2061 6c6c 4269 6274 6578  ef,"), allBibtex
+00043140: 735b 315d 290a 2020 2020 2020 2020 2320  s[1]).        # 
+00043150: 6578 6973 7469 6e67 0a20 2020 2020 2020  existing.       
+00043160: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00043170: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+00043180: 2e63 6f75 6e74 2829 2c20 3229 0a20 2020  .count(), 2).   
+00043190: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000431a0: 5472 7565 280a 2020 2020 2020 2020 2020  True(.          
+000431b0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+000431c0: 2e6c 6f61 6441 6e64 496e 7365 7274 280a  .loadAndInsert(.
+000431d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000431e0: 2740 6172 7469 636c 657b 6162 632c 5c6e  '@article{abc,\n
+000431f0: 6175 7468 6f72 3d22 6d65 222c 5c6e 7469  author="me",\nti
+00043200: 746c 653d 2261 6263 222c 5c6e 7d27 2c20  tle="abc",\n}', 
+00043210: 6d65 7468 6f64 3d22 6269 6274 6578 220a  method="bibtex".
+00043220: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00043230: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00043240: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00043250: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00043260: 636f 756e 7428 292c 2032 290a 2020 2020  count(), 2).    
+00043270: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00043280: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00043290: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+000432a0: 2e6c 6f61 6441 6e64 496e 7365 7274 280a  .loadAndInsert(.
+000432b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000432c0: 2740 6172 7469 636c 657b 6162 632c 5c6e  '@article{abc,\n
+000432d0: 6175 7468 6f72 3d22 6d65 222c 5c6e 7469  author="me",\nti
+000432e0: 746c 653d 2261 6263 222c 5c6e 7d27 2c0a  tle="abc",\n}',.
+000432f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043300: 6d65 7468 6f64 3d22 6269 6274 6578 222c  method="bibtex",
+00043310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043320: 2072 6574 7572 6e42 6962 7465 783d 5472   returnBibtex=Tr
+00043330: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+00043340: 292c 0a20 2020 2020 2020 2020 2020 2027  ),.            '
+00043350: 4041 7274 6963 6c65 7b61 6263 2c5c 6e20  @Article{abc,\n 
+00043360: 2020 2020 2020 2061 7574 686f 7220 3d20         author = 
+00043370: 226d 6522 2c5c 6e20 2020 2020 2020 2020  "me",\n         
+00043380: 2720 2b20 2774 6974 6c65 203d 2022 7b61  ' + 'title = "{a
+00043390: 6263 7d22 2c5c 6e7d 272c 0a20 2020 2020  bc}",\n}',.     
+000433a0: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
+000433b0: 6820 7061 7463 6828 0a20 2020 2020 2020  h patch(.       
+000433c0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+000433d0: 2e64 6174 6162 6173 652e 456e 7472 6965  .database.Entrie
+000433e0: 732e 6368 6563 6b45 7869 7374 696e 6745  s.checkExistingE
+000433f0: 6e74 7279 222c 0a20 2020 2020 2020 2020  ntry",.         
+00043400: 2020 2073 6964 655f 6566 6665 6374 3d5b     side_effect=[
+00043410: 5b5d 2c20 5b7b 2262 6962 6b65 7922 3a20  [], [{"bibkey": 
+00043420: 2261 6263 222c 2022 6f6c 645f 6b65 7973  "abc", "old_keys
+00043430: 223a 204e 6f6e 657d 5d5d 2c0a 2020 2020  ": None}]],.    
+00043440: 2020 2020 2920 6173 205f 6365 2c20 7061      ) as _ce, pa
+00043450: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+00043460: 2022 7068 7973 6269 626c 696f 2e77 6562   "physbiblio.web
+00043470: 696d 706f 7274 2e69 6e73 7069 7265 2e57  import.inspire.W
+00043480: 6562 5365 6172 6368 2e72 6574 7269 6576  ebSearch.retriev
+00043490: 6555 726c 416c 6c22 2c0a 2020 2020 2020  eUrlAll",.      
+000434a0: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
+000434b0: 7565 3d27 4041 7274 6963 6c65 7b61 6263  ue='@Article{abc
+000434c0: 2c5c 6e20 2020 2020 2020 2061 7574 686f  ,\n        autho
+000434d0: 7220 3d20 226d 6522 2c5c 6e20 2020 2020  r = "me",\n     
+000434e0: 2020 2020 270a 2020 2020 2020 2020 2020      '.          
+000434f0: 2020 2b20 2774 6974 6c65 203d 2022 7b61    + 'title = "{a
+00043500: 6263 7d22 2c5c 6e7d 272c 0a20 2020 2020  bc}",\n}',.     
+00043510: 2020 2029 2061 7320 5f72 753a 0a20 2020     ) as _ru:.   
+00043520: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00043530: 7365 7274 5472 7565 280a 2020 2020 2020  sertTrue(.      
+00043540: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00043550: 4244 422e 6269 6273 2e6c 6f61 6441 6e64  BDB.bibs.loadAnd
+00043560: 496e 7365 7274 280a 2020 2020 2020 2020  Insert(.        
+00043570: 2020 2020 2020 2020 2020 2020 2278 797a              "xyz
+00043580: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00043590: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+000435a0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
+000435b0: 6365 2e61 7373 6572 745f 616e 795f 6361  ce.assert_any_ca
+000435c0: 6c6c 2822 7879 7a22 290a 2020 2020 2020  ll("xyz").      
+000435d0: 2020 2020 2020 5f63 652e 6173 7365 7274        _ce.assert
+000435e0: 5f63 616c 6c65 645f 7769 7468 2822 6162  _called_with("ab
+000435f0: 6322 2c20 6172 7869 763d 2222 2c20 646f  c", arxiv="", do
+00043600: 693d 4e6f 6e65 290a 2020 2020 2020 2020  i=None).        
+00043610: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00043620: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
+00043630: 6962 732e 6765 7442 794b 6579 2822 6162  ibs.getByKey("ab
+00043640: 6322 295b 305d 5b22 6f6c 645f 6b65 7973  c")[0]["old_keys
+00043650: 225d 2c20 2278 797a 2229 0a20 2020 2020  "], "xyz").     
+00043660: 2020 2077 6974 6820 7061 7463 6828 0a20     with patch(. 
+00043670: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+00043680: 6269 626c 696f 2e64 6174 6162 6173 652e  biblio.database.
+00043690: 456e 7472 6965 732e 6368 6563 6b45 7869  Entries.checkExi
+000436a0: 7374 696e 6745 6e74 7279 222c 0a20 2020  stingEntry",.   
+000436b0: 2020 2020 2020 2020 2073 6964 655f 6566           side_ef
+000436c0: 6665 6374 3d5b 5b5d 2c20 5b7b 2262 6962  fect=[[], [{"bib
+000436d0: 6b65 7922 3a20 2261 6263 222c 2022 6f6c  key": "abc", "ol
+000436e0: 645f 6b65 7973 223a 2022 7879 7a22 7d5d  d_keys": "xyz"}]
+000436f0: 5d2c 0a20 2020 2020 2020 2029 2061 7320  ],.        ) as 
+00043700: 5f63 652c 2070 6174 6368 280a 2020 2020  _ce, patch(.    
+00043710: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
+00043720: 6c69 6f2e 7765 6269 6d70 6f72 742e 696e  lio.webimport.in
+00043730: 7370 6972 652e 5765 6253 6561 7263 682e  spire.WebSearch.
+00043740: 7265 7472 6965 7665 5572 6c41 6c6c 222c  retrieveUrlAll",
+00043750: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00043760: 7572 6e5f 7661 6c75 653d 2740 4172 7469  urn_value='@Arti
+00043770: 636c 657b 6162 632c 5c6e 2020 2020 2020  cle{abc,\n      
+00043780: 2020 6175 7468 6f72 203d 2022 6d65 222c    author = "me",
+00043790: 5c6e 2020 2020 2020 2020 2027 0a20 2020  \n         '.   
+000437a0: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
+000437b0: 6520 3d20 227b 6162 637d 222c 5c6e 7d27  e = "{abc}",\n}'
+000437c0: 2c0a 2020 2020 2020 2020 2920 6173 205f  ,.        ) as _
+000437d0: 7275 3a0a 2020 2020 2020 2020 2020 2020  ru:.            
+000437e0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+000437f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043800: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00043810: 6c6f 6164 416e 6449 6e73 6572 7428 0a20  loadAndInsert(. 
+00043820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043830: 2020 2022 7071 7222 2c0a 2020 2020 2020     "pqr",.      
+00043840: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00043850: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00043860: 2020 2020 2020 5f63 652e 6173 7365 7274        _ce.assert
+00043870: 5f61 6e79 5f63 616c 6c28 2270 7172 2229  _any_call("pqr")
+00043880: 0a20 2020 2020 2020 2020 2020 205f 6365  .            _ce
+00043890: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+000438a0: 6974 6828 2261 6263 222c 2061 7278 6976  ith("abc", arxiv
+000438b0: 3d22 222c 2064 6f69 3d4e 6f6e 6529 0a20  ="", doi=None). 
+000438c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000438d0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+000438e0: 2e70 4244 422e 6269 6273 2e67 6574 4279  .pBDB.bibs.getBy
+000438f0: 4b65 7928 2261 6263 2229 5b30 5d5b 226f  Key("abc")[0]["o
+00043900: 6c64 5f6b 6579 7322 5d2c 2022 7879 7a2c  ld_keys"], "xyz,
+00043910: 7071 7222 290a 2020 2020 2020 2020 2320  pqr").        # 
+00043920: 7265 7475 726e 4269 6274 6578 0a20 2020  returnBibtex.   
+00043930: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00043940: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00043950: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+00043960: 732e 6c6f 6164 416e 6449 6e73 6572 7428  s.loadAndInsert(
+00043970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043980: 2027 4061 7274 6963 6c65 7b67 6869 2c5c   '@article{ghi,\
+00043990: 6e61 7574 686f 723d 226d 6522 2c5c 6e74  nauthor="me",\nt
+000439a0: 6974 6c65 3d22 6768 6922 2c5c 6e7d 272c  itle="ghi",\n}',
+000439b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000439c0: 206d 6574 686f 643d 2262 6962 7465 7822   method="bibtex"
+000439d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000439e0: 2020 7265 7475 726e 4269 6274 6578 3d54    returnBibtex=T
+000439f0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+00043a00: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+00043a10: 2740 4172 7469 636c 657b 6768 692c 5c6e  '@Article{ghi,\n
+00043a20: 2020 2020 2020 2020 6175 7468 6f72 203d          author =
+00043a30: 2022 6d65 222c 5c6e 2020 2020 2020 2020   "me",\n        
+00043a40: 2027 202b 2027 7469 746c 6520 3d20 227b   ' + 'title = "{
+00043a50: 6768 697d 222c 5c6e 7d27 2c0a 2020 2020  ghi}",\n}',.    
+00043a60: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00043a70: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00043a80: 656c 662e 7042 4442 2e62 6962 732e 6c61  elf.pBDB.bibs.la
+00043a90: 7374 496e 7365 7274 6564 2c20 5b22 6768  stInserted, ["gh
+00043aa0: 6922 5d29 0a20 2020 2020 2020 2023 2075  i"]).        # u
+00043ab0: 6e72 6561 6461 626c 6520 6269 6274 6578  nreadable bibtex
+00043ac0: 2028 6269 6274 6578 206d 6574 686f 6429   (bibtex method)
+00043ad0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00043ae0: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
+00043af0: 4244 422e 6269 6273 2e6c 6f61 6441 6e64  BDB.bibs.loadAnd
+00043b00: 496e 7365 7274 2822 4061 7274 6963 6c65  Insert("@article
+00043b10: 7b6a 6b6c 2c22 2c20 6d65 7468 6f64 3d22  {jkl,", method="
+00043b20: 6269 6274 6578 2229 290a 0a20 2020 2020  bibtex"))..     
+00043b30: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
+00043b40: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
+00043b50: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+00043b60: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
+00043b70: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
+00043b80: 652e 456e 7472 6965 732e 7570 6461 7465  e.Entries.update
+00043b90: 496e 7370 6972 6549 4422 2c0a 2020 2020  InspireID",.    
+00043ba0: 2020 2020 2020 2020 7265 7475 726e 5f76          return_v
+00043bb0: 616c 7565 3d22 3122 2c0a 2020 2020 2020  alue="1",.      
+00043bc0: 2020 2020 2020 6175 746f 7370 6563 3d54        autospec=T
+00043bd0: 7275 652c 0a20 2020 2020 2020 2029 2061  rue,.        ) a
+00043be0: 7320 5f6d 6f63 6b5f 7569 6964 2c20 7061  s _mock_uiid, pa
+00043bf0: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+00043c00: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
+00043c10: 6162 6173 652e 456e 7472 6965 732e 7570  abase.Entries.up
+00043c20: 6461 7465 496e 666f 4672 6f6d 4f41 4922  dateInfoFromOAI"
+00043c30: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+00043c40: 7475 726e 5f76 616c 7565 3d54 7275 652c  turn_value=True,
+00043c50: 0a20 2020 2020 2020 2020 2020 2061 7574  .            aut
+00043c60: 6f73 7065 633d 5472 7565 2c0a 2020 2020  ospec=True,.    
+00043c70: 2020 2020 2920 6173 205f 6d6f 636b 5f75      ) as _mock_u
+00043c80: 696f 2c20 7061 7463 682e 6469 6374 280a  io, patch.dict(.
+00043c90: 2020 2020 2020 2020 2020 2020 7062 436f              pbCo
+00043ca0: 6e66 6967 2e70 6172 616d 732c 0a20 2020  nfig.params,.   
+00043cb0: 2020 2020 2020 2020 207b 2266 6574 6368           {"fetch
+00043cc0: 4162 7374 7261 6374 223a 2046 616c 7365  Abstract": False
+00043cd0: 2c20 2264 6566 6175 6c74 4361 7465 676f  , "defaultCatego
+00043ce0: 7269 6573 223a 205b 315d 7d2c 0a20 2020  ries": [1]},.   
+00043cf0: 2020 2020 2020 2020 2063 6c65 6172 3d46           clear=F
+00043d00: 616c 7365 2c0a 2020 2020 2020 2020 293a  alse,.        ):
+00043d10: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
+00043d20: 6573 7420 6164 6420 6361 7465 676f 7269  est add categori
+00043d30: 6573 0a20 2020 2020 2020 2020 2020 2077  es.            w
+00043d40: 6974 6820 7061 7463 6828 0a20 2020 2020  ith patch(.     
+00043d50: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+00043d60: 6269 626c 696f 2e77 6562 696d 706f 7274  biblio.webimport
+00043d70: 2e69 6e73 7069 7265 2e57 6562 5365 6172  .inspire.WebSear
+00043d80: 6368 2e72 6574 7269 6576 6555 726c 416c  ch.retrieveUrlAl
+00043d90: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
+00043da0: 2020 2020 7265 7475 726e 5f76 616c 7565      return_value
+00043db0: 3d22 5c6e 4061 7274 6963 6c65 7b6b 6579  ="\n@article{key
+00043dc0: 302c 5c6e 220a 2020 2020 2020 2020 2020  0,\n".          
+00043dd0: 2020 2020 2020 2b20 2761 7574 686f 7220        + 'author 
+00043de0: 3d20 2247 6172 6961 7a7a 6f22 2c5c 6e74  = "Gariazzo",\nt
+00043df0: 6974 6c65 203d 2022 7b74 6974 6c65 7d22  itle = "{title}"
+00043e00: 2c7d 5c6e 272c 0a20 2020 2020 2020 2020  ,}\n',.         
+00043e10: 2020 2020 2020 2061 7574 6f73 7065 633d         autospec=
+00043e20: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00043e30: 2020 2920 6173 205f 6d6f 636b 3a0a 2020    ) as _mock:.  
+00043e40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00043e50: 6c66 2e61 7373 6572 7454 7275 6528 7365  lf.assertTrue(se
+00043e60: 6c66 2e70 4244 422e 6269 6273 2e6c 6f61  lf.pBDB.bibs.loa
+00043e70: 6441 6e64 496e 7365 7274 2822 6b65 7930  dAndInsert("key0
+00043e80: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
+00043e90: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00043ea0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00043eb0: 2020 2020 2020 2020 2020 5b65 5b22 6964            [e["id
+00043ec0: 4361 7422 5d20 666f 7220 6520 696e 2073  Cat"] for e in s
+00043ed0: 656c 662e 7042 4442 2e63 6174 732e 6765  elf.pBDB.cats.ge
+00043ee0: 7442 7945 6e74 7279 2822 6b65 7930 2229  tByEntry("key0")
+00043ef0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00043f00: 2020 2020 2020 2070 6243 6f6e 6669 672e         pbConfig.
+00043f10: 7061 7261 6d73 5b22 6465 6661 756c 7443  params["defaultC
+00043f20: 6174 6567 6f72 6965 7322 5d2c 0a20 2020  ategories"],.   
+00043f30: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00043f40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00043f50: 7042 4442 2e75 6e64 6f28 7665 7262 6f73  pBDB.undo(verbos
+00043f60: 653d 3029 0a20 2020 2020 2020 2020 2020  e=0).           
+00043f70: 2023 2074 6573 7420 7769 7468 206c 6973   # test with lis
+00043f80: 7420 656e 7472 7920 2861 6c73 6f20 6e65  t entry (also ne
+00043f90: 7374 6564 206c 6973 7473 290a 2020 2020  sted lists).    
+00043fa0: 2020 2020 2020 2020 7062 6d20 3d20 4d61          pbm = Ma
+00043fb0: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
+00043fc0: 2020 2020 2020 7062 7620 3d20 4d61 6769        pbv = Magi
+00043fd0: 634d 6f63 6b28 290a 2020 2020 2020 2020  cMock().        
+00043fe0: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
+00043ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044000: 2270 6879 7362 6962 6c69 6f2e 7765 6269  "physbiblio.webi
+00044010: 6d70 6f72 742e 696e 7370 6972 652e 5765  mport.inspire.We
+00044020: 6253 6561 7263 682e 7265 7472 6965 7665  bSearch.retrieve
+00044030: 5572 6c41 6c6c 222c 0a20 2020 2020 2020  UrlAll",.       
+00044040: 2020 2020 2020 2020 2073 6964 655f 6566           side_ef
+00044050: 6665 6374 3d5b 0a20 2020 2020 2020 2020  fect=[.         
+00044060: 2020 2020 2020 2020 2020 2027 5c6e 4061             '\n@a
+00044070: 7274 6963 6c65 7b6b 6579 302c 5c6e 6175  rticle{key0,\nau
+00044080: 7468 6f72 203d 2022 4761 7269 617a 7a6f  thor = "Gariazzo
+00044090: 222c 5c6e 270a 2020 2020 2020 2020 2020  ",\n'.          
+000440a0: 2020 2020 2020 2020 2020 2b20 2774 6974            + 'tit
+000440b0: 6c65 203d 2022 7b74 6974 6c65 7d22 2c7d  le = "{title}",}
+000440c0: 5c6e 272c 0a20 2020 2020 2020 2020 2020  \n',.           
+000440d0: 2020 2020 2020 2020 2027 5c6e 4061 7274           '\n@art
+000440e0: 6963 6c65 7b6b 6579 302c 5c6e 6175 7468  icle{key0,\nauth
+000440f0: 6f72 203d 2022 4761 7269 617a 7a6f 222c  or = "Gariazzo",
+00044100: 5c6e 270a 2020 2020 2020 2020 2020 2020  \n'.            
+00044110: 2020 2020 2020 2020 2b20 2774 6974 6c65          + 'title
+00044120: 203d 2022 7b74 6974 6c65 7d22 2c7d 5c6e   = "{title}",}\n
+00044130: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+00044140: 2020 2020 2020 2027 5c6e 4061 7274 6963         '\n@artic
+00044150: 6c65 7b6b 6579 302c 5c6e 6175 7468 6f72  le{key0,\nauthor
+00044160: 203d 2022 4761 7269 617a 7a6f 222c 5c6e   = "Gariazzo",\n
+00044170: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00044180: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
+00044190: 2022 7b74 6974 6c65 7d22 2c7d 5c6e 272c   "{title}",}\n',
+000441a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000441b0: 2020 2020 2027 5c6e 4061 7274 6963 6c65       '\n@article
+000441c0: 7b6b 6579 302c 5c6e 6175 7468 6f72 203d  {key0,\nauthor =
+000441d0: 2022 4761 7269 617a 7a6f 222c 5c6e 270a   "Gariazzo",\n'.
+000441e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000441f0: 2020 2020 2b20 2774 6974 6c65 203d 2022      + 'title = "
+00044200: 7b74 6974 6c65 7d22 2c7d 5c6e 272c 0a20  {title}",}\n',. 
+00044210: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00044220: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00044230: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
+00044240: 0a20 2020 2020 2020 2020 2020 2029 2061  .            ) a
+00044250: 7320 5f6d 6f63 6b3a 0a20 2020 2020 2020  s _mock:.       
+00044260: 2020 2020 2020 2020 2077 6974 6820 7061           with pa
+00044270: 7463 6828 226c 6f67 6769 6e67 2e4c 6f67  tch("logging.Log
+00044280: 6765 722e 696e 666f 2229 2061 7320 5f69  ger.info") as _i
+00044290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000442a0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+000442b0: 6269 6273 2e6c 6f61 6441 6e64 496e 7365  bibs.loadAndInse
+000442c0: 7274 285b 226b 6579 3022 2c20 226b 6579  rt(["key0", "key
+000442d0: 3122 5d29 0a20 2020 2020 2020 2020 2020  1"]).           
+000442e0: 2020 2020 2020 2020 205f 692e 6173 7365           _i.asse
+000442f0: 7274 5f61 6e79 5f63 616c 6c28 2241 6c72  rt_any_call("Alr
+00044300: 6561 6479 2065 7869 7374 696e 673a 206b  eady existing: k
+00044310: 6579 305c 6e22 290a 2020 2020 2020 2020  ey0\n").        
+00044320: 2020 2020 2020 2020 5f6d 6f63 6b2e 6173          _mock.as
+00044330: 7365 7274 5f68 6173 5f63 616c 6c73 280a  sert_has_calls(.
+00044340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044350: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
+00044360: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+00044370: 6c6c 2870 6879 7342 6962 6c69 6f57 6562  ll(physBiblioWeb
+00044380: 2e77 6562 5365 6172 6368 5b22 696e 7370  .webSearch["insp
+00044390: 6972 6522 5d2c 2022 6b65 7930 2229 2c0a  ire"], "key0"),.
+000443a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000443b0: 2020 2020 2020 2020 6361 6c6c 2870 6879          call(phy
+000443c0: 7342 6962 6c69 6f57 6562 2e77 6562 5365  sBiblioWeb.webSe
+000443d0: 6172 6368 5b22 696e 7370 6972 6522 5d2c  arch["inspire"],
+000443e0: 2022 6b65 7931 2229 2c0a 2020 2020 2020   "key1"),.      
+000443f0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+00044400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044410: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00044420: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00044430: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
+00044440: 732e 636f 756e 7428 292c 2031 290a 2020  s.count(), 1).  
+00044450: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00044460: 7468 2070 6174 6368 2822 6c6f 6767 696e  th patch("loggin
+00044470: 672e 4c6f 6767 6572 2e69 6e66 6f22 2920  g.Logger.info") 
+00044480: 6173 205f 693a 0a20 2020 2020 2020 2020  as _i:.         
+00044490: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000444a0: 7042 4442 2e62 6962 732e 6c6f 6164 416e  pBDB.bibs.loadAn
+000444b0: 6449 6e73 6572 7428 5b22 6b65 7930 222c  dInsert(["key0",
+000444c0: 2022 6b65 7931 225d 2c20 7062 4d61 783d   "key1"], pbMax=
+000444d0: 7062 6d2c 2070 6256 616c 3d70 6276 290a  pbm, pbVal=pbv).
+000444e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000444f0: 2020 2020 5f69 2e61 7373 6572 745f 616e      _i.assert_an
+00044500: 795f 6361 6c6c 2822 416c 7265 6164 7920  y_call("Already 
+00044510: 6578 6973 7469 6e67 3a20 6b65 7930 5c6e  existing: key0\n
+00044520: 2229 0a20 2020 2020 2020 2020 2020 2070  ").            p
+00044530: 626d 2e61 7373 6572 745f 6361 6c6c 6564  bm.assert_called
+00044540: 5f6f 6e63 655f 7769 7468 2832 290a 2020  _once_with(2).  
+00044550: 2020 2020 2020 2020 2020 7062 762e 6173            pbv.as
+00044560: 7365 7274 5f68 6173 5f63 616c 6c73 285b  sert_has_calls([
+00044570: 6361 6c6c 2831 292c 2063 616c 6c28 3229  call(1), call(2)
+00044580: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
+00044590: 656c 662e 7042 4442 2e75 6e64 6f28 7665  elf.pBDB.undo(ve
+000445a0: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
+000445b0: 2020 2020 2023 2074 6573 7420 7769 7468       # test with
+000445c0: 206e 756d 6265 723e 300a 2020 2020 2020   number>0.      
+000445d0: 2020 2020 2020 7062 6d20 3d20 4d61 6769        pbm = Magi
+000445e0: 634d 6f63 6b28 290a 2020 2020 2020 2020  cMock().        
+000445f0: 2020 2020 7062 7620 3d20 4d61 6769 634d      pbv = MagicM
+00044600: 6f63 6b28 290a 2020 2020 2020 2020 2020  ock().          
+00044610: 2020 7769 7468 2070 6174 6368 280a 2020    with patch(.  
+00044620: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00044630: 6879 7362 6962 6c69 6f2e 7765 6269 6d70  hysbiblio.webimp
+00044640: 6f72 742e 696e 7370 6972 652e 5765 6253  ort.inspire.WebS
+00044650: 6561 7263 682e 7265 7472 6965 7665 5572  earch.retrieveUr
+00044660: 6c41 6c6c 222c 0a20 2020 2020 2020 2020  lAll",.         
+00044670: 2020 2020 2020 2073 6964 655f 6566 6665         side_effe
+00044680: 6374 3d5b 0a20 2020 2020 2020 2020 2020  ct=[.           
+00044690: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+000446a0: 6c65 7b6b 6579 302c 5c6e 6175 7468 6f72  le{key0,\nauthor
+000446b0: 203d 2022 4761 7269 617a 7a6f 222c 5c6e   = "Gariazzo",\n
+000446c0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+000446d0: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
+000446e0: 2022 7b74 6974 6c65 7d22 2c7d 5c6e 4061   "{title}",}\n@a
+000446f0: 7274 6963 6c65 7b6b 6579 312c 5c6e 6175  rticle{key1,\nau
+00044700: 7468 6f72 203d 2027 0a20 2020 2020 2020  thor = '.       
+00044710: 2020 2020 2020 2020 2020 2020 202b 2027               + '
+00044720: 2247 6172 6961 7a7a 6f22 2c5c 6e74 6974  "Gariazzo",\ntit
+00044730: 6c65 203d 2022 7b74 6974 6c65 7d22 2c7d  le = "{title}",}
+00044740: 5c6e 272c 0a20 2020 2020 2020 2020 2020  \n',.           
+00044750: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+00044760: 6c65 7b6b 6579 302c 5c6e 6175 7468 6f72  le{key0,\nauthor
+00044770: 203d 2022 4761 7269 617a 7a6f 222c 5c6e   = "Gariazzo",\n
+00044780: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00044790: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
+000447a0: 2022 7b74 6974 6c65 7d22 2c7d 5c6e 4061   "{title}",}\n@a
+000447b0: 7274 6963 6c65 7b6b 6579 312c 5c6e 270a  rticle{key1,\n'.
+000447c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000447d0: 2020 2020 2b20 2761 7574 686f 7220 3d20      + 'author = 
+000447e0: 2247 6172 6961 7a7a 6f22 2c5c 6e74 6974  "Gariazzo",\ntit
+000447f0: 6c65 203d 2022 7b74 6974 6c65 7d22 2c7d  le = "{title}",}
+00044800: 5c6e 272c 0a20 2020 2020 2020 2020 2020  \n',.           
+00044810: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00044820: 2020 2020 2020 2020 6175 746f 7370 6563          autospec
+00044830: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+00044840: 2020 2029 2061 7320 5f6d 6f63 6b3a 0a20     ) as _mock:. 
+00044850: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00044860: 656c 662e 6173 7365 7274 5472 7565 280a  elf.assertTrue(.
+00044870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044880: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00044890: 6273 2e6c 6f61 6441 6e64 496e 7365 7274  bs.loadAndInsert
+000448a0: 2822 6b65 7930 222c 206e 756d 6265 723d  ("key0", number=
+000448b0: 312c 2070 624d 6178 3d70 626d 2c20 7062  1, pbMax=pbm, pb
+000448c0: 5661 6c3d 7062 7629 0a20 2020 2020 2020  Val=pbv).       
+000448d0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000448e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000448f0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00044900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044910: 205b 655b 2262 6962 6b65 7922 5d20 666f   [e["bibkey"] fo
+00044920: 7220 6520 696e 2073 656c 662e 7042 4442  r e in self.pBDB
+00044930: 2e62 6962 732e 6765 7441 6c6c 2829 5d2c  .bibs.getAll()],
+00044940: 205b 226b 6579 3122 5d0a 2020 2020 2020   ["key1"].      
+00044950: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00044960: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00044970: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+00044980: 2e70 4244 422e 6269 6273 2e6c 6f61 6441  .pBDB.bibs.loadA
+00044990: 6e64 496e 7365 7274 2822 6b65 7930 222c  ndInsert("key0",
+000449a0: 206e 756d 6265 723d 3029 290a 2020 2020   number=0)).    
+000449b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000449c0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+000449d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000449e0: 2020 5b65 5b22 6269 626b 6579 225d 2066    [e["bibkey"] f
+000449f0: 6f72 2065 2069 6e20 7365 6c66 2e70 4244  or e in self.pBD
+00044a00: 422e 6269 6273 2e67 6574 416c 6c28 295d  B.bibs.getAll()]
+00044a10: 2c20 5b22 6b65 7931 222c 2022 6b65 7930  , ["key1", "key0
+00044a20: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+00044a30: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00044a40: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00044a50: 6c28 7062 6d2e 6361 6c6c 5f63 6f75 6e74  l(pbm.call_count
+00044a60: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+00044a70: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00044a80: 6c28 7062 762e 6361 6c6c 5f63 6f75 6e74  l(pbv.call_count
+00044a90: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+00044aa0: 2073 656c 662e 7042 4442 2e75 6e64 6f28   self.pBDB.undo(
+00044ab0: 7665 7262 6f73 653d 3029 0a20 2020 2020  verbose=0).     
+00044ac0: 2020 2020 2020 2023 2074 6573 7420 6162         # test ab
+00044ad0: 7374 7261 6374 2064 6f77 6e6c 6f61 640a  stract download.
+00044ae0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00044af0: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+00044b00: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
+00044b10: 6c69 6f2e 7765 6269 6d70 6f72 742e 696e  lio.webimport.in
+00044b20: 7370 6972 652e 5765 6253 6561 7263 682e  spire.WebSearch.
+00044b30: 7265 7472 6965 7665 5572 6c41 6c6c 222c  retrieveUrlAll",
+00044b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044b50: 2073 6964 655f 6566 6665 6374 3d5b 0a20   side_effect=[. 
+00044b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044b70: 2020 2027 5c6e 4061 7274 6963 6c65 7b6b     '\n@article{k
+00044b80: 6579 302c 5c6e 6175 7468 6f72 203d 2022  ey0,\nauthor = "
+00044b90: 4761 7269 617a 7a6f 222c 5c6e 270a 2020  Gariazzo",\n'.  
+00044ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044bb0: 2020 2b20 2774 6974 6c65 203d 2022 7b74    + 'title = "{t
+00044bc0: 6974 6c65 7d22 2c7d 5c6e 272c 0a20 2020  itle}",}\n',.   
+00044bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044be0: 2027 5c6e 4061 7274 6963 6c65 7b6b 6579   '\n@article{key
+00044bf0: 312c 5c6e 6175 7468 6f72 203d 2022 4761  1,\nauthor = "Ga
+00044c00: 7269 617a 7a6f 222c 5c6e 270a 2020 2020  riazzo",\n'.    
+00044c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044c20: 2b20 2774 6974 6c65 203d 2022 7b74 6974  + 'title = "{tit
+00044c30: 6c65 7d22 2c5c 6e61 7278 6976 3d22 3132  le}",\narxiv="12
+00044c40: 3334 2e35 3637 3822 2c7d 5c6e 272c 0a20  34.5678",}\n',. 
+00044c50: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00044c60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00044c70: 2020 6175 746f 7370 6563 3d54 7275 652c    autospec=True,
+00044c80: 0a20 2020 2020 2020 2020 2020 2029 2061  .            ) a
+00044c90: 7320 5f6d 6f63 6b2c 2070 6174 6368 280a  s _mock, patch(.
+00044ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044cb0: 2270 6879 7362 6962 6c69 6f2e 7765 6269  "physbiblio.webi
+00044cc0: 6d70 6f72 742e 6172 7869 762e 5765 6253  mport.arxiv.WebS
+00044cd0: 6561 7263 682e 7265 7472 6965 7665 5572  earch.retrieveUr
+00044ce0: 6c41 6c6c 222c 0a20 2020 2020 2020 2020  lAll",.         
+00044cf0: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
+00044d00: 6c75 653d 280a 2020 2020 2020 2020 2020  lue=(.          
+00044d10: 2020 2020 2020 2020 2020 225c 6e40 6172            "\n@ar
+00044d20: 7469 636c 657b 6b65 7930 2c5c 6e22 0a20  ticle{key0,\n". 
+00044d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044d40: 2020 202b 2027 6175 7468 6f72 203d 2022     + 'author = "
+00044d50: 4761 7269 617a 7a6f 222c 5c6e 7469 746c  Gariazzo",\ntitl
+00044d60: 6520 3d20 227b 7469 746c 657d 222c 7d5c  e = "{title}",}\
+00044d70: 6e27 2c0a 2020 2020 2020 2020 2020 2020  n',.            
+00044d80: 2020 2020 2020 2020 7b22 6162 7374 7261          {"abstra
+00044d90: 6374 223a 2022 736f 6d65 2066 616b 6520  ct": "some fake 
+00044da0: 6162 7374 7261 6374 227d 2c0a 2020 2020  abstract"},.    
+00044db0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00044dc0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00044dd0: 7574 6f73 7065 633d 5472 7565 2c0a 2020  utospec=True,.  
+00044de0: 2020 2020 2020 2020 2020 2920 6173 205f            ) as _
+00044df0: 6d6f 636b 2c20 7061 7463 682e 6469 6374  mock, patch.dict
+00044e00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00044e10: 2020 7062 436f 6e66 6967 2e70 6172 616d    pbConfig.param
+00044e20: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00044e30: 2020 207b 2266 6574 6368 4162 7374 7261     {"fetchAbstra
+00044e40: 6374 223a 2054 7275 652c 2022 6465 6661  ct": True, "defa
+00044e50: 756c 7443 6174 6567 6f72 6965 7322 3a20  ultCategories": 
+00044e60: 5b31 5d7d 2c0a 2020 2020 2020 2020 2020  [1]},.          
+00044e70: 2020 2020 2020 636c 6561 723d 4661 6c73        clear=Fals
+00044e80: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
+00044e90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00044ea0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+00044eb0: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
+00044ec0: 2e6c 6f61 6441 6e64 496e 7365 7274 2822  .loadAndInsert("
+00044ed0: 6b65 7930 2229 290a 2020 2020 2020 2020  key0")).        
+00044ee0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00044ef0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00044f00: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00044f10: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+00044f20: 4279 4269 626b 6579 2822 6b65 7930 2229  ByBibkey("key0")
+00044f30: 5b30 5d5b 2261 6273 7472 6163 7422 5d2c  [0]["abstract"],
+00044f40: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00044f50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00044f60: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00044f70: 6572 7454 7275 6528 7365 6c66 2e70 4244  ertTrue(self.pBD
+00044f80: 422e 6269 6273 2e6c 6f61 6441 6e64 496e  B.bibs.loadAndIn
+00044f90: 7365 7274 2822 6b65 7931 2229 290a 2020  sert("key1")).  
+00044fa0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00044fb0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00044fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044fd0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00044fe0: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
+00044ff0: 6b65 7931 2229 5b30 5d5b 2261 6273 7472  key1")[0]["abstr
+00045000: 6163 7422 5d2c 0a20 2020 2020 2020 2020  act"],.         
+00045010: 2020 2020 2020 2020 2020 2022 736f 6d65             "some
+00045020: 2066 616b 6520 6162 7374 7261 6374 222c   fake abstract",
+00045030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045040: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
+00045050: 656c 662e 7042 4442 2e75 6e64 6f28 7665  elf.pBDB.undo(ve
+00045060: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
+00045070: 2020 2020 2023 2075 6e72 6561 6461 626c       # unreadabl
+00045080: 6520 6269 6274 6578 2c20 656d 7074 7920  e bibtex, empty 
+00045090: 6269 626b 6579 2028 616e 7920 6f74 6865  bibkey (any othe
+000450a0: 7220 6d65 7468 6f64 290a 2020 2020 2020  r method).      
+000450b0: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+000450c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000450d0: 2020 2270 6879 7362 6962 6c69 6f2e 7765    "physbiblio.we
+000450e0: 6269 6d70 6f72 742e 696e 7370 6972 652e  bimport.inspire.
+000450f0: 5765 6253 6561 7263 682e 7265 7472 6965  WebSearch.retrie
+00045100: 7665 5572 6c41 6c6c 222c 0a20 2020 2020  veUrlAll",.     
+00045110: 2020 2020 2020 2020 2020 2073 6964 655f             side_
+00045120: 6566 6665 6374 3d5b 0a20 2020 2020 2020  effect=[.       
+00045130: 2020 2020 2020 2020 2020 2020 2022 5c6e               "\n
+00045140: 4061 7274 6963 6c65 7b6b 6579 302c 5c6e  @article{key0,\n
+00045150: 6175 7468 6f72 203d 2022 2c0a 2020 2020  author = ",.    
+00045160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045170: 225c 6e40 6172 7469 636c 657b 6b65 7930  "\n@article{key0
+00045180: 2c5c 6e61 7574 686f 7220 3d20 222c 0a20  ,\nauthor = ",. 
+00045190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000451a0: 2020 2027 5c6e 4061 7274 6963 6c65 7b20     '\n@article{ 
+000451b0: 2c5c 6e61 7574 686f 7220 3d20 2247 6172  ,\nauthor = "Gar
+000451c0: 6961 7a7a 6f22 2c5c 6e27 202b 2027 7469  iazzo",\n' + 'ti
+000451d0: 746c 6520 3d20 227b 7469 746c 657d 222c  tle = "{title}",
+000451e0: 7d5c 6e27 2c0a 2020 2020 2020 2020 2020  }\n',.          
+000451f0: 2020 2020 2020 2020 2020 275c 6e40 6172            '\n@ar
+00045200: 7469 636c 657b 202c 5c6e 6175 7468 6f72  ticle{ ,\nauthor
+00045210: 203d 2022 4761 7269 617a 7a6f 222c 5c6e   = "Gariazzo",\n
+00045220: 2720 2b20 2774 6974 6c65 203d 2022 7b74  ' + 'title = "{t
+00045230: 6974 6c65 7d22 2c7d 5c6e 272c 0a20 2020  itle}",}\n',.   
+00045240: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
+00045250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045260: 6175 746f 7370 6563 3d54 7275 652c 0a20  autospec=True,. 
+00045270: 2020 2020 2020 2020 2020 2029 2061 7320             ) as 
+00045280: 5f6d 6f63 6b2c 2070 6174 6368 2e64 6963  _mock, patch.dic
+00045290: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+000452a0: 2020 2070 6243 6f6e 6669 672e 7061 7261     pbConfig.para
+000452b0: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
+000452c0: 2020 2020 7b22 6665 7463 6841 6273 7472      {"fetchAbstr
+000452d0: 6163 7422 3a20 4661 6c73 652c 2022 6465  act": False, "de
+000452e0: 6661 756c 7443 6174 6567 6f72 6965 7322  faultCategories"
+000452f0: 3a20 5b31 5d7d 2c0a 2020 2020 2020 2020  : [1]},.        
+00045300: 2020 2020 2020 2020 636c 6561 723d 4661          clear=Fa
+00045310: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00045320: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00045330: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+00045340: 616c 7365 2873 656c 662e 7042 4442 2e62  alse(self.pBDB.b
+00045350: 6962 732e 6c6f 6164 416e 6449 6e73 6572  ibs.loadAndInser
+00045360: 7428 226b 6579 3022 2929 0a20 2020 2020  t("key0")).     
+00045370: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+00045380: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
+00045390: 6f67 6765 722e 6572 726f 7222 2920 6173  ogger.error") as
+000453a0: 205f 653a 0a20 2020 2020 2020 2020 2020   _e:.           
+000453b0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+000453c0: 4442 2e62 6962 732e 6c6f 6164 416e 6449  DB.bibs.loadAndI
+000453d0: 6e73 6572 7428 226b 6579 3022 290a 2020  nsert("key0").  
 000453e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000453f0: 225c 6e40 6172 7469 636c 657b 6b65 7930  "\n@article{key0
-00045400: 2c5c 6e61 7574 686f 7220 3d20 222c 0a20  ,\nauthor = ",. 
-00045410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045420: 2020 2027 5c6e 4061 7274 6963 6c65 7b20     '\n@article{ 
-00045430: 2c5c 6e61 7574 686f 7220 3d20 2247 6172  ,\nauthor = "Gar
-00045440: 6961 7a7a 6f22 2c5c 6e27 202b 2027 7469  iazzo",\n' + 'ti
-00045450: 746c 6520 3d20 227b 7469 746c 657d 222c  tle = "{title}",
-00045460: 7d5c 6e27 2c0a 2020 2020 2020 2020 2020  }\n',.          
-00045470: 2020 2020 2020 2020 2020 275c 6e40 6172            '\n@ar
-00045480: 7469 636c 657b 202c 5c6e 6175 7468 6f72  ticle{ ,\nauthor
-00045490: 203d 2022 4761 7269 617a 7a6f 222c 5c6e   = "Gariazzo",\n
-000454a0: 2720 2b20 2774 6974 6c65 203d 2022 7b74  ' + 'title = "{t
-000454b0: 6974 6c65 7d22 2c7d 5c6e 272c 0a20 2020  itle}",}\n',.   
-000454c0: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
-000454d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000454e0: 6175 746f 7370 6563 3d54 7275 652c 0a20  autospec=True,. 
-000454f0: 2020 2020 2020 2020 2020 2029 2061 7320             ) as 
-00045500: 5f6d 6f63 6b2c 2070 6174 6368 2e64 6963  _mock, patch.dic
-00045510: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00045520: 2020 2070 6243 6f6e 6669 672e 7061 7261     pbConfig.para
-00045530: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
-00045540: 2020 2020 7b22 6665 7463 6841 6273 7472      {"fetchAbstr
-00045550: 6163 7422 3a20 4661 6c73 652c 2022 6465  act": False, "de
-00045560: 6661 756c 7443 6174 6567 6f72 6965 7322  faultCategories"
-00045570: 3a20 5b31 5d7d 2c0a 2020 2020 2020 2020  : [1]},.        
-00045580: 2020 2020 2020 2020 636c 6561 723d 4661          clear=Fa
-00045590: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-000455a0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-000455b0: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
-000455c0: 616c 7365 2873 656c 662e 7042 4442 2e62  alse(self.pBDB.b
-000455d0: 6962 732e 6c6f 6164 416e 6449 6e73 6572  ibs.loadAndInser
-000455e0: 7428 226b 6579 3022 2929 0a20 2020 2020  t("key0")).     
-000455f0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00045600: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-00045610: 6f67 6765 722e 6572 726f 7222 2920 6173  ogger.error") as
-00045620: 205f 653a 0a20 2020 2020 2020 2020 2020   _e:.           
-00045630: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00045640: 4442 2e62 6962 732e 6c6f 6164 416e 6449  DB.bibs.loadAndI
-00045650: 6e73 6572 7428 226b 6579 3022 290a 2020  nsert("key0").  
-00045660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045670: 2020 5f65 2e61 7373 6572 745f 616e 795f    _e.assert_any_
-00045680: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-00045690: 2020 2020 2020 2020 2020 2020 2020 2249                "I
-000456a0: 6d70 6f73 7369 626c 6520 746f 2069 6e73  mpossible to ins
-000456b0: 6572 7420 616e 2065 6e74 7279 2077 6974  ert an entry wit
-000456c0: 6820 656d 7074 7920 6269 626b 6579 215c  h empty bibkey!\
-000456d0: 6e6b 6579 305c 6e22 0a20 2020 2020 2020  nkey0\n".       
-000456e0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-000456f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00045700: 656c 662e 7042 4442 2e75 6e64 6f28 7665  elf.pBDB.undo(ve
-00045710: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
-00045720: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00045730: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
-00045740: 4244 422e 6269 6273 2e6c 6f61 6441 6e64  BDB.bibs.loadAnd
-00045750: 496e 7365 7274 2822 6b65 7930 2229 290a  Insert("key0")).
-00045760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045770: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
-00045780: 696e 672e 4c6f 6767 6572 2e65 7272 6f72  ing.Logger.error
-00045790: 2229 2061 7320 5f65 3a0a 2020 2020 2020  ") as _e:.      
-000457a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000457b0: 6c66 2e70 4244 422e 6269 6273 2e6c 6f61  lf.pBDB.bibs.loa
-000457c0: 6441 6e64 496e 7365 7274 2822 6b65 7930  dAndInsert("key0
-000457d0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-000457e0: 2020 2020 2020 205f 652e 6173 7365 7274         _e.assert
-000457f0: 5f61 6e79 5f63 616c 6c28 0a20 2020 2020  _any_call(.     
-00045800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045810: 2020 2022 496d 706f 7373 6962 6c65 2074     "Impossible t
-00045820: 6f20 696e 7365 7274 2061 6e20 656e 7472  o insert an entr
-00045830: 7920 7769 7468 2065 6d70 7479 2062 6962  y with empty bib
-00045840: 6b65 7921 5c6e 6b65 7930 5c6e 220a 2020  key!\nkey0\n".  
-00045850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045860: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00045870: 7365 6c66 2e70 4244 422e 756e 646f 2876  self.pBDB.undo(v
-00045880: 6572 626f 7365 3d30 290a 2020 2020 2020  erbose=0).      
-00045890: 2020 2020 2020 5f6d 6f63 6b5f 7569 6964        _mock_uiid
-000458a0: 2e72 6573 6574 5f6d 6f63 6b28 290a 2020  .reset_mock().  
-000458b0: 2020 2020 2020 2020 2020 5f6d 6f63 6b5f            _mock_
-000458c0: 7569 6f2e 7265 7365 745f 6d6f 636b 2829  uio.reset_mock()
-000458d0: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
-000458e0: 6573 7420 7570 6461 7465 496e 7370 6972  est updateInspir
-000458f0: 6549 442c 2075 7064 6174 6549 6e66 6f46  eID, updateInfoF
-00045900: 726f 6d4f 4149 2061 7265 2063 616c 6c65  romOAI are calle
-00045910: 640a 2020 2020 2020 2020 2020 2020 7769  d.            wi
-00045920: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-00045930: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-00045940: 6962 6c69 6f2e 7765 6269 6d70 6f72 742e  iblio.webimport.
-00045950: 696e 7370 6972 652e 5765 6253 6561 7263  inspire.WebSearc
-00045960: 682e 7265 7472 6965 7665 5572 6c41 6c6c  h.retrieveUrlAll
-00045970: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00045980: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
-00045990: 225c 6e40 6172 7469 636c 657b 6b65 7930  "\n@article{key0
-000459a0: 2c5c 6e22 0a20 2020 2020 2020 2020 2020  ,\n".           
-000459b0: 2020 2020 202b 2027 6175 7468 6f72 203d       + 'author =
-000459c0: 2022 4761 7269 617a 7a6f 222c 5c6e 7469   "Gariazzo",\nti
-000459d0: 746c 6520 3d20 227b 7469 746c 657d 222c  tle = "{title}",
-000459e0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-000459f0: 2020 2b20 275c 6e61 7278 6976 3d22 3132    + '\narxiv="12
-00045a00: 3334 2e35 3637 3822 2c7d 272c 0a20 2020  34.5678",}',.   
-00045a10: 2020 2020 2020 2020 2020 2020 2061 7574               aut
-00045a20: 6f73 7065 633d 5472 7565 2c0a 2020 2020  ospec=True,.    
-00045a30: 2020 2020 2020 2020 2920 6173 205f 6d6f          ) as _mo
-00045a40: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
-00045a50: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00045a60: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
-00045a70: 6273 2e6c 6f61 6441 6e64 496e 7365 7274  bs.loadAndInsert
-00045a80: 2822 6b65 7930 2229 290a 2020 2020 2020  ("key0")).      
-00045a90: 2020 2020 2020 2020 2020 5f6d 6f63 6b5f            _mock_
-00045aa0: 7569 6964 2e61 7373 6572 745f 6361 6c6c  uiid.assert_call
-00045ab0: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
-00045ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045ad0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00045ae0: 2c20 226b 6579 3022 2c20 226b 6579 3022  , "key0", "key0"
-00045af0: 2c20 6e75 6d62 6572 3d4e 6f6e 650a 2020  , number=None.  
-00045b00: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00045b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045b20: 5f6d 6f63 6b5f 7569 6f2e 6173 7365 7274  _mock_uio.assert
-00045b30: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-00045b40: 6828 7365 6c66 2e70 4244 422e 6269 6273  h(self.pBDB.bibs
-00045b50: 2c20 2231 2229 0a20 2020 2020 2020 2020  , "1").         
-00045b60: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
-00045b70: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
-00045b80: 2020 2020 2020 2020 205f 6d6f 636b 5f75           _mock_u
-00045b90: 6969 642e 7265 7365 745f 6d6f 636b 2829  iid.reset_mock()
-00045ba0: 0a20 2020 2020 2020 2020 2020 205f 6d6f  .            _mo
-00045bb0: 636b 5f75 696f 2e72 6573 6574 5f6d 6f63  ck_uio.reset_moc
-00045bc0: 6b28 290a 2020 2020 2020 2020 2020 2020  k().            
-00045bd0: 2320 7465 7374 2075 7064 6174 6549 6e73  # test updateIns
-00045be0: 7069 7265 4944 2c20 7570 6461 7465 496e  pireID, updateIn
-00045bf0: 666f 4672 6f6d 4f41 4920 6172 6520 6361  foFromOAI are ca
-00045c00: 6c6c 6564 0a20 2020 2020 2020 2020 2020  lled.           
-00045c10: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
-00045c20: 2020 2020 2020 2020 2020 2020 2022 7068               "ph
-00045c30: 7973 6269 626c 696f 2e77 6562 696d 706f  ysbiblio.webimpo
-00045c40: 7274 2e69 6e73 7069 7265 2e57 6562 5365  rt.inspire.WebSe
-00045c50: 6172 6368 2e72 6574 7269 6576 6555 726c  arch.retrieveUrl
-00045c60: 416c 6c22 2c0a 2020 2020 2020 2020 2020  All",.          
-00045c70: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
-00045c80: 7565 3d27 4061 7274 6963 6c65 7b6b 6579  ue='@article{key
-00045c90: 302c 5c6e 6175 7468 6f72 203d 2022 4761  0,\nauthor = "Ga
-00045ca0: 7269 617a 7a6f 222c 270a 2020 2020 2020  riazzo",'.      
-00045cb0: 2020 2020 2020 2020 2020 2b20 275c 6e74            + '\nt
-00045cc0: 6974 6c65 203d 2022 7b74 6974 6c65 7d22  itle = "{title}"
-00045cd0: 2c5c 6e61 7278 6976 3d22 3132 3334 2e35  ,\narxiv="1234.5
-00045ce0: 3637 3822 2c7d 5c6e 4061 7274 6963 6c65  678",}\n@article
-00045cf0: 7b27 0a20 2020 2020 2020 2020 2020 2020  {'.             
-00045d00: 2020 202b 2027 6b65 7931 2c5c 6e61 7574     + 'key1,\naut
-00045d10: 686f 7220 3d20 2247 6172 6961 7a7a 6f22  hor = "Gariazzo"
-00045d20: 2c5c 6e74 6974 6c65 203d 2022 7b74 6974  ,\ntitle = "{tit
-00045d30: 6c65 7d22 2c27 0a20 2020 2020 2020 2020  le}",'.         
-00045d40: 2020 2020 2020 202b 2027 5c6e 6172 7869         + '\narxi
-00045d50: 763d 2231 3233 342e 3536 3738 222c 7d5c  v="1234.5678",}\
-00045d60: 6e27 2c0a 2020 2020 2020 2020 2020 2020  n',.            
-00045d70: 2020 2020 6175 746f 7370 6563 3d54 7275      autospec=Tru
-00045d80: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-00045d90: 2061 7320 5f6d 6f63 6b3a 0a20 2020 2020   as _mock:.     
-00045da0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00045db0: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
-00045dc0: 7042 4442 2e62 6962 732e 6c6f 6164 416e  pBDB.bibs.loadAn
-00045dd0: 6449 6e73 6572 7428 226b 6579 3022 2c20  dInsert("key0", 
-00045de0: 6e75 6d62 6572 3d30 2929 0a20 2020 2020  number=0)).     
-00045df0: 2020 2020 2020 2020 2020 205f 6d6f 636b             _mock
-00045e00: 5f75 6969 642e 6173 7365 7274 5f63 616c  _uiid.assert_cal
-00045e10: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
-00045e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e30: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00045e40: 732c 2022 6b65 7930 222c 2022 6b65 7930  s, "key0", "key0
-00045e50: 222c 206e 756d 6265 723d 300a 2020 2020  ", number=0.    
-00045e60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00045e70: 2020 2020 2020 2020 2020 2020 2020 5f6d                _m
-00045e80: 6f63 6b5f 7569 6f2e 6173 7365 7274 5f63  ock_uio.assert_c
-00045e90: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00045ea0: 7365 6c66 2e70 4244 422e 6269 6273 2c20  self.pBDB.bibs, 
-00045eb0: 2231 2229 0a20 2020 2020 2020 2020 2020  "1").           
-00045ec0: 2073 656c 662e 7042 4442 2e75 6e64 6f28   self.pBDB.undo(
-00045ed0: 7665 7262 6f73 653d 3029 0a20 2020 2020  verbose=0).     
-00045ee0: 2020 2020 2020 205f 6d6f 636b 5f75 6969         _mock_uii
-00045ef0: 642e 7265 7365 745f 6d6f 636b 2829 0a20  d.reset_mock(). 
-00045f00: 2020 2020 2020 2020 2020 205f 6d6f 636b             _mock
-00045f10: 5f75 696f 2e72 6573 6574 5f6d 6f63 6b28  _uio.reset_mock(
-00045f20: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-00045f30: 7465 7374 2075 7064 6174 6549 6e73 7069  test updateInspi
-00045f40: 7265 4944 2c20 7570 6461 7465 496e 666f  reID, updateInfo
-00045f50: 4672 6f6d 4f41 4920 6172 6520 6361 6c6c  FromOAI are call
-00045f60: 6564 0a20 2020 2020 2020 2020 2020 2077  ed.            w
-00045f70: 6974 6820 7061 7463 6828 0a20 2020 2020  ith patch(.     
-00045f80: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
-00045f90: 6269 626c 696f 2e77 6562 696d 706f 7274  biblio.webimport
-00045fa0: 2e61 7278 6976 2e57 6562 5365 6172 6368  .arxiv.WebSearch
-00045fb0: 2e72 6574 7269 6576 6555 726c 416c 6c22  .retrieveUrlAll"
-00045fc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00045fd0: 2020 7265 7475 726e 5f76 616c 7565 3d22    return_value="
-00045fe0: 4061 7274 6963 6c65 7b6b 6579 302c 5c6e  @article{key0,\n
-00045ff0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00046000: 2020 2b20 2761 7574 686f 7220 3d20 2247    + 'author = "G
-00046010: 6172 6961 7a7a 6f22 2c5c 6e74 6974 6c65  ariazzo",\ntitle
-00046020: 203d 2022 7b74 6974 6c65 7d22 2c27 0a20   = "{title}",'. 
-00046030: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-00046040: 2027 5c6e 6172 7869 763d 2231 3233 342e   '\narxiv="1234.
-00046050: 3536 3738 222c 7d27 2c0a 2020 2020 2020  5678",}',.      
-00046060: 2020 2020 2020 2020 2020 6175 746f 7370            autosp
-00046070: 6563 3d54 7275 652c 0a20 2020 2020 2020  ec=True,.       
-00046080: 2020 2020 2029 2061 7320 5f6d 6f63 6b3a       ) as _mock:
-00046090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000460a0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-000460b0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-000460c0: 6c6f 6164 416e 6449 6e73 6572 7428 226b  loadAndInsert("k
-000460d0: 6579 3022 2c20 6d65 7468 6f64 3d22 6172  ey0", method="ar
-000460e0: 7869 7622 2929 0a20 2020 2020 2020 2020  xiv")).         
-000460f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00046100: 7274 4571 7561 6c28 5f6d 6f63 6b5f 7569  rtEqual(_mock_ui
-00046110: 6964 2e63 616c 6c5f 636f 756e 742c 2030  id.call_count, 0
-00046120: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00046130: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00046140: 616c 285f 6d6f 636b 5f75 696f 2e63 616c  al(_mock_uio.cal
-00046150: 6c5f 636f 756e 742c 2030 290a 0a20 2020  l_count, 0)..   
-00046160: 2020 2020 2023 206c 6f61 6441 6e64 496e       # loadAndIn
-00046170: 7365 7274 5769 7468 4361 7473 0a20 2020  sertWithCats.   
-00046180: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00046190: 6962 732e 6c61 7374 496e 7365 7274 6564  ibs.lastInserted
-000461a0: 203d 205b 2261 6263 225d 0a20 2020 2020   = ["abc"].     
-000461b0: 2020 2077 6974 6820 7061 7463 6828 2262     with patch("b
-000461c0: 7569 6c74 696e 732e 696e 7075 7422 2c20  uiltins.input", 
-000461d0: 7265 7475 726e 5f76 616c 7565 3d22 5b31  return_value="[1
-000461e0: 2c32 5d22 2920 6173 205f 696e 7075 742c  ,2]") as _input,
-000461f0: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-00046200: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-00046210: 6461 7461 6261 7365 2e45 6e74 7269 6573  database.Entries
-00046220: 2e6c 6f61 6441 6e64 496e 7365 7274 222c  .loadAndInsert",
-00046230: 2061 7574 6f73 7065 633d 5472 7565 0a20   autospec=True. 
-00046240: 2020 2020 2020 2029 2061 7320 5f6d 6f63         ) as _moc
-00046250: 6b3a 0a20 2020 2020 2020 2020 2020 2073  k:.            s
-00046260: 656c 662e 7042 4442 2e62 6962 732e 6c6f  elf.pBDB.bibs.lo
-00046270: 6164 416e 6449 6e73 6572 7457 6974 6843  adAndInsertWithC
-00046280: 6174 7328 5b22 6163 6222 5d2c 2022 646f  ats(["acb"], "do
-00046290: 6922 2c20 5472 7565 2c20 312c 2054 7275  i", True, 1, Tru
-000462a0: 652c 2022 7965 7322 290a 2020 2020 2020  e, "yes").      
-000462b0: 2020 2020 2020 5f69 6e70 7574 2e61 7373        _input.ass
-000462c0: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-000462d0: 7769 7468 2822 6361 7465 676f 7269 6573  with("categories
-000462e0: 2066 6f72 2027 6162 6327 3a20 2229 0a20   for 'abc': "). 
-000462f0: 2020 2020 2020 2020 2020 205f 6d6f 636b             _mock
-00046300: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-00046310: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
-00046320: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00046330: 4244 422e 6269 6273 2c0a 2020 2020 2020  BDB.bibs,.      
-00046340: 2020 2020 2020 2020 2020 5b22 6163 6222            ["acb"
-00046350: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00046360: 2020 2063 6869 6c64 5072 6f63 6573 733d     childProcess=
-00046370: 2279 6573 222c 0a20 2020 2020 2020 2020  "yes",.         
-00046380: 2020 2020 2020 2069 6d70 6f73 654b 6579         imposeKey
-00046390: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
-000463a0: 2020 2020 2020 206d 6574 686f 643d 2264         method="d
-000463b0: 6f69 222c 0a20 2020 2020 2020 2020 2020  oi",.           
-000463c0: 2020 2020 206e 756d 6265 723d 312c 0a20       number=1,. 
-000463d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000463e0: 6574 7572 6e42 6962 7465 783d 5472 7565  eturnBibtex=True
-000463f0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00046400: 0a20 2020 2064 6566 2074 6573 745f 7061  .    def test_pa
-00046410: 7273 6541 6c6c 4269 6274 6578 7328 7365  rseAllBibtexs(se
-00046420: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
-00046430: 2020 2020 2222 2274 6573 7420 7061 7273      """test pars
-00046440: 6541 6c6c 4269 6274 6578 7322 2222 0a20  eAllBibtexs""". 
-00046450: 2020 2020 2020 2074 6578 7420 3d20 5b0a         text = [.
-00046460: 2020 2020 2020 2020 2020 2020 2240 6172              "@ar
-00046470: 7469 636c 657b 6162 632c 5c6e 222c 0a20  ticle{abc,\n",. 
-00046480: 2020 2020 2020 2020 2020 2027 6175 7468             'auth
-00046490: 6f72 203d 2022 6d65 222c 5c6e 272c 0a20  or = "me",\n',. 
-000464a0: 2020 2020 2020 2020 2020 2027 7469 746c             'titl
-000464b0: 6520 3d20 2222 2c7d 272c 0a20 2020 2020  e = "",}',.     
-000464c0: 2020 2020 2020 2027 2522 6162 6322 2c27         '%"abc",'
-000464d0: 2c0a 2020 2020 2020 2020 2020 2020 227d  ,.            "}
-000464e0: 5c6e 222c 0a20 2020 2020 2020 2020 2020  \n",.           
-000464f0: 2022 5c6e 222c 0a20 2020 2020 2020 2020   "\n",.         
-00046500: 2020 2022 4061 7274 6963 6c65 7b64 6566     "@article{def
-00046510: 2c5c 6e22 2c0a 2020 2020 2020 2020 2020  ,\n",.          
-00046520: 2020 2761 7574 686f 7220 3d20 226d 6522    'author = "me"
-00046530: 2c5c 6e27 2c0a 2020 2020 2020 2020 2020  ,\n',.          
-00046540: 2020 2774 6974 6c65 203d 2022 6465 6640    'title = "def@
-00046550: 6768 6922 2c7d 272c 0a20 2020 2020 2020  ghi",}',.       
-00046560: 205d 0a20 2020 2020 2020 2065 7272 6f72   ].        error
-00046570: 7320 3d20 5b5d 0a20 2020 2020 2020 2077  s = [].        w
-00046580: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
-00046590: 6e67 2e4c 6f67 6765 722e 6465 6275 6722  ng.Logger.debug"
-000465a0: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
-000465b0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000465c0: 6962 732e 7061 7273 6541 6c6c 4269 6274  ibs.parseAllBibt
-000465d0: 6578 7328 7465 7874 2c20 6572 726f 7273  exs(text, errors
-000465e0: 3d65 7272 6f72 732c 2076 6572 626f 7365  =errors, verbose
-000465f0: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
-00046600: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-00046610: 7565 285f 692e 6361 6c6c 5f63 6f75 6e74  ue(_i.call_count
-00046620: 203e 3d20 3429 0a20 2020 2020 2020 2020   >= 4).         
-00046630: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00046640: 7561 6c28 6c65 6e28 6572 726f 7273 292c  ual(len(errors),
-00046650: 2030 290a 2020 2020 2020 2020 2020 2020   0).            
-00046660: 5f69 2e72 6573 6574 5f6d 6f63 6b28 290a  _i.reset_mock().
-00046670: 2020 2020 2020 2020 2020 2020 7265 7320              res 
-00046680: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
-00046690: 2e70 6172 7365 416c 6c42 6962 7465 7873  .parseAllBibtexs
-000466a0: 2874 6578 742c 2065 7272 6f72 733d 6572  (text, errors=er
-000466b0: 726f 7273 2c20 7665 7262 6f73 653d 4661  rors, verbose=Fa
-000466c0: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-000466d0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-000466e0: 285f 692e 6361 6c6c 5f63 6f75 6e74 203e  (_i.call_count >
-000466f0: 3d20 3229 0a20 2020 2020 2020 2020 2020  = 2).           
-00046700: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00046710: 6c28 5b61 5b22 4944 225d 2066 6f72 2061  l([a["ID"] for a
-00046720: 2069 6e20 7265 735d 2c20 5b22 6162 6322   in res], ["abc"
-00046730: 2c20 2264 6566 225d 290a 2020 2020 2020  , "def"]).      
-00046740: 2020 7465 7874 203d 205b 0a20 2020 2020    text = [.     
-00046750: 2020 2020 2020 2022 4061 7274 6963 6c65         "@article
-00046760: 7b61 6263 2c5c 6e22 2c0a 2020 2020 2020  {abc,\n",.      
-00046770: 2020 2020 2020 2761 7574 686f 7220 3d20        'author = 
-00046780: 226d 6522 2c5c 6e27 2c0a 2020 2020 2020  "me",\n',.      
-00046790: 2020 2020 2020 2725 7469 746c 6520 3d20        '%title = 
-000467a0: 2222 2c7d 272c 0a20 2020 2020 2020 2020  "",}',.         
-000467b0: 2020 2027 2522 6162 6322 2c27 2c0a 2020     '%"abc",',.  
-000467c0: 2020 2020 2020 2020 2020 225c 6e22 2c0a            "\n",.
-000467d0: 2020 2020 2020 2020 2020 2020 2240 6172              "@ar
-000467e0: 7469 636c 657b 6465 662c 5c6e 222c 0a20  ticle{def,\n",. 
-000467f0: 2020 2020 2020 2020 2020 2027 6175 7468             'auth
-00046800: 6f72 203d 2022 6d65 222c 5c6e 272c 0a20  or = "me",\n',. 
-00046810: 2020 2020 2020 2020 2020 2027 7469 746c             'titl
-00046820: 6520 3d20 2264 6566 4067 6869 222c 7d27  e = "def@ghi",}'
-00046830: 2c0a 2020 2020 2020 2020 5d0a 2020 2020  ,.        ].    
-00046840: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
-00046850: 6c6f 6767 696e 672e 4c6f 6767 6572 2e65  logging.Logger.e
-00046860: 7863 6570 7469 6f6e 2229 2061 7320 5f65  xception") as _e
-00046870: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-00046880: 2020 2020 2022 6c6f 6767 696e 672e 4c6f       "logging.Lo
-00046890: 6767 6572 2e64 6562 7567 220a 2020 2020  gger.debug".    
-000468a0: 2020 2020 2920 6173 205f 693a 0a20 2020      ) as _i:.   
-000468b0: 2020 2020 2020 2020 2072 6573 203d 2073           res = s
-000468c0: 656c 662e 7042 4442 2e62 6962 732e 7061  elf.pBDB.bibs.pa
-000468d0: 7273 6541 6c6c 4269 6274 6578 7328 7465  rseAllBibtexs(te
-000468e0: 7874 2c20 6572 726f 7273 3d65 7272 6f72  xt, errors=error
-000468f0: 732c 2076 6572 626f 7365 3d46 616c 7365  s, verbose=False
-00046900: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00046910: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
-00046920: 615b 2249 4422 5d20 666f 7220 6120 696e  a["ID"] for a in
-00046930: 2072 6573 5d2c 205b 2264 6566 225d 290a   res], ["def"]).
-00046940: 0a20 2020 2064 6566 2074 6573 745f 7072  .    def test_pr
-00046950: 6570 6172 6549 6e73 6572 7428 7365 6c66  epareInsert(self
-00046960: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
-00046970: 2020 2222 2274 6573 7420 7072 6570 6172    """test prepar
-00046980: 6549 6e73 6572 7422 2222 0a20 2020 2020  eInsert""".     
-00046990: 2020 2023 206d 756c 7469 706c 6520 656e     # multiple en
-000469a0: 7472 6965 7320 696e 2062 6962 7465 783a  tries in bibtex:
-000469b0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000469c0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-000469d0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-000469e0: 2e62 6962 732e 7072 6570 6172 6549 6e73  .bibs.prepareIns
-000469f0: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
-00046a00: 2020 2020 2027 4061 7274 6963 6c65 7b61       '@article{a
-00046a10: 6263 2c5c 6e61 7574 686f 7220 3d20 226d  bc,\nauthor = "m
-00046a20: 6522 2c5c 6e27 0a20 2020 2020 2020 2020  e",\n'.         
-00046a30: 2020 2020 2020 202b 2027 7469 746c 6520         + 'title 
-00046a40: 3d20 226d 7974 6974 222c 7d5c 6e40 6172  = "mytit",}\n@ar
-00046a50: 7469 636c 657b 6465 662c 5c6e 6175 7468  ticle{def,\nauth
-00046a60: 6f72 203d 2022 796f 7522 2c27 0a20 2020  or = "you",'.   
-00046a70: 2020 2020 2020 2020 2020 2020 202b 2027               + '
-00046a80: 5c6e 7469 746c 6520 3d20 226f 7468 6572  \ntitle = "other
-00046a90: 222c 7d27 0a20 2020 2020 2020 2020 2020  ",}'.           
-00046aa0: 2029 5b22 6269 626b 6579 225d 2c0a 2020   )["bibkey"],.  
-00046ab0: 2020 2020 2020 2020 2020 2261 6263 222c            "abc",
-00046ac0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00046ad0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00046ae0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-00046af0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00046b00: 7072 6570 6172 6549 6e73 6572 7428 0a20  prepareInsert(. 
-00046b10: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00046b20: 4061 7274 6963 6c65 7b61 6263 2c5c 6e61  @article{abc,\na
-00046b30: 7574 686f 7220 3d20 226d 6522 2c5c 6e27  uthor = "me",\n'
-00046b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046b50: 202b 2027 7469 746c 6520 3d20 226d 7974   + 'title = "myt
-00046b60: 6974 222c 7d5c 6e40 6172 7469 636c 657b  it",}\n@article{
-00046b70: 6465 662c 5c6e 6175 7468 6f72 203d 2022  def,\nauthor = "
-00046b80: 796f 7522 2c5c 6e27 0a20 2020 2020 2020  you",\n'.       
-00046b90: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
-00046ba0: 6520 3d20 226f 7468 6572 222c 7d27 2c0a  e = "other",}',.
-00046bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046bc0: 6e75 6d62 6572 3d31 2c0a 2020 2020 2020  number=1,.      
-00046bd0: 2020 2020 2020 295b 2262 6962 6b65 7922        )["bibkey"
-00046be0: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-00046bf0: 6465 6622 2c0a 2020 2020 2020 2020 290a  def",.        ).
-00046c00: 0a20 2020 2020 2020 2023 2064 6966 6665  .        # diffe
-00046c10: 7265 6e74 2066 6965 6c64 730a 2020 2020  rent fields.    
-00046c20: 2020 2020 6269 6274 6578 203d 2028 0a20      bibtex = (. 
-00046c30: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-00046c40: 6963 6c65 7b61 6263 2c5c 6e61 7574 686f  icle{abc,\nautho
-00046c50: 7220 3d20 226d 6522 2c5c 6e27 0a20 2020  r = "me",\n'.   
-00046c60: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
-00046c70: 6520 3d20 226d 7974 6974 222c 5c6e 6172  e = "mytit",\nar
-00046c80: 7869 763d 2231 3830 312e 3030 3030 3022  xiv="1801.00000"
-00046c90: 2c5c 6e7d 270a 2020 2020 2020 2020 290a  ,\n}'.        ).
-00046ca0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00046cb0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00046cc0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00046cd0: 6269 6273 2e70 7265 7061 7265 496e 7365  bibs.prepareInse
-00046ce0: 7274 2862 6962 7465 782c 2062 6962 6b65  rt(bibtex, bibke
-00046cf0: 793d 2264 6566 2229 5b22 6269 626b 6579  y="def")["bibkey
-00046d00: 225d 2c20 2264 6566 220a 2020 2020 2020  "], "def".      
-00046d10: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00046d20: 2e61 7373 6572 7449 6e28 0a20 2020 2020  .assertIn(.     
-00046d30: 2020 2020 2020 2022 7274 6963 6c65 7b64         "rticle{d
-00046d40: 6566 2c22 2c20 7365 6c66 2e70 4244 422e  ef,", self.pBDB.
-00046d50: 6269 6273 2e70 7265 7061 7265 496e 7365  bibs.prepareInse
-00046d60: 7274 2862 6962 7465 782c 2062 6962 6b65  rt(bibtex, bibke
-00046d70: 793d 2264 6566 2229 5b22 6269 6274 6578  y="def")["bibtex
-00046d80: 225d 0a20 2020 2020 2020 2029 0a0a 2020  "].        )..  
-00046d90: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
-00046da0: 662e 7042 4442 2e62 6962 732e 7072 6570  f.pBDB.bibs.prep
-00046db0: 6172 6549 6e73 6572 7428 6269 6274 6578  areInsert(bibtex
-00046dc0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00046dd0: 7373 6572 7445 7175 616c 2864 6174 615b  ssertEqual(data[
-00046de0: 2262 6962 6b65 7922 5d2c 2022 6162 6322  "bibkey"], "abc"
-00046df0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00046e00: 7373 6572 7445 7175 616c 2864 6174 615b  ssertEqual(data[
-00046e10: 2261 7278 6976 225d 2c20 2231 3830 312e  "arxiv"], "1801.
-00046e20: 3030 3030 3022 290a 2020 2020 2020 2020  00000").        
-00046e30: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00046e40: 280a 2020 2020 2020 2020 2020 2020 6173  (.            as
-00046e50: 742e 6c69 7465 7261 6c5f 6576 616c 2864  t.literal_eval(d
-00046e60: 6174 615b 2262 6962 6469 6374 225d 292c  ata["bibdict"]),
-00046e70: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
-00046e80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00046e90: 454e 5452 5954 5950 4522 3a20 2261 7274  ENTRYTYPE": "art
-00046ea0: 6963 6c65 222c 0a20 2020 2020 2020 2020  icle",.         
-00046eb0: 2020 2020 2020 2022 4944 223a 2022 6162         "ID": "ab
-00046ec0: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
-00046ed0: 2020 2020 2261 7278 6976 223a 2022 3138      "arxiv": "18
-00046ee0: 3031 2e30 3030 3030 222c 0a20 2020 2020  01.00000",.     
-00046ef0: 2020 2020 2020 2020 2020 2022 6175 7468             "auth
-00046f00: 6f72 223a 2022 6d65 222c 0a20 2020 2020  or": "me",.     
-00046f10: 2020 2020 2020 2020 2020 2022 7469 746c             "titl
-00046f20: 6522 3a20 227b 6d79 7469 747d 222c 0a20  e": "{mytit}",. 
-00046f30: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-00046f40: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00046f50: 2023 2074 6573 7420 7369 6d70 6c65 2066   # test simple f
-00046f60: 6965 6c64 730a 2020 2020 2020 2020 6269  ields.        bi
-00046f70: 6274 6578 203d 2027 4061 7274 6963 6c65  btex = '@article
-00046f80: 7b61 6263 2c5c 6e61 7574 686f 7220 3d20  {abc,\nauthor = 
-00046f90: 226d 6522 2c5c 6e74 6974 6c65 203d 2022  "me",\ntitle = "
-00046fa0: 6d79 7469 7422 2c5c 6e7d 270a 2020 2020  mytit",\n}'.    
-00046fb0: 2020 2020 666f 7220 6b20 696e 2028 2269      for k in ("i
-00046fc0: 6e73 7069 7265 222c 2022 6164 7322 2c20  nspire", "ads", 
-00046fd0: 2273 6368 6f6c 6172 222c 2022 636f 6d6d  "scholar", "comm
-00046fe0: 656e 7473 222c 2022 6f6c 645f 6b65 7973  ents", "old_keys
-00046ff0: 222c 2022 6162 7374 7261 6374 2229 3a0a  ", "abstract"):.
-00047000: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00047010: 2e61 7373 6572 7445 7175 616c 2864 6174  .assertEqual(dat
-00047020: 615b 6b5d 2c20 4e6f 6e65 290a 2020 2020  a[k], None).    
-00047030: 2020 2020 2020 2020 746d 7020 3d20 7b7d          tmp = {}
-00047040: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
-00047050: 5b6b 5d20 3d20 2274 7279 220a 2020 2020  [k] = "try".    
-00047060: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00047070: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-00047080: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
-00047090: 6e73 6572 7428 6269 6274 6578 2c20 2a2a  nsert(bibtex, **
-000470a0: 746d 7029 5b6b 5d2c 2022 7472 7922 290a  tmp)[k], "try").
-000470b0: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
-000470c0: 2028 2270 7562 6461 7465 222c 2022 6d61   ("pubdate", "ma
-000470d0: 726b 7322 293a 0a20 2020 2020 2020 2020  rks"):.         
-000470e0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000470f0: 7561 6c28 6461 7461 5b6b 5d2c 2022 2229  ual(data[k], "")
-00047100: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
-00047110: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-00047120: 2020 746d 705b 6b5d 203d 2022 7472 7922    tmp[k] = "try"
-00047130: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00047140: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-00047150: 6c66 2e70 4244 422e 6269 6273 2e70 7265  lf.pBDB.bibs.pre
-00047160: 7061 7265 496e 7365 7274 2862 6962 7465  pareInsert(bibte
-00047170: 782c 202a 2a74 6d70 295b 6b5d 2c20 2274  x, **tmp)[k], "t
-00047180: 7279 2229 0a20 2020 2020 2020 2066 6f72  ry").        for
-00047190: 206b 2069 6e20 280a 2020 2020 2020 2020   k in (.        
-000471a0: 2020 2020 2265 7870 5f70 6170 6572 222c      "exp_paper",
-000471b0: 0a20 2020 2020 2020 2020 2020 2022 6c65  .            "le
-000471c0: 6374 7572 6522 2c0a 2020 2020 2020 2020  cture",.        
-000471d0: 2020 2020 2270 6864 5f74 6865 7369 7322      "phd_thesis"
-000471e0: 2c0a 2020 2020 2020 2020 2020 2020 2272  ,.            "r
-000471f0: 6576 6965 7722 2c0a 2020 2020 2020 2020  eview",.        
-00047200: 2020 2020 2270 726f 6365 6564 696e 6722      "proceeding"
-00047210: 2c0a 2020 2020 2020 2020 2020 2020 2262  ,.            "b
-00047220: 6f6f 6b22 2c0a 2020 2020 2020 2020 2020  ook",.          
-00047230: 2020 226e 6f55 7064 6174 6522 2c0a 2020    "noUpdate",.  
-00047240: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00047250: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00047260: 4571 7561 6c28 6461 7461 5b6b 5d2c 2030  Equal(data[k], 0
-00047270: 290a 2020 2020 2020 2020 2020 2020 746d  ).            tm
-00047280: 7020 3d20 7b7d 0a20 2020 2020 2020 2020  p = {}.         
-00047290: 2020 2074 6d70 5b6b 5d20 3d20 310a 2020     tmp[k] = 1.  
-000472a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000472b0: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-000472c0: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
-000472d0: 6549 6e73 6572 7428 6269 6274 6578 2c20  eInsert(bibtex, 
-000472e0: 2a2a 746d 7029 5b6b 5d2c 2031 290a 0a20  **tmp)[k], 1).. 
-000472f0: 2020 2020 2020 2023 2074 6573 7420 6172         # test ar
-00047300: 7869 760a 2020 2020 2020 2020 7365 6c66  xiv.        self
-00047310: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00047320: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00047330: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
-00047340: 496e 7365 7274 2862 6962 7465 782c 2061  Insert(bibtex, a
-00047350: 7278 6976 3d22 3138 3031 2e30 3030 3030  rxiv="1801.00000
-00047360: 2229 5b22 6172 7869 7622 5d2c 0a20 2020  ")["arxiv"],.   
-00047370: 2020 2020 2020 2020 2022 3138 3031 2e30           "1801.0
-00047380: 3030 3030 222c 0a20 2020 2020 2020 2029  0000",.        )
-00047390: 0a20 2020 2020 2020 2062 6962 7465 7841  .        bibtexA
-000473a0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-000473b0: 2027 4061 7274 6963 6c65 7b61 6263 2c5c   '@article{abc,\
-000473c0: 6e61 7574 686f 7220 3d20 226d 6522 2c5c  nauthor = "me",\
-000473d0: 6e27 0a20 2020 2020 2020 2020 2020 202b  n'.            +
-000473e0: 2027 7469 746c 6520 3d20 226d 7974 6974   'title = "mytit
-000473f0: 222c 5c6e 6570 7269 6e74 3d22 3138 3031  ",\neprint="1801
-00047400: 2e30 3030 3030 222c 5c6e 7d27 0a20 2020  .00000",\n}'.   
-00047410: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00047420: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00047430: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
-00047440: 7265 7061 7265 496e 7365 7274 2862 6962  repareInsert(bib
-00047450: 7465 7841 295b 2261 7278 6976 225d 2c20  texA)["arxiv"], 
-00047460: 2231 3830 312e 3030 3030 3022 290a 2020  "1801.00000").  
-00047470: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00047480: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
-00047490: 2e62 6962 732e 7072 6570 6172 6549 6e73  .bibs.prepareIns
-000474a0: 6572 7428 6269 6274 6578 295b 2261 7278  ert(bibtex)["arx
-000474b0: 6976 225d 2c20 2222 290a 0a20 2020 2020  iv"], "")..     
-000474c0: 2020 2023 206d 6f72 6520 7465 7374 730a     # more tests.
-000474d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000474e0: 6572 7445 7175 616c 2864 6174 615b 2264  ertEqual(data["d
-000474f0: 6f69 225d 2c20 4e6f 6e65 290a 2020 2020  oi"], None).    
-00047500: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00047510: 7175 616c 2864 6174 615b 2263 726f 7373  qual(data["cross
-00047520: 7265 6622 5d2c 204e 6f6e 6529 0a20 2020  ref"], None).   
-00047530: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00047540: 4571 7561 6c28 6461 7461 5b22 6162 7374  Equal(data["abst
-00047550: 7261 6374 225d 2c20 4e6f 6e65 290a 2020  ract"], None).  
-00047560: 2020 2020 2020 666f 7220 6b20 696e 2028        for k in (
-00047570: 2264 6f69 222c 2022 6973 626e 222c 2022  "doi", "isbn", "
-00047580: 6372 6f73 7372 6566 222c 2022 6162 7374  crossref", "abst
-00047590: 7261 6374 2229 3a0a 2020 2020 2020 2020  ract"):.        
-000475a0: 2020 2020 6269 6274 6578 4120 3d20 280a      bibtexA = (.
-000475b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000475c0: 2740 6172 7469 636c 657b 6162 632c 5c6e  '@article{abc,\n
-000475d0: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
-000475e0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-000475f0: 2020 2b20 2774 6974 6c65 203d 2022 6d79    + 'title = "my
-00047600: 7469 7422 2c5c 6e25 733d 2273 6f6d 6574  tit",\n%s="somet
-00047610: 6869 6e67 222c 5c6e 7d27 2025 206b 0a20  hing",\n}' % k. 
-00047620: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00047630: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00047640: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
-00047650: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
-00047660: 496e 7365 7274 2862 6962 7465 7841 295b  Insert(bibtexA)[
-00047670: 6b5d 2c20 2273 6f6d 6574 6869 6e67 2229  k], "something")
-00047680: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
-00047690: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-000476a0: 2020 746d 705b 6b5d 203d 2022 736f 6d65    tmp[k] = "some
-000476b0: 7468 696e 6722 0a20 2020 2020 2020 2020  thing".         
-000476c0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000476d0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-000476e0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000476f0: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
-00047700: 7428 6269 6274 6578 2c20 2a2a 746d 7029  t(bibtex, **tmp)
-00047710: 5b6b 5d2c 2022 736f 6d65 7468 696e 6722  [k], "something"
-00047720: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00047730: 2020 2020 2020 2020 2320 7465 7374 2079          # test y
-00047740: 6561 720a 2020 2020 2020 2020 7365 6c66  ear.        self
-00047750: 2e61 7373 6572 7445 7175 616c 2864 6174  .assertEqual(dat
-00047760: 615b 2279 6561 7222 5d2c 2022 3230 3138  a["year"], "2018
-00047770: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00047780: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00047790: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-000477a0: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
-000477b0: 6e73 6572 7428 6269 6274 6578 2c20 7965  nsert(bibtex, ye
-000477c0: 6172 3d22 3139 3939 2229 5b22 7965 6172  ar="1999")["year
-000477d0: 225d 2c20 2231 3939 3922 0a20 2020 2020  "], "1999".     
-000477e0: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-000477f0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00047800: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00047810: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
-00047820: 6549 6e73 6572 7428 6269 6274 6578 2c20  eInsert(bibtex, 
-00047830: 6172 7869 763d 2268 6570 2d70 682f 3939  arxiv="hep-ph/99
-00047840: 3031 3030 3022 295b 2279 6561 7222 5d2c  01000")["year"],
-00047850: 2022 3139 3939 220a 2020 2020 2020 2020   "1999".        
-00047860: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00047870: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00047880: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00047890: 422e 6269 6273 2e70 7265 7061 7265 496e  B.bibs.prepareIn
-000478a0: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
-000478b0: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
-000478c0: 6162 632c 5c6e 6175 7468 6f72 203d 2022  abc,\nauthor = "
-000478d0: 6d65 222c 5c6e 2720 2b20 2774 6974 6c65  me",\n' + 'title
-000478e0: 203d 2022 6d79 7469 7422 2c5c 6e79 6561   = "mytit",\nyea
-000478f0: 723d 2232 3030 3522 2c5c 6e7d 270a 2020  r="2005",\n}'.  
-00047900: 2020 2020 2020 2020 2020 295b 2279 6561            )["yea
-00047910: 7222 5d2c 0a20 2020 2020 2020 2020 2020  r"],.           
-00047920: 2022 3230 3035 222c 0a20 2020 2020 2020   "2005",.       
-00047930: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-00047940: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-00047950: 2e70 4244 422e 6269 6273 2e70 7265 7061  .pBDB.bibs.prepa
-00047960: 7265 496e 7365 7274 2862 6962 7465 7829  reInsert(bibtex)
-00047970: 5b22 7965 6172 225d 2c20 4e6f 6e65 290a  ["year"], None).
-00047980: 0a20 2020 2020 2020 2023 2074 6573 7420  .        # test 
-00047990: 6c69 6e6b 0a20 2020 2020 2020 2073 656c  link.        sel
-000479a0: 662e 6173 7365 7274 4571 7561 6c28 6461  f.assertEqual(da
-000479b0: 7461 5b22 6c69 6e6b 225d 2c20 7062 436f  ta["link"], pbCo
-000479c0: 6e66 6967 2e61 7278 6976 5572 6c20 2b20  nfig.arxivUrl + 
-000479d0: 222f 6162 732f 3138 3031 2e30 3030 3030  "/abs/1801.00000
-000479e0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-000479f0: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-00047a00: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00047a10: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
-00047a20: 6e73 6572 7428 6269 6274 6578 2c20 6c69  nsert(bibtex, li
-00047a30: 6e6b 3d22 6874 7470 3a2f 2f73 6f6d 652e  nk="http://some.
-00047a40: 7468 696e 6722 295b 226c 696e 6b22 5d2c  thing")["link"],
-00047a50: 0a20 2020 2020 2020 2020 2020 2022 6874  .            "ht
-00047a60: 7470 3a2f 2f73 6f6d 652e 7468 696e 6722  tp://some.thing"
-00047a70: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00047a80: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00047a90: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00047aa0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00047ab0: 2e70 7265 7061 7265 496e 7365 7274 2862  .prepareInsert(b
-00047ac0: 6962 7465 782c 2064 6f69 3d22 736f 6d65  ibtex, doi="some
-00047ad0: 646f 6922 295b 226c 696e 6b22 5d2c 0a20  doi")["link"],. 
-00047ae0: 2020 2020 2020 2020 2020 2070 6243 6f6e             pbCon
-00047af0: 6669 672e 646f 6955 726c 202b 2022 736f  fig.doiUrl + "so
-00047b00: 6d65 646f 6922 2c0a 2020 2020 2020 2020  medoi",.        
-00047b10: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00047b20: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-00047b30: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
-00047b40: 6549 6e73 6572 7428 6269 6274 6578 295b  eInsert(bibtex)[
-00047b50: 226c 696e 6b22 5d2c 2022 2229 0a0a 2020  "link"], "")..  
-00047b60: 2020 2020 2020 2320 7465 7374 2066 6972        # test fir
-00047b70: 7374 6461 7465 0a20 2020 2020 2020 2073  stdate.        s
-00047b80: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00047b90: 6461 7461 5b22 6669 7273 7464 6174 6522  data["firstdate"
-00047ba0: 5d2c 2064 6174 6574 696d 652e 6461 7465  ], datetime.date
-00047bb0: 2e74 6f64 6179 2829 2e73 7472 6674 696d  .today().strftim
-00047bc0: 6528 2225 592d 256d 2d25 6422 2929 0a20  e("%Y-%m-%d")). 
-00047bd0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00047be0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00047bf0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00047c00: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
-00047c10: 7428 6269 6274 6578 2c20 6669 7273 7464  t(bibtex, firstd
-00047c20: 6174 653d 2232 3031 382d 3031 2d30 3122  ate="2018-01-01"
-00047c30: 295b 2266 6972 7374 6461 7465 225d 2c0a  )["firstdate"],.
-00047c40: 2020 2020 2020 2020 2020 2020 2232 3031              "201
-00047c50: 382d 3031 2d30 3122 2c0a 2020 2020 2020  8-01-01",.      
-00047c60: 2020 290a 0a20 2020 2020 2020 2023 2074    )..        # t
-00047c70: 6573 7420 6162 7374 7261 6374 0a20 2020  est abstract.   
-00047c80: 2020 2020 2062 6962 7465 7820 3d20 280a       bibtex = (.
-00047c90: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
-00047ca0: 7469 636c 657b 6162 632c 5c6e 6175 7468  ticle{abc,\nauth
-00047cb0: 6f72 203d 2022 6d65 222c 5c6e 2720 2b20  or = "me",\n' + 
-00047cc0: 2774 6974 6c65 203d 2022 6d79 7469 7422  'title = "mytit"
-00047cd0: 2c5c 6e61 6273 7472 6163 743d 2274 7279  ,\nabstract="try
-00047ce0: 222c 5c6e 7d27 0a20 2020 2020 2020 2029  ",\n}'.        )
-00047cf0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00047d00: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
-00047d10: 7265 7061 7265 496e 7365 7274 2862 6962  repareInsert(bib
-00047d20: 7465 7829 0a20 2020 2020 2020 2073 656c  tex).        sel
-00047d30: 662e 6173 7365 7274 4571 7561 6c28 6461  f.assertEqual(da
-00047d40: 7461 5b22 6162 7374 7261 6374 225d 2c20  ta["abstract"], 
-00047d50: 2274 7279 2229 0a20 2020 2020 2020 2073  "try").        s
-00047d60: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00047d70: 0a20 2020 2020 2020 2020 2020 2061 7374  .            ast
-00047d80: 2e6c 6974 6572 616c 5f65 7661 6c28 6461  .literal_eval(da
-00047d90: 7461 5b22 6269 6264 6963 7422 5d29 2c0a  ta["bibdict"]),.
-00047da0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-00047db0: 2020 2020 2020 2020 2020 2020 2020 2245                "E
-00047dc0: 4e54 5259 5459 5045 223a 2022 6172 7469  NTRYTYPE": "arti
-00047dd0: 636c 6522 2c0a 2020 2020 2020 2020 2020  cle",.          
-00047de0: 2020 2020 2020 2249 4422 3a20 2261 6263        "ID": "abc
-00047df0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00047e00: 2020 2022 6162 7374 7261 6374 223a 2022     "abstract": "
-00047e10: 7b74 7279 7d22 2c0a 2020 2020 2020 2020  {try}",.        
-00047e20: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
-00047e30: 3a20 226d 6522 2c0a 2020 2020 2020 2020  : "me",.        
-00047e40: 2020 2020 2020 2020 2274 6974 6c65 223a          "title":
-00047e50: 2022 7b6d 7974 6974 7d22 2c0a 2020 2020   "{mytit}",.    
-00047e60: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-00047e70: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00047e80: 656d 7074 7920 6269 6274 6578 0a20 2020  empty bibtex.   
-00047e90: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00047ea0: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-00047eb0: 6269 6273 2e70 7265 7061 7265 496e 7365  bibs.prepareInse
-00047ec0: 7274 2822 2229 2c20 7b22 6269 626b 6579  rt(""), {"bibkey
-00047ed0: 223a 2022 227d 290a 2020 2020 2020 2020  ": ""}).        
-00047ee0: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
-00047ef0: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
-00047f00: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
-00047f10: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00047f20: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
-00047f30: 7428 2222 290a 2020 2020 2020 2020 2020  t("").          
-00047f40: 2020 5f69 2e61 7373 6572 745f 616e 795f    _i.assert_any_
-00047f50: 6361 6c6c 2822 4e6f 2065 6c65 6d65 6e74  call("No element
-00047f60: 7320 666f 756e 643f 2229 0a20 2020 2020  s found?").     
-00047f70: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00047f80: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
-00047f90: 6273 2e70 7265 7061 7265 496e 7365 7274  bs.prepareInsert
-00047fa0: 2822 4061 7274 6963 6c65 7b61 6263 2c22  ("@article{abc,"
-00047fb0: 292c 207b 2262 6962 6b65 7922 3a20 2222  ), {"bibkey": ""
-00047fc0: 7d29 0a0a 2020 2020 6465 6620 7465 7374  })..    def test
-00047fd0: 5f70 7265 7061 7265 5570 6461 7465 2873  _prepareUpdate(s
-00047fe0: 656c 662c 202a 6172 6773 293a 0a20 2020  elf, *args):.   
-00047ff0: 2020 2020 2022 2222 7465 7374 2070 7265       """test pre
-00048000: 7061 7265 5570 6461 7465 2061 6e64 2072  pareUpdate and r
-00048010: 656c 6174 6564 2066 756e 6374 696f 6e73  elated functions
-00048020: 2222 220a 2020 2020 2020 2020 6269 6274  """.        bibt
-00048030: 6578 4120 3d20 2740 6172 7469 636c 657b  exA = '@article{
-00048040: 6162 632c 5c6e 6175 7468 6f72 3d22 6d65  abc,\nauthor="me
-00048050: 222c 5c6e 7469 746c 653d 2261 6263 222c  ",\ntitle="abc",
-00048060: 5c6e 7d27 0a20 2020 2020 2020 2062 6962  \n}'.        bib
-00048070: 7465 7842 203d 2027 4061 7274 6963 6c65  texB = '@article
-00048080: 7b61 6263 312c 5c6e 6175 7468 6f72 3d22  {abc1,\nauthor="
-00048090: 6d65 222c 5c6e 7469 746c 653d 2241 4243  me",\ntitle="ABC
-000480a0: 222c 2720 2b20 275c 6e61 7278 6976 3d22  ",' + '\narxiv="
-000480b0: 3132 3334 222c 5c6e 7d27 0a20 2020 2020  1234",\n}'.     
-000480c0: 2020 2062 6962 7465 7845 203d 2022 4061     bibtexE = "@a
-000480d0: 7274 6963 6c65 7b2c 7d22 0a20 2020 2020  rticle{,}".     
-000480e0: 2020 2072 6573 756c 7441 203d 2028 0a20     resultA = (. 
-000480f0: 2020 2020 2020 2020 2020 2027 4041 7274             '@Art
-00048100: 6963 6c65 7b61 6263 2c5c 6e20 2020 2020  icle{abc,\n     
-00048110: 2020 2061 7574 686f 7220 3d20 226d 6522     author = "me"
-00048120: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
-00048130: 202b 2027 2020 2020 2020 2020 2074 6974   + '         tit
-00048140: 6c65 203d 2022 7b41 4243 7d22 2c5c 6e20  le = "{ABC}",\n 
-00048150: 2020 2020 2020 2020 6172 7869 7620 3d20          arxiv = 
-00048160: 2231 3233 3422 2c5c 6e7d 270a 2020 2020  "1234",\n}'.    
-00048170: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-00048180: 7375 6c74 4220 3d20 280a 2020 2020 2020  sultB = (.      
-00048190: 2020 2020 2020 2740 4172 7469 636c 657b        '@Article{
-000481a0: 6162 6331 2c5c 6e20 2020 2020 2020 2061  abc1,\n        a
-000481b0: 7574 686f 7220 3d20 226d 6522 2c5c 6e27  uthor = "me",\n'
-000481c0: 0a20 2020 2020 2020 2020 2020 202b 2027  .            + '
-000481d0: 2020 2020 2020 2020 2074 6974 6c65 203d           title =
-000481e0: 2022 7b61 6263 7d22 2c5c 6e20 2020 2020   "{abc}",\n     
-000481f0: 2020 2020 6172 7869 7620 3d20 2231 3233      arxiv = "123
-00048200: 3422 2c5c 6e7d 270a 2020 2020 2020 2020  4",\n}'.        
-00048210: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00048220: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-00048230: 2e70 4244 422e 6269 6273 2e70 7265 7061  .pBDB.bibs.prepa
-00048240: 7265 5570 6461 7465 2862 6962 7465 7841  reUpdate(bibtexA
-00048250: 2c20 6269 6274 6578 4529 2c20 2222 290a  , bibtexE), "").
-00048260: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00048270: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-00048280: 4442 2e62 6962 732e 7072 6570 6172 6555  DB.bibs.prepareU
-00048290: 7064 6174 6528 6269 6274 6578 452c 2062  pdate(bibtexE, b
-000482a0: 6962 7465 7841 292c 2022 2229 0a20 2020  ibtexA), "").   
-000482b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000482c0: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-000482d0: 6269 6273 2e70 7265 7061 7265 5570 6461  bibs.prepareUpda
-000482e0: 7465 2822 222c 2062 6962 7465 7841 292c  te("", bibtexA),
-000482f0: 2022 2229 0a0a 2020 2020 2020 2020 6269   "")..        bi
-00048300: 6274 6578 203d 2073 656c 662e 7042 4442  btex = self.pBDB
-00048310: 2e62 6962 732e 7072 6570 6172 6555 7064  .bibs.prepareUpd
-00048320: 6174 6528 6269 6274 6578 412c 2062 6962  ate(bibtexA, bib
-00048330: 7465 7842 290a 2020 2020 2020 2020 7365  texB).        se
-00048340: 6c66 2e61 7373 6572 7445 7175 616c 2862  lf.assertEqual(b
-00048350: 6962 7465 782c 2072 6573 756c 7441 202b  ibtex, resultA +
-00048360: 2022 5c6e 5c6e 2229 0a20 2020 2020 2020   "\n\n").       
-00048370: 2062 6962 7465 7820 3d20 7365 6c66 2e70   bibtex = self.p
-00048380: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
-00048390: 5570 6461 7465 2862 6962 7465 7842 2c20  Update(bibtexB, 
-000483a0: 6269 6274 6578 4129 0a20 2020 2020 2020  bibtexA).       
+000453f0: 2020 5f65 2e61 7373 6572 745f 616e 795f    _e.assert_any_
+00045400: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00045410: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+00045420: 6d70 6f73 7369 626c 6520 746f 2069 6e73  mpossible to ins
+00045430: 6572 7420 616e 2065 6e74 7279 2077 6974  ert an entry wit
+00045440: 6820 656d 7074 7920 6269 626b 6579 215c  h empty bibkey!\
+00045450: 6e6b 6579 305c 6e22 0a20 2020 2020 2020  nkey0\n".       
+00045460: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00045470: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00045480: 656c 662e 7042 4442 2e75 6e64 6f28 7665  elf.pBDB.undo(ve
+00045490: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
+000454a0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+000454b0: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
+000454c0: 4244 422e 6269 6273 2e6c 6f61 6441 6e64  BDB.bibs.loadAnd
+000454d0: 496e 7365 7274 2822 6b65 7930 2229 290a  Insert("key0")).
+000454e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000454f0: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
+00045500: 696e 672e 4c6f 6767 6572 2e65 7272 6f72  ing.Logger.error
+00045510: 2229 2061 7320 5f65 3a0a 2020 2020 2020  ") as _e:.      
+00045520: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00045530: 6c66 2e70 4244 422e 6269 6273 2e6c 6f61  lf.pBDB.bibs.loa
+00045540: 6441 6e64 496e 7365 7274 2822 6b65 7930  dAndInsert("key0
+00045550: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00045560: 2020 2020 2020 205f 652e 6173 7365 7274         _e.assert
+00045570: 5f61 6e79 5f63 616c 6c28 0a20 2020 2020  _any_call(.     
+00045580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045590: 2020 2022 496d 706f 7373 6962 6c65 2074     "Impossible t
+000455a0: 6f20 696e 7365 7274 2061 6e20 656e 7472  o insert an entr
+000455b0: 7920 7769 7468 2065 6d70 7479 2062 6962  y with empty bib
+000455c0: 6b65 7921 5c6e 6b65 7930 5c6e 220a 2020  key!\nkey0\n".  
+000455d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000455e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000455f0: 7365 6c66 2e70 4244 422e 756e 646f 2876  self.pBDB.undo(v
+00045600: 6572 626f 7365 3d30 290a 2020 2020 2020  erbose=0).      
+00045610: 2020 2020 2020 5f6d 6f63 6b5f 7569 6964        _mock_uiid
+00045620: 2e72 6573 6574 5f6d 6f63 6b28 290a 2020  .reset_mock().  
+00045630: 2020 2020 2020 2020 2020 5f6d 6f63 6b5f            _mock_
+00045640: 7569 6f2e 7265 7365 745f 6d6f 636b 2829  uio.reset_mock()
+00045650: 0a20 2020 2020 2020 2020 2020 2023 2074  .            # t
+00045660: 6573 7420 7570 6461 7465 496e 7370 6972  est updateInspir
+00045670: 6549 442c 2075 7064 6174 6549 6e66 6f46  eID, updateInfoF
+00045680: 726f 6d4f 4149 2061 7265 2063 616c 6c65  romOAI are calle
+00045690: 640a 2020 2020 2020 2020 2020 2020 7769  d.            wi
+000456a0: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
+000456b0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
+000456c0: 6962 6c69 6f2e 7765 6269 6d70 6f72 742e  iblio.webimport.
+000456d0: 696e 7370 6972 652e 5765 6253 6561 7263  inspire.WebSearc
+000456e0: 682e 7265 7472 6965 7665 5572 6c41 6c6c  h.retrieveUrlAll
+000456f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00045700: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
+00045710: 225c 6e40 6172 7469 636c 657b 6b65 7930  "\n@article{key0
+00045720: 2c5c 6e22 0a20 2020 2020 2020 2020 2020  ,\n".           
+00045730: 2020 2020 202b 2027 6175 7468 6f72 203d       + 'author =
+00045740: 2022 4761 7269 617a 7a6f 222c 5c6e 7469   "Gariazzo",\nti
+00045750: 746c 6520 3d20 227b 7469 746c 657d 222c  tle = "{title}",
+00045760: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00045770: 2020 2b20 275c 6e61 7278 6976 3d22 3132    + '\narxiv="12
+00045780: 3334 2e35 3637 3822 2c7d 272c 0a20 2020  34.5678",}',.   
+00045790: 2020 2020 2020 2020 2020 2020 2061 7574               aut
+000457a0: 6f73 7065 633d 5472 7565 2c0a 2020 2020  ospec=True,.    
+000457b0: 2020 2020 2020 2020 2920 6173 205f 6d6f          ) as _mo
+000457c0: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
+000457d0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+000457e0: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
+000457f0: 6273 2e6c 6f61 6441 6e64 496e 7365 7274  bs.loadAndInsert
+00045800: 2822 6b65 7930 2229 290a 2020 2020 2020  ("key0")).      
+00045810: 2020 2020 2020 2020 2020 5f6d 6f63 6b5f            _mock_
+00045820: 7569 6964 2e61 7373 6572 745f 6361 6c6c  uiid.assert_call
+00045830: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
+00045840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045850: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00045860: 2c20 226b 6579 3022 2c20 226b 6579 3022  , "key0", "key0"
+00045870: 2c20 6e75 6d62 6572 3d4e 6f6e 650a 2020  , number=None.  
+00045880: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00045890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000458a0: 5f6d 6f63 6b5f 7569 6f2e 6173 7365 7274  _mock_uio.assert
+000458b0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+000458c0: 6828 7365 6c66 2e70 4244 422e 6269 6273  h(self.pBDB.bibs
+000458d0: 2c20 2231 2229 0a20 2020 2020 2020 2020  , "1").         
+000458e0: 2020 2073 656c 662e 7042 4442 2e75 6e64     self.pBDB.und
+000458f0: 6f28 7665 7262 6f73 653d 3029 0a20 2020  o(verbose=0).   
+00045900: 2020 2020 2020 2020 205f 6d6f 636b 5f75           _mock_u
+00045910: 6969 642e 7265 7365 745f 6d6f 636b 2829  iid.reset_mock()
+00045920: 0a20 2020 2020 2020 2020 2020 205f 6d6f  .            _mo
+00045930: 636b 5f75 696f 2e72 6573 6574 5f6d 6f63  ck_uio.reset_moc
+00045940: 6b28 290a 2020 2020 2020 2020 2020 2020  k().            
+00045950: 2320 7465 7374 2075 7064 6174 6549 6e73  # test updateIns
+00045960: 7069 7265 4944 2c20 7570 6461 7465 496e  pireID, updateIn
+00045970: 666f 4672 6f6d 4f41 4920 6172 6520 6361  foFromOAI are ca
+00045980: 6c6c 6564 0a20 2020 2020 2020 2020 2020  lled.           
+00045990: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
+000459a0: 2020 2020 2020 2020 2020 2020 2022 7068               "ph
+000459b0: 7973 6269 626c 696f 2e77 6562 696d 706f  ysbiblio.webimpo
+000459c0: 7274 2e69 6e73 7069 7265 2e57 6562 5365  rt.inspire.WebSe
+000459d0: 6172 6368 2e72 6574 7269 6576 6555 726c  arch.retrieveUrl
+000459e0: 416c 6c22 2c0a 2020 2020 2020 2020 2020  All",.          
+000459f0: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
+00045a00: 7565 3d27 4061 7274 6963 6c65 7b6b 6579  ue='@article{key
+00045a10: 302c 5c6e 6175 7468 6f72 203d 2022 4761  0,\nauthor = "Ga
+00045a20: 7269 617a 7a6f 222c 270a 2020 2020 2020  riazzo",'.      
+00045a30: 2020 2020 2020 2020 2020 2b20 275c 6e74            + '\nt
+00045a40: 6974 6c65 203d 2022 7b74 6974 6c65 7d22  itle = "{title}"
+00045a50: 2c5c 6e61 7278 6976 3d22 3132 3334 2e35  ,\narxiv="1234.5
+00045a60: 3637 3822 2c7d 5c6e 4061 7274 6963 6c65  678",}\n@article
+00045a70: 7b27 0a20 2020 2020 2020 2020 2020 2020  {'.             
+00045a80: 2020 202b 2027 6b65 7931 2c5c 6e61 7574     + 'key1,\naut
+00045a90: 686f 7220 3d20 2247 6172 6961 7a7a 6f22  hor = "Gariazzo"
+00045aa0: 2c5c 6e74 6974 6c65 203d 2022 7b74 6974  ,\ntitle = "{tit
+00045ab0: 6c65 7d22 2c27 0a20 2020 2020 2020 2020  le}",'.         
+00045ac0: 2020 2020 2020 202b 2027 5c6e 6172 7869         + '\narxi
+00045ad0: 763d 2231 3233 342e 3536 3738 222c 7d5c  v="1234.5678",}\
+00045ae0: 6e27 2c0a 2020 2020 2020 2020 2020 2020  n',.            
+00045af0: 2020 2020 6175 746f 7370 6563 3d54 7275      autospec=Tru
+00045b00: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
+00045b10: 2061 7320 5f6d 6f63 6b3a 0a20 2020 2020   as _mock:.     
+00045b20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00045b30: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+00045b40: 7042 4442 2e62 6962 732e 6c6f 6164 416e  pBDB.bibs.loadAn
+00045b50: 6449 6e73 6572 7428 226b 6579 3022 2c20  dInsert("key0", 
+00045b60: 6e75 6d62 6572 3d30 2929 0a20 2020 2020  number=0)).     
+00045b70: 2020 2020 2020 2020 2020 205f 6d6f 636b             _mock
+00045b80: 5f75 6969 642e 6173 7365 7274 5f63 616c  _uiid.assert_cal
+00045b90: 6c65 645f 6f6e 6365 5f77 6974 6828 0a20  led_once_with(. 
+00045ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045bb0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+00045bc0: 732c 2022 6b65 7930 222c 2022 6b65 7930  s, "key0", "key0
+00045bd0: 222c 206e 756d 6265 723d 300a 2020 2020  ", number=0.    
+00045be0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00045bf0: 2020 2020 2020 2020 2020 2020 2020 5f6d                _m
+00045c00: 6f63 6b5f 7569 6f2e 6173 7365 7274 5f63  ock_uio.assert_c
+00045c10: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+00045c20: 7365 6c66 2e70 4244 422e 6269 6273 2c20  self.pBDB.bibs, 
+00045c30: 2231 2229 0a20 2020 2020 2020 2020 2020  "1").           
+00045c40: 2073 656c 662e 7042 4442 2e75 6e64 6f28   self.pBDB.undo(
+00045c50: 7665 7262 6f73 653d 3029 0a20 2020 2020  verbose=0).     
+00045c60: 2020 2020 2020 205f 6d6f 636b 5f75 6969         _mock_uii
+00045c70: 642e 7265 7365 745f 6d6f 636b 2829 0a20  d.reset_mock(). 
+00045c80: 2020 2020 2020 2020 2020 205f 6d6f 636b             _mock
+00045c90: 5f75 696f 2e72 6573 6574 5f6d 6f63 6b28  _uio.reset_mock(
+00045ca0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00045cb0: 7465 7374 2075 7064 6174 6549 6e73 7069  test updateInspi
+00045cc0: 7265 4944 2c20 7570 6461 7465 496e 666f  reID, updateInfo
+00045cd0: 4672 6f6d 4f41 4920 6172 6520 6361 6c6c  FromOAI are call
+00045ce0: 6564 0a20 2020 2020 2020 2020 2020 2077  ed.            w
+00045cf0: 6974 6820 7061 7463 6828 0a20 2020 2020  ith patch(.     
+00045d00: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+00045d10: 6269 626c 696f 2e77 6562 696d 706f 7274  biblio.webimport
+00045d20: 2e61 7278 6976 2e57 6562 5365 6172 6368  .arxiv.WebSearch
+00045d30: 2e72 6574 7269 6576 6555 726c 416c 6c22  .retrieveUrlAll"
+00045d40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00045d50: 2020 7265 7475 726e 5f76 616c 7565 3d22    return_value="
+00045d60: 4061 7274 6963 6c65 7b6b 6579 302c 5c6e  @article{key0,\n
+00045d70: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00045d80: 2020 2b20 2761 7574 686f 7220 3d20 2247    + 'author = "G
+00045d90: 6172 6961 7a7a 6f22 2c5c 6e74 6974 6c65  ariazzo",\ntitle
+00045da0: 203d 2022 7b74 6974 6c65 7d22 2c27 0a20   = "{title}",'. 
+00045db0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+00045dc0: 2027 5c6e 6172 7869 763d 2231 3233 342e   '\narxiv="1234.
+00045dd0: 3536 3738 222c 7d27 2c0a 2020 2020 2020  5678",}',.      
+00045de0: 2020 2020 2020 2020 2020 6175 746f 7370            autosp
+00045df0: 6563 3d54 7275 652c 0a20 2020 2020 2020  ec=True,.       
+00045e00: 2020 2020 2029 2061 7320 5f6d 6f63 6b3a       ) as _mock:
+00045e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045e20: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00045e30: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00045e40: 6c6f 6164 416e 6449 6e73 6572 7428 226b  loadAndInsert("k
+00045e50: 6579 3022 2c20 6d65 7468 6f64 3d22 6172  ey0", method="ar
+00045e60: 7869 7622 2929 0a20 2020 2020 2020 2020  xiv")).         
+00045e70: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00045e80: 7274 4571 7561 6c28 5f6d 6f63 6b5f 7569  rtEqual(_mock_ui
+00045e90: 6964 2e63 616c 6c5f 636f 756e 742c 2030  id.call_count, 0
+00045ea0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00045eb0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00045ec0: 616c 285f 6d6f 636b 5f75 696f 2e63 616c  al(_mock_uio.cal
+00045ed0: 6c5f 636f 756e 742c 2030 290a 0a20 2020  l_count, 0)..   
+00045ee0: 2020 2020 2023 206c 6f61 6441 6e64 496e       # loadAndIn
+00045ef0: 7365 7274 5769 7468 4361 7473 0a20 2020  sertWithCats.   
+00045f00: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00045f10: 6962 732e 6c61 7374 496e 7365 7274 6564  ibs.lastInserted
+00045f20: 203d 205b 2261 6263 225d 0a20 2020 2020   = ["abc"].     
+00045f30: 2020 2077 6974 6820 7061 7463 6828 2262     with patch("b
+00045f40: 7569 6c74 696e 732e 696e 7075 7422 2c20  uiltins.input", 
+00045f50: 7265 7475 726e 5f76 616c 7565 3d22 5b31  return_value="[1
+00045f60: 2c32 5d22 2920 6173 205f 696e 7075 742c  ,2]") as _input,
+00045f70: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+00045f80: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+00045f90: 6461 7461 6261 7365 2e45 6e74 7269 6573  database.Entries
+00045fa0: 2e6c 6f61 6441 6e64 496e 7365 7274 222c  .loadAndInsert",
+00045fb0: 2061 7574 6f73 7065 633d 5472 7565 0a20   autospec=True. 
+00045fc0: 2020 2020 2020 2029 2061 7320 5f6d 6f63         ) as _moc
+00045fd0: 6b3a 0a20 2020 2020 2020 2020 2020 2073  k:.            s
+00045fe0: 656c 662e 7042 4442 2e62 6962 732e 6c6f  elf.pBDB.bibs.lo
+00045ff0: 6164 416e 6449 6e73 6572 7457 6974 6843  adAndInsertWithC
+00046000: 6174 7328 5b22 6163 6222 5d2c 2022 646f  ats(["acb"], "do
+00046010: 6922 2c20 5472 7565 2c20 312c 2054 7275  i", True, 1, Tru
+00046020: 652c 2022 7965 7322 290a 2020 2020 2020  e, "yes").      
+00046030: 2020 2020 2020 5f69 6e70 7574 2e61 7373        _input.ass
+00046040: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+00046050: 7769 7468 2822 6361 7465 676f 7269 6573  with("categories
+00046060: 2066 6f72 2027 6162 6327 3a20 2229 0a20   for 'abc': "). 
+00046070: 2020 2020 2020 2020 2020 205f 6d6f 636b             _mock
+00046080: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+00046090: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
+000460a0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000460b0: 4244 422e 6269 6273 2c0a 2020 2020 2020  BDB.bibs,.      
+000460c0: 2020 2020 2020 2020 2020 5b22 6163 6222            ["acb"
+000460d0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000460e0: 2020 2063 6869 6c64 5072 6f63 6573 733d     childProcess=
+000460f0: 2279 6573 222c 0a20 2020 2020 2020 2020  "yes",.         
+00046100: 2020 2020 2020 2069 6d70 6f73 654b 6579         imposeKey
+00046110: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+00046120: 2020 2020 2020 206d 6574 686f 643d 2264         method="d
+00046130: 6f69 222c 0a20 2020 2020 2020 2020 2020  oi",.           
+00046140: 2020 2020 206e 756d 6265 723d 312c 0a20       number=1,. 
+00046150: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00046160: 6574 7572 6e42 6962 7465 783d 5472 7565  eturnBibtex=True
+00046170: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00046180: 0a20 2020 2064 6566 2074 6573 745f 7061  .    def test_pa
+00046190: 7273 6541 6c6c 4269 6274 6578 7328 7365  rseAllBibtexs(se
+000461a0: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
+000461b0: 2020 2020 2222 2274 6573 7420 7061 7273      """test pars
+000461c0: 6541 6c6c 4269 6274 6578 7322 2222 0a20  eAllBibtexs""". 
+000461d0: 2020 2020 2020 2074 6578 7420 3d20 5b0a         text = [.
+000461e0: 2020 2020 2020 2020 2020 2020 2240 6172              "@ar
+000461f0: 7469 636c 657b 6162 632c 5c6e 222c 0a20  ticle{abc,\n",. 
+00046200: 2020 2020 2020 2020 2020 2027 6175 7468             'auth
+00046210: 6f72 203d 2022 6d65 222c 5c6e 272c 0a20  or = "me",\n',. 
+00046220: 2020 2020 2020 2020 2020 2027 7469 746c             'titl
+00046230: 6520 3d20 2222 2c7d 272c 0a20 2020 2020  e = "",}',.     
+00046240: 2020 2020 2020 2027 2522 6162 6322 2c27         '%"abc",'
+00046250: 2c0a 2020 2020 2020 2020 2020 2020 227d  ,.            "}
+00046260: 5c6e 222c 0a20 2020 2020 2020 2020 2020  \n",.           
+00046270: 2022 5c6e 222c 0a20 2020 2020 2020 2020   "\n",.         
+00046280: 2020 2022 4061 7274 6963 6c65 7b64 6566     "@article{def
+00046290: 2c5c 6e22 2c0a 2020 2020 2020 2020 2020  ,\n",.          
+000462a0: 2020 2761 7574 686f 7220 3d20 226d 6522    'author = "me"
+000462b0: 2c5c 6e27 2c0a 2020 2020 2020 2020 2020  ,\n',.          
+000462c0: 2020 2774 6974 6c65 203d 2022 6465 6640    'title = "def@
+000462d0: 6768 6922 2c7d 272c 0a20 2020 2020 2020  ghi",}',.       
+000462e0: 205d 0a20 2020 2020 2020 2065 7272 6f72   ].        error
+000462f0: 7320 3d20 5b5d 0a20 2020 2020 2020 2077  s = [].        w
+00046300: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
+00046310: 6e67 2e4c 6f67 6765 722e 6465 6275 6722  ng.Logger.debug"
+00046320: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
+00046330: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00046340: 6962 732e 7061 7273 6541 6c6c 4269 6274  ibs.parseAllBibt
+00046350: 6578 7328 7465 7874 2c20 6572 726f 7273  exs(text, errors
+00046360: 3d65 7272 6f72 732c 2076 6572 626f 7365  =errors, verbose
+00046370: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
+00046380: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+00046390: 7565 285f 692e 6361 6c6c 5f63 6f75 6e74  ue(_i.call_count
+000463a0: 203e 3d20 3429 0a20 2020 2020 2020 2020   >= 4).         
+000463b0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+000463c0: 7561 6c28 6c65 6e28 6572 726f 7273 292c  ual(len(errors),
+000463d0: 2030 290a 2020 2020 2020 2020 2020 2020   0).            
+000463e0: 5f69 2e72 6573 6574 5f6d 6f63 6b28 290a  _i.reset_mock().
+000463f0: 2020 2020 2020 2020 2020 2020 7265 7320              res 
+00046400: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
+00046410: 2e70 6172 7365 416c 6c42 6962 7465 7873  .parseAllBibtexs
+00046420: 2874 6578 742c 2065 7272 6f72 733d 6572  (text, errors=er
+00046430: 726f 7273 2c20 7665 7262 6f73 653d 4661  rors, verbose=Fa
+00046440: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+00046450: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00046460: 285f 692e 6361 6c6c 5f63 6f75 6e74 203e  (_i.call_count >
+00046470: 3d20 3229 0a20 2020 2020 2020 2020 2020  = 2).           
+00046480: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00046490: 6c28 5b61 5b22 4944 225d 2066 6f72 2061  l([a["ID"] for a
+000464a0: 2069 6e20 7265 735d 2c20 5b22 6162 6322   in res], ["abc"
+000464b0: 2c20 2264 6566 225d 290a 2020 2020 2020  , "def"]).      
+000464c0: 2020 7465 7874 203d 205b 0a20 2020 2020    text = [.     
+000464d0: 2020 2020 2020 2022 4061 7274 6963 6c65         "@article
+000464e0: 7b61 6263 2c5c 6e22 2c0a 2020 2020 2020  {abc,\n",.      
+000464f0: 2020 2020 2020 2761 7574 686f 7220 3d20        'author = 
+00046500: 226d 6522 2c5c 6e27 2c0a 2020 2020 2020  "me",\n',.      
+00046510: 2020 2020 2020 2725 7469 746c 6520 3d20        '%title = 
+00046520: 2222 2c7d 272c 0a20 2020 2020 2020 2020  "",}',.         
+00046530: 2020 2027 2522 6162 6322 2c27 2c0a 2020     '%"abc",',.  
+00046540: 2020 2020 2020 2020 2020 225c 6e22 2c0a            "\n",.
+00046550: 2020 2020 2020 2020 2020 2020 2240 6172              "@ar
+00046560: 7469 636c 657b 6465 662c 5c6e 222c 0a20  ticle{def,\n",. 
+00046570: 2020 2020 2020 2020 2020 2027 6175 7468             'auth
+00046580: 6f72 203d 2022 6d65 222c 5c6e 272c 0a20  or = "me",\n',. 
+00046590: 2020 2020 2020 2020 2020 2027 7469 746c             'titl
+000465a0: 6520 3d20 2264 6566 4067 6869 222c 7d27  e = "def@ghi",}'
+000465b0: 2c0a 2020 2020 2020 2020 5d0a 2020 2020  ,.        ].    
+000465c0: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+000465d0: 6c6f 6767 696e 672e 4c6f 6767 6572 2e65  logging.Logger.e
+000465e0: 7863 6570 7469 6f6e 2229 2061 7320 5f65  xception") as _e
+000465f0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
+00046600: 2020 2020 2022 6c6f 6767 696e 672e 4c6f       "logging.Lo
+00046610: 6767 6572 2e64 6562 7567 220a 2020 2020  gger.debug".    
+00046620: 2020 2020 2920 6173 205f 693a 0a20 2020      ) as _i:.   
+00046630: 2020 2020 2020 2020 2072 6573 203d 2073           res = s
+00046640: 656c 662e 7042 4442 2e62 6962 732e 7061  elf.pBDB.bibs.pa
+00046650: 7273 6541 6c6c 4269 6274 6578 7328 7465  rseAllBibtexs(te
+00046660: 7874 2c20 6572 726f 7273 3d65 7272 6f72  xt, errors=error
+00046670: 732c 2076 6572 626f 7365 3d46 616c 7365  s, verbose=False
+00046680: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00046690: 6c66 2e61 7373 6572 7445 7175 616c 285b  lf.assertEqual([
+000466a0: 615b 2249 4422 5d20 666f 7220 6120 696e  a["ID"] for a in
+000466b0: 2072 6573 5d2c 205b 2264 6566 225d 290a   res], ["def"]).
+000466c0: 0a20 2020 2064 6566 2074 6573 745f 7072  .    def test_pr
+000466d0: 6570 6172 6549 6e73 6572 7428 7365 6c66  epareInsert(self
+000466e0: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
+000466f0: 2020 2222 2274 6573 7420 7072 6570 6172    """test prepar
+00046700: 6549 6e73 6572 7422 2222 0a20 2020 2020  eInsert""".     
+00046710: 2020 2023 206d 756c 7469 706c 6520 656e     # multiple en
+00046720: 7472 6965 7320 696e 2062 6962 7465 783a  tries in bibtex:
+00046730: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00046740: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00046750: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00046760: 2e62 6962 732e 7072 6570 6172 6549 6e73  .bibs.prepareIns
+00046770: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
+00046780: 2020 2020 2027 4061 7274 6963 6c65 7b61       '@article{a
+00046790: 6263 2c5c 6e61 7574 686f 7220 3d20 226d  bc,\nauthor = "m
+000467a0: 6522 2c5c 6e27 0a20 2020 2020 2020 2020  e",\n'.         
+000467b0: 2020 2020 2020 202b 2027 7469 746c 6520         + 'title 
+000467c0: 3d20 226d 7974 6974 222c 7d5c 6e40 6172  = "mytit",}\n@ar
+000467d0: 7469 636c 657b 6465 662c 5c6e 6175 7468  ticle{def,\nauth
+000467e0: 6f72 203d 2022 796f 7522 2c27 0a20 2020  or = "you",'.   
+000467f0: 2020 2020 2020 2020 2020 2020 202b 2027               + '
+00046800: 5c6e 7469 746c 6520 3d20 226f 7468 6572  \ntitle = "other
+00046810: 222c 7d27 0a20 2020 2020 2020 2020 2020  ",}'.           
+00046820: 2029 5b22 6269 626b 6579 225d 2c0a 2020   )["bibkey"],.  
+00046830: 2020 2020 2020 2020 2020 2261 6263 222c            "abc",
+00046840: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00046850: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00046860: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00046870: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00046880: 7072 6570 6172 6549 6e73 6572 7428 0a20  prepareInsert(. 
+00046890: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000468a0: 4061 7274 6963 6c65 7b61 6263 2c5c 6e61  @article{abc,\na
+000468b0: 7574 686f 7220 3d20 226d 6522 2c5c 6e27  uthor = "me",\n'
+000468c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000468d0: 202b 2027 7469 746c 6520 3d20 226d 7974   + 'title = "myt
+000468e0: 6974 222c 7d5c 6e40 6172 7469 636c 657b  it",}\n@article{
+000468f0: 6465 662c 5c6e 6175 7468 6f72 203d 2022  def,\nauthor = "
+00046900: 796f 7522 2c5c 6e27 0a20 2020 2020 2020  you",\n'.       
+00046910: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
+00046920: 6520 3d20 226f 7468 6572 222c 7d27 2c0a  e = "other",}',.
+00046930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046940: 6e75 6d62 6572 3d31 2c0a 2020 2020 2020  number=1,.      
+00046950: 2020 2020 2020 295b 2262 6962 6b65 7922        )["bibkey"
+00046960: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
+00046970: 6465 6622 2c0a 2020 2020 2020 2020 290a  def",.        ).
+00046980: 0a20 2020 2020 2020 2023 2064 6966 6665  .        # diffe
+00046990: 7265 6e74 2066 6965 6c64 730a 2020 2020  rent fields.    
+000469a0: 2020 2020 6269 6274 6578 203d 2028 0a20      bibtex = (. 
+000469b0: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
+000469c0: 6963 6c65 7b61 6263 2c5c 6e61 7574 686f  icle{abc,\nautho
+000469d0: 7220 3d20 226d 6522 2c5c 6e27 0a20 2020  r = "me",\n'.   
+000469e0: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
+000469f0: 6520 3d20 226d 7974 6974 222c 5c6e 6172  e = "mytit",\nar
+00046a00: 7869 763d 2231 3830 312e 3030 3030 3022  xiv="1801.00000"
+00046a10: 2c5c 6e7d 270a 2020 2020 2020 2020 290a  ,\n}'.        ).
+00046a20: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00046a30: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00046a40: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00046a50: 6269 6273 2e70 7265 7061 7265 496e 7365  bibs.prepareInse
+00046a60: 7274 2862 6962 7465 782c 2062 6962 6b65  rt(bibtex, bibke
+00046a70: 793d 2264 6566 2229 5b22 6269 626b 6579  y="def")["bibkey
+00046a80: 225d 2c20 2264 6566 220a 2020 2020 2020  "], "def".      
+00046a90: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00046aa0: 2e61 7373 6572 7449 6e28 0a20 2020 2020  .assertIn(.     
+00046ab0: 2020 2020 2020 2022 7274 6963 6c65 7b64         "rticle{d
+00046ac0: 6566 2c22 2c20 7365 6c66 2e70 4244 422e  ef,", self.pBDB.
+00046ad0: 6269 6273 2e70 7265 7061 7265 496e 7365  bibs.prepareInse
+00046ae0: 7274 2862 6962 7465 782c 2062 6962 6b65  rt(bibtex, bibke
+00046af0: 793d 2264 6566 2229 5b22 6269 6274 6578  y="def")["bibtex
+00046b00: 225d 0a20 2020 2020 2020 2029 0a0a 2020  "].        )..  
+00046b10: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
+00046b20: 662e 7042 4442 2e62 6962 732e 7072 6570  f.pBDB.bibs.prep
+00046b30: 6172 6549 6e73 6572 7428 6269 6274 6578  areInsert(bibtex
+00046b40: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00046b50: 7373 6572 7445 7175 616c 2864 6174 615b  ssertEqual(data[
+00046b60: 2262 6962 6b65 7922 5d2c 2022 6162 6322  "bibkey"], "abc"
+00046b70: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00046b80: 7373 6572 7445 7175 616c 2864 6174 615b  ssertEqual(data[
+00046b90: 2261 7278 6976 225d 2c20 2231 3830 312e  "arxiv"], "1801.
+00046ba0: 3030 3030 3022 290a 2020 2020 2020 2020  00000").        
+00046bb0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00046bc0: 280a 2020 2020 2020 2020 2020 2020 6173  (.            as
+00046bd0: 742e 6c69 7465 7261 6c5f 6576 616c 2864  t.literal_eval(d
+00046be0: 6174 615b 2262 6962 6469 6374 225d 292c  ata["bibdict"]),
+00046bf0: 0a20 2020 2020 2020 2020 2020 207b 0a20  .            {. 
+00046c00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00046c10: 454e 5452 5954 5950 4522 3a20 2261 7274  ENTRYTYPE": "art
+00046c20: 6963 6c65 222c 0a20 2020 2020 2020 2020  icle",.         
+00046c30: 2020 2020 2020 2022 4944 223a 2022 6162         "ID": "ab
+00046c40: 6322 2c0a 2020 2020 2020 2020 2020 2020  c",.            
+00046c50: 2020 2020 2261 7278 6976 223a 2022 3138      "arxiv": "18
+00046c60: 3031 2e30 3030 3030 222c 0a20 2020 2020  01.00000",.     
+00046c70: 2020 2020 2020 2020 2020 2022 6175 7468             "auth
+00046c80: 6f72 223a 2022 6d65 222c 0a20 2020 2020  or": "me",.     
+00046c90: 2020 2020 2020 2020 2020 2022 7469 746c             "titl
+00046ca0: 6522 3a20 227b 6d79 7469 747d 222c 0a20  e": "{mytit}",. 
+00046cb0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+00046cc0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00046cd0: 2023 2074 6573 7420 7369 6d70 6c65 2066   # test simple f
+00046ce0: 6965 6c64 730a 2020 2020 2020 2020 6269  ields.        bi
+00046cf0: 6274 6578 203d 2027 4061 7274 6963 6c65  btex = '@article
+00046d00: 7b61 6263 2c5c 6e61 7574 686f 7220 3d20  {abc,\nauthor = 
+00046d10: 226d 6522 2c5c 6e74 6974 6c65 203d 2022  "me",\ntitle = "
+00046d20: 6d79 7469 7422 2c5c 6e7d 270a 2020 2020  mytit",\n}'.    
+00046d30: 2020 2020 666f 7220 6b20 696e 2028 2269      for k in ("i
+00046d40: 6e73 7069 7265 222c 2022 6164 7322 2c20  nspire", "ads", 
+00046d50: 2273 6368 6f6c 6172 222c 2022 636f 6d6d  "scholar", "comm
+00046d60: 656e 7473 222c 2022 6f6c 645f 6b65 7973  ents", "old_keys
+00046d70: 222c 2022 6162 7374 7261 6374 2229 3a0a  ", "abstract"):.
+00046d80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00046d90: 2e61 7373 6572 7445 7175 616c 2864 6174  .assertEqual(dat
+00046da0: 615b 6b5d 2c20 4e6f 6e65 290a 2020 2020  a[k], None).    
+00046db0: 2020 2020 2020 2020 746d 7020 3d20 7b7d          tmp = {}
+00046dc0: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
+00046dd0: 5b6b 5d20 3d20 2274 7279 220a 2020 2020  [k] = "try".    
+00046de0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00046df0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+00046e00: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
+00046e10: 6e73 6572 7428 6269 6274 6578 2c20 2a2a  nsert(bibtex, **
+00046e20: 746d 7029 5b6b 5d2c 2022 7472 7922 290a  tmp)[k], "try").
+00046e30: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
+00046e40: 2028 2270 7562 6461 7465 222c 2022 6d61   ("pubdate", "ma
+00046e50: 726b 7322 293a 0a20 2020 2020 2020 2020  rks"):.         
+00046e60: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00046e70: 7561 6c28 6461 7461 5b6b 5d2c 2022 2229  ual(data[k], "")
+00046e80: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
+00046e90: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+00046ea0: 2020 746d 705b 6b5d 203d 2022 7472 7922    tmp[k] = "try"
+00046eb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00046ec0: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00046ed0: 6c66 2e70 4244 422e 6269 6273 2e70 7265  lf.pBDB.bibs.pre
+00046ee0: 7061 7265 496e 7365 7274 2862 6962 7465  pareInsert(bibte
+00046ef0: 782c 202a 2a74 6d70 295b 6b5d 2c20 2274  x, **tmp)[k], "t
+00046f00: 7279 2229 0a20 2020 2020 2020 2066 6f72  ry").        for
+00046f10: 206b 2069 6e20 280a 2020 2020 2020 2020   k in (.        
+00046f20: 2020 2020 2265 7870 5f70 6170 6572 222c      "exp_paper",
+00046f30: 0a20 2020 2020 2020 2020 2020 2022 6c65  .            "le
+00046f40: 6374 7572 6522 2c0a 2020 2020 2020 2020  cture",.        
+00046f50: 2020 2020 2270 6864 5f74 6865 7369 7322      "phd_thesis"
+00046f60: 2c0a 2020 2020 2020 2020 2020 2020 2272  ,.            "r
+00046f70: 6576 6965 7722 2c0a 2020 2020 2020 2020  eview",.        
+00046f80: 2020 2020 2270 726f 6365 6564 696e 6722      "proceeding"
+00046f90: 2c0a 2020 2020 2020 2020 2020 2020 2262  ,.            "b
+00046fa0: 6f6f 6b22 2c0a 2020 2020 2020 2020 2020  ook",.          
+00046fb0: 2020 226e 6f55 7064 6174 6522 2c0a 2020    "noUpdate",.  
+00046fc0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00046fd0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00046fe0: 4571 7561 6c28 6461 7461 5b6b 5d2c 2030  Equal(data[k], 0
+00046ff0: 290a 2020 2020 2020 2020 2020 2020 746d  ).            tm
+00047000: 7020 3d20 7b7d 0a20 2020 2020 2020 2020  p = {}.         
+00047010: 2020 2074 6d70 5b6b 5d20 3d20 310a 2020     tmp[k] = 1.  
+00047020: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00047030: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+00047040: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
+00047050: 6549 6e73 6572 7428 6269 6274 6578 2c20  eInsert(bibtex, 
+00047060: 2a2a 746d 7029 5b6b 5d2c 2031 290a 0a20  **tmp)[k], 1).. 
+00047070: 2020 2020 2020 2023 2074 6573 7420 6172         # test ar
+00047080: 7869 760a 2020 2020 2020 2020 7365 6c66  xiv.        self
+00047090: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+000470a0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000470b0: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
+000470c0: 496e 7365 7274 2862 6962 7465 782c 2061  Insert(bibtex, a
+000470d0: 7278 6976 3d22 3138 3031 2e30 3030 3030  rxiv="1801.00000
+000470e0: 2229 5b22 6172 7869 7622 5d2c 0a20 2020  ")["arxiv"],.   
+000470f0: 2020 2020 2020 2020 2022 3138 3031 2e30           "1801.0
+00047100: 3030 3030 222c 0a20 2020 2020 2020 2029  0000",.        )
+00047110: 0a20 2020 2020 2020 2062 6962 7465 7841  .        bibtexA
+00047120: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00047130: 2027 4061 7274 6963 6c65 7b61 6263 2c5c   '@article{abc,\
+00047140: 6e61 7574 686f 7220 3d20 226d 6522 2c5c  nauthor = "me",\
+00047150: 6e27 0a20 2020 2020 2020 2020 2020 202b  n'.            +
+00047160: 2027 7469 746c 6520 3d20 226d 7974 6974   'title = "mytit
+00047170: 222c 5c6e 6570 7269 6e74 3d22 3138 3031  ",\neprint="1801
+00047180: 2e30 3030 3030 222c 5c6e 7d27 0a20 2020  .00000",\n}'.   
+00047190: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+000471a0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000471b0: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
+000471c0: 7265 7061 7265 496e 7365 7274 2862 6962  repareInsert(bib
+000471d0: 7465 7841 295b 2261 7278 6976 225d 2c20  texA)["arxiv"], 
+000471e0: 2231 3830 312e 3030 3030 3022 290a 2020  "1801.00000").  
+000471f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00047200: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
+00047210: 2e62 6962 732e 7072 6570 6172 6549 6e73  .bibs.prepareIns
+00047220: 6572 7428 6269 6274 6578 295b 2261 7278  ert(bibtex)["arx
+00047230: 6976 225d 2c20 2222 290a 0a20 2020 2020  iv"], "")..     
+00047240: 2020 2023 206d 6f72 6520 7465 7374 730a     # more tests.
+00047250: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00047260: 6572 7445 7175 616c 2864 6174 615b 2264  ertEqual(data["d
+00047270: 6f69 225d 2c20 4e6f 6e65 290a 2020 2020  oi"], None).    
+00047280: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00047290: 7175 616c 2864 6174 615b 2263 726f 7373  qual(data["cross
+000472a0: 7265 6622 5d2c 204e 6f6e 6529 0a20 2020  ref"], None).   
+000472b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000472c0: 4571 7561 6c28 6461 7461 5b22 6162 7374  Equal(data["abst
+000472d0: 7261 6374 225d 2c20 4e6f 6e65 290a 2020  ract"], None).  
+000472e0: 2020 2020 2020 666f 7220 6b20 696e 2028        for k in (
+000472f0: 2264 6f69 222c 2022 6973 626e 222c 2022  "doi", "isbn", "
+00047300: 6372 6f73 7372 6566 222c 2022 6162 7374  crossref", "abst
+00047310: 7261 6374 2229 3a0a 2020 2020 2020 2020  ract"):.        
+00047320: 2020 2020 6269 6274 6578 4120 3d20 280a      bibtexA = (.
+00047330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047340: 2740 6172 7469 636c 657b 6162 632c 5c6e  '@article{abc,\n
+00047350: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
+00047360: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
+00047370: 2020 2b20 2774 6974 6c65 203d 2022 6d79    + 'title = "my
+00047380: 7469 7422 2c5c 6e25 733d 2273 6f6d 6574  tit",\n%s="somet
+00047390: 6869 6e67 222c 5c6e 7d27 2025 206b 0a20  hing",\n}' % k. 
+000473a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000473b0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+000473c0: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+000473d0: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
+000473e0: 496e 7365 7274 2862 6962 7465 7841 295b  Insert(bibtexA)[
+000473f0: 6b5d 2c20 2273 6f6d 6574 6869 6e67 2229  k], "something")
+00047400: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
+00047410: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+00047420: 2020 746d 705b 6b5d 203d 2022 736f 6d65    tmp[k] = "some
+00047430: 7468 696e 6722 0a20 2020 2020 2020 2020  thing".         
+00047440: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00047450: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00047460: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00047470: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
+00047480: 7428 6269 6274 6578 2c20 2a2a 746d 7029  t(bibtex, **tmp)
+00047490: 5b6b 5d2c 2022 736f 6d65 7468 696e 6722  [k], "something"
+000474a0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+000474b0: 2020 2020 2020 2020 2320 7465 7374 2079          # test y
+000474c0: 6561 720a 2020 2020 2020 2020 7365 6c66  ear.        self
+000474d0: 2e61 7373 6572 7445 7175 616c 2864 6174  .assertEqual(dat
+000474e0: 615b 2279 6561 7222 5d2c 2022 3230 3138  a["year"], "2018
+000474f0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00047500: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00047510: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00047520: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
+00047530: 6e73 6572 7428 6269 6274 6578 2c20 7965  nsert(bibtex, ye
+00047540: 6172 3d22 3139 3939 2229 5b22 7965 6172  ar="1999")["year
+00047550: 225d 2c20 2231 3939 3922 0a20 2020 2020  "], "1999".     
+00047560: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00047570: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00047580: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00047590: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
+000475a0: 6549 6e73 6572 7428 6269 6274 6578 2c20  eInsert(bibtex, 
+000475b0: 6172 7869 763d 2268 6570 2d70 682f 3939  arxiv="hep-ph/99
+000475c0: 3031 3030 3022 295b 2279 6561 7222 5d2c  01000")["year"],
+000475d0: 2022 3139 3939 220a 2020 2020 2020 2020   "1999".        
+000475e0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000475f0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00047600: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00047610: 422e 6269 6273 2e70 7265 7061 7265 496e  B.bibs.prepareIn
+00047620: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
+00047630: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
+00047640: 6162 632c 5c6e 6175 7468 6f72 203d 2022  abc,\nauthor = "
+00047650: 6d65 222c 5c6e 2720 2b20 2774 6974 6c65  me",\n' + 'title
+00047660: 203d 2022 6d79 7469 7422 2c5c 6e79 6561   = "mytit",\nyea
+00047670: 723d 2232 3030 3522 2c5c 6e7d 270a 2020  r="2005",\n}'.  
+00047680: 2020 2020 2020 2020 2020 295b 2279 6561            )["yea
+00047690: 7222 5d2c 0a20 2020 2020 2020 2020 2020  r"],.           
+000476a0: 2022 3230 3035 222c 0a20 2020 2020 2020   "2005",.       
+000476b0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+000476c0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+000476d0: 2e70 4244 422e 6269 6273 2e70 7265 7061  .pBDB.bibs.prepa
+000476e0: 7265 496e 7365 7274 2862 6962 7465 7829  reInsert(bibtex)
+000476f0: 5b22 7965 6172 225d 2c20 4e6f 6e65 290a  ["year"], None).
+00047700: 0a20 2020 2020 2020 2023 2074 6573 7420  .        # test 
+00047710: 6c69 6e6b 0a20 2020 2020 2020 2073 656c  link.        sel
+00047720: 662e 6173 7365 7274 4571 7561 6c28 6461  f.assertEqual(da
+00047730: 7461 5b22 6c69 6e6b 225d 2c20 7062 436f  ta["link"], pbCo
+00047740: 6e66 6967 2e61 7278 6976 5572 6c20 2b20  nfig.arxivUrl + 
+00047750: 222f 6162 732f 3138 3031 2e30 3030 3030  "/abs/1801.00000
+00047760: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00047770: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00047780: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00047790: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
+000477a0: 6e73 6572 7428 6269 6274 6578 2c20 6c69  nsert(bibtex, li
+000477b0: 6e6b 3d22 6874 7470 3a2f 2f73 6f6d 652e  nk="http://some.
+000477c0: 7468 696e 6722 295b 226c 696e 6b22 5d2c  thing")["link"],
+000477d0: 0a20 2020 2020 2020 2020 2020 2022 6874  .            "ht
+000477e0: 7470 3a2f 2f73 6f6d 652e 7468 696e 6722  tp://some.thing"
+000477f0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00047800: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00047810: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00047820: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00047830: 2e70 7265 7061 7265 496e 7365 7274 2862  .prepareInsert(b
+00047840: 6962 7465 782c 2064 6f69 3d22 736f 6d65  ibtex, doi="some
+00047850: 646f 6922 295b 226c 696e 6b22 5d2c 0a20  doi")["link"],. 
+00047860: 2020 2020 2020 2020 2020 2070 6243 6f6e             pbCon
+00047870: 6669 672e 646f 6955 726c 202b 2022 736f  fig.doiUrl + "so
+00047880: 6d65 646f 6922 2c0a 2020 2020 2020 2020  medoi",.        
+00047890: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000478a0: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+000478b0: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
+000478c0: 6549 6e73 6572 7428 6269 6274 6578 295b  eInsert(bibtex)[
+000478d0: 226c 696e 6b22 5d2c 2022 2229 0a0a 2020  "link"], "")..  
+000478e0: 2020 2020 2020 2320 7465 7374 2066 6972        # test fir
+000478f0: 7374 6461 7465 0a20 2020 2020 2020 2073  stdate.        s
+00047900: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00047910: 6461 7461 5b22 6669 7273 7464 6174 6522  data["firstdate"
+00047920: 5d2c 2064 6174 6574 696d 652e 6461 7465  ], datetime.date
+00047930: 2e74 6f64 6179 2829 2e73 7472 6674 696d  .today().strftim
+00047940: 6528 2225 592d 256d 2d25 6422 2929 0a20  e("%Y-%m-%d")). 
+00047950: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00047960: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00047970: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00047980: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
+00047990: 7428 6269 6274 6578 2c20 6669 7273 7464  t(bibtex, firstd
+000479a0: 6174 653d 2232 3031 382d 3031 2d30 3122  ate="2018-01-01"
+000479b0: 295b 2266 6972 7374 6461 7465 225d 2c0a  )["firstdate"],.
+000479c0: 2020 2020 2020 2020 2020 2020 2232 3031              "201
+000479d0: 382d 3031 2d30 3122 2c0a 2020 2020 2020  8-01-01",.      
+000479e0: 2020 290a 0a20 2020 2020 2020 2023 2074    )..        # t
+000479f0: 6573 7420 6162 7374 7261 6374 0a20 2020  est abstract.   
+00047a00: 2020 2020 2062 6962 7465 7820 3d20 280a       bibtex = (.
+00047a10: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
+00047a20: 7469 636c 657b 6162 632c 5c6e 6175 7468  ticle{abc,\nauth
+00047a30: 6f72 203d 2022 6d65 222c 5c6e 2720 2b20  or = "me",\n' + 
+00047a40: 2774 6974 6c65 203d 2022 6d79 7469 7422  'title = "mytit"
+00047a50: 2c5c 6e61 6273 7472 6163 743d 2274 7279  ,\nabstract="try
+00047a60: 222c 5c6e 7d27 0a20 2020 2020 2020 2029  ",\n}'.        )
+00047a70: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+00047a80: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
+00047a90: 7265 7061 7265 496e 7365 7274 2862 6962  repareInsert(bib
+00047aa0: 7465 7829 0a20 2020 2020 2020 2073 656c  tex).        sel
+00047ab0: 662e 6173 7365 7274 4571 7561 6c28 6461  f.assertEqual(da
+00047ac0: 7461 5b22 6162 7374 7261 6374 225d 2c20  ta["abstract"], 
+00047ad0: 2274 7279 2229 0a20 2020 2020 2020 2073  "try").        s
+00047ae0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00047af0: 0a20 2020 2020 2020 2020 2020 2061 7374  .            ast
+00047b00: 2e6c 6974 6572 616c 5f65 7661 6c28 6461  .literal_eval(da
+00047b10: 7461 5b22 6269 6264 6963 7422 5d29 2c0a  ta["bibdict"]),.
+00047b20: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00047b30: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+00047b40: 4e54 5259 5459 5045 223a 2022 6172 7469  NTRYTYPE": "arti
+00047b50: 636c 6522 2c0a 2020 2020 2020 2020 2020  cle",.          
+00047b60: 2020 2020 2020 2249 4422 3a20 2261 6263        "ID": "abc
+00047b70: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00047b80: 2020 2022 6162 7374 7261 6374 223a 2022     "abstract": "
+00047b90: 7b74 7279 7d22 2c0a 2020 2020 2020 2020  {try}",.        
+00047ba0: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
+00047bb0: 3a20 226d 6522 2c0a 2020 2020 2020 2020  : "me",.        
+00047bc0: 2020 2020 2020 2020 2274 6974 6c65 223a          "title":
+00047bd0: 2022 7b6d 7974 6974 7d22 2c0a 2020 2020   "{mytit}",.    
+00047be0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+00047bf0: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+00047c00: 656d 7074 7920 6269 6274 6578 0a20 2020  empty bibtex.   
+00047c10: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00047c20: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+00047c30: 6269 6273 2e70 7265 7061 7265 496e 7365  bibs.prepareInse
+00047c40: 7274 2822 2229 2c20 7b22 6269 626b 6579  rt(""), {"bibkey
+00047c50: 223a 2022 227d 290a 2020 2020 2020 2020  ": ""}).        
+00047c60: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
+00047c70: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
+00047c80: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
+00047c90: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00047ca0: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
+00047cb0: 7428 2222 290a 2020 2020 2020 2020 2020  t("").          
+00047cc0: 2020 5f69 2e61 7373 6572 745f 616e 795f    _i.assert_any_
+00047cd0: 6361 6c6c 2822 4e6f 2065 6c65 6d65 6e74  call("No element
+00047ce0: 7320 666f 756e 643f 2229 0a20 2020 2020  s found?").     
+00047cf0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00047d00: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
+00047d10: 6273 2e70 7265 7061 7265 496e 7365 7274  bs.prepareInsert
+00047d20: 2822 4061 7274 6963 6c65 7b61 6263 2c22  ("@article{abc,"
+00047d30: 292c 207b 2262 6962 6b65 7922 3a20 2222  ), {"bibkey": ""
+00047d40: 7d29 0a0a 2020 2020 6465 6620 7465 7374  })..    def test
+00047d50: 5f70 7265 7061 7265 5570 6461 7465 2873  _prepareUpdate(s
+00047d60: 656c 662c 202a 6172 6773 293a 0a20 2020  elf, *args):.   
+00047d70: 2020 2020 2022 2222 7465 7374 2070 7265       """test pre
+00047d80: 7061 7265 5570 6461 7465 2061 6e64 2072  pareUpdate and r
+00047d90: 656c 6174 6564 2066 756e 6374 696f 6e73  elated functions
+00047da0: 2222 220a 2020 2020 2020 2020 6269 6274  """.        bibt
+00047db0: 6578 4120 3d20 2740 6172 7469 636c 657b  exA = '@article{
+00047dc0: 6162 632c 5c6e 6175 7468 6f72 3d22 6d65  abc,\nauthor="me
+00047dd0: 222c 5c6e 7469 746c 653d 2261 6263 222c  ",\ntitle="abc",
+00047de0: 5c6e 7d27 0a20 2020 2020 2020 2062 6962  \n}'.        bib
+00047df0: 7465 7842 203d 2027 4061 7274 6963 6c65  texB = '@article
+00047e00: 7b61 6263 312c 5c6e 6175 7468 6f72 3d22  {abc1,\nauthor="
+00047e10: 6d65 222c 5c6e 7469 746c 653d 2241 4243  me",\ntitle="ABC
+00047e20: 222c 2720 2b20 275c 6e61 7278 6976 3d22  ",' + '\narxiv="
+00047e30: 3132 3334 222c 5c6e 7d27 0a20 2020 2020  1234",\n}'.     
+00047e40: 2020 2062 6962 7465 7845 203d 2022 4061     bibtexE = "@a
+00047e50: 7274 6963 6c65 7b2c 7d22 0a20 2020 2020  rticle{,}".     
+00047e60: 2020 2072 6573 756c 7441 203d 2028 0a20     resultA = (. 
+00047e70: 2020 2020 2020 2020 2020 2027 4041 7274             '@Art
+00047e80: 6963 6c65 7b61 6263 2c5c 6e20 2020 2020  icle{abc,\n     
+00047e90: 2020 2061 7574 686f 7220 3d20 226d 6522     author = "me"
+00047ea0: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
+00047eb0: 202b 2027 2020 2020 2020 2020 2074 6974   + '         tit
+00047ec0: 6c65 203d 2022 7b41 4243 7d22 2c5c 6e20  le = "{ABC}",\n 
+00047ed0: 2020 2020 2020 2020 6172 7869 7620 3d20          arxiv = 
+00047ee0: 2231 3233 3422 2c5c 6e7d 270a 2020 2020  "1234",\n}'.    
+00047ef0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00047f00: 7375 6c74 4220 3d20 280a 2020 2020 2020  sultB = (.      
+00047f10: 2020 2020 2020 2740 4172 7469 636c 657b        '@Article{
+00047f20: 6162 6331 2c5c 6e20 2020 2020 2020 2061  abc1,\n        a
+00047f30: 7574 686f 7220 3d20 226d 6522 2c5c 6e27  uthor = "me",\n'
+00047f40: 0a20 2020 2020 2020 2020 2020 202b 2027  .            + '
+00047f50: 2020 2020 2020 2020 2074 6974 6c65 203d           title =
+00047f60: 2022 7b61 6263 7d22 2c5c 6e20 2020 2020   "{abc}",\n     
+00047f70: 2020 2020 6172 7869 7620 3d20 2231 3233      arxiv = "123
+00047f80: 3422 2c5c 6e7d 270a 2020 2020 2020 2020  4",\n}'.        
+00047f90: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00047fa0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+00047fb0: 2e70 4244 422e 6269 6273 2e70 7265 7061  .pBDB.bibs.prepa
+00047fc0: 7265 5570 6461 7465 2862 6962 7465 7841  reUpdate(bibtexA
+00047fd0: 2c20 6269 6274 6578 4529 2c20 2222 290a  , bibtexE), "").
+00047fe0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00047ff0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+00048000: 4442 2e62 6962 732e 7072 6570 6172 6555  DB.bibs.prepareU
+00048010: 7064 6174 6528 6269 6274 6578 452c 2062  pdate(bibtexE, b
+00048020: 6962 7465 7841 292c 2022 2229 0a20 2020  ibtexA), "").   
+00048030: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00048040: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+00048050: 6269 6273 2e70 7265 7061 7265 5570 6461  bibs.prepareUpda
+00048060: 7465 2822 222c 2062 6962 7465 7841 292c  te("", bibtexA),
+00048070: 2022 2229 0a0a 2020 2020 2020 2020 6269   "")..        bi
+00048080: 6274 6578 203d 2073 656c 662e 7042 4442  btex = self.pBDB
+00048090: 2e62 6962 732e 7072 6570 6172 6555 7064  .bibs.prepareUpd
+000480a0: 6174 6528 6269 6274 6578 412c 2062 6962  ate(bibtexA, bib
+000480b0: 7465 7842 290a 2020 2020 2020 2020 7365  texB).        se
+000480c0: 6c66 2e61 7373 6572 7445 7175 616c 2862  lf.assertEqual(b
+000480d0: 6962 7465 782c 2072 6573 756c 7441 202b  ibtex, resultA +
+000480e0: 2022 5c6e 5c6e 2229 0a20 2020 2020 2020   "\n\n").       
+000480f0: 2062 6962 7465 7820 3d20 7365 6c66 2e70   bibtex = self.p
+00048100: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
+00048110: 5570 6461 7465 2862 6962 7465 7842 2c20  Update(bibtexB, 
+00048120: 6269 6274 6578 4129 0a20 2020 2020 2020  bibtexA).       
+00048130: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00048140: 6c28 6269 6274 6578 2c20 7265 7375 6c74  l(bibtex, result
+00048150: 4220 2b20 225c 6e5c 6e22 290a 0a20 2020  B + "\n\n")..   
+00048160: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00048170: 6962 732e 696e 7365 7274 4672 6f6d 4269  ibs.insertFromBi
+00048180: 6274 6578 2862 6962 7465 7841 290a 2020  btex(bibtexA).  
+00048190: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+000481a0: 6269 6273 2e69 6e73 6572 7446 726f 6d42  bibs.insertFromB
+000481b0: 6962 7465 7828 6269 6274 6578 4229 0a20  ibtex(bibtexB). 
+000481c0: 2020 2020 2020 2064 6174 6120 3d20 7365         data = se
+000481d0: 6c66 2e70 4244 422e 6269 6273 2e70 7265  lf.pBDB.bibs.pre
+000481e0: 7061 7265 5570 6461 7465 4279 4b65 7928  pareUpdateByKey(
+000481f0: 2261 6263 222c 2022 6162 6331 2229 0a20  "abc", "abc1"). 
+00048200: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00048210: 7274 4571 7561 6c28 6461 7461 5b22 6269  rtEqual(data["bi
+00048220: 626b 6579 225d 2c20 2261 6263 2229 0a20  bkey"], "abc"). 
+00048230: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00048240: 7274 4571 7561 6c28 6461 7461 5b22 6172  rtEqual(data["ar
+00048250: 7869 7622 5d2c 2022 3132 3334 2229 0a20  xiv"], "1234"). 
+00048260: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00048270: 7274 4571 7561 6c28 6461 7461 5b22 6269  rtEqual(data["bi
+00048280: 6274 6578 225d 2c20 7265 7375 6c74 4129  btex"], resultA)
+00048290: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+000482a0: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
+000482b0: 7265 7061 7265 5570 6461 7465 4279 4b65  repareUpdateByKe
+000482c0: 7928 2261 6263 3122 2c20 2261 6263 2229  y("abc1", "abc")
+000482d0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000482e0: 7365 7274 4571 7561 6c28 6461 7461 5b22  sertEqual(data["
+000482f0: 6269 626b 6579 225d 2c20 2261 6263 3122  bibkey"], "abc1"
+00048300: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00048310: 7373 6572 7445 7175 616c 2864 6174 615b  ssertEqual(data[
+00048320: 2261 7278 6976 225d 2c20 2231 3233 3422  "arxiv"], "1234"
+00048330: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00048340: 7373 6572 7445 7175 616c 2864 6174 615b  ssertEqual(data[
+00048350: 2262 6962 7465 7822 5d2c 2072 6573 756c  "bibtex"], resul
+00048360: 7442 290a 0a20 2020 2020 2020 2064 6174  tB)..        dat
+00048370: 6120 3d20 7365 6c66 2e70 4244 422e 6269  a = self.pBDB.bi
+00048380: 6273 2e70 7265 7061 7265 5570 6461 7465  bs.prepareUpdate
+00048390: 4279 4269 6274 6578 2822 6162 6322 2c20  ByBibtex("abc", 
+000483a0: 6269 6274 6578 4229 0a20 2020 2020 2020  bibtexB).       
 000483b0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000483c0: 6c28 6269 6274 6578 2c20 7265 7375 6c74  l(bibtex, result
-000483d0: 4220 2b20 225c 6e5c 6e22 290a 0a20 2020  B + "\n\n")..   
-000483e0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000483f0: 6962 732e 696e 7365 7274 4672 6f6d 4269  ibs.insertFromBi
-00048400: 6274 6578 2862 6962 7465 7841 290a 2020  btex(bibtexA).  
-00048410: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00048420: 6269 6273 2e69 6e73 6572 7446 726f 6d42  bibs.insertFromB
-00048430: 6962 7465 7828 6269 6274 6578 4229 0a20  ibtex(bibtexB). 
-00048440: 2020 2020 2020 2064 6174 6120 3d20 7365         data = se
-00048450: 6c66 2e70 4244 422e 6269 6273 2e70 7265  lf.pBDB.bibs.pre
-00048460: 7061 7265 5570 6461 7465 4279 4b65 7928  pareUpdateByKey(
-00048470: 2261 6263 222c 2022 6162 6331 2229 0a20  "abc", "abc1"). 
-00048480: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00048490: 7274 4571 7561 6c28 6461 7461 5b22 6269  rtEqual(data["bi
-000484a0: 626b 6579 225d 2c20 2261 6263 2229 0a20  bkey"], "abc"). 
-000484b0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000484c0: 7274 4571 7561 6c28 6461 7461 5b22 6172  rtEqual(data["ar
-000484d0: 7869 7622 5d2c 2022 3132 3334 2229 0a20  xiv"], "1234"). 
-000484e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000484f0: 7274 4571 7561 6c28 6461 7461 5b22 6269  rtEqual(data["bi
-00048500: 6274 6578 225d 2c20 7265 7375 6c74 4129  btex"], resultA)
-00048510: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00048520: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
-00048530: 7265 7061 7265 5570 6461 7465 4279 4b65  repareUpdateByKe
-00048540: 7928 2261 6263 3122 2c20 2261 6263 2229  y("abc1", "abc")
-00048550: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00048560: 7365 7274 4571 7561 6c28 6461 7461 5b22  sertEqual(data["
-00048570: 6269 626b 6579 225d 2c20 2261 6263 3122  bibkey"], "abc1"
-00048580: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00048590: 7373 6572 7445 7175 616c 2864 6174 615b  ssertEqual(data[
-000485a0: 2261 7278 6976 225d 2c20 2231 3233 3422  "arxiv"], "1234"
-000485b0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000485c0: 7373 6572 7445 7175 616c 2864 6174 615b  ssertEqual(data[
-000485d0: 2262 6962 7465 7822 5d2c 2072 6573 756c  "bibtex"], resul
-000485e0: 7442 290a 0a20 2020 2020 2020 2064 6174  tB)..        dat
-000485f0: 6120 3d20 7365 6c66 2e70 4244 422e 6269  a = self.pBDB.bi
-00048600: 6273 2e70 7265 7061 7265 5570 6461 7465  bs.prepareUpdate
-00048610: 4279 4269 6274 6578 2822 6162 6322 2c20  ByBibtex("abc", 
-00048620: 6269 6274 6578 4229 0a20 2020 2020 2020  bibtexB).       
-00048630: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00048640: 6c28 6461 7461 5b22 6269 626b 6579 225d  l(data["bibkey"]
-00048650: 2c20 2261 6263 2229 0a20 2020 2020 2020  , "abc").       
-00048660: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00048670: 6c28 6461 7461 5b22 6172 7869 7622 5d2c  l(data["arxiv"],
-00048680: 2022 3132 3334 2229 0a20 2020 2020 2020   "1234").       
-00048690: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000486a0: 6c28 6461 7461 5b22 6269 6274 6578 225d  l(data["bibtex"]
-000486b0: 2c20 7265 7375 6c74 4129 0a20 2020 2020  , resultA).     
-000486c0: 2020 2064 6174 6120 3d20 7365 6c66 2e70     data = self.p
-000486d0: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
-000486e0: 5570 6461 7465 4279 4269 6274 6578 2822  UpdateByBibtex("
-000486f0: 6162 6331 222c 2062 6962 7465 7841 290a  abc1", bibtexA).
-00048700: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00048710: 6572 7445 7175 616c 2864 6174 615b 2262  ertEqual(data["b
-00048720: 6962 6b65 7922 5d2c 2022 6162 6331 2229  ibkey"], "abc1")
-00048730: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00048740: 7365 7274 4571 7561 6c28 6461 7461 5b22  sertEqual(data["
-00048750: 6172 7869 7622 5d2c 2022 3132 3334 2229  arxiv"], "1234")
-00048760: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00048770: 7365 7274 4571 7561 6c28 6461 7461 5b22  sertEqual(data["
-00048780: 6269 6274 6578 225d 2c20 7265 7375 6c74  bibtex"], result
-00048790: 4229 0a0a 2020 2020 6465 6620 7465 7374  B)..    def test
-000487a0: 5f70 7269 6e74 416c 6c28 7365 6c66 2c20  _printAll(self, 
-000487b0: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
-000487c0: 7365 6c66 2e69 6e73 6572 745f 7468 7265  self.insert_thre
-000487d0: 6528 290a 2020 2020 2020 2020 7365 6c66  e().        self
-000487e0: 2e61 7373 6572 745f 7374 646f 7574 280a  .assert_stdout(.
-000487f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00048800: 2e70 4244 422e 6269 6273 2e70 7269 6e74  .pBDB.bibs.print
-00048810: 416c 6c42 6962 6b65 7973 2c0a 2020 2020  AllBibkeys,.    
-00048820: 2020 2020 2020 2020 2220 2020 3020 2d20          "   0 - 
-00048830: 6162 635c 6e5c 6e20 2020 3120 2d20 6465  abc\n\n   1 - de
-00048840: 665c 6e5c 6e20 2020 3220 2d20 6768 695c  f\n\n   2 - ghi\
-00048850: 6e5c 6e22 2c0a 2020 2020 2020 2020 290a  n\n",.        ).
-00048860: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00048870: 6572 745f 7374 646f 7574 280a 2020 2020  ert_stdout(.    
-00048880: 2020 2020 2020 2020 6c61 6d62 6461 3a20          lambda: 
-00048890: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
-000488a0: 7269 6e74 416c 6c42 6962 6b65 7973 280a  rintAllBibkeys(.
-000488b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000488c0: 656e 7472 6965 7349 6e3d 7365 6c66 2e70  entriesIn=self.p
-000488d0: 4244 422e 6269 6273 2e67 6574 4279 4269  BDB.bibs.getByBi
-000488e0: 626b 6579 2822 6162 6322 290a 2020 2020  bkey("abc").    
-000488f0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00048900: 2020 2020 2020 2022 2020 2030 202d 2061         "   0 - a
-00048910: 6263 5c6e 5c6e 222c 0a20 2020 2020 2020  bc\n\n",.       
-00048920: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
-00048930: 2e61 7373 6572 745f 7374 646f 7574 280a  .assert_stdout(.
-00048940: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00048950: 2e70 4244 422e 6269 6273 2e70 7269 6e74  .pBDB.bibs.print
-00048960: 416c 6c42 6962 7465 7873 2c0a 2020 2020  AllBibtexs,.    
-00048970: 2020 2020 2020 2020 2720 2020 3020 2d20          '   0 - 
-00048980: 4041 7274 6963 6c65 7b61 6263 2c5c 6e20  @Article{abc,\n 
-00048990: 2020 2020 2020 2061 7574 686f 7220 3d20         author = 
-000489a0: 226d 6522 2c5c 6e20 2020 2020 2020 2020  "me",\n         
-000489b0: 270a 2020 2020 2020 2020 2020 2020 2b20  '.            + 
-000489c0: 2774 6974 6c65 203d 2022 7b61 6263 7d22  'title = "{abc}"
-000489d0: 2c5c 6e7d 5c6e 5c6e 2020 2031 202d 2040  ,\n}\n\n   1 - @
-000489e0: 4172 7469 636c 657b 6465 662c 5c6e 2020  Article{def,\n  
-000489f0: 2020 2020 2020 270a 2020 2020 2020 2020        '.        
-00048a00: 2020 2020 2b20 2761 7574 686f 7220 3d20      + 'author = 
-00048a10: 226d 6522 2c5c 6e20 2020 2020 2020 2020  "me",\n         
-00048a20: 7469 746c 6520 3d20 227b 6465 667d 222c  title = "{def}",
-00048a30: 5c6e 7d5c 6e5c 6e20 2020 270a 2020 2020  \n}\n\n   '.    
-00048a40: 2020 2020 2020 2020 2b20 2732 202d 2040          + '2 - @
-00048a50: 4172 7469 636c 657b 6768 692c 5c6e 2020  Article{ghi,\n  
-00048a60: 2020 2020 2020 6175 7468 6f72 203d 2022        author = "
-00048a70: 6d65 222c 5c6e 2020 2020 2020 2020 2027  me",\n         '
-00048a80: 0a20 2020 2020 2020 2020 2020 202b 2027  .            + '
-00048a90: 7469 746c 6520 3d20 227b 6768 697d 222c  title = "{ghi}",
-00048aa0: 5c6e 7d5c 6e5c 6e27 2c0a 2020 2020 2020  \n}\n\n',.      
-00048ab0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00048ac0: 2e61 7373 6572 745f 7374 646f 7574 280a  .assert_stdout(.
-00048ad0: 2020 2020 2020 2020 2020 2020 6c61 6d62              lamb
-00048ae0: 6461 3a20 7365 6c66 2e70 4244 422e 6269  da: self.pBDB.bi
-00048af0: 6273 2e70 7269 6e74 416c 6c42 6962 7465  bs.printAllBibte
-00048b00: 7873 280a 2020 2020 2020 2020 2020 2020  xs(.            
-00048b10: 2020 2020 656e 7472 6965 7349 6e3d 7365      entriesIn=se
-00048b20: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-00048b30: 4279 4269 626b 6579 2822 6162 6322 290a  ByBibkey("abc").
-00048b40: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-00048b50: 2020 2020 2020 2020 2020 2027 2020 2030             '   0
-00048b60: 202d 2040 4172 7469 636c 657b 6162 632c   - @Article{abc,
-00048b70: 5c6e 2020 2020 2020 2020 6175 7468 6f72  \n        author
-00048b80: 203d 2022 6d65 222c 5c6e 2020 2020 2020   = "me",\n      
-00048b90: 2020 2027 0a20 2020 2020 2020 2020 2020     '.           
-00048ba0: 202b 2027 7469 746c 6520 3d20 227b 6162   + 'title = "{ab
-00048bb0: 637d 222c 5c6e 7d5c 6e5c 6e27 2c0a 2020  c}",\n}\n\n',.  
-00048bc0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00048bd0: 2074 6f64 6179 203d 2064 6174 6574 696d   today = datetim
-00048be0: 652e 6461 7465 2e74 6f64 6179 2829 2e73  e.date.today().s
-00048bf0: 7472 6674 696d 6528 2225 592d 256d 2d25  trftime("%Y-%m-%
-00048c00: 6422 290a 2020 2020 2020 2020 7365 6c66  d").        self
-00048c10: 2e70 4244 422e 6269 6273 2e73 6574 5265  .pBDB.bibs.setRe
-00048c20: 7669 6577 2822 6162 6322 290a 2020 2020  view("abc").    
-00048c30: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00048c40: 6273 2e75 7064 6174 6546 6965 6c64 2822  bs.updateField("
-00048c50: 6162 6322 2c20 2261 7278 6976 222c 2022  abc", "arxiv", "
-00048c60: 3132 3334 2229 0a20 2020 2020 2020 2073  1234").        s
-00048c70: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
-00048c80: 6461 7465 4669 656c 6428 2261 6263 222c  dateField("abc",
-00048c90: 2022 646f 6922 2c20 2273 6f6d 6564 6f69   "doi", "somedoi
-00048ca0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00048cb0: 7042 4442 2e62 6962 732e 7072 696e 7441  pBDB.bibs.printA
-00048cc0: 6c6c 496e 666f 2829 0a20 2020 2020 2020  llInfo().       
-00048cd0: 2073 656c 662e 6173 7365 7274 5f73 7464   self.assert_std
-00048ce0: 6f75 7428 0a20 2020 2020 2020 2020 2020  out(.           
-00048cf0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00048d00: 7072 696e 7441 6c6c 496e 666f 2c0a 2020  printAllInfo,.  
-00048d10: 2020 2020 2020 2020 2020 225b 2020 2030            "[   0
-00048d20: 202d 2022 0a20 2020 2020 2020 2020 2020   - ".           
-00048d30: 202b 2074 6f64 6179 0a20 2020 2020 2020   + today.       
-00048d40: 2020 2020 202b 2022 205d 2020 2872 6576       + " ]  (rev
-00048d50: 2920 6162 6320 2020 2020 2020 2020 2020  ) abc           
-00048d60: 2020 220a 2020 2020 2020 2020 2020 2020    ".            
-00048d70: 2b20 2220 2020 2020 2020 2020 2020 2020  + "             
-00048d80: 2020 3132 3334 2020 2020 2020 2020 2020    1234          
-00048d90: 2020 2020 2020 2073 6f6d 6564 6f69 2020         somedoi  
-00048da0: 2020 2020 2020 2020 2020 2022 0a20 2020             ".   
-00048db0: 2020 2020 2020 2020 202b 2022 5c6e 5b20           + "\n[ 
-00048dc0: 2020 3120 2d20 220a 2020 2020 2020 2020    1 - ".        
-00048dd0: 2020 2020 2b20 746f 6461 790a 2020 2020      + today.    
-00048de0: 2020 2020 2020 2020 2b20 2220 5d20 2020          + " ]   
-00048df0: 2020 2020 2064 6566 2020 2020 2020 2020       def        
-00048e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048e10: 220a 2020 2020 2020 2020 2020 2020 2b20  ".            + 
-00048e20: 2220 2020 2064 6566 2020 2020 2020 2020  "    def        
-00048e30: 2020 2020 2020 2020 2020 2d20 2020 2020            -     
-00048e40: 2020 2020 2020 2020 2020 2020 2020 220a                ".
-00048e50: 2020 2020 2020 2020 2020 2020 2b20 225c              + "\
-00048e60: 6e5b 2020 2032 202d 2022 0a20 2020 2020  n[   2 - ".     
-00048e70: 2020 2020 2020 202b 2074 6f64 6179 0a20         + today. 
-00048e80: 2020 2020 2020 2020 2020 202b 2022 205d             + " ]
-00048e90: 2020 2020 2020 2020 6768 6920 2020 2020          ghi     
-00048ea0: 2020 2020 2020 220a 2020 2020 2020 2020        ".        
-00048eb0: 2020 2020 2b20 2220 2020 2020 2020 2020      + "         
-00048ec0: 2020 2020 2020 2020 6768 6920 2020 2020          ghi     
-00048ed0: 2020 2020 2020 2020 2020 2020 202d 2020               -  
-00048ee0: 2020 2020 2022 0a20 2020 2020 2020 2020       ".         
-00048ef0: 2020 202b 2022 2020 2020 2020 2020 2020     + "          
-00048f00: 2020 5c6e 222c 0a20 2020 2020 2020 2029    \n",.        )
-00048f10: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-00048f20: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
-00048f30: 656c 6428 2267 6869 222c 2022 6669 7273  eld("ghi", "firs
-00048f40: 7464 6174 6522 2c20 2232 3031 382d 3031  tdate", "2018-01
-00048f50: 2d30 3122 290a 2020 2020 2020 2020 7365  -01").        se
-00048f60: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-00048f70: 6174 6546 6965 6c64 2822 6465 6622 2c20  ateField("def", 
-00048f80: 2266 6972 7374 6461 7465 222c 2022 3230  "firstdate", "20
-00048f90: 3138 2d30 332d 3031 2229 0a20 2020 2020  18-03-01").     
-00048fa0: 2020 2073 656c 662e 6173 7365 7274 5f73     self.assert_s
-00048fb0: 7464 6f75 7428 0a20 2020 2020 2020 2020  tdout(.         
-00048fc0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00048fd0: 732e 7072 696e 7441 6c6c 496e 666f 2c0a  s.printAllInfo,.
-00048fe0: 2020 2020 2020 2020 2020 2020 225b 2020              "[  
-00048ff0: 2030 202d 2032 3031 382d 3031 2d30 3120   0 - 2018-01-01 
-00049000: 5d20 2020 2020 2020 2067 6869 2020 2020  ]        ghi    
-00049010: 2020 2020 2020 2020 2020 2020 2022 0a20               ". 
-00049020: 2020 2020 2020 2020 2020 202b 2022 2020             + "  
-00049030: 2020 2020 2020 2020 2067 6869 2020 2020           ghi    
-00049040: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-00049050: 2020 2020 2020 2020 2020 2020 220a 2020              ".  
-00049060: 2020 2020 2020 2020 2020 2b20 2220 2020            + "   
-00049070: 2020 205c 6e5b 2020 2031 202d 2032 3031     \n[   1 - 201
-00049080: 382d 3033 2d30 3120 5d20 2020 2020 2020  8-03-01 ]       
-00049090: 2022 0a20 2020 2020 2020 2020 2020 202b   ".            +
-000490a0: 2022 6465 6620 2020 2020 2020 2020 2020   "def           
-000490b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000490c0: 2064 6566 2020 2020 2020 2020 2020 2020   def            
-000490d0: 220a 2020 2020 2020 2020 2020 2020 2b20  ".            + 
-000490e0: 2220 2020 2020 202d 2020 2020 2020 2020  "      -        
-000490f0: 2020 2020 2020 2020 2020 205c 6e5b 2020             \n[  
-00049100: 2032 202d 2022 0a20 2020 2020 2020 2020   2 - ".         
-00049110: 2020 202b 2074 6f64 6179 0a20 2020 2020     + today.     
-00049120: 2020 2020 2020 202b 2022 205d 220a 2020         + " ]".  
-00049130: 2020 2020 2020 2020 2020 2b20 2220 2028            + "  (
-00049140: 7265 7629 2061 6263 2020 2020 2020 2020  rev) abc        
-00049150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049160: 2020 2020 3132 3334 2020 2020 220a 2020      1234    ".  
-00049170: 2020 2020 2020 2020 2020 2b20 2220 2020            + "   
-00049180: 2020 2020 2020 2020 2020 736f 6d65 646f            somedo
-00049190: 6920 2020 2020 2020 2020 2020 2020 5c6e  i             \n
-000491a0: 222c 0a20 2020 2020 2020 2029 0a20 2020  ",.        ).   
-000491b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000491c0: 5f73 7464 6f75 7428 0a20 2020 2020 2020  _stdout(.       
-000491d0: 2020 2020 206c 616d 6264 613a 2073 656c       lambda: sel
-000491e0: 662e 7042 4442 2e62 6962 732e 7072 696e  f.pBDB.bibs.prin
-000491f0: 7441 6c6c 496e 666f 280a 2020 2020 2020  tAllInfo(.      
-00049200: 2020 2020 2020 2020 2020 656e 7472 6965            entrie
-00049210: 7349 6e3d 7365 6c66 2e70 4244 422e 6269  sIn=self.pBDB.bi
-00049220: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
-00049230: 6162 6322 290a 2020 2020 2020 2020 2020  abc").          
-00049240: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-00049250: 2022 5b20 2020 3020 2d20 220a 2020 2020   "[   0 - ".    
-00049260: 2020 2020 2020 2020 2b20 746f 6461 790a          + today.
-00049270: 2020 2020 2020 2020 2020 2020 2b20 2220              + " 
-00049280: 5d20 2028 7265 7629 2061 6263 2020 2020  ]  (rev) abc    
-00049290: 2020 2020 2020 2022 0a20 2020 2020 2020         ".       
-000492a0: 2020 2020 202b 2022 2020 2020 2020 2020       + "        
-000492b0: 2020 2020 2020 2020 2031 3233 3420 2020           1234   
-000492c0: 2020 2020 2020 2020 2020 2020 2020 736f                so
-000492d0: 6d65 646f 6920 2020 2022 0a20 2020 2020  medoi    ".     
-000492e0: 2020 2020 2020 202b 2022 2020 2020 2020         + "      
-000492f0: 2020 205c 6e22 2c0a 2020 2020 2020 2020     \n",.        
-00049300: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00049310: 7373 6572 745f 7374 646f 7574 280a 2020  ssert_stdout(.  
-00049320: 2020 2020 2020 2020 2020 6c61 6d62 6461            lambda
-00049330: 3a20 7365 6c66 2e70 4244 422e 6269 6273  : self.pBDB.bibs
-00049340: 2e70 7269 6e74 416c 6c49 6e66 6f28 0a20  .printAllInfo(. 
-00049350: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00049360: 6e74 7269 6573 496e 3d73 656c 662e 7042  ntriesIn=self.pB
-00049370: 4442 2e62 6962 732e 6765 7442 7942 6962  DB.bibs.getByBib
-00049380: 6b65 7928 2261 6263 2229 2c20 6164 6446  key("abc"), addF
-00049390: 6965 6c64 733d 2261 7574 686f 7222 0a20  ields="author". 
-000493a0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-000493b0: 2020 2020 2020 2020 2020 225b 2020 2030            "[   0
-000493c0: 202d 2022 0a20 2020 2020 2020 2020 2020   - ".           
-000493d0: 202b 2074 6f64 6179 0a20 2020 2020 2020   + today.       
-000493e0: 2020 2020 202b 2022 205d 2020 2872 6576       + " ]  (rev
-000493f0: 2920 6162 6320 2020 2020 2020 2020 2020  ) abc           
-00049400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049410: 220a 2020 2020 2020 2020 2020 2020 2b20  ".            + 
-00049420: 2220 3132 3334 2020 2020 2020 2020 2020  " 1234          
-00049430: 2020 2020 2020 2073 6f6d 6564 6f69 2020         somedoi  
-00049440: 2020 2020 2020 2020 2020 205c 6e20 2020             \n   
-00049450: 220a 2020 2020 2020 2020 2020 2020 2b20  ".            + 
-00049460: 2261 7574 686f 723a 206d 655c 6e22 2c0a  "author: me\n",.
-00049470: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00049480: 2020 7365 6c66 2e61 7373 6572 745f 7374    self.assert_st
-00049490: 646f 7574 280a 2020 2020 2020 2020 2020  dout(.          
-000494a0: 2020 6c61 6d62 6461 3a20 7365 6c66 2e70    lambda: self.p
-000494b0: 4244 422e 6269 6273 2e70 7269 6e74 416c  BDB.bibs.printAl
-000494c0: 6c49 6e66 6f28 0a20 2020 2020 2020 2020  lInfo(.         
-000494d0: 2020 2020 2020 2065 6e74 7269 6573 496e         entriesIn
-000494e0: 3d73 656c 662e 7042 4442 2e62 6962 732e  =self.pBDB.bibs.
-000494f0: 6765 7442 7942 6962 6b65 7928 2261 6263  getByBibkey("abc
-00049500: 2229 2c20 6164 6446 6965 6c64 733d 5b22  "), addFields=["
-00049510: 6175 7468 6f72 225d 0a20 2020 2020 2020  author"].       
-00049520: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00049530: 2020 2020 225b 2020 2030 202d 2022 0a20      "[   0 - ". 
-00049540: 2020 2020 2020 2020 2020 202b 2074 6f64             + tod
-00049550: 6179 0a20 2020 2020 2020 2020 2020 202b  ay.            +
-00049560: 2022 205d 2020 2872 6576 2920 6162 6320   " ]  (rev) abc 
-00049570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049580: 2020 2020 2020 2020 2020 2022 0a20 2020             ".   
-00049590: 2020 2020 2020 2020 202b 2022 3132 3334           + "1234
-000495a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000495b0: 2073 6f6d 6564 6f69 2020 2020 2020 2020   somedoi        
-000495c0: 2020 2020 205c 6e20 2020 6175 7468 6f72       \n   author
-000495d0: 3a20 6d65 220a 2020 2020 2020 2020 2020  : me".          
-000495e0: 2020 2b20 225c 6e22 2c0a 2020 2020 2020    + "\n",.      
-000495f0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00049600: 2e61 7373 6572 745f 7374 646f 7574 280a  .assert_stdout(.
-00049610: 2020 2020 2020 2020 2020 2020 6c61 6d62              lamb
-00049620: 6461 3a20 7365 6c66 2e70 4244 422e 6269  da: self.pBDB.bi
-00049630: 6273 2e70 7269 6e74 416c 6c49 6e66 6f28  bs.printAllInfo(
-00049640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00049650: 2065 6e74 7269 6573 496e 3d73 656c 662e   entriesIn=self.
-00049660: 7042 4442 2e62 6962 732e 6765 7442 7942  pBDB.bibs.getByB
-00049670: 6962 6b65 7928 2261 6263 2229 2c20 6164  ibkey("abc"), ad
-00049680: 6446 6965 6c64 733d 2274 6974 6c65 220a  dFields="title".
-00049690: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-000496a0: 2020 2020 2020 2020 2020 2022 5b20 2020             "[   
-000496b0: 3020 2d20 220a 2020 2020 2020 2020 2020  0 - ".          
-000496c0: 2020 2b20 746f 6461 790a 2020 2020 2020    + today.      
-000496d0: 2020 2020 2020 2b20 2220 5d20 2028 7265        + " ]  (re
-000496e0: 7629 2061 6263 2020 2020 2020 2020 2020  v) abc          
-000496f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00049700: 0a20 2020 2020 2020 2020 2020 202b 2022  .            + "
-00049710: 2020 2031 3233 3420 2020 2020 2020 2020     1234         
-00049720: 2020 2020 2020 2020 736f 6d65 646f 6920          somedoi 
-00049730: 2020 2020 2020 2020 2020 2020 5c6e 2020              \n  
-00049740: 2022 0a20 2020 2020 2020 2020 2020 202b   ".            +
-00049750: 2022 7469 746c 653a 207b 6162 637d 5c6e   "title: {abc}\n
-00049760: 222c 0a20 2020 2020 2020 2029 0a20 2020  ",.        ).   
-00049770: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00049780: 5f73 7464 6f75 7428 0a20 2020 2020 2020  _stdout(.       
-00049790: 2020 2020 206c 616d 6264 613a 2073 656c       lambda: sel
-000497a0: 662e 7042 4442 2e62 6962 732e 7072 696e  f.pBDB.bibs.prin
-000497b0: 7441 6c6c 496e 666f 280a 2020 2020 2020  tAllInfo(.      
-000497c0: 2020 2020 2020 2020 2020 656e 7472 6965            entrie
-000497d0: 7349 6e3d 7365 6c66 2e70 4244 422e 6269  sIn=self.pBDB.bi
-000497e0: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
-000497f0: 6162 6322 292c 0a20 2020 2020 2020 2020  abc"),.         
-00049800: 2020 2020 2020 2061 6464 4669 656c 6473         addFields
-00049810: 3d5b 2265 7072 696e 7422 2c20 226a 6f75  =["eprint", "jou
-00049820: 726e 616c 7322 5d2c 0a20 2020 2020 2020  rnals"],.       
-00049830: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00049840: 2020 2020 225b 2020 2030 202d 2022 0a20      "[   0 - ". 
-00049850: 2020 2020 2020 2020 2020 202b 2074 6f64             + tod
-00049860: 6179 0a20 2020 2020 2020 2020 2020 202b  ay.            +
-00049870: 2022 205d 2020 2872 6576 2920 6162 6320   " ]  (rev) abc 
-00049880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049890: 2020 2020 2020 2020 2022 0a20 2020 2020           ".     
-000498a0: 2020 2020 2020 202b 2022 2020 3132 3334         + "  1234
-000498b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000498c0: 2073 6f6d 6564 6f69 2020 2020 2020 2020   somedoi        
-000498d0: 2020 2020 205c 6e22 2c0a 2020 2020 2020       \n",.      
-000498e0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-000498f0: 745f 7265 6164 456e 7472 6965 7328 7365  t_readEntries(se
-00049900: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
-00049910: 2020 2020 2222 2274 6573 7420 7265 6164      """test read
-00049920: 456e 7472 6965 7322 2222 0a20 2020 2020  Entries""".     
-00049930: 2020 2072 6573 203d 204d 6167 6963 4d6f     res = MagicMo
-00049940: 636b 2829 0a20 2020 2020 2020 2072 6573  ck().        res
-00049950: 2e65 6e74 7269 6573 203d 205b 5d0a 2020  .entries = [].  
-00049960: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00049970: 2822 6269 6274 6578 7061 7273 6572 2e62  ("bibtexparser.b
-00049980: 7061 7273 6572 2e42 6962 5465 7850 6172  parser.BibTexPar
-00049990: 7365 722e 7061 7273 6522 2c20 7265 7475  ser.parse", retu
-000499a0: 726e 5f76 616c 7565 3d72 6573 2920 6173  rn_value=res) as
-000499b0: 205f 663a 0a20 2020 2020 2020 2020 2020   _f:.           
-000499c0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000499d0: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
-000499e0: 2e72 6561 6445 6e74 7269 6573 2822 6162  .readEntries("ab
-000499f0: 6322 292c 205b 5d29 0a20 2020 2020 2020  c"), []).       
-00049a00: 2020 2020 205f 662e 6173 7365 7274 5f63       _f.assert_c
-00049a10: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00049a20: 2261 6263 2229 0a20 2020 2020 2020 2020  "abc").         
-00049a30: 2020 2072 6573 2e65 6e74 7269 6573 203d     res.entries =
-00049a40: 205b 7b22 6122 3a20 2262 227d 5d0a 2020   [{"a": "b"}].  
-00049a50: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00049a60: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-00049a70: 7042 4442 2e62 6962 732e 7265 6164 456e  pBDB.bibs.readEn
-00049a80: 7472 6965 7328 2261 6263 2229 2c20 5b7b  tries("abc"), [{
-00049a90: 2261 223a 2022 6222 7d5d 290a 2020 2020  "a": "b"}]).    
-00049aa0: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
-00049ab0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-00049ac0: 7465 7870 6172 7365 722e 6270 6172 7365  texparser.bparse
-00049ad0: 722e 4269 6254 6578 5061 7273 6572 2e70  r.BibTexParser.p
-00049ae0: 6172 7365 222c 2073 6964 655f 6566 6665  arse", side_effe
-00049af0: 6374 3d56 616c 7565 4572 726f 720a 2020  ct=ValueError.  
-00049b00: 2020 2020 2020 2920 6173 205f 663a 0a20        ) as _f:. 
-00049b10: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00049b20: 7365 6c66 2e61 7373 6572 7452 6169 7365  self.assertRaise
-00049b30: 7328 5661 6c75 6545 7272 6f72 293a 0a20  s(ValueError):. 
-00049b40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00049b50: 656c 662e 7042 4442 2e62 6962 732e 7265  elf.pBDB.bibs.re
-00049b60: 6164 456e 7472 6965 7328 2261 6263 2229  adEntries("abc")
-00049b70: 0a0a 2020 2020 6465 6620 7465 7374 5f72  ..    def test_r
-00049b80: 6561 6445 6e74 7279 2873 656c 662c 202a  eadEntry(self, *
-00049b90: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00049ba0: 2222 7465 7374 2072 6561 6445 6e74 7279  ""test readEntry
-00049bb0: 2222 220a 2020 2020 2020 2020 7769 7468  """.        with
-00049bc0: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-00049bd0: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-00049be0: 6461 7461 6261 7365 2e45 6e74 7269 6573  database.Entries
-00049bf0: 2e72 6561 6445 6e74 7269 6573 222c 0a20  .readEntries",. 
-00049c00: 2020 2020 2020 2020 2020 2073 6964 655f             side_
-00049c10: 6566 6665 6374 3d5b 3132 332c 207b 2261  effect=[123, {"a
-00049c20: 6263 227d 2c20 5b5d 2c20 5b7b 2261 223a  bc"}, [], [{"a":
-00049c30: 2022 6222 7d5d 5d2c 0a20 2020 2020 2020   "b"}]],.       
-00049c40: 2029 2061 7320 5f66 3a0a 2020 2020 2020   ) as _f:.      
-00049c50: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
-00049c60: 6173 7365 7274 5261 6973 6573 2854 7970  assertRaises(Typ
-00049c70: 6545 7272 6f72 293a 0a20 2020 2020 2020  eError):.       
-00049c80: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-00049c90: 4442 2e62 6962 732e 7265 6164 456e 7472  DB.bibs.readEntr
-00049ca0: 7928 2261 6263 2229 0a20 2020 2020 2020  y("abc").       
-00049cb0: 2020 2020 2020 2020 205f 662e 6173 7365           _f.asse
-00049cc0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-00049cd0: 6974 6828 2261 6263 2229 0a20 2020 2020  ith("abc").     
-00049ce0: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
-00049cf0: 2e61 7373 6572 7452 6169 7365 7328 5479  .assertRaises(Ty
-00049d00: 7065 4572 726f 7229 3a0a 2020 2020 2020  peError):.      
-00049d10: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00049d20: 4244 422e 6269 6273 2e72 6561 6445 6e74  BDB.bibs.readEnt
-00049d30: 7279 2822 6162 6322 290a 2020 2020 2020  ry("abc").      
-00049d40: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
-00049d50: 6173 7365 7274 5261 6973 6573 2849 6e64  assertRaises(Ind
-00049d60: 6578 4572 726f 7229 3a0a 2020 2020 2020  exError):.      
-00049d70: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00049d80: 4244 422e 6269 6273 2e72 6561 6445 6e74  BDB.bibs.readEnt
-00049d90: 7279 2822 6162 6322 290a 2020 2020 2020  ry("abc").      
-00049da0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00049db0: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
-00049dc0: 2e62 6962 732e 7265 6164 456e 7472 7928  .bibs.readEntry(
-00049dd0: 2261 6263 2229 2c20 7b22 6122 3a20 2262  "abc"), {"a": "b
-00049de0: 227d 290a 0a20 2020 2064 6566 2074 6573  "})..    def tes
-00049df0: 745f 7265 706c 6163 6528 7365 6c66 2c20  t_replace(self, 
-00049e00: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
-00049e10: 2222 2274 6573 7420 7265 706c 6163 6520  """test replace 
-00049e20: 6675 6e63 7469 6f6e 7322 2222 0a20 2020  functions""".   
-00049e30: 2020 2020 2023 2072 6570 6c61 6365 496e       # replaceIn
-00049e40: 4269 6274 6578 0a20 2020 2020 2020 2062  Bibtex.        b
-00049e50: 6962 7465 7849 6e20 3d20 280a 2020 2020  ibtexIn = (.    
-00049e60: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
-00049e70: 657b 6162 632c 5c6e 6175 7468 6f72 203d  e{abc,\nauthor =
-00049e80: 2022 6d65 222c 5c6e 270a 2020 2020 2020   "me",\n'.      
-00049e90: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
-00049ea0: 2022 6162 6322 2c5c 6e6a 6f75 726e 616c   "abc",\njournal
-00049eb0: 3d22 6a63 6170 222c 5c6e 766f 6c75 6d65  ="jcap",\nvolume
-00049ec0: 3d22 3138 3033 222c 5c6e 270a 2020 2020  ="1803",\n'.    
-00049ed0: 2020 2020 2020 2020 2b20 2779 6561 723d          + 'year=
-00049ee0: 2232 3031 3822 2c5c 6e70 6167 6573 3d22  "2018",\npages="
-00049ef0: 3122 2c5c 6e61 7278 6976 3d22 3132 3334  1",\narxiv="1234
-00049f00: 2e35 3637 3839 222c 5c6e 7d27 0a20 2020  .56789",\n}'.   
-00049f10: 2020 2020 2029 0a20 2020 2020 2020 2062       ).        b
-00049f20: 6962 7465 784f 7574 203d 2028 0a20 2020  ibtexOut = (.   
-00049f30: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
-00049f40: 6c65 7b61 6263 2c5c 6e61 7574 686f 7220  le{abc,\nauthor 
-00049f50: 3d20 226d 6522 2c5c 6e27 0a20 2020 2020  = "me",\n'.     
-00049f60: 2020 2020 2020 202b 2027 7469 746c 6520         + 'title 
-00049f70: 3d20 2261 6263 222c 5c6e 6a6f 7572 6e61  = "abc",\njourna
-00049f80: 6c3d 226a 6361 7022 2c5c 6e76 6f6c 756d  l="jcap",\nvolum
-00049f90: 653d 2231 3830 3322 2c5c 6e27 0a20 2020  e="1803",\n'.   
-00049fa0: 2020 2020 2020 2020 202b 2027 7965 6172           + 'year
-00049fb0: 3d22 3230 3138 222c 5c6e 7061 6765 733d  ="2018",\npages=
-00049fc0: 2231 222c 5c6e 6172 7869 763d 2231 3233  "1",\narxiv="123
-00049fd0: 342e 3536 3738 3922 2c5c 6e7d 270a 2020  4.56789",\n}'.  
-00049fe0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00049ff0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-0004a000: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
-0004a010: 6e73 6572 7446 726f 6d42 6962 7465 7828  nsertFromBibtex(
-0004a020: 6269 6274 6578 496e 2929 0a20 2020 2020  bibtexIn)).     
-0004a030: 2020 2062 6962 7465 784f 7574 203d 2073     bibtexOut = s
-0004a040: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0004a050: 7446 6965 6c64 2822 6162 6322 2c20 2262  tField("abc", "b
-0004a060: 6962 7465 7822 290a 2020 2020 2020 2020  ibtex").        
-0004a070: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0004a080: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-0004a090: 7265 706c 6163 6549 6e42 6962 7465 7828  replaceInBibtex(
-0004a0a0: 2261 6263 6422 2c20 2261 6263 6465 2229  "abcd", "abcde")
-0004a0b0: 2c20 5b5d 290a 2020 2020 2020 2020 7365  , []).        se
-0004a0c0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-0004a0d0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0004a0e0: 7446 6965 6c64 2822 6162 6322 2c20 2262  tField("abc", "b
-0004a0f0: 6962 7465 7822 292c 2062 6962 7465 784f  ibtex"), bibtexO
-0004a100: 7574 290a 2020 2020 2020 2020 7365 6c66  ut).        self
-0004a110: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-0004a120: 662e 7042 4442 2e62 6962 732e 7265 706c  f.pBDB.bibs.repl
-0004a130: 6163 6549 6e42 6962 7465 7828 226a 6361  aceInBibtex("jca
-0004a140: 7022 2c20 224a 4341 5022 292c 205b 2261  p", "JCAP"), ["a
-0004a150: 6263 225d 290a 2020 2020 2020 2020 7365  bc"]).        se
-0004a160: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0004a170: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0004a180: 2e70 4244 422e 6269 6273 2e67 6574 4669  .pBDB.bibs.getFi
-0004a190: 656c 6428 2261 6263 222c 2022 6269 6274  eld("abc", "bibt
-0004a1a0: 6578 2229 2c20 6269 6274 6578 4f75 742e  ex"), bibtexOut.
-0004a1b0: 7265 706c 6163 6528 226a 6361 7022 2c20  replace("jcap", 
-0004a1c0: 224a 4341 5022 290a 2020 2020 2020 2020  "JCAP").        
-0004a1d0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0004a1e0: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-0004a1f0: 7042 4442 2e62 6962 732e 7265 706c 6163  pBDB.bibs.replac
-0004a200: 6549 6e42 6962 7465 7828 224a 4341 5022  eInBibtex("JCAP"
-0004a210: 2c20 226a 6361 7022 292c 205b 2261 6263  , "jcap"), ["abc
-0004a220: 225d 290a 0a20 2020 2020 2020 2073 656c  "])..        sel
-0004a230: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-0004a240: 6c66 2e70 4244 422e 6269 6273 2e72 6570  lf.pBDB.bibs.rep
-0004a250: 6c61 6365 496e 4269 6274 6578 2822 6a63  laceInBibtex("jc
-0004a260: 6170 222c 205b 224a 4341 5022 5d29 2c20  ap", ["JCAP"]), 
-0004a270: 4661 6c73 6529 0a20 2020 2020 2020 2073  False).        s
-0004a280: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0004a290: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
-0004a2a0: 6574 4669 656c 6428 2261 6263 222c 2022  etField("abc", "
-0004a2b0: 6269 6274 6578 2229 2c20 6269 6274 6578  bibtex"), bibtex
-0004a2c0: 4f75 7429 0a20 2020 2020 2020 2077 6974  Out).        wit
-0004a2d0: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
-0004a2e0: 2e4c 6f67 6765 722e 6578 6365 7074 696f  .Logger.exceptio
-0004a2f0: 6e22 2920 6173 205f 653a 0a20 2020 2020  n") as _e:.     
-0004a300: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0004a310: 2e62 6962 732e 7265 706c 6163 6549 6e42  .bibs.replaceInB
-0004a320: 6962 7465 7828 226a 6361 7022 2c20 5b22  ibtex("jcap", ["
-0004a330: 4a43 4150 225d 290a 2020 2020 2020 2020  JCAP"]).        
-0004a340: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-0004a350: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-0004a360: 2020 2022 4572 726f 7220 6269 6e64 696e     "Error bindin
-0004a370: 6720 7061 7261 6d65 7465 7220 3a6e 6577  g parameter :new
-0004a380: 202d 2022 202b 2022 7072 6f62 6162 6c79   - " + "probably
-0004a390: 2075 6e73 7570 706f 7274 6564 2074 7970   unsupported typ
-0004a3a0: 652e 222c 0a20 2020 2020 2020 2020 2020  e.",.           
-0004a3b0: 2020 2020 205f 652e 6361 6c6c 5f61 7267       _e.call_arg
-0004a3c0: 735b 305d 5b30 5d2c 0a20 2020 2020 2020  s[0][0],.       
-0004a3d0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-0004a3e0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0004a3f0: 7365 6c66 2e70 4244 422e 6269 6273 2e72  self.pBDB.bibs.r
-0004a400: 6570 6c61 6365 496e 4269 6274 6578 285b  eplaceInBibtex([
-0004a410: 226a 6361 7022 5d2c 2022 4a43 4150 2229  "jcap"], "JCAP")
-0004a420: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
-0004a430: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0004a440: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
-0004a450: 2e67 6574 4669 656c 6428 2261 6263 222c  .getField("abc",
-0004a460: 2022 6269 6274 6578 2229 2c20 6269 6274   "bibtex"), bibt
-0004a470: 6578 4f75 7429 0a20 2020 2020 2020 2077  exOut).        w
-0004a480: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
-0004a490: 6e67 2e4c 6f67 6765 722e 6578 6365 7074  ng.Logger.except
-0004a4a0: 696f 6e22 2920 6173 205f 653a 0a20 2020  ion") as _e:.   
-0004a4b0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0004a4c0: 4442 2e62 6962 732e 7265 706c 6163 6549  DB.bibs.replaceI
-0004a4d0: 6e42 6962 7465 7828 5b22 6a63 6170 225d  nBibtex(["jcap"]
-0004a4e0: 2c20 224a 4341 5022 290a 2020 2020 2020  , "JCAP").      
-0004a4f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0004a500: 7449 6e28 0a20 2020 2020 2020 2020 2020  tIn(.           
-0004a510: 2020 2020 2022 4572 726f 7220 6269 6e64       "Error bind
-0004a520: 696e 6720 7061 7261 6d65 7465 7220 3a6f  ing parameter :o
-0004a530: 6c64 202d 2022 202b 2022 7072 6f62 6162  ld - " + "probab
-0004a540: 6c79 2075 6e73 7570 706f 7274 6564 2074  ly unsupported t
-0004a550: 7970 652e 222c 0a20 2020 2020 2020 2020  ype.",.         
-0004a560: 2020 2020 2020 205f 652e 6361 6c6c 5f61         _e.call_a
-0004a570: 7267 735b 305d 5b30 5d2c 0a20 2020 2020  rgs[0][0],.     
-0004a580: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0004a590: 2020 2320 7265 706c 6163 650a 2020 2020    # replace.    
-0004a5a0: 2020 2020 6269 6274 6578 4f75 7420 3d20      bibtexOut = 
-0004a5b0: 280a 2020 2020 2020 2020 2020 2020 2740  (.            '@
-0004a5c0: 4172 7469 636c 657b 6162 632c 5c6e 2020  Article{abc,\n  
-0004a5d0: 2020 2020 2020 6175 7468 6f72 203d 2022        author = "
-0004a5e0: 6d65 222c 5c6e 2020 2020 2020 2020 2027  me",\n         '
-0004a5f0: 0a20 2020 2020 2020 2020 2020 202b 2027  .            + '
-0004a600: 7469 746c 6520 3d20 227b 6162 637d 222c  title = "{abc}",
-0004a610: 5c6e 2020 2020 2020 206a 6f75 726e 616c  \n       journal
-0004a620: 203d 2022 6a63 6170 222c 5c6e 2020 2020   = "jcap",\n    
-0004a630: 2020 2020 270a 2020 2020 2020 2020 2020      '.          
-0004a640: 2020 2b20 2776 6f6c 756d 6520 3d20 2231    + 'volume = "1
-0004a650: 3830 3322 2c5c 6e20 2020 2020 2020 2020  803",\n         
-0004a660: 2079 6561 7220 3d20 2232 3031 3822 2c5c   year = "2018",\
-0004a670: 6e20 2020 2020 2020 2020 270a 2020 2020  n         '.    
-0004a680: 2020 2020 2020 2020 2b20 2770 6167 6573          + 'pages
-0004a690: 203d 2022 3122 2c5c 6e20 2020 2020 2020   = "1",\n       
-0004a6a0: 2020 6172 7869 7620 3d20 2231 3233 342e    arxiv = "1234.
-0004a6b0: 3536 3738 3922 2c5c 6e7d 270a 2020 2020  56789",\n}'.    
-0004a6c0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0004a6d0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0004a6e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0004a6f0: 2e70 4244 422e 6269 6273 2e72 6570 6c61  .pBDB.bibs.repla
-0004a700: 6365 2822 6269 6274 6578 222c 205b 2262  ce("bibtex", ["b
-0004a710: 6962 7465 7822 5d2c 2022 6162 6364 222c  ibtex"], "abcd",
-0004a720: 205b 2261 6263 6465 225d 292c 0a20 2020   ["abcde"]),.   
-0004a730: 2020 2020 2020 2020 2028 5b22 6162 6322           (["abc"
-0004a740: 5d2c 205b 5d2c 205b 5d29 2c0a 2020 2020  ], [], []),.    
-0004a750: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0004a760: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-0004a770: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0004a780: 7446 6965 6c64 2822 6162 6322 2c20 2262  tField("abc", "b
-0004a790: 6962 7465 7822 292c 2062 6962 7465 784f  ibtex"), bibtexO
-0004a7a0: 7574 290a 0a20 2020 2020 2020 2070 626d  ut)..        pbm
-0004a7b0: 203d 204d 6167 6963 4d6f 636b 2829 0a20   = MagicMock(). 
-0004a7c0: 2020 2020 2020 2070 6276 203d 204d 6167         pbv = Mag
-0004a7d0: 6963 4d6f 636b 2829 0a20 2020 2020 2020  icMock().       
-0004a7e0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0004a7f0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-0004a800: 656c 662e 7042 4442 2e62 6962 732e 7265  elf.pBDB.bibs.re
-0004a810: 706c 6163 6528 0a20 2020 2020 2020 2020  place(.         
-0004a820: 2020 2020 2020 2022 766f 6c75 6d65 222c         "volume",
-0004a830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004a840: 205b 2276 6f6c 756d 6522 5d2c 0a20 2020   ["volume"],.   
-0004a850: 2020 2020 2020 2020 2020 2020 2022 285b               "([
-0004a860: 302d 395d 7b32 7d29 285b 302d 395d 7b32  0-9]{2})([0-9]{2
-0004a870: 7d29 222c 0a20 2020 2020 2020 2020 2020  })",.           
-0004a880: 2020 2020 205b 7222 5c32 225d 2c0a 2020       [r"\2"],.  
-0004a890: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0004a8a0: 6765 783d 5472 7565 2c0a 2020 2020 2020  gex=True,.      
-0004a8b0: 2020 2020 2020 2020 2020 7062 4d61 783d            pbMax=
-0004a8c0: 7062 6d2c 0a20 2020 2020 2020 2020 2020  pbm,.           
-0004a8d0: 2020 2020 2070 6256 616c 3d70 6276 2c0a       pbVal=pbv,.
-0004a8e0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0004a8f0: 2020 2020 2020 2020 2020 2028 5b22 6162             (["ab
-0004a900: 6322 5d2c 205b 2261 6263 225d 2c20 5b5d  c"], ["abc"], []
-0004a910: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-0004a920: 2020 2020 2070 626d 2e61 7373 6572 745f       pbm.assert_
-0004a930: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-0004a940: 2831 290a 2020 2020 2020 2020 7062 762e  (1).        pbv.
-0004a950: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-0004a960: 6365 5f77 6974 6828 3129 0a20 2020 2020  ce_with(1).     
-0004a970: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0004a980: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-0004a990: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0004a9a0: 6765 7446 6965 6c64 2822 6162 6322 2c20  getField("abc", 
-0004a9b0: 2262 6962 7465 7822 292c 2062 6962 7465  "bibtex"), bibte
-0004a9c0: 784f 7574 2e72 6570 6c61 6365 2822 3138  xOut.replace("18
-0004a9d0: 3033 222c 2022 3033 2229 0a20 2020 2020  03", "03").     
-0004a9e0: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
-0004a9f0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0004aa00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0004aa10: 2e70 4244 422e 6269 6273 2e72 6570 6c61  .pBDB.bibs.repla
-0004aa20: 6365 2822 766f 6c75 6d65 222c 205b 2276  ce("volume", ["v
-0004aa30: 6f6c 756d 6522 5d2c 2022 3033 222c 205b  olume"], "03", [
-0004aa40: 7222 3138 3033 225d 292c 0a20 2020 2020  r"1803"]),.     
-0004aa50: 2020 2020 2020 2028 5b22 6162 6322 5d2c         (["abc"],
-0004aa60: 205b 2261 6263 225d 2c20 5b5d 292c 0a20   ["abc"], []),. 
-0004aa70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0004aa80: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0004aa90: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
-0004aaa0: 2e67 6574 4669 656c 6428 2261 6263 222c  .getField("abc",
-0004aab0: 2022 6269 6274 6578 2229 2c20 6269 6274   "bibtex"), bibt
-0004aac0: 6578 4f75 7429 0a0a 2020 2020 2020 2020  exOut)..        
-0004aad0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0004aae0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0004aaf0: 6c66 2e70 4244 422e 6269 6273 2e72 6570  lf.pBDB.bibs.rep
-0004ab00: 6c61 6365 280a 2020 2020 2020 2020 2020  lace(.          
-0004ab10: 2020 2020 2020 2276 6f6c 756d 6522 2c20        "volume", 
-0004ab20: 5b22 766f 6c75 6d65 222c 2022 6a6f 7572  ["volume", "jour
-0004ab30: 6e61 6c22 5d2c 2022 3138 3033 222c 205b  nal"], "1803", [
-0004ab40: 2230 3322 2c20 2231 3830 3322 5d0a 2020  "03", "1803"].  
-0004ab50: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-0004ab60: 2020 2020 2020 2020 2028 5b22 6162 6322           (["abc"
-0004ab70: 5d2c 205b 2261 6263 225d 2c20 5b5d 292c  ], ["abc"], []),
-0004ab80: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0004ab90: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0004aba0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-0004abb0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0004abc0: 6765 7446 6965 6c64 2822 6162 6322 2c20  getField("abc", 
-0004abd0: 2262 6962 7465 7822 292c 0a20 2020 2020  "bibtex"),.     
-0004abe0: 2020 2020 2020 2062 6962 7465 784f 7574         bibtexOut
-0004abf0: 2e72 6570 6c61 6365 2822 3138 3033 222c  .replace("1803",
-0004ac00: 2022 3033 2229 2e72 6570 6c61 6365 2822   "03").replace("
-0004ac10: 6a63 6170 222c 2022 3138 3033 2229 2c0a  jcap", "1803"),.
-0004ac20: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0004ac30: 2020 2062 6962 7465 7849 6e20 3d20 280a     bibtexIn = (.
-0004ac40: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
-0004ac50: 7469 636c 657b 6465 662c 5c6e 6175 7468  ticle{def,\nauth
-0004ac60: 6f72 203d 2022 6d65 222c 5c6e 270a 2020  or = "me",\n'.  
-0004ac70: 2020 2020 2020 2020 2020 2b20 2774 6974            + 'tit
-0004ac80: 6c65 203d 2022 6465 6622 2c5c 6e6a 6f75  le = "def",\njou
-0004ac90: 726e 616c 3d22 5068 7973 2e20 5265 762e  rnal="Phys. Rev.
-0004aca0: 222c 5c6e 766f 6c75 6d65 3d22 4439 3522  ",\nvolume="D95"
-0004acb0: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
-0004acc0: 202b 2027 7965 6172 3d22 3230 3138 222c   + 'year="2018",
-0004acd0: 5c6e 7061 6765 733d 2231 222c 5c6e 6172  \npages="1",\nar
-0004ace0: 7869 763d 2231 3233 342e 3536 3738 3922  xiv="1234.56789"
-0004acf0: 2c5c 6e7d 270a 2020 2020 2020 2020 290a  ,\n}'.        ).
-0004ad00: 2020 2020 2020 2020 6269 6274 6578 4f75          bibtexOu
-0004ad10: 7420 3d20 280a 2020 2020 2020 2020 2020  t = (.          
-0004ad20: 2020 2740 4172 7469 636c 657b 6465 662c    '@Article{def,
-0004ad30: 5c6e 2020 2020 2020 2020 6175 7468 6f72  \n        author
-0004ad40: 203d 2022 6d65 222c 5c6e 2020 2020 2020   = "me",\n      
-0004ad50: 2020 2027 0a20 2020 2020 2020 2020 2020     '.           
-0004ad60: 202b 2027 7469 746c 6520 3d20 227b 6465   + 'title = "{de
-0004ad70: 667d 222c 5c6e 2020 2020 2020 206a 6f75  f}",\n       jou
-0004ad80: 726e 616c 203d 2022 5068 7973 2e20 5265  rnal = "Phys. Re
-0004ad90: 762e 2044 222c 5c6e 2020 2020 2020 2020  v. D",\n        
-0004ada0: 270a 2020 2020 2020 2020 2020 2020 2b20  '.            + 
-0004adb0: 2776 6f6c 756d 6520 3d20 2239 3522 2c5c  'volume = "95",\
-0004adc0: 6e20 2020 2020 2020 2020 2079 6561 7220  n          year 
-0004add0: 3d20 2232 3031 3822 2c5c 6e20 2020 2020  = "2018",\n     
-0004ade0: 2020 2020 270a 2020 2020 2020 2020 2020      '.          
-0004adf0: 2020 2b20 2770 6167 6573 203d 2022 3122    + 'pages = "1"
-0004ae00: 2c5c 6e20 2020 2020 2020 2020 6172 7869  ,\n         arxi
-0004ae10: 7620 3d20 2231 3233 342e 3536 3738 3922  v = "1234.56789"
-0004ae20: 2c5c 6e7d 270a 2020 2020 2020 2020 290a  ,\n}'.        ).
-0004ae30: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0004ae40: 6572 7454 7275 6528 7365 6c66 2e70 4244  ertTrue(self.pBD
-0004ae50: 422e 6269 6273 2e69 6e73 6572 7446 726f  B.bibs.insertFro
-0004ae60: 6d42 6962 7465 7828 6269 6274 6578 496e  mBibtex(bibtexIn
-0004ae70: 2929 0a20 2020 2020 2020 2077 6974 6820  )).        with 
-0004ae80: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-0004ae90: 6f67 6765 722e 696e 666f 2229 2061 7320  ogger.info") as 
-0004aea0: 5f69 3a0a 2020 2020 2020 2020 2020 2020  _i:.            
-0004aeb0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0004aec0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0004aed0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0004aee0: 2e72 6570 6c61 6365 280a 2020 2020 2020  .replace(.      
-0004aef0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-0004af00: 7562 6c69 7368 6564 222c 0a20 2020 2020  ublished",.     
-0004af10: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0004af20: 226a 6f75 726e 616c 222c 2022 766f 6c75  "journal", "volu
-0004af30: 6d65 225d 2c0a 2020 2020 2020 2020 2020  me"],.          
-0004af40: 2020 2020 2020 2020 2020 2228 5068 7973            "(Phys
-0004af50: 2e20 5265 762e 205b 412d 5a5d 7b31 7d29  . Rev. [A-Z]{1})
-0004af60: 285b 302d 395d 7b32 7d29 2e2a 222c 0a20  ([0-9]{2}).*",. 
-0004af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004af80: 2020 205b 7222 5c31 222c 2072 225c 3222     [r"\1", r"\2"
-0004af90: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0004afa0: 2020 2020 2020 2072 6567 6578 3d54 7275         regex=Tru
-0004afb0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0004afc0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-0004afd0: 2020 2020 2020 285b 2261 6263 222c 2022        (["abc", "
-0004afe0: 6465 6622 5d2c 205b 2264 6566 225d 2c20  def"], ["def"], 
-0004aff0: 5b5d 292c 0a20 2020 2020 2020 2020 2020  []),.           
-0004b000: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0004b010: 692e 6173 7365 7274 5f68 6173 5f63 616c  i.assert_has_cal
-0004b020: 6c73 280a 2020 2020 2020 2020 2020 2020  ls(.            
-0004b030: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0004b040: 2020 2020 2020 2020 2020 6361 6c6c 2822            call("
-0004b050: 5265 706c 6163 6520 7769 6c6c 2070 726f  Replace will pro
-0004b060: 6365 7373 2032 2065 6e74 7269 6573 2229  cess 2 entries")
-0004b070: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004b080: 2020 2020 2020 6361 6c6c 2822 7072 6f63        call("proc
-0004b090: 6573 7369 6e67 2020 2020 2031 202f 2032  essing     1 / 2
-0004b0a0: 2028 3530 2e30 3025 293a 2065 6e74 7279   (50.00%): entry
-0004b0b0: 2061 6263 2229 2c0a 2020 2020 2020 2020   abc"),.        
-0004b0c0: 2020 2020 2020 2020 2020 2020 6361 6c6c              call
-0004b0d0: 2822 7072 6f63 6573 7369 6e67 2020 2020  ("processing    
-0004b0e0: 2032 202f 2032 2028 3130 302e 3030 2529   2 / 2 (100.00%)
-0004b0f0: 3a20 656e 7472 7920 6465 6622 292c 0a20  : entry def"),. 
-0004b100: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0004b110: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0004b120: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0004b130: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-0004b140: 422e 6269 6273 2e67 6574 4669 656c 6428  B.bibs.getField(
-0004b150: 2264 6566 222c 2022 6269 6274 6578 2229  "def", "bibtex")
-0004b160: 2c20 6269 6274 6578 4f75 7429 0a0a 2020  , bibtexOut)..  
-0004b170: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0004b180: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0004b190: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-0004b1a0: 6273 2e72 6570 6c61 6365 280a 2020 2020  bs.replace(.    
-0004b1b0: 2020 2020 2020 2020 2020 2020 2270 7562              "pub
-0004b1c0: 6c69 7368 6564 222c 0a20 2020 2020 2020  lished",.       
-0004b1d0: 2020 2020 2020 2020 205b 226a 6f75 726e           ["journ
-0004b1e0: 616c 222c 2022 766f 6c75 6d65 225d 2c0a  al", "volume"],.
-0004b1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b200: 2228 5068 7973 2e20 5265 762e 205b 412d  "(Phys. Rev. [A-
-0004b210: 5a5d 7b31 7d29 285b 302d 395d 7b32 7d29  Z]{1})([0-9]{2})
-0004b220: 2e2a 222c 0a20 2020 2020 2020 2020 2020  .*",.           
-0004b230: 2020 2020 205b 7222 5c31 222c 2072 225c       [r"\1", r"\
-0004b240: 3222 5d2c 0a20 2020 2020 2020 2020 2020  2"],.           
-0004b250: 2020 2020 2072 6567 6578 3d54 7275 652c       regex=True,
-0004b260: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-0004b270: 2020 2020 2020 2020 2020 2020 285b 2261              (["a
-0004b280: 6263 222c 2022 6465 6622 5d2c 205b 5d2c  bc", "def"], [],
-0004b290: 205b 5d29 2c0a 2020 2020 2020 2020 290a   []),.        ).
-0004b2a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0004b2b0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0004b2c0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0004b2d0: 6269 6273 2e72 6570 6c61 6365 280a 2020  bibs.replace(.  
-0004b2e0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-0004b2f0: 7562 6c69 7368 6564 222c 0a20 2020 2020  ublished",.     
-0004b300: 2020 2020 2020 2020 2020 205b 226a 6f75             ["jou
-0004b310: 726e 616c 222c 2022 766f 6c75 6d65 225d  rnal", "volume"]
-0004b320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004b330: 2020 2228 5068 7973 2e20 5265 762e 205b    "(Phys. Rev. [
-0004b340: 412d 5a5d 7b31 7d29 285b 302d 395d 7b32  A-Z]{1})([0-9]{2
-0004b350: 7d29 2e2a 222c 0a20 2020 2020 2020 2020  }).*",.         
-0004b360: 2020 2020 2020 205b 7222 5c31 222c 2072         [r"\1", r
-0004b370: 225c 3222 5d2c 0a20 2020 2020 2020 2020  "\2"],.         
-0004b380: 2020 2020 2020 2065 6e74 7269 6573 3d73         entries=s
-0004b390: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-0004b3a0: 7442 7942 6962 6b65 7928 2261 6263 2229  tByBibkey("abc")
-0004b3b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004b3c0: 2020 7265 6765 783d 5472 7565 2c0a 2020    regex=True,.  
-0004b3d0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-0004b3e0: 2020 2020 2020 2020 2028 5b22 6162 6322           (["abc"
-0004b3f0: 5d2c 205b 5d2c 205b 5d29 2c0a 2020 2020  ], [], []),.    
-0004b400: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0004b410: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0004b420: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0004b430: 2e70 4244 422e 6269 6273 2e72 6570 6c61  .pBDB.bibs.repla
-0004b440: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-0004b450: 2020 2020 2270 7562 6c69 7368 6564 222c      "published",
-0004b460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004b470: 205b 226a 6f75 726e 616c 222c 2022 766f   ["journal", "vo
-0004b480: 6c75 6d65 225d 2c0a 2020 2020 2020 2020  lume"],.        
-0004b490: 2020 2020 2020 2020 2228 5068 7973 2e20          "(Phys. 
-0004b4a0: 5265 762e 205b 412d 5a5d 7b31 7d29 285b  Rev. [A-Z]{1})([
-0004b4b0: 302d 395d 7b32 7d29 2e2a 222c 0a20 2020  0-9]{2}).*",.   
-0004b4c0: 2020 2020 2020 2020 2020 2020 205b 7222               [r"
-0004b4d0: 5c31 222c 2072 225c 3222 5d2c 0a20 2020  \1", r"\2"],.   
-0004b4e0: 2020 2020 2020 2020 2020 2020 2065 6e74               ent
-0004b4f0: 7269 6573 3d73 656c 662e 7042 4442 2e62  ries=self.pBDB.b
-0004b500: 6962 732e 6765 7442 7942 6962 6b65 7928  ibs.getByBibkey(
-0004b510: 2261 6263 2229 2c0a 2020 2020 2020 2020  "abc"),.        
-0004b520: 2020 2020 2020 2020 7265 6765 783d 4661          regex=Fa
-0004b530: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-0004b540: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0004b550: 285b 2261 6263 225d 2c20 5b22 6162 6322  (["abc"], ["abc"
-0004b560: 5d2c 205b 5d29 2c0a 2020 2020 2020 2020  ], []),.        
-0004b570: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0004b580: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0004b590: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0004b5a0: 4442 2e62 6962 732e 7265 706c 6163 6528  DB.bibs.replace(
-0004b5b0: 2262 6962 7465 7822 2c20 2262 6962 7465  "bibtex", "bibte
-0004b5c0: 7822 2c20 2261 6263 6422 2c20 2261 6263  x", "abcd", "abc
-0004b5d0: 6465 2229 2c20 285b 5d2c 205b 5d2c 205b  de"), ([], [], [
-0004b5e0: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
-0004b5f0: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0004b600: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-0004b610: 7761 726e 696e 6722 2920 6173 205f 773a  warning") as _w:
-0004b620: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0004b630: 662e 7042 4442 2e62 6962 732e 7265 706c  f.pBDB.bibs.repl
-0004b640: 6163 6528 2262 6962 7465 7822 2c20 2262  ace("bibtex", "b
-0004b650: 6962 7465 7822 2c20 2261 6263 6422 2c20  ibtex", "abcd", 
-0004b660: 2261 6263 6465 2229 0a20 2020 2020 2020  "abcde").       
-0004b670: 2020 2020 205f 772e 6173 7365 7274 5f61       _w.assert_a
-0004b680: 6e79 5f63 616c 6c28 2249 6e76 616c 6964  ny_call("Invalid
-0004b690: 2027 6669 4e65 7773 2720 6f72 2027 6e65   'fiNews' or 'ne
-0004b6a0: 7773 2720 2874 6865 7920 6d75 7374 2062  ws' (they must b
-0004b6b0: 6520 6c69 7374 7329 2229 0a20 2020 2020  e lists)").     
-0004b6c0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0004b6d0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
-0004b6e0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0004b6f0: 7265 706c 6163 6528 2261 6263 6422 2c20  replace("abcd", 
-0004b700: 5b22 6162 6364 225d 2c20 2231 3233 342e  ["abcd"], "1234.
-0004b710: 3030 3030 3022 2c20 5b22 3536 3738 3922  00000", ["56789"
-0004b720: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-0004b730: 285b 5d2c 205b 5d2c 205b 2261 6263 222c  ([], [], ["abc",
-0004b740: 2022 6465 6622 5d29 2c0a 2020 2020 2020   "def"]),.      
-0004b750: 2020 290a 0a20 2020 2020 2020 2062 6962    )..        bib
-0004b760: 7465 7849 6e20 3d20 280a 2020 2020 2020  texIn = (.      
-0004b770: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
-0004b780: 6768 692c 5c6e 6175 7468 6f72 203d 2022  ghi,\nauthor = "
-0004b790: 6d65 222c 5c6e 270a 2020 2020 2020 2020  me",\n'.        
-0004b7a0: 2020 2020 2b20 2774 6974 6c65 203d 2022      + 'title = "
-0004b7b0: 6768 6922 2c5c 6e65 7072 696e 743d 2231  ghi",\neprint="1
-0004b7c0: 3233 342e 3536 3738 3922 2c5c 6e7d 270a  234.56789",\n}'.
-0004b7d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0004b7e0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-0004b7f0: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
-0004b800: 2e69 6e73 6572 7446 726f 6d42 6962 7465  .insertFromBibte
-0004b810: 7828 6269 6274 6578 496e 2929 0a20 2020  x(bibtexIn)).   
-0004b820: 2020 2020 2070 626d 203d 204d 6167 6963       pbm = Magic
-0004b830: 4d6f 636b 2829 0a20 2020 2020 2020 2070  Mock().        p
-0004b840: 6276 203d 204d 6167 6963 4d6f 636b 2829  bv = MagicMock()
-0004b850: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-0004b860: 7463 6828 226c 6f67 6769 6e67 2e4c 6f67  tch("logging.Log
-0004b870: 6765 722e 696e 666f 2229 2061 7320 5f69  ger.info") as _i
-0004b880: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0004b890: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0004b8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b8b0: 7365 6c66 2e70 4244 422e 6269 6273 2e72  self.pBDB.bibs.r
-0004b8c0: 6570 6c61 6365 280a 2020 2020 2020 2020  eplace(.        
-0004b8d0: 2020 2020 2020 2020 2020 2020 2265 7072              "epr
-0004b8e0: 696e 7422 2c0a 2020 2020 2020 2020 2020  int",.          
-0004b8f0: 2020 2020 2020 2020 2020 5b22 766f 6c75            ["volu
-0004b900: 6d65 225d 2c0a 2020 2020 2020 2020 2020  me"],.          
-0004b910: 2020 2020 2020 2020 2020 2231 3233 342e            "1234.
-0004b920: 3030 3030 3022 2c0a 2020 2020 2020 2020  00000",.        
-0004b930: 2020 2020 2020 2020 2020 2020 5b22 3536              ["56
-0004b940: 3738 3922 5d2c 0a20 2020 2020 2020 2020  789"],.         
-0004b950: 2020 2020 2020 2020 2020 206c 656e 456e             lenEn
-0004b960: 7472 6965 733d 352c 0a20 2020 2020 2020  tries=5,.       
-0004b970: 2020 2020 2020 2020 2020 2020 2065 6e74               ent
-0004b980: 7269 6573 3d73 656c 662e 7042 4442 2e62  ries=self.pBDB.b
-0004b990: 6962 732e 6665 7463 6841 6c6c 2873 6176  ibs.fetchAll(sav
-0004b9a0: 6551 7565 7279 3d46 616c 7365 292e 6c61  eQuery=False).la
-0004b9b0: 7374 4665 7463 6865 642c 0a20 2020 2020  stFetched,.     
-0004b9c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0004b9d0: 624d 6178 3d70 626d 2c0a 2020 2020 2020  bMax=pbm,.      
-0004b9e0: 2020 2020 2020 2020 2020 2020 2020 7062                pb
-0004b9f0: 5661 6c3d 7062 762c 0a20 2020 2020 2020  Val=pbv,.       
-0004ba00: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-0004ba10: 2020 2020 2020 2020 2020 2020 285b 2267              (["g
-0004ba20: 6869 225d 2c20 5b22 6768 6922 5d2c 205b  hi"], ["ghi"], [
-0004ba30: 2261 6263 222c 2022 6465 6622 5d29 2c0a  "abc", "def"]),.
-0004ba40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0004ba50: 2020 2020 2020 2020 2020 5f69 2e61 7373            _i.ass
-0004ba60: 6572 745f 6861 735f 6361 6c6c 7328 0a20  ert_has_calls(. 
-0004ba70: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0004ba80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004ba90: 2020 2020 2063 616c 6c28 2252 6570 6c61       call("Repla
-0004baa0: 6365 2077 696c 6c20 7072 6f63 6573 7320  ce will process 
-0004bab0: 3520 656e 7472 6965 7322 292c 0a20 2020  5 entries"),.   
-0004bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bad0: 2063 616c 6c28 2270 726f 6365 7373 696e   call("processin
-0004bae0: 6720 2020 2020 3120 2f20 3520 2832 302e  g     1 / 5 (20.
-0004baf0: 3030 2529 3a20 656e 7472 7920 6162 6322  00%): entry abc"
-0004bb00: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0004bb10: 2020 2020 2020 2063 616c 6c28 2270 726f         call("pro
-0004bb20: 6365 7373 696e 6720 2020 2020 3220 2f20  cessing     2 / 
-0004bb30: 3520 2834 302e 3030 2529 3a20 656e 7472  5 (40.00%): entr
-0004bb40: 7920 6465 6622 292c 0a20 2020 2020 2020  y def"),.       
-0004bb50: 2020 2020 2020 2020 2020 2020 2063 616c               cal
-0004bb60: 6c28 2270 726f 6365 7373 696e 6720 2020  l("processing   
-0004bb70: 2020 3320 2f20 3520 2836 302e 3030 2529    3 / 5 (60.00%)
-0004bb80: 3a20 656e 7472 7920 6768 6922 292c 0a20  : entry ghi"),. 
-0004bb90: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0004bba0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0004bbb0: 2020 2020 2020 2070 626d 2e61 7373 6572         pbm.asser
-0004bbc0: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
-0004bbd0: 7468 2835 290a 2020 2020 2020 2020 7062  th(5).        pb
-0004bbe0: 762e 6173 7365 7274 5f68 6173 5f63 616c  v.assert_has_cal
-0004bbf0: 6c73 285b 6361 6c6c 2869 202b 2031 2920  ls([call(i + 1) 
-0004bc00: 666f 7220 6920 696e 2072 616e 6765 2833  for i in range(3
-0004bc10: 295d 290a 2020 2020 2020 2020 7769 7468  )]).        with
-0004bc20: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
-0004bc30: 4c6f 6767 6572 2e65 7863 6570 7469 6f6e  Logger.exception
-0004bc40: 2229 2061 7320 5f69 3a0a 2020 2020 2020  ") as _i:.      
-0004bc50: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0004bc60: 6269 6273 2e72 6570 6c61 6365 2822 6570  bibs.replace("ep
-0004bc70: 7269 6e74 222c 205b 2276 6f6c 756d 6522  rint", ["volume"
-0004bc80: 5d2c 2022 3132 3334 2e30 3030 3030 222c  ], "1234.00000",
-0004bc90: 205b 2235 3637 3839 225d 290a 2020 2020   ["56789"]).    
-0004bca0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0004bcb0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-0004bcc0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0004bcd0: 2e72 6570 6c61 6365 2822 6172 7869 7622  .replace("arxiv"
-0004bce0: 2c20 5b22 6570 7269 6e74 225d 2c20 2231  , ["eprint"], "1
-0004bcf0: 3233 342e 3030 3030 3022 2c20 5b22 3536  234.00000", ["56
-0004bd00: 3738 3922 5d29 2c0a 2020 2020 2020 2020  789"]),.        
-0004bd10: 2020 2020 285b 2267 6869 225d 2c20 5b5d      (["ghi"], []
-0004bd20: 2c20 5b22 6162 6322 2c20 2264 6566 225d  , ["abc", "def"]
-0004bd30: 292c 0a20 2020 2020 2020 2029 0a0a 2020  ),.        )..  
-0004bd40: 2020 6465 6620 7465 7374 5f72 6570 6c61    def test_repla
-0004bd50: 6365 5369 6e67 6c65 456e 7472 7928 7365  ceSingleEntry(se
-0004bd60: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
-0004bd70: 2020 2020 2222 2274 6573 7420 7265 706c      """test repl
-0004bd80: 6163 6553 696e 676c 6545 6e74 7279 2222  aceSingleEntry""
-0004bd90: 220a 2020 2020 2020 2020 6264 203d 207b  ".        bd = {
-0004bda0: 2245 4e54 5259 5459 5045 223a 2022 6172  "ENTRYTYPE": "ar
-0004bdb0: 7469 636c 6522 2c20 2249 4422 3a20 226b  ticle", "ID": "k
-0004bdc0: 6579 3122 7d0a 2020 2020 2020 2020 7769  ey1"}.        wi
-0004bdd0: 7468 2070 6174 6368 2822 7068 7973 6269  th patch("physbi
-0004bde0: 626c 696f 2e64 6174 6162 6173 652e 456e  blio.database.En
-0004bdf0: 7472 6965 732e 7570 6461 7465 4669 656c  tries.updateFiel
-0004be00: 6422 2920 6173 205f 753a 0a20 2020 2020  d") as _u:.     
-0004be10: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0004be20: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-0004be30: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0004be40: 4442 2e62 6962 732e 7265 706c 6163 6553  DB.bibs.replaceS
-0004be50: 696e 676c 6545 6e74 7279 280a 2020 2020  ingleEntry(.    
-0004be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004be70: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-0004be80: 2020 2020 2020 207b 2262 6962 6b65 7922         {"bibkey"
-0004be90: 3a20 226b 6579 3122 2c20 2262 6962 7465  : "key1", "bibte
-0004bea0: 7844 6963 7422 3a20 7b7d 7d2c 0a20 2020  xDict": {}},.   
-0004beb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bec0: 2022 6269 6274 6578 222c 0a20 2020 2020   "bibtex",.     
-0004bed0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0004bee0: 2262 6962 7465 7822 5d2c 0a20 2020 2020  "bibtex"],.     
-0004bef0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004bf00: 6162 6364 222c 0a20 2020 2020 2020 2020  abcd",.         
-0004bf10: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
-0004bf20: 6465 225d 2c0a 2020 2020 2020 2020 2020  de"],.          
-0004bf30: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-0004bf40: 2020 2020 2020 2020 2028 5b5d 2c20 5b5d           ([], []
-0004bf50: 2c20 5b22 6b65 7931 225d 292c 0a20 2020  , ["key1"]),.   
-0004bf60: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0004bf70: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0004bf80: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-0004bf90: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0004bfa0: 4442 2e62 6962 732e 7265 706c 6163 6553  DB.bibs.replaceS
-0004bfb0: 696e 676c 6545 6e74 7279 280a 2020 2020  ingleEntry(.    
-0004bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bfd0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-0004bfe0: 2020 2020 2020 207b 2262 6962 6b65 7922         {"bibkey"
-0004bff0: 3a20 226b 6579 3122 2c20 2262 6962 7465  : "key1", "bibte
-0004c000: 7844 6963 7422 3a20 7b7d 7d2c 0a20 2020  xDict": {}},.   
-0004c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c020: 2022 6269 6274 6578 222c 0a20 2020 2020   "bibtex",.     
-0004c030: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0004c040: 2262 6962 7465 7822 5d2c 0a20 2020 2020  "bibtex"],.     
-0004c050: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004c060: 6162 6364 222c 0a20 2020 2020 2020 2020  abcd",.         
-0004c070: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
-0004c080: 6465 225d 2c0a 2020 2020 2020 2020 2020  de"],.          
-0004c090: 2020 2020 2020 2020 2020 6368 616e 6765            change
-0004c0a0: 643d 5b22 6122 5d2c 0a20 2020 2020 2020  d=["a"],.       
-0004c0b0: 2020 2020 2020 2020 2020 2020 2066 6169               fai
-0004c0c0: 6c65 643d 5b22 6222 5d2c 0a20 2020 2020  led=["b"],.     
-0004c0d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0004c0e0: 7563 6365 7373 3d5b 2263 225d 2c0a 2020  uccess=["c"],.  
-0004c0f0: 2020 2020 2020 2020 2020 2020 2020 292c                ),
-0004c100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004c110: 2028 5b22 6322 5d2c 205b 2261 225d 2c20   (["c"], ["a"], 
-0004c120: 5b22 6222 2c20 226b 6579 3122 5d29 2c0a  ["b", "key1"]),.
-0004c130: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0004c140: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0004c150: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-0004c160: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0004c170: 2e70 4244 422e 6269 6273 2e72 6570 6c61  .pBDB.bibs.repla
-0004c180: 6365 5369 6e67 6c65 456e 7472 7928 0a20  ceSingleEntry(. 
-0004c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c1a0: 2020 2030 2c0a 2020 2020 2020 2020 2020     0,.          
-0004c1b0: 2020 2020 2020 2020 2020 7b22 6269 626b            {"bibk
-0004c1c0: 6579 223a 2022 6b65 7931 222c 2022 6269  ey": "key1", "bi
-0004c1d0: 6274 6578 223a 2022 6269 6274 6578 2061  btex": "bibtex a
-0004c1e0: 6263 6422 2c20 2262 6962 7465 7844 6963  bcd", "bibtexDic
-0004c1f0: 7422 3a20 7b7d 7d2c 0a20 2020 2020 2020  t": {}},.       
-0004c200: 2020 2020 2020 2020 2020 2020 2022 7469               "ti
-0004c210: 746c 6522 2c0a 2020 2020 2020 2020 2020  tle",.          
-0004c220: 2020 2020 2020 2020 2020 5b22 6269 6274            ["bibt
-0004c230: 6578 225d 2c0a 2020 2020 2020 2020 2020  ex"],.          
-0004c240: 2020 2020 2020 2020 2020 2261 6263 6422            "abcd"
-0004c250: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004c260: 2020 2020 2020 5b22 6162 6364 6522 5d2c        ["abcde"],
-0004c270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004c280: 2020 2020 2063 6861 6e67 6564 3d5b 5d2c       changed=[],
-0004c290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004c2a0: 2020 2020 2066 6169 6c65 643d 5b5d 2c0a       failed=[],.
-0004c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c2c0: 2020 2020 7375 6363 6573 733d 5b5d 2c0a      success=[],.
-0004c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c2e0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0004c2f0: 2020 2028 5b5d 2c20 5b5d 2c20 5b22 6b65     ([], [], ["ke
-0004c300: 7931 225d 292c 0a20 2020 2020 2020 2020  y1"]),.         
-0004c310: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0004c320: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0004c330: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-0004c340: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-0004c350: 732e 7265 706c 6163 6553 696e 676c 6545  s.replaceSingleE
-0004c360: 6e74 7279 280a 2020 2020 2020 2020 2020  ntry(.          
-0004c370: 2020 2020 2020 2020 2020 302c 0a20 2020            0,.   
-0004c380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c390: 207b 2262 6962 6b65 7922 3a20 226b 6579   {"bibkey": "key
-0004c3a0: 3122 2c20 2262 6962 7465 7822 3a20 2262  1", "bibtex": "b
-0004c3b0: 6962 7465 7820 6162 6364 222c 2022 6269  ibtex abcd", "bi
-0004c3c0: 6274 6578 4469 6374 223a 207b 7d7d 2c0a  btexDict": {}},.
-0004c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c3e0: 2020 2020 2262 6962 7465 7822 2c0a 2020      "bibtex",.  
-0004c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c400: 2020 5b22 7469 746c 6522 5d2c 0a20 2020    ["title"],.   
-0004c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c420: 2022 6162 6364 222c 0a20 2020 2020 2020   "abcd",.       
-0004c430: 2020 2020 2020 2020 2020 2020 205b 2261               ["a
-0004c440: 6263 6465 225d 2c0a 2020 2020 2020 2020  bcde"],.        
-0004c450: 2020 2020 2020 2020 2020 2020 6368 616e              chan
-0004c460: 6765 643d 5b5d 2c0a 2020 2020 2020 2020  ged=[],.        
-0004c470: 2020 2020 2020 2020 2020 2020 6661 696c              fail
-0004c480: 6564 3d5b 5d2c 0a20 2020 2020 2020 2020  ed=[],.         
-0004c490: 2020 2020 2020 2020 2020 2073 7563 6365             succe
-0004c4a0: 7373 3d5b 5d2c 0a20 2020 2020 2020 2020  ss=[],.         
-0004c4b0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0004c4c0: 2020 2020 2020 2020 2020 285b 5d2c 205b            ([], [
-0004c4d0: 5d2c 205b 226b 6579 3122 5d29 2c0a 2020  ], ["key1"]),.  
-0004c4e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0004c4f0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0004c500: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0004c510: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0004c520: 4244 422e 6269 6273 2e72 6570 6c61 6365  BDB.bibs.replace
-0004c530: 5369 6e67 6c65 456e 7472 7928 0a20 2020  SingleEntry(.   
+000483c0: 6c28 6461 7461 5b22 6269 626b 6579 225d  l(data["bibkey"]
+000483d0: 2c20 2261 6263 2229 0a20 2020 2020 2020  , "abc").       
+000483e0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000483f0: 6c28 6461 7461 5b22 6172 7869 7622 5d2c  l(data["arxiv"],
+00048400: 2022 3132 3334 2229 0a20 2020 2020 2020   "1234").       
+00048410: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00048420: 6c28 6461 7461 5b22 6269 6274 6578 225d  l(data["bibtex"]
+00048430: 2c20 7265 7375 6c74 4129 0a20 2020 2020  , resultA).     
+00048440: 2020 2064 6174 6120 3d20 7365 6c66 2e70     data = self.p
+00048450: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
+00048460: 5570 6461 7465 4279 4269 6274 6578 2822  UpdateByBibtex("
+00048470: 6162 6331 222c 2062 6962 7465 7841 290a  abc1", bibtexA).
+00048480: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00048490: 6572 7445 7175 616c 2864 6174 615b 2262  ertEqual(data["b
+000484a0: 6962 6b65 7922 5d2c 2022 6162 6331 2229  ibkey"], "abc1")
+000484b0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000484c0: 7365 7274 4571 7561 6c28 6461 7461 5b22  sertEqual(data["
+000484d0: 6172 7869 7622 5d2c 2022 3132 3334 2229  arxiv"], "1234")
+000484e0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000484f0: 7365 7274 4571 7561 6c28 6461 7461 5b22  sertEqual(data["
+00048500: 6269 6274 6578 225d 2c20 7265 7375 6c74  bibtex"], result
+00048510: 4229 0a0a 2020 2020 6465 6620 7465 7374  B)..    def test
+00048520: 5f70 7269 6e74 416c 6c28 7365 6c66 2c20  _printAll(self, 
+00048530: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
+00048540: 7365 6c66 2e69 6e73 6572 745f 7468 7265  self.insert_thre
+00048550: 6528 290a 2020 2020 2020 2020 7365 6c66  e().        self
+00048560: 2e61 7373 6572 745f 7374 646f 7574 280a  .assert_stdout(.
+00048570: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00048580: 2e70 4244 422e 6269 6273 2e70 7269 6e74  .pBDB.bibs.print
+00048590: 416c 6c42 6962 6b65 7973 2c0a 2020 2020  AllBibkeys,.    
+000485a0: 2020 2020 2020 2020 2220 2020 3020 2d20          "   0 - 
+000485b0: 6162 635c 6e5c 6e20 2020 3120 2d20 6465  abc\n\n   1 - de
+000485c0: 665c 6e5c 6e20 2020 3220 2d20 6768 695c  f\n\n   2 - ghi\
+000485d0: 6e5c 6e22 2c0a 2020 2020 2020 2020 290a  n\n",.        ).
+000485e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000485f0: 6572 745f 7374 646f 7574 280a 2020 2020  ert_stdout(.    
+00048600: 2020 2020 2020 2020 6c61 6d62 6461 3a20          lambda: 
+00048610: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
+00048620: 7269 6e74 416c 6c42 6962 6b65 7973 280a  rintAllBibkeys(.
+00048630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00048640: 656e 7472 6965 7349 6e3d 7365 6c66 2e70  entriesIn=self.p
+00048650: 4244 422e 6269 6273 2e67 6574 4279 4269  BDB.bibs.getByBi
+00048660: 626b 6579 2822 6162 6322 290a 2020 2020  bkey("abc").    
+00048670: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+00048680: 2020 2020 2020 2022 2020 2030 202d 2061         "   0 - a
+00048690: 6263 5c6e 5c6e 222c 0a20 2020 2020 2020  bc\n\n",.       
+000486a0: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
+000486b0: 2e61 7373 6572 745f 7374 646f 7574 280a  .assert_stdout(.
+000486c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000486d0: 2e70 4244 422e 6269 6273 2e70 7269 6e74  .pBDB.bibs.print
+000486e0: 416c 6c42 6962 7465 7873 2c0a 2020 2020  AllBibtexs,.    
+000486f0: 2020 2020 2020 2020 2720 2020 3020 2d20          '   0 - 
+00048700: 4041 7274 6963 6c65 7b61 6263 2c5c 6e20  @Article{abc,\n 
+00048710: 2020 2020 2020 2061 7574 686f 7220 3d20         author = 
+00048720: 226d 6522 2c5c 6e20 2020 2020 2020 2020  "me",\n         
+00048730: 270a 2020 2020 2020 2020 2020 2020 2b20  '.            + 
+00048740: 2774 6974 6c65 203d 2022 7b61 6263 7d22  'title = "{abc}"
+00048750: 2c5c 6e7d 5c6e 5c6e 2020 2031 202d 2040  ,\n}\n\n   1 - @
+00048760: 4172 7469 636c 657b 6465 662c 5c6e 2020  Article{def,\n  
+00048770: 2020 2020 2020 270a 2020 2020 2020 2020        '.        
+00048780: 2020 2020 2b20 2761 7574 686f 7220 3d20      + 'author = 
+00048790: 226d 6522 2c5c 6e20 2020 2020 2020 2020  "me",\n         
+000487a0: 7469 746c 6520 3d20 227b 6465 667d 222c  title = "{def}",
+000487b0: 5c6e 7d5c 6e5c 6e20 2020 270a 2020 2020  \n}\n\n   '.    
+000487c0: 2020 2020 2020 2020 2b20 2732 202d 2040          + '2 - @
+000487d0: 4172 7469 636c 657b 6768 692c 5c6e 2020  Article{ghi,\n  
+000487e0: 2020 2020 2020 6175 7468 6f72 203d 2022        author = "
+000487f0: 6d65 222c 5c6e 2020 2020 2020 2020 2027  me",\n         '
+00048800: 0a20 2020 2020 2020 2020 2020 202b 2027  .            + '
+00048810: 7469 746c 6520 3d20 227b 6768 697d 222c  title = "{ghi}",
+00048820: 5c6e 7d5c 6e5c 6e27 2c0a 2020 2020 2020  \n}\n\n',.      
+00048830: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00048840: 2e61 7373 6572 745f 7374 646f 7574 280a  .assert_stdout(.
+00048850: 2020 2020 2020 2020 2020 2020 6c61 6d62              lamb
+00048860: 6461 3a20 7365 6c66 2e70 4244 422e 6269  da: self.pBDB.bi
+00048870: 6273 2e70 7269 6e74 416c 6c42 6962 7465  bs.printAllBibte
+00048880: 7873 280a 2020 2020 2020 2020 2020 2020  xs(.            
+00048890: 2020 2020 656e 7472 6965 7349 6e3d 7365      entriesIn=se
+000488a0: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+000488b0: 4279 4269 626b 6579 2822 6162 6322 290a  ByBibkey("abc").
+000488c0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+000488d0: 2020 2020 2020 2020 2020 2027 2020 2030             '   0
+000488e0: 202d 2040 4172 7469 636c 657b 6162 632c   - @Article{abc,
+000488f0: 5c6e 2020 2020 2020 2020 6175 7468 6f72  \n        author
+00048900: 203d 2022 6d65 222c 5c6e 2020 2020 2020   = "me",\n      
+00048910: 2020 2027 0a20 2020 2020 2020 2020 2020     '.           
+00048920: 202b 2027 7469 746c 6520 3d20 227b 6162   + 'title = "{ab
+00048930: 637d 222c 5c6e 7d5c 6e5c 6e27 2c0a 2020  c}",\n}\n\n',.  
+00048940: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00048950: 2074 6f64 6179 203d 2064 6174 6574 696d   today = datetim
+00048960: 652e 6461 7465 2e74 6f64 6179 2829 2e73  e.date.today().s
+00048970: 7472 6674 696d 6528 2225 592d 256d 2d25  trftime("%Y-%m-%
+00048980: 6422 290a 2020 2020 2020 2020 7365 6c66  d").        self
+00048990: 2e70 4244 422e 6269 6273 2e73 6574 5265  .pBDB.bibs.setRe
+000489a0: 7669 6577 2822 6162 6322 290a 2020 2020  view("abc").    
+000489b0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+000489c0: 6273 2e75 7064 6174 6546 6965 6c64 2822  bs.updateField("
+000489d0: 6162 6322 2c20 2261 7278 6976 222c 2022  abc", "arxiv", "
+000489e0: 3132 3334 2229 0a20 2020 2020 2020 2073  1234").        s
+000489f0: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
+00048a00: 6461 7465 4669 656c 6428 2261 6263 222c  dateField("abc",
+00048a10: 2022 646f 6922 2c20 2273 6f6d 6564 6f69   "doi", "somedoi
+00048a20: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00048a30: 7042 4442 2e62 6962 732e 7072 696e 7441  pBDB.bibs.printA
+00048a40: 6c6c 496e 666f 2829 0a20 2020 2020 2020  llInfo().       
+00048a50: 2073 656c 662e 6173 7365 7274 5f73 7464   self.assert_std
+00048a60: 6f75 7428 0a20 2020 2020 2020 2020 2020  out(.           
+00048a70: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00048a80: 7072 696e 7441 6c6c 496e 666f 2c0a 2020  printAllInfo,.  
+00048a90: 2020 2020 2020 2020 2020 225b 2020 2030            "[   0
+00048aa0: 202d 2022 0a20 2020 2020 2020 2020 2020   - ".           
+00048ab0: 202b 2074 6f64 6179 0a20 2020 2020 2020   + today.       
+00048ac0: 2020 2020 202b 2022 205d 2020 2872 6576       + " ]  (rev
+00048ad0: 2920 6162 6320 2020 2020 2020 2020 2020  ) abc           
+00048ae0: 2020 220a 2020 2020 2020 2020 2020 2020    ".            
+00048af0: 2b20 2220 2020 2020 2020 2020 2020 2020  + "             
+00048b00: 2020 3132 3334 2020 2020 2020 2020 2020    1234          
+00048b10: 2020 2020 2020 2073 6f6d 6564 6f69 2020         somedoi  
+00048b20: 2020 2020 2020 2020 2020 2022 0a20 2020             ".   
+00048b30: 2020 2020 2020 2020 202b 2022 5c6e 5b20           + "\n[ 
+00048b40: 2020 3120 2d20 220a 2020 2020 2020 2020    1 - ".        
+00048b50: 2020 2020 2b20 746f 6461 790a 2020 2020      + today.    
+00048b60: 2020 2020 2020 2020 2b20 2220 5d20 2020          + " ]   
+00048b70: 2020 2020 2064 6566 2020 2020 2020 2020       def        
+00048b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00048b90: 220a 2020 2020 2020 2020 2020 2020 2b20  ".            + 
+00048ba0: 2220 2020 2064 6566 2020 2020 2020 2020  "    def        
+00048bb0: 2020 2020 2020 2020 2020 2d20 2020 2020            -     
+00048bc0: 2020 2020 2020 2020 2020 2020 2020 220a                ".
+00048bd0: 2020 2020 2020 2020 2020 2020 2b20 225c              + "\
+00048be0: 6e5b 2020 2032 202d 2022 0a20 2020 2020  n[   2 - ".     
+00048bf0: 2020 2020 2020 202b 2074 6f64 6179 0a20         + today. 
+00048c00: 2020 2020 2020 2020 2020 202b 2022 205d             + " ]
+00048c10: 2020 2020 2020 2020 6768 6920 2020 2020          ghi     
+00048c20: 2020 2020 2020 220a 2020 2020 2020 2020        ".        
+00048c30: 2020 2020 2b20 2220 2020 2020 2020 2020      + "         
+00048c40: 2020 2020 2020 2020 6768 6920 2020 2020          ghi     
+00048c50: 2020 2020 2020 2020 2020 2020 202d 2020               -  
+00048c60: 2020 2020 2022 0a20 2020 2020 2020 2020       ".         
+00048c70: 2020 202b 2022 2020 2020 2020 2020 2020     + "          
+00048c80: 2020 5c6e 222c 0a20 2020 2020 2020 2029    \n",.        )
+00048c90: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+00048ca0: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
+00048cb0: 656c 6428 2267 6869 222c 2022 6669 7273  eld("ghi", "firs
+00048cc0: 7464 6174 6522 2c20 2232 3031 382d 3031  tdate", "2018-01
+00048cd0: 2d30 3122 290a 2020 2020 2020 2020 7365  -01").        se
+00048ce0: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
+00048cf0: 6174 6546 6965 6c64 2822 6465 6622 2c20  ateField("def", 
+00048d00: 2266 6972 7374 6461 7465 222c 2022 3230  "firstdate", "20
+00048d10: 3138 2d30 332d 3031 2229 0a20 2020 2020  18-03-01").     
+00048d20: 2020 2073 656c 662e 6173 7365 7274 5f73     self.assert_s
+00048d30: 7464 6f75 7428 0a20 2020 2020 2020 2020  tdout(.         
+00048d40: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+00048d50: 732e 7072 696e 7441 6c6c 496e 666f 2c0a  s.printAllInfo,.
+00048d60: 2020 2020 2020 2020 2020 2020 225b 2020              "[  
+00048d70: 2030 202d 2032 3031 382d 3031 2d30 3120   0 - 2018-01-01 
+00048d80: 5d20 2020 2020 2020 2067 6869 2020 2020  ]        ghi    
+00048d90: 2020 2020 2020 2020 2020 2020 2022 0a20               ". 
+00048da0: 2020 2020 2020 2020 2020 202b 2022 2020             + "  
+00048db0: 2020 2020 2020 2020 2067 6869 2020 2020           ghi    
+00048dc0: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+00048dd0: 2020 2020 2020 2020 2020 2020 220a 2020              ".  
+00048de0: 2020 2020 2020 2020 2020 2b20 2220 2020            + "   
+00048df0: 2020 205c 6e5b 2020 2031 202d 2032 3031     \n[   1 - 201
+00048e00: 382d 3033 2d30 3120 5d20 2020 2020 2020  8-03-01 ]       
+00048e10: 2022 0a20 2020 2020 2020 2020 2020 202b   ".            +
+00048e20: 2022 6465 6620 2020 2020 2020 2020 2020   "def           
+00048e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00048e40: 2064 6566 2020 2020 2020 2020 2020 2020   def            
+00048e50: 220a 2020 2020 2020 2020 2020 2020 2b20  ".            + 
+00048e60: 2220 2020 2020 202d 2020 2020 2020 2020  "      -        
+00048e70: 2020 2020 2020 2020 2020 205c 6e5b 2020             \n[  
+00048e80: 2032 202d 2022 0a20 2020 2020 2020 2020   2 - ".         
+00048e90: 2020 202b 2074 6f64 6179 0a20 2020 2020     + today.     
+00048ea0: 2020 2020 2020 202b 2022 205d 220a 2020         + " ]".  
+00048eb0: 2020 2020 2020 2020 2020 2b20 2220 2028            + "  (
+00048ec0: 7265 7629 2061 6263 2020 2020 2020 2020  rev) abc        
+00048ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00048ee0: 2020 2020 3132 3334 2020 2020 220a 2020      1234    ".  
+00048ef0: 2020 2020 2020 2020 2020 2b20 2220 2020            + "   
+00048f00: 2020 2020 2020 2020 2020 736f 6d65 646f            somedo
+00048f10: 6920 2020 2020 2020 2020 2020 2020 5c6e  i             \n
+00048f20: 222c 0a20 2020 2020 2020 2029 0a20 2020  ",.        ).   
+00048f30: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00048f40: 5f73 7464 6f75 7428 0a20 2020 2020 2020  _stdout(.       
+00048f50: 2020 2020 206c 616d 6264 613a 2073 656c       lambda: sel
+00048f60: 662e 7042 4442 2e62 6962 732e 7072 696e  f.pBDB.bibs.prin
+00048f70: 7441 6c6c 496e 666f 280a 2020 2020 2020  tAllInfo(.      
+00048f80: 2020 2020 2020 2020 2020 656e 7472 6965            entrie
+00048f90: 7349 6e3d 7365 6c66 2e70 4244 422e 6269  sIn=self.pBDB.bi
+00048fa0: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
+00048fb0: 6162 6322 290a 2020 2020 2020 2020 2020  abc").          
+00048fc0: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00048fd0: 2022 5b20 2020 3020 2d20 220a 2020 2020   "[   0 - ".    
+00048fe0: 2020 2020 2020 2020 2b20 746f 6461 790a          + today.
+00048ff0: 2020 2020 2020 2020 2020 2020 2b20 2220              + " 
+00049000: 5d20 2028 7265 7629 2061 6263 2020 2020  ]  (rev) abc    
+00049010: 2020 2020 2020 2022 0a20 2020 2020 2020         ".       
+00049020: 2020 2020 202b 2022 2020 2020 2020 2020       + "        
+00049030: 2020 2020 2020 2020 2031 3233 3420 2020           1234   
+00049040: 2020 2020 2020 2020 2020 2020 2020 736f                so
+00049050: 6d65 646f 6920 2020 2022 0a20 2020 2020  medoi    ".     
+00049060: 2020 2020 2020 202b 2022 2020 2020 2020         + "      
+00049070: 2020 205c 6e22 2c0a 2020 2020 2020 2020     \n",.        
+00049080: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00049090: 7373 6572 745f 7374 646f 7574 280a 2020  ssert_stdout(.  
+000490a0: 2020 2020 2020 2020 2020 6c61 6d62 6461            lambda
+000490b0: 3a20 7365 6c66 2e70 4244 422e 6269 6273  : self.pBDB.bibs
+000490c0: 2e70 7269 6e74 416c 6c49 6e66 6f28 0a20  .printAllInfo(. 
+000490d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000490e0: 6e74 7269 6573 496e 3d73 656c 662e 7042  ntriesIn=self.pB
+000490f0: 4442 2e62 6962 732e 6765 7442 7942 6962  DB.bibs.getByBib
+00049100: 6b65 7928 2261 6263 2229 2c20 6164 6446  key("abc"), addF
+00049110: 6965 6c64 733d 2261 7574 686f 7222 0a20  ields="author". 
+00049120: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+00049130: 2020 2020 2020 2020 2020 225b 2020 2030            "[   0
+00049140: 202d 2022 0a20 2020 2020 2020 2020 2020   - ".           
+00049150: 202b 2074 6f64 6179 0a20 2020 2020 2020   + today.       
+00049160: 2020 2020 202b 2022 205d 2020 2872 6576       + " ]  (rev
+00049170: 2920 6162 6320 2020 2020 2020 2020 2020  ) abc           
+00049180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049190: 220a 2020 2020 2020 2020 2020 2020 2b20  ".            + 
+000491a0: 2220 3132 3334 2020 2020 2020 2020 2020  " 1234          
+000491b0: 2020 2020 2020 2073 6f6d 6564 6f69 2020         somedoi  
+000491c0: 2020 2020 2020 2020 2020 205c 6e20 2020             \n   
+000491d0: 220a 2020 2020 2020 2020 2020 2020 2b20  ".            + 
+000491e0: 2261 7574 686f 723a 206d 655c 6e22 2c0a  "author: me\n",.
+000491f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00049200: 2020 7365 6c66 2e61 7373 6572 745f 7374    self.assert_st
+00049210: 646f 7574 280a 2020 2020 2020 2020 2020  dout(.          
+00049220: 2020 6c61 6d62 6461 3a20 7365 6c66 2e70    lambda: self.p
+00049230: 4244 422e 6269 6273 2e70 7269 6e74 416c  BDB.bibs.printAl
+00049240: 6c49 6e66 6f28 0a20 2020 2020 2020 2020  lInfo(.         
+00049250: 2020 2020 2020 2065 6e74 7269 6573 496e         entriesIn
+00049260: 3d73 656c 662e 7042 4442 2e62 6962 732e  =self.pBDB.bibs.
+00049270: 6765 7442 7942 6962 6b65 7928 2261 6263  getByBibkey("abc
+00049280: 2229 2c20 6164 6446 6965 6c64 733d 5b22  "), addFields=["
+00049290: 6175 7468 6f72 225d 0a20 2020 2020 2020  author"].       
+000492a0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+000492b0: 2020 2020 225b 2020 2030 202d 2022 0a20      "[   0 - ". 
+000492c0: 2020 2020 2020 2020 2020 202b 2074 6f64             + tod
+000492d0: 6179 0a20 2020 2020 2020 2020 2020 202b  ay.            +
+000492e0: 2022 205d 2020 2872 6576 2920 6162 6320   " ]  (rev) abc 
+000492f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049300: 2020 2020 2020 2020 2020 2022 0a20 2020             ".   
+00049310: 2020 2020 2020 2020 202b 2022 3132 3334           + "1234
+00049320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049330: 2073 6f6d 6564 6f69 2020 2020 2020 2020   somedoi        
+00049340: 2020 2020 205c 6e20 2020 6175 7468 6f72       \n   author
+00049350: 3a20 6d65 220a 2020 2020 2020 2020 2020  : me".          
+00049360: 2020 2b20 225c 6e22 2c0a 2020 2020 2020    + "\n",.      
+00049370: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00049380: 2e61 7373 6572 745f 7374 646f 7574 280a  .assert_stdout(.
+00049390: 2020 2020 2020 2020 2020 2020 6c61 6d62              lamb
+000493a0: 6461 3a20 7365 6c66 2e70 4244 422e 6269  da: self.pBDB.bi
+000493b0: 6273 2e70 7269 6e74 416c 6c49 6e66 6f28  bs.printAllInfo(
+000493c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000493d0: 2065 6e74 7269 6573 496e 3d73 656c 662e   entriesIn=self.
+000493e0: 7042 4442 2e62 6962 732e 6765 7442 7942  pBDB.bibs.getByB
+000493f0: 6962 6b65 7928 2261 6263 2229 2c20 6164  ibkey("abc"), ad
+00049400: 6446 6965 6c64 733d 2274 6974 6c65 220a  dFields="title".
+00049410: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00049420: 2020 2020 2020 2020 2020 2022 5b20 2020             "[   
+00049430: 3020 2d20 220a 2020 2020 2020 2020 2020  0 - ".          
+00049440: 2020 2b20 746f 6461 790a 2020 2020 2020    + today.      
+00049450: 2020 2020 2020 2b20 2220 5d20 2028 7265        + " ]  (re
+00049460: 7629 2061 6263 2020 2020 2020 2020 2020  v) abc          
+00049470: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00049480: 0a20 2020 2020 2020 2020 2020 202b 2022  .            + "
+00049490: 2020 2031 3233 3420 2020 2020 2020 2020     1234         
+000494a0: 2020 2020 2020 2020 736f 6d65 646f 6920          somedoi 
+000494b0: 2020 2020 2020 2020 2020 2020 5c6e 2020              \n  
+000494c0: 2022 0a20 2020 2020 2020 2020 2020 202b   ".            +
+000494d0: 2022 7469 746c 653a 207b 6162 637d 5c6e   "title: {abc}\n
+000494e0: 222c 0a20 2020 2020 2020 2029 0a20 2020  ",.        ).   
+000494f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00049500: 5f73 7464 6f75 7428 0a20 2020 2020 2020  _stdout(.       
+00049510: 2020 2020 206c 616d 6264 613a 2073 656c       lambda: sel
+00049520: 662e 7042 4442 2e62 6962 732e 7072 696e  f.pBDB.bibs.prin
+00049530: 7441 6c6c 496e 666f 280a 2020 2020 2020  tAllInfo(.      
+00049540: 2020 2020 2020 2020 2020 656e 7472 6965            entrie
+00049550: 7349 6e3d 7365 6c66 2e70 4244 422e 6269  sIn=self.pBDB.bi
+00049560: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
+00049570: 6162 6322 292c 0a20 2020 2020 2020 2020  abc"),.         
+00049580: 2020 2020 2020 2061 6464 4669 656c 6473         addFields
+00049590: 3d5b 2265 7072 696e 7422 2c20 226a 6f75  =["eprint", "jou
+000495a0: 726e 616c 7322 5d2c 0a20 2020 2020 2020  rnals"],.       
+000495b0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+000495c0: 2020 2020 225b 2020 2030 202d 2022 0a20      "[   0 - ". 
+000495d0: 2020 2020 2020 2020 2020 202b 2074 6f64             + tod
+000495e0: 6179 0a20 2020 2020 2020 2020 2020 202b  ay.            +
+000495f0: 2022 205d 2020 2872 6576 2920 6162 6320   " ]  (rev) abc 
+00049600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049610: 2020 2020 2020 2020 2022 0a20 2020 2020           ".     
+00049620: 2020 2020 2020 202b 2022 2020 3132 3334         + "  1234
+00049630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049640: 2073 6f6d 6564 6f69 2020 2020 2020 2020   somedoi        
+00049650: 2020 2020 205c 6e22 2c0a 2020 2020 2020       \n",.      
+00049660: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
+00049670: 745f 7265 6164 456e 7472 6965 7328 7365  t_readEntries(se
+00049680: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
+00049690: 2020 2020 2222 2274 6573 7420 7265 6164      """test read
+000496a0: 456e 7472 6965 7322 2222 0a20 2020 2020  Entries""".     
+000496b0: 2020 2072 6573 203d 204d 6167 6963 4d6f     res = MagicMo
+000496c0: 636b 2829 0a20 2020 2020 2020 2072 6573  ck().        res
+000496d0: 2e65 6e74 7269 6573 203d 205b 5d0a 2020  .entries = [].  
+000496e0: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+000496f0: 2822 6269 6274 6578 7061 7273 6572 2e62  ("bibtexparser.b
+00049700: 7061 7273 6572 2e42 6962 5465 7850 6172  parser.BibTexPar
+00049710: 7365 722e 7061 7273 6522 2c20 7265 7475  ser.parse", retu
+00049720: 726e 5f76 616c 7565 3d72 6573 2920 6173  rn_value=res) as
+00049730: 205f 663a 0a20 2020 2020 2020 2020 2020   _f:.           
+00049740: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00049750: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+00049760: 2e72 6561 6445 6e74 7269 6573 2822 6162  .readEntries("ab
+00049770: 6322 292c 205b 5d29 0a20 2020 2020 2020  c"), []).       
+00049780: 2020 2020 205f 662e 6173 7365 7274 5f63       _f.assert_c
+00049790: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+000497a0: 2261 6263 2229 0a20 2020 2020 2020 2020  "abc").         
+000497b0: 2020 2072 6573 2e65 6e74 7269 6573 203d     res.entries =
+000497c0: 205b 7b22 6122 3a20 2262 227d 5d0a 2020   [{"a": "b"}].  
+000497d0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000497e0: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+000497f0: 7042 4442 2e62 6962 732e 7265 6164 456e  pBDB.bibs.readEn
+00049800: 7472 6965 7328 2261 6263 2229 2c20 5b7b  tries("abc"), [{
+00049810: 2261 223a 2022 6222 7d5d 290a 2020 2020  "a": "b"}]).    
+00049820: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
+00049830: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
+00049840: 7465 7870 6172 7365 722e 6270 6172 7365  texparser.bparse
+00049850: 722e 4269 6254 6578 5061 7273 6572 2e70  r.BibTexParser.p
+00049860: 6172 7365 222c 2073 6964 655f 6566 6665  arse", side_effe
+00049870: 6374 3d56 616c 7565 4572 726f 720a 2020  ct=ValueError.  
+00049880: 2020 2020 2020 2920 6173 205f 663a 0a20        ) as _f:. 
+00049890: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+000498a0: 7365 6c66 2e61 7373 6572 7452 6169 7365  self.assertRaise
+000498b0: 7328 5661 6c75 6545 7272 6f72 293a 0a20  s(ValueError):. 
+000498c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000498d0: 656c 662e 7042 4442 2e62 6962 732e 7265  elf.pBDB.bibs.re
+000498e0: 6164 456e 7472 6965 7328 2261 6263 2229  adEntries("abc")
+000498f0: 0a0a 2020 2020 6465 6620 7465 7374 5f72  ..    def test_r
+00049900: 6561 6445 6e74 7279 2873 656c 662c 202a  eadEntry(self, *
+00049910: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
+00049920: 2222 7465 7374 2072 6561 6445 6e74 7279  ""test readEntry
+00049930: 2222 220a 2020 2020 2020 2020 7769 7468  """.        with
+00049940: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+00049950: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
+00049960: 6461 7461 6261 7365 2e45 6e74 7269 6573  database.Entries
+00049970: 2e72 6561 6445 6e74 7269 6573 222c 0a20  .readEntries",. 
+00049980: 2020 2020 2020 2020 2020 2073 6964 655f             side_
+00049990: 6566 6665 6374 3d5b 3132 332c 207b 2261  effect=[123, {"a
+000499a0: 6263 227d 2c20 5b5d 2c20 5b7b 2261 223a  bc"}, [], [{"a":
+000499b0: 2022 6222 7d5d 5d2c 0a20 2020 2020 2020   "b"}]],.       
+000499c0: 2029 2061 7320 5f66 3a0a 2020 2020 2020   ) as _f:.      
+000499d0: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
+000499e0: 6173 7365 7274 5261 6973 6573 2854 7970  assertRaises(Typ
+000499f0: 6545 7272 6f72 293a 0a20 2020 2020 2020  eError):.       
+00049a00: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00049a10: 4442 2e62 6962 732e 7265 6164 456e 7472  DB.bibs.readEntr
+00049a20: 7928 2261 6263 2229 0a20 2020 2020 2020  y("abc").       
+00049a30: 2020 2020 2020 2020 205f 662e 6173 7365           _f.asse
+00049a40: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
+00049a50: 6974 6828 2261 6263 2229 0a20 2020 2020  ith("abc").     
+00049a60: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
+00049a70: 2e61 7373 6572 7452 6169 7365 7328 5479  .assertRaises(Ty
+00049a80: 7065 4572 726f 7229 3a0a 2020 2020 2020  peError):.      
+00049a90: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00049aa0: 4244 422e 6269 6273 2e72 6561 6445 6e74  BDB.bibs.readEnt
+00049ab0: 7279 2822 6162 6322 290a 2020 2020 2020  ry("abc").      
+00049ac0: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
+00049ad0: 6173 7365 7274 5261 6973 6573 2849 6e64  assertRaises(Ind
+00049ae0: 6578 4572 726f 7229 3a0a 2020 2020 2020  exError):.      
+00049af0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00049b00: 4244 422e 6269 6273 2e72 6561 6445 6e74  BDB.bibs.readEnt
+00049b10: 7279 2822 6162 6322 290a 2020 2020 2020  ry("abc").      
+00049b20: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00049b30: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
+00049b40: 2e62 6962 732e 7265 6164 456e 7472 7928  .bibs.readEntry(
+00049b50: 2261 6263 2229 2c20 7b22 6122 3a20 2262  "abc"), {"a": "b
+00049b60: 227d 290a 0a20 2020 2064 6566 2074 6573  "})..    def tes
+00049b70: 745f 7265 706c 6163 6528 7365 6c66 2c20  t_replace(self, 
+00049b80: 2a61 7267 7329 3a0a 2020 2020 2020 2020  *args):.        
+00049b90: 2222 2274 6573 7420 7265 706c 6163 6520  """test replace 
+00049ba0: 6675 6e63 7469 6f6e 7322 2222 0a20 2020  functions""".   
+00049bb0: 2020 2020 2023 2072 6570 6c61 6365 496e       # replaceIn
+00049bc0: 4269 6274 6578 0a20 2020 2020 2020 2062  Bibtex.        b
+00049bd0: 6962 7465 7849 6e20 3d20 280a 2020 2020  ibtexIn = (.    
+00049be0: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
+00049bf0: 657b 6162 632c 5c6e 6175 7468 6f72 203d  e{abc,\nauthor =
+00049c00: 2022 6d65 222c 5c6e 270a 2020 2020 2020   "me",\n'.      
+00049c10: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
+00049c20: 2022 6162 6322 2c5c 6e6a 6f75 726e 616c   "abc",\njournal
+00049c30: 3d22 6a63 6170 222c 5c6e 766f 6c75 6d65  ="jcap",\nvolume
+00049c40: 3d22 3138 3033 222c 5c6e 270a 2020 2020  ="1803",\n'.    
+00049c50: 2020 2020 2020 2020 2b20 2779 6561 723d          + 'year=
+00049c60: 2232 3031 3822 2c5c 6e70 6167 6573 3d22  "2018",\npages="
+00049c70: 3122 2c5c 6e61 7278 6976 3d22 3132 3334  1",\narxiv="1234
+00049c80: 2e35 3637 3839 222c 5c6e 7d27 0a20 2020  .56789",\n}'.   
+00049c90: 2020 2020 2029 0a20 2020 2020 2020 2062       ).        b
+00049ca0: 6962 7465 784f 7574 203d 2028 0a20 2020  ibtexOut = (.   
+00049cb0: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+00049cc0: 6c65 7b61 6263 2c5c 6e61 7574 686f 7220  le{abc,\nauthor 
+00049cd0: 3d20 226d 6522 2c5c 6e27 0a20 2020 2020  = "me",\n'.     
+00049ce0: 2020 2020 2020 202b 2027 7469 746c 6520         + 'title 
+00049cf0: 3d20 2261 6263 222c 5c6e 6a6f 7572 6e61  = "abc",\njourna
+00049d00: 6c3d 226a 6361 7022 2c5c 6e76 6f6c 756d  l="jcap",\nvolum
+00049d10: 653d 2231 3830 3322 2c5c 6e27 0a20 2020  e="1803",\n'.   
+00049d20: 2020 2020 2020 2020 202b 2027 7965 6172           + 'year
+00049d30: 3d22 3230 3138 222c 5c6e 7061 6765 733d  ="2018",\npages=
+00049d40: 2231 222c 5c6e 6172 7869 763d 2231 3233  "1",\narxiv="123
+00049d50: 342e 3536 3738 3922 2c5c 6e7d 270a 2020  4.56789",\n}'.  
+00049d60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00049d70: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+00049d80: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
+00049d90: 6e73 6572 7446 726f 6d42 6962 7465 7828  nsertFromBibtex(
+00049da0: 6269 6274 6578 496e 2929 0a20 2020 2020  bibtexIn)).     
+00049db0: 2020 2062 6962 7465 784f 7574 203d 2073     bibtexOut = s
+00049dc0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+00049dd0: 7446 6965 6c64 2822 6162 6322 2c20 2262  tField("abc", "b
+00049de0: 6962 7465 7822 290a 2020 2020 2020 2020  ibtex").        
+00049df0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00049e00: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00049e10: 7265 706c 6163 6549 6e42 6962 7465 7828  replaceInBibtex(
+00049e20: 2261 6263 6422 2c20 2261 6263 6465 2229  "abcd", "abcde")
+00049e30: 2c20 5b5d 290a 2020 2020 2020 2020 7365  , []).        se
+00049e40: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00049e50: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+00049e60: 7446 6965 6c64 2822 6162 6322 2c20 2262  tField("abc", "b
+00049e70: 6962 7465 7822 292c 2062 6962 7465 784f  ibtex"), bibtexO
+00049e80: 7574 290a 2020 2020 2020 2020 7365 6c66  ut).        self
+00049e90: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
+00049ea0: 662e 7042 4442 2e62 6962 732e 7265 706c  f.pBDB.bibs.repl
+00049eb0: 6163 6549 6e42 6962 7465 7828 226a 6361  aceInBibtex("jca
+00049ec0: 7022 2c20 224a 4341 5022 292c 205b 2261  p", "JCAP"), ["a
+00049ed0: 6263 225d 290a 2020 2020 2020 2020 7365  bc"]).        se
+00049ee0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00049ef0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00049f00: 2e70 4244 422e 6269 6273 2e67 6574 4669  .pBDB.bibs.getFi
+00049f10: 656c 6428 2261 6263 222c 2022 6269 6274  eld("abc", "bibt
+00049f20: 6578 2229 2c20 6269 6274 6578 4f75 742e  ex"), bibtexOut.
+00049f30: 7265 706c 6163 6528 226a 6361 7022 2c20  replace("jcap", 
+00049f40: 224a 4341 5022 290a 2020 2020 2020 2020  "JCAP").        
+00049f50: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00049f60: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+00049f70: 7042 4442 2e62 6962 732e 7265 706c 6163  pBDB.bibs.replac
+00049f80: 6549 6e42 6962 7465 7828 224a 4341 5022  eInBibtex("JCAP"
+00049f90: 2c20 226a 6361 7022 292c 205b 2261 6263  , "jcap"), ["abc
+00049fa0: 225d 290a 0a20 2020 2020 2020 2073 656c  "])..        sel
+00049fb0: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00049fc0: 6c66 2e70 4244 422e 6269 6273 2e72 6570  lf.pBDB.bibs.rep
+00049fd0: 6c61 6365 496e 4269 6274 6578 2822 6a63  laceInBibtex("jc
+00049fe0: 6170 222c 205b 224a 4341 5022 5d29 2c20  ap", ["JCAP"]), 
+00049ff0: 4661 6c73 6529 0a20 2020 2020 2020 2073  False).        s
+0004a000: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0004a010: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+0004a020: 6574 4669 656c 6428 2261 6263 222c 2022  etField("abc", "
+0004a030: 6269 6274 6578 2229 2c20 6269 6274 6578  bibtex"), bibtex
+0004a040: 4f75 7429 0a20 2020 2020 2020 2077 6974  Out).        wit
+0004a050: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
+0004a060: 2e4c 6f67 6765 722e 6578 6365 7074 696f  .Logger.exceptio
+0004a070: 6e22 2920 6173 205f 653a 0a20 2020 2020  n") as _e:.     
+0004a080: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0004a090: 2e62 6962 732e 7265 706c 6163 6549 6e42  .bibs.replaceInB
+0004a0a0: 6962 7465 7828 226a 6361 7022 2c20 5b22  ibtex("jcap", ["
+0004a0b0: 4a43 4150 225d 290a 2020 2020 2020 2020  JCAP"]).        
+0004a0c0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+0004a0d0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0004a0e0: 2020 2022 4572 726f 7220 6269 6e64 696e     "Error bindin
+0004a0f0: 6720 7061 7261 6d65 7465 7222 2c0a 2020  g parameter",.  
+0004a100: 2020 2020 2020 2020 2020 2020 2020 5f65                _e
+0004a110: 2e63 616c 6c5f 6172 6773 5b30 5d5b 305d  .call_args[0][0]
+0004a120: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0004a130: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0004a140: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+0004a150: 4442 2e62 6962 732e 7265 706c 6163 6549  DB.bibs.replaceI
+0004a160: 6e42 6962 7465 7828 5b22 6a63 6170 225d  nBibtex(["jcap"]
+0004a170: 2c20 224a 4341 5022 292c 2046 616c 7365  , "JCAP"), False
+0004a180: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0004a190: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+0004a1a0: 7042 4442 2e62 6962 732e 6765 7446 6965  pBDB.bibs.getFie
+0004a1b0: 6c64 2822 6162 6322 2c20 2262 6962 7465  ld("abc", "bibte
+0004a1c0: 7822 292c 2062 6962 7465 784f 7574 290a  x"), bibtexOut).
+0004a1d0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0004a1e0: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
+0004a1f0: 6572 2e65 7863 6570 7469 6f6e 2229 2061  er.exception") a
+0004a200: 7320 5f65 3a0a 2020 2020 2020 2020 2020  s _e:.          
+0004a210: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0004a220: 2e72 6570 6c61 6365 496e 4269 6274 6578  .replaceInBibtex
+0004a230: 285b 226a 6361 7022 5d2c 2022 4a43 4150  (["jcap"], "JCAP
+0004a240: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
+0004a250: 656c 662e 6173 7365 7274 496e 280a 2020  elf.assertIn(.  
+0004a260: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+0004a270: 7272 6f72 2062 696e 6469 6e67 2070 6172  rror binding par
+0004a280: 616d 6574 6572 222c 0a20 2020 2020 2020  ameter",.       
+0004a290: 2020 2020 2020 2020 205f 652e 6361 6c6c           _e.call
+0004a2a0: 5f61 7267 735b 305d 5b30 5d2c 0a20 2020  _args[0][0],.   
+0004a2b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0004a2c0: 2020 2020 2320 7265 706c 6163 650a 2020      # replace.  
+0004a2d0: 2020 2020 2020 6269 6274 6578 4f75 7420        bibtexOut 
+0004a2e0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+0004a2f0: 2740 4172 7469 636c 657b 6162 632c 5c6e  '@Article{abc,\n
+0004a300: 2020 2020 2020 2020 6175 7468 6f72 203d          author =
+0004a310: 2022 6d65 222c 5c6e 2020 2020 2020 2020   "me",\n        
+0004a320: 2027 0a20 2020 2020 2020 2020 2020 202b   '.            +
+0004a330: 2027 7469 746c 6520 3d20 227b 6162 637d   'title = "{abc}
+0004a340: 222c 5c6e 2020 2020 2020 206a 6f75 726e  ",\n       journ
+0004a350: 616c 203d 2022 6a63 6170 222c 5c6e 2020  al = "jcap",\n  
+0004a360: 2020 2020 2020 270a 2020 2020 2020 2020        '.        
+0004a370: 2020 2020 2b20 2776 6f6c 756d 6520 3d20      + 'volume = 
+0004a380: 2231 3830 3322 2c5c 6e20 2020 2020 2020  "1803",\n       
+0004a390: 2020 2079 6561 7220 3d20 2232 3031 3822     year = "2018"
+0004a3a0: 2c5c 6e20 2020 2020 2020 2020 270a 2020  ,\n         '.  
+0004a3b0: 2020 2020 2020 2020 2020 2b20 2770 6167            + 'pag
+0004a3c0: 6573 203d 2022 3122 2c5c 6e20 2020 2020  es = "1",\n     
+0004a3d0: 2020 2020 6172 7869 7620 3d20 2231 3233      arxiv = "123
+0004a3e0: 342e 3536 3738 3922 2c5c 6e7d 270a 2020  4.56789",\n}'.  
+0004a3f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0004a400: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0004a410: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0004a420: 6c66 2e70 4244 422e 6269 6273 2e72 6570  lf.pBDB.bibs.rep
+0004a430: 6c61 6365 2822 6269 6274 6578 222c 205b  lace("bibtex", [
+0004a440: 2262 6962 7465 7822 5d2c 2022 6162 6364  "bibtex"], "abcd
+0004a450: 222c 205b 2261 6263 6465 225d 292c 0a20  ", ["abcde"]),. 
+0004a460: 2020 2020 2020 2020 2020 2028 5b22 6162             (["ab
+0004a470: 6322 5d2c 205b 5d2c 205b 5d29 2c0a 2020  c"], [], []),.  
+0004a480: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0004a490: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0004a4a0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+0004a4b0: 6765 7446 6965 6c64 2822 6162 6322 2c20  getField("abc", 
+0004a4c0: 2262 6962 7465 7822 292c 2062 6962 7465  "bibtex"), bibte
+0004a4d0: 784f 7574 290a 0a20 2020 2020 2020 2070  xOut)..        p
+0004a4e0: 626d 203d 204d 6167 6963 4d6f 636b 2829  bm = MagicMock()
+0004a4f0: 0a20 2020 2020 2020 2070 6276 203d 204d  .        pbv = M
+0004a500: 6167 6963 4d6f 636b 2829 0a20 2020 2020  agicMock().     
+0004a510: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0004a520: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0004a530: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0004a540: 7265 706c 6163 6528 0a20 2020 2020 2020  replace(.       
+0004a550: 2020 2020 2020 2020 2022 766f 6c75 6d65           "volume
+0004a560: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0004a570: 2020 205b 2276 6f6c 756d 6522 5d2c 0a20     ["volume"],. 
+0004a580: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0004a590: 285b 302d 395d 7b32 7d29 285b 302d 395d  ([0-9]{2})([0-9]
+0004a5a0: 7b32 7d29 222c 0a20 2020 2020 2020 2020  {2})",.         
+0004a5b0: 2020 2020 2020 205b 7222 5c32 225d 2c0a         [r"\2"],.
+0004a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a5d0: 7265 6765 783d 5472 7565 2c0a 2020 2020  regex=True,.    
+0004a5e0: 2020 2020 2020 2020 2020 2020 7062 4d61              pbMa
+0004a5f0: 783d 7062 6d2c 0a20 2020 2020 2020 2020  x=pbm,.         
+0004a600: 2020 2020 2020 2070 6256 616c 3d70 6276         pbVal=pbv
+0004a610: 2c0a 2020 2020 2020 2020 2020 2020 292c  ,.            ),
+0004a620: 0a20 2020 2020 2020 2020 2020 2028 5b22  .            (["
+0004a630: 6162 6322 5d2c 205b 2261 6263 225d 2c20  abc"], ["abc"], 
+0004a640: 5b5d 292c 0a20 2020 2020 2020 2029 0a20  []),.        ). 
+0004a650: 2020 2020 2020 2070 626d 2e61 7373 6572         pbm.asser
+0004a660: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+0004a670: 7468 2831 290a 2020 2020 2020 2020 7062  th(1).        pb
+0004a680: 762e 6173 7365 7274 5f63 616c 6c65 645f  v.assert_called_
+0004a690: 6f6e 6365 5f77 6974 6828 3129 0a20 2020  once_with(1).   
+0004a6a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0004a6b0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+0004a6c0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0004a6d0: 732e 6765 7446 6965 6c64 2822 6162 6322  s.getField("abc"
+0004a6e0: 2c20 2262 6962 7465 7822 292c 2062 6962  , "bibtex"), bib
+0004a6f0: 7465 784f 7574 2e72 6570 6c61 6365 2822  texOut.replace("
+0004a700: 3138 3033 222c 2022 3033 2229 0a20 2020  1803", "03").   
+0004a710: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0004a720: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0004a730: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0004a740: 6c66 2e70 4244 422e 6269 6273 2e72 6570  lf.pBDB.bibs.rep
+0004a750: 6c61 6365 2822 766f 6c75 6d65 222c 205b  lace("volume", [
+0004a760: 2276 6f6c 756d 6522 5d2c 2022 3033 222c  "volume"], "03",
+0004a770: 205b 7222 3138 3033 225d 292c 0a20 2020   [r"1803"]),.   
+0004a780: 2020 2020 2020 2020 2028 5b22 6162 6322           (["abc"
+0004a790: 5d2c 205b 2261 6263 225d 2c20 5b5d 292c  ], ["abc"], []),
+0004a7a0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0004a7b0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0004a7c0: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
+0004a7d0: 6273 2e67 6574 4669 656c 6428 2261 6263  bs.getField("abc
+0004a7e0: 222c 2022 6269 6274 6578 2229 2c20 6269  ", "bibtex"), bi
+0004a7f0: 6274 6578 4f75 7429 0a0a 2020 2020 2020  btexOut)..      
+0004a800: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0004a810: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0004a820: 7365 6c66 2e70 4244 422e 6269 6273 2e72  self.pBDB.bibs.r
+0004a830: 6570 6c61 6365 280a 2020 2020 2020 2020  eplace(.        
+0004a840: 2020 2020 2020 2020 2276 6f6c 756d 6522          "volume"
+0004a850: 2c20 5b22 766f 6c75 6d65 222c 2022 6a6f  , ["volume", "jo
+0004a860: 7572 6e61 6c22 5d2c 2022 3138 3033 222c  urnal"], "1803",
+0004a870: 205b 2230 3322 2c20 2231 3830 3322 5d0a   ["03", "1803"].
+0004a880: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0004a890: 2020 2020 2020 2020 2020 2028 5b22 6162             (["ab
+0004a8a0: 6322 5d2c 205b 2261 6263 225d 2c20 5b5d  c"], ["abc"], []
+0004a8b0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+0004a8c0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0004a8d0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+0004a8e0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0004a8f0: 732e 6765 7446 6965 6c64 2822 6162 6322  s.getField("abc"
+0004a900: 2c20 2262 6962 7465 7822 292c 0a20 2020  , "bibtex"),.   
+0004a910: 2020 2020 2020 2020 2062 6962 7465 784f           bibtexO
+0004a920: 7574 2e72 6570 6c61 6365 2822 3138 3033  ut.replace("1803
+0004a930: 222c 2022 3033 2229 2e72 6570 6c61 6365  ", "03").replace
+0004a940: 2822 6a63 6170 222c 2022 3138 3033 2229  ("jcap", "1803")
+0004a950: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0004a960: 2020 2020 2062 6962 7465 7849 6e20 3d20       bibtexIn = 
+0004a970: 280a 2020 2020 2020 2020 2020 2020 2740  (.            '@
+0004a980: 6172 7469 636c 657b 6465 662c 5c6e 6175  article{def,\nau
+0004a990: 7468 6f72 203d 2022 6d65 222c 5c6e 270a  thor = "me",\n'.
+0004a9a0: 2020 2020 2020 2020 2020 2020 2b20 2774              + 't
+0004a9b0: 6974 6c65 203d 2022 6465 6622 2c5c 6e6a  itle = "def",\nj
+0004a9c0: 6f75 726e 616c 3d22 5068 7973 2e20 5265  ournal="Phys. Re
+0004a9d0: 762e 222c 5c6e 766f 6c75 6d65 3d22 4439  v.",\nvolume="D9
+0004a9e0: 3522 2c5c 6e27 0a20 2020 2020 2020 2020  5",\n'.         
+0004a9f0: 2020 202b 2027 7965 6172 3d22 3230 3138     + 'year="2018
+0004aa00: 222c 5c6e 7061 6765 733d 2231 222c 5c6e  ",\npages="1",\n
+0004aa10: 6172 7869 763d 2231 3233 342e 3536 3738  arxiv="1234.5678
+0004aa20: 3922 2c5c 6e7d 270a 2020 2020 2020 2020  9",\n}'.        
+0004aa30: 290a 2020 2020 2020 2020 6269 6274 6578  ).        bibtex
+0004aa40: 4f75 7420 3d20 280a 2020 2020 2020 2020  Out = (.        
+0004aa50: 2020 2020 2740 4172 7469 636c 657b 6465      '@Article{de
+0004aa60: 662c 5c6e 2020 2020 2020 2020 6175 7468  f,\n        auth
+0004aa70: 6f72 203d 2022 6d65 222c 5c6e 2020 2020  or = "me",\n    
+0004aa80: 2020 2020 2027 0a20 2020 2020 2020 2020       '.         
+0004aa90: 2020 202b 2027 7469 746c 6520 3d20 227b     + 'title = "{
+0004aaa0: 6465 667d 222c 5c6e 2020 2020 2020 206a  def}",\n       j
+0004aab0: 6f75 726e 616c 203d 2022 5068 7973 2e20  ournal = "Phys. 
+0004aac0: 5265 762e 2044 222c 5c6e 2020 2020 2020  Rev. D",\n      
+0004aad0: 2020 270a 2020 2020 2020 2020 2020 2020    '.            
+0004aae0: 2b20 2776 6f6c 756d 6520 3d20 2239 3522  + 'volume = "95"
+0004aaf0: 2c5c 6e20 2020 2020 2020 2020 2079 6561  ,\n          yea
+0004ab00: 7220 3d20 2232 3031 3822 2c5c 6e20 2020  r = "2018",\n   
+0004ab10: 2020 2020 2020 270a 2020 2020 2020 2020        '.        
+0004ab20: 2020 2020 2b20 2770 6167 6573 203d 2022      + 'pages = "
+0004ab30: 3122 2c5c 6e20 2020 2020 2020 2020 6172  1",\n         ar
+0004ab40: 7869 7620 3d20 2231 3233 342e 3536 3738  xiv = "1234.5678
+0004ab50: 3922 2c5c 6e7d 270a 2020 2020 2020 2020  9",\n}'.        
+0004ab60: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0004ab70: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
+0004ab80: 4244 422e 6269 6273 2e69 6e73 6572 7446  BDB.bibs.insertF
+0004ab90: 726f 6d42 6962 7465 7828 6269 6274 6578  romBibtex(bibtex
+0004aba0: 496e 2929 0a20 2020 2020 2020 2077 6974  In)).        wit
+0004abb0: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
+0004abc0: 2e4c 6f67 6765 722e 696e 666f 2229 2061  .Logger.info") a
+0004abd0: 7320 5f69 3a0a 2020 2020 2020 2020 2020  s _i:.          
+0004abe0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0004abf0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+0004ac00: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0004ac10: 6273 2e72 6570 6c61 6365 280a 2020 2020  bs.replace(.    
+0004ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ac30: 2270 7562 6c69 7368 6564 222c 0a20 2020  "published",.   
+0004ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ac50: 205b 226a 6f75 726e 616c 222c 2022 766f   ["journal", "vo
+0004ac60: 6c75 6d65 225d 2c0a 2020 2020 2020 2020  lume"],.        
+0004ac70: 2020 2020 2020 2020 2020 2020 2228 5068              "(Ph
+0004ac80: 7973 2e20 5265 762e 205b 412d 5a5d 7b31  ys. Rev. [A-Z]{1
+0004ac90: 7d29 285b 302d 395d 7b32 7d29 2e2a 222c  })([0-9]{2}).*",
+0004aca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004acb0: 2020 2020 205b 7222 5c31 222c 2072 225c       [r"\1", r"\
+0004acc0: 3222 5d2c 0a20 2020 2020 2020 2020 2020  2"],.           
+0004acd0: 2020 2020 2020 2020 2072 6567 6578 3d54           regex=T
+0004ace0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0004acf0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+0004ad00: 2020 2020 2020 2020 285b 2261 6263 222c          (["abc",
+0004ad10: 2022 6465 6622 5d2c 205b 2264 6566 225d   "def"], ["def"]
+0004ad20: 2c20 5b5d 292c 0a20 2020 2020 2020 2020  , []),.         
+0004ad30: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0004ad40: 205f 692e 6173 7365 7274 5f68 6173 5f63   _i.assert_has_c
+0004ad50: 616c 6c73 280a 2020 2020 2020 2020 2020  alls(.          
+0004ad60: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
+0004ad70: 2020 2020 2020 2020 2020 2020 6361 6c6c              call
+0004ad80: 2822 5265 706c 6163 6520 7769 6c6c 2070  ("Replace will p
+0004ad90: 726f 6365 7373 2032 2065 6e74 7269 6573  rocess 2 entries
+0004ada0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0004adb0: 2020 2020 2020 2020 6361 6c6c 2822 7072          call("pr
+0004adc0: 6f63 6573 7369 6e67 2020 2020 2031 202f  ocessing     1 /
+0004add0: 2032 2028 3530 2e30 3025 293a 2065 6e74   2 (50.00%): ent
+0004ade0: 7279 2061 6263 2229 2c0a 2020 2020 2020  ry abc"),.      
+0004adf0: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+0004ae00: 6c6c 2822 7072 6f63 6573 7369 6e67 2020  ll("processing  
+0004ae10: 2020 2032 202f 2032 2028 3130 302e 3030     2 / 2 (100.00
+0004ae20: 2529 3a20 656e 7472 7920 6465 6622 292c  %): entry def"),
+0004ae30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004ae40: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
+0004ae50: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0004ae60: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+0004ae70: 4244 422e 6269 6273 2e67 6574 4669 656c  BDB.bibs.getFiel
+0004ae80: 6428 2264 6566 222c 2022 6269 6274 6578  d("def", "bibtex
+0004ae90: 2229 2c20 6269 6274 6578 4f75 7429 0a0a  "), bibtexOut)..
+0004aea0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0004aeb0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0004aec0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0004aed0: 6269 6273 2e72 6570 6c61 6365 280a 2020  bibs.replace(.  
+0004aee0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+0004aef0: 7562 6c69 7368 6564 222c 0a20 2020 2020  ublished",.     
+0004af00: 2020 2020 2020 2020 2020 205b 226a 6f75             ["jou
+0004af10: 726e 616c 222c 2022 766f 6c75 6d65 225d  rnal", "volume"]
+0004af20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004af30: 2020 2228 5068 7973 2e20 5265 762e 205b    "(Phys. Rev. [
+0004af40: 412d 5a5d 7b31 7d29 285b 302d 395d 7b32  A-Z]{1})([0-9]{2
+0004af50: 7d29 2e2a 222c 0a20 2020 2020 2020 2020  }).*",.         
+0004af60: 2020 2020 2020 205b 7222 5c31 222c 2072         [r"\1", r
+0004af70: 225c 3222 5d2c 0a20 2020 2020 2020 2020  "\2"],.         
+0004af80: 2020 2020 2020 2072 6567 6578 3d54 7275         regex=Tru
+0004af90: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
+0004afa0: 2c0a 2020 2020 2020 2020 2020 2020 285b  ,.            ([
+0004afb0: 2261 6263 222c 2022 6465 6622 5d2c 205b  "abc", "def"], [
+0004afc0: 5d2c 205b 5d29 2c0a 2020 2020 2020 2020  ], []),.        
+0004afd0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0004afe0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+0004aff0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0004b000: 422e 6269 6273 2e72 6570 6c61 6365 280a  B.bibs.replace(.
+0004b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b020: 2270 7562 6c69 7368 6564 222c 0a20 2020  "published",.   
+0004b030: 2020 2020 2020 2020 2020 2020 205b 226a               ["j
+0004b040: 6f75 726e 616c 222c 2022 766f 6c75 6d65  ournal", "volume
+0004b050: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0004b060: 2020 2020 2228 5068 7973 2e20 5265 762e      "(Phys. Rev.
+0004b070: 205b 412d 5a5d 7b31 7d29 285b 302d 395d   [A-Z]{1})([0-9]
+0004b080: 7b32 7d29 2e2a 222c 0a20 2020 2020 2020  {2}).*",.       
+0004b090: 2020 2020 2020 2020 205b 7222 5c31 222c           [r"\1",
+0004b0a0: 2072 225c 3222 5d2c 0a20 2020 2020 2020   r"\2"],.       
+0004b0b0: 2020 2020 2020 2020 2065 6e74 7269 6573           entries
+0004b0c0: 3d73 656c 662e 7042 4442 2e62 6962 732e  =self.pBDB.bibs.
+0004b0d0: 6765 7442 7942 6962 6b65 7928 2261 6263  getByBibkey("abc
+0004b0e0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0004b0f0: 2020 2020 7265 6765 783d 5472 7565 2c0a      regex=True,.
+0004b100: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0004b110: 2020 2020 2020 2020 2020 2028 5b22 6162             (["ab
+0004b120: 6322 5d2c 205b 5d2c 205b 5d29 2c0a 2020  c"], [], []),.  
+0004b130: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0004b140: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0004b150: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0004b160: 6c66 2e70 4244 422e 6269 6273 2e72 6570  lf.pBDB.bibs.rep
+0004b170: 6c61 6365 280a 2020 2020 2020 2020 2020  lace(.          
+0004b180: 2020 2020 2020 2270 7562 6c69 7368 6564        "published
+0004b190: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0004b1a0: 2020 205b 226a 6f75 726e 616c 222c 2022     ["journal", "
+0004b1b0: 766f 6c75 6d65 225d 2c0a 2020 2020 2020  volume"],.      
+0004b1c0: 2020 2020 2020 2020 2020 2228 5068 7973            "(Phys
+0004b1d0: 2e20 5265 762e 205b 412d 5a5d 7b31 7d29  . Rev. [A-Z]{1})
+0004b1e0: 285b 302d 395d 7b32 7d29 2e2a 222c 0a20  ([0-9]{2}).*",. 
+0004b1f0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0004b200: 7222 5c31 222c 2072 225c 3222 5d2c 0a20  r"\1", r"\2"],. 
+0004b210: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004b220: 6e74 7269 6573 3d73 656c 662e 7042 4442  ntries=self.pBDB
+0004b230: 2e62 6962 732e 6765 7442 7942 6962 6b65  .bibs.getByBibke
+0004b240: 7928 2261 6263 2229 2c0a 2020 2020 2020  y("abc"),.      
+0004b250: 2020 2020 2020 2020 2020 7265 6765 783d            regex=
+0004b260: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+0004b270: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+0004b280: 2020 285b 2261 6263 225d 2c20 5b22 6162    (["abc"], ["ab
+0004b290: 6322 5d2c 205b 5d29 2c0a 2020 2020 2020  c"], []),.      
+0004b2a0: 2020 290a 0a20 2020 2020 2020 2073 656c    )..        sel
+0004b2b0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0004b2c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0004b2d0: 7042 4442 2e62 6962 732e 7265 706c 6163  pBDB.bibs.replac
+0004b2e0: 6528 2262 6962 7465 7822 2c20 2262 6962  e("bibtex", "bib
+0004b2f0: 7465 7822 2c20 2261 6263 6422 2c20 2261  tex", "abcd", "a
+0004b300: 6263 6465 2229 2c20 285b 5d2c 205b 5d2c  bcde"), ([], [],
+0004b310: 205b 5d29 0a20 2020 2020 2020 2029 0a20   []).        ). 
+0004b320: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+0004b330: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
+0004b340: 722e 7761 726e 696e 6722 2920 6173 205f  r.warning") as _
+0004b350: 773a 0a20 2020 2020 2020 2020 2020 2073  w:.            s
+0004b360: 656c 662e 7042 4442 2e62 6962 732e 7265  elf.pBDB.bibs.re
+0004b370: 706c 6163 6528 2262 6962 7465 7822 2c20  place("bibtex", 
+0004b380: 2262 6962 7465 7822 2c20 2261 6263 6422  "bibtex", "abcd"
+0004b390: 2c20 2261 6263 6465 2229 0a20 2020 2020  , "abcde").     
+0004b3a0: 2020 2020 2020 205f 772e 6173 7365 7274         _w.assert
+0004b3b0: 5f61 6e79 5f63 616c 6c28 2249 6e76 616c  _any_call("Inval
+0004b3c0: 6964 2027 6669 4e65 7773 2720 6f72 2027  id 'fiNews' or '
+0004b3d0: 6e65 7773 2720 2874 6865 7920 6d75 7374  news' (they must
+0004b3e0: 2062 6520 6c69 7374 7329 2229 0a20 2020   be lists)").   
+0004b3f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0004b400: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+0004b410: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0004b420: 732e 7265 706c 6163 6528 2261 6263 6422  s.replace("abcd"
+0004b430: 2c20 5b22 6162 6364 225d 2c20 2231 3233  , ["abcd"], "123
+0004b440: 342e 3030 3030 3022 2c20 5b22 3536 3738  4.00000", ["5678
+0004b450: 3922 5d29 2c0a 2020 2020 2020 2020 2020  9"]),.          
+0004b460: 2020 285b 5d2c 205b 5d2c 205b 2261 6263    ([], [], ["abc
+0004b470: 222c 2022 6465 6622 5d29 2c0a 2020 2020  ", "def"]),.    
+0004b480: 2020 2020 290a 0a20 2020 2020 2020 2062      )..        b
+0004b490: 6962 7465 7849 6e20 3d20 280a 2020 2020  ibtexIn = (.    
+0004b4a0: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
+0004b4b0: 657b 6768 692c 5c6e 6175 7468 6f72 203d  e{ghi,\nauthor =
+0004b4c0: 2022 6d65 222c 5c6e 270a 2020 2020 2020   "me",\n'.      
+0004b4d0: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
+0004b4e0: 2022 6768 6922 2c5c 6e65 7072 696e 743d   "ghi",\neprint=
+0004b4f0: 2231 3233 342e 3536 3738 3922 2c5c 6e7d  "1234.56789",\n}
+0004b500: 270a 2020 2020 2020 2020 290a 2020 2020  '.        ).    
+0004b510: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+0004b520: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
+0004b530: 6273 2e69 6e73 6572 7446 726f 6d42 6962  bs.insertFromBib
+0004b540: 7465 7828 6269 6274 6578 496e 2929 0a20  tex(bibtexIn)). 
+0004b550: 2020 2020 2020 2070 626d 203d 204d 6167         pbm = Mag
+0004b560: 6963 4d6f 636b 2829 0a20 2020 2020 2020  icMock().       
+0004b570: 2070 6276 203d 204d 6167 6963 4d6f 636b   pbv = MagicMock
+0004b580: 2829 0a20 2020 2020 2020 2077 6974 6820  ().        with 
+0004b590: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
+0004b5a0: 6f67 6765 722e 696e 666f 2229 2061 7320  ogger.info") as 
+0004b5b0: 5f69 3a0a 2020 2020 2020 2020 2020 2020  _i:.            
+0004b5c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0004b5d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0004b5e0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0004b5f0: 2e72 6570 6c61 6365 280a 2020 2020 2020  .replace(.      
+0004b600: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+0004b610: 7072 696e 7422 2c0a 2020 2020 2020 2020  print",.        
+0004b620: 2020 2020 2020 2020 2020 2020 5b22 766f              ["vo
+0004b630: 6c75 6d65 225d 2c0a 2020 2020 2020 2020  lume"],.        
+0004b640: 2020 2020 2020 2020 2020 2020 2231 3233              "123
+0004b650: 342e 3030 3030 3022 2c0a 2020 2020 2020  4.00000",.      
+0004b660: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
+0004b670: 3536 3738 3922 5d2c 0a20 2020 2020 2020  56789"],.       
+0004b680: 2020 2020 2020 2020 2020 2020 206c 656e               len
+0004b690: 456e 7472 6965 733d 352c 0a20 2020 2020  Entries=5,.     
+0004b6a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004b6b0: 6e74 7269 6573 3d73 656c 662e 7042 4442  ntries=self.pBDB
+0004b6c0: 2e62 6962 732e 6665 7463 6841 6c6c 2873  .bibs.fetchAll(s
+0004b6d0: 6176 6551 7565 7279 3d46 616c 7365 292e  aveQuery=False).
+0004b6e0: 6c61 7374 4665 7463 6865 642c 0a20 2020  lastFetched,.   
+0004b6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b700: 2070 624d 6178 3d70 626d 2c0a 2020 2020   pbMax=pbm,.    
+0004b710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b720: 7062 5661 6c3d 7062 762c 0a20 2020 2020  pbVal=pbv,.     
+0004b730: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0004b740: 2020 2020 2020 2020 2020 2020 2020 285b                ([
+0004b750: 2267 6869 225d 2c20 5b22 6768 6922 5d2c  "ghi"], ["ghi"],
+0004b760: 205b 2261 6263 222c 2022 6465 6622 5d29   ["abc", "def"])
+0004b770: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0004b780: 2020 2020 2020 2020 2020 2020 5f69 2e61              _i.a
+0004b790: 7373 6572 745f 6861 735f 6361 6c6c 7328  ssert_has_calls(
+0004b7a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b7b0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0004b7c0: 2020 2020 2020 2063 616c 6c28 2252 6570         call("Rep
+0004b7d0: 6c61 6365 2077 696c 6c20 7072 6f63 6573  lace will proces
+0004b7e0: 7320 3520 656e 7472 6965 7322 292c 0a20  s 5 entries"),. 
+0004b7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b800: 2020 2063 616c 6c28 2270 726f 6365 7373     call("process
+0004b810: 696e 6720 2020 2020 3120 2f20 3520 2832  ing     1 / 5 (2
+0004b820: 302e 3030 2529 3a20 656e 7472 7920 6162  0.00%): entry ab
+0004b830: 6322 292c 0a20 2020 2020 2020 2020 2020  c"),.           
+0004b840: 2020 2020 2020 2020 2063 616c 6c28 2270           call("p
+0004b850: 726f 6365 7373 696e 6720 2020 2020 3220  rocessing     2 
+0004b860: 2f20 3520 2834 302e 3030 2529 3a20 656e  / 5 (40.00%): en
+0004b870: 7472 7920 6465 6622 292c 0a20 2020 2020  try def"),.     
+0004b880: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0004b890: 616c 6c28 2270 726f 6365 7373 696e 6720  all("processing 
+0004b8a0: 2020 2020 3320 2f20 3520 2836 302e 3030      3 / 5 (60.00
+0004b8b0: 2529 3a20 656e 7472 7920 6768 6922 292c  %): entry ghi"),
+0004b8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b8d0: 205d 0a20 2020 2020 2020 2020 2020 2029   ].            )
+0004b8e0: 0a20 2020 2020 2020 2070 626d 2e61 7373  .        pbm.ass
+0004b8f0: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
+0004b900: 7769 7468 2835 290a 2020 2020 2020 2020  with(5).        
+0004b910: 7062 762e 6173 7365 7274 5f68 6173 5f63  pbv.assert_has_c
+0004b920: 616c 6c73 285b 6361 6c6c 2869 202b 2031  alls([call(i + 1
+0004b930: 2920 666f 7220 6920 696e 2072 616e 6765  ) for i in range
+0004b940: 2833 295d 290a 2020 2020 2020 2020 7769  (3)]).        wi
+0004b950: 7468 2070 6174 6368 2822 6c6f 6767 696e  th patch("loggin
+0004b960: 672e 4c6f 6767 6572 2e65 7863 6570 7469  g.Logger.excepti
+0004b970: 6f6e 2229 2061 7320 5f69 3a0a 2020 2020  on") as _i:.    
+0004b980: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0004b990: 422e 6269 6273 2e72 6570 6c61 6365 2822  B.bibs.replace("
+0004b9a0: 6570 7269 6e74 222c 205b 2276 6f6c 756d  eprint", ["volum
+0004b9b0: 6522 5d2c 2022 3132 3334 2e30 3030 3030  e"], "1234.00000
+0004b9c0: 222c 205b 2235 3637 3839 225d 290a 2020  ", ["56789"]).  
+0004b9d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0004b9e0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0004b9f0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0004ba00: 6273 2e72 6570 6c61 6365 2822 6172 7869  bs.replace("arxi
+0004ba10: 7622 2c20 5b22 6570 7269 6e74 225d 2c20  v", ["eprint"], 
+0004ba20: 2231 3233 342e 3030 3030 3022 2c20 5b22  "1234.00000", ["
+0004ba30: 3536 3738 3922 5d29 2c0a 2020 2020 2020  56789"]),.      
+0004ba40: 2020 2020 2020 285b 2267 6869 225d 2c20        (["ghi"], 
+0004ba50: 5b5d 2c20 5b22 6162 6322 2c20 2264 6566  [], ["abc", "def
+0004ba60: 225d 292c 0a20 2020 2020 2020 2029 0a0a  "]),.        )..
+0004ba70: 2020 2020 6465 6620 7465 7374 5f72 6570      def test_rep
+0004ba80: 6c61 6365 5369 6e67 6c65 456e 7472 7928  laceSingleEntry(
+0004ba90: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+0004baa0: 2020 2020 2020 2222 2274 6573 7420 7265        """test re
+0004bab0: 706c 6163 6553 696e 676c 6545 6e74 7279  placeSingleEntry
+0004bac0: 2222 220a 2020 2020 2020 2020 6264 203d  """.        bd =
+0004bad0: 207b 2245 4e54 5259 5459 5045 223a 2022   {"ENTRYTYPE": "
+0004bae0: 6172 7469 636c 6522 2c20 2249 4422 3a20  article", "ID": 
+0004baf0: 226b 6579 3122 7d0a 2020 2020 2020 2020  "key1"}.        
+0004bb00: 7769 7468 2070 6174 6368 2822 7068 7973  with patch("phys
+0004bb10: 6269 626c 696f 2e64 6174 6162 6173 652e  biblio.database.
+0004bb20: 456e 7472 6965 732e 7570 6461 7465 4669  Entries.updateFi
+0004bb30: 656c 6422 2920 6173 205f 753a 0a20 2020  eld") as _u:.   
+0004bb40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0004bb50: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0004bb60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0004bb70: 7042 4442 2e62 6962 732e 7265 706c 6163  pBDB.bibs.replac
+0004bb80: 6553 696e 676c 6545 6e74 7279 280a 2020  eSingleEntry(.  
+0004bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bba0: 2020 302c 0a20 2020 2020 2020 2020 2020    0,.           
+0004bbb0: 2020 2020 2020 2020 207b 2262 6962 6b65           {"bibke
+0004bbc0: 7922 3a20 226b 6579 3122 2c20 2262 6962  y": "key1", "bib
+0004bbd0: 7465 7844 6963 7422 3a20 7b7d 7d2c 0a20  texDict": {}},. 
+0004bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bbf0: 2020 2022 6269 6274 6578 222c 0a20 2020     "bibtex",.   
+0004bc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bc10: 205b 2262 6962 7465 7822 5d2c 0a20 2020   ["bibtex"],.   
+0004bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bc30: 2022 6162 6364 222c 0a20 2020 2020 2020   "abcd",.       
+0004bc40: 2020 2020 2020 2020 2020 2020 205b 2261               ["a
+0004bc50: 6263 6465 225d 2c0a 2020 2020 2020 2020  bcde"],.        
+0004bc60: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+0004bc70: 2020 2020 2020 2020 2020 2028 5b5d 2c20             ([], 
+0004bc80: 5b5d 2c20 5b22 6b65 7931 225d 292c 0a20  [], ["key1"]),. 
+0004bc90: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0004bca0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0004bcb0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0004bcc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0004bcd0: 7042 4442 2e62 6962 732e 7265 706c 6163  pBDB.bibs.replac
+0004bce0: 6553 696e 676c 6545 6e74 7279 280a 2020  eSingleEntry(.  
+0004bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bd00: 2020 302c 0a20 2020 2020 2020 2020 2020    0,.           
+0004bd10: 2020 2020 2020 2020 207b 2262 6962 6b65           {"bibke
+0004bd20: 7922 3a20 226b 6579 3122 2c20 2262 6962  y": "key1", "bib
+0004bd30: 7465 7844 6963 7422 3a20 7b7d 7d2c 0a20  texDict": {}},. 
+0004bd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bd50: 2020 2022 6269 6274 6578 222c 0a20 2020     "bibtex",.   
+0004bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bd70: 205b 2262 6962 7465 7822 5d2c 0a20 2020   ["bibtex"],.   
+0004bd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bd90: 2022 6162 6364 222c 0a20 2020 2020 2020   "abcd",.       
+0004bda0: 2020 2020 2020 2020 2020 2020 205b 2261               ["a
+0004bdb0: 6263 6465 225d 2c0a 2020 2020 2020 2020  bcde"],.        
+0004bdc0: 2020 2020 2020 2020 2020 2020 6368 616e              chan
+0004bdd0: 6765 643d 5b22 6122 5d2c 0a20 2020 2020  ged=["a"],.     
+0004bde0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0004bdf0: 6169 6c65 643d 5b22 6222 5d2c 0a20 2020  ailed=["b"],.   
+0004be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004be10: 2073 7563 6365 7373 3d5b 2263 225d 2c0a   success=["c"],.
+0004be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004be30: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0004be40: 2020 2028 5b22 6322 5d2c 205b 2261 225d     (["c"], ["a"]
+0004be50: 2c20 5b22 6222 2c20 226b 6579 3122 5d29  , ["b", "key1"])
+0004be60: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0004be70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0004be80: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+0004be90: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0004bea0: 6c66 2e70 4244 422e 6269 6273 2e72 6570  lf.pBDB.bibs.rep
+0004beb0: 6c61 6365 5369 6e67 6c65 456e 7472 7928  laceSingleEntry(
+0004bec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004bed0: 2020 2020 2030 2c0a 2020 2020 2020 2020       0,.        
+0004bee0: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
+0004bef0: 626b 6579 223a 2022 6b65 7931 222c 2022  bkey": "key1", "
+0004bf00: 6269 6274 6578 223a 2022 6269 6274 6578  bibtex": "bibtex
+0004bf10: 2061 6263 6422 2c20 2262 6962 7465 7844   abcd", "bibtexD
+0004bf20: 6963 7422 3a20 7b7d 7d2c 0a20 2020 2020  ict": {}},.     
+0004bf30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0004bf40: 7469 746c 6522 2c0a 2020 2020 2020 2020  title",.        
+0004bf50: 2020 2020 2020 2020 2020 2020 5b22 6269              ["bi
+0004bf60: 6274 6578 225d 2c0a 2020 2020 2020 2020  btex"],.        
+0004bf70: 2020 2020 2020 2020 2020 2020 2261 6263              "abc
+0004bf80: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+0004bf90: 2020 2020 2020 2020 5b22 6162 6364 6522          ["abcde"
+0004bfa0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004bfb0: 2020 2020 2020 2063 6861 6e67 6564 3d5b         changed=[
+0004bfc0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004bfd0: 2020 2020 2020 2066 6169 6c65 643d 5b5d         failed=[]
+0004bfe0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004bff0: 2020 2020 2020 7375 6363 6573 733d 5b5d        success=[]
+0004c000: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004c010: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+0004c020: 2020 2020 2028 5b5d 2c20 5b5d 2c20 5b22       ([], [], ["
+0004c030: 6b65 7931 225d 292c 0a20 2020 2020 2020  key1"]),.       
+0004c040: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0004c050: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0004c060: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0004c070: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0004c080: 6962 732e 7265 706c 6163 6553 696e 676c  ibs.replaceSingl
+0004c090: 6545 6e74 7279 280a 2020 2020 2020 2020  eEntry(.        
+0004c0a0: 2020 2020 2020 2020 2020 2020 302c 0a20              0,. 
+0004c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c0c0: 2020 207b 2262 6962 6b65 7922 3a20 226b     {"bibkey": "k
+0004c0d0: 6579 3122 2c20 2262 6962 7465 7822 3a20  ey1", "bibtex": 
+0004c0e0: 2262 6962 7465 7820 6162 6364 222c 2022  "bibtex abcd", "
+0004c0f0: 6269 6274 6578 4469 6374 223a 207b 7d7d  bibtexDict": {}}
+0004c100: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004c110: 2020 2020 2020 2262 6962 7465 7822 2c0a        "bibtex",.
+0004c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c130: 2020 2020 5b22 7469 746c 6522 5d2c 0a20      ["title"],. 
+0004c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c150: 2020 2022 6162 6364 222c 0a20 2020 2020     "abcd",.     
+0004c160: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0004c170: 2261 6263 6465 225d 2c0a 2020 2020 2020  "abcde"],.      
+0004c180: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+0004c190: 616e 6765 643d 5b5d 2c0a 2020 2020 2020  anged=[],.      
+0004c1a0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+0004c1b0: 696c 6564 3d5b 5d2c 0a20 2020 2020 2020  iled=[],.       
+0004c1c0: 2020 2020 2020 2020 2020 2020 2073 7563               suc
+0004c1d0: 6365 7373 3d5b 5d2c 0a20 2020 2020 2020  cess=[],.       
+0004c1e0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+0004c1f0: 2020 2020 2020 2020 2020 2020 285b 5d2c              ([],
+0004c200: 205b 5d2c 205b 226b 6579 3122 5d29 2c0a   [], ["key1"]),.
+0004c210: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0004c220: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0004c230: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+0004c240: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0004c250: 2e70 4244 422e 6269 6273 2e72 6570 6c61  .pBDB.bibs.repla
+0004c260: 6365 5369 6e67 6c65 456e 7472 7928 0a20  ceSingleEntry(. 
+0004c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c280: 2020 2030 2c0a 2020 2020 2020 2020 2020     0,.          
+0004c290: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+0004c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c2b0: 2020 2020 2262 6962 6b65 7922 3a20 226b      "bibkey": "k
+0004c2c0: 6579 3122 2c0a 2020 2020 2020 2020 2020  ey1",.          
+0004c2d0: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+0004c2e0: 6962 7465 7822 3a20 2262 6962 7465 7820  ibtex": "bibtex 
+0004c2f0: 6162 6364 222c 0a20 2020 2020 2020 2020  abcd",.         
+0004c300: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0004c310: 6269 6274 6578 4469 6374 223a 207b 2274  bibtexDict": {"t
+0004c320: 6974 6c65 223a 2022 6162 6364 227d 2c0a  itle": "abcd"},.
+0004c330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c340: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+0004c350: 2020 2020 2020 2020 2020 2022 7469 746c             "titl
+0004c360: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0004c370: 2020 2020 2020 2020 5b22 7469 746c 6531          ["title1
+0004c380: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0004c390: 2020 2020 2020 2020 2261 6263 6422 2c0a          "abcd",.
+0004c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c3b0: 2020 2020 5b22 6162 6364 6522 5d2c 0a20      ["abcde"],. 
+0004c3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c3d0: 2020 2063 6861 6e67 6564 3d5b 5d2c 0a20     changed=[],. 
+0004c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c3f0: 2020 2066 6169 6c65 643d 5b5d 2c0a 2020     failed=[],.  
+0004c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c410: 2020 7375 6363 6573 733d 5b5d 2c0a 2020    success=[],.  
+0004c420: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+0004c430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004c440: 2028 5b5d 2c20 5b5d 2c20 5b22 6b65 7931   ([], [], ["key1
+0004c450: 225d 292c 0a20 2020 2020 2020 2020 2020  "]),.           
+0004c460: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
+0004c470: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0004c480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004c490: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0004c4a0: 7265 706c 6163 6553 696e 676c 6545 6e74  replaceSingleEnt
+0004c4b0: 7279 280a 2020 2020 2020 2020 2020 2020  ry(.            
+0004c4c0: 2020 2020 2020 2020 302c 0a20 2020 2020          0,.     
+0004c4d0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+0004c4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004c4f0: 2020 2020 2020 2020 2022 6269 626b 6579           "bibkey
+0004c500: 223a 2022 6b65 7931 222c 0a20 2020 2020  ": "key1",.     
+0004c510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c520: 2020 2022 6269 6274 6578 223a 2022 6269     "bibtex": "bi
+0004c530: 6274 6578 2061 6263 6422 2c0a 2020 2020  btex abcd",.    
 0004c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c550: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-0004c560: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-0004c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c580: 2020 2262 6962 6b65 7922 3a20 226b 6579    "bibkey": "key
-0004c590: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-0004c5a0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0004c5b0: 7465 7822 3a20 2262 6962 7465 7820 6162  tex": "bibtex ab
-0004c5c0: 6364 222c 0a20 2020 2020 2020 2020 2020  cd",.           
-0004c5d0: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
-0004c5e0: 6274 6578 4469 6374 223a 207b 2274 6974  btexDict": {"tit
-0004c5f0: 6c65 223a 2022 6162 6364 227d 2c0a 2020  le": "abcd"},.  
-0004c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c610: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-0004c620: 2020 2020 2020 2020 2022 7469 746c 6522           "title"
-0004c630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004c640: 2020 2020 2020 5b22 7469 746c 6531 225d        ["title1"]
-0004c650: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004c660: 2020 2020 2020 2261 6263 6422 2c0a 2020        "abcd",.  
-0004c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c680: 2020 5b22 6162 6364 6522 5d2c 0a20 2020    ["abcde"],.   
-0004c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c6a0: 2063 6861 6e67 6564 3d5b 5d2c 0a20 2020   changed=[],.   
-0004c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c6c0: 2066 6169 6c65 643d 5b5d 2c0a 2020 2020   failed=[],.    
-0004c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c6e0: 7375 6363 6573 733d 5b5d 2c0a 2020 2020  success=[],.    
-0004c6f0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0004c700: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0004c710: 5b5d 2c20 5b5d 2c20 5b22 6b65 7931 225d  [], [], ["key1"]
-0004c720: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
-0004c730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0004c740: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-0004c750: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0004c760: 656c 662e 7042 4442 2e62 6962 732e 7265  elf.pBDB.bibs.re
-0004c770: 706c 6163 6553 696e 676c 6545 6e74 7279  placeSingleEntry
-0004c780: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0004c790: 2020 2020 2020 302c 0a20 2020 2020 2020        0,.       
-0004c7a0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
-0004c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c7c0: 2020 2020 2020 2022 6269 626b 6579 223a         "bibkey":
-0004c7d0: 2022 6b65 7931 222c 0a20 2020 2020 2020   "key1",.       
-0004c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c7f0: 2022 6269 6274 6578 223a 2022 6269 6274   "bibtex": "bibt
-0004c800: 6578 2061 6263 6422 2c0a 2020 2020 2020  ex abcd",.      
-0004c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c820: 2020 2262 6962 7465 7844 6963 7422 3a20    "bibtexDict": 
-0004c830: 7b22 7469 746c 6522 3a20 2261 6263 6422  {"title": "abcd"
-0004c840: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0004c850: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-0004c860: 2020 2020 2020 2020 2020 2020 2020 2274                "t
-0004c870: 6974 6c65 222c 0a20 2020 2020 2020 2020  itle",.         
-0004c880: 2020 2020 2020 2020 2020 205b 2274 6974             ["tit
-0004c890: 6c65 222c 2022 7469 746c 6531 225d 2c0a  le", "title1"],.
-0004c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c8b0: 2020 2020 2261 6263 6422 2c0a 2020 2020      "abcd",.    
-0004c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c8d0: 5b22 6162 6422 2c20 2261 6263 6465 225d  ["abd", "abcde"]
-0004c8e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004c8f0: 2020 2020 2020 6368 616e 6765 643d 5b5d        changed=[]
-0004c900: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004c910: 2020 2020 2020 6661 696c 6564 3d5b 5d2c        failed=[],
-0004c920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004c930: 2020 2020 2073 7563 6365 7373 3d5b 5d2c       success=[],
-0004c940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004c950: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0004c960: 2020 2020 285b 5d2c 205b 5d2c 205b 226b      ([], [], ["k
-0004c970: 6579 3122 5d29 2c0a 2020 2020 2020 2020  ey1"]),.        
-0004c980: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0004c990: 2020 5f75 2e61 7373 6572 745f 6e6f 745f    _u.assert_not_
-0004c9a0: 6361 6c6c 6564 2829 0a20 2020 2020 2020  called().       
-0004c9b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0004c9c0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0004c9d0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0004c9e0: 2e62 6962 732e 7265 706c 6163 6553 696e  .bibs.replaceSin
-0004c9f0: 676c 6545 6e74 7279 280a 2020 2020 2020  gleEntry(.      
-0004ca00: 2020 2020 2020 2020 2020 2020 2020 302c                0,
-0004ca10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004ca20: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-0004ca30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004ca40: 6269 626b 6579 223a 2022 6b65 7931 222c  bibkey": "key1",
-0004ca50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004ca60: 2020 2020 2020 2020 2022 6269 6274 6578           "bibtex
-0004ca70: 223a 2022 6269 6274 6578 2061 6263 6422  ": "bibtex abcd"
-0004ca80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004ca90: 2020 2020 2020 2020 2020 2262 6962 7465            "bibte
-0004caa0: 7844 6963 7422 3a20 7b22 7469 746c 6522  xDict": {"title"
-0004cab0: 3a20 2261 6263 222c 202a 2a62 647d 2c0a  : "abc", **bd},.
-0004cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cad0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-0004cae0: 2020 2020 2020 2020 2020 2022 7469 746c             "titl
-0004caf0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0004cb00: 2020 2020 2020 2020 5b22 7469 746c 6522          ["title"
-0004cb10: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0004cb20: 2020 2020 2020 2022 6162 6364 222c 0a20         "abcd",. 
-0004cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cb40: 2020 205b 2261 6263 6465 225d 2c0a 2020     ["abcde"],.  
-0004cb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cb60: 2020 6368 616e 6765 643d 5b22 6122 5d2c    changed=["a"],
-0004cb70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004cb80: 2020 2020 2066 6169 6c65 643d 5b5d 2c0a       failed=[],.
-0004cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cba0: 2020 2020 7375 6363 6573 733d 5b22 7322      success=["s"
-0004cbb0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0004cbc0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-0004cbd0: 2020 2020 2020 285b 2273 222c 2022 6b65        (["s", "ke
-0004cbe0: 7931 225d 2c20 5b22 6122 5d2c 205b 5d29  y1"], ["a"], [])
-0004cbf0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0004cc00: 2020 2020 2020 2020 2020 2020 5f75 2e61              _u.a
-0004cc10: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-0004cc20: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
-0004cc30: 2020 2020 2020 2020 226b 6579 3122 2c0a          "key1",.
-0004cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cc50: 2262 6962 7465 7822 2c0a 2020 2020 2020  "bibtex",.      
-0004cc60: 2020 2020 2020 2020 2020 2740 4172 7469            '@Arti
-0004cc70: 636c 657b 6b65 7931 2c5c 6e20 2020 2020  cle{key1,\n     
-0004cc80: 2020 2020 7469 746c 6520 3d20 227b 6162      title = "{ab
-0004cc90: 637d 222c 5c6e 7d27 2c0a 2020 2020 2020  c}",\n}',.      
-0004cca0: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
-0004ccb0: 653d 302c 0a20 2020 2020 2020 2020 2020  e=0,.           
-0004ccc0: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
-0004ccd0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0004cce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004ccf0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-0004cd00: 7265 706c 6163 6553 696e 676c 6545 6e74  replaceSingleEnt
-0004cd10: 7279 280a 2020 2020 2020 2020 2020 2020  ry(.            
-0004cd20: 2020 2020 2020 2020 302c 0a20 2020 2020          0,.     
-0004cd30: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0004cd40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004cd50: 2020 2020 2020 2020 2022 6269 626b 6579           "bibkey
-0004cd60: 223a 2022 6b65 7931 222c 0a20 2020 2020  ": "key1",.     
+0004c550: 2020 2020 2262 6962 7465 7844 6963 7422      "bibtexDict"
+0004c560: 3a20 7b22 7469 746c 6522 3a20 2261 6263  : {"title": "abc
+0004c570: 6422 7d2c 0a20 2020 2020 2020 2020 2020  d"},.           
+0004c580: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+0004c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c5a0: 2274 6974 6c65 222c 0a20 2020 2020 2020  "title",.       
+0004c5b0: 2020 2020 2020 2020 2020 2020 205b 2274               ["t
+0004c5c0: 6974 6c65 222c 2022 7469 746c 6531 225d  itle", "title1"]
+0004c5d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004c5e0: 2020 2020 2020 2261 6263 6422 2c0a 2020        "abcd",.  
+0004c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c600: 2020 5b22 6162 6422 2c20 2261 6263 6465    ["abd", "abcde
+0004c610: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0004c620: 2020 2020 2020 2020 6368 616e 6765 643d          changed=
+0004c630: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
+0004c640: 2020 2020 2020 2020 6661 696c 6564 3d5b          failed=[
+0004c650: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004c660: 2020 2020 2020 2073 7563 6365 7373 3d5b         success=[
+0004c670: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004c680: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+0004c690: 2020 2020 2020 285b 5d2c 205b 5d2c 205b        ([], [], [
+0004c6a0: 226b 6579 3122 5d29 2c0a 2020 2020 2020  "key1"]),.      
+0004c6b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0004c6c0: 2020 2020 5f75 2e61 7373 6572 745f 6e6f      _u.assert_no
+0004c6d0: 745f 6361 6c6c 6564 2829 0a20 2020 2020  t_called().     
+0004c6e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0004c6f0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+0004c700: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0004c710: 4442 2e62 6962 732e 7265 706c 6163 6553  DB.bibs.replaceS
+0004c720: 696e 676c 6545 6e74 7279 280a 2020 2020  ingleEntry(.    
+0004c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c740: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+0004c750: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0004c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c770: 2022 6269 626b 6579 223a 2022 6b65 7931   "bibkey": "key1
+0004c780: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0004c790: 2020 2020 2020 2020 2020 2022 6269 6274             "bibt
+0004c7a0: 6578 223a 2022 6269 6274 6578 2061 6263  ex": "bibtex abc
+0004c7b0: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+0004c7c0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
+0004c7d0: 7465 7844 6963 7422 3a20 7b22 7469 746c  texDict": {"titl
+0004c7e0: 6522 3a20 2261 6263 222c 202a 2a62 647d  e": "abc", **bd}
+0004c7f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004c800: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0004c810: 2020 2020 2020 2020 2020 2020 2022 7469               "ti
+0004c820: 746c 6522 2c0a 2020 2020 2020 2020 2020  tle",.          
+0004c830: 2020 2020 2020 2020 2020 5b22 7469 746c            ["titl
+0004c840: 6522 5d2c 0a20 2020 2020 2020 2020 2020  e"],.           
+0004c850: 2020 2020 2020 2020 2022 6162 6364 222c           "abcd",
+0004c860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004c870: 2020 2020 205b 2261 6263 6465 225d 2c0a       ["abcde"],.
+0004c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c890: 2020 2020 6368 616e 6765 643d 5b22 6122      changed=["a"
+0004c8a0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004c8b0: 2020 2020 2020 2066 6169 6c65 643d 5b5d         failed=[]
+0004c8c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004c8d0: 2020 2020 2020 7375 6363 6573 733d 5b22        success=["
+0004c8e0: 7322 5d2c 0a20 2020 2020 2020 2020 2020  s"],.           
+0004c8f0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+0004c900: 2020 2020 2020 2020 285b 2273 222c 2022          (["s", "
+0004c910: 6b65 7931 225d 2c20 5b22 6122 5d2c 205b  key1"], ["a"], [
+0004c920: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+0004c930: 290a 2020 2020 2020 2020 2020 2020 5f75  ).            _u
+0004c940: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+0004c950: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
+0004c960: 2020 2020 2020 2020 2020 226b 6579 3122            "key1"
+0004c970: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004c980: 2020 2262 6962 7465 7822 2c0a 2020 2020    "bibtex",.    
+0004c990: 2020 2020 2020 2020 2020 2020 2740 4172              '@Ar
+0004c9a0: 7469 636c 657b 6b65 7931 2c5c 6e20 2020  ticle{key1,\n   
+0004c9b0: 2020 2020 2020 7469 746c 6520 3d20 227b        title = "{
+0004c9c0: 6162 637d 222c 5c6e 7d27 2c0a 2020 2020  abc}",\n}',.    
+0004c9d0: 2020 2020 2020 2020 2020 2020 7665 7262              verb
+0004c9e0: 6f73 653d 302c 0a20 2020 2020 2020 2020  ose=0,.         
+0004c9f0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0004ca00: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0004ca10: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+0004ca20: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+0004ca30: 732e 7265 706c 6163 6553 696e 676c 6545  s.replaceSingleE
+0004ca40: 6e74 7279 280a 2020 2020 2020 2020 2020  ntry(.          
+0004ca50: 2020 2020 2020 2020 2020 302c 0a20 2020            0,.   
+0004ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ca70: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0004ca80: 2020 2020 2020 2020 2020 2022 6269 626b             "bibk
+0004ca90: 6579 223a 2022 6b65 7931 222c 0a20 2020  ey": "key1",.   
+0004caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cab0: 2020 2020 2022 6269 6274 6578 223a 2022       "bibtex": "
+0004cac0: 6269 6274 6578 2061 6263 6422 2c0a 2020  bibtex abcd",.  
+0004cad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cae0: 2020 2020 2020 2262 6962 7465 7844 6963        "bibtexDic
+0004caf0: 7422 3a20 7b22 7469 746c 6522 3a20 2261  t": {"title": "a
+0004cb00: 6263 6422 2c20 2a2a 6264 7d2c 0a20 2020  bcd", **bd},.   
+0004cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cb20: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+0004cb30: 2020 2020 2020 2020 2274 6974 6c65 222c          "title",
+0004cb40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004cb50: 2020 2020 205b 2274 6974 6c65 225d 2c0a       ["title"],.
+0004cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cb70: 2020 2020 2261 6263 6422 2c0a 2020 2020      "abcd",.    
+0004cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cb90: 5b22 6162 6364 6522 5d2c 0a20 2020 2020  ["abcde"],.     
+0004cba0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0004cbb0: 6861 6e67 6564 3d5b 2261 225d 2c0a 2020  hanged=["a"],.  
+0004cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cbd0: 2020 6661 696c 6564 3d5b 2266 225d 2c0a    failed=["f"],.
+0004cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cbf0: 2020 2020 7375 6363 6573 733d 5b22 7322      success=["s"
+0004cc00: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004cc10: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+0004cc20: 2020 2020 2020 285b 2273 222c 2022 6b65        (["s", "ke
+0004cc30: 7931 225d 2c20 5b22 6122 2c20 226b 6579  y1"], ["a", "key
+0004cc40: 3122 5d2c 205b 2266 225d 292c 0a20 2020  1"], ["f"]),.   
+0004cc50: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0004cc60: 2020 2020 2020 205f 752e 6173 7365 7274         _u.assert
+0004cc70: 5f63 616c 6c65 645f 7769 7468 280a 2020  _called_with(.  
+0004cc80: 2020 2020 2020 2020 2020 2020 2020 226b                "k
+0004cc90: 6579 3122 2c0a 2020 2020 2020 2020 2020  ey1",.          
+0004cca0: 2020 2020 2020 2262 6962 7465 7822 2c0a        "bibtex",.
+0004ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ccc0: 2740 4172 7469 636c 657b 6b65 7931 2c5c  '@Article{key1,\
+0004ccd0: 6e20 2020 2020 2020 2020 7469 746c 6520  n         title 
+0004cce0: 3d20 227b 6162 6364 657d 222c 5c6e 7d27  = "{abcde}",\n}'
+0004ccf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004cd00: 2020 7665 7262 6f73 653d 302c 0a20 2020    verbose=0,.   
+0004cd10: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0004cd20: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0004cd30: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+0004cd40: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0004cd50: 4442 2e62 6962 732e 7265 706c 6163 6553  DB.bibs.replaceS
+0004cd60: 696e 676c 6545 6e74 7279 280a 2020 2020  ingleEntry(.    
 0004cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cd80: 2020 2022 6269 6274 6578 223a 2022 6269     "bibtex": "bi
-0004cd90: 6274 6578 2061 6263 6422 2c0a 2020 2020  btex abcd",.    
+0004cd80: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+0004cd90: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
 0004cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cdb0: 2020 2020 2262 6962 7465 7844 6963 7422      "bibtexDict"
-0004cdc0: 3a20 7b22 7469 746c 6522 3a20 2261 6263  : {"title": "abc
-0004cdd0: 6422 2c20 2a2a 6264 7d2c 0a20 2020 2020  d", **bd},.     
-0004cde0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0004cdf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004ce00: 2020 2020 2020 2274 6974 6c65 222c 0a20        "title",. 
-0004ce10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ce20: 2020 205b 2274 6974 6c65 225d 2c0a 2020     ["title"],.  
+0004cdb0: 2022 6269 626b 6579 223a 2022 6b65 7931   "bibkey": "key1
+0004cdc0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0004cdd0: 2020 2020 2020 2020 2020 2022 6172 7869             "arxi
+0004cde0: 7622 3a20 226d 7961 6263 6465 6622 2c0a  v": "myabcdef",.
+0004cdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ce00: 2020 2020 2020 2020 2262 6962 7465 7844          "bibtexD
+0004ce10: 6963 7422 3a20 7b22 7469 746c 6522 3a20  ict": {"title": 
+0004ce20: 2261 6263 6422 2c20 2a2a 6264 7d2c 0a20  "abcd", **bd},. 
 0004ce30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ce40: 2020 2261 6263 6422 2c0a 2020 2020 2020    "abcd",.      
-0004ce50: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
-0004ce60: 6162 6364 6522 5d2c 0a20 2020 2020 2020  abcde"],.       
-0004ce70: 2020 2020 2020 2020 2020 2020 2063 6861               cha
-0004ce80: 6e67 6564 3d5b 2261 225d 2c0a 2020 2020  nged=["a"],.    
-0004ce90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cea0: 6661 696c 6564 3d5b 2266 225d 2c0a 2020  failed=["f"],.  
-0004ceb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cec0: 2020 7375 6363 6573 733d 5b22 7322 5d2c    success=["s"],
-0004ced0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004cee0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0004cef0: 2020 2020 285b 2273 222c 2022 6b65 7931      (["s", "key1
-0004cf00: 225d 2c20 5b22 6122 2c20 226b 6579 3122  "], ["a", "key1"
-0004cf10: 5d2c 205b 2266 225d 292c 0a20 2020 2020  ], ["f"]),.     
-0004cf20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0004cf30: 2020 2020 205f 752e 6173 7365 7274 5f63       _u.assert_c
-0004cf40: 616c 6c65 645f 7769 7468 280a 2020 2020  alled_with(.    
-0004cf50: 2020 2020 2020 2020 2020 2020 226b 6579              "key
-0004cf60: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
-0004cf70: 2020 2020 2262 6962 7465 7822 2c0a 2020      "bibtex",.  
-0004cf80: 2020 2020 2020 2020 2020 2020 2020 2740                '@
-0004cf90: 4172 7469 636c 657b 6b65 7931 2c5c 6e20  Article{key1,\n 
-0004cfa0: 2020 2020 2020 2020 7469 746c 6520 3d20          title = 
-0004cfb0: 227b 6162 6364 657d 222c 5c6e 7d27 2c0a  "{abcde}",\n}',.
-0004cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cfd0: 7665 7262 6f73 653d 302c 0a20 2020 2020  verbose=0,.     
-0004cfe0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0004cff0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0004d000: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0004d010: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0004d020: 2e62 6962 732e 7265 706c 6163 6553 696e  .bibs.replaceSin
-0004d030: 676c 6545 6e74 7279 280a 2020 2020 2020  gleEntry(.      
-0004d040: 2020 2020 2020 2020 2020 2020 2020 302c                0,
-0004d050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d060: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-0004d070: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004d080: 6269 626b 6579 223a 2022 6b65 7931 222c  bibkey": "key1",
-0004d090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d0a0: 2020 2020 2020 2020 2022 6172 7869 7622           "arxiv"
-0004d0b0: 3a20 226d 7961 6263 6465 6622 2c0a 2020  : "myabcdef",.  
-0004d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d0d0: 2020 2020 2020 2262 6962 7465 7844 6963        "bibtexDic
-0004d0e0: 7422 3a20 7b22 7469 746c 6522 3a20 2261  t": {"title": "a
-0004d0f0: 6263 6422 2c20 2a2a 6264 7d2c 0a20 2020  bcd", **bd},.   
-0004d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d110: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0004d120: 2020 2020 2020 2020 2274 6974 6c65 222c          "title",
-0004d130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d140: 2020 2020 205b 2261 7278 6976 222c 2022       ["arxiv", "
-0004d150: 7469 746c 6522 5d2c 0a20 2020 2020 2020  title"],.       
-0004d160: 2020 2020 2020 2020 2020 2020 2022 6162               "ab
-0004d170: 6364 222c 0a20 2020 2020 2020 2020 2020  cd",.           
-0004d180: 2020 2020 2020 2020 205b 2261 6263 6465           ["abcde
-0004d190: 222c 2022 6463 6261 225d 2c0a 2020 2020  ", "dcba"],.    
-0004d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d1b0: 6368 616e 6765 643d 5b22 6122 5d2c 0a20  changed=["a"],. 
+0004ce40: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+0004ce50: 2020 2020 2020 2020 2020 2274 6974 6c65            "title
+0004ce60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0004ce70: 2020 2020 2020 205b 2261 7278 6976 222c         ["arxiv",
+0004ce80: 2022 7469 746c 6522 5d2c 0a20 2020 2020   "title"],.     
+0004ce90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0004cea0: 6162 6364 222c 0a20 2020 2020 2020 2020  abcd",.         
+0004ceb0: 2020 2020 2020 2020 2020 205b 2261 6263             ["abc
+0004cec0: 6465 222c 2022 6463 6261 225d 2c0a 2020  de", "dcba"],.  
+0004ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004cee0: 2020 6368 616e 6765 643d 5b22 6122 5d2c    changed=["a"],
+0004cef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004cf00: 2020 2020 2066 6169 6c65 643d 5b22 6622       failed=["f"
+0004cf10: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004cf20: 2020 2020 2020 2073 7563 6365 7373 3d5b         success=[
+0004cf30: 2273 225d 2c0a 2020 2020 2020 2020 2020  "s"],.          
+0004cf40: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0004cf50: 2020 2020 2020 2020 2028 5b22 7322 2c20           (["s", 
+0004cf60: 226b 6579 3122 5d2c 205b 2261 222c 2022  "key1"], ["a", "
+0004cf70: 6b65 7931 225d 2c20 5b22 6622 5d29 2c0a  key1"], ["f"]),.
+0004cf80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0004cf90: 2020 2020 2020 2020 2020 5f75 2e61 7373            _u.ass
+0004cfa0: 6572 745f 616e 795f 6361 6c6c 2822 6b65  ert_any_call("ke
+0004cfb0: 7931 222c 2022 6172 7869 7622 2c20 2261  y1", "arxiv", "a
+0004cfc0: 6263 6465 222c 2076 6572 626f 7365 3d30  bcde", verbose=0
+0004cfd0: 290a 2020 2020 2020 2020 2020 2020 5f75  ).            _u
+0004cfe0: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+0004cff0: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
+0004d000: 2020 2020 2022 6b65 7931 222c 0a20 2020       "key1",.   
+0004d010: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+0004d020: 6274 6578 222c 0a20 2020 2020 2020 2020  btex",.         
+0004d030: 2020 2020 2020 2027 4041 7274 6963 6c65         '@Article
+0004d040: 7b6b 6579 312c 5c6e 2020 2020 2020 2020  {key1,\n        
+0004d050: 2074 6974 6c65 203d 2022 7b64 6362 617d   title = "{dcba}
+0004d060: 222c 5c6e 7d27 2c0a 2020 2020 2020 2020  ",\n}',.        
+0004d070: 2020 2020 2020 2020 7665 7262 6f73 653d          verbose=
+0004d080: 302c 0a20 2020 2020 2020 2020 2020 2029  0,.            )
+0004d090: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0004d0a0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0004d0b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0004d0c0: 656c 662e 7042 4442 2e62 6962 732e 7265  elf.pBDB.bibs.re
+0004d0d0: 706c 6163 6553 696e 676c 6545 6e74 7279  placeSingleEntry
+0004d0e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0004d0f0: 2020 2020 2020 302c 0a20 2020 2020 2020        0,.       
+0004d100: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+0004d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d120: 2020 2020 2020 2022 6269 626b 6579 223a         "bibkey":
+0004d130: 2022 6b65 7931 222c 0a20 2020 2020 2020   "key1",.       
+0004d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d150: 2022 6172 7869 7622 3a20 226d 7961 6263   "arxiv": "myabc
+0004d160: 6465 6622 2c0a 2020 2020 2020 2020 2020  def",.          
+0004d170: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+0004d180: 6962 7465 7844 6963 7422 3a20 7b22 766f  ibtexDict": {"vo
+0004d190: 6c75 6d65 223a 2022 3138 3033 222c 202a  lume": "1803", *
+0004d1a0: 2a62 647d 2c0a 2020 2020 2020 2020 2020  *bd},.          
+0004d1b0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
 0004d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d1d0: 2020 2066 6169 6c65 643d 5b22 6622 5d2c     failed=["f"],
-0004d1e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d1f0: 2020 2020 2073 7563 6365 7373 3d5b 2273       success=["s
-0004d200: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-0004d210: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-0004d220: 2020 2020 2020 2028 5b22 7322 2c20 226b         (["s", "k
-0004d230: 6579 3122 5d2c 205b 2261 222c 2022 6b65  ey1"], ["a", "ke
-0004d240: 7931 225d 2c20 5b22 6622 5d29 2c0a 2020  y1"], ["f"]),.  
-0004d250: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0004d260: 2020 2020 2020 2020 5f75 2e61 7373 6572          _u.asser
-0004d270: 745f 616e 795f 6361 6c6c 2822 6b65 7931  t_any_call("key1
-0004d280: 222c 2022 6172 7869 7622 2c20 2261 6263  ", "arxiv", "abc
-0004d290: 6465 222c 2076 6572 626f 7365 3d30 290a  de", verbose=0).
-0004d2a0: 2020 2020 2020 2020 2020 2020 5f75 2e61              _u.a
-0004d2b0: 7373 6572 745f 6361 6c6c 6564 5f77 6974  ssert_called_wit
-0004d2c0: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
-0004d2d0: 2020 2022 6b65 7931 222c 0a20 2020 2020     "key1",.     
-0004d2e0: 2020 2020 2020 2020 2020 2022 6269 6274             "bibt
-0004d2f0: 6578 222c 0a20 2020 2020 2020 2020 2020  ex",.           
-0004d300: 2020 2020 2027 4041 7274 6963 6c65 7b6b       '@Article{k
-0004d310: 6579 312c 5c6e 2020 2020 2020 2020 2074  ey1,\n         t
-0004d320: 6974 6c65 203d 2022 7b64 6362 617d 222c  itle = "{dcba}",
-0004d330: 5c6e 7d27 2c0a 2020 2020 2020 2020 2020  \n}',.          
-0004d340: 2020 2020 2020 7665 7262 6f73 653d 302c        verbose=0,
-0004d350: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0004d360: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0004d370: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0004d380: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0004d390: 662e 7042 4442 2e62 6962 732e 7265 706c  f.pBDB.bibs.repl
-0004d3a0: 6163 6553 696e 676c 6545 6e74 7279 280a  aceSingleEntry(.
-0004d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d3c0: 2020 2020 302c 0a20 2020 2020 2020 2020      0,.         
-0004d3d0: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
-0004d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d3f0: 2020 2020 2022 6269 626b 6579 223a 2022       "bibkey": "
-0004d400: 6b65 7931 222c 0a20 2020 2020 2020 2020  key1",.         
-0004d410: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004d420: 6172 7869 7622 3a20 226d 7961 6263 6465  arxiv": "myabcde
-0004d430: 6622 2c0a 2020 2020 2020 2020 2020 2020  f",.            
-0004d440: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0004d450: 7465 7844 6963 7422 3a20 7b22 766f 6c75  texDict": {"volu
-0004d460: 6d65 223a 2022 3138 3033 222c 202a 2a62  me": "1803", **b
-0004d470: 647d 2c0a 2020 2020 2020 2020 2020 2020  d},.            
-0004d480: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0004d490: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004d4a0: 766f 6c75 6d65 222c 0a20 2020 2020 2020  volume",.       
-0004d4b0: 2020 2020 2020 2020 2020 2020 205b 2276               ["v
-0004d4c0: 6f6c 756d 6522 5d2c 0a20 2020 2020 2020  olume"],.       
-0004d4d0: 2020 2020 2020 2020 2020 2020 2022 285b               "([
-0004d4e0: 302d 395d 7b32 7d29 285b 302d 395d 7b32  0-9]{2})([0-9]{2
-0004d4f0: 7d29 222c 0a20 2020 2020 2020 2020 2020  })",.           
-0004d500: 2020 2020 2020 2020 205b 7222 5c32 225d           [r"\2"]
-0004d510: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004d520: 2020 2020 2020 6368 616e 6765 643d 5b5d        changed=[]
-0004d530: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004d540: 2020 2020 2020 6661 696c 6564 3d5b 5d2c        failed=[],
-0004d550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d560: 2020 2020 2073 7563 6365 7373 3d5b 5d2c       success=[],
-0004d570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d580: 2020 2020 2072 6567 6578 3d54 7275 652c       regex=True,
-0004d590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d5a0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0004d5b0: 2020 2020 285b 226b 6579 3122 5d2c 205b      (["key1"], [
-0004d5c0: 226b 6579 3122 5d2c 205b 5d29 2c0a 2020  "key1"], []),.  
-0004d5d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0004d5e0: 2020 2020 2020 2020 5f75 2e61 7373 6572          _u.asser
-0004d5f0: 745f 6361 6c6c 6564 5f77 6974 6828 0a20  t_called_with(. 
-0004d600: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004d610: 6b65 7931 222c 2022 6269 6274 6578 222c  key1", "bibtex",
-0004d620: 2027 4041 7274 6963 6c65 7b6b 6579 312c   '@Article{key1,
-0004d630: 5c6e 2020 2020 2020 2020 766f 6c75 6d65  \n        volume
-0004d640: 203d 2022 3033 222c 5c6e 7d27 2c20 7665   = "03",\n}', ve
-0004d650: 7262 6f73 653d 300a 2020 2020 2020 2020  rbose=0.        
-0004d660: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0004d670: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0004d680: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-0004d690: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-0004d6a0: 6273 2e72 6570 6c61 6365 5369 6e67 6c65  bs.replaceSingle
-0004d6b0: 456e 7472 7928 0a20 2020 2020 2020 2020  Entry(.         
-0004d6c0: 2020 2020 2020 2020 2020 2030 2c0a 2020             0,.  
-0004d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d6e0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-0004d6f0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0004d700: 6b65 7922 3a20 226b 6579 3122 2c0a 2020  key": "key1",.  
-0004d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d720: 2020 2020 2020 2261 7278 6976 223a 2022        "arxiv": "
-0004d730: 6d79 6162 6364 6566 222c 0a20 2020 2020  myabcdef",.     
-0004d740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d750: 2020 2022 6269 6274 6578 4469 6374 223a     "bibtexDict":
-0004d760: 207b 2276 6f6c 756d 6522 3a20 2231 3830   {"volume": "180
-0004d770: 3322 2c20 226a 6f75 726e 616c 223a 2022  3", "journal": "
-0004d780: 7072 6422 2c20 2a2a 6264 7d2c 0a20 2020  prd", **bd},.   
+0004d1d0: 2022 766f 6c75 6d65 222c 0a20 2020 2020   "volume",.     
+0004d1e0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0004d1f0: 2276 6f6c 756d 6522 5d2c 0a20 2020 2020  "volume"],.     
+0004d200: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0004d210: 285b 302d 395d 7b32 7d29 285b 302d 395d  ([0-9]{2})([0-9]
+0004d220: 7b32 7d29 222c 0a20 2020 2020 2020 2020  {2})",.         
+0004d230: 2020 2020 2020 2020 2020 205b 7222 5c32             [r"\2
+0004d240: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0004d250: 2020 2020 2020 2020 6368 616e 6765 643d          changed=
+0004d260: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
+0004d270: 2020 2020 2020 2020 6661 696c 6564 3d5b          failed=[
+0004d280: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004d290: 2020 2020 2020 2073 7563 6365 7373 3d5b         success=[
+0004d2a0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0004d2b0: 2020 2020 2020 2072 6567 6578 3d54 7275         regex=Tru
+0004d2c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0004d2d0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+0004d2e0: 2020 2020 2020 285b 226b 6579 3122 5d2c        (["key1"],
+0004d2f0: 205b 226b 6579 3122 5d2c 205b 5d29 2c0a   ["key1"], []),.
+0004d300: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0004d310: 2020 2020 2020 2020 2020 5f75 2e61 7373            _u.ass
+0004d320: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+0004d330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d340: 2022 6b65 7931 222c 2022 6269 6274 6578   "key1", "bibtex
+0004d350: 222c 2027 4041 7274 6963 6c65 7b6b 6579  ", '@Article{key
+0004d360: 312c 5c6e 2020 2020 2020 2020 766f 6c75  1,\n        volu
+0004d370: 6d65 203d 2022 3033 222c 5c6e 7d27 2c20  me = "03",\n}', 
+0004d380: 7665 7262 6f73 653d 300a 2020 2020 2020  verbose=0.      
+0004d390: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0004d3a0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0004d3b0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+0004d3c0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0004d3d0: 6269 6273 2e72 6570 6c61 6365 5369 6e67  bibs.replaceSing
+0004d3e0: 6c65 456e 7472 7928 0a20 2020 2020 2020  leEntry(.       
+0004d3f0: 2020 2020 2020 2020 2020 2020 2030 2c0a               0,.
+0004d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d410: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0004d420: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+0004d430: 6962 6b65 7922 3a20 226b 6579 3122 2c0a  ibkey": "key1",.
+0004d440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d450: 2020 2020 2020 2020 2261 7278 6976 223a          "arxiv":
+0004d460: 2022 6d79 6162 6364 6566 222c 0a20 2020   "myabcdef",.   
+0004d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d480: 2020 2020 2022 6269 6274 6578 4469 6374       "bibtexDict
+0004d490: 223a 207b 2276 6f6c 756d 6522 3a20 2231  ": {"volume": "1
+0004d4a0: 3830 3322 2c20 226a 6f75 726e 616c 223a  803", "journal":
+0004d4b0: 2022 7072 6422 2c20 2a2a 6264 7d2c 0a20   "prd", **bd},. 
+0004d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d4d0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+0004d4e0: 2020 2020 2020 2020 2020 2276 6f6c 756d            "volum
+0004d4f0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0004d500: 2020 2020 2020 2020 5b22 766f 6c75 6d65          ["volume
+0004d510: 222c 2022 6a6f 7572 6e61 6c22 5d2c 0a20  ", "journal"],. 
+0004d520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d530: 2020 2022 285b 302d 395d 7b32 7d29 285b     "([0-9]{2})([
+0004d540: 302d 395d 7b32 7d29 222c 0a20 2020 2020  0-9]{2})",.     
+0004d550: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0004d560: 7222 5c32 222c 2072 225c 3122 5d2c 0a20  r"\2", r"\1"],. 
+0004d570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d580: 2020 2063 6861 6e67 6564 3d5b 5d2c 0a20     changed=[],. 
+0004d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d5a0: 2020 2066 6169 6c65 643d 5b5d 2c0a 2020     failed=[],.  
+0004d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d5c0: 2020 7375 6363 6573 733d 5b5d 2c0a 2020    success=[],.  
+0004d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d5e0: 2020 7265 6765 783d 5472 7565 2c0a 2020    regex=True,.  
+0004d5f0: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+0004d600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d610: 2028 5b22 6b65 7931 225d 2c20 5b22 6b65   (["key1"], ["ke
+0004d620: 7931 225d 2c20 5b5d 292c 0a20 2020 2020  y1"], []),.     
+0004d630: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0004d640: 2020 2020 205f 752e 6173 7365 7274 5f63       _u.assert_c
+0004d650: 616c 6c65 645f 7769 7468 280a 2020 2020  alled_with(.    
+0004d660: 2020 2020 2020 2020 2020 2020 226b 6579              "key
+0004d670: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+0004d680: 2020 2020 2262 6962 7465 7822 2c0a 2020      "bibtex",.  
+0004d690: 2020 2020 2020 2020 2020 2020 2020 2740                '@
+0004d6a0: 4172 7469 636c 657b 6b65 7931 2c5c 6e20  Article{key1,\n 
+0004d6b0: 2020 2020 2020 6a6f 7572 6e61 6c20 3d20        journal = 
+0004d6c0: 2231 3822 2c5c 6e20 2020 2020 2020 2076  "18",\n        v
+0004d6d0: 6f6c 756d 6520 3d20 2230 3322 2c5c 6e7d  olume = "03",\n}
+0004d6e0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0004d6f0: 2020 2076 6572 626f 7365 3d30 2c0a 2020     verbose=0,.  
+0004d700: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0004d710: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0004d720: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0004d730: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0004d740: 4244 422e 6269 6273 2e72 6570 6c61 6365  BDB.bibs.replace
+0004d750: 5369 6e67 6c65 456e 7472 7928 0a20 2020  SingleEntry(.   
+0004d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d770: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+0004d780: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
 0004d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d7a0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-0004d7b0: 2020 2020 2020 2020 2276 6f6c 756d 6522          "volume"
-0004d7c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004d7d0: 2020 2020 2020 5b22 766f 6c75 6d65 222c        ["volume",
-0004d7e0: 2022 6a6f 7572 6e61 6c22 5d2c 0a20 2020   "journal"],.   
-0004d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d800: 2022 285b 302d 395d 7b32 7d29 285b 302d   "([0-9]{2})([0-
-0004d810: 395d 7b32 7d29 222c 0a20 2020 2020 2020  9]{2})",.       
-0004d820: 2020 2020 2020 2020 2020 2020 205b 7222               [r"
-0004d830: 5c32 222c 2072 225c 3122 5d2c 0a20 2020  \2", r"\1"],.   
-0004d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d850: 2063 6861 6e67 6564 3d5b 5d2c 0a20 2020   changed=[],.   
-0004d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d870: 2066 6169 6c65 643d 5b5d 2c0a 2020 2020   failed=[],.    
-0004d880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d890: 7375 6363 6573 733d 5b5d 2c0a 2020 2020  success=[],.    
-0004d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d8b0: 7265 6765 783d 5472 7565 2c0a 2020 2020  regex=True,.    
-0004d8c0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-0004d8d0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0004d8e0: 5b22 6b65 7931 225d 2c20 5b22 6b65 7931  ["key1"], ["key1
-0004d8f0: 225d 2c20 5b5d 292c 0a20 2020 2020 2020  "], []),.       
-0004d900: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0004d910: 2020 205f 752e 6173 7365 7274 5f63 616c     _u.assert_cal
-0004d920: 6c65 645f 7769 7468 280a 2020 2020 2020  led_with(.      
-0004d930: 2020 2020 2020 2020 2020 226b 6579 3122            "key1"
-0004d940: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004d950: 2020 2262 6962 7465 7822 2c0a 2020 2020    "bibtex",.    
-0004d960: 2020 2020 2020 2020 2020 2020 2740 4172              '@Ar
-0004d970: 7469 636c 657b 6b65 7931 2c5c 6e20 2020  ticle{key1,\n   
-0004d980: 2020 2020 6a6f 7572 6e61 6c20 3d20 2231      journal = "1
-0004d990: 3822 2c5c 6e20 2020 2020 2020 2076 6f6c  8",\n        vol
-0004d9a0: 756d 6520 3d20 2230 3322 2c5c 6e7d 272c  ume = "03",\n}',
-0004d9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d9c0: 2076 6572 626f 7365 3d30 2c0a 2020 2020   verbose=0,.    
-0004d9d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0004d9e0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0004d9f0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0004da00: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0004da10: 422e 6269 6273 2e72 6570 6c61 6365 5369  B.bibs.replaceSi
-0004da20: 6e67 6c65 456e 7472 7928 0a20 2020 2020  ngleEntry(.     
-0004da30: 2020 2020 2020 2020 2020 2020 2020 2030                 0
-0004da40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004da50: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-0004da60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004da70: 2262 6962 6b65 7922 3a20 226b 6579 3122  "bibkey": "key1"
-0004da80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004da90: 2020 2020 2020 2020 2020 2261 7278 6976            "arxiv
-0004daa0: 223a 2022 6d79 6162 6364 6566 222c 0a20  ": "myabcdef",. 
-0004dab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dac0: 2020 2020 2020 2022 6269 6274 6578 4469         "bibtexDi
-0004dad0: 6374 223a 207b 2276 6f6c 756d 6522 3a20  ct": {"volume": 
-0004dae0: 2258 3031 222c 2022 6a6f 7572 6e61 6c22  "X01", "journal"
-0004daf0: 3a20 2250 6879 732e 5265 762e 222c 202a  : "Phys.Rev.", *
-0004db00: 2a62 647d 2c0a 2020 2020 2020 2020 2020  *bd},.          
-0004db10: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-0004db20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004db30: 2022 7075 626c 6973 6865 6422 2c0a 2020   "published",.  
+0004d7a0: 2020 2262 6962 6b65 7922 3a20 226b 6579    "bibkey": "key
+0004d7b0: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+0004d7c0: 2020 2020 2020 2020 2020 2020 2261 7278              "arx
+0004d7d0: 6976 223a 2022 6d79 6162 6364 6566 222c  iv": "myabcdef",
+0004d7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d7f0: 2020 2020 2020 2020 2022 6269 6274 6578           "bibtex
+0004d800: 4469 6374 223a 207b 2276 6f6c 756d 6522  Dict": {"volume"
+0004d810: 3a20 2258 3031 222c 2022 6a6f 7572 6e61  : "X01", "journa
+0004d820: 6c22 3a20 2250 6879 732e 5265 762e 222c  l": "Phys.Rev.",
+0004d830: 202a 2a62 647d 2c0a 2020 2020 2020 2020   **bd},.        
+0004d840: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+0004d850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d860: 2020 2022 7075 626c 6973 6865 6422 2c0a     "published",.
+0004d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d880: 2020 2020 5b22 6a6f 7572 6e61 6c22 2c20      ["journal", 
+0004d890: 2276 6f6c 756d 6522 5d2c 0a20 2020 2020  "volume"],.     
+0004d8a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0004d8b0: 2850 6879 732e 2052 6576 2e20 5b41 2d5a  (Phys. Rev. [A-Z
+0004d8c0: 5d7b 317d 2928 5b30 2d39 5d7b 327d 292e  ]{1})([0-9]{2}).
+0004d8d0: 2a22 2c0a 2020 2020 2020 2020 2020 2020  *",.            
+0004d8e0: 2020 2020 2020 2020 5b72 225c 3122 2c20          [r"\1", 
+0004d8f0: 7222 5c32 225d 2c0a 2020 2020 2020 2020  r"\2"],.        
+0004d900: 2020 2020 2020 2020 2020 2020 6368 616e              chan
+0004d910: 6765 643d 5b5d 2c0a 2020 2020 2020 2020  ged=[],.        
+0004d920: 2020 2020 2020 2020 2020 2020 6661 696c              fail
+0004d930: 6564 3d5b 5d2c 0a20 2020 2020 2020 2020  ed=[],.         
+0004d940: 2020 2020 2020 2020 2020 2073 7563 6365             succe
+0004d950: 7373 3d5b 5d2c 0a20 2020 2020 2020 2020  ss=[],.         
+0004d960: 2020 2020 2020 2020 2020 2072 6567 6578             regex
+0004d970: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+0004d980: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+0004d990: 2020 2020 2020 2020 2020 285b 5d2c 205b            ([], [
+0004d9a0: 5d2c 205b 226b 6579 3122 5d29 2c0a 2020  ], ["key1"]),.  
+0004d9b0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0004d9c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0004d9d0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+0004d9e0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0004d9f0: 4244 422e 6269 6273 2e72 6570 6c61 6365  BDB.bibs.replace
+0004da00: 5369 6e67 6c65 456e 7472 7928 0a20 2020  SingleEntry(.   
+0004da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004da20: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+0004da30: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0004da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004da50: 2020 2262 6962 6b65 7922 3a20 226b 6579    "bibkey": "key
+0004da60: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+0004da70: 2020 2020 2020 2020 2020 2020 2261 7278              "arx
+0004da80: 6976 223a 2022 6d79 6162 6364 6566 222c  iv": "myabcdef",
+0004da90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004daa0: 2020 2020 2020 2020 2022 7075 626c 6973           "publis
+0004dab0: 6865 6422 3a20 2250 6879 732e 5265 762e  hed": "Phys.Rev.
+0004dac0: 2058 3031 2062 6c61 626c 6122 2c0a 2020   X01 blabla",.  
+0004dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dae0: 2020 2020 2020 2262 6962 7465 7844 6963        "bibtexDic
+0004daf0: 7422 3a20 7b22 766f 6c75 6d65 223a 2022  t": {"volume": "
+0004db00: 5830 3122 2c20 226a 6f75 726e 616c 223a  X01", "journal":
+0004db10: 2022 5068 7973 2e52 6576 2e22 2c20 2a2a   "Phys.Rev.", **
+0004db20: 6264 7d2c 0a20 2020 2020 2020 2020 2020  bd},.           
+0004db30: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
 0004db40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004db50: 2020 5b22 6a6f 7572 6e61 6c22 2c20 2276    ["journal", "v
-0004db60: 6f6c 756d 6522 5d2c 0a20 2020 2020 2020  olume"],.       
-0004db70: 2020 2020 2020 2020 2020 2020 2022 2850               "(P
-0004db80: 6879 732e 2052 6576 2e20 5b41 2d5a 5d7b  hys. Rev. [A-Z]{
-0004db90: 317d 2928 5b30 2d39 5d7b 327d 292e 2a22  1})([0-9]{2}).*"
-0004dba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004dbb0: 2020 2020 2020 5b72 225c 3122 2c20 7222        [r"\1", r"
-0004dbc0: 5c32 225d 2c0a 2020 2020 2020 2020 2020  \2"],.          
-0004dbd0: 2020 2020 2020 2020 2020 6368 616e 6765            change
-0004dbe0: 643d 5b5d 2c0a 2020 2020 2020 2020 2020  d=[],.          
-0004dbf0: 2020 2020 2020 2020 2020 6661 696c 6564            failed
+0004db50: 2270 7562 6c69 7368 6564 222c 0a20 2020  "published",.   
+0004db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004db70: 205b 226a 6f75 726e 616c 222c 2022 766f   ["journal", "vo
+0004db80: 6c75 6d65 225d 2c0a 2020 2020 2020 2020  lume"],.        
+0004db90: 2020 2020 2020 2020 2020 2020 2228 5068              "(Ph
+0004dba0: 7973 2e20 5265 762e 205b 412d 5a5d 7b31  ys. Rev. [A-Z]{1
+0004dbb0: 7d29 285b 302d 395d 7b32 7d29 2e2a 222c  })([0-9]{2}).*",
+0004dbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004dbd0: 2020 2020 205b 7222 5c31 222c 2072 225c       [r"\1", r"\
+0004dbe0: 3222 5d2c 0a20 2020 2020 2020 2020 2020  2"],.           
+0004dbf0: 2020 2020 2020 2020 2063 6861 6e67 6564           changed
 0004dc00: 3d5b 5d2c 0a20 2020 2020 2020 2020 2020  =[],.           
-0004dc10: 2020 2020 2020 2020 2073 7563 6365 7373           success
-0004dc20: 3d5b 5d2c 0a20 2020 2020 2020 2020 2020  =[],.           
-0004dc30: 2020 2020 2020 2020 2072 6567 6578 3d54           regex=T
-0004dc40: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-0004dc50: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0004dc60: 2020 2020 2020 2020 285b 5d2c 205b 5d2c          ([], [],
-0004dc70: 205b 226b 6579 3122 5d29 2c0a 2020 2020   ["key1"]),.    
-0004dc80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0004dc90: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0004dca0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-0004dcb0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0004dcc0: 422e 6269 6273 2e72 6570 6c61 6365 5369  B.bibs.replaceSi
-0004dcd0: 6e67 6c65 456e 7472 7928 0a20 2020 2020  ngleEntry(.     
-0004dce0: 2020 2020 2020 2020 2020 2020 2020 2030                 0
-0004dcf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004dd00: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-0004dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dd20: 2262 6962 6b65 7922 3a20 226b 6579 3122  "bibkey": "key1"
-0004dd30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004dd40: 2020 2020 2020 2020 2020 2261 7278 6976            "arxiv
-0004dd50: 223a 2022 6d79 6162 6364 6566 222c 0a20  ": "myabcdef",. 
-0004dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dd70: 2020 2020 2020 2022 7075 626c 6973 6865         "publishe
-0004dd80: 6422 3a20 2250 6879 732e 5265 762e 2058  d": "Phys.Rev. X
-0004dd90: 3031 2062 6c61 626c 6122 2c0a 2020 2020  01 blabla",.    
-0004dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ddb0: 2020 2020 2262 6962 7465 7844 6963 7422      "bibtexDict"
-0004ddc0: 3a20 7b22 766f 6c75 6d65 223a 2022 5830  : {"volume": "X0
-0004ddd0: 3122 2c20 226a 6f75 726e 616c 223a 2022  1", "journal": "
-0004dde0: 5068 7973 2e52 6576 2e22 2c20 2a2a 6264  Phys.Rev.", **bd
-0004ddf0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-0004de00: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-0004de10: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-0004de20: 7562 6c69 7368 6564 222c 0a20 2020 2020  ublished",.     
-0004de30: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0004de40: 226a 6f75 726e 616c 222c 2022 766f 6c75  "journal", "volu
-0004de50: 6d65 225d 2c0a 2020 2020 2020 2020 2020  me"],.          
-0004de60: 2020 2020 2020 2020 2020 2228 5068 7973            "(Phys
-0004de70: 2e20 5265 762e 205b 412d 5a5d 7b31 7d29  . Rev. [A-Z]{1})
-0004de80: 285b 302d 395d 7b32 7d29 2e2a 222c 0a20  ([0-9]{2}).*",. 
-0004de90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dea0: 2020 205b 7222 5c31 222c 2072 225c 3222     [r"\1", r"\2"
-0004deb0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0004dec0: 2020 2020 2020 2063 6861 6e67 6564 3d5b         changed=[
-0004ded0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0004dee0: 2020 2020 2020 2066 6169 6c65 643d 5b5d         failed=[]
-0004def0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004df00: 2020 2020 2020 7375 6363 6573 733d 5b5d        success=[]
-0004df10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004df20: 2020 2020 2020 7265 6765 783d 5472 7565        regex=True
-0004df30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004df40: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
-0004df50: 2020 2020 2028 5b22 6b65 7931 225d 2c20       (["key1"], 
-0004df60: 5b5d 2c20 5b5d 292c 0a20 2020 2020 2020  [], []),.       
-0004df70: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0004df80: 2020 205f 752e 6173 7365 7274 5f63 616c     _u.assert_cal
-0004df90: 6c65 645f 7769 7468 280a 2020 2020 2020  led_with(.      
-0004dfa0: 2020 2020 2020 2020 2020 226b 6579 3122            "key1"
-0004dfb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004dfc0: 2020 2262 6962 7465 7822 2c0a 2020 2020    "bibtex",.    
-0004dfd0: 2020 2020 2020 2020 2020 2020 2740 4172              '@Ar
-0004dfe0: 7469 636c 657b 6b65 7931 2c5c 6e20 2020  ticle{key1,\n   
-0004dff0: 2020 2020 6a6f 7572 6e61 6c20 3d20 2250      journal = "P
-0004e000: 6879 732e 5265 762e 222c 5c6e 2020 2020  hys.Rev.",\n    
-0004e010: 2020 2020 766f 6c75 6d65 203d 2022 5830      volume = "X0
-0004e020: 3122 2c5c 6e7d 272c 0a20 2020 2020 2020  1",\n}',.       
-0004e030: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
-0004e040: 3d30 2c0a 2020 2020 2020 2020 2020 2020  =0,.            
-0004e050: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0004e060: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-0004e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e080: 7365 6c66 2e70 4244 422e 6269 6273 2e72  self.pBDB.bibs.r
-0004e090: 6570 6c61 6365 5369 6e67 6c65 456e 7472  eplaceSingleEntr
-0004e0a0: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
-0004e0b0: 2020 2020 2020 2030 2c0a 2020 2020 2020         0,.      
-0004e0c0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-0004e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e0e0: 2020 2020 2020 2020 2262 6962 6b65 7922          "bibkey"
-0004e0f0: 3a20 226b 6579 3122 2c0a 2020 2020 2020  : "key1",.      
-0004e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e110: 2020 2261 7278 6976 223a 2022 6d79 6162    "arxiv": "myab
-0004e120: 6364 6566 222c 0a20 2020 2020 2020 2020  cdef",.         
-0004e130: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004e140: 7075 626c 6973 6865 6422 3a20 2250 6879  published": "Phy
-0004e150: 732e 5265 762e 2058 3031 2062 6c61 626c  s.Rev. X01 blabl
-0004e160: 6122 2c0a 2020 2020 2020 2020 2020 2020  a",.            
-0004e170: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0004e180: 7465 7844 6963 7422 3a20 7b22 766f 6c75  texDict": {"volu
-0004e190: 6d65 223a 2022 5830 3122 2c20 226a 6f75  me": "X01", "jou
-0004e1a0: 726e 616c 223a 2022 5068 7973 2e52 6576  rnal": "Phys.Rev
-0004e1b0: 2e22 2c20 2a2a 6264 7d2c 0a20 2020 2020  .", **bd},.     
-0004e1c0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0004e1d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004e1e0: 2020 2020 2020 2270 7562 6c69 7368 6564        "published
-0004e1f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0004e200: 2020 2020 2020 205b 226a 6f75 726e 616c         ["journal
-0004e210: 222c 2022 766f 6c75 6d65 225d 2c0a 2020  ", "volume"],.  
-0004e220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e230: 2020 2228 5068 7973 2e52 6576 2e20 5b41    "(Phys.Rev. [A
-0004e240: 2d5a 5d7b 317d 2928 5b30 2d39 5d7b 327d  -Z]{1})([0-9]{2}
-0004e250: 292e 2a22 2c0a 2020 2020 2020 2020 2020  ).*",.          
-0004e260: 2020 2020 2020 2020 2020 5b72 225c 3122            [r"\1"
-0004e270: 2c20 7222 5c32 225d 2c0a 2020 2020 2020  , r"\2"],.      
-0004e280: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-0004e290: 616e 6765 643d 5b5d 2c0a 2020 2020 2020  anged=[],.      
-0004e2a0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-0004e2b0: 696c 6564 3d5b 5d2c 0a20 2020 2020 2020  iled=[],.       
-0004e2c0: 2020 2020 2020 2020 2020 2020 2073 7563               suc
-0004e2d0: 6365 7373 3d5b 5d2c 0a20 2020 2020 2020  cess=[],.       
-0004e2e0: 2020 2020 2020 2020 2020 2020 2072 6567               reg
-0004e2f0: 6578 3d54 7275 652c 0a20 2020 2020 2020  ex=True,.       
-0004e300: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-0004e310: 2020 2020 2020 2020 2020 2020 285b 226b              (["k
-0004e320: 6579 3122 5d2c 205b 226b 6579 3122 5d2c  ey1"], ["key1"],
-0004e330: 205b 5d29 2c0a 2020 2020 2020 2020 2020   []),.          
-0004e340: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0004e350: 5f75 2e61 7373 6572 745f 6361 6c6c 6564  _u.assert_called
-0004e360: 5f77 6974 6828 0a20 2020 2020 2020 2020  _with(.         
-0004e370: 2020 2020 2020 2022 6b65 7931 222c 0a20         "key1",. 
-0004e380: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004e390: 6269 6274 6578 222c 0a20 2020 2020 2020  bibtex",.       
-0004e3a0: 2020 2020 2020 2020 2027 4041 7274 6963           '@Artic
-0004e3b0: 6c65 7b6b 6579 312c 5c6e 2020 2020 2020  le{key1,\n      
-0004e3c0: 206a 6f75 726e 616c 203d 2022 5068 7973   journal = "Phys
-0004e3d0: 2e52 6576 2e20 5822 2c5c 6e20 2020 2020  .Rev. X",\n     
-0004e3e0: 2020 2076 6f6c 756d 6520 3d20 2230 3122     volume = "01"
-0004e3f0: 2c5c 6e7d 272c 0a20 2020 2020 2020 2020  ,\n}',.         
-0004e400: 2020 2020 2020 2076 6572 626f 7365 3d30         verbose=0
-0004e410: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0004e420: 0a20 2020 2064 6566 2074 6573 745f 726d  .    def test_rm
-0004e430: 4269 6274 6578 5374 7566 6628 7365 6c66  BibtexStuff(self
-0004e440: 2c20 2a61 7267 7329 3a0a 2020 2020 2020  , *args):.      
-0004e450: 2020 2222 2254 6573 7420 726d 4269 6274    """Test rmBibt
-0004e460: 6578 436f 6d6d 656e 7473 2061 6e64 2072  exComments and r
-0004e470: 6d42 6962 7465 7841 4361 706f 2222 220a  mBibtexACapo""".
-0004e480: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0004e490: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0004e4a0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0004e4b0: 6269 6273 2e72 6d42 6962 7465 7843 6f6d  bibs.rmBibtexCom
-0004e4c0: 6d65 6e74 7328 0a20 2020 2020 2020 2020  ments(.         
-0004e4d0: 2020 2020 2020 2027 2563 6f6d 6d65 6e74         '%comment
-0004e4e0: 5c6e 4061 7274 6963 6c65 7b67 6869 2c5c  \n@article{ghi,\
-0004e4f0: 6e61 7574 686f 7220 3d20 226d 6522 2c5c  nauthor = "me",\
-0004e500: 6e74 6974 6c65 203d 2022 6768 6922 2c7d  ntitle = "ghi",}
-0004e510: 270a 2020 2020 2020 2020 2020 2020 292c  '.            ),
-0004e520: 0a20 2020 2020 2020 2020 2020 2027 4061  .            '@a
-0004e530: 7274 6963 6c65 7b67 6869 2c5c 6e61 7574  rticle{ghi,\naut
-0004e540: 686f 7220 3d20 226d 6522 2c5c 6e74 6974  hor = "me",\ntit
-0004e550: 6c65 203d 2022 6768 6922 2c7d 272c 0a20  le = "ghi",}',. 
-0004e560: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0004e570: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0004e580: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-0004e590: 656c 662e 7042 4442 2e62 6962 732e 726d  elf.pBDB.bibs.rm
-0004e5a0: 4269 6274 6578 436f 6d6d 656e 7473 280a  BibtexComments(.
-0004e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e5c0: 2720 2563 6f6d 6d65 6e74 5c6e 4061 7274  ' %comment\n@art
-0004e5d0: 6963 6c65 7b67 6869 2c5c 6e61 7574 686f  icle{ghi,\nautho
-0004e5e0: 7220 3d20 226d 6522 2c5c 6e74 6974 6c65  r = "me",\ntitle
-0004e5f0: 203d 2022 6768 6922 2c7d 270a 2020 2020   = "ghi",}'.    
+0004dc10: 2020 2020 2020 2020 2066 6169 6c65 643d           failed=
+0004dc20: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
+0004dc30: 2020 2020 2020 2020 7375 6363 6573 733d          success=
+0004dc40: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
+0004dc50: 2020 2020 2020 2020 7265 6765 783d 5472          regex=Tr
+0004dc60: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+0004dc70: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
+0004dc80: 2020 2020 2020 2028 5b22 6b65 7931 225d         (["key1"]
+0004dc90: 2c20 5b5d 2c20 5b5d 292c 0a20 2020 2020  , [], []),.     
+0004dca0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0004dcb0: 2020 2020 205f 752e 6173 7365 7274 5f63       _u.assert_c
+0004dcc0: 616c 6c65 645f 7769 7468 280a 2020 2020  alled_with(.    
+0004dcd0: 2020 2020 2020 2020 2020 2020 226b 6579              "key
+0004dce0: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+0004dcf0: 2020 2020 2262 6962 7465 7822 2c0a 2020      "bibtex",.  
+0004dd00: 2020 2020 2020 2020 2020 2020 2020 2740                '@
+0004dd10: 4172 7469 636c 657b 6b65 7931 2c5c 6e20  Article{key1,\n 
+0004dd20: 2020 2020 2020 6a6f 7572 6e61 6c20 3d20        journal = 
+0004dd30: 2250 6879 732e 5265 762e 222c 5c6e 2020  "Phys.Rev.",\n  
+0004dd40: 2020 2020 2020 766f 6c75 6d65 203d 2022        volume = "
+0004dd50: 5830 3122 2c5c 6e7d 272c 0a20 2020 2020  X01",\n}',.     
+0004dd60: 2020 2020 2020 2020 2020 2076 6572 626f             verbo
+0004dd70: 7365 3d30 2c0a 2020 2020 2020 2020 2020  se=0,.          
+0004dd80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0004dd90: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0004dda0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0004ddb0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0004ddc0: 2e72 6570 6c61 6365 5369 6e67 6c65 456e  .replaceSingleEn
+0004ddd0: 7472 7928 0a20 2020 2020 2020 2020 2020  try(.           
+0004dde0: 2020 2020 2020 2020 2030 2c0a 2020 2020           0,.    
+0004ddf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004de00: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+0004de10: 2020 2020 2020 2020 2020 2262 6962 6b65            "bibke
+0004de20: 7922 3a20 226b 6579 3122 2c0a 2020 2020  y": "key1",.    
+0004de30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004de40: 2020 2020 2261 7278 6976 223a 2022 6d79      "arxiv": "my
+0004de50: 6162 6364 6566 222c 0a20 2020 2020 2020  abcdef",.       
+0004de60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004de70: 2022 7075 626c 6973 6865 6422 3a20 2250   "published": "P
+0004de80: 6879 732e 5265 762e 2058 3031 2062 6c61  hys.Rev. X01 bla
+0004de90: 626c 6122 2c0a 2020 2020 2020 2020 2020  bla",.          
+0004dea0: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+0004deb0: 6962 7465 7844 6963 7422 3a20 7b22 766f  ibtexDict": {"vo
+0004dec0: 6c75 6d65 223a 2022 5830 3122 2c20 226a  lume": "X01", "j
+0004ded0: 6f75 726e 616c 223a 2022 5068 7973 2e52  ournal": "Phys.R
+0004dee0: 6576 2e22 2c20 2a2a 6264 7d2c 0a20 2020  ev.", **bd},.   
+0004def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004df00: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+0004df10: 2020 2020 2020 2020 2270 7562 6c69 7368          "publish
+0004df20: 6564 222c 0a20 2020 2020 2020 2020 2020  ed",.           
+0004df30: 2020 2020 2020 2020 205b 226a 6f75 726e           ["journ
+0004df40: 616c 222c 2022 766f 6c75 6d65 225d 2c0a  al", "volume"],.
+0004df50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004df60: 2020 2020 2228 5068 7973 2e52 6576 2e20      "(Phys.Rev. 
+0004df70: 5b41 2d5a 5d7b 317d 2928 5b30 2d39 5d7b  [A-Z]{1})([0-9]{
+0004df80: 327d 292e 2a22 2c0a 2020 2020 2020 2020  2}).*",.        
+0004df90: 2020 2020 2020 2020 2020 2020 5b72 225c              [r"\
+0004dfa0: 3122 2c20 7222 5c32 225d 2c0a 2020 2020  1", r"\2"],.    
+0004dfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dfc0: 6368 616e 6765 643d 5b5d 2c0a 2020 2020  changed=[],.    
+0004dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dfe0: 6661 696c 6564 3d5b 5d2c 0a20 2020 2020  failed=[],.     
+0004dff0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0004e000: 7563 6365 7373 3d5b 5d2c 0a20 2020 2020  uccess=[],.     
+0004e010: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0004e020: 6567 6578 3d54 7275 652c 0a20 2020 2020  egex=True,.     
+0004e030: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
+0004e040: 2020 2020 2020 2020 2020 2020 2020 285b                ([
+0004e050: 226b 6579 3122 5d2c 205b 226b 6579 3122  "key1"], ["key1"
+0004e060: 5d2c 205b 5d29 2c0a 2020 2020 2020 2020  ], []),.        
+0004e070: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0004e080: 2020 5f75 2e61 7373 6572 745f 6361 6c6c    _u.assert_call
+0004e090: 6564 5f77 6974 6828 0a20 2020 2020 2020  ed_with(.       
+0004e0a0: 2020 2020 2020 2020 2022 6b65 7931 222c           "key1",
+0004e0b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004e0c0: 2022 6269 6274 6578 222c 0a20 2020 2020   "bibtex",.     
+0004e0d0: 2020 2020 2020 2020 2020 2027 4041 7274             '@Art
+0004e0e0: 6963 6c65 7b6b 6579 312c 5c6e 2020 2020  icle{key1,\n    
+0004e0f0: 2020 206a 6f75 726e 616c 203d 2022 5068     journal = "Ph
+0004e100: 7973 2e52 6576 2e20 5822 2c5c 6e20 2020  ys.Rev. X",\n   
+0004e110: 2020 2020 2076 6f6c 756d 6520 3d20 2230       volume = "0
+0004e120: 3122 2c5c 6e7d 272c 0a20 2020 2020 2020  1",\n}',.       
+0004e130: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
+0004e140: 3d30 2c0a 2020 2020 2020 2020 2020 2020  =0,.            
+0004e150: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0004e160: 726d 4269 6274 6578 5374 7566 6628 7365  rmBibtexStuff(se
+0004e170: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
+0004e180: 2020 2020 2222 2254 6573 7420 726d 4269      """Test rmBi
+0004e190: 6274 6578 436f 6d6d 656e 7473 2061 6e64  btexComments and
+0004e1a0: 2072 6d42 6962 7465 7841 4361 706f 2222   rmBibtexACapo""
+0004e1b0: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+0004e1c0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+0004e1d0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0004e1e0: 422e 6269 6273 2e72 6d42 6962 7465 7843  B.bibs.rmBibtexC
+0004e1f0: 6f6d 6d65 6e74 7328 0a20 2020 2020 2020  omments(.       
+0004e200: 2020 2020 2020 2020 2027 2563 6f6d 6d65           '%comme
+0004e210: 6e74 5c6e 4061 7274 6963 6c65 7b67 6869  nt\n@article{ghi
+0004e220: 2c5c 6e61 7574 686f 7220 3d20 226d 6522  ,\nauthor = "me"
+0004e230: 2c5c 6e74 6974 6c65 203d 2022 6768 6922  ,\ntitle = "ghi"
+0004e240: 2c7d 270a 2020 2020 2020 2020 2020 2020  ,}'.            
+0004e250: 292c 0a20 2020 2020 2020 2020 2020 2027  ),.            '
+0004e260: 4061 7274 6963 6c65 7b67 6869 2c5c 6e61  @article{ghi,\na
+0004e270: 7574 686f 7220 3d20 226d 6522 2c5c 6e74  uthor = "me",\nt
+0004e280: 6974 6c65 203d 2022 6768 6922 2c7d 272c  itle = "ghi",}',
+0004e290: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0004e2a0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0004e2b0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0004e2c0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+0004e2d0: 726d 4269 6274 6578 436f 6d6d 656e 7473  rmBibtexComments
+0004e2e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0004e2f0: 2020 2720 2563 6f6d 6d65 6e74 5c6e 4061    ' %comment\n@a
+0004e300: 7274 6963 6c65 7b67 6869 2c5c 6e61 7574  rticle{ghi,\naut
+0004e310: 686f 7220 3d20 226d 6522 2c5c 6e74 6974  hor = "me",\ntit
+0004e320: 6c65 203d 2022 6768 6922 2c7d 270a 2020  le = "ghi",}'.  
+0004e330: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0004e340: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+0004e350: 6c65 7b67 6869 2c5c 6e61 7574 686f 7220  le{ghi,\nauthor 
+0004e360: 3d20 226d 6522 2c5c 6e74 6974 6c65 203d  = "me",\ntitle =
+0004e370: 2022 6768 6922 2c7d 272c 0a20 2020 2020   "ghi",}',.     
+0004e380: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+0004e390: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0004e3a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0004e3b0: 7042 4442 2e62 6962 732e 726d 4269 6274  pBDB.bibs.rmBibt
+0004e3c0: 6578 436f 6d6d 656e 7473 280a 2020 2020  exComments(.    
+0004e3d0: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
+0004e3e0: 7469 636c 657b 6768 692c 5c6e 6175 7468  ticle{ghi,\nauth
+0004e3f0: 6f72 203d 2022 256d 6522 2c5c 6e74 6974  or = "%me",\ntit
+0004e400: 6c65 203d 2022 6768 6922 2c7d 270a 2020  le = "ghi",}'.  
+0004e410: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0004e420: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+0004e430: 6c65 7b67 6869 2c5c 6e61 7574 686f 7220  le{ghi,\nauthor 
+0004e440: 3d20 2225 6d65 222c 5c6e 7469 746c 6520  = "%me",\ntitle 
+0004e450: 3d20 2267 6869 222c 7d27 2c0a 2020 2020  = "ghi",}',.    
+0004e460: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+0004e470: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+0004e480: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0004e490: 2e70 4244 422e 6269 6273 2e72 6d42 6962  .pBDB.bibs.rmBib
+0004e4a0: 7465 7843 6f6d 6d65 6e74 7328 0a20 2020  texComments(.   
+0004e4b0: 2020 2020 2020 2020 2020 2020 2027 4061               '@a
+0004e4c0: 7274 6963 6c65 7b67 6869 2c5c 6e61 7574  rticle{ghi,\naut
+0004e4d0: 686f 7220 3d20 226d 6522 2c5c 6e74 6974  hor = "me",\ntit
+0004e4e0: 6c65 203d 2022 6768 6922 2c27 0a20 2020  le = "ghi",'.   
+0004e4f0: 2020 2020 2020 2020 2020 2020 202b 2027               + '
+0004e500: 5c6e 2020 256a 6f75 726e 616c 3d22 4a43  \n  %journal="JC
+0004e510: 4150 222c 5c6e 7d27 0a20 2020 2020 2020  AP",\n}'.       
+0004e520: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+0004e530: 2020 2020 2740 6172 7469 636c 657b 6768      '@article{gh
+0004e540: 692c 5c6e 6175 7468 6f72 203d 2022 6d65  i,\nauthor = "me
+0004e550: 222c 5c6e 7469 746c 6520 3d20 2267 6869  ",\ntitle = "ghi
+0004e560: 222c 5c6e 7d27 2c0a 2020 2020 2020 2020  ",\n}',.        
+0004e570: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0004e580: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0004e590: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+0004e5a0: 4442 2e62 6962 732e 726d 4269 6274 6578  DB.bibs.rmBibtex
+0004e5b0: 4143 6170 6f28 0a20 2020 2020 2020 2020  ACapo(.         
+0004e5c0: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
+0004e5d0: 7b67 6869 2c5c 6e61 7574 686f 7220 3d20  {ghi,\nauthor = 
+0004e5e0: 226d 6522 2c5c 6e74 6974 6c65 203d 2022  "me",\ntitle = "
+0004e5f0: 6768 5c6e 6922 2c5c 6e7d 270a 2020 2020  gh\ni",\n}'.    
 0004e600: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-0004e610: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
-0004e620: 7b67 6869 2c5c 6e61 7574 686f 7220 3d20  {ghi,\nauthor = 
-0004e630: 226d 6522 2c5c 6e74 6974 6c65 203d 2022  "me",\ntitle = "
-0004e640: 6768 6922 2c7d 272c 0a20 2020 2020 2020  ghi",}',.       
-0004e650: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0004e660: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0004e670: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0004e680: 4442 2e62 6962 732e 726d 4269 6274 6578  DB.bibs.rmBibtex
-0004e690: 436f 6d6d 656e 7473 280a 2020 2020 2020  Comments(.      
-0004e6a0: 2020 2020 2020 2020 2020 2740 6172 7469            '@arti
-0004e6b0: 636c 657b 6768 692c 5c6e 6175 7468 6f72  cle{ghi,\nauthor
-0004e6c0: 203d 2022 256d 6522 2c5c 6e74 6974 6c65   = "%me",\ntitle
-0004e6d0: 203d 2022 6768 6922 2c7d 270a 2020 2020   = "ghi",}'.    
-0004e6e0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-0004e6f0: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
-0004e700: 7b67 6869 2c5c 6e61 7574 686f 7220 3d20  {ghi,\nauthor = 
-0004e710: 2225 6d65 222c 5c6e 7469 746c 6520 3d20  "%me",\ntitle = 
-0004e720: 2267 6869 222c 7d27 2c0a 2020 2020 2020  "ghi",}',.      
-0004e730: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0004e740: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-0004e750: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0004e760: 4244 422e 6269 6273 2e72 6d42 6962 7465  BDB.bibs.rmBibte
-0004e770: 7843 6f6d 6d65 6e74 7328 0a20 2020 2020  xComments(.     
-0004e780: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-0004e790: 6963 6c65 7b67 6869 2c5c 6e61 7574 686f  icle{ghi,\nautho
-0004e7a0: 7220 3d20 226d 6522 2c5c 6e74 6974 6c65  r = "me",\ntitle
-0004e7b0: 203d 2022 6768 6922 2c27 0a20 2020 2020   = "ghi",'.     
-0004e7c0: 2020 2020 2020 2020 2020 202b 2027 5c6e             + '\n
-0004e7d0: 2020 256a 6f75 726e 616c 3d22 4a43 4150    %journal="JCAP
-0004e7e0: 222c 5c6e 7d27 0a20 2020 2020 2020 2020  ",\n}'.         
-0004e7f0: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-0004e800: 2020 2740 6172 7469 636c 657b 6768 692c    '@article{ghi,
-0004e810: 5c6e 6175 7468 6f72 203d 2022 6d65 222c  \nauthor = "me",
-0004e820: 5c6e 7469 746c 6520 3d20 2267 6869 222c  \ntitle = "ghi",
-0004e830: 5c6e 7d27 2c0a 2020 2020 2020 2020 290a  \n}',.        ).
-0004e840: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0004e850: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0004e860: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0004e870: 2e62 6962 732e 726d 4269 6274 6578 4143  .bibs.rmBibtexAC
-0004e880: 6170 6f28 0a20 2020 2020 2020 2020 2020  apo(.           
-0004e890: 2020 2020 2027 4061 7274 6963 6c65 7b67       '@article{g
-0004e8a0: 6869 2c5c 6e61 7574 686f 7220 3d20 226d  hi,\nauthor = "m
-0004e8b0: 6522 2c5c 6e74 6974 6c65 203d 2022 6768  e",\ntitle = "gh
-0004e8c0: 5c6e 6922 2c5c 6e7d 270a 2020 2020 2020  \ni",\n}'.      
-0004e8d0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-0004e8e0: 2020 2020 2027 4041 7274 6963 6c65 7b67       '@Article{g
-0004e8f0: 6869 2c5c 6e20 2020 2020 2020 2061 7574  hi,\n        aut
-0004e900: 686f 7220 3d20 226d 6522 2c5c 6e20 2020  hor = "me",\n   
-0004e910: 2020 2020 2020 270a 2020 2020 2020 2020        '.        
-0004e920: 2020 2020 2b20 2774 6974 6c65 203d 2022      + 'title = "
-0004e930: 7b67 6820 697d 222c 5c6e 7d5c 6e5c 6e27  {gh i}",\n}\n\n'
-0004e940: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0004e950: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0004e960: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-0004e970: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0004e980: 2e72 6d42 6962 7465 7841 4361 706f 280a  .rmBibtexACapo(.
-0004e990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e9a0: 2740 6172 7469 636c 657b 6768 692c 5c6e  '@article{ghi,\n
-0004e9b0: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
-0004e9c0: 7469 746c 6520 3d20 2267 6869 222c 5c6e  title = "ghi",\n
-0004e9d0: 7d27 0a20 2020 2020 2020 2020 2020 2029  }'.            )
-0004e9e0: 2c0a 2020 2020 2020 2020 2020 2020 2740  ,.            '@
-0004e9f0: 4172 7469 636c 657b 6768 692c 5c6e 2020  Article{ghi,\n  
-0004ea00: 2020 2020 2020 6175 7468 6f72 203d 2022        author = "
-0004ea10: 6d65 222c 5c6e 2020 2020 2020 2020 2027  me",\n         '
-0004ea20: 0a20 2020 2020 2020 2020 2020 202b 2027  .            + '
-0004ea30: 7469 746c 6520 3d20 227b 6768 697d 222c  title = "{ghi}",
-0004ea40: 5c6e 7d5c 6e5c 6e27 2c0a 2020 2020 2020  \n}\n\n',.      
-0004ea50: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-0004ea60: 2070 6174 6368 2822 6c6f 6767 696e 672e   patch("logging.
-0004ea70: 4c6f 6767 6572 2e77 6172 6e69 6e67 2229  Logger.warning")
-0004ea80: 2061 7320 5f77 3a0a 2020 2020 2020 2020   as _w:.        
-0004ea90: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0004eaa0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-0004eab0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0004eac0: 6269 6273 2e72 6d42 6962 7465 7841 4361  bibs.rmBibtexACa
-0004ead0: 706f 280a 2020 2020 2020 2020 2020 2020  po(.            
-0004eae0: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
-0004eaf0: 657b 6768 692c 5c6e 6175 7468 6f72 203d  e{ghi,\nauthor =
-0004eb00: 2022 2261 6d65 222c 5c6e 7469 746c 6520   ""ame",\ntitle 
-0004eb10: 3d20 2267 6869 222c 5c6e 7d27 0a20 2020  = "ghi",\n}'.   
-0004eb20: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
-0004eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004eb40: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-0004eb50: 290a 2020 2020 2020 2020 2020 2020 5f77  ).            _w
-0004eb60: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-0004eb70: 6e63 655f 7769 7468 280a 2020 2020 2020  nce_with(.      
-0004eb80: 2020 2020 2020 2020 2020 2243 616e 6e6f            "Canno
-0004eb90: 7420 7061 7273 6520 7072 6f70 6572 6c79  t parse properly
-0004eba0: 3a5c 6e22 0a20 2020 2020 2020 2020 2020  :\n".           
-0004ebb0: 2020 2020 202b 2027 4061 7274 6963 6c65       + '@article
-0004ebc0: 7b67 6869 2c5c 6e61 7574 686f 7220 3d20  {ghi,\nauthor = 
-0004ebd0: 2222 616d 6522 2c5c 6e74 6974 6c65 203d  ""ame",\ntitle =
-0004ebe0: 2022 6768 6922 2c5c 6e7d 270a 2020 2020   "ghi",\n}'.    
-0004ebf0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0004ec00: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
-0004ec10: 6767 696e 672e 4c6f 6767 6572 2e77 6172  gging.Logger.war
-0004ec20: 6e69 6e67 2229 2061 7320 5f77 3a0a 2020  ning") as _w:.  
-0004ec30: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0004ec40: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
-0004ec50: 7042 4442 2e62 6962 732e 726d 4269 6274  pBDB.bibs.rmBibt
-0004ec60: 6578 4143 6170 6f28 2225 6162 6322 292c  exACapo("%abc"),
-0004ec70: 2022 2229 0a20 2020 2020 2020 2020 2020   "").           
-0004ec80: 205f 772e 6173 7365 7274 5f63 616c 6c65   _w.assert_calle
-0004ec90: 645f 6f6e 6365 5f77 6974 6828 2243 616e  d_once_with("Can
-0004eca0: 6e6f 7420 7061 7273 6520 7072 6f70 6572  not parse proper
-0004ecb0: 6c79 3a5c 6e25 6162 6322 290a 0a20 2020  ly:\n%abc")..   
-0004ecc0: 2040 756e 6974 7465 7374 2e73 6b69 7049   @unittest.skipI
-0004ecd0: 6628 736b 6970 5465 7374 7353 6574 7469  f(skipTestsSetti
-0004ece0: 6e67 732e 6f6e 6c69 6e65 2c20 224f 6e6c  ngs.online, "Onl
-0004ecf0: 696e 6520 7465 7374 7322 290a 2020 2020  ine tests").    
-0004ed00: 6465 6620 7465 7374 5f73 6561 7263 684f  def test_searchO
-0004ed10: 4149 5570 6461 7465 735f 6f6e 6c69 6e65  AIUpdates_online
-0004ed20: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-0004ed30: 2020 2020 2020 2022 2222 7465 7374 7320         """tests 
-0004ed40: 666f 7220 7365 6172 6368 4f41 4955 7064  for searchOAIUpd
-0004ed50: 6174 6573 2c20 7769 7468 2072 6561 6c20  ates, with real 
-0004ed60: 636f 6e6e 6563 7469 6f6e 2222 220a 2020  connection""".  
-0004ed70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0004ed80: 7445 7175 616c 2873 656c 662e 7042 4442  tEqual(self.pBDB
-0004ed90: 2e62 6962 732e 7365 6172 6368 4f41 4955  .bibs.searchOAIU
-0004eda0: 7064 6174 6573 2873 7461 7274 4672 6f6d  pdates(startFrom
-0004edb0: 3d31 292c 2028 302c 205b 5d2c 205b 5d29  =1), (0, [], [])
-0004edc0: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
-0004edd0: 4244 422e 6269 6273 2e69 6e73 6572 7428  BDB.bibs.insert(
-0004ede0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0004edf0: 662e 7042 4442 2e62 6962 732e 7072 6570  f.pBDB.bibs.prep
-0004ee00: 6172 6549 6e73 6572 7428 0a20 2020 2020  areInsert(.     
-0004ee10: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-0004ee20: 6963 6c65 7b47 6172 6961 7a7a 6f3a 3230  icle{Gariazzo:20
-0004ee30: 3135 7272 612c 5c6e 6172 7869 763d 2231  15rra,\narxiv="1
-0004ee40: 3530 372e 3038 3230 3422 5c6e 7d27 2c20  507.08204"\n}', 
-0004ee50: 696e 7370 6972 653d 2231 3338 3535 3833  inspire="1385583
-0004ee60: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0004ee70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0004ee80: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0004ee90: 2e69 6e73 6572 7428 0a20 2020 2020 2020  .insert(.       
-0004eea0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-0004eeb0: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
-0004eec0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0004eed0: 2020 2027 4061 7274 6963 6c65 7b50 6c61     '@article{Pla
-0004eee0: 6e63 6b3a 3230 3133 7078 622c 5c6e 6172  nck:2013pxb,\nar
-0004eef0: 7869 763d 2231 3330 332e 3530 3736 225c  xiv="1303.5076"\
-0004ef00: 6e7d 272c 2069 6e73 7069 7265 3d22 3132  n}', inspire="12
-0004ef10: 3234 3734 3122 0a20 2020 2020 2020 2020  24741".         
-0004ef20: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
-0004ef30: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0004ef40: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-0004ef50: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-0004ef60: 6962 732e 7365 6172 6368 4f41 4955 7064  ibs.searchOAIUpd
-0004ef70: 6174 6573 2829 2c0a 2020 2020 2020 2020  ates(),.        
-0004ef80: 2020 2020 2832 2c20 5b5d 2c20 5b22 4761      (2, [], ["Ga
-0004ef90: 7269 617a 7a6f 3a32 3031 3572 7261 222c  riazzo:2015rra",
-0004efa0: 2022 506c 616e 636b 3a32 3031 3370 7862   "Planck:2013pxb
-0004efb0: 225d 292c 0a20 2020 2020 2020 2029 0a20  "]),.        ). 
-0004efc0: 2020 2020 2020 2067 6120 3d20 7365 6c66         ga = self
-0004efd0: 2e70 4244 422e 6269 6273 2e67 6574 416c  .pBDB.bibs.getAl
-0004efe0: 6c28 290a 2020 2020 2020 2020 7265 7320  l().        res 
-0004eff0: 3d20 6761 5b30 5d0a 2020 2020 2020 2020  = ga[0].        
-0004f000: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-0004f010: 7265 735b 2263 6974 6174 696f 6e73 225d  res["citations"]
-0004f020: 203e 2037 3330 3029 0a20 2020 2020 2020   > 7300).       
-0004f030: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-0004f040: 2872 6573 5b22 6369 7461 7469 6f6e 735f  (res["citations_
-0004f050: 6e6f 5f73 656c 6622 5d20 3e20 3639 3030  no_self"] > 6900
-0004f060: 290a 2020 2020 2020 2020 6465 6c20 7265  ).        del re
-0004f070: 735b 2263 6974 6174 696f 6e73 225d 0a20  s["citations"]. 
-0004f080: 2020 2020 2020 2064 656c 2072 6573 5b22         del res["
-0004f090: 6369 7461 7469 6f6e 735f 6e6f 5f73 656c  citations_no_sel
-0004f0a0: 6622 5d0a 2020 2020 2020 2020 7365 6c66  f"].        self
-0004f0b0: 2e61 7373 6572 7445 7175 616c 2872 6573  .assertEqual(res
-0004f0c0: 2c20 6675 6c6c 5265 636f 7264 4164 6529  , fullRecordAde)
-0004f0d0: 0a20 2020 2020 2020 2072 6573 203d 2067  .        res = g
-0004f0e0: 615b 315d 0a20 2020 2020 2020 2073 656c  a[1].        sel
-0004f0f0: 662e 6173 7365 7274 5472 7565 2872 6573  f.assertTrue(res
-0004f100: 5b22 6369 7461 7469 6f6e 7322 5d20 3e20  ["citations"] > 
-0004f110: 3234 3029 0a20 2020 2020 2020 2073 656c  240).        sel
-0004f120: 662e 6173 7365 7274 5472 7565 2872 6573  f.assertTrue(res
-0004f130: 5b22 6369 7461 7469 6f6e 735f 6e6f 5f73  ["citations_no_s
-0004f140: 656c 6622 5d20 3e20 3139 3029 0a20 2020  elf"] > 190).   
-0004f150: 2020 2020 2064 656c 2072 6573 5b22 6369       del res["ci
-0004f160: 7461 7469 6f6e 7322 5d0a 2020 2020 2020  tations"].      
-0004f170: 2020 6465 6c20 7265 735b 2263 6974 6174    del res["citat
-0004f180: 696f 6e73 5f6e 6f5f 7365 6c66 225d 0a20  ions_no_self"]. 
-0004f190: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0004f1a0: 7274 4571 7561 6c28 7265 732c 2066 756c  rtEqual(res, ful
-0004f1b0: 6c52 6563 6f72 6447 6172 6961 7a7a 6f29  lRecordGariazzo)
-0004f1c0: 0a0a 2020 2020 6465 6620 7465 7374 5f73  ..    def test_s
-0004f1d0: 6561 7263 684f 4149 5570 6461 7465 7328  earchOAIUpdates(
-0004f1e0: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
-0004f1f0: 2020 2020 2020 2222 2274 6573 7473 2066        """tests f
-0004f200: 6f72 2073 6561 7263 684f 4149 5570 6461  or searchOAIUpda
-0004f210: 7465 732c 2077 6974 6820 6d6f 636b 2066  tes, with mock f
-0004f220: 756e 6374 696f 6e73 2222 220a 2020 2020  unctions""".    
-0004f230: 2020 2020 6931 203d 2022 3133 3835 3538      i1 = "138558
-0004f240: 3322 0a20 2020 2020 2020 2069 3220 3d20  3".        i2 = 
-0004f250: 2231 3232 3437 3431 220a 2020 2020 2020  "1224741".      
-0004f260: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0004f270: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
-0004f280: 732e 7365 6172 6368 4f41 4955 7064 6174  s.searchOAIUpdat
-0004f290: 6573 2873 7461 7274 4672 6f6d 3d31 292c  es(startFrom=1),
-0004f2a0: 2028 302c 205b 5d2c 205b 5d29 290a 2020   (0, [], [])).  
-0004f2b0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0004f2c0: 6269 6273 2e69 6e73 6572 7428 0a20 2020  bibs.insert(.   
-0004f2d0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0004f2e0: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
-0004f2f0: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
-0004f300: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
-0004f310: 7b47 6172 6961 7a7a 6f3a 3230 3135 7272  {Gariazzo:2015rr
-0004f320: 612c 5c6e 6172 7869 763d 2231 3530 372e  a,\narxiv="1507.
-0004f330: 3038 3230 3422 5c6e 7d27 2c20 696e 7370  08204"\n}', insp
-0004f340: 6972 653d 6931 0a20 2020 2020 2020 2020  ire=i1.         
-0004f350: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
-0004f360: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-0004f370: 2e62 6962 732e 696e 7365 7274 280a 2020  .bibs.insert(.  
-0004f380: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0004f390: 4244 422e 6269 6273 2e70 7265 7061 7265  BDB.bibs.prepare
-0004f3a0: 496e 7365 7274 280a 2020 2020 2020 2020  Insert(.        
-0004f3b0: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
-0004f3c0: 657b 4164 653a 3230 3133 7a75 762c 5c6e  e{Ade:2013zuv,\n
-0004f3d0: 6172 7869 763d 2231 3330 332e 3530 3736  arxiv="1303.5076
-0004f3e0: 225c 6e7d 272c 2069 6e73 7069 7265 3d69  "\n}', inspire=i
-0004f3f0: 320a 2020 2020 2020 2020 2020 2020 290a  2.            ).
-0004f400: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0004f410: 2020 7062 6d20 3d20 4d61 6769 634d 6f63    pbm = MagicMoc
-0004f420: 6b28 290a 2020 2020 2020 2020 7062 7620  k().        pbv 
-0004f430: 3d20 4d61 6769 634d 6f63 6b28 290a 2020  = MagicMock().  
-0004f440: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-0004f450: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
-0004f460: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
-0004f470: 7365 2e45 6e74 7269 6573 2e67 6574 496e  se.Entries.getIn
-0004f480: 7370 6972 6549 444c 6973 7422 2c0a 2020  spireIDList",.  
-0004f490: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0004f4a0: 5f76 616c 7565 3d28 5b5d 2c20 3029 2c0a  _value=([], 0),.
-0004f4b0: 2020 2020 2020 2020 2920 6173 205f 6769          ) as _gi
-0004f4c0: 6c3a 0a20 2020 2020 2020 2020 2020 2073  l:.            s
-0004f4d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0004f4e0: 7365 6c66 2e70 4244 422e 6269 6273 2e73  self.pBDB.bibs.s
-0004f4f0: 6561 7263 684f 4149 5570 6461 7465 7328  earchOAIUpdates(
-0004f500: 7374 6172 7446 726f 6d3d 3129 2c20 2830  startFrom=1), (0
-0004f510: 2c20 5b5d 2c20 5b5d 2929 0a20 2020 2020  , [], [])).     
-0004f520: 2020 2020 2020 205f 6769 6c2e 6173 7365         _gil.asse
-0004f530: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-0004f540: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
-0004f550: 2020 2020 202a 7365 6c66 2e70 4244 422e       *self.pBDB.
-0004f560: 6269 6273 2e67 6574 456e 7472 6965 7349  bibs.getEntriesI
-0004f570: 664e 6f6e 6528 7374 6172 7446 726f 6d3d  fNone(startFrom=
-0004f580: 3129 2c20 666f 7263 653d 4661 6c73 652c  1), force=False,
-0004f590: 2070 6256 616c 3d4e 6f6e 650a 2020 2020   pbVal=None.    
-0004f5a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0004f5b0: 2020 7769 7468 2070 6174 6368 280a 2020    with patch(.  
-0004f5c0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-0004f5d0: 6962 6c69 6f2e 6461 7461 6261 7365 2e45  iblio.database.E
-0004f5e0: 6e74 7269 6573 2e67 6574 496e 7370 6972  ntries.getInspir
-0004f5f0: 6549 444c 6973 7422 2c0a 2020 2020 2020  eIDList",.      
-0004f600: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
-0004f610: 7565 3d28 5b5d 2c20 3029 2c0a 2020 2020  ue=([], 0),.    
-0004f620: 2020 2020 2920 6173 205f 6769 6c3a 0a20      ) as _gil:. 
-0004f630: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0004f640: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0004f650: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0004f660: 662e 7042 4442 2e62 6962 732e 7365 6172  f.pBDB.bibs.sear
-0004f670: 6368 4f41 4955 7064 6174 6573 2865 6e74  chOAIUpdates(ent
-0004f680: 7269 6573 3d5b 2261 222c 2022 6222 5d2c  ries=["a", "b"],
-0004f690: 2070 624d 6178 3d70 626d 292c 0a20 2020   pbMax=pbm),.   
-0004f6a0: 2020 2020 2020 2020 2020 2020 2028 302c               (0,
-0004f6b0: 205b 5d2c 205b 5d29 2c0a 2020 2020 2020   [], []),.      
-0004f6c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0004f6d0: 2020 2020 5f67 696c 2e61 7373 6572 745f      _gil.assert_
-0004f6e0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-0004f6f0: 285b 2261 222c 2022 6222 5d2c 2032 2c20  (["a", "b"], 2, 
-0004f700: 666f 7263 653d 4661 6c73 652c 2070 6256  force=False, pbV
-0004f710: 616c 3d4e 6f6e 6529 0a20 2020 2020 2020  al=None).       
-0004f720: 2020 2020 2070 626d 2e61 7373 6572 745f       pbm.assert_
-0004f730: 616e 795f 6361 6c6c 2832 290a 2020 2020  any_call(2).    
-0004f740: 2020 2020 2020 2020 7062 6d2e 6173 7365          pbm.asse
-0004f750: 7274 5f61 6e79 5f63 616c 6c28 3029 0a20  rt_any_call(0). 
-0004f760: 2020 2020 2020 2065 6e74 7279 3120 3d20         entry1 = 
-0004f770: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
-0004f780: 6574 4279 4269 626b 6579 2822 4761 7269  etByBibkey("Gari
-0004f790: 617a 7a6f 3a32 3031 3572 7261 2229 5b30  azzo:2015rra")[0
-0004f7a0: 5d0a 2020 2020 2020 2020 656e 7472 7932  ].        entry2
-0004f7b0: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
-0004f7c0: 732e 6765 7442 7942 6962 6b65 7928 2241  s.getByBibkey("A
-0004f7d0: 6465 3a32 3031 337a 7576 2229 5b30 5d0a  de:2013zuv")[0].
-0004f7e0: 2020 2020 2020 2020 656e 7472 7931 6120          entry1a 
-0004f7f0: 3d20 6469 6374 2865 6e74 7279 3129 0a20  = dict(entry1). 
-0004f800: 2020 2020 2020 2065 6e74 7279 3261 203d         entry2a =
-0004f810: 2064 6963 7428 656e 7472 7932 290a 2020   dict(entry2).  
-0004f820: 2020 2020 2020 656e 7472 7931 615b 2264        entry1a["d
-0004f830: 6f69 225d 203d 2022 312f 322f 332f 3422  oi"] = "1/2/3/4"
-0004f840: 0a20 2020 2020 2020 2065 6e74 7279 3261  .        entry2a
-0004f850: 5b22 646f 6922 5d20 3d20 2231 2f32 2f33  ["doi"] = "1/2/3
-0004f860: 2f34 220a 2020 2020 2020 2020 656e 7472  /4".        entr
-0004f870: 7931 615b 2262 6962 7465 7844 6963 7422  y1a["bibtexDict"
-0004f880: 5d5b 226a 6f75 726e 616c 225d 203d 2022  ]["journal"] = "
-0004f890: 6a63 6170 220a 2020 2020 2020 2020 656e  jcap".        en
-0004f8a0: 7472 7932 615b 2262 6962 7465 7844 6963  try2a["bibtexDic
-0004f8b0: 7422 5d5b 226a 6f75 726e 616c 225d 203d  t"]["journal"] =
-0004f8c0: 2022 6a63 6170 220a 2020 2020 2020 2020   "jcap".        
-0004f8d0: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
-0004f8e0: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-0004f8f0: 6c69 6f2e 6461 7461 6261 7365 2e45 6e74  lio.database.Ent
-0004f900: 7269 6573 2e67 6574 496e 7370 6972 6549  ries.getInspireI
-0004f910: 444c 6973 7422 2c0a 2020 2020 2020 2020  DList",.        
-0004f920: 2020 2020 7369 6465 5f65 6666 6563 743d      side_effect=
-0004f930: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0004f940: 2020 285b 5d2c 2030 292c 2020 2320 300a    ([], 0),  # 0.
-0004f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004f960: 285b 6931 2c20 6932 5d2c 2032 292c 2020  ([i1, i2], 2),  
-0004f970: 2320 310a 2020 2020 2020 2020 2020 2020  # 1.            
-0004f980: 2020 2020 285b 6931 2c20 6932 5d2c 2032      ([i1, i2], 2
-0004f990: 292c 2020 2320 320a 2020 2020 2020 2020  ),  # 2.        
-0004f9a0: 2020 2020 2020 2020 285b 6931 2c20 6932          ([i1, i2
-0004f9b0: 5d2c 2032 292c 2020 2320 330a 2020 2020  ], 2),  # 3.    
-0004f9c0: 2020 2020 2020 2020 2020 2020 285b 6932              ([i2
-0004f9d0: 5d2c 2031 292c 2020 2320 340a 2020 2020  ], 1),  # 4.    
-0004f9e0: 2020 2020 2020 2020 2020 2020 285b 6931              ([i1
-0004f9f0: 2c20 6932 5d2c 2032 292c 2020 2320 350a  , i2], 2),  # 5.
-0004fa00: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-0004fa10: 2020 2020 2020 2029 2061 7320 5f67 6c2c         ) as _gl,
-0004fa20: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-0004fa30: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-0004fa40: 7765 6269 6d70 6f72 742e 696e 7370 6972  webimport.inspir
-0004fa50: 652e 5765 6253 6561 7263 682e 7265 7472  e.WebSearch.retr
-0004fa60: 6965 7665 4261 7463 6851 7565 7279 222c  ieveBatchQuery",
-0004fa70: 0a20 2020 2020 2020 2020 2020 2073 6964  .            sid
-0004fa80: 655f 6566 6665 6374 3d5b 0a20 2020 2020  e_effect=[.     
-0004fa90: 2020 2020 2020 2020 2020 2028 5b7b 2269             ([{"i
-0004faa0: 6422 3a20 2265 227d 2c20 7b22 6964 223a  d": "e"}, {"id":
-0004fab0: 2022 6422 7d5d 2c20 3229 2c20 2023 2031   "d"}], 2),  # 1
-0004fac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004fad0: 2028 5b7b 2269 6422 3a20 2265 227d 5d2c   ([{"id": "e"}],
-0004fae0: 2031 292c 2020 2320 320a 2020 2020 2020   1),  # 2.      
-0004faf0: 2020 2020 2020 2020 2020 285b 5d2c 2030            ([], 0
-0004fb00: 292c 2020 2320 330a 2020 2020 2020 2020  ),  # 3.        
-0004fb10: 2020 2020 2020 2020 285b 7b22 6964 223a          ([{"id":
-0004fb20: 2022 6522 7d2c 207b 2269 6422 3a20 2264   "e"}, {"id": "d
-0004fb30: 227d 5d2c 2032 292c 2020 2320 340a 2020  "}], 2),  # 4.  
-0004fb40: 2020 2020 2020 2020 2020 2020 2020 285b                ([
-0004fb50: 7b22 6964 223a 2022 6522 7d2c 207b 2269  {"id": "e"}, {"i
-0004fb60: 6422 3a20 2264 227d 5d2c 2032 292c 2020  d": "d"}], 2),  
-0004fb70: 2320 350a 2020 2020 2020 2020 2020 2020  # 5.            
-0004fb80: 5d2c 0a20 2020 2020 2020 2029 2061 7320  ],.        ) as 
-0004fb90: 5f72 622c 2070 6174 6368 280a 2020 2020  _rb, patch(.    
-0004fba0: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-0004fbb0: 6c69 6f2e 7765 6269 6d70 6f72 742e 696e  lio.webimport.in
-0004fbc0: 7370 6972 652e 5765 6253 6561 7263 682e  spire.WebSearch.
-0004fbd0: 7072 6f63 6573 7352 6563 6f72 6422 2c0a  processRecord",.
-0004fbe0: 2020 2020 2020 2020 2020 2020 7369 6465              side
-0004fbf0: 5f65 6666 6563 743d 5b0a 2020 2020 2020  _effect=[.      
-0004fc00: 2020 2020 2020 2020 2020 5b22 7072 3122            ["pr1"
-0004fc10: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0004fc20: 2020 205b 2270 7232 225d 2c0a 2020 2020     ["pr2"],.    
-0004fc30: 2020 2020 2020 2020 2020 2020 5b22 7072              ["pr
-0004fc40: 3322 5d2c 0a20 2020 2020 2020 2020 2020  3"],.           
-0004fc50: 2020 2020 205b 2270 7234 225d 2c0a 2020       ["pr4"],.  
-0004fc60: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
-0004fc70: 7072 3522 5d2c 0a20 2020 2020 2020 2020  pr5"],.         
-0004fc80: 2020 2020 2020 205b 2270 7236 225d 2c0a         ["pr6"],.
-0004fc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004fca0: 5b22 7072 3722 5d2c 0a20 2020 2020 2020  ["pr7"],.       
-0004fcb0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0004fcc0: 2920 6173 205f 7072 2c20 7061 7463 6828  ) as _pr, patch(
-0004fcd0: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-0004fce0: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-0004fcf0: 652e 456e 7472 6965 732e 7570 6461 7465  e.Entries.update
-0004fd00: 5265 636f 7264 222c 0a20 2020 2020 2020  Record",.       
-0004fd10: 2020 2020 2073 6964 655f 6566 6665 6374       side_effect
-0004fd20: 3d5b 5472 7565 2c20 5472 7565 2c20 5472  =[True, True, Tr
-0004fd30: 7565 2c20 5472 7565 2c20 5472 7565 2c20  ue, True, True, 
-0004fd40: 5472 7565 2c20 4661 6c73 652c 2054 7275  True, False, Tru
-0004fd50: 655d 2c0a 2020 2020 2020 2020 2920 6173  e],.        ) as
-0004fd60: 205f 7572 2c20 7061 7463 6828 0a20 2020   _ur, patch(.   
-0004fd70: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
-0004fd80: 626c 696f 2e77 6562 696d 706f 7274 2e69  blio.webimport.i
-0004fd90: 6e73 7069 7265 2e57 6562 5365 6172 6368  nspire.WebSearch
-0004fda0: 2e72 6574 7269 6576 6555 726c 4669 7273  .retrieveUrlFirs
-0004fdb0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-0004fdc0: 7265 7475 726e 5f76 616c 7565 3d22 736f  return_value="so
-0004fdd0: 6d65 6269 6274 6578 222c 0a20 2020 2020  mebibtex",.     
-0004fde0: 2020 2029 2061 7320 5f72 7566 2c20 7061     ) as _ruf, pa
-0004fdf0: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
-0004fe00: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
-0004fe10: 6162 6173 652e 456e 7472 6965 732e 6765  abase.Entries.ge
-0004fe20: 7442 7949 6e73 7069 7265 4944 222c 0a20  tByInspireID",. 
-0004fe30: 2020 2020 2020 2020 2020 2073 6964 655f             side_
-0004fe40: 6566 6665 6374 3d5b 0a20 2020 2020 2020  effect=[.       
-0004fe50: 2020 2020 2020 2020 205b 656e 7472 7931           [entry1
-0004fe60: 615d 2c0a 2020 2020 2020 2020 2020 2020  a],.            
-0004fe70: 2020 2020 5b65 6e74 7279 3261 5d2c 2020      [entry2a],  
-0004fe80: 2320 310a 2020 2020 2020 2020 2020 2020  # 1.            
-0004fe90: 2020 2020 5b65 6e74 7279 3161 5d2c 0a20      [entry1a],. 
-0004fea0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0004feb0: 656e 7472 7932 615d 2c20 2023 2033 0a20  entry2a],  # 3. 
-0004fec0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0004fed0: 656e 7472 7931 615d 2c0a 2020 2020 2020  entry1a],.      
-0004fee0: 2020 2020 2020 2020 2020 5b65 6e74 7279            [entry
-0004fef0: 3261 5d2c 2020 2320 342c 350a 2020 2020  2a],  # 4,5.    
-0004ff00: 2020 2020 2020 2020 2020 2020 5b65 6e74              [ent
-0004ff10: 7279 3161 5d2c 2020 2320 360a 2020 2020  ry1a],  # 6.    
-0004ff20: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-0004ff30: 2020 2029 2061 7320 5f67 693a 0a20 2020     ) as _gi:.   
-0004ff40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0004ff50: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-0004ff60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0004ff70: 7042 4442 2e62 6962 732e 7365 6172 6368  pBDB.bibs.search
-0004ff80: 4f41 4955 7064 6174 6573 2865 6e74 7269  OAIUpdates(entri
-0004ff90: 6573 3d5b 2261 225d 2c20 7062 5661 6c3d  es=["a"], pbVal=
-0004ffa0: 7062 7629 2c0a 2020 2020 2020 2020 2020  pbv),.          
-0004ffb0: 2020 2020 2020 2830 2c20 5b5d 2c20 5b5d        (0, [], []
-0004ffc0: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
-0004ffd0: 2020 2320 300a 2020 2020 2020 2020 2020    # 0.          
-0004ffe0: 2020 5f67 6c2e 6173 7365 7274 5f63 616c    _gl.assert_cal
-0004fff0: 6c65 645f 6f6e 6365 5f77 6974 6828 5b22  led_once_with(["
-00050000: 6122 5d2c 2031 2c20 666f 7263 653d 4661  a"], 1, force=Fa
-00050010: 6c73 652c 2070 6256 616c 3d70 6276 290a  lse, pbVal=pbv).
-00050020: 2020 2020 2020 2020 2020 2020 5f72 622e              _rb.
-00050030: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
-00050040: 6428 290a 2020 2020 2020 2020 2020 2020  d().            
-00050050: 5f70 722e 6173 7365 7274 5f6e 6f74 5f63  _pr.assert_not_c
-00050060: 616c 6c65 6428 290a 2020 2020 2020 2020  alled().        
-00050070: 2020 2020 5f75 722e 6173 7365 7274 5f6e      _ur.assert_n
-00050080: 6f74 5f63 616c 6c65 6428 290a 2020 2020  ot_called().    
-00050090: 2020 2020 2020 2020 5f67 692e 6173 7365          _gi.asse
-000500a0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-000500b0: 2020 2020 2020 2020 2020 2020 5f67 6c2e              _gl.
-000500c0: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
-000500d0: 2020 2020 2020 2020 205f 7275 662e 6173           _ruf.as
-000500e0: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
-000500f0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00050100: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00050110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050120: 7365 6c66 2e70 4244 422e 6269 6273 2e73  self.pBDB.bibs.s
-00050130: 6561 7263 684f 4149 5570 6461 7465 7328  earchOAIUpdates(
-00050140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00050150: 2020 2020 2065 6e74 7269 6573 3d5b 2261       entries=["a
-00050160: 225d 2c20 666f 7263 653d 5472 7565 2c20  "], force=True, 
-00050170: 7265 6c6f 6164 416c 6c3d 5472 7565 2c20  reloadAll=True, 
-00050180: 7062 5661 6c3d 7062 760a 2020 2020 2020  pbVal=pbv.      
-00050190: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-000501a0: 2020 2020 2020 2020 2020 2020 2028 322c               (2,
-000501b0: 205b 5d2c 205b 2247 6172 6961 7a7a 6f3a   [], ["Gariazzo:
-000501c0: 3230 3135 7272 6122 2c20 2241 6465 3a32  2015rra", "Ade:2
-000501d0: 3031 337a 7576 225d 292c 0a20 2020 2020  013zuv"]),.     
-000501e0: 2020 2020 2020 2029 2020 2320 310a 2020         )  # 1.  
-000501f0: 2020 2020 2020 2020 2020 5f67 6c2e 6173            _gl.as
-00050200: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-00050210: 5f77 6974 6828 5b22 6122 5d2c 2031 2c20  _with(["a"], 1, 
-00050220: 666f 7263 653d 5472 7565 2c20 7062 5661  force=True, pbVa
-00050230: 6c3d 7062 7629 0a20 2020 2020 2020 2020  l=pbv).         
-00050240: 2020 205f 7262 2e61 7373 6572 745f 6361     _rb.assert_ca
-00050250: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
-00050260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050270: 5b69 312c 2069 325d 2c0a 2020 2020 2020  [i1, i2],.      
-00050280: 2020 2020 2020 2020 2020 7365 6172 6368            search
-00050290: 466f 726d 6174 3d22 7265 6369 643a 2573  Format="recid:%s
-000502a0: 222c 0a20 2020 2020 2020 2020 2020 2029  ",.            )
-000502b0: 0a20 2020 2020 2020 2020 2020 205f 7072  .            _pr
-000502c0: 2e61 7373 6572 745f 616e 795f 6361 6c6c  .assert_any_call
-000502d0: 287b 2269 6422 3a20 2265 227d 2c20 6269  ({"id": "e"}, bi
-000502e0: 6274 6578 3d65 6e74 7279 3161 5b22 6269  btex=entry1a["bi
-000502f0: 6274 6578 225d 290a 2020 2020 2020 2020  btex"]).        
-00050300: 2020 2020 5f70 722e 6173 7365 7274 5f61      _pr.assert_a
-00050310: 6e79 5f63 616c 6c28 7b22 6964 223a 2022  ny_call({"id": "
-00050320: 6422 7d2c 2062 6962 7465 783d 656e 7472  d"}, bibtex=entr
-00050330: 7932 615b 2262 6962 7465 7822 5d29 0a20  y2a["bibtex"]). 
-00050340: 2020 2020 2020 2020 2020 2065 3161 203d             e1a =
-00050350: 2064 6963 7428 656e 7472 7931 6129 0a20   dict(entry1a). 
-00050360: 2020 2020 2020 2020 2020 2065 3161 5b22             e1a["
-00050370: 6269 6274 6578 225d 203d 2022 736f 6d65  bibtex"] = "some
-00050380: 6269 6274 6578 220a 2020 2020 2020 2020  bibtex".        
-00050390: 2020 2020 6465 6c20 6531 615b 2262 6962      del e1a["bib
-000503a0: 7465 7844 6963 7422 5d5b 226a 6f75 726e  texDict"]["journ
-000503b0: 616c 225d 0a20 2020 2020 2020 2020 2020  al"].           
-000503c0: 2065 3261 203d 2064 6963 7428 656e 7472   e2a = dict(entr
-000503d0: 7932 6129 0a20 2020 2020 2020 2020 2020  y2a).           
-000503e0: 2065 3261 5b22 6269 6274 6578 225d 203d   e2a["bibtex"] =
-000503f0: 2022 736f 6d65 6269 6274 6578 220a 2020   "somebibtex".  
-00050400: 2020 2020 2020 2020 2020 6465 6c20 6532            del e2
-00050410: 615b 2262 6962 7465 7844 6963 7422 5d5b  a["bibtexDict"][
-00050420: 226a 6f75 726e 616c 225d 0a20 2020 2020  "journal"].     
-00050430: 2020 2020 2020 205f 7572 2e61 7373 6572         _ur.asser
-00050440: 745f 616e 795f 6361 6c6c 2865 3161 2c20  t_any_call(e1a, 
-00050450: 5b22 7072 3122 5d2c 2054 7275 652c 2054  ["pr1"], True, T
-00050460: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-00050470: 205f 7572 2e61 7373 6572 745f 616e 795f   _ur.assert_any_
-00050480: 6361 6c6c 2865 6e74 7279 3261 2c20 5b22  call(entry2a, ["
-00050490: 7072 3222 5d2c 2054 7275 652c 2054 7275  pr2"], True, Tru
-000504a0: 6529 0a20 2020 2020 2020 2020 2020 205f  e).            _
-000504b0: 6769 2e61 7373 6572 745f 616e 795f 6361  gi.assert_any_ca
-000504c0: 6c6c 2822 6522 290a 2020 2020 2020 2020  ll("e").        
-000504d0: 2020 2020 5f67 692e 6173 7365 7274 5f61      _gi.assert_a
-000504e0: 6e79 5f63 616c 6c28 2264 2229 0a20 2020  ny_call("d").   
-000504f0: 2020 2020 2020 2020 2070 6276 2e61 7373           pbv.ass
-00050500: 6572 745f 616e 795f 6361 6c6c 2831 290a  ert_any_call(1).
-00050510: 2020 2020 2020 2020 2020 2020 7062 762e              pbv.
-00050520: 6173 7365 7274 5f61 6e79 5f63 616c 6c28  assert_any_call(
-00050530: 3229 0a20 2020 2020 2020 2020 2020 205f  2).            _
-00050540: 7275 662e 7265 7365 745f 6d6f 636b 2829  ruf.reset_mock()
-00050550: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00050560: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00050570: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00050580: 656c 662e 7042 4442 2e62 6962 732e 7365  elf.pBDB.bibs.se
-00050590: 6172 6368 4f41 4955 7064 6174 6573 2865  archOAIUpdates(e
-000505a0: 6e74 7269 6573 3d5b 2261 225d 292c 0a20  ntries=["a"]),. 
-000505b0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-000505c0: 312c 205b 5d2c 205b 2247 6172 6961 7a7a  1, [], ["Gariazz
-000505d0: 6f3a 3230 3135 7272 6122 5d29 2c0a 2020  o:2015rra"]),.  
-000505e0: 2020 2020 2020 2020 2020 2920 2023 2032            )  # 2
-000505f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00050600: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00050610: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00050620: 656c 662e 7042 4442 2e62 6962 732e 7365  elf.pBDB.bibs.se
-00050630: 6172 6368 4f41 4955 7064 6174 6573 2865  archOAIUpdates(e
-00050640: 6e74 7269 6573 3d5b 2261 225d 292c 2028  ntries=["a"]), (
-00050650: 302c 205b 5d2c 205b 5d29 0a20 2020 2020  0, [], []).     
-00050660: 2020 2020 2020 2029 2020 2320 330a 2020         )  # 3.  
-00050670: 2020 2020 2020 2020 2020 5f75 722e 6173            _ur.as
-00050680: 7365 7274 5f61 6e79 5f63 616c 6c28 656e  sert_any_call(en
-00050690: 7472 7931 612c 205b 2270 7233 225d 2c20  try1a, ["pr3"], 
-000506a0: 4661 6c73 652c 2046 616c 7365 290a 2020  False, False).  
-000506b0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000506c0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-000506d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000506e0: 2e70 4244 422e 6269 6273 2e73 6561 7263  .pBDB.bibs.searc
-000506f0: 684f 4149 5570 6461 7465 7328 656e 7472  hOAIUpdates(entr
-00050700: 6965 733d 5b22 6122 5d2c 2073 7461 7274  ies=["a"], start
-00050710: 4672 6f6d 3d31 292c 0a20 2020 2020 2020  From=1),.       
-00050720: 2020 2020 2020 2020 2028 322c 205b 5d2c           (2, [],
-00050730: 205b 2241 6465 3a32 3031 337a 7576 222c   ["Ade:2013zuv",
-00050740: 2022 4761 7269 617a 7a6f 3a32 3031 3572   "Gariazzo:2015r
-00050750: 7261 225d 292c 0a20 2020 2020 2020 2020  ra"]),.         
-00050760: 2020 2029 2020 2320 340a 2020 2020 2020     )  # 4.      
-00050770: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00050780: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00050790: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-000507a0: 422e 6269 6273 2e73 6561 7263 684f 4149  B.bibs.searchOAI
-000507b0: 5570 6461 7465 7328 656e 7472 6965 733d  Updates(entries=
-000507c0: 5b65 6e74 7279 315d 292c 0a20 2020 2020  [entry1]),.     
-000507d0: 2020 2020 2020 2020 2020 2028 322c 205b             (2, [
-000507e0: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
-000507f0: 6122 5d2c 205b 2241 6465 3a32 3031 337a  a"], ["Ade:2013z
-00050800: 7576 225d 292c 0a20 2020 2020 2020 2020  uv"]),.         
-00050810: 2020 2029 2020 2320 350a 2020 2020 2020     )  # 5.      
-00050820: 2020 2020 2020 5f72 7566 2e61 7373 6572        _ruf.asser
-00050830: 745f 6e6f 745f 6361 6c6c 6564 2829 0a0a  t_not_called()..
-00050840: 2020 2020 6465 6620 7465 7374 5f73 6574      def test_set
-00050850: 5374 7566 6628 7365 6c66 2c20 2a61 7267  Stuff(self, *arg
-00050860: 7329 3a0a 2020 2020 2020 2020 2222 2274  s):.        """t
-00050870: 6573 7420 5b22 7365 7442 6f6f 6b22 2c20  est ["setBook", 
-00050880: 2273 6574 4c65 6374 7572 6522 2c20 2273  "setLecture", "s
-00050890: 6574 5068 6454 6865 7369 7322 2c0a 2020  etPhdThesis",.  
-000508a0: 2020 2020 2020 2273 6574 5072 6f63 6565        "setProcee
-000508b0: 6469 6e67 222c 2022 7365 7452 6576 6965  ding", "setRevie
-000508c0: 7722 2c20 2273 6574 4e6f 5570 6461 7465  w", "setNoUpdate
-000508d0: 225d 0a20 2020 2020 2020 2022 2222 0a20  "].        """. 
-000508e0: 2020 2020 2020 2073 656c 662e 696e 7365         self.inse
-000508f0: 7274 5f74 6872 6565 2829 0a20 2020 2020  rt_three().     
-00050900: 2020 2066 6f72 2070 726f 6365 6475 7265     for procedure
-00050910: 2c20 6669 656c 6420 696e 207a 6970 280a  , field in zip(.
-00050920: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-00050930: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00050940: 6574 426f 6f6b 222c 0a20 2020 2020 2020  etBook",.       
-00050950: 2020 2020 2020 2020 2022 7365 744c 6563           "setLec
-00050960: 7475 7265 222c 0a20 2020 2020 2020 2020  ture",.         
-00050970: 2020 2020 2020 2022 7365 7450 6864 5468         "setPhdTh
-00050980: 6573 6973 222c 0a20 2020 2020 2020 2020  esis",.         
-00050990: 2020 2020 2020 2022 7365 7450 726f 6365         "setProce
-000509a0: 6564 696e 6722 2c0a 2020 2020 2020 2020  eding",.        
-000509b0: 2020 2020 2020 2020 2273 6574 5265 7669          "setRevi
-000509c0: 6577 222c 0a20 2020 2020 2020 2020 2020  ew",.           
-000509d0: 2020 2020 2022 7365 744e 6f55 7064 6174       "setNoUpdat
-000509e0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-000509f0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
-00050a00: 2262 6f6f 6b22 2c20 226c 6563 7475 7265  "book", "lecture
-00050a10: 222c 2022 7068 645f 7468 6573 6973 222c  ", "phd_thesis",
-00050a20: 2022 7072 6f63 6565 6469 6e67 222c 2022   "proceeding", "
-00050a30: 7265 7669 6577 222c 2022 6e6f 5570 6461  review", "noUpda
-00050a40: 7465 225d 2c0a 2020 2020 2020 2020 293a  te"],.        ):
-00050a50: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00050a60: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-00050a70: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-00050a80: 4669 656c 6428 2261 6263 222c 2066 6965  Field("abc", fie
-00050a90: 6c64 292c 2030 290a 2020 2020 2020 2020  ld), 0).        
-00050aa0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00050ab0: 7275 6528 6765 7461 7474 7228 7365 6c66  rue(getattr(self
-00050ac0: 2e70 4244 422e 6269 6273 2c20 7072 6f63  .pBDB.bibs, proc
-00050ad0: 6564 7572 6529 2822 6162 6322 2929 0a20  edure)("abc")). 
-00050ae0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00050af0: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-00050b00: 2e70 4244 422e 6269 6273 2e67 6574 4669  .pBDB.bibs.getFi
-00050b10: 656c 6428 2261 6263 222c 2066 6965 6c64  eld("abc", field
-00050b20: 292c 2031 290a 2020 2020 2020 2020 2020  ), 1).          
-00050b30: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00050b40: 6528 6765 7461 7474 7228 7365 6c66 2e70  e(getattr(self.p
-00050b50: 4244 422e 6269 6273 2c20 7072 6f63 6564  BDB.bibs, proced
-00050b60: 7572 6529 2822 6162 6322 2c20 3029 290a  ure)("abc", 0)).
-00050b70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00050b80: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-00050b90: 662e 7042 4442 2e62 6962 732e 6765 7446  f.pBDB.bibs.getF
-00050ba0: 6965 6c64 2822 6162 6322 2c20 6669 656c  ield("abc", fiel
-00050bb0: 6429 2c20 3029 0a20 2020 2020 2020 2020  d), 0).         
-00050bc0: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-00050bd0: 7565 2867 6574 6174 7472 2873 656c 662e  ue(getattr(self.
-00050be0: 7042 4442 2e62 6962 732c 2070 726f 6365  pBDB.bibs, proce
-00050bf0: 6475 7265 2928 2261 6263 3122 2929 0a0a  dure)("abc1"))..
-00050c00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00050c10: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-00050c20: 662e 7042 4442 2e62 6962 732e 6765 7446  f.pBDB.bibs.getF
-00050c30: 6965 6c64 2822 6465 6622 2c20 6669 656c  ield("def", fiel
-00050c40: 6429 2c20 3029 0a20 2020 2020 2020 2020  d), 0).         
-00050c50: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00050c60: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
-00050c70: 6273 2e67 6574 4669 656c 6428 2267 6869  bs.getField("ghi
-00050c80: 222c 2066 6965 6c64 292c 2030 290a 2020  ", field), 0).  
-00050c90: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00050ca0: 7373 6572 7445 7175 616c 2867 6574 6174  ssertEqual(getat
-00050cb0: 7472 2873 656c 662e 7042 4442 2e62 6962  tr(self.pBDB.bib
-00050cc0: 732c 2070 726f 6365 6475 7265 2928 5b22  s, procedure)(["
-00050cd0: 6465 6622 2c20 2267 6869 225d 292c 204e  def", "ghi"]), N
-00050ce0: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
-00050cf0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00050d00: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
-00050d10: 2e67 6574 4669 656c 6428 2264 6566 222c  .getField("def",
-00050d20: 2066 6965 6c64 292c 2031 290a 2020 2020   field), 1).    
-00050d30: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00050d40: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
-00050d50: 4442 2e62 6962 732e 6765 7446 6965 6c64  DB.bibs.getField
-00050d60: 2822 6768 6922 2c20 6669 656c 6429 2c20  ("ghi", field), 
-00050d70: 3129 0a20 2020 2020 2020 2020 2020 2073  1).            s
-00050d80: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00050d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00050da0: 2067 6574 6174 7472 2873 656c 662e 7042   getattr(self.pB
-00050db0: 4442 2e62 6962 732c 2070 726f 6365 6475  DB.bibs, procedu
-00050dc0: 7265 2928 5b22 6465 6622 2c20 2267 6869  re)(["def", "ghi
-00050dd0: 225d 2c20 3029 2c20 4e6f 6e65 0a20 2020  "], 0), None.   
-00050de0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00050df0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00050e00: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00050e10: 422e 6269 6273 2e67 6574 4669 656c 6428  B.bibs.getField(
-00050e20: 2264 6566 222c 2066 6965 6c64 292c 2030  "def", field), 0
-00050e30: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00050e40: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-00050e50: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-00050e60: 7446 6965 6c64 2822 6768 6922 2c20 6669  tField("ghi", fi
-00050e70: 656c 6429 2c20 3029 0a0a 2020 2020 6465  eld), 0)..    de
-00050e80: 6620 7465 7374 5f75 7064 6174 6528 7365  f test_update(se
-00050e90: 6c66 2c20 2a61 7267 7329 3a0a 2020 2020  lf, *args):.    
-00050ea0: 2020 2020 2222 2254 6573 7420 6765 6e65      """Test gene
-00050eb0: 7261 6c20 7570 6461 7465 2c20 6669 656c  ral update, fiel
-00050ec0: 6420 7570 6461 7465 2c20 6269 626b 6579  d update, bibkey
-00050ed0: 2075 7064 6174 6522 2222 0a20 2020 2020   update""".     
-00050ee0: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-00050ef0: 6c73 6528 7365 6c66 2e70 4244 422e 6269  lse(self.pBDB.bi
-00050f00: 6273 2e67 6574 4669 656c 6428 2261 6263  bs.getField("abc
-00050f10: 222c 2022 6269 626b 6579 2229 290a 2020  ", "bibkey")).  
-00050f20: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
-00050f30: 662e 7042 4442 2e62 6962 732e 7072 6570  f.pBDB.bibs.prep
-00050f40: 6172 6549 6e73 6572 7428 0a20 2020 2020  areInsert(.     
-00050f50: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
-00050f60: 7b61 6263 2c5c 6e61 7574 686f 7220 3d20  {abc,\nauthor = 
-00050f70: 226d 6522 2c5c 6e74 6974 6c65 203d 2022  "me",\ntitle = "
-00050f80: 6162 6322 2c7d 272c 2061 7278 6976 3d22  abc",}', arxiv="
-00050f90: 6162 6322 0a20 2020 2020 2020 2029 0a20  abc".        ). 
-00050fa0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00050fb0: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
-00050fc0: 2e62 6962 732e 696e 7365 7274 2864 6174  .bibs.insert(dat
-00050fd0: 6129 290a 2020 2020 2020 2020 7365 6c66  a)).        self
-00050fe0: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-00050ff0: 662e 7042 4442 2e62 6962 732e 6765 7446  f.pBDB.bibs.getF
-00051000: 6965 6c64 2822 6162 6322 2c20 2262 6962  ield("abc", "bib
-00051010: 6b65 7922 292c 2022 6162 6322 290a 2020  key"), "abc").  
-00051020: 2020 2020 2020 6461 7461 6e65 7720 3d20        datanew = 
-00051030: 7365 6c66 2e70 4244 422e 6269 6273 2e70  self.pBDB.bibs.p
-00051040: 7265 7061 7265 496e 7365 7274 280a 2020  repareInsert(.  
-00051050: 2020 2020 2020 2020 2020 2740 6172 7469            '@arti
-00051060: 636c 657b 6364 652c 5c6e 6175 7468 6f72  cle{cde,\nauthor
-00051070: 203d 2022 6d65 222c 5c6e 7469 746c 6520   = "me",\ntitle 
-00051080: 3d20 2261 6263 222c 7d27 2c20 6172 7869  = "abc",}', arxi
-00051090: 763d 2263 6465 220a 2020 2020 2020 2020  v="cde".        
-000510a0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000510b0: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-000510c0: 4244 422e 6269 6273 2e75 7064 6174 6528  BDB.bibs.update(
-000510d0: 6461 7461 6e65 772c 2022 6162 6322 2929  datanew, "abc"))
-000510e0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000510f0: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
-00051100: 4244 422e 6269 6273 2e67 6574 4669 656c  BDB.bibs.getFiel
-00051110: 6428 2261 6263 222c 2022 6269 626b 6579  d("abc", "bibkey
-00051120: 2229 2c20 2261 6263 2229 0a20 2020 2020  "), "abc").     
-00051130: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00051140: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
-00051150: 6273 2e67 6574 4669 656c 6428 2261 6263  bs.getField("abc
-00051160: 222c 2022 6172 7869 7622 292c 2022 6364  ", "arxiv"), "cd
-00051170: 6522 290a 2020 2020 2020 2020 6465 6c20  e").        del 
-00051180: 6461 7461 5b22 6172 7869 7622 5d0a 2020  data["arxiv"].  
-00051190: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000511a0: 7454 7275 6528 7365 6c66 2e70 4244 422e  tTrue(self.pBDB.
-000511b0: 6269 6273 2e75 7064 6174 6528 6461 7461  bibs.update(data
-000511c0: 2c20 2261 6263 2229 290a 2020 2020 2020  , "abc")).      
-000511d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000511e0: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
-000511f0: 732e 6765 7446 6965 6c64 2822 6162 6322  s.getField("abc"
-00051200: 2c20 2262 6962 6b65 7922 292c 2022 6162  , "bibkey"), "ab
-00051210: 6322 290a 2020 2020 2020 2020 7365 6c66  c").        self
-00051220: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-00051230: 662e 7042 4442 2e62 6962 732e 6765 7446  f.pBDB.bibs.getF
-00051240: 6965 6c64 2822 6162 6322 2c20 2261 7278  ield("abc", "arx
-00051250: 6976 2229 2c20 4e6f 6e65 290a 2020 2020  iv"), None).    
-00051260: 2020 2020 6531 203d 2073 656c 662e 7042      e1 = self.pB
-00051270: 4442 2e62 6962 732e 6765 7442 7942 6962  DB.bibs.getByBib
-00051280: 6b65 7928 2261 6263 2229 0a20 2020 2020  key("abc").     
-00051290: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-000512a0: 6c73 6528 7365 6c66 2e70 4244 422e 6269  lse(self.pBDB.bi
-000512b0: 6273 2e75 7064 6174 6528 7b22 6269 626b  bs.update({"bibk
-000512c0: 6579 223a 2022 6364 6522 7d2c 2022 6162  ey": "cde"}, "ab
-000512d0: 6322 2929 0a20 2020 2020 2020 2077 6974  c")).        wit
-000512e0: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
-000512f0: 2e4c 6f67 6765 722e 6578 6365 7074 696f  .Logger.exceptio
-00051300: 6e22 2920 6173 205f 653a 0a20 2020 2020  n") as _e:.     
-00051310: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00051320: 2e62 6962 732e 7570 6461 7465 287b 2262  .bibs.update({"b
-00051330: 6962 6b65 7922 3a20 2263 6465 227d 2c20  ibkey": "cde"}, 
-00051340: 2261 6263 2229 0a20 2020 2020 2020 2020  "abc").         
-00051350: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-00051360: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00051370: 2020 224e 4f54 204e 554c 4c20 636f 6e73    "NOT NULL cons
-00051380: 7472 6169 6e74 2066 6169 6c65 643a 2065  traint failed: e
-00051390: 6e74 7269 6573 2e62 6962 7465 7822 2c20  ntries.bibtex", 
-000513a0: 5f65 2e63 616c 6c5f 6172 6773 5b30 5d5b  _e.call_args[0][
-000513b0: 305d 0a20 2020 2020 2020 2020 2020 2029  0].            )
-000513c0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000513d0: 7365 7274 4661 6c73 6528 0a20 2020 2020  sertFalse(.     
-000513e0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-000513f0: 2e62 6962 732e 7570 6461 7465 280a 2020  .bibs.update(.  
-00051400: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00051410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051420: 2020 2020 2262 6962 6b65 7922 3a20 2263      "bibkey": "c
-00051430: 6465 222c 0a20 2020 2020 2020 2020 2020  de",.           
-00051440: 2020 2020 2020 2020 2022 6269 6274 6578           "bibtex
-00051450: 223a 2027 4061 7274 6963 6c65 7b61 6263  ": '@article{abc
-00051460: 2c5c 6e61 7574 686f 7220 3d20 226d 6522  ,\nauthor = "me"
-00051470: 2c5c 6e74 6974 6c65 203d 2022 6162 6322  ,\ntitle = "abc"
-00051480: 2c7d 272c 0a20 2020 2020 2020 2020 2020  ,}',.           
-00051490: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-000514a0: 2020 2020 2020 2020 2261 6263 222c 0a20          "abc",. 
-000514b0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000514c0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-000514d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000514e0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
-000514f0: 6574 4279 4269 626b 6579 2822 6162 6322  etByBibkey("abc"
-00051500: 292c 2065 3129 0a0a 2020 2020 2020 2020  ), e1)..        
-00051510: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-00051520: 7365 6c66 2e70 4244 422e 6269 6245 7870  self.pBDB.bibExp
-00051530: 2e69 6e73 6572 7428 2261 6263 222c 2031  .insert("abc", 1
-00051540: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-00051550: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
-00051560: 7042 4442 2e63 6174 4269 622e 696e 7365  pBDB.catBib.inse
-00051570: 7274 2831 2c20 2261 6263 2229 290a 2020  rt(1, "abc")).  
-00051580: 2020 2020 2020 6462 5374 6174 7328 7365        dbStats(se
-00051590: 6c66 2e70 4244 4229 0a20 2020 2020 2020  lf.pBDB).       
-000515a0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000515b0: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
-000515c0: 656c 662e 7042 4442 2e73 7461 7473 2c0a  elf.pBDB.stats,.
-000515d0: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
-000515e0: 6273 223a 2031 2c20 2263 6174 7322 3a20  bs": 1, "cats": 
-000515f0: 322c 2022 6578 7073 223a 2030 2c20 2263  2, "exps": 0, "c
-00051600: 6174 4269 6222 3a20 312c 2022 6361 7445  atBib": 1, "catE
-00051610: 7870 223a 2030 2c20 2262 6962 4578 7022  xp": 0, "bibExp"
-00051620: 3a20 317d 2c0a 2020 2020 2020 2020 290a  : 1},.        ).
-00051630: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-00051640: 6368 2822 7068 7973 6269 626c 696f 2e70  ch("physbiblio.p
-00051650: 6466 2e4c 6f63 616c 5044 462e 7265 6e61  df.LocalPDF.rena
-00051660: 6d65 466f 6c64 6572 222c 2061 7574 6f73  meFolder", autos
-00051670: 7065 633d 5472 7565 2920 6173 205f 6d6f  pec=True) as _mo
-00051680: 636b 5f72 656e 3a0a 2020 2020 2020 2020  ck_ren:.        
-00051690: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-000516a0: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
-000516b0: 6273 2e75 7064 6174 6542 6962 6b65 7928  bs.updateBibkey(
-000516c0: 2261 6263 222c 2022 6465 6622 2929 0a20  "abc", "def")). 
-000516d0: 2020 2020 2020 2020 2020 205f 6d6f 636b             _mock
-000516e0: 5f72 656e 2e61 7373 6572 745f 6361 6c6c  _ren.assert_call
-000516f0: 6564 5f6f 6e63 655f 7769 7468 2870 4250  ed_once_with(pBP
-00051700: 4446 2c20 2261 6263 222c 2022 6465 6622  DF, "abc", "def"
-00051710: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00051720: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00051730: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00051740: 422e 6269 6273 2e67 6574 4279 4269 626b  B.bibs.getByBibk
-00051750: 6579 2822 6465 6622 295b 305d 5b22 6269  ey("def")[0]["bi
-00051760: 6274 6578 225d 2c0a 2020 2020 2020 2020  btex"],.        
-00051770: 2020 2020 2740 4172 7469 636c 657b 6162      '@Article{ab
-00051780: 632c 5c6e 2020 2020 2020 2020 6175 7468  c,\n        auth
-00051790: 6f72 203d 2022 6d65 222c 5c6e 2020 2020  or = "me",\n    
-000517a0: 2020 2020 2027 202b 2027 7469 746c 6520       ' + 'title 
-000517b0: 3d20 227b 6162 637d 222c 5c6e 7d27 2c0a  = "{abc}",\n}',.
-000517c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000517d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000517e0: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
-000517f0: 732e 6765 7442 7942 6962 6b65 7928 2264  s.getByBibkey("d
-00051800: 6566 2229 5b30 5d5b 226f 6c64 5f6b 6579  ef")[0]["old_key
-00051810: 7322 5d2c 2022 6162 6322 290a 2020 2020  s"], "abc").    
-00051820: 2020 2020 6462 5374 6174 7328 7365 6c66      dbStats(self
-00051830: 2e70 4244 4229 0a20 2020 2020 2020 2073  .pBDB).        s
-00051840: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00051850: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00051860: 662e 7042 4442 2e73 7461 7473 2c0a 2020  f.pBDB.stats,.  
-00051870: 2020 2020 2020 2020 2020 7b22 6269 6273            {"bibs
-00051880: 223a 2031 2c20 2263 6174 7322 3a20 322c  ": 1, "cats": 2,
-00051890: 2022 6578 7073 223a 2030 2c20 2263 6174   "exps": 0, "cat
-000518a0: 4269 6222 3a20 312c 2022 6361 7445 7870  Bib": 1, "catExp
-000518b0: 223a 2030 2c20 2262 6962 4578 7022 3a20  ": 0, "bibExp": 
-000518c0: 317d 2c0a 2020 2020 2020 2020 290a 0a20  1},.        ).. 
-000518d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000518e0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-000518f0: 422e 6269 6273 2e67 6574 4279 4269 626b  B.bibs.getByBibk
-00051900: 6579 2822 6465 6622 295b 305d 5b22 696e  ey("def")[0]["in
-00051910: 7370 6972 6522 5d2c 204e 6f6e 6529 0a20  spire"], None). 
-00051920: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00051930: 7274 5472 7565 2873 656c 662e 7042 4442  rtTrue(self.pBDB
-00051940: 2e62 6962 732e 7570 6461 7465 4669 656c  .bibs.updateFiel
-00051950: 6428 2264 6566 222c 2022 696e 7370 6972  d("def", "inspir
-00051960: 6522 2c20 2231 3233 3422 2c20 7665 7262  e", "1234", verb
-00051970: 6f73 653d 3029 290a 2020 2020 2020 2020  ose=0)).        
-00051980: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
-00051990: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
-000519a0: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
-000519b0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000519c0: 6962 732e 7570 6461 7465 4669 656c 6428  ibs.updateField(
-000519d0: 2264 6566 222c 2022 696e 7370 6972 6522  "def", "inspire"
-000519e0: 2c20 2231 3233 3422 290a 2020 2020 2020  , "1234").      
-000519f0: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
-00051a00: 616e 795f 6361 6c6c 2822 5570 6461 7469  any_call("Updati
-00051a10: 6e67 2027 696e 7370 6972 6527 2066 6f72  ng 'inspire' for
-00051a20: 2065 6e74 7279 2027 6465 6627 2229 0a20   entry 'def'"). 
-00051a30: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00051a40: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00051a50: 422e 6269 6273 2e67 6574 4279 4269 626b  B.bibs.getByBibk
-00051a60: 6579 2822 6465 6622 295b 305d 5b22 696e  ey("def")[0]["in
-00051a70: 7370 6972 6522 5d2c 2022 3132 3334 2229  spire"], "1234")
-00051a80: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00051a90: 7365 7274 4661 6c73 6528 0a20 2020 2020  sertFalse(.     
-00051aa0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00051ab0: 2e62 6962 732e 7570 6461 7465 4669 656c  .bibs.updateFiel
-00051ac0: 6428 2264 6566 222c 2022 696e 7370 6972  d("def", "inspir
-00051ad0: 6573 222c 2022 3132 3334 222c 2076 6572  es", "1234", ver
-00051ae0: 626f 7365 3d30 290a 2020 2020 2020 2020  bose=0).        
-00051af0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00051b00: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
-00051b10: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
-00051b20: 4669 656c 6428 2264 6566 222c 2022 696e  Field("def", "in
-00051b30: 7370 6972 6522 2c20 4e6f 6e65 2c20 7665  spire", None, ve
-00051b40: 7262 6f73 653d 3029 290a 2020 2020 2020  rbose=0)).      
-00051b50: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
-00051b60: 6767 696e 672e 4c6f 6767 6572 2e69 6e66  gging.Logger.inf
-00051b70: 6f22 2920 6173 205f 693a 0a20 2020 2020  o") as _i:.     
-00051b80: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00051b90: 2e62 6962 732e 7570 6461 7465 4669 656c  .bibs.updateFiel
-00051ba0: 6428 2264 6566 222c 2022 696e 7370 6972  d("def", "inspir
-00051bb0: 6573 222c 2022 3132 3334 2229 0a20 2020  es", "1234").   
-00051bc0: 2020 2020 2020 2020 205f 692e 6173 7365           _i.asse
-00051bd0: 7274 5f61 6e79 5f63 616c 6c28 2255 7064  rt_any_call("Upd
-00051be0: 6174 696e 6720 2769 6e73 7069 7265 7327  ating 'inspires'
-00051bf0: 2066 6f72 2065 6e74 7279 2027 6465 6627   for entry 'def'
-00051c00: 2229 0a20 2020 2020 2020 2077 6974 6820  ").        with 
-00051c10: 7061 7463 6828 226c 6f67 6769 6e67 2e4c  patch("logging.L
-00051c20: 6f67 6765 722e 7761 726e 696e 6722 2920  ogger.warning") 
-00051c30: 6173 205f 693a 0a20 2020 2020 2020 2020  as _i:.         
-00051c40: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00051c50: 732e 7570 6461 7465 4669 656c 6428 2264  s.updateField("d
-00051c60: 6566 222c 2022 696e 7370 6972 6573 222c  ef", "inspires",
-00051c70: 2022 3132 3334 222c 2076 6572 626f 7365   "1234", verbose
-00051c80: 3d32 290a 2020 2020 2020 2020 2020 2020  =2).            
-00051c90: 5f69 2e61 7373 6572 745f 616e 795f 6361  _i.assert_any_ca
-00051ca0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-00051cb0: 2020 2020 224e 6f6e 2d65 7869 7374 696e      "Non-existin
-00051cc0: 6720 6669 656c 6420 2220 2b20 226f 7220  g field " + "or 
-00051cd0: 756e 6170 7072 6f70 7269 6174 6564 2076  unappropriated v
-00051ce0: 616c 7565 3a20 2864 6566 2c20 696e 7370  alue: (def, insp
-00051cf0: 6972 6573 2c20 3132 3334 2922 0a20 2020  ires, 1234)".   
-00051d00: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00051d10: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
-00051d20: 7068 7973 6269 626c 696f 2e70 6466 2e4c  physbiblio.pdf.L
-00051d30: 6f63 616c 5044 462e 7265 6e61 6d65 466f  ocalPDF.renameFo
-00051d40: 6c64 6572 222c 2061 7574 6f73 7065 633d  lder", autospec=
-00051d50: 5472 7565 2920 6173 205f 6d6f 636b 5f72  True) as _mock_r
-00051d60: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
-00051d70: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-00051d80: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-00051d90: 7064 6174 6542 6962 6b65 7928 2264 6566  pdateBibkey("def
-00051da0: 222c 2022 6162 6322 2929 0a20 2020 2020  ", "abc")).     
-00051db0: 2020 2020 2020 205f 6d6f 636b 5f72 656e         _mock_ren
-00051dc0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-00051dd0: 6e63 655f 7769 7468 2870 4250 4446 2c20  nce_with(pBPDF, 
-00051de0: 2264 6566 222c 2022 6162 6322 290a 2020  "def", "abc").  
-00051df0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00051e00: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00051e10: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00051e20: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
-00051e30: 6162 6322 295b 305d 5b22 6269 6274 6578  abc")[0]["bibtex
-00051e40: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-00051e50: 2740 4172 7469 636c 657b 6162 632c 5c6e  '@Article{abc,\n
-00051e60: 2020 2020 2020 2020 6175 7468 6f72 203d          author =
-00051e70: 2022 6d65 222c 5c6e 2020 2020 2020 2020   "me",\n        
-00051e80: 2027 202b 2027 7469 746c 6520 3d20 227b   ' + 'title = "{
-00051e90: 6162 637d 222c 5c6e 7d27 2c0a 2020 2020  abc}",\n}',.    
-00051ea0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00051eb0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-00051ec0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-00051ed0: 7442 7942 6962 6b65 7928 2261 6263 2229  tByBibkey("abc")
-00051ee0: 5b30 5d5b 226f 6c64 5f6b 6579 7322 5d2c  [0]["old_keys"],
-00051ef0: 2022 6162 632c 6465 6622 290a 0a20 2020   "abc,def")..   
-00051f00: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-00051f10: 2270 6879 7362 6962 6c69 6f2e 7064 662e  "physbiblio.pdf.
-00051f20: 4c6f 6361 6c50 4446 2e72 656e 616d 6546  LocalPDF.renameF
-00051f30: 6f6c 6465 7222 2c20 6175 746f 7370 6563  older", autospec
-00051f40: 3d54 7275 6529 2061 7320 5f6d 6f63 6b5f  =True) as _mock_
-00051f50: 7265 6e3a 0a20 2020 2020 2020 2020 2020  ren:.           
-00051f60: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-00051f70: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-00051f80: 7570 6461 7465 4269 626b 6579 2822 6162  updateBibkey("ab
-00051f90: 6322 2c20 2264 6566 2229 290a 2020 2020  c", "def")).    
-00051fa0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00051fb0: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
-00051fc0: 6273 2e75 7064 6174 6546 6965 6c64 2822  bs.updateField("
-00051fd0: 6465 6622 2c20 2262 6962 6469 6374 222c  def", "bibdict",
-00051fe0: 2022 7b7d 222c 2076 6572 626f 7365 3d30   "{}", verbose=0
-00051ff0: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-00052000: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-00052010: 2e70 4244 422e 6269 6273 2e67 6574 4669  .pBDB.bibs.getFi
-00052020: 656c 6428 2264 6566 222c 2022 6269 6264  eld("def", "bibd
-00052030: 6963 7422 292c 207b 7d29 0a20 2020 2020  ict"), {}).     
-00052040: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-00052050: 7565 280a 2020 2020 2020 2020 2020 2020  ue(.            
-00052060: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-00052070: 7064 6174 6546 6965 6c64 280a 2020 2020  pdateField(.    
-00052080: 2020 2020 2020 2020 2020 2020 2264 6566              "def
-00052090: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000520a0: 2020 2022 6269 6274 6578 222c 0a20 2020     "bibtex",.   
-000520b0: 2020 2020 2020 2020 2020 2020 2027 4041               '@A
-000520c0: 7274 6963 6c65 7b61 6263 2c5c 6e61 7574  rticle{abc,\naut
-000520d0: 686f 7220 3d20 226d 6522 2c5c 6e74 6974  hor = "me",\ntit
-000520e0: 6c65 203d 2022 7b61 6263 7d22 2c5c 6e7d  le = "{abc}",\n}
-000520f0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00052100: 2020 2076 6572 626f 7365 3d30 2c0a 2020     verbose=0,.  
-00052110: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00052120: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00052130: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00052140: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00052150: 2e70 4244 422e 6269 6273 2e67 6574 4669  .pBDB.bibs.getFi
-00052160: 656c 6428 2264 6566 222c 2022 6269 6264  eld("def", "bibd
-00052170: 6963 7422 292c 0a20 2020 2020 2020 2020  ict"),.         
-00052180: 2020 207b 2245 4e54 5259 5459 5045 223a     {"ENTRYTYPE":
-00052190: 2022 6172 7469 636c 6522 2c20 2249 4422   "article", "ID"
-000521a0: 3a20 2261 6263 222c 2022 6175 7468 6f72  : "abc", "author
-000521b0: 223a 2022 6d65 222c 2022 7469 746c 6522  ": "me", "title"
-000521c0: 3a20 227b 6162 637d 227d 2c0a 2020 2020  : "{abc}"},.    
-000521d0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-000521e0: 6c66 2e61 7373 6572 7454 7275 6528 0a20  lf.assertTrue(. 
-000521f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00052200: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
-00052210: 4669 656c 6428 0a20 2020 2020 2020 2020  Field(.         
-00052220: 2020 2020 2020 2022 6465 6622 2c20 2262         "def", "b
-00052230: 6962 7465 7822 2c20 2740 4172 7469 636c  ibtex", '@Articl
-00052240: 657b 6162 632c 5c6e 6175 7468 6f72 203d  e{abc,\nauthor =
-00052250: 2022 6d65 222c 5c6e 7469 746c 6520 3d20   "me",\ntitle = 
-00052260: 272c 2076 6572 626f 7365 3d30 0a20 2020  ', verbose=0.   
-00052270: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00052280: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00052290: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-000522a0: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-000522b0: 4669 656c 6428 2264 6566 222c 2022 6269  Field("def", "bi
-000522c0: 6264 6963 7422 292c 207b 7d29 0a0a 2020  bdict"), {})..  
-000522d0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-000522e0: 6269 6273 2e64 656c 6574 6528 2264 6566  bibs.delete("def
-000522f0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00052300: 696e 7365 7274 5f74 6872 6565 2829 0a20  insert_three(). 
-00052310: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-00052320: 6828 2270 6879 7362 6962 6c69 6f2e 7064  h("physbiblio.pd
-00052330: 662e 4c6f 6361 6c50 4446 2e72 656e 616d  f.LocalPDF.renam
-00052340: 6546 6f6c 6465 7222 2c20 6175 746f 7370  eFolder", autosp
-00052350: 6563 3d54 7275 6529 2061 7320 5f6d 6f63  ec=True) as _moc
-00052360: 6b5f 7265 6e3a 0a20 2020 2020 2020 2020  k_ren:.         
-00052370: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-00052380: 6c73 6528 7365 6c66 2e70 4244 422e 6269  lse(self.pBDB.bi
-00052390: 6273 2e75 7064 6174 6542 6962 6b65 7928  bs.updateBibkey(
-000523a0: 2264 6566 222c 2022 6162 6322 2929 0a0a  "def", "abc"))..
-000523b0: 2020 2020 4075 6e69 7474 6573 742e 736b      @unittest.sk
-000523c0: 6970 4966 2873 6b69 7054 6573 7473 5365  ipIf(skipTestsSe
-000523d0: 7474 696e 6773 2e6f 6e6c 696e 652c 2022  ttings.online, "
-000523e0: 4f6e 6c69 6e65 2074 6573 7473 2229 0a20  Online tests"). 
-000523f0: 2020 2064 6566 2074 6573 745f 7570 6461     def test_upda
-00052400: 7465 4672 6f6d 4f41 495f 6f6e 6c69 6e65  teFromOAI_online
-00052410: 2873 656c 662c 202a 6172 6773 293a 0a20  (self, *args):. 
-00052420: 2020 2020 2020 2022 2222 7465 7374 2075         """test u
-00052430: 7064 6174 6546 726f 6d4f 4149 2077 6974  pdateFromOAI wit
-00052440: 6820 6f6e 6c69 6e65 2063 6f6e 6e65 6374  h online connect
-00052450: 696f 6e22 2222 0a20 2020 2020 2020 2065  ion""".        e
-00052460: 7870 6563 7465 6420 3d20 6675 6c6c 5265  xpected = fullRe
-00052470: 636f 7264 4761 7269 617a 7a6f 0a20 2020  cordGariazzo.   
-00052480: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00052490: 6962 732e 696e 7365 7274 4672 6f6d 4269  ibs.insertFromBi
-000524a0: 6274 6578 280a 2020 2020 2020 2020 2020  btex(.          
-000524b0: 2020 2740 6172 7469 636c 657b 4761 7269    '@article{Gari
-000524c0: 617a 7a6f 3a32 3031 3572 7261 2c5c 6e61  azzo:2015rra,\na
-000524d0: 7278 6976 3d22 3135 3037 2e30 3832 3034  rxiv="1507.08204
-000524e0: 225c 6e7d 270a 2020 2020 2020 2020 290a  "\n}'.        ).
-000524f0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00052500: 6572 7454 7275 6528 7365 6c66 2e70 4244  ertTrue(self.pBD
-00052510: 422e 6269 6273 2e75 7064 6174 6546 726f  B.bibs.updateFro
-00052520: 6d4f 4149 2822 4761 7269 617a 7a6f 3a32  mOAI("Gariazzo:2
-00052530: 3031 3572 7261 2229 290a 2020 2020 2020  015rra")).      
-00052540: 2020 7265 7320 3d20 7365 6c66 2e70 4244    res = self.pBD
-00052550: 422e 6269 6273 2e67 6574 4279 4269 626b  B.bibs.getByBibk
-00052560: 6579 2822 4761 7269 617a 7a6f 3a32 3031  ey("Gariazzo:201
-00052570: 3572 7261 2229 5b30 5d0a 2020 2020 2020  5rra")[0].      
-00052580: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00052590: 6528 7265 735b 2263 6974 6174 696f 6e73  e(res["citations
-000525a0: 225d 203e 2032 3430 290a 2020 2020 2020  "] > 240).      
-000525b0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-000525c0: 6528 7265 735b 2263 6974 6174 696f 6e73  e(res["citations
-000525d0: 5f6e 6f5f 7365 6c66 225d 203e 2031 3930  _no_self"] > 190
-000525e0: 290a 2020 2020 2020 2020 6465 6c20 7265  ).        del re
-000525f0: 735b 2263 6974 6174 696f 6e73 225d 0a20  s["citations"]. 
-00052600: 2020 2020 2020 2064 656c 2072 6573 5b22         del res["
-00052610: 6369 7461 7469 6f6e 735f 6e6f 5f73 656c  citations_no_sel
-00052620: 6622 5d0a 2020 2020 2020 2020 7365 6c66  f"].        self
-00052630: 2e61 7373 6572 7445 7175 616c 2872 6573  .assertEqual(res
-00052640: 2c20 6578 7065 6374 6564 290a 2020 2020  , expected).    
-00052650: 2020 2020 7365 6c66 2e70 4244 422e 756e      self.pBDB.un
-00052660: 646f 2876 6572 626f 7365 3d30 290a 2020  do(verbose=0).  
-00052670: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00052680: 6269 6273 2e69 6e73 6572 7428 0a20 2020  bibs.insert(.   
-00052690: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-000526a0: 4442 2e62 6962 732e 7072 6570 6172 6549  DB.bibs.prepareI
-000526b0: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
-000526c0: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
-000526d0: 7b47 6172 6961 7a7a 6f3a 3230 3135 7272  {Gariazzo:2015rr
-000526e0: 612c 5c6e 6172 7869 763d 2231 3530 372e  a,\narxiv="1507.
-000526f0: 3038 3230 3422 5c6e 7d27 2c20 696e 7370  08204"\n}', insp
-00052700: 6972 653d 2231 3338 3535 3833 220a 2020  ire="1385583".  
-00052710: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00052720: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00052730: 6c66 2e61 7373 6572 7454 7275 6528 7365  lf.assertTrue(se
-00052740: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-00052750: 6174 6546 726f 6d4f 4149 2822 3133 3835  ateFromOAI("1385
-00052760: 3538 3322 2929 0a20 2020 2020 2020 2072  583")).        r
-00052770: 6573 203d 2073 656c 662e 7042 4442 2e62  es = self.pBDB.b
-00052780: 6962 732e 6765 7442 7942 6962 6b65 7928  ibs.getByBibkey(
-00052790: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
-000527a0: 6122 295b 305d 0a20 2020 2020 2020 2073  a")[0].        s
-000527b0: 656c 662e 6173 7365 7274 5472 7565 2872  elf.assertTrue(r
-000527c0: 6573 5b22 6369 7461 7469 6f6e 7322 5d20  es["citations"] 
-000527d0: 3e20 3234 3029 0a20 2020 2020 2020 2073  > 240).        s
-000527e0: 656c 662e 6173 7365 7274 5472 7565 2872  elf.assertTrue(r
-000527f0: 6573 5b22 6369 7461 7469 6f6e 735f 6e6f  es["citations_no
-00052800: 5f73 656c 6622 5d20 3e20 3139 3029 0a20  _self"] > 190). 
-00052810: 2020 2020 2020 2064 656c 2072 6573 5b22         del res["
-00052820: 6369 7461 7469 6f6e 7322 5d0a 2020 2020  citations"].    
-00052830: 2020 2020 6465 6c20 7265 735b 2263 6974      del res["cit
-00052840: 6174 696f 6e73 5f6e 6f5f 7365 6c66 225d  ations_no_self"]
-00052850: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00052860: 7365 7274 4571 7561 6c28 7265 732c 2065  sertEqual(res, e
-00052870: 7870 6563 7465 6429 0a0a 2020 2020 6465  xpected)..    de
-00052880: 6620 7465 7374 5f75 7064 6174 6546 726f  f test_updateFro
-00052890: 6d4f 4149 2873 656c 662c 202a 6172 6773  mOAI(self, *args
-000528a0: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
-000528b0: 7374 2075 7064 6174 6546 726f 6d4f 4149  st updateFromOAI
-000528c0: 2077 6974 686f 7574 2072 656c 7969 6e67   without relying
-000528d0: 0a20 2020 2020 2020 206f 6e20 7468 6520  .        on the 
-000528e0: 7472 7565 2070 4244 422e 6269 6273 2e75  true pBDB.bibs.u
-000528f0: 7064 6174 6549 6e66 6f46 726f 6d4f 4149  pdateInfoFromOAI
-00052900: 2028 6d6f 636b 6564 290a 2020 2020 2020   (mocked).      
-00052910: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
-00052920: 6c66 2e70 4244 422e 6269 6273 2e69 6e73  lf.pBDB.bibs.ins
-00052930: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
-00052940: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00052950: 7072 6570 6172 6549 6e73 6572 7428 0a20  prepareInsert(. 
-00052960: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00052970: 4061 7274 6963 6c65 7b61 6263 2c5c 6e61  @article{abc,\na
-00052980: 7278 6976 3d22 3132 3334 2e35 3637 3839  rxiv="1234.56789
-00052990: 225c 6e7d 272c 2069 6e73 7069 7265 3d22  "\n}', inspire="
-000529a0: 3132 3334 3522 0a20 2020 2020 2020 2020  12345".         
-000529b0: 2020 2029 0a20 2020 2020 2020 2029 0a20     ).        ). 
-000529c0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-000529d0: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-000529e0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-000529f0: 6173 652e 456e 7472 6965 732e 7570 6461  ase.Entries.upda
-00052a00: 7465 496e 666f 4672 6f6d 4f41 4922 2c0a  teInfoFromOAI",.
-00052a10: 2020 2020 2020 2020 2020 2020 6175 746f              auto
-00052a20: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
-00052a30: 2020 2020 2020 2073 6964 655f 6566 6665         side_effe
-00052a40: 6374 3d5b 2261 222c 2022 6222 2c20 2263  ct=["a", "b", "c
-00052a50: 222c 2022 6422 2c20 2265 222c 2022 6622  ", "d", "e", "f"
-00052a60: 5d2c 0a20 2020 2020 2020 2029 2061 7320  ],.        ) as 
-00052a70: 6d6f 636b 5f66 756e 6374 696f 6e3a 0a20  mock_function:. 
-00052a80: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00052a90: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-00052aa0: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
-00052ab0: 696f 2e64 6174 6162 6173 652e 456e 7472  io.database.Entr
-00052ac0: 6965 732e 7570 6461 7465 496e 7370 6972  ies.updateInspir
-00052ad0: 6549 4422 2c0a 2020 2020 2020 2020 2020  eID",.          
-00052ae0: 2020 2020 2020 7369 6465 5f65 6666 6563        side_effec
-00052af0: 743d 5b22 3534 3332 3122 2c20 4661 6c73  t=["54321", Fals
-00052b00: 655d 2c0a 2020 2020 2020 2020 2020 2020  e],.            
-00052b10: 2020 2020 6175 746f 7370 6563 3d54 7275      autospec=Tru
-00052b20: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-00052b30: 2061 7320 5f75 7064 6174 6569 643a 0a20   as _updateid:. 
-00052b40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00052b50: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00052b60: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-00052b70: 7064 6174 6546 726f 6d4f 4149 2822 6162  pdateFromOAI("ab
-00052b80: 6322 292c 2022 6122 290a 2020 2020 2020  c"), "a").      
-00052b90: 2020 2020 2020 2020 2020 6d6f 636b 5f66            mock_f
-00052ba0: 756e 6374 696f 6e2e 6173 7365 7274 5f63  unction.assert_c
-00052bb0: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00052bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00052bd0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00052be0: 6962 732c 2022 3132 3334 3522 2c20 7665  ibs, "12345", ve
-00052bf0: 7262 6f73 653d 300a 2020 2020 2020 2020  rbose=0.        
-00052c00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00052c10: 2020 2020 2020 2020 2020 6d6f 636b 5f66            mock_f
-00052c20: 756e 6374 696f 6e2e 7265 7365 745f 6d6f  unction.reset_mo
-00052c30: 636b 2829 0a20 2020 2020 2020 2020 2020  ck().           
-00052c40: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00052c50: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-00052c60: 6269 6273 2e75 7064 6174 6546 726f 6d4f  bibs.updateFromO
-00052c70: 4149 2822 3132 3334 2229 2c20 2262 2229  AI("1234"), "b")
-00052c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00052c90: 206d 6f63 6b5f 6675 6e63 7469 6f6e 2e61   mock_function.a
-00052ca0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00052cb0: 655f 7769 7468 2873 656c 662e 7042 4442  e_with(self.pBDB
-00052cc0: 2e62 6962 732c 2022 3132 3334 222c 2076  .bibs, "1234", v
-00052cd0: 6572 626f 7365 3d30 290a 2020 2020 2020  erbose=0).      
-00052ce0: 2020 2020 2020 2020 2020 6d6f 636b 5f66            mock_f
-00052cf0: 756e 6374 696f 6e2e 7265 7365 745f 6d6f  unction.reset_mo
-00052d00: 636b 2829 0a20 2020 2020 2020 2020 2020  ck().           
-00052d10: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00052d20: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00052d30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00052d40: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
-00052d50: 4672 6f6d 4f41 4928 5b22 6162 6322 2c20  FromOAI(["abc", 
-00052d60: 2231 3233 3422 5d29 2c20 5b22 6322 2c20  "1234"]), ["c", 
-00052d70: 2264 225d 0a20 2020 2020 2020 2020 2020  "d"].           
-00052d80: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00052d90: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00052da0: 7274 4571 7561 6c28 6d6f 636b 5f66 756e  rtEqual(mock_fun
-00052db0: 6374 696f 6e2e 6361 6c6c 5f63 6f75 6e74  ction.call_count
-00052dc0: 2c20 3229 0a20 2020 2020 2020 2020 2020  , 2).           
-00052dd0: 2020 2020 206d 6f63 6b5f 6675 6e63 7469       mock_functi
-00052de0: 6f6e 2e61 7373 6572 745f 6361 6c6c 6564  on.assert_called
-00052df0: 5f77 6974 6828 7365 6c66 2e70 4244 422e  _with(self.pBDB.
-00052e00: 6269 6273 2c20 2231 3233 3422 2c20 7665  bibs, "1234", ve
-00052e10: 7262 6f73 653d 3029 0a20 2020 2020 2020  rbose=0).       
-00052e20: 2020 2020 2020 2020 206d 6f63 6b5f 6675           mock_fu
-00052e30: 6e63 7469 6f6e 2e72 6573 6574 5f6d 6f63  nction.reset_moc
-00052e40: 6b28 290a 2020 2020 2020 2020 2020 2020  k().            
+0004e610: 2020 2020 2020 2027 4041 7274 6963 6c65         '@Article
+0004e620: 7b67 6869 2c5c 6e20 2020 2020 2020 2061  {ghi,\n        a
+0004e630: 7574 686f 7220 3d20 226d 6522 2c5c 6e20  uthor = "me",\n 
+0004e640: 2020 2020 2020 2020 270a 2020 2020 2020          '.      
+0004e650: 2020 2020 2020 2b20 2774 6974 6c65 203d        + 'title =
+0004e660: 2022 7b67 6820 697d 222c 5c6e 7d5c 6e5c   "{gh i}",\n}\n\
+0004e670: 6e27 2c0a 2020 2020 2020 2020 290a 2020  n',.        ).  
+0004e680: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0004e690: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0004e6a0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0004e6b0: 6273 2e72 6d42 6962 7465 7841 4361 706f  bs.rmBibtexACapo
+0004e6c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0004e6d0: 2020 2740 6172 7469 636c 657b 6768 692c    '@article{ghi,
+0004e6e0: 5c6e 6175 7468 6f72 203d 2022 6d65 222c  \nauthor = "me",
+0004e6f0: 5c6e 7469 746c 6520 3d20 2267 6869 222c  \ntitle = "ghi",
+0004e700: 5c6e 7d27 0a20 2020 2020 2020 2020 2020  \n}'.           
+0004e710: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0004e720: 2740 4172 7469 636c 657b 6768 692c 5c6e  '@Article{ghi,\n
+0004e730: 2020 2020 2020 2020 6175 7468 6f72 203d          author =
+0004e740: 2022 6d65 222c 5c6e 2020 2020 2020 2020   "me",\n        
+0004e750: 2027 0a20 2020 2020 2020 2020 2020 202b   '.            +
+0004e760: 2027 7469 746c 6520 3d20 227b 6768 697d   'title = "{ghi}
+0004e770: 222c 5c6e 7d5c 6e5c 6e27 2c0a 2020 2020  ",\n}\n\n',.    
+0004e780: 2020 2020 290a 2020 2020 2020 2020 7769      ).        wi
+0004e790: 7468 2070 6174 6368 2822 6c6f 6767 696e  th patch("loggin
+0004e7a0: 672e 4c6f 6767 6572 2e77 6172 6e69 6e67  g.Logger.warning
+0004e7b0: 2229 2061 7320 5f77 3a0a 2020 2020 2020  ") as _w:.      
+0004e7c0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0004e7d0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0004e7e0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0004e7f0: 422e 6269 6273 2e72 6d42 6962 7465 7841  B.bibs.rmBibtexA
+0004e800: 4361 706f 280a 2020 2020 2020 2020 2020  Capo(.          
+0004e810: 2020 2020 2020 2020 2020 2740 6172 7469            '@arti
+0004e820: 636c 657b 6768 692c 5c6e 6175 7468 6f72  cle{ghi,\nauthor
+0004e830: 203d 2022 2261 6d65 222c 5c6e 7469 746c   = ""ame",\ntitl
+0004e840: 6520 3d20 2267 6869 222c 5c6e 7d27 0a20  e = "ghi",\n}'. 
+0004e850: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0004e860: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004e870: 2020 2222 2c0a 2020 2020 2020 2020 2020    "",.          
+0004e880: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0004e890: 5f77 2e61 7373 6572 745f 6361 6c6c 6564  _w.assert_called
+0004e8a0: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
+0004e8b0: 2020 2020 2020 2020 2020 2020 2243 616e              "Can
+0004e8c0: 6e6f 7420 7061 7273 6520 7072 6f70 6572  not parse proper
+0004e8d0: 6c79 3a5c 6e22 0a20 2020 2020 2020 2020  ly:\n".         
+0004e8e0: 2020 2020 2020 202b 2027 4061 7274 6963         + '@artic
+0004e8f0: 6c65 7b67 6869 2c5c 6e61 7574 686f 7220  le{ghi,\nauthor 
+0004e900: 3d20 2222 616d 6522 2c5c 6e74 6974 6c65  = ""ame",\ntitle
+0004e910: 203d 2022 6768 6922 2c5c 6e7d 270a 2020   = "ghi",\n}'.  
+0004e920: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0004e930: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+0004e940: 6c6f 6767 696e 672e 4c6f 6767 6572 2e77  logging.Logger.w
+0004e950: 6172 6e69 6e67 2229 2061 7320 5f77 3a0a  arning") as _w:.
+0004e960: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0004e970: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
+0004e980: 662e 7042 4442 2e62 6962 732e 726d 4269  f.pBDB.bibs.rmBi
+0004e990: 6274 6578 4143 6170 6f28 2225 6162 6322  btexACapo("%abc"
+0004e9a0: 292c 2022 2229 0a20 2020 2020 2020 2020  ), "").         
+0004e9b0: 2020 205f 772e 6173 7365 7274 5f63 616c     _w.assert_cal
+0004e9c0: 6c65 645f 6f6e 6365 5f77 6974 6828 2243  led_once_with("C
+0004e9d0: 616e 6e6f 7420 7061 7273 6520 7072 6f70  annot parse prop
+0004e9e0: 6572 6c79 3a5c 6e25 6162 6322 290a 0a20  erly:\n%abc").. 
+0004e9f0: 2020 2040 756e 6974 7465 7374 2e73 6b69     @unittest.ski
+0004ea00: 7049 6628 736b 6970 5465 7374 7353 6574  pIf(skipTestsSet
+0004ea10: 7469 6e67 732e 6f6e 6c69 6e65 2c20 224f  tings.online, "O
+0004ea20: 6e6c 696e 6520 7465 7374 7322 290a 2020  nline tests").  
+0004ea30: 2020 6465 6620 7465 7374 5f73 6561 7263    def test_searc
+0004ea40: 684f 4149 5570 6461 7465 735f 6f6e 6c69  hOAIUpdates_onli
+0004ea50: 6e65 2873 656c 662c 202a 6172 6773 293a  ne(self, *args):
+0004ea60: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
+0004ea70: 7320 666f 7220 7365 6172 6368 4f41 4955  s for searchOAIU
+0004ea80: 7064 6174 6573 2c20 7769 7468 2072 6561  pdates, with rea
+0004ea90: 6c20 636f 6e6e 6563 7469 6f6e 2222 220a  l connection""".
+0004eaa0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0004eab0: 6572 7445 7175 616c 2873 656c 662e 7042  ertEqual(self.pB
+0004eac0: 4442 2e62 6962 732e 7365 6172 6368 4f41  DB.bibs.searchOA
+0004ead0: 4955 7064 6174 6573 2873 7461 7274 4672  IUpdates(startFr
+0004eae0: 6f6d 3d31 292c 2028 302c 205b 5d2c 205b  om=1), (0, [], [
+0004eaf0: 5d29 290a 2020 2020 2020 2020 7365 6c66  ])).        self
+0004eb00: 2e70 4244 422e 6269 6273 2e69 6e73 6572  .pBDB.bibs.inser
+0004eb10: 7428 0a20 2020 2020 2020 2020 2020 2073  t(.            s
+0004eb20: 656c 662e 7042 4442 2e62 6962 732e 7072  elf.pBDB.bibs.pr
+0004eb30: 6570 6172 6549 6e73 6572 7428 0a20 2020  epareInsert(.   
+0004eb40: 2020 2020 2020 2020 2020 2020 2027 4061               '@a
+0004eb50: 7274 6963 6c65 7b47 6172 6961 7a7a 6f3a  rticle{Gariazzo:
+0004eb60: 3230 3135 7272 612c 5c6e 6172 7869 763d  2015rra,\narxiv=
+0004eb70: 2231 3530 372e 3038 3230 3422 5c6e 7d27  "1507.08204"\n}'
+0004eb80: 2c20 696e 7370 6972 653d 2231 3338 3535  , inspire="13855
+0004eb90: 3833 220a 2020 2020 2020 2020 2020 2020  83".            
+0004eba0: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+0004ebb0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0004ebc0: 6273 2e69 6e73 6572 7428 0a20 2020 2020  bs.insert(.     
+0004ebd0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0004ebe0: 2e62 6962 732e 7072 6570 6172 6549 6e73  .bibs.prepareIns
+0004ebf0: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
+0004ec00: 2020 2020 2027 4061 7274 6963 6c65 7b50       '@article{P
+0004ec10: 6c61 6e63 6b3a 3230 3133 7078 622c 5c6e  lanck:2013pxb,\n
+0004ec20: 6172 7869 763d 2231 3330 332e 3530 3736  arxiv="1303.5076
+0004ec30: 225c 6e7d 272c 2069 6e73 7069 7265 3d22  "\n}', inspire="
+0004ec40: 3132 3234 3734 3122 0a20 2020 2020 2020  1224741".       
+0004ec50: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+0004ec60: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0004ec70: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+0004ec80: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+0004ec90: 2e62 6962 732e 7365 6172 6368 4f41 4955  .bibs.searchOAIU
+0004eca0: 7064 6174 6573 2829 2c0a 2020 2020 2020  pdates(),.      
+0004ecb0: 2020 2020 2020 2832 2c20 5b5d 2c20 5b22        (2, [], ["
+0004ecc0: 4761 7269 617a 7a6f 3a32 3031 3572 7261  Gariazzo:2015rra
+0004ecd0: 222c 2022 506c 616e 636b 3a32 3031 3370  ", "Planck:2013p
+0004ece0: 7862 225d 292c 0a20 2020 2020 2020 2029  xb"]),.        )
+0004ecf0: 0a20 2020 2020 2020 2067 6120 3d20 7365  .        ga = se
+0004ed00: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+0004ed10: 416c 6c28 290a 2020 2020 2020 2020 7265  All().        re
+0004ed20: 7320 3d20 6761 5b30 5d0a 2020 2020 2020  s = ga[0].      
+0004ed30: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+0004ed40: 6528 7265 735b 2263 6974 6174 696f 6e73  e(res["citations
+0004ed50: 225d 203e 2037 3330 3029 0a20 2020 2020  "] > 7300).     
+0004ed60: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+0004ed70: 7565 2872 6573 5b22 6369 7461 7469 6f6e  ue(res["citation
+0004ed80: 735f 6e6f 5f73 656c 6622 5d20 3e20 3639  s_no_self"] > 69
+0004ed90: 3030 290a 2020 2020 2020 2020 6465 6c20  00).        del 
+0004eda0: 7265 735b 2263 6974 6174 696f 6e73 225d  res["citations"]
+0004edb0: 0a20 2020 2020 2020 2064 656c 2072 6573  .        del res
+0004edc0: 5b22 6369 7461 7469 6f6e 735f 6e6f 5f73  ["citations_no_s
+0004edd0: 656c 6622 5d0a 2020 2020 2020 2020 7365  elf"].        se
+0004ede0: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
+0004edf0: 6573 2c20 6675 6c6c 5265 636f 7264 4164  es, fullRecordAd
+0004ee00: 6529 0a20 2020 2020 2020 2072 6573 203d  e).        res =
+0004ee10: 2067 615b 315d 0a20 2020 2020 2020 2073   ga[1].        s
+0004ee20: 656c 662e 6173 7365 7274 5472 7565 2872  elf.assertTrue(r
+0004ee30: 6573 5b22 6369 7461 7469 6f6e 7322 5d20  es["citations"] 
+0004ee40: 3e20 3234 3029 0a20 2020 2020 2020 2073  > 240).        s
+0004ee50: 656c 662e 6173 7365 7274 5472 7565 2872  elf.assertTrue(r
+0004ee60: 6573 5b22 6369 7461 7469 6f6e 735f 6e6f  es["citations_no
+0004ee70: 5f73 656c 6622 5d20 3e20 3139 3029 0a20  _self"] > 190). 
+0004ee80: 2020 2020 2020 2064 656c 2072 6573 5b22         del res["
+0004ee90: 6369 7461 7469 6f6e 7322 5d0a 2020 2020  citations"].    
+0004eea0: 2020 2020 6465 6c20 7265 735b 2263 6974      del res["cit
+0004eeb0: 6174 696f 6e73 5f6e 6f5f 7365 6c66 225d  ations_no_self"]
+0004eec0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0004eed0: 7365 7274 4571 7561 6c28 7265 732c 2066  sertEqual(res, f
+0004eee0: 756c 6c52 6563 6f72 6447 6172 6961 7a7a  ullRecordGariazz
+0004eef0: 6f29 0a0a 2020 2020 6465 6620 7465 7374  o)..    def test
+0004ef00: 5f73 6561 7263 684f 4149 5570 6461 7465  _searchOAIUpdate
+0004ef10: 7328 7365 6c66 2c20 2a61 7267 7329 3a0a  s(self, *args):.
+0004ef20: 2020 2020 2020 2020 2222 2274 6573 7473          """tests
+0004ef30: 2066 6f72 2073 6561 7263 684f 4149 5570   for searchOAIUp
+0004ef40: 6461 7465 732c 2077 6974 6820 6d6f 636b  dates, with mock
+0004ef50: 2066 756e 6374 696f 6e73 2222 220a 2020   functions""".  
+0004ef60: 2020 2020 2020 6931 203d 2022 3133 3835        i1 = "1385
+0004ef70: 3538 3322 0a20 2020 2020 2020 2069 3220  583".        i2 
+0004ef80: 3d20 2231 3232 3437 3431 220a 2020 2020  = "1224741".    
+0004ef90: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0004efa0: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
+0004efb0: 6962 732e 7365 6172 6368 4f41 4955 7064  ibs.searchOAIUpd
+0004efc0: 6174 6573 2873 7461 7274 4672 6f6d 3d31  ates(startFrom=1
+0004efd0: 292c 2028 302c 205b 5d2c 205b 5d29 290a  ), (0, [], [])).
+0004efe0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0004eff0: 422e 6269 6273 2e69 6e73 6572 7428 0a20  B.bibs.insert(. 
+0004f000: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0004f010: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
+0004f020: 6549 6e73 6572 7428 0a20 2020 2020 2020  eInsert(.       
+0004f030: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+0004f040: 6c65 7b47 6172 6961 7a7a 6f3a 3230 3135  le{Gariazzo:2015
+0004f050: 7272 612c 5c6e 6172 7869 763d 2231 3530  rra,\narxiv="150
+0004f060: 372e 3038 3230 3422 5c6e 7d27 2c20 696e  7.08204"\n}', in
+0004f070: 7370 6972 653d 6931 0a20 2020 2020 2020  spire=i1.       
+0004f080: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+0004f090: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+0004f0a0: 4442 2e62 6962 732e 696e 7365 7274 280a  DB.bibs.insert(.
+0004f0b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0004f0c0: 2e70 4244 422e 6269 6273 2e70 7265 7061  .pBDB.bibs.prepa
+0004f0d0: 7265 496e 7365 7274 280a 2020 2020 2020  reInsert(.      
+0004f0e0: 2020 2020 2020 2020 2020 2740 6172 7469            '@arti
+0004f0f0: 636c 657b 4164 653a 3230 3133 7a75 762c  cle{Ade:2013zuv,
+0004f100: 5c6e 6172 7869 763d 2231 3330 332e 3530  \narxiv="1303.50
+0004f110: 3736 225c 6e7d 272c 2069 6e73 7069 7265  76"\n}', inspire
+0004f120: 3d69 320a 2020 2020 2020 2020 2020 2020  =i2.            
+0004f130: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+0004f140: 2020 2020 7062 6d20 3d20 4d61 6769 634d      pbm = MagicM
+0004f150: 6f63 6b28 290a 2020 2020 2020 2020 7062  ock().        pb
+0004f160: 7620 3d20 4d61 6769 634d 6f63 6b28 290a  v = MagicMock().
+0004f170: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0004f180: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0004f190: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+0004f1a0: 6261 7365 2e45 6e74 7269 6573 2e67 6574  base.Entries.get
+0004f1b0: 496e 7370 6972 6549 444c 6973 7422 2c0a  InspireIDList",.
+0004f1c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0004f1d0: 726e 5f76 616c 7565 3d28 5b5d 2c20 3029  rn_value=([], 0)
+0004f1e0: 2c0a 2020 2020 2020 2020 2920 6173 205f  ,.        ) as _
+0004f1f0: 6769 6c3a 0a20 2020 2020 2020 2020 2020  gil:.           
+0004f200: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0004f210: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+0004f220: 2e73 6561 7263 684f 4149 5570 6461 7465  .searchOAIUpdate
+0004f230: 7328 7374 6172 7446 726f 6d3d 3129 2c20  s(startFrom=1), 
+0004f240: 2830 2c20 5b5d 2c20 5b5d 2929 0a20 2020  (0, [], [])).   
+0004f250: 2020 2020 2020 2020 205f 6769 6c2e 6173           _gil.as
+0004f260: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+0004f270: 5f77 6974 6828 0a20 2020 2020 2020 2020  _with(.         
+0004f280: 2020 2020 2020 202a 7365 6c66 2e70 4244         *self.pBD
+0004f290: 422e 6269 6273 2e67 6574 456e 7472 6965  B.bibs.getEntrie
+0004f2a0: 7349 664e 6f6e 6528 7374 6172 7446 726f  sIfNone(startFro
+0004f2b0: 6d3d 3129 2c20 666f 7263 653d 4661 6c73  m=1), force=Fals
+0004f2c0: 652c 2070 6256 616c 3d4e 6f6e 650a 2020  e, pbVal=None.  
+0004f2d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0004f2e0: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
+0004f2f0: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+0004f300: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+0004f310: 2e45 6e74 7269 6573 2e67 6574 496e 7370  .Entries.getInsp
+0004f320: 6972 6549 444c 6973 7422 2c0a 2020 2020  ireIDList",.    
+0004f330: 2020 2020 2020 2020 7265 7475 726e 5f76          return_v
+0004f340: 616c 7565 3d28 5b5d 2c20 3029 2c0a 2020  alue=([], 0),.  
+0004f350: 2020 2020 2020 2920 6173 205f 6769 6c3a        ) as _gil:
+0004f360: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0004f370: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0004f380: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0004f390: 656c 662e 7042 4442 2e62 6962 732e 7365  elf.pBDB.bibs.se
+0004f3a0: 6172 6368 4f41 4955 7064 6174 6573 2865  archOAIUpdates(e
+0004f3b0: 6e74 7269 6573 3d5b 2261 222c 2022 6222  ntries=["a", "b"
+0004f3c0: 5d2c 2070 624d 6178 3d70 626d 292c 0a20  ], pbMax=pbm),. 
+0004f3d0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0004f3e0: 302c 205b 5d2c 205b 5d29 2c0a 2020 2020  0, [], []),.    
+0004f3f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0004f400: 2020 2020 2020 5f67 696c 2e61 7373 6572        _gil.asser
+0004f410: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+0004f420: 7468 285b 2261 222c 2022 6222 5d2c 2032  th(["a", "b"], 2
+0004f430: 2c20 666f 7263 653d 4661 6c73 652c 2070  , force=False, p
+0004f440: 6256 616c 3d4e 6f6e 6529 0a20 2020 2020  bVal=None).     
+0004f450: 2020 2020 2020 2070 626d 2e61 7373 6572         pbm.asser
+0004f460: 745f 616e 795f 6361 6c6c 2832 290a 2020  t_any_call(2).  
+0004f470: 2020 2020 2020 2020 2020 7062 6d2e 6173            pbm.as
+0004f480: 7365 7274 5f61 6e79 5f63 616c 6c28 3029  sert_any_call(0)
+0004f490: 0a20 2020 2020 2020 2065 6e74 7279 3120  .        entry1 
+0004f4a0: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
+0004f4b0: 2e67 6574 4279 4269 626b 6579 2822 4761  .getByBibkey("Ga
+0004f4c0: 7269 617a 7a6f 3a32 3031 3572 7261 2229  riazzo:2015rra")
+0004f4d0: 5b30 5d0a 2020 2020 2020 2020 656e 7472  [0].        entr
+0004f4e0: 7932 203d 2073 656c 662e 7042 4442 2e62  y2 = self.pBDB.b
+0004f4f0: 6962 732e 6765 7442 7942 6962 6b65 7928  ibs.getByBibkey(
+0004f500: 2241 6465 3a32 3031 337a 7576 2229 5b30  "Ade:2013zuv")[0
+0004f510: 5d0a 2020 2020 2020 2020 656e 7472 7931  ].        entry1
+0004f520: 6120 3d20 6469 6374 2865 6e74 7279 3129  a = dict(entry1)
+0004f530: 0a20 2020 2020 2020 2065 6e74 7279 3261  .        entry2a
+0004f540: 203d 2064 6963 7428 656e 7472 7932 290a   = dict(entry2).
+0004f550: 2020 2020 2020 2020 656e 7472 7931 615b          entry1a[
+0004f560: 2264 6f69 225d 203d 2022 312f 322f 332f  "doi"] = "1/2/3/
+0004f570: 3422 0a20 2020 2020 2020 2065 6e74 7279  4".        entry
+0004f580: 3261 5b22 646f 6922 5d20 3d20 2231 2f32  2a["doi"] = "1/2
+0004f590: 2f33 2f34 220a 2020 2020 2020 2020 656e  /3/4".        en
+0004f5a0: 7472 7931 615b 2262 6962 7465 7844 6963  try1a["bibtexDic
+0004f5b0: 7422 5d5b 226a 6f75 726e 616c 225d 203d  t"]["journal"] =
+0004f5c0: 2022 6a63 6170 220a 2020 2020 2020 2020   "jcap".        
+0004f5d0: 656e 7472 7932 615b 2262 6962 7465 7844  entry2a["bibtexD
+0004f5e0: 6963 7422 5d5b 226a 6f75 726e 616c 225d  ict"]["journal"]
+0004f5f0: 203d 2022 6a63 6170 220a 2020 2020 2020   = "jcap".      
+0004f600: 2020 7769 7468 2070 6174 6368 280a 2020    with patch(.  
+0004f610: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
+0004f620: 6962 6c69 6f2e 6461 7461 6261 7365 2e45  iblio.database.E
+0004f630: 6e74 7269 6573 2e67 6574 496e 7370 6972  ntries.getInspir
+0004f640: 6549 444c 6973 7422 2c0a 2020 2020 2020  eIDList",.      
+0004f650: 2020 2020 2020 7369 6465 5f65 6666 6563        side_effec
+0004f660: 743d 5b0a 2020 2020 2020 2020 2020 2020  t=[.            
+0004f670: 2020 2020 285b 5d2c 2030 292c 2020 2320      ([], 0),  # 
+0004f680: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+0004f690: 2020 285b 6931 2c20 6932 5d2c 2032 292c    ([i1, i2], 2),
+0004f6a0: 2020 2320 310a 2020 2020 2020 2020 2020    # 1.          
+0004f6b0: 2020 2020 2020 285b 6931 2c20 6932 5d2c        ([i1, i2],
+0004f6c0: 2032 292c 2020 2320 320a 2020 2020 2020   2),  # 2.      
+0004f6d0: 2020 2020 2020 2020 2020 285b 6931 2c20            ([i1, 
+0004f6e0: 6932 5d2c 2032 292c 2020 2320 330a 2020  i2], 2),  # 3.  
+0004f6f0: 2020 2020 2020 2020 2020 2020 2020 285b                ([
+0004f700: 6932 5d2c 2031 292c 2020 2320 340a 2020  i2], 1),  # 4.  
+0004f710: 2020 2020 2020 2020 2020 2020 2020 285b                ([
+0004f720: 6931 2c20 6932 5d2c 2032 292c 2020 2320  i1, i2], 2),  # 
+0004f730: 350a 2020 2020 2020 2020 2020 2020 5d2c  5.            ],
+0004f740: 0a20 2020 2020 2020 2029 2061 7320 5f67  .        ) as _g
+0004f750: 6c2c 2070 6174 6368 280a 2020 2020 2020  l, patch(.      
+0004f760: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
+0004f770: 6f2e 7765 6269 6d70 6f72 742e 696e 7370  o.webimport.insp
+0004f780: 6972 652e 5765 6253 6561 7263 682e 7265  ire.WebSearch.re
+0004f790: 7472 6965 7665 4261 7463 6851 7565 7279  trieveBatchQuery
+0004f7a0: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+0004f7b0: 6964 655f 6566 6665 6374 3d5b 0a20 2020  ide_effect=[.   
+0004f7c0: 2020 2020 2020 2020 2020 2020 2028 5b7b               ([{
+0004f7d0: 2269 6422 3a20 2265 227d 2c20 7b22 6964  "id": "e"}, {"id
+0004f7e0: 223a 2022 6422 7d5d 2c20 3229 2c20 2023  ": "d"}], 2),  #
+0004f7f0: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
+0004f800: 2020 2028 5b7b 2269 6422 3a20 2265 227d     ([{"id": "e"}
+0004f810: 5d2c 2031 292c 2020 2320 320a 2020 2020  ], 1),  # 2.    
+0004f820: 2020 2020 2020 2020 2020 2020 285b 5d2c              ([],
+0004f830: 2030 292c 2020 2320 330a 2020 2020 2020   0),  # 3.      
+0004f840: 2020 2020 2020 2020 2020 285b 7b22 6964            ([{"id
+0004f850: 223a 2022 6522 7d2c 207b 2269 6422 3a20  ": "e"}, {"id": 
+0004f860: 2264 227d 5d2c 2032 292c 2020 2320 340a  "d"}], 2),  # 4.
+0004f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f880: 285b 7b22 6964 223a 2022 6522 7d2c 207b  ([{"id": "e"}, {
+0004f890: 2269 6422 3a20 2264 227d 5d2c 2032 292c  "id": "d"}], 2),
+0004f8a0: 2020 2320 350a 2020 2020 2020 2020 2020    # 5.          
+0004f8b0: 2020 5d2c 0a20 2020 2020 2020 2029 2061    ],.        ) a
+0004f8c0: 7320 5f72 622c 2070 6174 6368 280a 2020  s _rb, patch(.  
+0004f8d0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
+0004f8e0: 6962 6c69 6f2e 7765 6269 6d70 6f72 742e  iblio.webimport.
+0004f8f0: 696e 7370 6972 652e 5765 6253 6561 7263  inspire.WebSearc
+0004f900: 682e 7072 6f63 6573 7352 6563 6f72 6422  h.processRecord"
+0004f910: 2c0a 2020 2020 2020 2020 2020 2020 7369  ,.            si
+0004f920: 6465 5f65 6666 6563 743d 5b0a 2020 2020  de_effect=[.    
+0004f930: 2020 2020 2020 2020 2020 2020 5b22 7072              ["pr
+0004f940: 3122 5d2c 0a20 2020 2020 2020 2020 2020  1"],.           
+0004f950: 2020 2020 205b 2270 7232 225d 2c0a 2020       ["pr2"],.  
+0004f960: 2020 2020 2020 2020 2020 2020 2020 5b22                ["
+0004f970: 7072 3322 5d2c 0a20 2020 2020 2020 2020  pr3"],.         
+0004f980: 2020 2020 2020 205b 2270 7234 225d 2c0a         ["pr4"],.
+0004f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f9a0: 5b22 7072 3522 5d2c 0a20 2020 2020 2020  ["pr5"],.       
+0004f9b0: 2020 2020 2020 2020 205b 2270 7236 225d           ["pr6"]
+0004f9c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0004f9d0: 2020 5b22 7072 3722 5d2c 0a20 2020 2020    ["pr7"],.     
+0004f9e0: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+0004f9f0: 2020 2920 6173 205f 7072 2c20 7061 7463    ) as _pr, patc
+0004fa00: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+0004fa10: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
+0004fa20: 6173 652e 456e 7472 6965 732e 7570 6461  ase.Entries.upda
+0004fa30: 7465 5265 636f 7264 222c 0a20 2020 2020  teRecord",.     
+0004fa40: 2020 2020 2020 2073 6964 655f 6566 6665         side_effe
+0004fa50: 6374 3d5b 5472 7565 2c20 5472 7565 2c20  ct=[True, True, 
+0004fa60: 5472 7565 2c20 5472 7565 2c20 5472 7565  True, True, True
+0004fa70: 2c20 5472 7565 2c20 4661 6c73 652c 2054  , True, False, T
+0004fa80: 7275 655d 2c0a 2020 2020 2020 2020 2920  rue],.        ) 
+0004fa90: 6173 205f 7572 2c20 7061 7463 6828 0a20  as _ur, patch(. 
+0004faa0: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+0004fab0: 6269 626c 696f 2e77 6562 696d 706f 7274  biblio.webimport
+0004fac0: 2e69 6e73 7069 7265 2e57 6562 5365 6172  .inspire.WebSear
+0004fad0: 6368 2e72 6574 7269 6576 6555 726c 4669  ch.retrieveUrlFi
+0004fae0: 7273 7422 2c0a 2020 2020 2020 2020 2020  rst",.          
+0004faf0: 2020 7265 7475 726e 5f76 616c 7565 3d22    return_value="
+0004fb00: 736f 6d65 6269 6274 6578 222c 0a20 2020  somebibtex",.   
+0004fb10: 2020 2020 2029 2061 7320 5f72 7566 2c20       ) as _ruf, 
+0004fb20: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
+0004fb30: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
+0004fb40: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
+0004fb50: 6765 7442 7949 6e73 7069 7265 4944 222c  getByInspireID",
+0004fb60: 0a20 2020 2020 2020 2020 2020 2073 6964  .            sid
+0004fb70: 655f 6566 6665 6374 3d5b 0a20 2020 2020  e_effect=[.     
+0004fb80: 2020 2020 2020 2020 2020 205b 656e 7472             [entr
+0004fb90: 7931 615d 2c0a 2020 2020 2020 2020 2020  y1a],.          
+0004fba0: 2020 2020 2020 5b65 6e74 7279 3261 5d2c        [entry2a],
+0004fbb0: 2020 2320 310a 2020 2020 2020 2020 2020    # 1.          
+0004fbc0: 2020 2020 2020 5b65 6e74 7279 3161 5d2c        [entry1a],
+0004fbd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004fbe0: 205b 656e 7472 7932 615d 2c20 2023 2033   [entry2a],  # 3
+0004fbf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004fc00: 205b 656e 7472 7931 615d 2c0a 2020 2020   [entry1a],.    
+0004fc10: 2020 2020 2020 2020 2020 2020 5b65 6e74              [ent
+0004fc20: 7279 3261 5d2c 2020 2320 342c 350a 2020  ry2a],  # 4,5.  
+0004fc30: 2020 2020 2020 2020 2020 2020 2020 5b65                [e
+0004fc40: 6e74 7279 3161 5d2c 2020 2320 360a 2020  ntry1a],  # 6.  
+0004fc50: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+0004fc60: 2020 2020 2029 2061 7320 5f67 693a 0a20       ) as _gi:. 
+0004fc70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0004fc80: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+0004fc90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0004fca0: 662e 7042 4442 2e62 6962 732e 7365 6172  f.pBDB.bibs.sear
+0004fcb0: 6368 4f41 4955 7064 6174 6573 2865 6e74  chOAIUpdates(ent
+0004fcc0: 7269 6573 3d5b 2261 225d 2c20 7062 5661  ries=["a"], pbVa
+0004fcd0: 6c3d 7062 7629 2c0a 2020 2020 2020 2020  l=pbv),.        
+0004fce0: 2020 2020 2020 2020 2830 2c20 5b5d 2c20          (0, [], 
+0004fcf0: 5b5d 292c 0a20 2020 2020 2020 2020 2020  []),.           
+0004fd00: 2029 2020 2320 300a 2020 2020 2020 2020   )  # 0.        
+0004fd10: 2020 2020 5f67 6c2e 6173 7365 7274 5f63      _gl.assert_c
+0004fd20: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+0004fd30: 5b22 6122 5d2c 2031 2c20 666f 7263 653d  ["a"], 1, force=
+0004fd40: 4661 6c73 652c 2070 6256 616c 3d70 6276  False, pbVal=pbv
+0004fd50: 290a 2020 2020 2020 2020 2020 2020 5f72  ).            _r
+0004fd60: 622e 6173 7365 7274 5f6e 6f74 5f63 616c  b.assert_not_cal
+0004fd70: 6c65 6428 290a 2020 2020 2020 2020 2020  led().          
+0004fd80: 2020 5f70 722e 6173 7365 7274 5f6e 6f74    _pr.assert_not
+0004fd90: 5f63 616c 6c65 6428 290a 2020 2020 2020  _called().      
+0004fda0: 2020 2020 2020 5f75 722e 6173 7365 7274        _ur.assert
+0004fdb0: 5f6e 6f74 5f63 616c 6c65 6428 290a 2020  _not_called().  
+0004fdc0: 2020 2020 2020 2020 2020 5f67 692e 6173            _gi.as
+0004fdd0: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+0004fde0: 290a 2020 2020 2020 2020 2020 2020 5f67  ).            _g
+0004fdf0: 6c2e 7265 7365 745f 6d6f 636b 2829 0a20  l.reset_mock(). 
+0004fe00: 2020 2020 2020 2020 2020 205f 7275 662e             _ruf.
+0004fe10: 6173 7365 7274 5f6e 6f74 5f63 616c 6c65  assert_not_calle
+0004fe20: 6428 290a 2020 2020 2020 2020 2020 2020  d().            
+0004fe30: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0004fe40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0004fe50: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+0004fe60: 2e73 6561 7263 684f 4149 5570 6461 7465  .searchOAIUpdate
+0004fe70: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0004fe80: 2020 2020 2020 2065 6e74 7269 6573 3d5b         entries=[
+0004fe90: 2261 225d 2c20 666f 7263 653d 5472 7565  "a"], force=True
+0004fea0: 2c20 7265 6c6f 6164 416c 6c3d 5472 7565  , reloadAll=True
+0004feb0: 2c20 7062 5661 6c3d 7062 760a 2020 2020  , pbVal=pbv.    
+0004fec0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+0004fed0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0004fee0: 322c 205b 5d2c 205b 2247 6172 6961 7a7a  2, [], ["Gariazz
+0004fef0: 6f3a 3230 3135 7272 6122 2c20 2241 6465  o:2015rra", "Ade
+0004ff00: 3a32 3031 337a 7576 225d 292c 0a20 2020  :2013zuv"]),.   
+0004ff10: 2020 2020 2020 2020 2029 2020 2320 310a           )  # 1.
+0004ff20: 2020 2020 2020 2020 2020 2020 5f67 6c2e              _gl.
+0004ff30: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
+0004ff40: 6365 5f77 6974 6828 5b22 6122 5d2c 2031  ce_with(["a"], 1
+0004ff50: 2c20 666f 7263 653d 5472 7565 2c20 7062  , force=True, pb
+0004ff60: 5661 6c3d 7062 7629 0a20 2020 2020 2020  Val=pbv).       
+0004ff70: 2020 2020 205f 7262 2e61 7373 6572 745f       _rb.assert_
+0004ff80: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+0004ff90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0004ffa0: 2020 5b69 312c 2069 325d 2c0a 2020 2020    [i1, i2],.    
+0004ffb0: 2020 2020 2020 2020 2020 2020 7365 6172              sear
+0004ffc0: 6368 466f 726d 6174 3d22 7265 6369 643a  chFormat="recid:
+0004ffd0: 2573 222c 0a20 2020 2020 2020 2020 2020  %s",.           
+0004ffe0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
+0004fff0: 7072 2e61 7373 6572 745f 616e 795f 6361  pr.assert_any_ca
+00050000: 6c6c 287b 2269 6422 3a20 2265 227d 2c20  ll({"id": "e"}, 
+00050010: 6269 6274 6578 3d65 6e74 7279 3161 5b22  bibtex=entry1a["
+00050020: 6269 6274 6578 225d 290a 2020 2020 2020  bibtex"]).      
+00050030: 2020 2020 2020 5f70 722e 6173 7365 7274        _pr.assert
+00050040: 5f61 6e79 5f63 616c 6c28 7b22 6964 223a  _any_call({"id":
+00050050: 2022 6422 7d2c 2062 6962 7465 783d 656e   "d"}, bibtex=en
+00050060: 7472 7932 615b 2262 6962 7465 7822 5d29  try2a["bibtex"])
+00050070: 0a20 2020 2020 2020 2020 2020 2065 3161  .            e1a
+00050080: 203d 2064 6963 7428 656e 7472 7931 6129   = dict(entry1a)
+00050090: 0a20 2020 2020 2020 2020 2020 2065 3161  .            e1a
+000500a0: 5b22 6269 6274 6578 225d 203d 2022 736f  ["bibtex"] = "so
+000500b0: 6d65 6269 6274 6578 220a 2020 2020 2020  mebibtex".      
+000500c0: 2020 2020 2020 6465 6c20 6531 615b 2262        del e1a["b
+000500d0: 6962 7465 7844 6963 7422 5d5b 226a 6f75  ibtexDict"]["jou
+000500e0: 726e 616c 225d 0a20 2020 2020 2020 2020  rnal"].         
+000500f0: 2020 2065 3261 203d 2064 6963 7428 656e     e2a = dict(en
+00050100: 7472 7932 6129 0a20 2020 2020 2020 2020  try2a).         
+00050110: 2020 2065 3261 5b22 6269 6274 6578 225d     e2a["bibtex"]
+00050120: 203d 2022 736f 6d65 6269 6274 6578 220a   = "somebibtex".
+00050130: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
+00050140: 6532 615b 2262 6962 7465 7844 6963 7422  e2a["bibtexDict"
+00050150: 5d5b 226a 6f75 726e 616c 225d 0a20 2020  ]["journal"].   
+00050160: 2020 2020 2020 2020 205f 7572 2e61 7373           _ur.ass
+00050170: 6572 745f 616e 795f 6361 6c6c 2865 3161  ert_any_call(e1a
+00050180: 2c20 5b22 7072 3122 5d2c 2054 7275 652c  , ["pr1"], True,
+00050190: 2054 7275 6529 0a20 2020 2020 2020 2020   True).         
+000501a0: 2020 205f 7572 2e61 7373 6572 745f 616e     _ur.assert_an
+000501b0: 795f 6361 6c6c 2865 6e74 7279 3261 2c20  y_call(entry2a, 
+000501c0: 5b22 7072 3222 5d2c 2054 7275 652c 2054  ["pr2"], True, T
+000501d0: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+000501e0: 205f 6769 2e61 7373 6572 745f 616e 795f   _gi.assert_any_
+000501f0: 6361 6c6c 2822 6522 290a 2020 2020 2020  call("e").      
+00050200: 2020 2020 2020 5f67 692e 6173 7365 7274        _gi.assert
+00050210: 5f61 6e79 5f63 616c 6c28 2264 2229 0a20  _any_call("d"). 
+00050220: 2020 2020 2020 2020 2020 2070 6276 2e61             pbv.a
+00050230: 7373 6572 745f 616e 795f 6361 6c6c 2831  ssert_any_call(1
+00050240: 290a 2020 2020 2020 2020 2020 2020 7062  ).            pb
+00050250: 762e 6173 7365 7274 5f61 6e79 5f63 616c  v.assert_any_cal
+00050260: 6c28 3229 0a20 2020 2020 2020 2020 2020  l(2).           
+00050270: 205f 7275 662e 7265 7365 745f 6d6f 636b   _ruf.reset_mock
+00050280: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00050290: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000502a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000502b0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+000502c0: 7365 6172 6368 4f41 4955 7064 6174 6573  searchOAIUpdates
+000502d0: 2865 6e74 7269 6573 3d5b 2261 225d 292c  (entries=["a"]),
+000502e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000502f0: 2028 312c 205b 5d2c 205b 2247 6172 6961   (1, [], ["Garia
+00050300: 7a7a 6f3a 3230 3135 7272 6122 5d29 2c0a  zzo:2015rra"]),.
+00050310: 2020 2020 2020 2020 2020 2020 2920 2023              )  #
+00050320: 2032 0a20 2020 2020 2020 2020 2020 2073   2.            s
+00050330: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00050340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00050350: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00050360: 7365 6172 6368 4f41 4955 7064 6174 6573  searchOAIUpdates
+00050370: 2865 6e74 7269 6573 3d5b 2261 225d 292c  (entries=["a"]),
+00050380: 2028 302c 205b 5d2c 205b 5d29 0a20 2020   (0, [], []).   
+00050390: 2020 2020 2020 2020 2029 2020 2320 330a           )  # 3.
+000503a0: 2020 2020 2020 2020 2020 2020 5f75 722e              _ur.
+000503b0: 6173 7365 7274 5f61 6e79 5f63 616c 6c28  assert_any_call(
+000503c0: 656e 7472 7931 612c 205b 2270 7233 225d  entry1a, ["pr3"]
+000503d0: 2c20 4661 6c73 652c 2046 616c 7365 290a  , False, False).
+000503e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000503f0: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00050400: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00050410: 6c66 2e70 4244 422e 6269 6273 2e73 6561  lf.pBDB.bibs.sea
+00050420: 7263 684f 4149 5570 6461 7465 7328 656e  rchOAIUpdates(en
+00050430: 7472 6965 733d 5b22 6122 5d2c 2073 7461  tries=["a"], sta
+00050440: 7274 4672 6f6d 3d31 292c 0a20 2020 2020  rtFrom=1),.     
+00050450: 2020 2020 2020 2020 2020 2028 322c 205b             (2, [
+00050460: 5d2c 205b 2241 6465 3a32 3031 337a 7576  ], ["Ade:2013zuv
+00050470: 222c 2022 4761 7269 617a 7a6f 3a32 3031  ", "Gariazzo:201
+00050480: 3572 7261 225d 292c 0a20 2020 2020 2020  5rra"]),.       
+00050490: 2020 2020 2029 2020 2320 340a 2020 2020       )  # 4.    
+000504a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000504b0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+000504c0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000504d0: 4244 422e 6269 6273 2e73 6561 7263 684f  BDB.bibs.searchO
+000504e0: 4149 5570 6461 7465 7328 656e 7472 6965  AIUpdates(entrie
+000504f0: 733d 5b65 6e74 7279 315d 292c 0a20 2020  s=[entry1]),.   
+00050500: 2020 2020 2020 2020 2020 2020 2028 322c               (2,
+00050510: 205b 2247 6172 6961 7a7a 6f3a 3230 3135   ["Gariazzo:2015
+00050520: 7272 6122 5d2c 205b 2241 6465 3a32 3031  rra"], ["Ade:201
+00050530: 337a 7576 225d 292c 0a20 2020 2020 2020  3zuv"]),.       
+00050540: 2020 2020 2029 2020 2320 350a 2020 2020       )  # 5.    
+00050550: 2020 2020 2020 2020 5f72 7566 2e61 7373          _ruf.ass
+00050560: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+00050570: 0a0a 2020 2020 6465 6620 7465 7374 5f73  ..    def test_s
+00050580: 6574 5374 7566 6628 7365 6c66 2c20 2a61  etStuff(self, *a
+00050590: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+000505a0: 2274 6573 7420 5b22 7365 7442 6f6f 6b22  "test ["setBook"
+000505b0: 2c20 2273 6574 4c65 6374 7572 6522 2c20  , "setLecture", 
+000505c0: 2273 6574 5068 6454 6865 7369 7322 2c0a  "setPhdThesis",.
+000505d0: 2020 2020 2020 2020 2273 6574 5072 6f63          "setProc
+000505e0: 6565 6469 6e67 222c 2022 7365 7452 6576  eeding", "setRev
+000505f0: 6965 7722 2c20 2273 6574 4e6f 5570 6461  iew", "setNoUpda
+00050600: 7465 225d 0a20 2020 2020 2020 2022 2222  te"].        """
+00050610: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
+00050620: 7365 7274 5f74 6872 6565 2829 0a20 2020  sert_three().   
+00050630: 2020 2020 2066 6f72 2070 726f 6365 6475       for procedu
+00050640: 7265 2c20 6669 656c 6420 696e 207a 6970  re, field in zip
+00050650: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
+00050660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050670: 2273 6574 426f 6f6b 222c 0a20 2020 2020  "setBook",.     
+00050680: 2020 2020 2020 2020 2020 2022 7365 744c             "setL
+00050690: 6563 7475 7265 222c 0a20 2020 2020 2020  ecture",.       
+000506a0: 2020 2020 2020 2020 2022 7365 7450 6864           "setPhd
+000506b0: 5468 6573 6973 222c 0a20 2020 2020 2020  Thesis",.       
+000506c0: 2020 2020 2020 2020 2022 7365 7450 726f           "setPro
+000506d0: 6365 6564 696e 6722 2c0a 2020 2020 2020  ceeding",.      
+000506e0: 2020 2020 2020 2020 2020 2273 6574 5265            "setRe
+000506f0: 7669 6577 222c 0a20 2020 2020 2020 2020  view",.         
+00050700: 2020 2020 2020 2022 7365 744e 6f55 7064         "setNoUpd
+00050710: 6174 6522 2c0a 2020 2020 2020 2020 2020  ate",.          
+00050720: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+00050730: 205b 2262 6f6f 6b22 2c20 226c 6563 7475   ["book", "lectu
+00050740: 7265 222c 2022 7068 645f 7468 6573 6973  re", "phd_thesis
+00050750: 222c 2022 7072 6f63 6565 6469 6e67 222c  ", "proceeding",
+00050760: 2022 7265 7669 6577 222c 2022 6e6f 5570   "review", "noUp
+00050770: 6461 7465 225d 2c0a 2020 2020 2020 2020  date"],.        
+00050780: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00050790: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000507a0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+000507b0: 6574 4669 656c 6428 2261 6263 222c 2066  etField("abc", f
+000507c0: 6965 6c64 292c 2030 290a 2020 2020 2020  ield), 0).      
+000507d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000507e0: 7454 7275 6528 6765 7461 7474 7228 7365  tTrue(getattr(se
+000507f0: 6c66 2e70 4244 422e 6269 6273 2c20 7072  lf.pBDB.bibs, pr
+00050800: 6f63 6564 7572 6529 2822 6162 6322 2929  ocedure)("abc"))
+00050810: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00050820: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00050830: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+00050840: 4669 656c 6428 2261 6263 222c 2066 6965  Field("abc", fie
+00050850: 6c64 292c 2031 290a 2020 2020 2020 2020  ld), 1).        
+00050860: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00050870: 7275 6528 6765 7461 7474 7228 7365 6c66  rue(getattr(self
+00050880: 2e70 4244 422e 6269 6273 2c20 7072 6f63  .pBDB.bibs, proc
+00050890: 6564 7572 6529 2822 6162 6322 2c20 3029  edure)("abc", 0)
+000508a0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+000508b0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+000508c0: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+000508d0: 7446 6965 6c64 2822 6162 6322 2c20 6669  tField("abc", fi
+000508e0: 656c 6429 2c20 3029 0a20 2020 2020 2020  eld), 0).       
+000508f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00050900: 5472 7565 2867 6574 6174 7472 2873 656c  True(getattr(sel
+00050910: 662e 7042 4442 2e62 6962 732c 2070 726f  f.pBDB.bibs, pro
+00050920: 6365 6475 7265 2928 2261 6263 3122 2929  cedure)("abc1"))
+00050930: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00050940: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00050950: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+00050960: 7446 6965 6c64 2822 6465 6622 2c20 6669  tField("def", fi
+00050970: 656c 6429 2c20 3029 0a20 2020 2020 2020  eld), 0).       
+00050980: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00050990: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+000509a0: 6269 6273 2e67 6574 4669 656c 6428 2267  bibs.getField("g
+000509b0: 6869 222c 2066 6965 6c64 292c 2030 290a  hi", field), 0).
+000509c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000509d0: 2e61 7373 6572 7445 7175 616c 2867 6574  .assertEqual(get
+000509e0: 6174 7472 2873 656c 662e 7042 4442 2e62  attr(self.pBDB.b
+000509f0: 6962 732c 2070 726f 6365 6475 7265 2928  ibs, procedure)(
+00050a00: 5b22 6465 6622 2c20 2267 6869 225d 292c  ["def", "ghi"]),
+00050a10: 204e 6f6e 6529 0a20 2020 2020 2020 2020   None).         
+00050a20: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00050a30: 7561 6c28 7365 6c66 2e70 4244 422e 6269  ual(self.pBDB.bi
+00050a40: 6273 2e67 6574 4669 656c 6428 2264 6566  bs.getField("def
+00050a50: 222c 2066 6965 6c64 292c 2031 290a 2020  ", field), 1).  
+00050a60: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00050a70: 7373 6572 7445 7175 616c 2873 656c 662e  ssertEqual(self.
+00050a80: 7042 4442 2e62 6962 732e 6765 7446 6965  pBDB.bibs.getFie
+00050a90: 6c64 2822 6768 6922 2c20 6669 656c 6429  ld("ghi", field)
+00050aa0: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
+00050ab0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00050ac0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+00050ad0: 2020 2067 6574 6174 7472 2873 656c 662e     getattr(self.
+00050ae0: 7042 4442 2e62 6962 732c 2070 726f 6365  pBDB.bibs, proce
+00050af0: 6475 7265 2928 5b22 6465 6622 2c20 2267  dure)(["def", "g
+00050b00: 6869 225d 2c20 3029 2c20 4e6f 6e65 0a20  hi"], 0), None. 
+00050b10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00050b20: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00050b30: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00050b40: 4244 422e 6269 6273 2e67 6574 4669 656c  BDB.bibs.getFiel
+00050b50: 6428 2264 6566 222c 2066 6965 6c64 292c  d("def", field),
+00050b60: 2030 290a 2020 2020 2020 2020 2020 2020   0).            
+00050b70: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00050b80: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00050b90: 6765 7446 6965 6c64 2822 6768 6922 2c20  getField("ghi", 
+00050ba0: 6669 656c 6429 2c20 3029 0a0a 2020 2020  field), 0)..    
+00050bb0: 6465 6620 7465 7374 5f75 7064 6174 6528  def test_update(
+00050bc0: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
+00050bd0: 2020 2020 2020 2222 2254 6573 7420 6765        """Test ge
+00050be0: 6e65 7261 6c20 7570 6461 7465 2c20 6669  neral update, fi
+00050bf0: 656c 6420 7570 6461 7465 2c20 6269 626b  eld update, bibk
+00050c00: 6579 2075 7064 6174 6522 2222 0a20 2020  ey update""".   
+00050c10: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00050c20: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
+00050c30: 6269 6273 2e67 6574 4669 656c 6428 2261  bibs.getField("a
+00050c40: 6263 222c 2022 6269 626b 6579 2229 290a  bc", "bibkey")).
+00050c50: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
+00050c60: 656c 662e 7042 4442 2e62 6962 732e 7072  elf.pBDB.bibs.pr
+00050c70: 6570 6172 6549 6e73 6572 7428 0a20 2020  epareInsert(.   
+00050c80: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+00050c90: 6c65 7b61 6263 2c5c 6e61 7574 686f 7220  le{abc,\nauthor 
+00050ca0: 3d20 226d 6522 2c5c 6e74 6974 6c65 203d  = "me",\ntitle =
+00050cb0: 2022 6162 6322 2c7d 272c 2061 7278 6976   "abc",}', arxiv
+00050cc0: 3d22 6162 6322 0a20 2020 2020 2020 2029  ="abc".        )
+00050cd0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00050ce0: 7365 7274 5472 7565 2873 656c 662e 7042  sertTrue(self.pB
+00050cf0: 4442 2e62 6962 732e 696e 7365 7274 2864  DB.bibs.insert(d
+00050d00: 6174 6129 290a 2020 2020 2020 2020 7365  ata)).        se
+00050d10: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00050d20: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+00050d30: 7446 6965 6c64 2822 6162 6322 2c20 2262  tField("abc", "b
+00050d40: 6962 6b65 7922 292c 2022 6162 6322 290a  ibkey"), "abc").
+00050d50: 2020 2020 2020 2020 6461 7461 6e65 7720          datanew 
+00050d60: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
+00050d70: 2e70 7265 7061 7265 496e 7365 7274 280a  .prepareInsert(.
+00050d80: 2020 2020 2020 2020 2020 2020 2740 6172              '@ar
+00050d90: 7469 636c 657b 6364 652c 5c6e 6175 7468  ticle{cde,\nauth
+00050da0: 6f72 203d 2022 6d65 222c 5c6e 7469 746c  or = "me",\ntitl
+00050db0: 6520 3d20 2261 6263 222c 7d27 2c20 6172  e = "abc",}', ar
+00050dc0: 7869 763d 2263 6465 220a 2020 2020 2020  xiv="cde".      
+00050dd0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00050de0: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+00050df0: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+00050e00: 6528 6461 7461 6e65 772c 2022 6162 6322  e(datanew, "abc"
+00050e10: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+00050e20: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+00050e30: 2e70 4244 422e 6269 6273 2e67 6574 4669  .pBDB.bibs.getFi
+00050e40: 656c 6428 2261 6263 222c 2022 6269 626b  eld("abc", "bibk
+00050e50: 6579 2229 2c20 2261 6263 2229 0a20 2020  ey"), "abc").   
+00050e60: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00050e70: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
+00050e80: 6269 6273 2e67 6574 4669 656c 6428 2261  bibs.getField("a
+00050e90: 6263 222c 2022 6172 7869 7622 292c 2022  bc", "arxiv"), "
+00050ea0: 6364 6522 290a 2020 2020 2020 2020 6465  cde").        de
+00050eb0: 6c20 6461 7461 5b22 6172 7869 7622 5d0a  l data["arxiv"].
+00050ec0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00050ed0: 6572 7454 7275 6528 7365 6c66 2e70 4244  ertTrue(self.pBD
+00050ee0: 422e 6269 6273 2e75 7064 6174 6528 6461  B.bibs.update(da
+00050ef0: 7461 2c20 2261 6263 2229 290a 2020 2020  ta, "abc")).    
+00050f00: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00050f10: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
+00050f20: 6962 732e 6765 7446 6965 6c64 2822 6162  ibs.getField("ab
+00050f30: 6322 2c20 2262 6962 6b65 7922 292c 2022  c", "bibkey"), "
+00050f40: 6162 6322 290a 2020 2020 2020 2020 7365  abc").        se
+00050f50: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00050f60: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
+00050f70: 7446 6965 6c64 2822 6162 6322 2c20 2261  tField("abc", "a
+00050f80: 7278 6976 2229 2c20 4e6f 6e65 290a 2020  rxiv"), None).  
+00050f90: 2020 2020 2020 6531 203d 2073 656c 662e        e1 = self.
+00050fa0: 7042 4442 2e62 6962 732e 6765 7442 7942  pBDB.bibs.getByB
+00050fb0: 6962 6b65 7928 2261 6263 2229 0a20 2020  ibkey("abc").   
+00050fc0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00050fd0: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
+00050fe0: 6269 6273 2e75 7064 6174 6528 7b22 6269  bibs.update({"bi
+00050ff0: 626b 6579 223a 2022 6364 6522 7d2c 2022  bkey": "cde"}, "
+00051000: 6162 6322 2929 0a20 2020 2020 2020 2077  abc")).        w
+00051010: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
+00051020: 6e67 2e4c 6f67 6765 722e 6578 6365 7074  ng.Logger.except
+00051030: 696f 6e22 2920 6173 205f 653a 0a20 2020  ion") as _e:.   
+00051040: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00051050: 4442 2e62 6962 732e 7570 6461 7465 287b  DB.bibs.update({
+00051060: 2262 6962 6b65 7922 3a20 2263 6465 227d  "bibkey": "cde"}
+00051070: 2c20 2261 6263 2229 0a20 2020 2020 2020  , "abc").       
+00051080: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00051090: 496e 280a 2020 2020 2020 2020 2020 2020  In(.            
+000510a0: 2020 2020 224e 4f54 204e 554c 4c20 636f      "NOT NULL co
+000510b0: 6e73 7472 6169 6e74 2066 6169 6c65 643a  nstraint failed:
+000510c0: 2065 6e74 7269 6573 2e62 6962 7465 7822   entries.bibtex"
+000510d0: 2c20 5f65 2e63 616c 6c5f 6172 6773 5b30  , _e.call_args[0
+000510e0: 5d5b 305d 0a20 2020 2020 2020 2020 2020  ][0].           
+000510f0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+00051100: 6173 7365 7274 4661 6c73 6528 0a20 2020  assertFalse(.   
+00051110: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+00051120: 4442 2e62 6962 732e 7570 6461 7465 280a  DB.bibs.update(.
+00051130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051140: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00051150: 2020 2020 2020 2262 6962 6b65 7922 3a20        "bibkey": 
+00051160: 2263 6465 222c 0a20 2020 2020 2020 2020  "cde",.         
+00051170: 2020 2020 2020 2020 2020 2022 6269 6274             "bibt
+00051180: 6578 223a 2027 4061 7274 6963 6c65 7b61  ex": '@article{a
+00051190: 6263 2c5c 6e61 7574 686f 7220 3d20 226d  bc,\nauthor = "m
+000511a0: 6522 2c5c 6e74 6974 6c65 203d 2022 6162  e",\ntitle = "ab
+000511b0: 6322 2c7d 272c 0a20 2020 2020 2020 2020  c",}',.         
+000511c0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+000511d0: 2020 2020 2020 2020 2020 2261 6263 222c            "abc",
+000511e0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000511f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00051200: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00051210: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+00051220: 2e67 6574 4279 4269 626b 6579 2822 6162  .getByBibkey("ab
+00051230: 6322 292c 2065 3129 0a0a 2020 2020 2020  c"), e1)..      
+00051240: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+00051250: 6528 7365 6c66 2e70 4244 422e 6269 6245  e(self.pBDB.bibE
+00051260: 7870 2e69 6e73 6572 7428 2261 6263 222c  xp.insert("abc",
+00051270: 2031 2929 0a20 2020 2020 2020 2073 656c   1)).        sel
+00051280: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
+00051290: 662e 7042 4442 2e63 6174 4269 622e 696e  f.pBDB.catBib.in
+000512a0: 7365 7274 2831 2c20 2261 6263 2229 290a  sert(1, "abc")).
+000512b0: 2020 2020 2020 2020 6462 5374 6174 7328          dbStats(
+000512c0: 7365 6c66 2e70 4244 4229 0a20 2020 2020  self.pBDB).     
+000512d0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+000512e0: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+000512f0: 2073 656c 662e 7042 4442 2e73 7461 7473   self.pBDB.stats
+00051300: 2c0a 2020 2020 2020 2020 2020 2020 7b22  ,.            {"
+00051310: 6269 6273 223a 2031 2c20 2263 6174 7322  bibs": 1, "cats"
+00051320: 3a20 322c 2022 6578 7073 223a 2030 2c20  : 2, "exps": 0, 
+00051330: 2263 6174 4269 6222 3a20 312c 2022 6361  "catBib": 1, "ca
+00051340: 7445 7870 223a 2030 2c20 2262 6962 4578  tExp": 0, "bibEx
+00051350: 7022 3a20 317d 2c0a 2020 2020 2020 2020  p": 1},.        
+00051360: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+00051370: 6174 6368 2822 7068 7973 6269 626c 696f  atch("physbiblio
+00051380: 2e70 6466 2e4c 6f63 616c 5044 462e 7265  .pdf.LocalPDF.re
+00051390: 6e61 6d65 466f 6c64 6572 222c 2061 7574  nameFolder", aut
+000513a0: 6f73 7065 633d 5472 7565 2920 6173 205f  ospec=True) as _
+000513b0: 6d6f 636b 5f72 656e 3a0a 2020 2020 2020  mock_ren:.      
+000513c0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000513d0: 7454 7275 6528 7365 6c66 2e70 4244 422e  tTrue(self.pBDB.
+000513e0: 6269 6273 2e75 7064 6174 6542 6962 6b65  bibs.updateBibke
+000513f0: 7928 2261 6263 222c 2022 6465 6622 2929  y("abc", "def"))
+00051400: 0a20 2020 2020 2020 2020 2020 205f 6d6f  .            _mo
+00051410: 636b 5f72 656e 2e61 7373 6572 745f 6361  ck_ren.assert_ca
+00051420: 6c6c 6564 5f6f 6e63 655f 7769 7468 2870  lled_once_with(p
+00051430: 4250 4446 2c20 2261 6263 222c 2022 6465  BPDF, "abc", "de
+00051440: 6622 290a 2020 2020 2020 2020 7365 6c66  f").        self
+00051450: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00051460: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00051470: 4244 422e 6269 6273 2e67 6574 4279 4269  BDB.bibs.getByBi
+00051480: 626b 6579 2822 6465 6622 295b 305d 5b22  bkey("def")[0]["
+00051490: 6269 6274 6578 225d 2c0a 2020 2020 2020  bibtex"],.      
+000514a0: 2020 2020 2020 2740 4172 7469 636c 657b        '@Article{
+000514b0: 6162 632c 5c6e 2020 2020 2020 2020 6175  abc,\n        au
+000514c0: 7468 6f72 203d 2022 6d65 222c 5c6e 2020  thor = "me",\n  
+000514d0: 2020 2020 2020 2027 202b 2027 7469 746c         ' + 'titl
+000514e0: 6520 3d20 227b 6162 637d 222c 5c6e 7d27  e = "{abc}",\n}'
+000514f0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00051500: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00051510: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
+00051520: 6962 732e 6765 7442 7942 6962 6b65 7928  ibs.getByBibkey(
+00051530: 2264 6566 2229 5b30 5d5b 226f 6c64 5f6b  "def")[0]["old_k
+00051540: 6579 7322 5d2c 2022 6162 6322 290a 2020  eys"], "abc").  
+00051550: 2020 2020 2020 6462 5374 6174 7328 7365        dbStats(se
+00051560: 6c66 2e70 4244 4229 0a20 2020 2020 2020  lf.pBDB).       
+00051570: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00051580: 6c28 0a20 2020 2020 2020 2020 2020 2073  l(.            s
+00051590: 656c 662e 7042 4442 2e73 7461 7473 2c0a  elf.pBDB.stats,.
+000515a0: 2020 2020 2020 2020 2020 2020 7b22 6269              {"bi
+000515b0: 6273 223a 2031 2c20 2263 6174 7322 3a20  bs": 1, "cats": 
+000515c0: 322c 2022 6578 7073 223a 2030 2c20 2263  2, "exps": 0, "c
+000515d0: 6174 4269 6222 3a20 312c 2022 6361 7445  atBib": 1, "catE
+000515e0: 7870 223a 2030 2c20 2262 6962 4578 7022  xp": 0, "bibExp"
+000515f0: 3a20 317d 2c0a 2020 2020 2020 2020 290a  : 1},.        ).
+00051600: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00051610: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00051620: 4244 422e 6269 6273 2e67 6574 4279 4269  BDB.bibs.getByBi
+00051630: 626b 6579 2822 6465 6622 295b 305d 5b22  bkey("def")[0]["
+00051640: 696e 7370 6972 6522 5d2c 204e 6f6e 6529  inspire"], None)
+00051650: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00051660: 7365 7274 5472 7565 2873 656c 662e 7042  sertTrue(self.pB
+00051670: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
+00051680: 656c 6428 2264 6566 222c 2022 696e 7370  eld("def", "insp
+00051690: 6972 6522 2c20 2231 3233 3422 2c20 7665  ire", "1234", ve
+000516a0: 7262 6f73 653d 3029 290a 2020 2020 2020  rbose=0)).      
+000516b0: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
+000516c0: 6767 696e 672e 4c6f 6767 6572 2e69 6e66  gging.Logger.inf
+000516d0: 6f22 2920 6173 205f 693a 0a20 2020 2020  o") as _i:.     
+000516e0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+000516f0: 2e62 6962 732e 7570 6461 7465 4669 656c  .bibs.updateFiel
+00051700: 6428 2264 6566 222c 2022 696e 7370 6972  d("def", "inspir
+00051710: 6522 2c20 2231 3233 3422 290a 2020 2020  e", "1234").    
+00051720: 2020 2020 2020 2020 5f69 2e61 7373 6572          _i.asser
+00051730: 745f 616e 795f 6361 6c6c 2822 5570 6461  t_any_call("Upda
+00051740: 7469 6e67 2027 696e 7370 6972 6527 2066  ting 'inspire' f
+00051750: 6f72 2065 6e74 7279 2027 6465 6627 2229  or entry 'def'")
+00051760: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00051770: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00051780: 4244 422e 6269 6273 2e67 6574 4279 4269  BDB.bibs.getByBi
+00051790: 626b 6579 2822 6465 6622 295b 305d 5b22  bkey("def")[0]["
+000517a0: 696e 7370 6972 6522 5d2c 2022 3132 3334  inspire"], "1234
+000517b0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+000517c0: 6173 7365 7274 4661 6c73 6528 0a20 2020  assertFalse(.   
+000517d0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+000517e0: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
+000517f0: 656c 6428 2264 6566 222c 2022 696e 7370  eld("def", "insp
+00051800: 6972 6573 222c 2022 3132 3334 222c 2076  ires", "1234", v
+00051810: 6572 626f 7365 3d30 290a 2020 2020 2020  erbose=0).      
+00051820: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00051830: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
+00051840: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
+00051850: 7465 4669 656c 6428 2264 6566 222c 2022  teField("def", "
+00051860: 696e 7370 6972 6522 2c20 4e6f 6e65 2c20  inspire", None, 
+00051870: 7665 7262 6f73 653d 3029 290a 2020 2020  verbose=0)).    
+00051880: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+00051890: 6c6f 6767 696e 672e 4c6f 6767 6572 2e69  logging.Logger.i
+000518a0: 6e66 6f22 2920 6173 205f 693a 0a20 2020  nfo") as _i:.   
+000518b0: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
+000518c0: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
+000518d0: 656c 6428 2264 6566 222c 2022 696e 7370  eld("def", "insp
+000518e0: 6972 6573 222c 2022 3132 3334 2229 0a20  ires", "1234"). 
+000518f0: 2020 2020 2020 2020 2020 205f 692e 6173             _i.as
+00051900: 7365 7274 5f61 6e79 5f63 616c 6c28 2255  sert_any_call("U
+00051910: 7064 6174 696e 6720 2769 6e73 7069 7265  pdating 'inspire
+00051920: 7327 2066 6f72 2065 6e74 7279 2027 6465  s' for entry 'de
+00051930: 6627 2229 0a20 2020 2020 2020 2077 6974  f'").        wit
+00051940: 6820 7061 7463 6828 226c 6f67 6769 6e67  h patch("logging
+00051950: 2e4c 6f67 6765 722e 7761 726e 696e 6722  .Logger.warning"
+00051960: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
+00051970: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00051980: 6962 732e 7570 6461 7465 4669 656c 6428  ibs.updateField(
+00051990: 2264 6566 222c 2022 696e 7370 6972 6573  "def", "inspires
+000519a0: 222c 2022 3132 3334 222c 2076 6572 626f  ", "1234", verbo
+000519b0: 7365 3d32 290a 2020 2020 2020 2020 2020  se=2).          
+000519c0: 2020 5f69 2e61 7373 6572 745f 616e 795f    _i.assert_any_
+000519d0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+000519e0: 2020 2020 2020 224e 6f6e 2d65 7869 7374        "Non-exist
+000519f0: 696e 6720 6669 656c 6420 2220 2b20 226f  ing field " + "o
+00051a00: 7220 756e 6170 7072 6f70 7269 6174 6564  r unappropriated
+00051a10: 2076 616c 7565 3a20 2864 6566 2c20 696e   value: (def, in
+00051a20: 7370 6972 6573 2c20 3132 3334 2922 0a20  spires, 1234)". 
+00051a30: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00051a40: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
+00051a50: 2822 7068 7973 6269 626c 696f 2e70 6466  ("physbiblio.pdf
+00051a60: 2e4c 6f63 616c 5044 462e 7265 6e61 6d65  .LocalPDF.rename
+00051a70: 466f 6c64 6572 222c 2061 7574 6f73 7065  Folder", autospe
+00051a80: 633d 5472 7565 2920 6173 205f 6d6f 636b  c=True) as _mock
+00051a90: 5f72 656e 3a0a 2020 2020 2020 2020 2020  _ren:.          
+00051aa0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+00051ab0: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
+00051ac0: 2e75 7064 6174 6542 6962 6b65 7928 2264  .updateBibkey("d
+00051ad0: 6566 222c 2022 6162 6322 2929 0a20 2020  ef", "abc")).   
+00051ae0: 2020 2020 2020 2020 205f 6d6f 636b 5f72           _mock_r
+00051af0: 656e 2e61 7373 6572 745f 6361 6c6c 6564  en.assert_called
+00051b00: 5f6f 6e63 655f 7769 7468 2870 4250 4446  _once_with(pBPDF
+00051b10: 2c20 2264 6566 222c 2022 6162 6322 290a  , "def", "abc").
+00051b20: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00051b30: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00051b40: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00051b50: 6269 6273 2e67 6574 4279 4269 626b 6579  bibs.getByBibkey
+00051b60: 2822 6162 6322 295b 305d 5b22 6269 6274  ("abc")[0]["bibt
+00051b70: 6578 225d 2c0a 2020 2020 2020 2020 2020  ex"],.          
+00051b80: 2020 2740 4172 7469 636c 657b 6162 632c    '@Article{abc,
+00051b90: 5c6e 2020 2020 2020 2020 6175 7468 6f72  \n        author
+00051ba0: 203d 2022 6d65 222c 5c6e 2020 2020 2020   = "me",\n      
+00051bb0: 2020 2027 202b 2027 7469 746c 6520 3d20     ' + 'title = 
+00051bc0: 227b 6162 637d 222c 5c6e 7d27 2c0a 2020  "{abc}",\n}',.  
+00051bd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00051be0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00051bf0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00051c00: 6765 7442 7942 6962 6b65 7928 2261 6263  getByBibkey("abc
+00051c10: 2229 5b30 5d5b 226f 6c64 5f6b 6579 7322  ")[0]["old_keys"
+00051c20: 5d2c 2022 6162 632c 6465 6622 290a 0a20  ], "abc,def").. 
+00051c30: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+00051c40: 6828 2270 6879 7362 6962 6c69 6f2e 7064  h("physbiblio.pd
+00051c50: 662e 4c6f 6361 6c50 4446 2e72 656e 616d  f.LocalPDF.renam
+00051c60: 6546 6f6c 6465 7222 2c20 6175 746f 7370  eFolder", autosp
+00051c70: 6563 3d54 7275 6529 2061 7320 5f6d 6f63  ec=True) as _moc
+00051c80: 6b5f 7265 6e3a 0a20 2020 2020 2020 2020  k_ren:.         
+00051c90: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+00051ca0: 7565 2873 656c 662e 7042 4442 2e62 6962  ue(self.pBDB.bib
+00051cb0: 732e 7570 6461 7465 4269 626b 6579 2822  s.updateBibkey("
+00051cc0: 6162 6322 2c20 2264 6566 2229 290a 2020  abc", "def")).  
+00051cd0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00051ce0: 7454 7275 6528 7365 6c66 2e70 4244 422e  tTrue(self.pBDB.
+00051cf0: 6269 6273 2e75 7064 6174 6546 6965 6c64  bibs.updateField
+00051d00: 2822 6465 6622 2c20 2262 6962 6469 6374  ("def", "bibdict
+00051d10: 222c 2022 7b7d 222c 2076 6572 626f 7365  ", "{}", verbose
+00051d20: 3d30 2929 0a20 2020 2020 2020 2073 656c  =0)).        sel
+00051d30: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00051d40: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+00051d50: 4669 656c 6428 2264 6566 222c 2022 6269  Field("def", "bi
+00051d60: 6264 6963 7422 292c 207b 7d29 0a20 2020  bdict"), {}).   
+00051d70: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00051d80: 5472 7565 280a 2020 2020 2020 2020 2020  True(.          
+00051d90: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00051da0: 2e75 7064 6174 6546 6965 6c64 280a 2020  .updateField(.  
+00051db0: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00051dc0: 6566 222c 0a20 2020 2020 2020 2020 2020  ef",.           
+00051dd0: 2020 2020 2022 6269 6274 6578 222c 0a20       "bibtex",. 
+00051de0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00051df0: 4041 7274 6963 6c65 7b61 6263 2c5c 6e61  @Article{abc,\na
+00051e00: 7574 686f 7220 3d20 226d 6522 2c5c 6e74  uthor = "me",\nt
+00051e10: 6974 6c65 203d 2022 7b61 6263 7d22 2c5c  itle = "{abc}",\
+00051e20: 6e7d 272c 0a20 2020 2020 2020 2020 2020  n}',.           
+00051e30: 2020 2020 2076 6572 626f 7365 3d30 2c0a       verbose=0,.
+00051e40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00051e50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00051e60: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00051e70: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00051e80: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+00051e90: 4669 656c 6428 2264 6566 222c 2022 6269  Field("def", "bi
+00051ea0: 6264 6963 7422 292c 0a20 2020 2020 2020  bdict"),.       
+00051eb0: 2020 2020 207b 2245 4e54 5259 5459 5045       {"ENTRYTYPE
+00051ec0: 223a 2022 6172 7469 636c 6522 2c20 2249  ": "article", "I
+00051ed0: 4422 3a20 2261 6263 222c 2022 6175 7468  D": "abc", "auth
+00051ee0: 6f72 223a 2022 6d65 222c 2022 7469 746c  or": "me", "titl
+00051ef0: 6522 3a20 227b 6162 637d 227d 2c0a 2020  e": "{abc}"},.  
+00051f00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00051f10: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+00051f20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00051f30: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
+00051f40: 7465 4669 656c 6428 0a20 2020 2020 2020  teField(.       
+00051f50: 2020 2020 2020 2020 2022 6465 6622 2c20           "def", 
+00051f60: 2262 6962 7465 7822 2c20 2740 4172 7469  "bibtex", '@Arti
+00051f70: 636c 657b 6162 632c 5c6e 6175 7468 6f72  cle{abc,\nauthor
+00051f80: 203d 2022 6d65 222c 5c6e 7469 746c 6520   = "me",\ntitle 
+00051f90: 3d20 272c 2076 6572 626f 7365 3d30 0a20  = ', verbose=0. 
+00051fa0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00051fb0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00051fc0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00051fd0: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+00051fe0: 6574 4669 656c 6428 2264 6566 222c 2022  etField("def", "
+00051ff0: 6269 6264 6963 7422 292c 207b 7d29 0a0a  bibdict"), {})..
+00052000: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00052010: 422e 6269 6273 2e64 656c 6574 6528 2264  B.bibs.delete("d
+00052020: 6566 2229 0a20 2020 2020 2020 2073 656c  ef").        sel
+00052030: 662e 696e 7365 7274 5f74 6872 6565 2829  f.insert_three()
+00052040: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
+00052050: 7463 6828 2270 6879 7362 6962 6c69 6f2e  tch("physbiblio.
+00052060: 7064 662e 4c6f 6361 6c50 4446 2e72 656e  pdf.LocalPDF.ren
+00052070: 616d 6546 6f6c 6465 7222 2c20 6175 746f  ameFolder", auto
+00052080: 7370 6563 3d54 7275 6529 2061 7320 5f6d  spec=True) as _m
+00052090: 6f63 6b5f 7265 6e3a 0a20 2020 2020 2020  ock_ren:.       
+000520a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000520b0: 4661 6c73 6528 7365 6c66 2e70 4244 422e  False(self.pBDB.
+000520c0: 6269 6273 2e75 7064 6174 6542 6962 6b65  bibs.updateBibke
+000520d0: 7928 2264 6566 222c 2022 6162 6322 2929  y("def", "abc"))
+000520e0: 0a0a 2020 2020 4075 6e69 7474 6573 742e  ..    @unittest.
+000520f0: 736b 6970 4966 2873 6b69 7054 6573 7473  skipIf(skipTests
+00052100: 5365 7474 696e 6773 2e6f 6e6c 696e 652c  Settings.online,
+00052110: 2022 4f6e 6c69 6e65 2074 6573 7473 2229   "Online tests")
+00052120: 0a20 2020 2064 6566 2074 6573 745f 7570  .    def test_up
+00052130: 6461 7465 4672 6f6d 4f41 495f 6f6e 6c69  dateFromOAI_onli
+00052140: 6e65 2873 656c 662c 202a 6172 6773 293a  ne(self, *args):
+00052150: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
+00052160: 2075 7064 6174 6546 726f 6d4f 4149 2077   updateFromOAI w
+00052170: 6974 6820 6f6e 6c69 6e65 2063 6f6e 6e65  ith online conne
+00052180: 6374 696f 6e22 2222 0a20 2020 2020 2020  ction""".       
+00052190: 2065 7870 6563 7465 6420 3d20 6675 6c6c   expected = full
+000521a0: 5265 636f 7264 4761 7269 617a 7a6f 0a20  RecordGariazzo. 
+000521b0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+000521c0: 2e62 6962 732e 696e 7365 7274 4672 6f6d  .bibs.insertFrom
+000521d0: 4269 6274 6578 280a 2020 2020 2020 2020  Bibtex(.        
+000521e0: 2020 2020 2740 6172 7469 636c 657b 4761      '@article{Ga
+000521f0: 7269 617a 7a6f 3a32 3031 3572 7261 2c5c  riazzo:2015rra,\
+00052200: 6e61 7278 6976 3d22 3135 3037 2e30 3832  narxiv="1507.082
+00052210: 3034 225c 6e7d 270a 2020 2020 2020 2020  04"\n}'.        
+00052220: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00052230: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
+00052240: 4244 422e 6269 6273 2e75 7064 6174 6546  BDB.bibs.updateF
+00052250: 726f 6d4f 4149 2822 4761 7269 617a 7a6f  romOAI("Gariazzo
+00052260: 3a32 3031 3572 7261 2229 290a 2020 2020  :2015rra")).    
+00052270: 2020 2020 7265 7320 3d20 7365 6c66 2e70      res = self.p
+00052280: 4244 422e 6269 6273 2e67 6574 4279 4269  BDB.bibs.getByBi
+00052290: 626b 6579 2822 4761 7269 617a 7a6f 3a32  bkey("Gariazzo:2
+000522a0: 3031 3572 7261 2229 5b30 5d0a 2020 2020  015rra")[0].    
+000522b0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+000522c0: 7275 6528 7265 735b 2263 6974 6174 696f  rue(res["citatio
+000522d0: 6e73 225d 203e 2032 3430 290a 2020 2020  ns"] > 240).    
+000522e0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+000522f0: 7275 6528 7265 735b 2263 6974 6174 696f  rue(res["citatio
+00052300: 6e73 5f6e 6f5f 7365 6c66 225d 203e 2031  ns_no_self"] > 1
+00052310: 3930 290a 2020 2020 2020 2020 6465 6c20  90).        del 
+00052320: 7265 735b 2263 6974 6174 696f 6e73 225d  res["citations"]
+00052330: 0a20 2020 2020 2020 2064 656c 2072 6573  .        del res
+00052340: 5b22 6369 7461 7469 6f6e 735f 6e6f 5f73  ["citations_no_s
+00052350: 656c 6622 5d0a 2020 2020 2020 2020 7365  elf"].        se
+00052360: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
+00052370: 6573 2c20 6578 7065 6374 6564 290a 2020  es, expected).  
+00052380: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00052390: 756e 646f 2876 6572 626f 7365 3d30 290a  undo(verbose=0).
+000523a0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+000523b0: 422e 6269 6273 2e69 6e73 6572 7428 0a20  B.bibs.insert(. 
+000523c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000523d0: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
+000523e0: 6549 6e73 6572 7428 0a20 2020 2020 2020  eInsert(.       
+000523f0: 2020 2020 2020 2020 2027 4061 7274 6963           '@artic
+00052400: 6c65 7b47 6172 6961 7a7a 6f3a 3230 3135  le{Gariazzo:2015
+00052410: 7272 612c 5c6e 6172 7869 763d 2231 3530  rra,\narxiv="150
+00052420: 372e 3038 3230 3422 5c6e 7d27 2c20 696e  7.08204"\n}', in
+00052430: 7370 6972 653d 2231 3338 3535 3833 220a  spire="1385583".
+00052440: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00052450: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00052460: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+00052470: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
+00052480: 7064 6174 6546 726f 6d4f 4149 2822 3133  pdateFromOAI("13
+00052490: 3835 3538 3322 2929 0a20 2020 2020 2020  85583")).       
+000524a0: 2072 6573 203d 2073 656c 662e 7042 4442   res = self.pBDB
+000524b0: 2e62 6962 732e 6765 7442 7942 6962 6b65  .bibs.getByBibke
+000524c0: 7928 2247 6172 6961 7a7a 6f3a 3230 3135  y("Gariazzo:2015
+000524d0: 7272 6122 295b 305d 0a20 2020 2020 2020  rra")[0].       
+000524e0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+000524f0: 2872 6573 5b22 6369 7461 7469 6f6e 7322  (res["citations"
+00052500: 5d20 3e20 3234 3029 0a20 2020 2020 2020  ] > 240).       
+00052510: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00052520: 2872 6573 5b22 6369 7461 7469 6f6e 735f  (res["citations_
+00052530: 6e6f 5f73 656c 6622 5d20 3e20 3139 3029  no_self"] > 190)
+00052540: 0a20 2020 2020 2020 2064 656c 2072 6573  .        del res
+00052550: 5b22 6369 7461 7469 6f6e 7322 5d0a 2020  ["citations"].  
+00052560: 2020 2020 2020 6465 6c20 7265 735b 2263        del res["c
+00052570: 6974 6174 696f 6e73 5f6e 6f5f 7365 6c66  itations_no_self
+00052580: 225d 0a20 2020 2020 2020 2073 656c 662e  "].        self.
+00052590: 6173 7365 7274 4571 7561 6c28 7265 732c  assertEqual(res,
+000525a0: 2065 7870 6563 7465 6429 0a0a 2020 2020   expected)..    
+000525b0: 6465 6620 7465 7374 5f75 7064 6174 6546  def test_updateF
+000525c0: 726f 6d4f 4149 2873 656c 662c 202a 6172  romOAI(self, *ar
+000525d0: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+000525e0: 7465 7374 2075 7064 6174 6546 726f 6d4f  test updateFromO
+000525f0: 4149 2077 6974 686f 7574 2072 656c 7969  AI without relyi
+00052600: 6e67 0a20 2020 2020 2020 206f 6e20 7468  ng.        on th
+00052610: 6520 7472 7565 2070 4244 422e 6269 6273  e true pBDB.bibs
+00052620: 2e75 7064 6174 6549 6e66 6f46 726f 6d4f  .updateInfoFromO
+00052630: 4149 2028 6d6f 636b 6564 290a 2020 2020  AI (mocked).    
+00052640: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00052650: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
+00052660: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
+00052670: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
+00052680: 732e 7072 6570 6172 6549 6e73 6572 7428  s.prepareInsert(
+00052690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000526a0: 2027 4061 7274 6963 6c65 7b61 6263 2c5c   '@article{abc,\
+000526b0: 6e61 7278 6976 3d22 3132 3334 2e35 3637  narxiv="1234.567
+000526c0: 3839 225c 6e7d 272c 2069 6e73 7069 7265  89"\n}', inspire
+000526d0: 3d22 3132 3334 3522 0a20 2020 2020 2020  ="12345".       
+000526e0: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
+000526f0: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
+00052700: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
+00052710: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
+00052720: 6162 6173 652e 456e 7472 6965 732e 7570  abase.Entries.up
+00052730: 6461 7465 496e 666f 4672 6f6d 4f41 4922  dateInfoFromOAI"
+00052740: 2c0a 2020 2020 2020 2020 2020 2020 6175  ,.            au
+00052750: 746f 7370 6563 3d54 7275 652c 0a20 2020  tospec=True,.   
+00052760: 2020 2020 2020 2020 2073 6964 655f 6566           side_ef
+00052770: 6665 6374 3d5b 2261 222c 2022 6222 2c20  fect=["a", "b", 
+00052780: 2263 222c 2022 6422 2c20 2265 222c 2022  "c", "d", "e", "
+00052790: 6622 5d2c 0a20 2020 2020 2020 2029 2061  f"],.        ) a
+000527a0: 7320 6d6f 636b 5f66 756e 6374 696f 6e3a  s mock_function:
+000527b0: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+000527c0: 6820 7061 7463 6828 0a20 2020 2020 2020  h patch(.       
+000527d0: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
+000527e0: 626c 696f 2e64 6174 6162 6173 652e 456e  blio.database.En
+000527f0: 7472 6965 732e 7570 6461 7465 496e 7370  tries.updateInsp
+00052800: 6972 6549 4422 2c0a 2020 2020 2020 2020  ireID",.        
+00052810: 2020 2020 2020 2020 7369 6465 5f65 6666          side_eff
+00052820: 6563 743d 5b22 3534 3332 3122 2c20 4661  ect=["54321", Fa
+00052830: 6c73 655d 2c0a 2020 2020 2020 2020 2020  lse],.          
+00052840: 2020 2020 2020 6175 746f 7370 6563 3d54        autospec=T
+00052850: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+00052860: 2029 2061 7320 5f75 7064 6174 6569 643a   ) as _updateid:
+00052870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052880: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00052890: 6c28 7365 6c66 2e70 4244 422e 6269 6273  l(self.pBDB.bibs
+000528a0: 2e75 7064 6174 6546 726f 6d4f 4149 2822  .updateFromOAI("
+000528b0: 6162 6322 292c 2022 6122 290a 2020 2020  abc"), "a").    
+000528c0: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+000528d0: 5f66 756e 6374 696f 6e2e 6173 7365 7274  _function.assert
+000528e0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+000528f0: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
+00052900: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00052910: 2e62 6962 732c 2022 3132 3334 3522 2c20  .bibs, "12345", 
+00052920: 7665 7262 6f73 653d 300a 2020 2020 2020  verbose=0.      
+00052930: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00052940: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+00052950: 5f66 756e 6374 696f 6e2e 7265 7365 745f  _function.reset_
+00052960: 6d6f 636b 2829 0a20 2020 2020 2020 2020  mock().         
+00052970: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00052980: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+00052990: 422e 6269 6273 2e75 7064 6174 6546 726f  B.bibs.updateFro
+000529a0: 6d4f 4149 2822 3132 3334 2229 2c20 2262  mOAI("1234"), "b
+000529b0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+000529c0: 2020 206d 6f63 6b5f 6675 6e63 7469 6f6e     mock_function
+000529d0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+000529e0: 6e63 655f 7769 7468 2873 656c 662e 7042  nce_with(self.pB
+000529f0: 4442 2e62 6962 732c 2022 3132 3334 222c  DB.bibs, "1234",
+00052a00: 2076 6572 626f 7365 3d30 290a 2020 2020   verbose=0).    
+00052a10: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+00052a20: 5f66 756e 6374 696f 6e2e 7265 7365 745f  _function.reset_
+00052a30: 6d6f 636b 2829 0a20 2020 2020 2020 2020  mock().         
+00052a40: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00052a50: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00052a60: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00052a70: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
+00052a80: 7465 4672 6f6d 4f41 4928 5b22 6162 6322  teFromOAI(["abc"
+00052a90: 2c20 2231 3233 3422 5d29 2c20 5b22 6322  , "1234"]), ["c"
+00052aa0: 2c20 2264 225d 0a20 2020 2020 2020 2020  , "d"].         
+00052ab0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00052ac0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00052ad0: 7365 7274 4571 7561 6c28 6d6f 636b 5f66  sertEqual(mock_f
+00052ae0: 756e 6374 696f 6e2e 6361 6c6c 5f63 6f75  unction.call_cou
+00052af0: 6e74 2c20 3229 0a20 2020 2020 2020 2020  nt, 2).         
+00052b00: 2020 2020 2020 206d 6f63 6b5f 6675 6e63         mock_func
+00052b10: 7469 6f6e 2e61 7373 6572 745f 6361 6c6c  tion.assert_call
+00052b20: 6564 5f77 6974 6828 7365 6c66 2e70 4244  ed_with(self.pBD
+00052b30: 422e 6269 6273 2c20 2231 3233 3422 2c20  B.bibs, "1234", 
+00052b40: 7665 7262 6f73 653d 3029 0a20 2020 2020  verbose=0).     
+00052b50: 2020 2020 2020 2020 2020 206d 6f63 6b5f             mock_
+00052b60: 6675 6e63 7469 6f6e 2e72 6573 6574 5f6d  function.reset_m
+00052b70: 6f63 6b28 290a 2020 2020 2020 2020 2020  ock().          
+00052b80: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00052b90: 6269 6273 2e69 6e73 6572 7446 726f 6d42  bibs.insertFromB
+00052ba0: 6962 7465 7828 2740 6172 7469 636c 657b  ibtex('@article{
+00052bb0: 6465 662c 5c6e 6172 7869 763d 2231 3233  def,\narxiv="123
+00052bc0: 342e 3536 3738 3922 5c6e 7d27 290a 2020  4.56789"\n}').  
+00052bd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00052be0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00052bf0: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
+00052c00: 6461 7465 4672 6f6d 4f41 4928 2264 6566  dateFromOAI("def
+00052c10: 222c 2076 6572 626f 7365 3d31 292c 2022  ", verbose=1), "
+00052c20: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+00052c30: 2020 2020 6d6f 636b 5f66 756e 6374 696f      mock_functio
+00052c40: 6e2e 6173 7365 7274 5f63 616c 6c65 645f  n.assert_called_
+00052c50: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
+00052c60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00052c70: 656c 662e 7042 4442 2e62 6962 732c 2022  elf.pBDB.bibs, "
+00052c80: 3534 3332 3122 2c20 7665 7262 6f73 653d  54321", verbose=
+00052c90: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00052ca0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00052cb0: 2020 2020 6d6f 636b 5f66 756e 6374 696f      mock_functio
+00052cc0: 6e2e 7265 7365 745f 6d6f 636b 2829 0a20  n.reset_mock(). 
+00052cd0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00052ce0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00052cf0: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
+00052d00: 7064 6174 6546 726f 6d4f 4149 2822 6162  pdateFromOAI("ab
+00052d10: 6364 6566 2229 2c20 2266 2229 0a20 2020  cdef"), "f").   
+00052d20: 2020 2020 2020 2020 2020 2020 206d 6f63               moc
+00052d30: 6b5f 6675 6e63 7469 6f6e 2e61 7373 6572  k_function.asser
+00052d40: 745f 6361 6c6c 6564 5f6f 6e63 655f 7769  t_called_once_wi
+00052d50: 7468 2873 656c 662e 7042 4442 2e62 6962  th(self.pBDB.bib
+00052d60: 732c 2046 616c 7365 2c20 7665 7262 6f73  s, False, verbos
+00052d70: 653d 3029 0a0a 2020 2020 4075 6e69 7474  e=0)..    @unitt
+00052d80: 6573 742e 736b 6970 4966 2873 6b69 7054  est.skipIf(skipT
+00052d90: 6573 7473 5365 7474 696e 6773 2e6f 6e6c  estsSettings.onl
+00052da0: 696e 652c 2022 4f6e 6c69 6e65 2074 6573  ine, "Online tes
+00052db0: 7473 2229 0a20 2020 2064 6566 2074 6573  ts").    def tes
+00052dc0: 745f 7570 6461 7465 496e 666f 4672 6f6d  t_updateInfoFrom
+00052dd0: 4f41 495f 6f6e 6c69 6e65 2873 656c 662c  OAI_online(self,
+00052de0: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
+00052df0: 2022 2222 7465 7374 2075 7064 6174 6549   """test updateI
+00052e00: 6e66 6f46 726f 6d4f 4149 2c20 7769 7468  nfoFromOAI, with
+00052e10: 206f 6e6c 696e 6520 636f 6e6e 6563 7469   online connecti
+00052e20: 6f6e 2222 220a 2020 2020 2020 2020 6578  on""".        ex
+00052e30: 7065 6374 6564 203d 2066 756c 6c52 6563  pected = fullRec
+00052e40: 6f72 6447 6172 6961 7a7a 6f0a 2020 2020  ordGariazzo.    
 00052e50: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00052e60: 6273 2e69 6e73 6572 7446 726f 6d42 6962  bs.insertFromBib
-00052e70: 7465 7828 2740 6172 7469 636c 657b 6465  tex('@article{de
-00052e80: 662c 5c6e 6172 7869 763d 2231 3233 342e  f,\narxiv="1234.
-00052e90: 3536 3738 3922 5c6e 7d27 290a 2020 2020  56789"\n}').    
-00052ea0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00052eb0: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-00052ec0: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
-00052ed0: 7465 4672 6f6d 4f41 4928 2264 6566 222c  teFromOAI("def",
-00052ee0: 2076 6572 626f 7365 3d31 292c 2022 6522   verbose=1), "e"
-00052ef0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00052f00: 2020 6d6f 636b 5f66 756e 6374 696f 6e2e    mock_function.
-00052f10: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00052f20: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
-00052f30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00052f40: 662e 7042 4442 2e62 6962 732c 2022 3534  f.pBDB.bibs, "54
-00052f50: 3332 3122 2c20 7665 7262 6f73 653d 310a  321", verbose=1.
-00052f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052f70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00052f80: 2020 6d6f 636b 5f66 756e 6374 696f 6e2e    mock_function.
-00052f90: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
-00052fa0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00052fb0: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
-00052fc0: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-00052fd0: 6174 6546 726f 6d4f 4149 2822 6162 6364  ateFromOAI("abcd
-00052fe0: 6566 2229 2c20 2266 2229 0a20 2020 2020  ef"), "f").     
-00052ff0: 2020 2020 2020 2020 2020 206d 6f63 6b5f             mock_
-00053000: 6675 6e63 7469 6f6e 2e61 7373 6572 745f  function.assert_
-00053010: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-00053020: 2873 656c 662e 7042 4442 2e62 6962 732c  (self.pBDB.bibs,
-00053030: 2046 616c 7365 2c20 7665 7262 6f73 653d   False, verbose=
-00053040: 3029 0a0a 2020 2020 4075 6e69 7474 6573  0)..    @unittes
-00053050: 742e 736b 6970 4966 2873 6b69 7054 6573  t.skipIf(skipTes
-00053060: 7473 5365 7474 696e 6773 2e6f 6e6c 696e  tsSettings.onlin
-00053070: 652c 2022 4f6e 6c69 6e65 2074 6573 7473  e, "Online tests
-00053080: 2229 0a20 2020 2064 6566 2074 6573 745f  ").    def test_
-00053090: 7570 6461 7465 496e 666f 4672 6f6d 4f41  updateInfoFromOA
-000530a0: 495f 6f6e 6c69 6e65 2873 656c 662c 202a  I_online(self, *
-000530b0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-000530c0: 2222 7465 7374 2075 7064 6174 6549 6e66  ""test updateInf
-000530d0: 6f46 726f 6d4f 4149 2c20 7769 7468 206f  oFromOAI, with o
-000530e0: 6e6c 696e 6520 636f 6e6e 6563 7469 6f6e  nline connection
-000530f0: 2222 220a 2020 2020 2020 2020 6578 7065  """.        expe
-00053100: 6374 6564 203d 2066 756c 6c52 6563 6f72  cted = fullRecor
-00053110: 6447 6172 6961 7a7a 6f0a 2020 2020 2020  dGariazzo.      
-00053120: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00053130: 2e69 6e73 6572 7428 0a20 2020 2020 2020  .insert(.       
-00053140: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00053150: 6962 732e 7072 6570 6172 6549 6e73 6572  ibs.prepareInser
-00053160: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00053170: 2020 2027 4061 7274 6963 6c65 7b47 6172     '@article{Gar
-00053180: 6961 7a7a 6f3a 3230 3135 7272 612c 5c6e  iazzo:2015rra,\n
-00053190: 6172 7869 763d 2231 3530 372e 3038 3230  arxiv="1507.0820
-000531a0: 3422 5c6e 7d27 2c20 696e 7370 6972 653d  4"\n}', inspire=
-000531b0: 2231 3338 3535 3833 220a 2020 2020 2020  "1385583".      
-000531c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000531d0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000531e0: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-000531f0: 4244 422e 6269 6273 2e75 7064 6174 6549  BDB.bibs.updateI
-00053200: 6e66 6f46 726f 6d4f 4149 2822 4761 7269  nfoFromOAI("Gari
-00053210: 617a 7a6f 3a32 3031 3572 7261 2229 290a  azzo:2015rra")).
-00053220: 2020 2020 2020 2020 7265 7320 3d20 7365          res = se
-00053230: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
-00053240: 4279 4269 626b 6579 2822 4761 7269 617a  ByBibkey("Gariaz
-00053250: 7a6f 3a32 3031 3572 7261 2229 5b30 5d0a  zo:2015rra")[0].
-00053260: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00053270: 6572 7454 7275 6528 7265 735b 2263 6974  ertTrue(res["cit
-00053280: 6174 696f 6e73 225d 203e 2032 3430 290a  ations"] > 240).
-00053290: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000532a0: 6572 7454 7275 6528 7265 735b 2263 6974  ertTrue(res["cit
-000532b0: 6174 696f 6e73 5f6e 6f5f 7365 6c66 225d  ations_no_self"]
-000532c0: 203e 2031 3930 290a 2020 2020 2020 2020   > 190).        
-000532d0: 6465 6c20 7265 735b 2263 6974 6174 696f  del res["citatio
-000532e0: 6e73 225d 0a20 2020 2020 2020 2064 656c  ns"].        del
-000532f0: 2072 6573 5b22 6369 7461 7469 6f6e 735f   res["citations_
-00053300: 6e6f 5f73 656c 6622 5d0a 2020 2020 2020  no_self"].      
-00053310: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00053320: 616c 2872 6573 2c20 6578 7065 6374 6564  al(res, expected
-00053330: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
-00053340: 4244 422e 756e 646f 2876 6572 626f 7365  BDB.undo(verbose
-00053350: 3d30 290a 2020 2020 2020 2020 7365 6c66  =0).        self
-00053360: 2e70 4244 422e 6269 6273 2e69 6e73 6572  .pBDB.bibs.inser
-00053370: 7428 0a20 2020 2020 2020 2020 2020 2073  t(.            s
-00053380: 656c 662e 7042 4442 2e62 6962 732e 7072  elf.pBDB.bibs.pr
-00053390: 6570 6172 6549 6e73 6572 7428 0a20 2020  epareInsert(.   
-000533a0: 2020 2020 2020 2020 2020 2020 2027 4061               '@a
-000533b0: 7274 6963 6c65 7b47 6172 6961 7a7a 6f3a  rticle{Gariazzo:
-000533c0: 3230 3135 7272 612c 5c6e 6172 7869 763d  2015rra,\narxiv=
-000533d0: 2231 3530 372e 3038 3230 3422 5c6e 7d27  "1507.08204"\n}'
-000533e0: 2c20 696e 7370 6972 653d 2231 3338 3535  , inspire="13855
-000533f0: 3833 220a 2020 2020 2020 2020 2020 2020  83".            
-00053400: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00053410: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-00053420: 7275 6528 7365 6c66 2e70 4244 422e 6269  rue(self.pBDB.bi
-00053430: 6273 2e75 7064 6174 6549 6e66 6f46 726f  bs.updateInfoFro
-00053440: 6d4f 4149 2822 3133 3835 3538 3322 2929  mOAI("1385583"))
-00053450: 0a20 2020 2020 2020 2072 6573 203d 2073  .        res = s
-00053460: 656c 662e 7042 4442 2e62 6962 732e 6765  elf.pBDB.bibs.ge
-00053470: 7442 7942 6962 6b65 7928 2247 6172 6961  tByBibkey("Garia
-00053480: 7a7a 6f3a 3230 3135 7272 6122 295b 305d  zzo:2015rra")[0]
-00053490: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000534a0: 7365 7274 5472 7565 2872 6573 5b22 6369  sertTrue(res["ci
-000534b0: 7461 7469 6f6e 7322 5d20 3e20 3234 3029  tations"] > 240)
-000534c0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000534d0: 7365 7274 5472 7565 2872 6573 5b22 6369  sertTrue(res["ci
-000534e0: 7461 7469 6f6e 735f 6e6f 5f73 656c 6622  tations_no_self"
-000534f0: 5d20 3e20 3139 3029 0a20 2020 2020 2020  ] > 190).       
-00053500: 2064 656c 2072 6573 5b22 6369 7461 7469   del res["citati
-00053510: 6f6e 7322 5d0a 2020 2020 2020 2020 6465  ons"].        de
-00053520: 6c20 7265 735b 2263 6974 6174 696f 6e73  l res["citations
-00053530: 5f6e 6f5f 7365 6c66 225d 0a20 2020 2020  _no_self"].     
-00053540: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00053550: 7561 6c28 7265 732c 2065 7870 6563 7465  ual(res, expecte
-00053560: 6429 0a0a 2020 2020 6465 6620 7465 7374  d)..    def test
-00053570: 5f75 7064 6174 6549 6e66 6f46 726f 6d4f  _updateInfoFromO
-00053580: 4149 2873 656c 662c 202a 6172 6773 293a  AI(self, *args):
-00053590: 0a20 2020 2020 2020 2022 2222 7465 7374  .        """test
-000535a0: 2075 7064 6174 6549 6e66 6f46 726f 6d4f   updateInfoFromO
-000535b0: 4149 2c20 6275 7420 7769 7468 206d 6f63  AI, but with moc
-000535c0: 6b65 6420 6d65 7468 6f64 7322 2222 0a20  ked methods""". 
-000535d0: 2020 2020 2020 2064 7420 3d20 6461 7465         dt = date
-000535e0: 7469 6d65 2e64 6174 652e 746f 6461 7928  time.date.today(
-000535f0: 292e 7374 7266 7469 6d65 2822 2559 2d25  ).strftime("%Y-%
-00053600: 6d2d 2564 2229 0a20 2020 2020 2020 206d  m-%d").        m
-00053610: 6f63 6b4f 7574 203d 207b 0a20 2020 2020  ockOut = {.     
-00053620: 2020 2020 2020 2022 646f 6922 3a20 2231         "doi": "1
-00053630: 302e 3130 3838 2f30 3935 342d 3338 3939  0.1088/0954-3899
-00053640: 2f34 332f 332f 3033 3330 3031 222c 0a20  /43/3/033001",. 
-00053650: 2020 2020 2020 2020 2020 2022 6973 626e             "isbn
-00053660: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-00053670: 2020 2020 2022 6164 7322 3a20 2232 3031       "ads": "201
-00053680: 354a 5068 472e 2e2e 3433 6333 3030 3147  5JPhG...43c3001G
-00053690: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-000536a0: 7075 6264 6174 6522 3a20 2232 3031 362d  pubdate": "2016-
-000536b0: 3031 2d31 3322 2c0a 2020 2020 2020 2020  01-13",.        
-000536c0: 2020 2020 2266 6972 7374 6461 7465 223a      "firstdate":
-000536d0: 2022 3230 3135 2d30 372d 3239 222c 0a20   "2015-07-29",. 
-000536e0: 2020 2020 2020 2020 2020 2022 6a6f 7572             "jour
-000536f0: 6e61 6c22 3a20 224a 2e50 6879 732e 222c  nal": "J.Phys.",
-00053700: 0a20 2020 2020 2020 2020 2020 2022 6172  .            "ar
-00053710: 7869 7622 3a20 2231 3530 372e 3038 3230  xiv": "1507.0820
-00053720: 3422 2c0a 2020 2020 2020 2020 2020 2020  4",.            
-00053730: 2269 6422 3a20 2231 3338 3535 3833 222c  "id": "1385583",
-00053740: 0a20 2020 2020 2020 2020 2020 2022 766f  .            "vo
-00053750: 6c75 6d65 223a 2022 4734 3322 2c0a 2020  lume": "G43",.  
-00053760: 2020 2020 2020 2020 2020 2262 6962 7465            "bibte
-00053770: 7822 3a20 4e6f 6e65 2c0a 2020 2020 2020  x": None,.      
-00053780: 2020 2020 2020 2279 6561 7222 3a20 2232        "year": "2
-00053790: 3031 3622 2c0a 2020 2020 2020 2020 2020  016",.          
-000537a0: 2020 226f 6c64 6b65 7973 223a 2022 222c    "oldkeys": "",
-000537b0: 0a20 2020 2020 2020 2020 2020 2022 6269  .            "bi
-000537c0: 626b 6579 223a 2022 4761 7269 617a 7a6f  bkey": "Gariazzo
-000537d0: 3a32 3031 3572 7261 222c 0a20 2020 2020  :2015rra",.     
-000537e0: 2020 2020 2020 2022 7061 6765 7322 3a20         "pages": 
-000537f0: 2230 3333 3030 3122 2c0a 2020 2020 2020  "033001",.      
-00053800: 2020 7d0a 2020 2020 2020 2020 7365 6c66    }.        self
-00053810: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
-00053820: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
-00053830: 7465 496e 666f 4672 6f6d 4f41 4928 4661  teInfoFromOAI(Fa
-00053840: 6c73 6529 290a 2020 2020 2020 2020 7365  lse)).        se
-00053850: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
-00053860: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
-00053870: 6461 7465 496e 666f 4672 6f6d 4f41 4928  dateInfoFromOAI(
-00053880: 2222 2929 0a20 2020 2020 2020 2073 656c  "")).        sel
-00053890: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
-000538a0: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-000538b0: 6174 6549 6e66 6f46 726f 6d4f 4149 284e  ateInfoFromOAI(N
-000538c0: 6f6e 6529 290a 2020 2020 2020 2020 7769  one)).        wi
-000538d0: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-000538e0: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-000538f0: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
-00053900: 6573 2e67 6574 4669 656c 6422 2c0a 2020  es.getField",.  
-00053910: 2020 2020 2020 2020 2020 7369 6465 5f65            side_e
-00053920: 6666 6563 743d 5b22 6162 6364 222c 2046  ffect=["abcd", F
-00053930: 616c 7365 2c20 2231 3233 3435 225d 2c0a  alse, "12345"],.
-00053940: 2020 2020 2020 2020 2020 2020 6175 746f              auto
-00053950: 7370 6563 3d54 7275 652c 0a20 2020 2020  spec=True,.     
-00053960: 2020 2029 2061 7320 6d6f 636b 3a0a 2020     ) as mock:.  
-00053970: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00053980: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
-00053990: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
-000539a0: 496e 666f 4672 6f6d 4f41 4928 2261 6263  InfoFromOAI("abc
-000539b0: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
-000539c0: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
-000539d0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-000539e0: 7570 6461 7465 496e 666f 4672 6f6d 4f41  updateInfoFromOA
-000539f0: 4928 2261 6263 2229 290a 0a20 2020 2020  I("abc"))..     
-00053a00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00053a10: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00053a20: 422e 6269 6273 2e67 6574 4279 4269 626b  B.bibs.getByBibk
-00053a30: 6579 2822 4761 7269 617a 7a6f 3a32 3031  ey("Gariazzo:201
-00053a40: 3572 7261 2229 2c20 5b5d 290a 2020 2020  5rra"), []).    
-00053a50: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-00053a60: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-00053a70: 2020 2020 2270 6879 7362 6962 6c69 6f2e      "physbiblio.
-00053a80: 7765 6269 6d70 6f72 742e 696e 7370 6972  webimport.inspir
-00053a90: 652e 5765 6253 6561 7263 682e 7265 7472  e.WebSearch.retr
-00053aa0: 6965 7665 4f41 4944 6174 6122 2c0a 2020  ieveOAIData",.  
-00053ab0: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00053ac0: 6465 5f65 6666 6563 743d 5b0a 2020 2020  de_effect=[.    
+00052e60: 6273 2e69 6e73 6572 7428 0a20 2020 2020  bs.insert(.     
+00052e70: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00052e80: 2e62 6962 732e 7072 6570 6172 6549 6e73  .bibs.prepareIns
+00052e90: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
+00052ea0: 2020 2020 2027 4061 7274 6963 6c65 7b47       '@article{G
+00052eb0: 6172 6961 7a7a 6f3a 3230 3135 7272 612c  ariazzo:2015rra,
+00052ec0: 5c6e 6172 7869 763d 2231 3530 372e 3038  \narxiv="1507.08
+00052ed0: 3230 3422 5c6e 7d27 2c20 696e 7370 6972  204"\n}', inspir
+00052ee0: 653d 2231 3338 3535 3833 220a 2020 2020  e="1385583".    
+00052ef0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00052f00: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00052f10: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+00052f20: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+00052f30: 6549 6e66 6f46 726f 6d4f 4149 2822 4761  eInfoFromOAI("Ga
+00052f40: 7269 617a 7a6f 3a32 3031 3572 7261 2229  riazzo:2015rra")
+00052f50: 290a 2020 2020 2020 2020 7265 7320 3d20  ).        res = 
+00052f60: 7365 6c66 2e70 4244 422e 6269 6273 2e67  self.pBDB.bibs.g
+00052f70: 6574 4279 4269 626b 6579 2822 4761 7269  etByBibkey("Gari
+00052f80: 617a 7a6f 3a32 3031 3572 7261 2229 5b30  azzo:2015rra")[0
+00052f90: 5d0a 2020 2020 2020 2020 7365 6c66 2e61  ].        self.a
+00052fa0: 7373 6572 7454 7275 6528 7265 735b 2263  ssertTrue(res["c
+00052fb0: 6974 6174 696f 6e73 225d 203e 2032 3430  itations"] > 240
+00052fc0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00052fd0: 7373 6572 7454 7275 6528 7265 735b 2263  ssertTrue(res["c
+00052fe0: 6974 6174 696f 6e73 5f6e 6f5f 7365 6c66  itations_no_self
+00052ff0: 225d 203e 2031 3930 290a 2020 2020 2020  "] > 190).      
+00053000: 2020 6465 6c20 7265 735b 2263 6974 6174    del res["citat
+00053010: 696f 6e73 225d 0a20 2020 2020 2020 2064  ions"].        d
+00053020: 656c 2072 6573 5b22 6369 7461 7469 6f6e  el res["citation
+00053030: 735f 6e6f 5f73 656c 6622 5d0a 2020 2020  s_no_self"].    
+00053040: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00053050: 7175 616c 2872 6573 2c20 6578 7065 6374  qual(res, expect
+00053060: 6564 290a 2020 2020 2020 2020 7365 6c66  ed).        self
+00053070: 2e70 4244 422e 756e 646f 2876 6572 626f  .pBDB.undo(verbo
+00053080: 7365 3d30 290a 2020 2020 2020 2020 7365  se=0).        se
+00053090: 6c66 2e70 4244 422e 6269 6273 2e69 6e73  lf.pBDB.bibs.ins
+000530a0: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
+000530b0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+000530c0: 7072 6570 6172 6549 6e73 6572 7428 0a20  prepareInsert(. 
+000530d0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+000530e0: 4061 7274 6963 6c65 7b47 6172 6961 7a7a  @article{Gariazz
+000530f0: 6f3a 3230 3135 7272 612c 5c6e 6172 7869  o:2015rra,\narxi
+00053100: 763d 2231 3530 372e 3038 3230 3422 5c6e  v="1507.08204"\n
+00053110: 7d27 2c20 696e 7370 6972 653d 2231 3338  }', inspire="138
+00053120: 3535 3833 220a 2020 2020 2020 2020 2020  5583".          
+00053130: 2020 290a 2020 2020 2020 2020 290a 2020    ).        ).  
+00053140: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00053150: 7454 7275 6528 7365 6c66 2e70 4244 422e  tTrue(self.pBDB.
+00053160: 6269 6273 2e75 7064 6174 6549 6e66 6f46  bibs.updateInfoF
+00053170: 726f 6d4f 4149 2822 3133 3835 3538 3322  romOAI("1385583"
+00053180: 2929 0a20 2020 2020 2020 2072 6573 203d  )).        res =
+00053190: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+000531a0: 6765 7442 7942 6962 6b65 7928 2247 6172  getByBibkey("Gar
+000531b0: 6961 7a7a 6f3a 3230 3135 7272 6122 295b  iazzo:2015rra")[
+000531c0: 305d 0a20 2020 2020 2020 2073 656c 662e  0].        self.
+000531d0: 6173 7365 7274 5472 7565 2872 6573 5b22  assertTrue(res["
+000531e0: 6369 7461 7469 6f6e 7322 5d20 3e20 3234  citations"] > 24
+000531f0: 3029 0a20 2020 2020 2020 2073 656c 662e  0).        self.
+00053200: 6173 7365 7274 5472 7565 2872 6573 5b22  assertTrue(res["
+00053210: 6369 7461 7469 6f6e 735f 6e6f 5f73 656c  citations_no_sel
+00053220: 6622 5d20 3e20 3139 3029 0a20 2020 2020  f"] > 190).     
+00053230: 2020 2064 656c 2072 6573 5b22 6369 7461     del res["cita
+00053240: 7469 6f6e 7322 5d0a 2020 2020 2020 2020  tions"].        
+00053250: 6465 6c20 7265 735b 2263 6974 6174 696f  del res["citatio
+00053260: 6e73 5f6e 6f5f 7365 6c66 225d 0a20 2020  ns_no_self"].   
+00053270: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00053280: 4571 7561 6c28 7265 732c 2065 7870 6563  Equal(res, expec
+00053290: 7465 6429 0a0a 2020 2020 6465 6620 7465  ted)..    def te
+000532a0: 7374 5f75 7064 6174 6549 6e66 6f46 726f  st_updateInfoFro
+000532b0: 6d4f 4149 2873 656c 662c 202a 6172 6773  mOAI(self, *args
+000532c0: 293a 0a20 2020 2020 2020 2022 2222 7465  ):.        """te
+000532d0: 7374 2075 7064 6174 6549 6e66 6f46 726f  st updateInfoFro
+000532e0: 6d4f 4149 2c20 6275 7420 7769 7468 206d  mOAI, but with m
+000532f0: 6f63 6b65 6420 6d65 7468 6f64 7322 2222  ocked methods"""
+00053300: 0a20 2020 2020 2020 2064 7420 3d20 6461  .        dt = da
+00053310: 7465 7469 6d65 2e64 6174 652e 746f 6461  tetime.date.toda
+00053320: 7928 292e 7374 7266 7469 6d65 2822 2559  y().strftime("%Y
+00053330: 2d25 6d2d 2564 2229 0a20 2020 2020 2020  -%m-%d").       
+00053340: 206d 6f63 6b4f 7574 203d 207b 0a20 2020   mockOut = {.   
+00053350: 2020 2020 2020 2020 2022 646f 6922 3a20           "doi": 
+00053360: 2231 302e 3130 3838 2f30 3935 342d 3338  "10.1088/0954-38
+00053370: 3939 2f34 332f 332f 3033 3330 3031 222c  99/43/3/033001",
+00053380: 0a20 2020 2020 2020 2020 2020 2022 6973  .            "is
+00053390: 626e 223a 204e 6f6e 652c 0a20 2020 2020  bn": None,.     
+000533a0: 2020 2020 2020 2022 6164 7322 3a20 2232         "ads": "2
+000533b0: 3031 354a 5068 472e 2e2e 3433 6333 3030  015JPhG...43c300
+000533c0: 3147 222c 0a20 2020 2020 2020 2020 2020  1G",.           
+000533d0: 2022 7075 6264 6174 6522 3a20 2232 3031   "pubdate": "201
+000533e0: 362d 3031 2d31 3322 2c0a 2020 2020 2020  6-01-13",.      
+000533f0: 2020 2020 2020 2266 6972 7374 6461 7465        "firstdate
+00053400: 223a 2022 3230 3135 2d30 372d 3239 222c  ": "2015-07-29",
+00053410: 0a20 2020 2020 2020 2020 2020 2022 6a6f  .            "jo
+00053420: 7572 6e61 6c22 3a20 224a 2e50 6879 732e  urnal": "J.Phys.
+00053430: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00053440: 6172 7869 7622 3a20 2231 3530 372e 3038  arxiv": "1507.08
+00053450: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
+00053460: 2020 2269 6422 3a20 2231 3338 3535 3833    "id": "1385583
+00053470: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00053480: 766f 6c75 6d65 223a 2022 4734 3322 2c0a  volume": "G43",.
+00053490: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
+000534a0: 7465 7822 3a20 4e6f 6e65 2c0a 2020 2020  tex": None,.    
+000534b0: 2020 2020 2020 2020 2279 6561 7222 3a20          "year": 
+000534c0: 2232 3031 3622 2c0a 2020 2020 2020 2020  "2016",.        
+000534d0: 2020 2020 226f 6c64 6b65 7973 223a 2022      "oldkeys": "
+000534e0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+000534f0: 6269 626b 6579 223a 2022 4761 7269 617a  bibkey": "Gariaz
+00053500: 7a6f 3a32 3031 3572 7261 222c 0a20 2020  zo:2015rra",.   
+00053510: 2020 2020 2020 2020 2022 7061 6765 7322           "pages"
+00053520: 3a20 2230 3333 3030 3122 2c0a 2020 2020  : "033001",.    
+00053530: 2020 2020 7d0a 2020 2020 2020 2020 7365      }.        se
+00053540: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
+00053550: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
+00053560: 6461 7465 496e 666f 4672 6f6d 4f41 4928  dateInfoFromOAI(
+00053570: 4661 6c73 6529 290a 2020 2020 2020 2020  False)).        
+00053580: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
+00053590: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+000535a0: 7570 6461 7465 496e 666f 4672 6f6d 4f41  updateInfoFromOA
+000535b0: 4928 2222 2929 0a20 2020 2020 2020 2073  I("")).        s
+000535c0: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+000535d0: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
+000535e0: 7064 6174 6549 6e66 6f46 726f 6d4f 4149  pdateInfoFromOAI
+000535f0: 284e 6f6e 6529 290a 2020 2020 2020 2020  (None)).        
+00053600: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
+00053610: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
+00053620: 6c69 6f2e 6461 7461 6261 7365 2e45 6e74  lio.database.Ent
+00053630: 7269 6573 2e67 6574 4669 656c 6422 2c0a  ries.getField",.
+00053640: 2020 2020 2020 2020 2020 2020 7369 6465              side
+00053650: 5f65 6666 6563 743d 5b22 6162 6364 222c  _effect=["abcd",
+00053660: 2046 616c 7365 2c20 2231 3233 3435 225d   False, "12345"]
+00053670: 2c0a 2020 2020 2020 2020 2020 2020 6175  ,.            au
+00053680: 746f 7370 6563 3d54 7275 652c 0a20 2020  tospec=True,.   
+00053690: 2020 2020 2029 2061 7320 6d6f 636b 3a0a       ) as mock:.
+000536a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000536b0: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
+000536c0: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
+000536d0: 7465 496e 666f 4672 6f6d 4f41 4928 2261  teInfoFromOAI("a
+000536e0: 6263 2229 290a 2020 2020 2020 2020 2020  bc")).          
+000536f0: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
+00053700: 7365 2873 656c 662e 7042 4442 2e62 6962  se(self.pBDB.bib
+00053710: 732e 7570 6461 7465 496e 666f 4672 6f6d  s.updateInfoFrom
+00053720: 4f41 4928 2261 6263 2229 290a 0a20 2020  OAI("abc"))..   
+00053730: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00053740: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00053750: 4244 422e 6269 6273 2e67 6574 4279 4269  BDB.bibs.getByBi
+00053760: 626b 6579 2822 4761 7269 617a 7a6f 3a32  bkey("Gariazzo:2
+00053770: 3031 3572 7261 2229 2c20 5b5d 290a 2020  015rra"), []).  
+00053780: 2020 2020 2020 2020 2020 7769 7468 2070            with p
+00053790: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+000537a0: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
+000537b0: 6f2e 7765 6269 6d70 6f72 742e 696e 7370  o.webimport.insp
+000537c0: 6972 652e 5765 6253 6561 7263 682e 7265  ire.WebSearch.re
+000537d0: 7472 6965 7665 4f41 4944 6174 6122 2c0a  trieveOAIData",.
+000537e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000537f0: 7369 6465 5f65 6666 6563 743d 5b0a 2020  side_effect=[.  
+00053800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053810: 2020 4661 6c73 652c 0a20 2020 2020 2020    False,.       
+00053820: 2020 2020 2020 2020 2020 2020 206d 6f63               moc
+00053830: 6b4f 7574 2c0a 2020 2020 2020 2020 2020  kOut,.          
+00053840: 2020 2020 2020 2020 2020 6d6f 636b 4f75            mockOu
+00053850: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00053860: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+00053870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053880: 2022 646f 6922 3a20 2231 302e 3130 3838   "doi": "10.1088
+00053890: 2f30 3935 342d 3338 3939 2f34 332f 332f  /0954-3899/43/3/
+000538a0: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
+000538b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000538c0: 2022 6973 626e 223a 204e 6f6e 652c 0a20   "isbn": None,. 
+000538d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000538e0: 2020 2020 2020 2022 6164 7322 3a20 2232         "ads": "2
+000538f0: 3031 354a 5068 472e 2e2e 3433 6333 3030  015JPhG...43c300
+00053900: 3147 222c 0a20 2020 2020 2020 2020 2020  1G",.           
+00053910: 2020 2020 2020 2020 2020 2020 2022 7075               "pu
+00053920: 6264 6174 6522 3a20 2232 3031 362d 3031  bdate": "2016-01
+00053930: 2d31 3322 2c0a 2020 2020 2020 2020 2020  -13",.          
+00053940: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+00053950: 6972 7374 6461 7465 223a 2022 3230 3135  irstdate": "2015
+00053960: 2d30 372d 3239 222c 0a20 2020 2020 2020  -07-29",.       
+00053970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053980: 2023 2022 6a6f 7572 6e61 6c22 3a20 7522   # "journal": u"
+00053990: 4a2e 5068 7973 2e47 222c 0a20 2020 2020  J.Phys.G",.     
+000539a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000539b0: 2020 2022 6172 7869 7622 3a20 2231 3530     "arxiv": "150
+000539c0: 372e 3038 3230 3422 2c0a 2020 2020 2020  7.08204",.      
+000539d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000539e0: 2020 2269 6422 3a20 2231 3338 3535 3833    "id": "1385583
+000539f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00053a00: 2020 2020 2020 2020 2020 2023 2022 766f             # "vo
+00053a10: 6c75 6d65 223a 2075 2234 3322 2c0a 2020  lume": u"43",.  
+00053a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053a30: 2020 2020 2020 2262 6962 7465 7822 3a20        "bibtex": 
+00053a40: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00053a50: 2020 2020 2020 2020 2020 2020 2020 2279                "y
+00053a60: 6561 7222 3a20 2232 3031 3622 2c0a 2020  ear": "2016",.  
+00053a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053a80: 2020 2020 2020 226f 6c64 6b65 7973 223a        "oldkeys":
+00053a90: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00053aa0: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+00053ab0: 626b 6579 223a 2022 4761 7269 617a 7a6f  bkey": "Gariazzo
+00053ac0: 3a32 3031 3572 7261 222c 0a20 2020 2020  :2015rra",.     
 00053ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053ae0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00053af0: 2020 2020 2020 2020 2020 206d 6f63 6b4f             mockO
-00053b00: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-00053b10: 2020 2020 2020 2020 6d6f 636b 4f75 742c          mockOut,
-00053b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00053b30: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00053b40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00053b50: 646f 6922 3a20 2231 302e 3130 3838 2f30  doi": "10.1088/0
-00053b60: 3935 342d 3338 3939 2f34 332f 332f 3033  954-3899/43/3/03
-00053b70: 3330 3031 222c 0a20 2020 2020 2020 2020  3001",.         
-00053b80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00053b90: 6973 626e 223a 204e 6f6e 652c 0a20 2020  isbn": None,.   
-00053ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053bb0: 2020 2020 2022 6164 7322 3a20 2232 3031       "ads": "201
-00053bc0: 354a 5068 472e 2e2e 3433 6333 3030 3147  5JPhG...43c3001G
-00053bd0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00053be0: 2020 2020 2020 2020 2020 2022 7075 6264             "pubd
-00053bf0: 6174 6522 3a20 2232 3031 362d 3031 2d31  ate": "2016-01-1
-00053c00: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-00053c10: 2020 2020 2020 2020 2020 2020 2266 6972              "fir
-00053c20: 7374 6461 7465 223a 2022 3230 3135 2d30  stdate": "2015-0
-00053c30: 372d 3239 222c 0a20 2020 2020 2020 2020  7-29",.         
-00053c40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00053c50: 2022 6a6f 7572 6e61 6c22 3a20 7522 4a2e   "journal": u"J.
-00053c60: 5068 7973 2e47 222c 0a20 2020 2020 2020  Phys.G",.       
-00053c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053c80: 2022 6172 7869 7622 3a20 2231 3530 372e   "arxiv": "1507.
-00053c90: 3038 3230 3422 2c0a 2020 2020 2020 2020  08204",.        
-00053ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053cb0: 2269 6422 3a20 2231 3338 3535 3833 222c  "id": "1385583",
-00053cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00053cd0: 2020 2020 2020 2020 2023 2022 766f 6c75           # "volu
-00053ce0: 6d65 223a 2075 2234 3322 2c0a 2020 2020  me": u"43",.    
-00053cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053d00: 2020 2020 2262 6962 7465 7822 3a20 4e6f      "bibtex": No
-00053d10: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00053d20: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
-00053d30: 7222 3a20 2232 3031 3622 2c0a 2020 2020  r": "2016",.    
-00053d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053d50: 2020 2020 226f 6c64 6b65 7973 223a 2022      "oldkeys": "
-00053d60: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00053d70: 2020 2020 2020 2020 2020 2022 6269 626b             "bibk
-00053d80: 6579 223a 2022 4761 7269 617a 7a6f 3a32  ey": "Gariazzo:2
-00053d90: 3031 3572 7261 222c 0a20 2020 2020 2020  015rra",.       
+00053ae0: 2020 2023 2022 7061 6765 7322 3a20 7522     # "pages": u"
+00053af0: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
+00053b00: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00053b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053b20: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+00053b30: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00053b40: 2264 6f69 223a 2075 2231 302e 3130 3838  "doi": u"10.1088
+00053b50: 2f30 3935 342d 3338 3939 2f34 332f 332f  /0954-3899/43/3/
+00053b60: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
+00053b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053b80: 2022 6973 626e 223a 204e 6f6e 652c 0a20   "isbn": None,. 
+00053b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053ba0: 2020 2020 2020 2022 6164 7322 3a20 2232         "ads": "2
+00053bb0: 3031 354a 5068 472e 2e2e 3433 6333 3030  015JPhG...43c300
+00053bc0: 3147 222c 0a20 2020 2020 2020 2020 2020  1G",.           
+00053bd0: 2020 2020 2020 2020 2020 2020 2022 7075               "pu
+00053be0: 6264 6174 6522 3a20 2232 3031 362d 3031  bdate": "2016-01
+00053bf0: 2d31 3322 2c0a 2020 2020 2020 2020 2020  -13",.          
+00053c00: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+00053c10: 6972 7374 6461 7465 223a 2022 3230 3135  irstdate": "2015
+00053c20: 2d30 372d 3239 222c 0a20 2020 2020 2020  -07-29",.       
+00053c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053c40: 2022 6a6f 7572 6e61 6c22 3a20 224a 2e50   "journal": "J.P
+00053c50: 6879 732e 4722 2c0a 2020 2020 2020 2020  hys.G",.        
+00053c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053c70: 2261 7278 6976 223a 2022 3135 3037 2e30  "arxiv": "1507.0
+00053c80: 3832 3034 222c 0a20 2020 2020 2020 2020  8204",.         
+00053c90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00053ca0: 6964 223a 2022 3133 3835 3538 3322 2c0a  id": "1385583",.
+00053cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053cc0: 2020 2020 2020 2020 2320 2276 6f6c 756d          # "volum
+00053cd0: 6522 3a20 7522 3433 222c 0a20 2020 2020  e": u"43",.     
+00053ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053cf0: 2020 2022 6269 6274 6578 223a 2027 4041     "bibtex": '@A
+00053d00: 7274 6963 6c65 7b47 6172 6961 7a7a 6f3a  rticle{Gariazzo:
+00053d10: 3230 3135 7272 612c 5c6e 6175 7468 6f72  2015rra,\nauthor
+00053d20: 3d22 4761 7269 617a 7a6f 222c 270a 2020  ="Gariazzo",'.  
+00053d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053d40: 2020 2020 2020 2b20 275c 6e74 6974 6c65        + '\ntitle
+00053d50: 3d22 7b4c 6967 6874 2053 7465 7269 6c65  ="{Light Sterile
+00053d60: 204e 6575 7472 696e 6f73 7d22 5c6e 7d27   Neutrinos}"\n}'
+00053d70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00053d80: 2020 2020 2020 2020 2020 2279 6561 7222            "year"
+00053d90: 3a20 2232 3031 3622 2c0a 2020 2020 2020  : "2016",.      
 00053da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053db0: 2023 2022 7061 6765 7322 3a20 7522 3033   # "pages": u"03
-00053dc0: 3330 3031 222c 0a20 2020 2020 2020 2020  3001",.         
-00053dd0: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
-00053de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053df0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-00053e00: 2020 2020 2020 2020 2020 2020 2320 2264              # "d
-00053e10: 6f69 223a 2075 2231 302e 3130 3838 2f30  oi": u"10.1088/0
-00053e20: 3935 342d 3338 3939 2f34 332f 332f 3033  954-3899/43/3/03
-00053e30: 3330 3031 222c 0a20 2020 2020 2020 2020  3001",.         
-00053e40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00053e50: 6973 626e 223a 204e 6f6e 652c 0a20 2020  isbn": None,.   
-00053e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053e70: 2020 2020 2022 6164 7322 3a20 2232 3031       "ads": "201
-00053e80: 354a 5068 472e 2e2e 3433 6333 3030 3147  5JPhG...43c3001G
-00053e90: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00053ea0: 2020 2020 2020 2020 2020 2022 7075 6264             "pubd
-00053eb0: 6174 6522 3a20 2232 3031 362d 3031 2d31  ate": "2016-01-1
-00053ec0: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-00053ed0: 2020 2020 2020 2020 2020 2020 2266 6972              "fir
-00053ee0: 7374 6461 7465 223a 2022 3230 3135 2d30  stdate": "2015-0
-00053ef0: 372d 3239 222c 0a20 2020 2020 2020 2020  7-29",.         
-00053f00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00053f10: 6a6f 7572 6e61 6c22 3a20 224a 2e50 6879  journal": "J.Phy
-00053f20: 732e 4722 2c0a 2020 2020 2020 2020 2020  s.G",.          
-00053f30: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-00053f40: 7278 6976 223a 2022 3135 3037 2e30 3832  rxiv": "1507.082
-00053f50: 3034 222c 0a20 2020 2020 2020 2020 2020  04",.           
-00053f60: 2020 2020 2020 2020 2020 2020 2022 6964               "id
-00053f70: 223a 2022 3133 3835 3538 3322 2c0a 2020  ": "1385583",.  
-00053f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053f90: 2020 2020 2020 2320 2276 6f6c 756d 6522        # "volume"
-00053fa0: 3a20 7522 3433 222c 0a20 2020 2020 2020  : u"43",.       
-00053fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053fc0: 2022 6269 6274 6578 223a 2027 4041 7274   "bibtex": '@Art
-00053fd0: 6963 6c65 7b47 6172 6961 7a7a 6f3a 3230  icle{Gariazzo:20
-00053fe0: 3135 7272 612c 5c6e 6175 7468 6f72 3d22  15rra,\nauthor="
-00053ff0: 4761 7269 617a 7a6f 222c 270a 2020 2020  Gariazzo",'.    
-00054000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054010: 2020 2020 2b20 275c 6e74 6974 6c65 3d22      + '\ntitle="
-00054020: 7b4c 6967 6874 2053 7465 7269 6c65 204e  {Light Sterile N
-00054030: 6575 7472 696e 6f73 7d22 5c6e 7d27 2c0a  eutrinos}"\n}',.
-00054040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054050: 2020 2020 2020 2020 2279 6561 7222 3a20          "year": 
-00054060: 2232 3031 3622 2c0a 2020 2020 2020 2020  "2016",.        
+00053db0: 2020 226f 6c64 6b65 7973 223a 2022 222c    "oldkeys": "",
+00053dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00053dd0: 2020 2020 2020 2020 2022 6269 626b 6579           "bibkey
+00053de0: 223a 2022 4761 7269 617a 7a6f 3a32 3031  ": "Gariazzo:201
+00053df0: 3572 7261 222c 0a20 2020 2020 2020 2020  5rra",.         
+00053e00: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00053e10: 2022 7061 6765 7322 3a20 7522 3033 3330   "pages": u"0330
+00053e20: 3031 222c 0a20 2020 2020 2020 2020 2020  01",.           
+00053e30: 2020 2020 2020 2020 2020 2020 2022 6175               "au
+00053e40: 7468 6f72 223a 2022 4761 7269 617a 7a6f  thor": "Gariazzo
+00053e50: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00053e60: 2020 2020 2020 2020 2020 2022 7469 746c             "titl
+00053e70: 6522 3a20 227b 4c69 6768 7420 5374 6572  e": "{Light Ster
+00053e80: 696c 6520 4e65 7574 7269 6e6f 737d 222c  ile Neutrinos}",
+00053e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00053ea0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+00053eb0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00053ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053ed0: 2020 2020 2020 2264 6f69 223a 2022 3130        "doi": "10
+00053ee0: 2e31 3038 382f 3039 3534 2d33 3839 392f  .1088/0954-3899/
+00053ef0: 3433 2f33 2f30 3333 3030 3122 2c0a 2020  43/3/033001",.  
+00053f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053f10: 2020 2020 2020 2269 7362 6e22 3a20 4e6f        "isbn": No
+00053f20: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00053f30: 2020 2020 2020 2020 2020 2020 2261 6473              "ads
+00053f40: 223a 2022 3230 3135 4a50 6847 2e2e 2e34  ": "2015JPhG...4
+00053f50: 3363 3330 3031 4722 2c0a 2020 2020 2020  3c3001G",.      
+00053f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053f70: 2020 2270 7562 6461 7465 223a 2022 3230    "pubdate": "20
+00053f80: 3136 2d30 312d 3133 222c 0a20 2020 2020  16-01-13",.     
+00053f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053fa0: 2020 2022 6669 7273 7464 6174 6522 3a20     "firstdate": 
+00053fb0: 2232 3031 352d 3037 2d32 3922 2c0a 2020  "2015-07-29",.  
+00053fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053fd0: 2020 2020 2020 226a 6f75 726e 616c 223a        "journal":
+00053fe0: 2022 4a2e 5068 7973 2e47 222c 0a20 2020   "J.Phys.G",.   
+00053ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054000: 2020 2020 2022 6172 7869 7622 3a20 2231       "arxiv": "1
+00054010: 3530 372e 3038 3230 3422 2c0a 2020 2020  507.08204",.    
+00054020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054030: 2020 2020 2269 6422 3a20 2231 3338 3535      "id": "13855
+00054040: 3833 222c 0a20 2020 2020 2020 2020 2020  83",.           
+00054050: 2020 2020 2020 2020 2020 2020 2022 766f               "vo
+00054060: 6c75 6d65 223a 2022 3433 222c 0a20 2020  lume": "43",.   
 00054070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054080: 226f 6c64 6b65 7973 223a 2022 222c 0a20  "oldkeys": "",. 
-00054090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000540a0: 2020 2020 2020 2022 6269 626b 6579 223a         "bibkey":
-000540b0: 2022 4761 7269 617a 7a6f 3a32 3031 3572   "Gariazzo:2015r
-000540c0: 7261 222c 0a20 2020 2020 2020 2020 2020  ra",.           
-000540d0: 2020 2020 2020 2020 2020 2020 2023 2022               # "
-000540e0: 7061 6765 7322 3a20 7522 3033 3330 3031  pages": u"033001
-000540f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00054100: 2020 2020 2020 2020 2020 2022 6175 7468             "auth
-00054110: 6f72 223a 2022 4761 7269 617a 7a6f 222c  or": "Gariazzo",
-00054120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00054130: 2020 2020 2020 2020 2022 7469 746c 6522           "title"
-00054140: 3a20 227b 4c69 6768 7420 5374 6572 696c  : "{Light Steril
-00054150: 6520 4e65 7574 7269 6e6f 737d 222c 0a20  e Neutrinos}",. 
-00054160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054170: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-00054180: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
+00054080: 2020 2020 2022 6269 6274 6578 223a 2027       "bibtex": '
+00054090: 4041 7274 6963 6c65 7b47 6172 6961 7a7a  @Article{Gariazz
+000540a0: 6f3a 3230 3135 7272 612c 5c6e 6175 7468  o:2015rra,\nauth
+000540b0: 6f72 3d22 4761 7269 617a 7a6f 222c 270a  or="Gariazzo",'.
+000540c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000540d0: 2020 2020 2020 2020 2b20 275c 6e74 6974          + '\ntit
+000540e0: 6c65 3d22 7b4c 6967 6874 2053 7465 7269  le="{Light Steri
+000540f0: 6c65 204e 6575 7472 696e 6f73 7d22 5c6e  le Neutrinos}"\n
+00054100: 7d27 2c0a 2020 2020 2020 2020 2020 2020  }',.            
+00054110: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
+00054120: 7222 3a20 2232 3031 3622 2c0a 2020 2020  r": "2016",.    
+00054130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054140: 2020 2020 226f 6c64 6b65 7973 223a 2022      "oldkeys": "
+00054150: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00054160: 2020 2020 2020 2020 2020 2022 6269 626b             "bibk
+00054170: 6579 223a 2022 4761 7269 617a 7a6f 3a32  ey": "Gariazzo:2
+00054180: 3031 3572 7261 222c 0a20 2020 2020 2020  015rra",.       
 00054190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000541a0: 2020 2020 2264 6f69 223a 2022 3130 2e31      "doi": "10.1
-000541b0: 3038 382f 3039 3534 2d33 3839 392f 3433  088/0954-3899/43
-000541c0: 2f33 2f30 3333 3030 3122 2c0a 2020 2020  /3/033001",.    
-000541d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000541e0: 2020 2020 2269 7362 6e22 3a20 4e6f 6e65      "isbn": None
-000541f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00054200: 2020 2020 2020 2020 2020 2261 6473 223a            "ads":
-00054210: 2022 3230 3135 4a50 6847 2e2e 2e34 3363   "2015JPhG...43c
-00054220: 3330 3031 4722 2c0a 2020 2020 2020 2020  3001G",.        
-00054230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054240: 2270 7562 6461 7465 223a 2022 3230 3136  "pubdate": "2016
-00054250: 2d30 312d 3133 222c 0a20 2020 2020 2020  -01-13",.       
-00054260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054270: 2022 6669 7273 7464 6174 6522 3a20 2232   "firstdate": "2
-00054280: 3031 352d 3037 2d32 3922 2c0a 2020 2020  015-07-29",.    
-00054290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000542a0: 2020 2020 226a 6f75 726e 616c 223a 2022      "journal": "
-000542b0: 4a2e 5068 7973 2e47 222c 0a20 2020 2020  J.Phys.G",.     
+000541a0: 2022 7061 6765 7322 3a20 2230 3333 3030   "pages": "03300
+000541b0: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+000541c0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+000541d0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+000541e0: 2264 6f69 223a 2022 3130 2e31 3038 382f  "doi": "10.1088/
+000541f0: 3039 3534 2d33 3839 392f 3433 2f33 2f30  0954-3899/43/3/0
+00054200: 3333 3030 3122 2c20 2269 7362 6e22 3a20  33001", "isbn": 
+00054210: 4e6f 6e65 7d2c 0a20 2020 2020 2020 2020  None},.         
+00054220: 2020 2020 2020 2020 2020 207b 2264 6f69             {"doi
+00054230: 223a 2022 3130 2e31 3038 382f 3039 3534  ": "10.1088/0954
+00054240: 2d33 3839 392f 3433 2f33 2f30 3333 3030  -3899/43/3/03300
+00054250: 3122 2c20 2269 7362 6e22 3a20 4e6f 6e65  1", "isbn": None
+00054260: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00054270: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+00054280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054290: 2022 646f 6922 3a20 2231 302e 3130 3838   "doi": "10.1088
+000542a0: 2f30 3935 342d 3338 3939 2f34 332f 332f  /0954-3899/43/3/
+000542b0: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
 000542c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000542d0: 2020 2022 6172 7869 7622 3a20 2231 3530     "arxiv": "150
-000542e0: 372e 3038 3230 3422 2c0a 2020 2020 2020  7.08204",.      
+000542d0: 2022 6269 626b 6579 223a 2022 4761 7269   "bibkey": "Gari
+000542e0: 617a 7a6f 3a32 3031 3572 7261 222c 0a20  azzo:2015rra",. 
 000542f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054300: 2020 2269 6422 3a20 2231 3338 3535 3833    "id": "1385583
-00054310: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00054320: 2020 2020 2020 2020 2020 2022 766f 6c75             "volu
-00054330: 6d65 223a 2022 3433 222c 0a20 2020 2020  me": "43",.     
-00054340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054350: 2020 2022 6269 6274 6578 223a 2027 4041     "bibtex": '@A
-00054360: 7274 6963 6c65 7b47 6172 6961 7a7a 6f3a  rticle{Gariazzo:
-00054370: 3230 3135 7272 612c 5c6e 6175 7468 6f72  2015rra,\nauthor
-00054380: 3d22 4761 7269 617a 7a6f 222c 270a 2020  ="Gariazzo",'.  
+00054300: 2020 2020 2020 2022 6964 223a 2022 4761         "id": "Ga
+00054310: 7269 617a 7a6f 3a32 3031 3572 7261 222c  riazzo:2015rra",
+00054320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054330: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
+00054340: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+00054350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054360: 2020 2020 2020 2264 6f69 223a 2022 3130        "doi": "10
+00054370: 2e31 3038 382f 3039 3534 2d33 3839 392f  .1088/0954-3899/
+00054380: 3433 2f33 2f30 3333 3030 3122 2c0a 2020  43/3/033001",.  
 00054390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000543a0: 2020 2020 2020 2b20 275c 6e74 6974 6c65        + '\ntitle
-000543b0: 3d22 7b4c 6967 6874 2053 7465 7269 6c65  ="{Light Sterile
-000543c0: 204e 6575 7472 696e 6f73 7d22 5c6e 7d27   Neutrinos}"\n}'
-000543d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000543e0: 2020 2020 2020 2020 2020 2279 6561 7222            "year"
-000543f0: 3a20 2232 3031 3622 2c0a 2020 2020 2020  : "2016",.      
-00054400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054410: 2020 226f 6c64 6b65 7973 223a 2022 222c    "oldkeys": "",
-00054420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00054430: 2020 2020 2020 2020 2022 6269 626b 6579           "bibkey
-00054440: 223a 2022 4761 7269 617a 7a6f 3a32 3031  ": "Gariazzo:201
-00054450: 3572 7261 222c 0a20 2020 2020 2020 2020  5rra",.         
-00054460: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00054470: 7061 6765 7322 3a20 2230 3333 3030 3122  pages": "033001"
-00054480: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00054490: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-000544a0: 2020 2020 2020 2020 2020 2020 207b 2264               {"d
-000544b0: 6f69 223a 2022 3130 2e31 3038 382f 3039  oi": "10.1088/09
-000544c0: 3534 2d33 3839 392f 3433 2f33 2f30 3333  54-3899/43/3/033
-000544d0: 3030 3122 2c20 2269 7362 6e22 3a20 4e6f  001", "isbn": No
-000544e0: 6e65 7d2c 0a20 2020 2020 2020 2020 2020  ne},.           
-000544f0: 2020 2020 2020 2020 207b 2264 6f69 223a           {"doi":
-00054500: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
-00054510: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
-00054520: 2c20 2269 7362 6e22 3a20 4e6f 6e65 7d2c  , "isbn": None},
-00054530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00054540: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00054550: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00054560: 646f 6922 3a20 2231 302e 3130 3838 2f30  doi": "10.1088/0
-00054570: 3935 342d 3338 3939 2f34 332f 332f 3033  954-3899/43/3/03
-00054580: 3330 3031 222c 0a20 2020 2020 2020 2020  3001",.         
-00054590: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000545a0: 6269 626b 6579 223a 2022 4761 7269 617a  bibkey": "Gariaz
-000545b0: 7a6f 3a32 3031 3572 7261 222c 0a20 2020  zo:2015rra",.   
-000545c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000545d0: 2020 2020 2022 6964 223a 2022 4761 7269       "id": "Gari
-000545e0: 617a 7a6f 3a32 3031 3572 7261 222c 0a20  azzo:2015rra",. 
-000545f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054600: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-00054610: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00054620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054630: 2020 2020 2264 6f69 223a 2022 3130 2e31      "doi": "10.1
-00054640: 3038 382f 3039 3534 2d33 3839 392f 3433  088/0954-3899/43
-00054650: 2f33 2f30 3333 3030 3122 2c0a 2020 2020  /3/033001",.    
-00054660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054670: 2020 2020 2262 6962 6b65 7922 3a20 2247      "bibkey": "G
-00054680: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
-00054690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000546a0: 2020 2020 2020 2020 2020 2269 6422 3a20            "id": 
-000546b0: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
-000546c0: 6122 2c0a 2020 2020 2020 2020 2020 2020  a",.            
-000546d0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-000546e0: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-000546f0: 2020 2020 2020 2020 2020 2020 2020 6175                au
-00054700: 746f 7370 6563 3d54 7275 652c 0a20 2020  tospec=True,.   
-00054710: 2020 2020 2020 2020 2029 2061 7320 6d6f           ) as mo
-00054720: 636b 5f66 756e 6374 696f 6e3a 0a20 2020  ck_function:.   
-00054730: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00054740: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
-00054750: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-00054760: 6174 6549 6e66 6f46 726f 6d4f 4149 2822  ateInfoFromOAI("
-00054770: 6162 6322 2c20 7665 7262 6f73 653d 3229  abc", verbose=2)
-00054780: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00054790: 2020 6d6f 636b 5f66 756e 6374 696f 6e2e    mock_function.
-000547a0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-000547b0: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
-000547c0: 2020 2020 2020 2020 2020 2020 2070 6879               phy
-000547d0: 7342 6962 6c69 6f57 6562 2e77 6562 5365  sBiblioWeb.webSe
-000547e0: 6172 6368 5b22 696e 7370 6972 6522 5d2c  arch["inspire"],
-000547f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00054800: 2020 2020 2022 3132 3334 3522 2c0a 2020       "12345",.  
-00054810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054820: 2020 6269 6274 6578 3d4e 6f6e 652c 0a20    bibtex=None,. 
-00054830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054840: 2020 2072 6561 6443 6f6e 6665 7265 6e63     readConferenc
-00054850: 6554 6974 6c65 3d46 616c 7365 2c0a 2020  eTitle=False,.  
-00054860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054870: 2020 7665 7262 6f73 653d 322c 0a20 2020    verbose=2,.   
-00054880: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00054890: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000548a0: 656c 662e 6173 7365 7274 5472 7565 2873  elf.assertTrue(s
-000548b0: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
-000548c0: 6461 7465 496e 666f 4672 6f6d 4f41 4928  dateInfoFromOAI(
-000548d0: 2231 3233 3435 222c 2076 6572 626f 7365  "12345", verbose
-000548e0: 3d32 2929 0a20 2020 2020 2020 2020 2020  =2)).           
-000548f0: 2020 2020 206d 6f63 6b5f 6675 6e63 7469       mock_functi
-00054900: 6f6e 2e72 6573 6574 5f6d 6f63 6b28 290a  on.reset_mock().
-00054910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054920: 7769 7468 2070 6174 6368 2822 6c6f 6767  with patch("logg
-00054930: 696e 672e 4c6f 6767 6572 2e69 6e66 6f22  ing.Logger.info"
-00054940: 2920 6173 205f 693a 0a20 2020 2020 2020  ) as _i:.       
-00054950: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00054960: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
-00054970: 7465 496e 666f 4672 6f6d 4f41 4928 2231  teInfoFromOAI("1
-00054980: 3233 3435 222c 2076 6572 626f 7365 3d32  2345", verbose=2
-00054990: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000549a0: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
-000549b0: 616e 795f 6361 6c6c 2822 496e 7370 6972  any_call("Inspir
-000549c0: 6520 4f41 4920 696e 666f 2066 6f72 2031  e OAI info for 1
-000549d0: 3233 3435 2073 6176 6564 2e22 290a 2020  2345 saved.").  
-000549e0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-000549f0: 636b 5f66 756e 6374 696f 6e2e 6173 7365  ck_function.asse
-00054a00: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-00054a10: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
-00054a20: 2020 2020 2020 2020 2070 6879 7342 6962           physBib
-00054a30: 6c69 6f57 6562 2e77 6562 5365 6172 6368  lioWeb.webSearch
-00054a40: 5b22 696e 7370 6972 6522 5d2c 0a20 2020  ["inspire"],.   
-00054a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054a60: 2022 3132 3334 3522 2c0a 2020 2020 2020   "12345",.      
-00054a70: 2020 2020 2020 2020 2020 2020 2020 6269                bi
-00054a80: 6274 6578 3d4e 6f6e 652c 0a20 2020 2020  btex=None,.     
-00054a90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00054aa0: 6561 6443 6f6e 6665 7265 6e63 6554 6974  eadConferenceTit
-00054ab0: 6c65 3d46 616c 7365 2c0a 2020 2020 2020  le=False,.      
-00054ac0: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00054ad0: 7262 6f73 653d 322c 0a20 2020 2020 2020  rbose=2,.       
-00054ae0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00054af0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00054b00: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-00054b10: 2e70 4244 422e 6269 6273 2e67 6574 4279  .pBDB.bibs.getBy
-00054b20: 4269 626b 6579 2822 4761 7269 617a 7a6f  Bibkey("Gariazzo
-00054b30: 3a32 3031 3572 7261 2229 2c20 5b5d 290a  :2015rra"), []).
-00054b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054b50: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
-00054b60: 6e73 6572 7446 726f 6d42 6962 7465 7828  nsertFromBibtex(
-00054b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00054b80: 2020 2020 2027 4061 7274 6963 6c65 7b47       '@article{G
-00054b90: 6172 6961 7a7a 6f3a 3230 3135 7272 612c  ariazzo:2015rra,
-00054ba0: 5c6e 6172 7869 763d 2231 3530 372e 3038  \narxiv="1507.08
-00054bb0: 3230 3422 5c6e 7d27 0a20 2020 2020 2020  204"\n}'.       
-00054bc0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00054bd0: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-00054be0: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00054bf0: 6765 7442 7942 6962 6b65 7928 2247 6172  getByBibkey("Gar
-00054c00: 6961 7a7a 6f3a 3230 3135 7272 6122 295b  iazzo:2015rra")[
-00054c10: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-00054c20: 2020 2064 656c 2072 6573 5b22 6369 7461     del res["cita
-00054c30: 7469 6f6e 7322 5d0a 2020 2020 2020 2020  tions"].        
-00054c40: 2020 2020 2020 2020 6465 6c20 7265 735b          del res[
-00054c50: 2263 6974 6174 696f 6e73 5f6e 6f5f 7365  "citations_no_se
-00054c60: 6c66 225d 0a20 2020 2020 2020 2020 2020  lf"].           
-00054c70: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00054c80: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00054c90: 2020 2020 2020 2020 2020 2072 6573 2c0a             res,.
-00054ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054cb0: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-00054cc0: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-00054cd0: 6962 6b65 7922 3a20 2247 6172 6961 7a7a  ibkey": "Gariazz
-00054ce0: 6f3a 3230 3135 7272 6122 2c0a 2020 2020  o:2015rra",.    
-00054cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054d00: 2020 2020 2269 6e73 7069 7265 223a 204e      "inspire": N
-00054d10: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-00054d20: 2020 2020 2020 2020 2020 2020 2022 6172               "ar
-00054d30: 7869 7622 3a20 2231 3530 372e 3038 3230  xiv": "1507.0820
-00054d40: 3422 2c0a 2020 2020 2020 2020 2020 2020  4",.            
-00054d50: 2020 2020 2020 2020 2020 2020 2261 6473              "ads
-00054d60: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+000543a0: 2020 2020 2020 2262 6962 6b65 7922 3a20        "bibkey": 
+000543b0: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
+000543c0: 6122 2c0a 2020 2020 2020 2020 2020 2020  a",.            
+000543d0: 2020 2020 2020 2020 2020 2020 2269 6422              "id"
+000543e0: 3a20 2247 6172 6961 7a7a 6f3a 3230 3135  : "Gariazzo:2015
+000543f0: 7272 6122 2c0a 2020 2020 2020 2020 2020  rra",.          
+00054400: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00054410: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
+00054420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054430: 6175 746f 7370 6563 3d54 7275 652c 0a20  autospec=True,. 
+00054440: 2020 2020 2020 2020 2020 2029 2061 7320             ) as 
+00054450: 6d6f 636b 5f66 756e 6374 696f 6e3a 0a20  mock_function:. 
+00054460: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00054470: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+00054480: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
+00054490: 7064 6174 6549 6e66 6f46 726f 6d4f 4149  pdateInfoFromOAI
+000544a0: 2822 6162 6322 2c20 7665 7262 6f73 653d  ("abc", verbose=
+000544b0: 3229 290a 2020 2020 2020 2020 2020 2020  2)).            
+000544c0: 2020 2020 6d6f 636b 5f66 756e 6374 696f      mock_functio
+000544d0: 6e2e 6173 7365 7274 5f63 616c 6c65 645f  n.assert_called_
+000544e0: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
+000544f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00054500: 6879 7342 6962 6c69 6f57 6562 2e77 6562  hysBiblioWeb.web
+00054510: 5365 6172 6368 5b22 696e 7370 6972 6522  Search["inspire"
+00054520: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00054530: 2020 2020 2020 2022 3132 3334 3522 2c0a         "12345",.
+00054540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054550: 2020 2020 6269 6274 6578 3d4e 6f6e 652c      bibtex=None,
+00054560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054570: 2020 2020 2072 6561 6443 6f6e 6665 7265       readConfere
+00054580: 6e63 6554 6974 6c65 3d46 616c 7365 2c0a  nceTitle=False,.
+00054590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000545a0: 2020 2020 7665 7262 6f73 653d 322c 0a20      verbose=2,. 
+000545b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000545c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000545d0: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+000545e0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+000545f0: 7570 6461 7465 496e 666f 4672 6f6d 4f41  updateInfoFromOA
+00054600: 4928 2231 3233 3435 222c 2076 6572 626f  I("12345", verbo
+00054610: 7365 3d32 2929 0a20 2020 2020 2020 2020  se=2)).         
+00054620: 2020 2020 2020 206d 6f63 6b5f 6675 6e63         mock_func
+00054630: 7469 6f6e 2e72 6573 6574 5f6d 6f63 6b28  tion.reset_mock(
+00054640: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00054650: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
+00054660: 6767 696e 672e 4c6f 6767 6572 2e69 6e66  gging.Logger.inf
+00054670: 6f22 2920 6173 205f 693a 0a20 2020 2020  o") as _i:.     
+00054680: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00054690: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
+000546a0: 6461 7465 496e 666f 4672 6f6d 4f41 4928  dateInfoFromOAI(
+000546b0: 2231 3233 3435 222c 2076 6572 626f 7365  "12345", verbose
+000546c0: 3d32 290a 2020 2020 2020 2020 2020 2020  =2).            
+000546d0: 2020 2020 2020 2020 5f69 2e61 7373 6572          _i.asser
+000546e0: 745f 616e 795f 6361 6c6c 2822 496e 7370  t_any_call("Insp
+000546f0: 6972 6520 4f41 4920 696e 666f 2066 6f72  ire OAI info for
+00054700: 2031 3233 3435 2073 6176 6564 2e22 290a   12345 saved.").
+00054710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054720: 6d6f 636b 5f66 756e 6374 696f 6e2e 6173  mock_function.as
+00054730: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+00054740: 5f77 6974 6828 0a20 2020 2020 2020 2020  _with(.         
+00054750: 2020 2020 2020 2020 2020 2070 6879 7342             physB
+00054760: 6962 6c69 6f57 6562 2e77 6562 5365 6172  iblioWeb.webSear
+00054770: 6368 5b22 696e 7370 6972 6522 5d2c 0a20  ch["inspire"],. 
+00054780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054790: 2020 2022 3132 3334 3522 2c0a 2020 2020     "12345",.    
+000547a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000547b0: 6269 6274 6578 3d4e 6f6e 652c 0a20 2020  bibtex=None,.   
+000547c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000547d0: 2072 6561 6443 6f6e 6665 7265 6e63 6554   readConferenceT
+000547e0: 6974 6c65 3d46 616c 7365 2c0a 2020 2020  itle=False,.    
+000547f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054800: 7665 7262 6f73 653d 322c 0a20 2020 2020  verbose=2,.     
+00054810: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00054820: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00054830: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00054840: 6c66 2e70 4244 422e 6269 6273 2e67 6574  lf.pBDB.bibs.get
+00054850: 4279 4269 626b 6579 2822 4761 7269 617a  ByBibkey("Gariaz
+00054860: 7a6f 3a32 3031 3572 7261 2229 2c20 5b5d  zo:2015rra"), []
+00054870: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00054880: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00054890: 2e69 6e73 6572 7446 726f 6d42 6962 7465  .insertFromBibte
+000548a0: 7828 0a20 2020 2020 2020 2020 2020 2020  x(.             
+000548b0: 2020 2020 2020 2027 4061 7274 6963 6c65         '@article
+000548c0: 7b47 6172 6961 7a7a 6f3a 3230 3135 7272  {Gariazzo:2015rr
+000548d0: 612c 5c6e 6172 7869 763d 2231 3530 372e  a,\narxiv="1507.
+000548e0: 3038 3230 3422 5c6e 7d27 0a20 2020 2020  08204"\n}'.     
+000548f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00054900: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00054910: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
+00054920: 732e 6765 7442 7942 6962 6b65 7928 2247  s.getByBibkey("G
+00054930: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
+00054940: 295b 305d 0a20 2020 2020 2020 2020 2020  )[0].           
+00054950: 2020 2020 2064 656c 2072 6573 5b22 6369       del res["ci
+00054960: 7461 7469 6f6e 7322 5d0a 2020 2020 2020  tations"].      
+00054970: 2020 2020 2020 2020 2020 6465 6c20 7265            del re
+00054980: 735b 2263 6974 6174 696f 6e73 5f6e 6f5f  s["citations_no_
+00054990: 7365 6c66 225d 0a20 2020 2020 2020 2020  self"].         
+000549a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000549b0: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+000549c0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+000549d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000549e0: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+000549f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054a00: 2262 6962 6b65 7922 3a20 2247 6172 6961  "bibkey": "Garia
+00054a10: 7a7a 6f3a 3230 3135 7272 6122 2c0a 2020  zzo:2015rra",.  
+00054a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054a30: 2020 2020 2020 2269 6e73 7069 7265 223a        "inspire":
+00054a40: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+00054a50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00054a60: 6172 7869 7622 3a20 2231 3530 372e 3038  arxiv": "1507.08
+00054a70: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
+00054a80: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+00054a90: 6473 223a 204e 6f6e 652c 0a20 2020 2020  ds": None,.     
+00054aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054ab0: 2020 2022 7363 686f 6c61 7222 3a20 4e6f     "scholar": No
+00054ac0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00054ad0: 2020 2020 2020 2020 2020 2020 2264 6f69              "doi
+00054ae0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+00054af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054b00: 2022 6973 626e 223a 204e 6f6e 652c 0a20   "isbn": None,. 
+00054b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054b20: 2020 2020 2020 2022 7965 6172 223a 2032         "year": 2
+00054b30: 3031 352c 0a20 2020 2020 2020 2020 2020  015,.           
+00054b40: 2020 2020 2020 2020 2020 2020 2022 6c69               "li
+00054b50: 6e6b 223a 2022 2573 2f61 6273 2f31 3530  nk": "%s/abs/150
+00054b60: 372e 3038 3230 3422 2025 2070 6243 6f6e  7.08204" % pbCon
+00054b70: 6669 672e 6172 7869 7655 726c 2c0a 2020  fig.arxivUrl,.  
+00054b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054b90: 2020 2020 2020 2263 6f6d 6d65 6e74 7322        "comments"
+00054ba0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+00054bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054bc0: 226f 6c64 5f6b 6579 7322 3a20 4e6f 6e65  "old_keys": None
+00054bd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00054be0: 2020 2020 2020 2020 2020 2263 726f 7373            "cross
+00054bf0: 7265 6622 3a20 4e6f 6e65 2c0a 2020 2020  ref": None,.    
+00054c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054c10: 2020 2020 2262 6962 7465 7822 3a20 2240      "bibtex": "@
+00054c20: 4172 7469 636c 657b 4761 7269 617a 7a6f  Article{Gariazzo
+00054c30: 3a32 3031 3572 7261 2c5c 6e20 2020 2020  :2015rra,\n     
+00054c40: 2020 2020 220a 2020 2020 2020 2020 2020      ".          
+00054c50: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+00054c60: 2761 7278 6976 203d 2022 3135 3037 2e30  'arxiv = "1507.0
+00054c70: 3832 3034 222c 5c6e 7d27 2c0a 2020 2020  8204",\n}',.    
+00054c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054c90: 2020 2020 2266 6972 7374 6461 7465 223a      "firstdate":
+00054ca0: 2064 742c 0a20 2020 2020 2020 2020 2020   dt,.           
+00054cb0: 2020 2020 2020 2020 2020 2020 2022 7075               "pu
+00054cc0: 6264 6174 6522 3a20 2222 2c0a 2020 2020  bdate": "",.    
+00054cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054ce0: 2020 2020 2265 7870 5f70 6170 6572 223a      "exp_paper":
+00054cf0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+00054d00: 2020 2020 2020 2020 2020 2020 226c 6563              "lec
+00054d10: 7475 7265 223a 2030 2c0a 2020 2020 2020  ture": 0,.      
+00054d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054d30: 2020 2270 6864 5f74 6865 7369 7322 3a20    "phd_thesis": 
+00054d40: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+00054d50: 2020 2020 2020 2020 2020 2022 7265 7669             "revi
+00054d60: 6577 223a 2030 2c0a 2020 2020 2020 2020  ew": 0,.        
 00054d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054d80: 2022 7363 686f 6c61 7222 3a20 4e6f 6e65   "scholar": None
-00054d90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00054da0: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
-00054db0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00054dc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00054dd0: 6973 626e 223a 204e 6f6e 652c 0a20 2020  isbn": None,.   
+00054d80: 2270 726f 6365 6564 696e 6722 3a20 302c  "proceeding": 0,
+00054d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054da0: 2020 2020 2020 2020 2022 626f 6f6b 223a           "book":
+00054db0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+00054dc0: 2020 2020 2020 2020 2020 2020 226e 6f55              "noU
+00054dd0: 7064 6174 6522 3a20 302c 0a20 2020 2020  pdate": 0,.     
 00054de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054df0: 2020 2020 2022 7965 6172 223a 2032 3031       "year": 201
-00054e00: 352c 0a20 2020 2020 2020 2020 2020 2020  5,.             
-00054e10: 2020 2020 2020 2020 2020 2022 6c69 6e6b             "link
-00054e20: 223a 2022 2573 2f61 6273 2f31 3530 372e  ": "%s/abs/1507.
-00054e30: 3038 3230 3422 2025 2070 6243 6f6e 6669  08204" % pbConfi
-00054e40: 672e 6172 7869 7655 726c 2c0a 2020 2020  g.arxivUrl,.    
-00054e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054e60: 2020 2020 2263 6f6d 6d65 6e74 7322 3a20      "comments": 
-00054e70: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00054e80: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-00054e90: 6c64 5f6b 6579 7322 3a20 4e6f 6e65 2c0a  ld_keys": None,.
-00054ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054eb0: 2020 2020 2020 2020 2263 726f 7373 7265          "crossre
-00054ec0: 6622 3a20 4e6f 6e65 2c0a 2020 2020 2020  f": None,.      
-00054ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054ee0: 2020 2262 6962 7465 7822 3a20 2240 4172    "bibtex": "@Ar
-00054ef0: 7469 636c 657b 4761 7269 617a 7a6f 3a32  ticle{Gariazzo:2
-00054f00: 3031 3572 7261 2c5c 6e20 2020 2020 2020  015rra,\n       
-00054f10: 2020 220a 2020 2020 2020 2020 2020 2020    ".            
-00054f20: 2020 2020 2020 2020 2020 2020 2b20 2761              + 'a
-00054f30: 7278 6976 203d 2022 3135 3037 2e30 3832  rxiv = "1507.082
-00054f40: 3034 222c 5c6e 7d27 2c0a 2020 2020 2020  04",\n}',.      
-00054f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054f60: 2020 2266 6972 7374 6461 7465 223a 2064    "firstdate": d
-00054f70: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00054f80: 2020 2020 2020 2020 2020 2022 7075 6264             "pubd
-00054f90: 6174 6522 3a20 2222 2c0a 2020 2020 2020  ate": "",.      
-00054fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054fb0: 2020 2265 7870 5f70 6170 6572 223a 2030    "exp_paper": 0
-00054fc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00054fd0: 2020 2020 2020 2020 2020 226c 6563 7475            "lectu
-00054fe0: 7265 223a 2030 2c0a 2020 2020 2020 2020  re": 0,.        
+00054df0: 2020 2022 6d61 726b 7322 3a20 2222 2c0a     "marks": "",.
+00054e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054e10: 2020 2020 2020 2020 2261 6273 7472 6163          "abstrac
+00054e20: 7422 3a20 4e6f 6e65 2c0a 2020 2020 2020  t": None,.      
+00054e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054e40: 2020 2262 6962 7465 7844 6963 7422 3a20    "bibtexDict": 
+00054e50: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00054e60: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+00054e70: 7278 6976 223a 2022 3135 3037 2e30 3832  rxiv": "1507.082
+00054e80: 3034 222c 0a20 2020 2020 2020 2020 2020  04",.           
+00054e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054ea0: 2022 454e 5452 5954 5950 4522 3a20 2261   "ENTRYTYPE": "a
+00054eb0: 7274 6963 6c65 222c 0a20 2020 2020 2020  rticle",.       
+00054ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054ed0: 2020 2020 2022 4944 223a 2022 4761 7269       "ID": "Gari
+00054ee0: 617a 7a6f 3a32 3031 3572 7261 222c 0a20  azzo:2015rra",. 
+00054ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054f00: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00054f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054f20: 2020 2274 6974 6c65 223a 2022 222c 0a20    "title": "",. 
+00054f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054f40: 2020 2020 2020 2022 6a6f 7572 6e61 6c22         "journal"
+00054f50: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00054f60: 2020 2020 2020 2020 2020 2020 2020 2276                "v
+00054f70: 6f6c 756d 6522 3a20 2222 2c0a 2020 2020  olume": "",.    
+00054f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054f90: 2020 2020 226e 756d 6265 7222 3a20 2222      "number": ""
+00054fa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00054fb0: 2020 2020 2020 2020 2020 2270 6167 6573            "pages
+00054fc0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+00054fd0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00054fe0: 7075 626c 6973 6865 6422 3a20 2222 2c0a  published": "",.
 00054ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055000: 2270 6864 5f74 6865 7369 7322 3a20 302c  "phd_thesis": 0,
-00055010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00055020: 2020 2020 2020 2020 2022 7265 7669 6577           "review
-00055030: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
-00055040: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-00055050: 726f 6365 6564 696e 6722 3a20 302c 0a20  roceeding": 0,. 
-00055060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055070: 2020 2020 2020 2022 626f 6f6b 223a 2030         "book": 0
-00055080: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00055090: 2020 2020 2020 2020 2020 226e 6f55 7064            "noUpd
-000550a0: 6174 6522 3a20 302c 0a20 2020 2020 2020  ate": 0,.       
-000550b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000550c0: 2022 6d61 726b 7322 3a20 2222 2c0a 2020   "marks": "",.  
-000550d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000550e0: 2020 2020 2020 2261 6273 7472 6163 7422        "abstract"
-000550f0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-00055100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055110: 2262 6962 7465 7844 6963 7422 3a20 7b0a  "bibtexDict": {.
-00055120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055130: 2020 2020 2020 2020 2020 2020 2261 7278              "arx
-00055140: 6976 223a 2022 3135 3037 2e30 3832 3034  iv": "1507.08204
-00055150: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00055160: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00055170: 454e 5452 5954 5950 4522 3a20 2261 7274  ENTRYTYPE": "art
-00055180: 6963 6c65 222c 0a20 2020 2020 2020 2020  icle",.         
-00055190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000551a0: 2020 2022 4944 223a 2022 4761 7269 617a     "ID": "Gariaz
-000551b0: 7a6f 3a32 3031 3572 7261 222c 0a20 2020  zo:2015rra",.   
-000551c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000551d0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-000551e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000551f0: 2274 6974 6c65 223a 2022 222c 0a20 2020  "title": "",.   
-00055200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055210: 2020 2020 2022 6a6f 7572 6e61 6c22 3a20       "journal": 
-00055220: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-00055230: 2020 2020 2020 2020 2020 2020 2276 6f6c              "vol
-00055240: 756d 6522 3a20 2222 2c0a 2020 2020 2020  ume": "",.      
-00055250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055260: 2020 226e 756d 6265 7222 3a20 2222 2c0a    "number": "",.
-00055270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055280: 2020 2020 2020 2020 2270 6167 6573 223a          "pages":
-00055290: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-000552a0: 2020 2020 2020 2020 2020 2020 2022 7075               "pu
-000552b0: 626c 6973 6865 6422 3a20 2222 2c0a 2020  blished": "",.  
-000552c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000552d0: 2020 2020 2020 2261 7574 686f 7222 3a20        "author": 
-000552e0: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-000552f0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-00055300: 6469 6374 223a 207b 0a20 2020 2020 2020  dict": {.       
-00055310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055320: 2020 2020 2022 6172 7869 7622 3a20 2231       "arxiv": "1
-00055330: 3530 372e 3038 3230 3422 2c0a 2020 2020  507.08204",.    
-00055340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055350: 2020 2020 2020 2020 2245 4e54 5259 5459          "ENTRYTY
-00055360: 5045 223a 2022 6172 7469 636c 6522 2c0a  PE": "article",.
-00055370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055380: 2020 2020 2020 2020 2020 2020 2249 4422              "ID"
-00055390: 3a20 2247 6172 6961 7a7a 6f3a 3230 3135  : "Gariazzo:2015
-000553a0: 7272 6122 2c0a 2020 2020 2020 2020 2020  rra",.          
-000553b0: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-000553c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000553d0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-000553e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000553f0: 2020 2020 2020 2020 2020 6d6f 636b 5f66            mock_f
-00055400: 756e 6374 696f 6e2e 7265 7365 745f 6d6f  unction.reset_mo
-00055410: 636b 2829 0a20 2020 2020 2020 2020 2020  ck().           
-00055420: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00055430: 6962 732e 7570 6461 7465 496e 666f 4672  ibs.updateInfoFr
-00055440: 6f6d 4f41 4928 0a20 2020 2020 2020 2020  omOAI(.         
-00055450: 2020 2020 2020 2020 2020 2022 3132 3334             "1234
-00055460: 3522 2c0a 2020 2020 2020 2020 2020 2020  5",.            
-00055470: 2020 2020 2020 2020 6269 6274 6578 3d22          bibtex="
-00055480: 4061 7274 6963 6c65 7b47 6172 6961 7a7a  @article{Gariazz
-00055490: 6f3a 3230 3135 7272 612c 5c6e 2220 2b20  o:2015rra,\n" + 
-000554a0: 2761 7278 6976 3d22 3135 3037 2e30 3832  'arxiv="1507.082
-000554b0: 3034 225c 6e7d 272c 0a20 2020 2020 2020  04"\n}',.       
-000554c0: 2020 2020 2020 2020 2020 2020 2076 6572               ver
-000554d0: 626f 7365 3d32 2c0a 2020 2020 2020 2020  bose=2,.        
-000554e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000554f0: 2020 2020 2020 2020 2020 6d6f 636b 5f66            mock_f
-00055500: 756e 6374 696f 6e2e 6173 7365 7274 5f63  unction.assert_c
-00055510: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00055520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00055530: 2020 2020 2070 6879 7342 6962 6c69 6f57       physBiblioW
-00055540: 6562 2e77 6562 5365 6172 6368 5b22 696e  eb.webSearch["in
-00055550: 7370 6972 6522 5d2c 0a20 2020 2020 2020  spire"],.       
-00055560: 2020 2020 2020 2020 2020 2020 2022 3132               "12
-00055570: 3334 3522 2c0a 2020 2020 2020 2020 2020  345",.          
-00055580: 2020 2020 2020 2020 2020 6269 6274 6578            bibtex
-00055590: 3d22 4061 7274 6963 6c65 7b47 6172 6961  ="@article{Garia
-000555a0: 7a7a 6f3a 3230 3135 7272 612c 5c6e 2220  zzo:2015rra,\n" 
-000555b0: 2b20 2761 7278 6976 3d22 3135 3037 2e30  + 'arxiv="1507.0
-000555c0: 3832 3034 225c 6e7d 272c 0a20 2020 2020  8204"\n}',.     
-000555d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000555e0: 6561 6443 6f6e 6665 7265 6e63 6554 6974  eadConferenceTit
-000555f0: 6c65 3d46 616c 7365 2c0a 2020 2020 2020  le=False,.      
-00055600: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00055610: 7262 6f73 653d 322c 0a20 2020 2020 2020  rbose=2,.       
-00055620: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00055630: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-00055640: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
-00055650: 6765 7442 7942 6962 6b65 7928 2247 6172  getByBibkey("Gar
-00055660: 6961 7a7a 6f3a 3230 3135 7272 6122 295b  iazzo:2015rra")[
-00055670: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-00055680: 2020 2064 656c 2072 6573 5b22 6369 7461     del res["cita
-00055690: 7469 6f6e 7322 5d0a 2020 2020 2020 2020  tions"].        
-000556a0: 2020 2020 2020 2020 6465 6c20 7265 735b          del res[
-000556b0: 2263 6974 6174 696f 6e73 5f6e 6f5f 7365  "citations_no_se
-000556c0: 6c66 225d 0a20 2020 2020 2020 2020 2020  lf"].           
-000556d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000556e0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-000556f0: 2020 2020 2020 2020 2020 2072 6573 2c0a             res,.
-00055700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055710: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
-00055720: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-00055730: 6962 6b65 7922 3a20 2247 6172 6961 7a7a  ibkey": "Gariazz
-00055740: 6f3a 3230 3135 7272 6122 2c0a 2020 2020  o:2015rra",.    
-00055750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055760: 2020 2020 2269 6e73 7069 7265 223a 2022      "inspire": "
-00055770: 3133 3835 3538 3322 2c0a 2020 2020 2020  1385583",.      
-00055780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055790: 2020 2261 7278 6976 223a 2022 3135 3037    "arxiv": "1507
-000557a0: 2e30 3832 3034 222c 0a20 2020 2020 2020  .08204",.       
-000557b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000557c0: 2022 6164 7322 3a20 2232 3031 354a 5068   "ads": "2015JPh
-000557d0: 472e 2e2e 3433 6333 3030 3147 222c 0a20  G...43c3001G",. 
-000557e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000557f0: 2020 2020 2020 2022 7363 686f 6c61 7222         "scholar"
-00055800: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-00055810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055820: 2264 6f69 223a 2022 3130 2e31 3038 382f  "doi": "10.1088/
-00055830: 3039 3534 2d33 3839 392f 3433 2f33 2f30  0954-3899/43/3/0
-00055840: 3333 3030 3122 2c0a 2020 2020 2020 2020  33001",.        
+00055000: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
+00055010: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00055020: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+00055030: 6962 6469 6374 223a 207b 0a20 2020 2020  ibdict": {.     
+00055040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055050: 2020 2020 2020 2022 6172 7869 7622 3a20         "arxiv": 
+00055060: 2231 3530 372e 3038 3230 3422 2c0a 2020  "1507.08204",.  
+00055070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055080: 2020 2020 2020 2020 2020 2245 4e54 5259            "ENTRY
+00055090: 5459 5045 223a 2022 6172 7469 636c 6522  TYPE": "article"
+000550a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000550b0: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+000550c0: 4422 3a20 2247 6172 6961 7a7a 6f3a 3230  D": "Gariazzo:20
+000550d0: 3135 7272 6122 2c0a 2020 2020 2020 2020  15rra",.        
+000550e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000550f0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00055100: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00055110: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00055120: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+00055130: 5f66 756e 6374 696f 6e2e 7265 7365 745f  _function.reset_
+00055140: 6d6f 636b 2829 0a20 2020 2020 2020 2020  mock().         
+00055150: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00055160: 2e62 6962 732e 7570 6461 7465 496e 666f  .bibs.updateInfo
+00055170: 4672 6f6d 4f41 4928 0a20 2020 2020 2020  FromOAI(.       
+00055180: 2020 2020 2020 2020 2020 2020 2022 3132               "12
+00055190: 3334 3522 2c0a 2020 2020 2020 2020 2020  345",.          
+000551a0: 2020 2020 2020 2020 2020 6269 6274 6578            bibtex
+000551b0: 3d22 4061 7274 6963 6c65 7b47 6172 6961  ="@article{Garia
+000551c0: 7a7a 6f3a 3230 3135 7272 612c 5c6e 2220  zzo:2015rra,\n" 
+000551d0: 2b20 2761 7278 6976 3d22 3135 3037 2e30  + 'arxiv="1507.0
+000551e0: 3832 3034 225c 6e7d 272c 0a20 2020 2020  8204"\n}',.     
+000551f0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00055200: 6572 626f 7365 3d32 2c0a 2020 2020 2020  erbose=2,.      
+00055210: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00055220: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+00055230: 5f66 756e 6374 696f 6e2e 6173 7365 7274  _function.assert
+00055240: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+00055250: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
+00055260: 2020 2020 2020 2070 6879 7342 6962 6c69         physBibli
+00055270: 6f57 6562 2e77 6562 5365 6172 6368 5b22  oWeb.webSearch["
+00055280: 696e 7370 6972 6522 5d2c 0a20 2020 2020  inspire"],.     
+00055290: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000552a0: 3132 3334 3522 2c0a 2020 2020 2020 2020  12345",.        
+000552b0: 2020 2020 2020 2020 2020 2020 6269 6274              bibt
+000552c0: 6578 3d22 4061 7274 6963 6c65 7b47 6172  ex="@article{Gar
+000552d0: 6961 7a7a 6f3a 3230 3135 7272 612c 5c6e  iazzo:2015rra,\n
+000552e0: 2220 2b20 2761 7278 6976 3d22 3135 3037  " + 'arxiv="1507
+000552f0: 2e30 3832 3034 225c 6e7d 272c 0a20 2020  .08204"\n}',.   
+00055300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055310: 2072 6561 6443 6f6e 6665 7265 6e63 6554   readConferenceT
+00055320: 6974 6c65 3d46 616c 7365 2c0a 2020 2020  itle=False,.    
+00055330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055340: 7665 7262 6f73 653d 322c 0a20 2020 2020  verbose=2,.     
+00055350: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00055360: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00055370: 203d 2073 656c 662e 7042 4442 2e62 6962   = self.pBDB.bib
+00055380: 732e 6765 7442 7942 6962 6b65 7928 2247  s.getByBibkey("G
+00055390: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
+000553a0: 295b 305d 0a20 2020 2020 2020 2020 2020  )[0].           
+000553b0: 2020 2020 2064 656c 2072 6573 5b22 6369       del res["ci
+000553c0: 7461 7469 6f6e 7322 5d0a 2020 2020 2020  tations"].      
+000553d0: 2020 2020 2020 2020 2020 6465 6c20 7265            del re
+000553e0: 735b 2263 6974 6174 696f 6e73 5f6e 6f5f  s["citations_no_
+000553f0: 7365 6c66 225d 0a20 2020 2020 2020 2020  self"].         
+00055400: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00055410: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
+00055420: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00055430: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00055440: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
+00055450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055460: 2262 6962 6b65 7922 3a20 2247 6172 6961  "bibkey": "Garia
+00055470: 7a7a 6f3a 3230 3135 7272 6122 2c0a 2020  zzo:2015rra",.  
+00055480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055490: 2020 2020 2020 2269 6e73 7069 7265 223a        "inspire":
+000554a0: 2022 3133 3835 3538 3322 2c0a 2020 2020   "1385583",.    
+000554b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000554c0: 2020 2020 2261 7278 6976 223a 2022 3135      "arxiv": "15
+000554d0: 3037 2e30 3832 3034 222c 0a20 2020 2020  07.08204",.     
+000554e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000554f0: 2020 2022 6164 7322 3a20 2232 3031 354a     "ads": "2015J
+00055500: 5068 472e 2e2e 3433 6333 3030 3147 222c  PhG...43c3001G",
+00055510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00055520: 2020 2020 2020 2020 2022 7363 686f 6c61           "schola
+00055530: 7222 3a20 4e6f 6e65 2c0a 2020 2020 2020  r": None,.      
+00055540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055550: 2020 2264 6f69 223a 2022 3130 2e31 3038    "doi": "10.108
+00055560: 382f 3039 3534 2d33 3839 392f 3433 2f33  8/0954-3899/43/3
+00055570: 2f30 3333 3030 3122 2c0a 2020 2020 2020  /033001",.      
+00055580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055590: 2020 2269 7362 6e22 3a20 4e6f 6e65 2c0a    "isbn": None,.
+000555a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000555b0: 2020 2020 2020 2020 2279 6561 7222 3a20          "year": 
+000555c0: 2232 3031 3622 2c0a 2020 2020 2020 2020  "2016",.        
+000555d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000555e0: 226c 696e 6b22 3a20 2225 732f 6162 732f  "link": "%s/abs/
+000555f0: 3135 3037 2e30 3832 3034 2220 2520 7062  1507.08204" % pb
+00055600: 436f 6e66 6967 2e61 7278 6976 5572 6c2c  Config.arxivUrl,
+00055610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00055620: 2020 2020 2020 2020 2022 636f 6d6d 656e           "commen
+00055630: 7473 223a 204e 6f6e 652c 0a20 2020 2020  ts": None,.     
+00055640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055650: 2020 2022 6f6c 645f 6b65 7973 223a 204e     "old_keys": N
+00055660: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00055670: 2020 2020 2020 2020 2020 2020 2022 6372               "cr
+00055680: 6f73 7372 6566 223a 204e 6f6e 652c 0a20  ossref": None,. 
+00055690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000556a0: 2020 2020 2020 2022 6269 6274 6578 223a         "bibtex":
+000556b0: 2022 4041 7274 6963 6c65 7b47 6172 6961   "@Article{Garia
+000556c0: 7a7a 6f3a 3230 3135 7272 612c 5c6e 220a  zzo:2015rra,\n".
+000556d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000556e0: 2020 2020 2020 2020 2b20 2720 2020 2020          + '     
+000556f0: 2020 2020 2079 6561 7220 3d20 2232 3031       year = "201
+00055700: 3622 2c5c 6e27 0a20 2020 2020 2020 2020  6",\n'.         
+00055710: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+00055720: 2027 2020 2020 2020 2020 6570 7269 6e74   '        eprint
+00055730: 203d 2022 3135 3037 2e30 3832 3034 222c   = "1507.08204",
+00055740: 5c6e 270a 2020 2020 2020 2020 2020 2020  \n'.            
+00055750: 2020 2020 2020 2020 2020 2020 2b20 2720              + ' 
+00055760: 2020 2020 2020 2020 2020 646f 6920 3d20            doi = 
+00055770: 2231 302e 3130 3838 2f30 3935 342d 3338  "10.1088/0954-38
+00055780: 3939 2f34 332f 332f 3033 3330 3031 222c  99/43/3/033001",
+00055790: 5c6e 7d27 2c0a 2020 2020 2020 2020 2020  \n}',.          
+000557a0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+000557b0: 6972 7374 6461 7465 223a 2022 3230 3135  irstdate": "2015
+000557c0: 2d30 372d 3239 222c 0a20 2020 2020 2020  -07-29",.       
+000557d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000557e0: 2022 7075 6264 6174 6522 3a20 2232 3031   "pubdate": "201
+000557f0: 362d 3031 2d31 3322 2c0a 2020 2020 2020  6-01-13",.      
+00055800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055810: 2020 2265 7870 5f70 6170 6572 223a 2030    "exp_paper": 0
+00055820: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00055830: 2020 2020 2020 2020 2020 226c 6563 7475            "lectu
+00055840: 7265 223a 2030 2c0a 2020 2020 2020 2020  re": 0,.        
 00055850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055860: 2269 7362 6e22 3a20 4e6f 6e65 2c0a 2020  "isbn": None,.  
-00055870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055880: 2020 2020 2020 2279 6561 7222 3a20 2232        "year": "2
-00055890: 3031 3622 2c0a 2020 2020 2020 2020 2020  016",.          
-000558a0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-000558b0: 696e 6b22 3a20 2225 732f 6162 732f 3135  ink": "%s/abs/15
-000558c0: 3037 2e30 3832 3034 2220 2520 7062 436f  07.08204" % pbCo
-000558d0: 6e66 6967 2e61 7278 6976 5572 6c2c 0a20  nfig.arxivUrl,. 
-000558e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000558f0: 2020 2020 2020 2022 636f 6d6d 656e 7473         "comments
-00055900: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+00055860: 2270 6864 5f74 6865 7369 7322 3a20 302c  "phd_thesis": 0,
+00055870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00055880: 2020 2020 2020 2020 2022 7265 7669 6577           "review
+00055890: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
+000558a0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+000558b0: 726f 6365 6564 696e 6722 3a20 302c 0a20  roceeding": 0,. 
+000558c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000558d0: 2020 2020 2020 2022 626f 6f6b 223a 2030         "book": 0
+000558e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000558f0: 2020 2020 2020 2020 2020 226e 6f55 7064            "noUpd
+00055900: 6174 6522 3a20 302c 0a20 2020 2020 2020  ate": 0,.       
 00055910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055920: 2022 6f6c 645f 6b65 7973 223a 204e 6f6e   "old_keys": Non
-00055930: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00055940: 2020 2020 2020 2020 2020 2022 6372 6f73             "cros
-00055950: 7372 6566 223a 204e 6f6e 652c 0a20 2020  sref": None,.   
+00055920: 2022 6d61 726b 7322 3a20 2222 2c0a 2020   "marks": "",.  
+00055930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055940: 2020 2020 2020 2261 6273 7472 6163 7422        "abstract"
+00055950: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
 00055960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055970: 2020 2020 2022 6269 6274 6578 223a 2022       "bibtex": "
-00055980: 4041 7274 6963 6c65 7b47 6172 6961 7a7a  @Article{Gariazz
-00055990: 6f3a 3230 3135 7272 612c 5c6e 220a 2020  o:2015rra,\n".  
-000559a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000559b0: 2020 2020 2020 2b20 2720 2020 2020 2020        + '       
-000559c0: 2020 2079 6561 7220 3d20 2232 3031 3622     year = "2016"
-000559d0: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
-000559e0: 2020 2020 2020 2020 2020 2020 202b 2027               + '
-000559f0: 2020 2020 2020 2020 6570 7269 6e74 203d          eprint =
-00055a00: 2022 3135 3037 2e30 3832 3034 222c 5c6e   "1507.08204",\n
-00055a10: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00055a20: 2020 2020 2020 2020 2020 2b20 2720 2020            + '   
-00055a30: 2020 2020 2020 2020 646f 6920 3d20 2231          doi = "1
-00055a40: 302e 3130 3838 2f30 3935 342d 3338 3939  0.1088/0954-3899
-00055a50: 2f34 332f 332f 3033 3330 3031 222c 5c6e  /43/3/033001",\n
-00055a60: 7d27 2c0a 2020 2020 2020 2020 2020 2020  }',.            
-00055a70: 2020 2020 2020 2020 2020 2020 2266 6972              "fir
-00055a80: 7374 6461 7465 223a 2022 3230 3135 2d30  stdate": "2015-0
-00055a90: 372d 3239 222c 0a20 2020 2020 2020 2020  7-29",.         
-00055aa0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00055ab0: 7075 6264 6174 6522 3a20 2232 3031 362d  pubdate": "2016-
-00055ac0: 3031 2d31 3322 2c0a 2020 2020 2020 2020  01-13",.        
+00055970: 2262 6962 7465 7844 6963 7422 3a20 7b0a  "bibtexDict": {.
+00055980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055990: 2020 2020 2020 2020 2020 2020 2265 7072              "epr
+000559a0: 696e 7422 3a20 2231 3530 372e 3038 3230  int": "1507.0820
+000559b0: 3422 2c0a 2020 2020 2020 2020 2020 2020  4",.            
+000559c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000559d0: 2264 6f69 223a 2022 3130 2e31 3038 382f  "doi": "10.1088/
+000559e0: 3039 3534 2d33 3839 392f 3433 2f33 2f30  0954-3899/43/3/0
+000559f0: 3333 3030 3122 2c0a 2020 2020 2020 2020  33001",.        
+00055a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055a10: 2020 2020 2245 4e54 5259 5459 5045 223a      "ENTRYTYPE":
+00055a20: 2022 6172 7469 636c 6522 2c0a 2020 2020   "article",.    
+00055a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055a40: 2020 2020 2020 2020 2249 4422 3a20 2247          "ID": "G
+00055a50: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
+00055a60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00055a70: 2020 2020 2020 2020 2020 2020 2020 2279                "y
+00055a80: 6561 7222 3a20 2232 3031 3622 2c0a 2020  ear": "2016",.  
+00055a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055aa0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00055ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055ac0: 2022 7469 746c 6522 3a20 2222 2c0a 2020   "title": "",.  
 00055ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ae0: 2265 7870 5f70 6170 6572 223a 2030 2c0a  "exp_paper": 0,.
-00055af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055b00: 2020 2020 2020 2020 226c 6563 7475 7265          "lecture
-00055b10: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
-00055b20: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-00055b30: 6864 5f74 6865 7369 7322 3a20 302c 0a20  hd_thesis": 0,. 
-00055b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055b50: 2020 2020 2020 2022 7265 7669 6577 223a         "review":
-00055b60: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-00055b70: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
-00055b80: 6365 6564 696e 6722 3a20 302c 0a20 2020  ceeding": 0,.   
+00055ae0: 2020 2020 2020 226a 6f75 726e 616c 223a        "journal":
+00055af0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00055b00: 2020 2020 2020 2020 2020 2020 2022 766f               "vo
+00055b10: 6c75 6d65 223a 2022 222c 0a20 2020 2020  lume": "",.     
+00055b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055b30: 2020 2022 6e75 6d62 6572 223a 2022 222c     "number": "",
+00055b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00055b50: 2020 2020 2020 2020 2022 7061 6765 7322           "pages"
+00055b60: 3a20 2222 2c0a 2020 2020 2020 2020 2020  : "",.          
+00055b70: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00055b80: 7562 6c69 7368 6564 223a 2022 222c 0a20  ublished": "",. 
 00055b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ba0: 2020 2020 2022 626f 6f6b 223a 2030 2c0a       "book": 0,.
-00055bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055bc0: 2020 2020 2020 2020 226e 6f55 7064 6174          "noUpdat
-00055bd0: 6522 3a20 302c 0a20 2020 2020 2020 2020  e": 0,.         
-00055be0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00055bf0: 6d61 726b 7322 3a20 2222 2c0a 2020 2020  marks": "",.    
-00055c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055c10: 2020 2020 2261 6273 7472 6163 7422 3a20      "abstract": 
-00055c20: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00055c30: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-00055c40: 6962 7465 7844 6963 7422 3a20 7b0a 2020  ibtexDict": {.  
-00055c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055c60: 2020 2020 2020 2020 2020 2265 7072 696e            "eprin
-00055c70: 7422 3a20 2231 3530 372e 3038 3230 3422  t": "1507.08204"
-00055c80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00055c90: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-00055ca0: 6f69 223a 2022 3130 2e31 3038 382f 3039  oi": "10.1088/09
-00055cb0: 3534 2d33 3839 392f 3433 2f33 2f30 3333  54-3899/43/3/033
-00055cc0: 3030 3122 2c0a 2020 2020 2020 2020 2020  001",.          
-00055cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ce0: 2020 2245 4e54 5259 5459 5045 223a 2022    "ENTRYTYPE": "
-00055cf0: 6172 7469 636c 6522 2c0a 2020 2020 2020  article",.      
-00055d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055d10: 2020 2020 2020 2249 4422 3a20 2247 6172        "ID": "Gar
-00055d20: 6961 7a7a 6f3a 3230 3135 7272 6122 2c0a  iazzo:2015rra",.
-00055d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055d40: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
-00055d50: 7222 3a20 2232 3031 3622 2c0a 2020 2020  r": "2016",.    
-00055d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055d70: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-00055d80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00055d90: 7469 746c 6522 3a20 2222 2c0a 2020 2020  title": "",.    
-00055da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055db0: 2020 2020 226a 6f75 726e 616c 223a 2022      "journal": "
-00055dc0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00055dd0: 2020 2020 2020 2020 2020 2022 766f 6c75             "volu
-00055de0: 6d65 223a 2022 222c 0a20 2020 2020 2020  me": "",.       
-00055df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055e00: 2022 6e75 6d62 6572 223a 2022 222c 0a20   "number": "",. 
-00055e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055e20: 2020 2020 2020 2022 7061 6765 7322 3a20         "pages": 
-00055e30: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
-00055e40: 2020 2020 2020 2020 2020 2020 2270 7562              "pub
-00055e50: 6c69 7368 6564 223a 2022 222c 0a20 2020  lished": "",.   
-00055e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055e70: 2020 2020 2022 6175 7468 6f72 223a 2022       "author": "
-00055e80: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00055e90: 2020 2020 2020 2020 2020 2022 6269 6264             "bibd
-00055ea0: 6963 7422 3a20 7b0a 2020 2020 2020 2020  ict": {.        
-00055eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ec0: 2020 2020 2265 7072 696e 7422 3a20 2231      "eprint": "1
-00055ed0: 3530 372e 3038 3230 3422 2c0a 2020 2020  507.08204",.    
-00055ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ef0: 2020 2020 2020 2020 2264 6f69 223a 2022          "doi": "
-00055f00: 3130 2e31 3038 382f 3039 3534 2d33 3839  10.1088/0954-389
-00055f10: 392f 3433 2f33 2f30 3333 3030 3122 2c0a  9/43/3/033001",.
-00055f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055f30: 2020 2020 2020 2020 2020 2020 2245 4e54              "ENT
-00055f40: 5259 5459 5045 223a 2022 6172 7469 636c  RYTYPE": "articl
-00055f50: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00055f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055f70: 2249 4422 3a20 2247 6172 6961 7a7a 6f3a  "ID": "Gariazzo:
-00055f80: 3230 3135 7272 6122 2c0a 2020 2020 2020  2015rra",.      
-00055f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055fa0: 2020 2020 2020 2279 6561 7222 3a20 2232        "year": "2
-00055fb0: 3031 3622 2c0a 2020 2020 2020 2020 2020  016",.          
-00055fc0: 2020 2020 2020 2020 2020 2020 2020 7d2c                },
-00055fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00055fe0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00055ff0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00056000: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00056010: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-00056020: 4244 422e 6269 6273 2e75 7064 6174 6549  BDB.bibs.updateI
-00056030: 6e66 6f46 726f 6d4f 4149 2822 3132 3334  nfoFromOAI("1234
-00056040: 3522 2929 0a20 2020 2020 2020 2020 2020  5")).           
-00056050: 2020 2020 2072 6573 203d 2073 656c 662e       res = self.
-00056060: 7042 4442 2e62 6962 732e 6765 7442 7942  pBDB.bibs.getByB
-00056070: 6962 6b65 7928 2247 6172 6961 7a7a 6f3a  ibkey("Gariazzo:
-00056080: 3230 3135 7272 6122 295b 305d 0a20 2020  2015rra")[0].   
-00056090: 2020 2020 2020 2020 2020 2020 2064 656c               del
-000560a0: 2072 6573 5b22 6369 7461 7469 6f6e 7322   res["citations"
-000560b0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000560c0: 2020 6465 6c20 7265 735b 2263 6974 6174    del res["citat
-000560d0: 696f 6e73 5f6e 6f5f 7365 6c66 225d 0a20  ions_no_self"]. 
-000560e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000560f0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00056100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00056110: 2020 2020 2072 6573 2c0a 2020 2020 2020       res,.      
-00056120: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-00056130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056140: 2020 2020 2020 2020 2262 6962 6b65 7922          "bibkey"
-00056150: 3a20 2247 6172 6961 7a7a 6f3a 3230 3135  : "Gariazzo:2015
-00056160: 7272 6122 2c0a 2020 2020 2020 2020 2020  rra",.          
-00056170: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00056180: 6e73 7069 7265 223a 2022 3133 3835 3538  nspire": "138558
-00056190: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-000561a0: 2020 2020 2020 2020 2020 2020 2261 7278              "arx
-000561b0: 6976 223a 2022 3135 3037 2e30 3832 3034  iv": "1507.08204
-000561c0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000561d0: 2020 2020 2020 2020 2020 2022 6164 7322             "ads"
-000561e0: 3a20 2232 3031 354a 5068 472e 2e2e 3433  : "2015JPhG...43
-000561f0: 6333 3030 3147 222c 0a20 2020 2020 2020  c3001G",.       
-00056200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056210: 2022 7363 686f 6c61 7222 3a20 4e6f 6e65   "scholar": None
-00056220: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00056230: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
-00056240: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
-00056250: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
-00056260: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00056270: 2020 2020 2020 2020 2020 2269 7362 6e22            "isbn"
-00056280: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
+00055ba0: 2020 2020 2020 2022 6175 7468 6f72 223a         "author":
+00055bb0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
+00055bc0: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+00055bd0: 6264 6963 7422 3a20 7b0a 2020 2020 2020  bdict": {.      
+00055be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055bf0: 2020 2020 2020 2265 7072 696e 7422 3a20        "eprint": 
+00055c00: 2231 3530 372e 3038 3230 3422 2c0a 2020  "1507.08204",.  
+00055c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055c20: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
+00055c30: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
+00055c40: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
+00055c50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00055c60: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+00055c70: 4e54 5259 5459 5045 223a 2022 6172 7469  NTRYTYPE": "arti
+00055c80: 636c 6522 2c0a 2020 2020 2020 2020 2020  cle",.          
+00055c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055ca0: 2020 2249 4422 3a20 2247 6172 6961 7a7a    "ID": "Gariazz
+00055cb0: 6f3a 3230 3135 7272 6122 2c0a 2020 2020  o:2015rra",.    
+00055cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055cd0: 2020 2020 2020 2020 2279 6561 7222 3a20          "year": 
+00055ce0: 2232 3031 3622 2c0a 2020 2020 2020 2020  "2016",.        
+00055cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055d00: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00055d10: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00055d20: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00055d30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00055d40: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+00055d50: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+00055d60: 6549 6e66 6f46 726f 6d4f 4149 2822 3132  eInfoFromOAI("12
+00055d70: 3334 3522 2929 0a20 2020 2020 2020 2020  345")).         
+00055d80: 2020 2020 2020 2072 6573 203d 2073 656c         res = sel
+00055d90: 662e 7042 4442 2e62 6962 732e 6765 7442  f.pBDB.bibs.getB
+00055da0: 7942 6962 6b65 7928 2247 6172 6961 7a7a  yBibkey("Gariazz
+00055db0: 6f3a 3230 3135 7272 6122 295b 305d 0a20  o:2015rra")[0]. 
+00055dc0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00055dd0: 656c 2072 6573 5b22 6369 7461 7469 6f6e  el res["citation
+00055de0: 7322 5d0a 2020 2020 2020 2020 2020 2020  s"].            
+00055df0: 2020 2020 6465 6c20 7265 735b 2263 6974      del res["cit
+00055e00: 6174 696f 6e73 5f6e 6f5f 7365 6c66 225d  ations_no_self"]
+00055e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00055e20: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00055e30: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+00055e40: 2020 2020 2020 2072 6573 2c0a 2020 2020         res,.    
+00055e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055e60: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00055e70: 2020 2020 2020 2020 2020 2262 6962 6b65            "bibke
+00055e80: 7922 3a20 2247 6172 6961 7a7a 6f3a 3230  y": "Gariazzo:20
+00055e90: 3135 7272 6122 2c0a 2020 2020 2020 2020  15rra",.        
+00055ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055eb0: 2269 6e73 7069 7265 223a 2022 3133 3835  "inspire": "1385
+00055ec0: 3538 3322 2c0a 2020 2020 2020 2020 2020  583",.          
+00055ed0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+00055ee0: 7278 6976 223a 2022 3135 3037 2e30 3832  rxiv": "1507.082
+00055ef0: 3034 222c 0a20 2020 2020 2020 2020 2020  04",.           
+00055f00: 2020 2020 2020 2020 2020 2020 2022 6164               "ad
+00055f10: 7322 3a20 2232 3031 354a 5068 472e 2e2e  s": "2015JPhG...
+00055f20: 3433 6333 3030 3147 222c 0a20 2020 2020  43c3001G",.     
+00055f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055f40: 2020 2022 7363 686f 6c61 7222 3a20 4e6f     "scholar": No
+00055f50: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00055f60: 2020 2020 2020 2020 2020 2020 2264 6f69              "doi
+00055f70: 223a 2022 3130 2e31 3038 382f 3039 3534  ": "10.1088/0954
+00055f80: 2d33 3839 392f 3433 2f33 2f30 3333 3030  -3899/43/3/03300
+00055f90: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+00055fa0: 2020 2020 2020 2020 2020 2020 2269 7362              "isb
+00055fb0: 6e22 3a20 4e6f 6e65 2c0a 2020 2020 2020  n": None,.      
+00055fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055fd0: 2020 2279 6561 7222 3a20 2232 3031 3622    "year": "2016"
+00055fe0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00055ff0: 2020 2020 2020 2020 2020 226c 696e 6b22            "link"
+00056000: 3a20 2225 732f 6162 732f 3135 3037 2e30  : "%s/abs/1507.0
+00056010: 3832 3034 2220 2520 7062 436f 6e66 6967  8204" % pbConfig
+00056020: 2e61 7278 6976 5572 6c2c 0a20 2020 2020  .arxivUrl,.     
+00056030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056040: 2020 2022 636f 6d6d 656e 7473 223a 204e     "comments": N
+00056050: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00056060: 2020 2020 2020 2020 2020 2020 2022 6f6c               "ol
+00056070: 645f 6b65 7973 223a 204e 6f6e 652c 0a20  d_keys": None,. 
+00056080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056090: 2020 2020 2020 2022 6372 6f73 7372 6566         "crossref
+000560a0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
+000560b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000560c0: 2022 6269 6274 6578 223a 2022 4041 7274   "bibtex": "@Art
+000560d0: 6963 6c65 7b47 6172 6961 7a7a 6f3a 3230  icle{Gariazzo:20
+000560e0: 3135 7272 612c 5c6e 220a 2020 2020 2020  15rra,\n".      
+000560f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056100: 2020 2b20 2720 2020 2020 2020 2061 7574    + '        aut
+00056110: 686f 7220 3d20 2247 6172 6961 7a7a 6f22  hor = "Gariazzo"
+00056120: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
+00056130: 2020 2020 2020 2020 2020 2020 202b 2027               + '
+00056140: 2020 2020 2020 2020 2074 6974 6c65 203d           title =
+00056150: 2022 7b4c 6967 6874 2053 7465 7269 6c65   "{Light Sterile
+00056160: 204e 6575 7472 696e 6f73 7d22 2c5c 6e27   Neutrinos}",\n'
+00056170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00056180: 2020 2020 2020 2020 202b 2027 2020 2020           + '    
+00056190: 2020 206a 6f75 726e 616c 203d 2022 4a2e     journal = "J.
+000561a0: 5068 7973 2e47 222c 5c6e 270a 2020 2020  Phys.G",\n'.    
+000561b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000561c0: 2020 2020 2b20 2720 2020 2020 2020 2020      + '         
+000561d0: 2079 6561 7220 3d20 2232 3031 3622 2c5c   year = "2016",\
+000561e0: 6e27 0a20 2020 2020 2020 2020 2020 2020  n'.             
+000561f0: 2020 2020 2020 2020 2020 202b 2027 2020             + '  
+00056200: 2020 2020 2020 6570 7269 6e74 203d 2022        eprint = "
+00056210: 3135 3037 2e30 3832 3034 222c 5c6e 270a  1507.08204",\n'.
+00056220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056230: 2020 2020 2020 2020 2b20 2720 2020 2020          + '     
+00056240: 2020 2020 2020 646f 6920 3d20 2231 302e        doi = "10.
+00056250: 3130 3838 2f30 3935 342d 3338 3939 2f34  1088/0954-3899/4
+00056260: 332f 332f 3033 3330 3031 222c 5c6e 270a  3/3/033001",\n'.
+00056270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056280: 2020 2020 2020 2020 2b20 227d 222c 0a20          + "}",. 
 00056290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000562a0: 2279 6561 7222 3a20 2232 3031 3622 2c0a  "year": "2016",.
-000562b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000562c0: 2020 2020 2020 2020 226c 696e 6b22 3a20          "link": 
-000562d0: 2225 732f 6162 732f 3135 3037 2e30 3832  "%s/abs/1507.082
-000562e0: 3034 2220 2520 7062 436f 6e66 6967 2e61  04" % pbConfig.a
-000562f0: 7278 6976 5572 6c2c 0a20 2020 2020 2020  rxivUrl,.       
-00056300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056310: 2022 636f 6d6d 656e 7473 223a 204e 6f6e   "comments": Non
-00056320: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00056330: 2020 2020 2020 2020 2020 2022 6f6c 645f             "old_
-00056340: 6b65 7973 223a 204e 6f6e 652c 0a20 2020  keys": None,.   
-00056350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056360: 2020 2020 2022 6372 6f73 7372 6566 223a       "crossref":
-00056370: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00056380: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00056390: 6269 6274 6578 223a 2022 4041 7274 6963  bibtex": "@Artic
-000563a0: 6c65 7b47 6172 6961 7a7a 6f3a 3230 3135  le{Gariazzo:2015
-000563b0: 7272 612c 5c6e 220a 2020 2020 2020 2020  rra,\n".        
+000562a0: 2020 2020 2020 2022 6669 7273 7464 6174         "firstdat
+000562b0: 6522 3a20 2232 3031 352d 3037 2d32 3922  e": "2015-07-29"
+000562c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000562d0: 2020 2020 2020 2020 2020 2270 7562 6461            "pubda
+000562e0: 7465 223a 2022 3230 3136 2d30 312d 3133  te": "2016-01-13
+000562f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00056300: 2020 2020 2020 2020 2020 2022 6578 705f             "exp_
+00056310: 7061 7065 7222 3a20 302c 0a20 2020 2020  paper": 0,.     
+00056320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056330: 2020 2022 6c65 6374 7572 6522 3a20 302c     "lecture": 0,
+00056340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00056350: 2020 2020 2020 2020 2022 7068 645f 7468           "phd_th
+00056360: 6573 6973 223a 2030 2c0a 2020 2020 2020  esis": 0,.      
+00056370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056380: 2020 2272 6576 6965 7722 3a20 302c 0a20    "review": 0,. 
+00056390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000563a0: 2020 2020 2020 2022 7072 6f63 6565 6469         "proceedi
+000563b0: 6e67 223a 2030 2c0a 2020 2020 2020 2020  ng": 0,.        
 000563c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000563d0: 2b20 2720 2020 2020 2020 2061 7574 686f  + '        autho
-000563e0: 7220 3d20 2247 6172 6961 7a7a 6f22 2c5c  r = "Gariazzo",\
-000563f0: 6e27 0a20 2020 2020 2020 2020 2020 2020  n'.             
-00056400: 2020 2020 2020 2020 2020 202b 2027 2020             + '  
-00056410: 2020 2020 2020 2074 6974 6c65 203d 2022         title = "
-00056420: 7b4c 6967 6874 2053 7465 7269 6c65 204e  {Light Sterile N
-00056430: 6575 7472 696e 6f73 7d22 2c5c 6e27 0a20  eutrinos}",\n'. 
-00056440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056450: 2020 2020 2020 202b 2027 2020 2020 2020         + '      
-00056460: 206a 6f75 726e 616c 203d 2022 4a2e 5068   journal = "J.Ph
-00056470: 7973 2e47 222c 5c6e 270a 2020 2020 2020  ys.G",\n'.      
+000563d0: 2262 6f6f 6b22 3a20 302c 0a20 2020 2020  "book": 0,.     
+000563e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000563f0: 2020 2022 6e6f 5570 6461 7465 223a 2030     "noUpdate": 0
+00056400: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00056410: 2020 2020 2020 2020 2020 226d 6172 6b73            "marks
+00056420: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+00056430: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00056440: 6162 7374 7261 6374 223a 204e 6f6e 652c  abstract": None,
+00056450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00056460: 2020 2020 2020 2020 2022 6269 6274 6578           "bibtex
+00056470: 4469 6374 223a 207b 0a20 2020 2020 2020  Dict": {.       
 00056480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056490: 2020 2b20 2720 2020 2020 2020 2020 2079    + '          y
-000564a0: 6561 7220 3d20 2232 3031 3622 2c5c 6e27  ear = "2016",\n'
-000564b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000564c0: 2020 2020 2020 2020 202b 2027 2020 2020           + '    
-000564d0: 2020 2020 6570 7269 6e74 203d 2022 3135      eprint = "15
-000564e0: 3037 2e30 3832 3034 222c 5c6e 270a 2020  07.08204",\n'.  
-000564f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056500: 2020 2020 2020 2b20 2720 2020 2020 2020        + '       
-00056510: 2020 2020 646f 6920 3d20 2231 302e 3130      doi = "10.10
-00056520: 3838 2f30 3935 342d 3338 3939 2f34 332f  88/0954-3899/43/
-00056530: 332f 3033 3330 3031 222c 5c6e 270a 2020  3/033001",\n'.  
-00056540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056550: 2020 2020 2020 2b20 227d 222c 0a20 2020        + "}",.   
+00056490: 2020 2020 2022 454e 5452 5954 5950 4522       "ENTRYTYPE"
+000564a0: 3a20 2261 7274 6963 6c65 222c 0a20 2020  : "article",.   
+000564b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000564c0: 2020 2020 2020 2020 2022 4944 223a 2022           "ID": "
+000564d0: 4761 7269 617a 7a6f 3a32 3031 3572 7261  Gariazzo:2015rra
+000564e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000564f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00056500: 6175 7468 6f72 223a 2022 4761 7269 617a  author": "Gariaz
+00056510: 7a6f 222c 0a20 2020 2020 2020 2020 2020  zo",.           
+00056520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056530: 2022 646f 6922 3a20 2231 302e 3130 3838   "doi": "10.1088
+00056540: 2f30 3935 342d 3338 3939 2f34 332f 332f  /0954-3899/43/3/
+00056550: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
 00056560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056570: 2020 2020 2022 6669 7273 7464 6174 6522       "firstdate"
-00056580: 3a20 2232 3031 352d 3037 2d32 3922 2c0a  : "2015-07-29",.
+00056570: 2020 2020 2022 6570 7269 6e74 223a 2022       "eprint": "
+00056580: 3135 3037 2e30 3832 3034 222c 0a20 2020  1507.08204",.   
 00056590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000565a0: 2020 2020 2020 2020 2270 7562 6461 7465          "pubdate
-000565b0: 223a 2022 3230 3136 2d30 312d 3133 222c  ": "2016-01-13",
-000565c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000565d0: 2020 2020 2020 2020 2022 6578 705f 7061           "exp_pa
-000565e0: 7065 7222 3a20 302c 0a20 2020 2020 2020  per": 0,.       
-000565f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056600: 2022 6c65 6374 7572 6522 3a20 302c 0a20   "lecture": 0,. 
-00056610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056620: 2020 2020 2020 2022 7068 645f 7468 6573         "phd_thes
-00056630: 6973 223a 2030 2c0a 2020 2020 2020 2020  is": 0,.        
-00056640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056650: 2272 6576 6965 7722 3a20 302c 0a20 2020  "review": 0,.   
-00056660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056670: 2020 2020 2022 7072 6f63 6565 6469 6e67       "proceeding
-00056680: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
-00056690: 2020 2020 2020 2020 2020 2020 2020 2262                "b
-000566a0: 6f6f 6b22 3a20 302c 0a20 2020 2020 2020  ook": 0,.       
-000566b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000566c0: 2022 6e6f 5570 6461 7465 223a 2030 2c0a   "noUpdate": 0,.
-000566d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000566e0: 2020 2020 2020 2020 226d 6172 6b73 223a          "marks":
-000566f0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00056700: 2020 2020 2020 2020 2020 2020 2022 6162               "ab
-00056710: 7374 7261 6374 223a 204e 6f6e 652c 0a20  stract": None,. 
-00056720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056730: 2020 2020 2020 2022 6269 6274 6578 4469         "bibtexDi
-00056740: 6374 223a 207b 0a20 2020 2020 2020 2020  ct": {.         
-00056750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056760: 2020 2022 454e 5452 5954 5950 4522 3a20     "ENTRYTYPE": 
-00056770: 2261 7274 6963 6c65 222c 0a20 2020 2020  "article",.     
-00056780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056790: 2020 2020 2020 2022 4944 223a 2022 4761         "ID": "Ga
-000567a0: 7269 617a 7a6f 3a32 3031 3572 7261 222c  riazzo:2015rra",
-000567b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000567c0: 2020 2020 2020 2020 2020 2020 2022 6175               "au
-000567d0: 7468 6f72 223a 2022 4761 7269 617a 7a6f  thor": "Gariazzo
-000567e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000567f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00056800: 646f 6922 3a20 2231 302e 3130 3838 2f30  doi": "10.1088/0
-00056810: 3935 342d 3338 3939 2f34 332f 332f 3033  954-3899/43/3/03
-00056820: 3330 3031 222c 0a20 2020 2020 2020 2020  3001",.         
-00056830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056840: 2020 2022 6570 7269 6e74 223a 2022 3135     "eprint": "15
-00056850: 3037 2e30 3832 3034 222c 0a20 2020 2020  07.08204",.     
-00056860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056870: 2020 2020 2020 2022 6a6f 7572 6e61 6c22         "journal"
-00056880: 3a20 224a 2e50 6879 732e 4722 2c0a 2020  : "J.Phys.G",.  
-00056890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000568a0: 2020 2020 2020 2020 2020 2274 6974 6c65            "title
-000568b0: 223a 2022 7b4c 6967 6874 2053 7465 7269  ": "{Light Steri
-000568c0: 6c65 204e 6575 7472 696e 6f73 7d22 2c0a  le Neutrinos}",.
+000565a0: 2020 2020 2020 2020 2022 6a6f 7572 6e61           "journa
+000565b0: 6c22 3a20 224a 2e50 6879 732e 4722 2c0a  l": "J.Phys.G",.
+000565c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000565d0: 2020 2020 2020 2020 2020 2020 2274 6974              "tit
+000565e0: 6c65 223a 2022 7b4c 6967 6874 2053 7465  le": "{Light Ste
+000565f0: 7269 6c65 204e 6575 7472 696e 6f73 7d22  rile Neutrinos}"
+00056600: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00056610: 2020 2020 2020 2020 2020 2020 2020 2279                "y
+00056620: 6561 7222 3a20 2232 3031 3622 2c0a 2020  ear": "2016",.  
+00056630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056640: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00056650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056660: 2022 7469 746c 6522 3a20 227b 4c69 6768   "title": "{Ligh
+00056670: 7420 5374 6572 696c 6520 4e65 7574 7269  t Sterile Neutri
+00056680: 6e6f 737d 222c 0a20 2020 2020 2020 2020  nos}",.         
+00056690: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000566a0: 6a6f 7572 6e61 6c22 3a20 224a 2e50 6879  journal": "J.Phy
+000566b0: 732e 4722 2c0a 2020 2020 2020 2020 2020  s.G",.          
+000566c0: 2020 2020 2020 2020 2020 2020 2020 2276                "v
+000566d0: 6f6c 756d 6522 3a20 2222 2c0a 2020 2020  olume": "",.    
+000566e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000566f0: 2020 2020 226e 756d 6265 7222 3a20 2222      "number": ""
+00056700: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00056710: 2020 2020 2020 2020 2020 2270 6167 6573            "pages
+00056720: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+00056730: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00056740: 7075 626c 6973 6865 6422 3a20 224a 2e50  published": "J.P
+00056750: 6879 732e 4720 2028 3230 3136 2920 222c  hys.G  (2016) ",
+00056760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00056770: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
+00056780: 223a 2022 4761 7269 617a 7a6f 222c 0a20  ": "Gariazzo",. 
+00056790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000567a0: 2020 2020 2020 2022 6269 6264 6963 7422         "bibdict"
+000567b0: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
+000567c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000567d0: 2245 4e54 5259 5459 5045 223a 2022 6172  "ENTRYTYPE": "ar
+000567e0: 7469 636c 6522 2c0a 2020 2020 2020 2020  ticle",.        
+000567f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056800: 2020 2020 2249 4422 3a20 2247 6172 6961      "ID": "Garia
+00056810: 7a7a 6f3a 3230 3135 7272 6122 2c0a 2020  zzo:2015rra",.  
+00056820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056830: 2020 2020 2020 2020 2020 2261 7574 686f            "autho
+00056840: 7222 3a20 2247 6172 6961 7a7a 6f22 2c0a  r": "Gariazzo",.
+00056850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056860: 2020 2020 2020 2020 2020 2020 2264 6f69              "doi
+00056870: 223a 2022 3130 2e31 3038 382f 3039 3534  ": "10.1088/0954
+00056880: 2d33 3839 392f 3433 2f33 2f30 3333 3030  -3899/43/3/03300
+00056890: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+000568a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000568b0: 2265 7072 696e 7422 3a20 2231 3530 372e  "eprint": "1507.
+000568c0: 3038 3230 3422 2c0a 2020 2020 2020 2020  08204",.        
 000568d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000568e0: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
-000568f0: 7222 3a20 2232 3031 3622 2c0a 2020 2020  r": "2016",.    
+000568e0: 2020 2020 226a 6f75 726e 616c 223a 2022      "journal": "
+000568f0: 4a2e 5068 7973 2e47 222c 0a20 2020 2020  J.Phys.G",.     
 00056900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056910: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-00056920: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00056930: 7469 746c 6522 3a20 227b 4c69 6768 7420  title": "{Light 
-00056940: 5374 6572 696c 6520 4e65 7574 7269 6e6f  Sterile Neutrino
-00056950: 737d 222c 0a20 2020 2020 2020 2020 2020  s}",.           
-00056960: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
-00056970: 7572 6e61 6c22 3a20 224a 2e50 6879 732e  urnal": "J.Phys.
-00056980: 4722 2c0a 2020 2020 2020 2020 2020 2020  G",.            
-00056990: 2020 2020 2020 2020 2020 2020 2276 6f6c              "vol
-000569a0: 756d 6522 3a20 2222 2c0a 2020 2020 2020  ume": "",.      
-000569b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000569c0: 2020 226e 756d 6265 7222 3a20 2222 2c0a    "number": "",.
+00056910: 2020 2020 2020 2022 7469 746c 6522 3a20         "title": 
+00056920: 227b 4c69 6768 7420 5374 6572 696c 6520  "{Light Sterile 
+00056930: 4e65 7574 7269 6e6f 737d 222c 0a20 2020  Neutrinos}",.   
+00056940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056950: 2020 2020 2020 2020 2022 7965 6172 223a           "year":
+00056960: 2022 3230 3136 222c 0a20 2020 2020 2020   "2016",.       
+00056970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056980: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+00056990: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
+000569a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000569b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000569c0: 662e 6173 7365 7274 5472 7565 280a 2020  f.assertTrue(.  
 000569d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000569e0: 2020 2020 2020 2020 2270 6167 6573 223a          "pages":
-000569f0: 2022 222c 0a20 2020 2020 2020 2020 2020   "",.           
-00056a00: 2020 2020 2020 2020 2020 2020 2022 7075               "pu
-00056a10: 626c 6973 6865 6422 3a20 224a 2e50 6879  blished": "J.Phy
-00056a20: 732e 4720 2028 3230 3136 2920 222c 0a20  s.G  (2016) ",. 
-00056a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056a40: 2020 2020 2020 2022 6175 7468 6f72 223a         "author":
-00056a50: 2022 4761 7269 617a 7a6f 222c 0a20 2020   "Gariazzo",.   
-00056a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056a70: 2020 2020 2022 6269 6264 6963 7422 3a20       "bibdict": 
-00056a80: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00056a90: 2020 2020 2020 2020 2020 2020 2020 2245                "E
-00056aa0: 4e54 5259 5459 5045 223a 2022 6172 7469  NTRYTYPE": "arti
-00056ab0: 636c 6522 2c0a 2020 2020 2020 2020 2020  cle",.          
-00056ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056ad0: 2020 2249 4422 3a20 2247 6172 6961 7a7a    "ID": "Gariazz
-00056ae0: 6f3a 3230 3135 7272 6122 2c0a 2020 2020  o:2015rra",.    
-00056af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056b00: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
-00056b10: 3a20 2247 6172 6961 7a7a 6f22 2c0a 2020  : "Gariazzo",.  
+000569e0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+000569f0: 2e75 7064 6174 6549 6e66 6f46 726f 6d4f  .updateInfoFromO
+00056a00: 4149 2822 3132 3334 3522 2c20 7265 6c6f  AI("12345", relo
+00056a10: 6164 416c 6c3d 5472 7565 290a 2020 2020  adAll=True).    
+00056a20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00056a30: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00056a40: 7320 3d20 7365 6c66 2e70 4244 422e 6269  s = self.pBDB.bi
+00056a50: 6273 2e67 6574 4279 4269 626b 6579 2822  bs.getByBibkey("
+00056a60: 4761 7269 617a 7a6f 3a32 3031 3572 7261  Gariazzo:2015rra
+00056a70: 2229 5b30 5d0a 2020 2020 2020 2020 2020  ")[0].          
+00056a80: 2020 2020 2020 6465 6c20 7265 735b 2263        del res["c
+00056a90: 6974 6174 696f 6e73 225d 0a20 2020 2020  itations"].     
+00056aa0: 2020 2020 2020 2020 2020 2064 656c 2072             del r
+00056ab0: 6573 5b22 6369 7461 7469 6f6e 735f 6e6f  es["citations_no
+00056ac0: 5f73 656c 6622 5d0a 2020 2020 2020 2020  _self"].        
+00056ad0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00056ae0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00056af0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00056b00: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00056b10: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
 00056b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056b30: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
-00056b40: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
-00056b50: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
-00056b60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00056b70: 2020 2020 2020 2020 2020 2020 2020 2265                "e
-00056b80: 7072 696e 7422 3a20 2231 3530 372e 3038  print": "1507.08
-00056b90: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
-00056ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056bb0: 2020 226a 6f75 726e 616c 223a 2022 4a2e    "journal": "J.
-00056bc0: 5068 7973 2e47 222c 0a20 2020 2020 2020  Phys.G",.       
-00056bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056be0: 2020 2020 2022 7469 746c 6522 3a20 227b       "title": "{
-00056bf0: 4c69 6768 7420 5374 6572 696c 6520 4e65  Light Sterile Ne
-00056c00: 7574 7269 6e6f 737d 222c 0a20 2020 2020  utrinos}",.     
+00056b30: 2022 6269 626b 6579 223a 2022 4761 7269   "bibkey": "Gari
+00056b40: 617a 7a6f 3a32 3031 3572 7261 222c 0a20  azzo:2015rra",. 
+00056b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056b60: 2020 2020 2020 2022 696e 7370 6972 6522         "inspire"
+00056b70: 3a20 2231 3338 3535 3833 222c 0a20 2020  : "1385583",.   
+00056b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056b90: 2020 2020 2022 6172 7869 7622 3a20 2231       "arxiv": "1
+00056ba0: 3530 372e 3038 3230 3422 2c0a 2020 2020  507.08204",.    
+00056bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056bc0: 2020 2020 2261 6473 223a 2022 3230 3135      "ads": "2015
+00056bd0: 4a50 6847 2e2e 2e34 3363 3330 3031 4722  JPhG...43c3001G"
+00056be0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00056bf0: 2020 2020 2020 2020 2020 2273 6368 6f6c            "schol
+00056c00: 6172 223a 204e 6f6e 652c 0a20 2020 2020  ar": None,.     
 00056c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056c20: 2020 2020 2020 2022 7965 6172 223a 2022         "year": "
-00056c30: 3230 3136 222c 0a20 2020 2020 2020 2020  2016",.         
-00056c40: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00056c50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00056c60: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
-00056c70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00056c80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00056c90: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
+00056c20: 2020 2022 646f 6922 3a20 2231 302e 3130     "doi": "10.10
+00056c30: 3838 2f30 3935 342d 3338 3939 2f34 332f  88/0954-3899/43/
+00056c40: 332f 3033 3330 3031 222c 0a20 2020 2020  3/033001",.     
+00056c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056c60: 2020 2022 6973 626e 223a 204e 6f6e 652c     "isbn": None,
+00056c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00056c80: 2020 2020 2020 2020 2022 7965 6172 223a           "year":
+00056c90: 2022 3230 3136 222c 0a20 2020 2020 2020   "2016",.       
 00056ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056cb0: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-00056cc0: 7064 6174 6549 6e66 6f46 726f 6d4f 4149  pdateInfoFromOAI
-00056cd0: 2822 3132 3334 3522 2c20 7265 6c6f 6164  ("12345", reload
-00056ce0: 416c 6c3d 5472 7565 290a 2020 2020 2020  All=True).      
-00056cf0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00056d00: 2020 2020 2020 2020 2020 2020 7265 7320              res 
-00056d10: 3d20 7365 6c66 2e70 4244 422e 6269 6273  = self.pBDB.bibs
-00056d20: 2e67 6574 4279 4269 626b 6579 2822 4761  .getByBibkey("Ga
-00056d30: 7269 617a 7a6f 3a32 3031 3572 7261 2229  riazzo:2015rra")
-00056d40: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-00056d50: 2020 2020 6465 6c20 7265 735b 2263 6974      del res["cit
-00056d60: 6174 696f 6e73 225d 0a20 2020 2020 2020  ations"].       
-00056d70: 2020 2020 2020 2020 2064 656c 2072 6573           del res
-00056d80: 5b22 6369 7461 7469 6f6e 735f 6e6f 5f73  ["citations_no_s
-00056d90: 656c 6622 5d0a 2020 2020 2020 2020 2020  elf"].          
-00056da0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00056db0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-00056dc0: 2020 2020 2020 2020 2020 2020 7265 732c              res,
-00056dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00056de0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
-00056df0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00056e00: 6269 626b 6579 223a 2022 4761 7269 617a  bibkey": "Gariaz
-00056e10: 7a6f 3a32 3031 3572 7261 222c 0a20 2020  zo:2015rra",.   
-00056e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056e30: 2020 2020 2022 696e 7370 6972 6522 3a20       "inspire": 
-00056e40: 2231 3338 3535 3833 222c 0a20 2020 2020  "1385583",.     
-00056e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056e60: 2020 2022 6172 7869 7622 3a20 2231 3530     "arxiv": "150
-00056e70: 372e 3038 3230 3422 2c0a 2020 2020 2020  7.08204",.      
-00056e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056e90: 2020 2261 6473 223a 2022 3230 3135 4a50    "ads": "2015JP
-00056ea0: 6847 2e2e 2e34 3363 3330 3031 4722 2c0a  hG...43c3001G",.
-00056eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056ec0: 2020 2020 2020 2020 2273 6368 6f6c 6172          "scholar
-00056ed0: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-00056ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056ef0: 2022 646f 6922 3a20 2231 302e 3130 3838   "doi": "10.1088
-00056f00: 2f30 3935 342d 3338 3939 2f34 332f 332f  /0954-3899/43/3/
-00056f10: 3033 3330 3031 222c 0a20 2020 2020 2020  033001",.       
-00056f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056f30: 2022 6973 626e 223a 204e 6f6e 652c 0a20   "isbn": None,. 
-00056f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056f50: 2020 2020 2020 2022 7965 6172 223a 2022         "year": "
-00056f60: 3230 3136 222c 0a20 2020 2020 2020 2020  2016",.         
-00056f70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00056f80: 6c69 6e6b 223a 2022 2573 2f61 6273 2f31  link": "%s/abs/1
-00056f90: 3530 372e 3038 3230 3422 2025 2070 6243  507.08204" % pbC
-00056fa0: 6f6e 6669 672e 6172 7869 7655 726c 2c0a  onfig.arxivUrl,.
-00056fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056fc0: 2020 2020 2020 2020 2263 6f6d 6d65 6e74          "comment
-00056fd0: 7322 3a20 4e6f 6e65 2c0a 2020 2020 2020  s": None,.      
-00056fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056ff0: 2020 226f 6c64 5f6b 6579 7322 3a20 4e6f    "old_keys": No
-00057000: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00057010: 2020 2020 2020 2020 2020 2020 2263 726f              "cro
-00057020: 7373 7265 6622 3a20 4e6f 6e65 2c0a 2020  ssref": None,.  
-00057030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057040: 2020 2020 2020 2262 6962 7465 7822 3a20        "bibtex": 
-00057050: 2240 4172 7469 636c 657b 4761 7269 617a  "@Article{Gariaz
-00057060: 7a6f 3a32 3031 3572 7261 2c5c 6e22 0a20  zo:2015rra,\n". 
-00057070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057080: 2020 2020 2020 202b 2027 2020 2020 2020         + '      
-00057090: 2020 6175 7468 6f72 203d 2022 4761 7269    author = "Gari
-000570a0: 617a 7a6f 222c 5c6e 270a 2020 2020 2020  azzo",\n'.      
-000570b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000570c0: 2020 2b20 2720 2020 2020 2020 2020 7469    + '         ti
-000570d0: 746c 6520 3d20 227b 4c69 6768 7420 5374  tle = "{Light St
-000570e0: 6572 696c 6520 4e65 7574 7269 6e6f 737d  erile Neutrinos}
-000570f0: 222c 5c6e 270a 2020 2020 2020 2020 2020  ",\n'.          
-00057100: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00057110: 2720 2020 2020 2020 6a6f 7572 6e61 6c20  '       journal 
-00057120: 3d20 224a 2e50 6879 732e 4722 2c5c 6e27  = "J.Phys.G",\n'
-00057130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00057140: 2020 2020 2020 2020 202b 2027 2020 2020           + '    
-00057150: 2020 2020 766f 6c75 6d65 203d 2022 3433      volume = "43
-00057160: 222c 5c6e 270a 2020 2020 2020 2020 2020  ",\n'.          
-00057170: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00057180: 2720 2020 2020 2020 2020 2079 6561 7220  '          year 
-00057190: 3d20 2232 3031 3622 2c5c 6e27 0a20 2020  = "2016",\n'.   
+00056cb0: 2022 6c69 6e6b 223a 2022 2573 2f61 6273   "link": "%s/abs
+00056cc0: 2f31 3530 372e 3038 3230 3422 2025 2070  /1507.08204" % p
+00056cd0: 6243 6f6e 6669 672e 6172 7869 7655 726c  bConfig.arxivUrl
+00056ce0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00056cf0: 2020 2020 2020 2020 2020 2263 6f6d 6d65            "comme
+00056d00: 6e74 7322 3a20 4e6f 6e65 2c0a 2020 2020  nts": None,.    
+00056d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056d20: 2020 2020 226f 6c64 5f6b 6579 7322 3a20      "old_keys": 
+00056d30: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00056d40: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00056d50: 726f 7373 7265 6622 3a20 4e6f 6e65 2c0a  rossref": None,.
+00056d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056d70: 2020 2020 2020 2020 2262 6962 7465 7822          "bibtex"
+00056d80: 3a20 2240 4172 7469 636c 657b 4761 7269  : "@Article{Gari
+00056d90: 617a 7a6f 3a32 3031 3572 7261 2c5c 6e22  azzo:2015rra,\n"
+00056da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00056db0: 2020 2020 2020 2020 202b 2027 2020 2020           + '    
+00056dc0: 2020 2020 6175 7468 6f72 203d 2022 4761      author = "Ga
+00056dd0: 7269 617a 7a6f 222c 5c6e 270a 2020 2020  riazzo",\n'.    
+00056de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056df0: 2020 2020 2b20 2720 2020 2020 2020 2020      + '         
+00056e00: 7469 746c 6520 3d20 227b 4c69 6768 7420  title = "{Light 
+00056e10: 5374 6572 696c 6520 4e65 7574 7269 6e6f  Sterile Neutrino
+00056e20: 737d 222c 5c6e 270a 2020 2020 2020 2020  s}",\n'.        
+00056e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056e40: 2b20 2720 2020 2020 2020 6a6f 7572 6e61  + '       journa
+00056e50: 6c20 3d20 224a 2e50 6879 732e 4722 2c5c  l = "J.Phys.G",\
+00056e60: 6e27 0a20 2020 2020 2020 2020 2020 2020  n'.             
+00056e70: 2020 2020 2020 2020 2020 202b 2027 2020             + '  
+00056e80: 2020 2020 2020 766f 6c75 6d65 203d 2022        volume = "
+00056e90: 3433 222c 5c6e 270a 2020 2020 2020 2020  43",\n'.        
+00056ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056eb0: 2b20 2720 2020 2020 2020 2020 2079 6561  + '          yea
+00056ec0: 7220 3d20 2232 3031 3622 2c5c 6e27 0a20  r = "2016",\n'. 
+00056ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056ee0: 2020 2020 2020 202b 2027 2020 2020 2020         + '      
+00056ef0: 2020 2070 6167 6573 203d 2022 3033 3330     pages = "0330
+00056f00: 3031 222c 5c6e 270a 2020 2020 2020 2020  01",\n'.        
+00056f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056f20: 2b20 2720 2020 2020 2020 2065 7072 696e  + '        eprin
+00056f30: 7420 3d20 2231 3530 372e 3038 3230 3422  t = "1507.08204"
+00056f40: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
+00056f50: 2020 2020 2020 2020 2020 2020 202b 2027               + '
+00056f60: 2020 2020 2020 2020 2020 2064 6f69 203d             doi =
+00056f70: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
+00056f80: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
+00056f90: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
+00056fa0: 2020 2020 2020 2020 2020 2020 202b 2022               + "
+00056fb0: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
+00056fc0: 2020 2020 2020 2020 2020 2020 2266 6972              "fir
+00056fd0: 7374 6461 7465 223a 2022 3230 3135 2d30  stdate": "2015-0
+00056fe0: 372d 3239 222c 0a20 2020 2020 2020 2020  7-29",.         
+00056ff0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00057000: 7075 6264 6174 6522 3a20 2232 3031 362d  pubdate": "2016-
+00057010: 3031 2d31 3322 2c0a 2020 2020 2020 2020  01-13",.        
+00057020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057030: 2265 7870 5f70 6170 6572 223a 2030 2c0a  "exp_paper": 0,.
+00057040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057050: 2020 2020 2020 2020 226c 6563 7475 7265          "lecture
+00057060: 223a 2030 2c0a 2020 2020 2020 2020 2020  ": 0,.          
+00057070: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00057080: 6864 5f74 6865 7369 7322 3a20 302c 0a20  hd_thesis": 0,. 
+00057090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000570a0: 2020 2020 2020 2022 7265 7669 6577 223a         "review":
+000570b0: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+000570c0: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
+000570d0: 6365 6564 696e 6722 3a20 302c 0a20 2020  ceeding": 0,.   
+000570e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000570f0: 2020 2020 2022 626f 6f6b 223a 2030 2c0a       "book": 0,.
+00057100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057110: 2020 2020 2020 2020 226e 6f55 7064 6174          "noUpdat
+00057120: 6522 3a20 302c 0a20 2020 2020 2020 2020  e": 0,.         
+00057130: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00057140: 6d61 726b 7322 3a20 2222 2c0a 2020 2020  marks": "",.    
+00057150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057160: 2020 2020 2261 6273 7472 6163 7422 3a20      "abstract": 
+00057170: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00057180: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+00057190: 6962 7465 7844 6963 7422 3a20 7b0a 2020  ibtexDict": {.  
 000571a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000571b0: 2020 2020 202b 2027 2020 2020 2020 2020       + '        
-000571c0: 2070 6167 6573 203d 2022 3033 3330 3031   pages = "033001
-000571d0: 222c 5c6e 270a 2020 2020 2020 2020 2020  ",\n'.          
-000571e0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-000571f0: 2720 2020 2020 2020 2065 7072 696e 7420  '        eprint 
-00057200: 3d20 2231 3530 372e 3038 3230 3422 2c5c  = "1507.08204",\
-00057210: 6e27 0a20 2020 2020 2020 2020 2020 2020  n'.             
-00057220: 2020 2020 2020 2020 2020 202b 2027 2020             + '  
-00057230: 2020 2020 2020 2020 2064 6f69 203d 2022           doi = "
-00057240: 3130 2e31 3038 382f 3039 3534 2d33 3839  10.1088/0954-389
-00057250: 392f 3433 2f33 2f30 3333 3030 3122 2c5c  9/43/3/033001",\
-00057260: 6e27 0a20 2020 2020 2020 2020 2020 2020  n'.             
-00057270: 2020 2020 2020 2020 2020 202b 2022 7d22             + "}"
-00057280: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00057290: 2020 2020 2020 2020 2020 2266 6972 7374            "first
-000572a0: 6461 7465 223a 2022 3230 3135 2d30 372d  date": "2015-07-
-000572b0: 3239 222c 0a20 2020 2020 2020 2020 2020  29",.           
-000572c0: 2020 2020 2020 2020 2020 2020 2022 7075               "pu
-000572d0: 6264 6174 6522 3a20 2232 3031 362d 3031  bdate": "2016-01
-000572e0: 2d31 3322 2c0a 2020 2020 2020 2020 2020  -13",.          
-000572f0: 2020 2020 2020 2020 2020 2020 2020 2265                "e
-00057300: 7870 5f70 6170 6572 223a 2030 2c0a 2020  xp_paper": 0,.  
-00057310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057320: 2020 2020 2020 226c 6563 7475 7265 223a        "lecture":
-00057330: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
-00057340: 2020 2020 2020 2020 2020 2020 2270 6864              "phd
-00057350: 5f74 6865 7369 7322 3a20 302c 0a20 2020  _thesis": 0,.   
+000571b0: 2020 2020 2020 2020 2020 2245 4e54 5259            "ENTRY
+000571c0: 5459 5045 223a 2022 6172 7469 636c 6522  TYPE": "article"
+000571d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000571e0: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+000571f0: 4422 3a20 2247 6172 6961 7a7a 6f3a 3230  D": "Gariazzo:20
+00057200: 3135 7272 6122 2c0a 2020 2020 2020 2020  15rra",.        
+00057210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057220: 2020 2020 2261 7574 686f 7222 3a20 2247      "author": "G
+00057230: 6172 6961 7a7a 6f22 2c0a 2020 2020 2020  ariazzo",.      
+00057240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057250: 2020 2020 2020 2274 6974 6c65 223a 2022        "title": "
+00057260: 7b4c 6967 6874 2053 7465 7269 6c65 204e  {Light Sterile N
+00057270: 6575 7472 696e 6f73 7d22 2c0a 2020 2020  eutrinos}",.    
+00057280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057290: 2020 2020 2020 2020 2264 6f69 223a 2022          "doi": "
+000572a0: 3130 2e31 3038 382f 3039 3534 2d33 3839  10.1088/0954-389
+000572b0: 392f 3433 2f33 2f30 3333 3030 3122 2c0a  9/43/3/033001",.
+000572c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000572d0: 2020 2020 2020 2020 2020 2020 2265 7072              "epr
+000572e0: 696e 7422 3a20 2231 3530 372e 3038 3230  int": "1507.0820
+000572f0: 3422 2c0a 2020 2020 2020 2020 2020 2020  4",.            
+00057300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057310: 2270 6167 6573 223a 2022 3033 3330 3031  "pages": "033001
+00057320: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00057330: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00057340: 6a6f 7572 6e61 6c22 3a20 224a 2e50 6879  journal": "J.Phy
+00057350: 732e 4722 2c0a 2020 2020 2020 2020 2020  s.G",.          
 00057360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057370: 2020 2020 2022 7265 7669 6577 223a 2030       "review": 0
+00057370: 2020 2276 6f6c 756d 6522 3a20 2234 3322    "volume": "43"
 00057380: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00057390: 2020 2020 2020 2020 2020 2270 726f 6365            "proce
-000573a0: 6564 696e 6722 3a20 302c 0a20 2020 2020  eding": 0,.     
+00057390: 2020 2020 2020 2020 2020 2020 2020 2279                "y
+000573a0: 6561 7222 3a20 2232 3031 3622 2c0a 2020  ear": "2016",.  
 000573b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000573c0: 2020 2022 626f 6f6b 223a 2030 2c0a 2020     "book": 0,.  
+000573c0: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
 000573d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000573e0: 2020 2020 2020 226e 6f55 7064 6174 6522        "noUpdate"
-000573f0: 3a20 302c 0a20 2020 2020 2020 2020 2020  : 0,.           
-00057400: 2020 2020 2020 2020 2020 2020 2022 6d61               "ma
-00057410: 726b 7322 3a20 2222 2c0a 2020 2020 2020  rks": "",.      
-00057420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057430: 2020 2261 6273 7472 6163 7422 3a20 4e6f    "abstract": No
-00057440: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-00057450: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-00057460: 7465 7844 6963 7422 3a20 7b0a 2020 2020  texDict": {.    
-00057470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057480: 2020 2020 2020 2020 2245 4e54 5259 5459          "ENTRYTY
-00057490: 5045 223a 2022 6172 7469 636c 6522 2c0a  PE": "article",.
-000574a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000574b0: 2020 2020 2020 2020 2020 2020 2249 4422              "ID"
-000574c0: 3a20 2247 6172 6961 7a7a 6f3a 3230 3135  : "Gariazzo:2015
-000574d0: 7272 6122 2c0a 2020 2020 2020 2020 2020  rra",.          
-000574e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000574f0: 2020 2261 7574 686f 7222 3a20 2247 6172    "author": "Gar
-00057500: 6961 7a7a 6f22 2c0a 2020 2020 2020 2020  iazzo",.        
-00057510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057520: 2020 2020 2274 6974 6c65 223a 2022 7b4c      "title": "{L
-00057530: 6967 6874 2053 7465 7269 6c65 204e 6575  ight Sterile Neu
-00057540: 7472 696e 6f73 7d22 2c0a 2020 2020 2020  trinos}",.      
+000573e0: 2022 7469 746c 6522 3a20 227b 4c69 6768   "title": "{Ligh
+000573f0: 7420 5374 6572 696c 6520 4e65 7574 7269  t Sterile Neutri
+00057400: 6e6f 737d 222c 0a20 2020 2020 2020 2020  nos}",.         
+00057410: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00057420: 6a6f 7572 6e61 6c22 3a20 224a 2e50 6879  journal": "J.Phy
+00057430: 732e 4722 2c0a 2020 2020 2020 2020 2020  s.G",.          
+00057440: 2020 2020 2020 2020 2020 2020 2020 2276                "v
+00057450: 6f6c 756d 6522 3a20 2234 3322 2c0a 2020  olume": "43",.  
+00057460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057470: 2020 2020 2020 226e 756d 6265 7222 3a20        "number": 
+00057480: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+00057490: 2020 2020 2020 2020 2020 2020 2270 6167              "pag
+000574a0: 6573 223a 2022 3033 3330 3031 222c 0a20  es": "033001",. 
+000574b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000574c0: 2020 2020 2020 2022 7075 626c 6973 6865         "publishe
+000574d0: 6422 3a20 224a 2e50 6879 732e 4720 3433  d": "J.Phys.G 43
+000574e0: 2028 3230 3136 2920 3033 3330 3031 222c   (2016) 033001",
+000574f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00057500: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
+00057510: 223a 2022 4761 7269 617a 7a6f 222c 0a20  ": "Gariazzo",. 
+00057520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057530: 2020 2020 2020 2022 6269 6264 6963 7422         "bibdict"
+00057540: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
 00057550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057560: 2020 2020 2020 2264 6f69 223a 2022 3130        "doi": "10
-00057570: 2e31 3038 382f 3039 3534 2d33 3839 392f  .1088/0954-3899/
-00057580: 3433 2f33 2f30 3333 3030 3122 2c0a 2020  43/3/033001",.  
-00057590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000575a0: 2020 2020 2020 2020 2020 2265 7072 696e            "eprin
-000575b0: 7422 3a20 2231 3530 372e 3038 3230 3422  t": "1507.08204"
-000575c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000575d0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
-000575e0: 6167 6573 223a 2022 3033 3330 3031 222c  ages": "033001",
-000575f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00057600: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
-00057610: 7572 6e61 6c22 3a20 224a 2e50 6879 732e  urnal": "J.Phys.
-00057620: 4722 2c0a 2020 2020 2020 2020 2020 2020  G",.            
+00057560: 2249 4422 3a20 2247 6172 6961 7a7a 6f3a  "ID": "Gariazzo:
+00057570: 3230 3135 7272 6122 2c0a 2020 2020 2020  2015rra",.      
+00057580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057590: 2020 2020 2020 2245 4e54 5259 5459 5045        "ENTRYTYPE
+000575a0: 223a 2022 6172 7469 636c 6522 2c0a 2020  ": "article",.  
+000575b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000575c0: 2020 2020 2020 2020 2020 2261 7574 686f            "autho
+000575d0: 7222 3a20 2247 6172 6961 7a7a 6f22 2c0a  r": "Gariazzo",.
+000575e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000575f0: 2020 2020 2020 2020 2020 2020 2264 6f69              "doi
+00057600: 223a 2022 3130 2e31 3038 382f 3039 3534  ": "10.1088/0954
+00057610: 2d33 3839 392f 3433 2f33 2f30 3333 3030  -3899/43/3/03300
+00057620: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
 00057630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057640: 2276 6f6c 756d 6522 3a20 2234 3322 2c0a  "volume": "43",.
-00057650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057660: 2020 2020 2020 2020 2020 2020 2279 6561              "yea
-00057670: 7222 3a20 2232 3031 3622 2c0a 2020 2020  r": "2016",.    
-00057680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057690: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
-000576a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000576b0: 7469 746c 6522 3a20 227b 4c69 6768 7420  title": "{Light 
-000576c0: 5374 6572 696c 6520 4e65 7574 7269 6e6f  Sterile Neutrino
-000576d0: 737d 222c 0a20 2020 2020 2020 2020 2020  s}",.           
-000576e0: 2020 2020 2020 2020 2020 2020 2022 6a6f               "jo
-000576f0: 7572 6e61 6c22 3a20 224a 2e50 6879 732e  urnal": "J.Phys.
-00057700: 4722 2c0a 2020 2020 2020 2020 2020 2020  G",.            
-00057710: 2020 2020 2020 2020 2020 2020 2276 6f6c              "vol
-00057720: 756d 6522 3a20 2234 3322 2c0a 2020 2020  ume": "43",.    
+00057640: 2265 7072 696e 7422 3a20 2231 3530 372e  "eprint": "1507.
+00057650: 3038 3230 3422 2c0a 2020 2020 2020 2020  08204",.        
+00057660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057670: 2020 2020 2270 6167 6573 223a 2022 3033      "pages": "03
+00057680: 3330 3031 222c 0a20 2020 2020 2020 2020  3001",.         
+00057690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000576a0: 2020 2022 6a6f 7572 6e61 6c22 3a20 224a     "journal": "J
+000576b0: 2e50 6879 732e 4722 2c0a 2020 2020 2020  .Phys.G",.      
+000576c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000576d0: 2020 2020 2020 2276 6f6c 756d 6522 3a20        "volume": 
+000576e0: 2234 3322 2c0a 2020 2020 2020 2020 2020  "43",.          
+000576f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057700: 2020 2274 6974 6c65 223a 2022 7b4c 6967    "title": "{Lig
+00057710: 6874 2053 7465 7269 6c65 204e 6575 7472  ht Sterile Neutr
+00057720: 696e 6f73 7d22 2c0a 2020 2020 2020 2020  inos}",.        
 00057730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057740: 2020 2020 226e 756d 6265 7222 3a20 2222      "number": ""
-00057750: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00057760: 2020 2020 2020 2020 2020 2270 6167 6573            "pages
-00057770: 223a 2022 3033 3330 3031 222c 0a20 2020  ": "033001",.   
-00057780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057790: 2020 2020 2022 7075 626c 6973 6865 6422       "published"
-000577a0: 3a20 224a 2e50 6879 732e 4720 3433 2028  : "J.Phys.G 43 (
-000577b0: 3230 3136 2920 3033 3330 3031 222c 0a20  2016) 033001",. 
-000577c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000577d0: 2020 2020 2020 2022 6175 7468 6f72 223a         "author":
-000577e0: 2022 4761 7269 617a 7a6f 222c 0a20 2020   "Gariazzo",.   
-000577f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057800: 2020 2020 2022 6269 6264 6963 7422 3a20       "bibdict": 
-00057810: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00057820: 2020 2020 2020 2020 2020 2020 2020 2249                "I
-00057830: 4422 3a20 2247 6172 6961 7a7a 6f3a 3230  D": "Gariazzo:20
-00057840: 3135 7272 6122 2c0a 2020 2020 2020 2020  15rra",.        
-00057850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057860: 2020 2020 2245 4e54 5259 5459 5045 223a      "ENTRYTYPE":
-00057870: 2022 6172 7469 636c 6522 2c0a 2020 2020   "article",.    
-00057880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057890: 2020 2020 2020 2020 2261 7574 686f 7222          "author"
-000578a0: 3a20 2247 6172 6961 7a7a 6f22 2c0a 2020  : "Gariazzo",.  
-000578b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000578c0: 2020 2020 2020 2020 2020 2264 6f69 223a            "doi":
-000578d0: 2022 3130 2e31 3038 382f 3039 3534 2d33   "10.1088/0954-3
-000578e0: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
-000578f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00057900: 2020 2020 2020 2020 2020 2020 2020 2265                "e
-00057910: 7072 696e 7422 3a20 2231 3530 372e 3038  print": "1507.08
-00057920: 3230 3422 2c0a 2020 2020 2020 2020 2020  204",.          
-00057930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057940: 2020 2270 6167 6573 223a 2022 3033 3330    "pages": "0330
-00057950: 3031 222c 0a20 2020 2020 2020 2020 2020  01",.           
-00057960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057970: 2022 6a6f 7572 6e61 6c22 3a20 224a 2e50   "journal": "J.P
-00057980: 6879 732e 4722 2c0a 2020 2020 2020 2020  hys.G",.        
-00057990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000579a0: 2020 2020 2276 6f6c 756d 6522 3a20 2234      "volume": "4
-000579b0: 3322 2c0a 2020 2020 2020 2020 2020 2020  3",.            
-000579c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000579d0: 2274 6974 6c65 223a 2022 7b4c 6967 6874  "title": "{Light
-000579e0: 2053 7465 7269 6c65 204e 6575 7472 696e   Sterile Neutrin
-000579f0: 6f73 7d22 2c0a 2020 2020 2020 2020 2020  os}",.          
-00057a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057a10: 2020 2279 6561 7222 3a20 2232 3031 3622    "year": "2016"
-00057a20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00057a30: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-00057a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057a50: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
-00057a60: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00057a70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00057a80: 7446 616c 7365 2873 656c 662e 7042 4442  tFalse(self.pBDB
-00057a90: 2e62 6962 732e 7570 6461 7465 496e 666f  .bibs.updateInfo
-00057aa0: 4672 6f6d 4f41 4928 2231 3233 3435 2229  FromOAI("12345")
-00057ab0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00057ac0: 2020 7769 7468 2070 6174 6368 2822 6c6f    with patch("lo
-00057ad0: 6767 696e 672e 4c6f 6767 6572 2e65 7863  gging.Logger.exc
-00057ae0: 6570 7469 6f6e 2229 2061 7320 5f69 3a0a  eption") as _i:.
-00057af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057b00: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-00057b10: 6273 2e75 7064 6174 6549 6e66 6f46 726f  bs.updateInfoFro
-00057b20: 6d4f 4149 2822 3132 3334 3522 290a 2020  mOAI("12345").  
-00057b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057b40: 2020 7365 6c66 2e61 7373 6572 7449 6e28    self.assertIn(
-00057b50: 224b 6579 2065 7272 6f72 3a20 2862 6962  "Key error: (bib
-00057b60: 6b65 7922 2c20 5f69 2e63 616c 6c5f 6172  key", _i.call_ar
-00057b70: 6773 5b30 5d5b 305d 290a 2020 2020 2020  gs[0][0]).      
-00057b80: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00057b90: 7373 6572 7454 7275 6528 7365 6c66 2e70  ssertTrue(self.p
-00057ba0: 4244 422e 6269 6273 2e75 7064 6174 6549  BDB.bibs.updateI
-00057bb0: 6e66 6f46 726f 6d4f 4149 2822 3132 3334  nfoFromOAI("1234
-00057bc0: 3522 2929 0a0a 2020 2020 4075 6e69 7474  5"))..    @unitt
-00057bd0: 6573 742e 736b 6970 4966 2873 6b69 7054  est.skipIf(skipT
-00057be0: 6573 7473 5365 7474 696e 6773 2e6f 6e6c  estsSettings.onl
-00057bf0: 696e 652c 2022 4f6e 6c69 6e65 2074 6573  ine, "Online tes
-00057c00: 7473 2229 0a20 2020 2064 6566 2074 6573  ts").    def tes
-00057c10: 745f 7570 6461 7465 496e 7370 6972 6549  t_updateInspireI
-00057c20: 4428 7365 6c66 2c20 2a61 7267 7329 3a0a  D(self, *args):.
-00057c30: 2020 2020 2020 2020 2222 2274 6573 7473          """tests
-00057c40: 2066 6f72 2075 7064 6174 6549 6e73 7069   for updateInspi
-00057c50: 7265 4944 2028 6f6e 6c69 6e65 2922 2222  reID (online)"""
-00057c60: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-00057c70: 4442 2e62 6962 732e 696e 7365 7274 4672  DB.bibs.insertFr
-00057c80: 6f6d 4269 6274 6578 280a 2020 2020 2020  omBibtex(.      
-00057c90: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
-00057ca0: 4761 7269 617a 7a6f 3a32 3031 3572 7261  Gariazzo:2015rra
-00057cb0: 2c5c 6e61 7278 6976 3d22 3135 3037 2e30  ,\narxiv="1507.0
-00057cc0: 3832 3034 225c 6e7d 270a 2020 2020 2020  8204"\n}'.      
-00057cd0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00057ce0: 2e61 7373 6572 7445 7175 616c 2873 656c  .assertEqual(sel
-00057cf0: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
-00057d00: 7465 496e 7370 6972 6549 4428 2247 6172  teInspireID("Gar
-00057d10: 6961 7a7a 6f3a 3230 3135 7272 6122 292c  iazzo:2015rra"),
-00057d20: 2022 3133 3835 3538 3322 290a 2020 2020   "1385583").    
-00057d30: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00057d40: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-00057d50: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00057d60: 2e75 7064 6174 6549 6e73 7069 7265 4944  .updateInspireID
-00057d70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00057d80: 2020 2261 2047 6172 6961 7a7a 6f20 616e    "a Gariazzo an
-00057d90: 6420 6420 3230 3135 222c 2022 4761 7269  d d 2015", "Gari
-00057da0: 617a 7a6f 3a32 3031 3572 7261 222c 206e  azzo:2015rra", n
-00057db0: 756d 6265 723d 330a 2020 2020 2020 2020  umber=3.        
-00057dc0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-00057dd0: 2020 2022 3133 3835 3538 3322 2c0a 2020     "1385583",.  
-00057de0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00057df0: 7365 6c66 2e70 4244 422e 6269 6273 2e64  self.pBDB.bibs.d
-00057e00: 656c 6574 6528 2247 6172 6961 7a7a 6f3a  elete("Gariazzo:
-00057e10: 3230 3135 7272 6122 290a 2020 2020 2020  2015rra").      
-00057e20: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-00057e30: 2e69 6e73 6572 7446 726f 6d42 6962 7465  .insertFromBibte
-00057e40: 7828 0a20 2020 2020 2020 2020 2020 2027  x(.            '
-00057e50: 4061 7274 6963 6c65 7b47 6172 6961 7a7a  @article{Gariazz
-00057e60: 6f3a 3230 3135 2c5c 6e61 7278 6976 3d22  o:2015,\narxiv="
-00057e70: 3135 3037 2e30 3832 3034 225c 6e7d 270a  1507.08204"\n}'.
-00057e80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00057e90: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00057ea0: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
-00057eb0: 732e 7570 6461 7465 496e 7370 6972 6549  s.updateInspireI
-00057ec0: 4428 2247 6172 6961 7a7a 6f3a 3230 3135  D("Gariazzo:2015
-00057ed0: 7272 6122 292c 2022 3133 3835 3538 3322  rra"), "1385583"
-00057ee0: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
-00057ef0: 4244 422e 6269 6273 2e64 656c 6574 6528  BDB.bibs.delete(
-00057f00: 2247 6172 6961 7a7a 6f3a 3230 3135 2229  "Gariazzo:2015")
-00057f10: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-00057f20: 4442 2e62 6962 732e 696e 7365 7274 4672  DB.bibs.insertFr
-00057f30: 6f6d 4269 6274 6578 280a 2020 2020 2020  omBibtex(.      
-00057f40: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
-00057f50: 4761 7269 617a 7a6f 3a32 3031 352c 5c6e  Gariazzo:2015,\n
-00057f60: 646f 693d 2231 302e 3130 3838 2f30 3935  doi="10.1088/095
-00057f70: 342d 3338 3939 2f34 332f 332f 3033 3330  4-3899/43/3/0330
-00057f80: 3031 2227 0a20 2020 2020 2020 2020 2020  01"'.           
-00057f90: 202b 2027 5c6e 6172 7869 763d 2231 3530   + '\narxiv="150
-00057fa0: 3730 3832 3034 225c 6e7d 270a 2020 2020  708204"\n}'.    
-00057fb0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00057fc0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-00057fd0: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
-00057fe0: 6461 7465 496e 7370 6972 6549 4428 2247  dateInspireID("G
-00057ff0: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
-00058000: 292c 2022 3133 3835 3538 3322 290a 2020  ), "1385583").  
-00058010: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-00058020: 6269 6273 2e64 656c 6574 6528 2247 6172  bibs.delete("Gar
-00058030: 6961 7a7a 6f3a 3230 3135 2229 0a20 2020  iazzo:2015").   
-00058040: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-00058050: 6962 732e 696e 7365 7274 4672 6f6d 4269  ibs.insertFromBi
-00058060: 6274 6578 280a 2020 2020 2020 2020 2020  btex(.          
-00058070: 2020 2740 6172 7469 636c 657b 4761 7269    '@article{Gari
-00058080: 617a 7a6f 3a32 3031 352c 5c6e 646f 693d  azzo:2015,\ndoi=
-00058090: 2231 302e 3130 3838 3039 3534 2d33 3839  "10.10880954-389
-000580a0: 3934 3333 3033 3330 3031 2227 0a20 2020  9433033001"'.   
-000580b0: 2020 2020 2020 2020 202b 2027 5c6e 6172           + '\nar
-000580c0: 7869 763d 2231 3530 372e 3038 3230 3422  xiv="1507.08204"
-000580d0: 5c6e 7d27 0a20 2020 2020 2020 2029 0a20  \n}'.        ). 
-000580e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000580f0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
-00058100: 422e 6269 6273 2e75 7064 6174 6549 6e73  B.bibs.updateIns
-00058110: 7069 7265 4944 2822 4761 7269 617a 7a6f  pireID("Gariazzo
-00058120: 3a32 3031 3572 7261 2229 2c20 2231 3338  :2015rra"), "138
-00058130: 3535 3833 2229 0a20 2020 2020 2020 2073  5583").        s
-00058140: 656c 662e 7042 4442 2e62 6962 732e 6465  elf.pBDB.bibs.de
-00058150: 6c65 7465 2822 4761 7269 617a 7a6f 3a32  lete("Gariazzo:2
-00058160: 3031 3522 290a 2020 2020 2020 2020 7365  015").        se
-00058170: 6c66 2e70 4244 422e 6269 6273 2e69 6e73  lf.pBDB.bibs.ins
-00058180: 6572 7446 726f 6d42 6962 7465 7828 0a20  ertFromBibtex(. 
-00058190: 2020 2020 2020 2020 2020 2027 4061 7274             '@art
-000581a0: 6963 6c65 7b47 6172 6961 7a7a 6f3a 3230  icle{Gariazzo:20
-000581b0: 3135 2c5c 6e74 6974 6c65 3d22 4c69 6768  15,\ntitle="Ligh
-000581c0: 7420 5374 6572 696c 6520 4e65 7574 7269  t Sterile Neutri
-000581d0: 6e6f 225c 6e7d 270a 2020 2020 2020 2020  no"\n}'.        
-000581e0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000581f0: 7373 6572 7446 616c 7365 280a 2020 2020  ssertFalse(.    
-00058200: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00058210: 422e 6269 6273 2e75 7064 6174 6549 6e73  B.bibs.updateIns
-00058220: 7069 7265 4944 2822 4761 7269 617a 7a6f  pireID("Gariazzo
-00058230: 3a32 3031 3572 222c 2022 4761 7269 617a  :2015r", "Gariaz
-00058240: 7a6f 3a32 3031 3572 7261 2229 0a20 2020  zo:2015rra").   
-00058250: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00058260: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
-00058270: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-00058280: 7064 6174 6549 6e73 7069 7265 4944 2822  pdateInspireID("
-00058290: 6162 6364 6566 6768 6922 2929 0a20 2020  abcdefghi")).   
-000582a0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000582b0: 6962 732e 6465 6c65 7465 2822 4761 7269  ibs.delete("Gari
-000582c0: 617a 7a6f 3a32 3031 3522 290a 2020 2020  azzo:2015").    
-000582d0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
-000582e0: 6273 2e69 6e73 6572 7446 726f 6d42 6962  bs.insertFromBib
-000582f0: 7465 7828 0a20 2020 2020 2020 2020 2020  tex(.           
-00058300: 2027 4061 7274 6963 6c65 7b47 6172 6961   '@article{Garia
-00058310: 7a7a 6f3a 3230 3135 2c5c 6e64 6f69 3d22  zzo:2015,\ndoi="
-00058320: 3130 2e31 3038 382f 3039 3534 2d33 3839  10.1088/0954-389
-00058330: 392f 3433 2f33 2f30 3333 3030 3122 270a  9/43/3/033001"'.
-00058340: 2020 2020 2020 2020 2020 2020 2b20 275c              + '\
-00058350: 6e61 7278 6976 3d22 3135 3037 3038 3230  narxiv="15070820
-00058360: 3422 5c6e 7d27 0a20 2020 2020 2020 2029  4"\n}'.        )
-00058370: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
-00058380: 4442 2e62 6962 732e 7570 6461 7465 4669  DB.bibs.updateFi
-00058390: 656c 6428 2247 6172 6961 7a7a 6f3a 3230  eld("Gariazzo:20
-000583a0: 3135 222c 2022 696e 7370 6972 6549 4422  15", "inspireID"
-000583b0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-000583c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000583d0: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
-000583e0: 7570 6461 7465 496e 7370 6972 6549 4428  updateInspireID(
-000583f0: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
-00058400: 6122 292c 2022 3133 3835 3538 3322 290a  a"), "1385583").
-00058410: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-00058420: 422e 6269 6273 2e64 656c 6574 6528 2247  B.bibs.delete("G
-00058430: 6172 6961 7a7a 6f3a 3230 3135 2229 0a20  ariazzo:2015"). 
-00058440: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
-00058450: 2e62 6962 732e 696e 7365 7274 4672 6f6d  .bibs.insertFrom
-00058460: 4269 6274 6578 280a 2020 2020 2020 2020  Bibtex(.        
-00058470: 2020 2020 2740 6172 7469 636c 657b 4761      '@article{Ga
-00058480: 7269 617a 7a6f 3a32 3031 352c 5c6e 7469  riazzo:2015,\nti
-00058490: 746c 653d 224c 6967 6874 2053 7465 7269  tle="Light Steri
-000584a0: 6c65 204e 6575 7472 696e 6f22 5c6e 7d27  le Neutrino"\n}'
-000584b0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000584c0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-000584d0: 732e 7570 6461 7465 4669 656c 6428 2247  s.updateField("G
-000584e0: 6172 6961 7a7a 6f3a 3230 3135 222c 2022  ariazzo:2015", "
-000584f0: 696e 7370 6972 6549 4422 2c20 4e6f 6e65  inspireID", None
-00058500: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00058510: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
-00058520: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
-00058530: 496e 7370 6972 6549 4428 2247 6172 6961  InspireID("Garia
-00058540: 7a7a 6f3a 3230 3135 6162 6364 2229 290a  zzo:2015abcd")).
-00058550: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00058560: 7365 7274 4661 6c73 6528 7365 6c66 2e70  sertFalse(self.p
-00058570: 4244 422e 6269 6273 2e75 7064 6174 6549  BDB.bibs.updateI
-00058580: 6e73 7069 7265 4944 2822 6162 6364 6566  nspireID("abcdef
-00058590: 6768 6922 2929 0a0a 2020 2020 6465 6620  ghi"))..    def 
-000585a0: 7465 7374 5f74 6f44 6174 6144 6963 7428  test_toDataDict(
-000585b0: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
-000585c0: 2020 2020 2020 2222 2274 6573 7420 746f        """test to
-000585d0: 4461 7461 4469 6374 2222 220a 2020 2020  DataDict""".    
-000585e0: 2020 2020 7365 6c66 2e69 6e73 6572 745f      self.insert_
-000585f0: 7468 7265 6528 290a 2020 2020 2020 2020  three().        
-00058600: 6120 3d20 7365 6c66 2e70 4244 422e 6269  a = self.pBDB.bi
-00058610: 6273 2e74 6f44 6174 6144 6963 7428 2261  bs.toDataDict("a
-00058620: 6263 2229 0a20 2020 2020 2020 2073 656c  bc").        sel
-00058630: 662e 6173 7365 7274 4571 7561 6c28 615b  f.assertEqual(a[
-00058640: 2262 6962 6b65 7922 5d2c 2022 6162 6322  "bibkey"], "abc"
-00058650: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00058660: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00058670: 2020 2020 2020 2020 615b 2262 6962 7465          a["bibte
-00058680: 7822 5d2c 0a20 2020 2020 2020 2020 2020  x"],.           
-00058690: 2027 4041 7274 6963 6c65 7b61 6263 2c5c   '@Article{abc,\
-000586a0: 6e20 2020 2020 2020 2061 7574 686f 7220  n        author 
-000586b0: 3d20 226d 6522 2c5c 6e20 2020 2020 2020  = "me",\n       
-000586c0: 2020 2720 2b20 2774 6974 6c65 203d 2022    ' + 'title = "
-000586d0: 7b61 6263 7d22 2c5c 6e7d 272c 0a20 2020  {abc}",\n}',.   
-000586e0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-000586f0: 7465 7374 5f75 7064 6174 6552 6563 6f72  test_updateRecor
-00058700: 6428 7365 6c66 2c20 2a61 7267 7329 3a0a  d(self, *args):.
-00058710: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
-00058720: 7570 6461 7465 5265 636f 7264 2222 220a  updateRecord""".
-00058730: 2020 2020 2020 2020 6520 3d20 7b22 6269          e = {"bi
-00058740: 626b 6579 223a 2022 6162 6322 2c20 2262  bkey": "abc", "b
-00058750: 6962 7465 7822 3a20 2262 6962 222c 2022  ibtex": "bib", "
-00058760: 696e 7370 6972 6522 3a20 2231 3233 222c  inspire": "123",
-00058770: 2022 7072 6f63 6565 6469 6e67 223a 2030   "proceeding": 0
-00058780: 7d0a 2020 2020 2020 2020 6e20 3d20 7b22  }.        n = {"
-00058790: 6269 626b 6579 223a 2022 6162 6364 222c  bibkey": "abcd",
-000587a0: 2022 6269 6274 6578 223a 2022 6269 6274   "bibtex": "bibt
-000587b0: 6578 222c 2022 696e 7370 6972 6522 3a20  ex", "inspire": 
-000587c0: 2231 3233 222c 2022 7072 6f63 6565 6469  "123", "proceedi
-000587d0: 6e67 223a 2030 7d0a 2020 2020 2020 2020  ng": 0}.        
-000587e0: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
-000587f0: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
-00058800: 6c69 6f2e 6461 7461 6261 7365 2e45 6e74  lio.database.Ent
-00058810: 7269 6573 2e75 7064 6174 6549 6e66 6f46  ries.updateInfoF
-00058820: 726f 6d4f 4149 222c 0a20 2020 2020 2020  romOAI",.       
-00058830: 2020 2020 2073 6964 655f 6566 6665 6374       side_effect
-00058840: 3d5b 4661 6c73 652c 2054 7275 652c 2054  =[False, True, T
-00058850: 7275 652c 2054 7275 655d 2c0a 2020 2020  rue, True],.    
-00058860: 2020 2020 2920 6173 205f 7569 2c20 7061      ) as _ui, pa
-00058870: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
-00058880: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
-00058890: 6162 6173 652e 456e 7472 6965 732e 6765  abase.Entries.ge
-000588a0: 7442 794b 6579 222c 2072 6574 7572 6e5f  tByKey", return_
-000588b0: 7661 6c75 653d 5b65 5d0a 2020 2020 2020  value=[e].      
-000588c0: 2020 2920 6173 205f 676b 3a0a 2020 2020    ) as _gk:.    
-000588d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000588e0: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
-000588f0: 4442 2e62 6962 732e 7570 6461 7465 5265  DB.bibs.updateRe
-00058900: 636f 7264 2865 2e63 6f70 7928 292c 207b  cord(e.copy(), {
-00058910: 2262 223a 2022 6122 7d29 290a 2020 2020  "b": "a"})).    
-00058920: 2020 2020 2020 2020 5f75 692e 6173 7365          _ui.asse
-00058930: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-00058940: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
-00058950: 2020 2020 2022 3132 3322 2c0a 2020 2020       "123",.    
-00058960: 2020 2020 2020 2020 2020 2020 6269 6274              bibt
-00058970: 6578 3d22 6269 6222 2c0a 2020 2020 2020  ex="bib",.      
-00058980: 2020 2020 2020 2020 2020 7265 6164 436f            readCo
-00058990: 6e66 6572 656e 6365 5469 746c 653d 4661  nferenceTitle=Fa
-000589a0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-000589b0: 2020 2020 2072 656c 6f61 6441 6c6c 3d46       reloadAll=F
-000589c0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-000589d0: 2020 2020 2020 6f72 6967 696e 616c 4b65        originalKe
-000589e0: 793d 2261 6263 222c 0a20 2020 2020 2020  y="abc",.       
-000589f0: 2020 2020 2020 2020 2075 7365 5265 636f           useReco
-00058a00: 7264 3d7b 2262 223a 2022 6122 7d2c 0a20  rd={"b": "a"},. 
-00058a10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00058a20: 2020 2020 2020 2020 205f 676b 2e61 7373           _gk.ass
-00058a30: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
-00058a40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00058a50: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
-00058a60: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-00058a70: 6174 6552 6563 6f72 6428 652e 636f 7079  ateRecord(e.copy
-00058a80: 2829 2c20 7b22 6222 3a20 2261 227d 2929  (), {"b": "a"}))
-00058a90: 0a20 2020 2020 2020 2020 2020 205f 676b  .            _gk
-00058aa0: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-00058ab0: 6e63 655f 7769 7468 2822 6162 6322 2c20  nce_with("abc", 
-00058ac0: 7361 7665 5175 6572 793d 4661 6c73 6529  saveQuery=False)
-00058ad0: 0a20 2020 2020 2020 2020 2020 205f 676b  .            _gk
-00058ae0: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
-00058af0: 5b6e 5d0a 2020 2020 2020 2020 2020 2020  [n].            
-00058b00: 5f75 692e 7265 7365 745f 6d6f 636b 2829  _ui.reset_mock()
-00058b10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00058b20: 662e 6173 7365 7274 5472 7565 280a 2020  f.assertTrue(.  
-00058b30: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00058b40: 6c66 2e70 4244 422e 6269 6273 2e75 7064  lf.pBDB.bibs.upd
-00058b50: 6174 6552 6563 6f72 6428 0a20 2020 2020  ateRecord(.     
-00058b60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00058b70: 2e63 6f70 7928 292c 207b 2262 223a 2022  .copy(), {"b": "
-00058b80: 6122 7d2c 2066 6f72 6365 3d54 7275 652c  a"}, force=True,
-00058b90: 2072 656c 6f61 6441 6c6c 3d54 7275 650a   reloadAll=True.
-00058ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058bb0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00058bc0: 2020 2020 2020 2020 2020 2020 5f75 692e              _ui.
-00058bd0: 6173 7365 7274 5f63 616c 6c65 645f 6f6e  assert_called_on
-00058be0: 6365 5f77 6974 6828 0a20 2020 2020 2020  ce_with(.       
-00058bf0: 2020 2020 2020 2020 2022 3132 3322 2c0a           "123",.
-00058c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058c10: 6269 6274 6578 3d22 6269 6222 2c0a 2020  bibtex="bib",.  
-00058c20: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00058c30: 6164 436f 6e66 6572 656e 6365 5469 746c  adConferenceTitl
-00058c40: 653d 4661 6c73 652c 0a20 2020 2020 2020  e=False,.       
-00058c50: 2020 2020 2020 2020 2072 656c 6f61 6441           reloadA
-00058c60: 6c6c 3d54 7275 652c 0a20 2020 2020 2020  ll=True,.       
-00058c70: 2020 2020 2020 2020 206f 7269 6769 6e61           origina
-00058c80: 6c4b 6579 3d22 6162 6322 2c0a 2020 2020  lKey="abc",.    
-00058c90: 2020 2020 2020 2020 2020 2020 7573 6552              useR
-00058ca0: 6563 6f72 643d 7b22 6222 3a20 2261 227d  ecord={"b": "a"}
-00058cb0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00058cc0: 2020 2020 2020 2020 2020 2020 655b 2270              e["p
-00058cd0: 726f 6365 6564 696e 6722 5d20 3d20 310a  roceeding"] = 1.
-00058ce0: 2020 2020 2020 2020 2020 2020 5f75 692e              _ui.
-00058cf0: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
-00058d00: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00058d10: 7365 7274 5472 7565 280a 2020 2020 2020  sertTrue(.      
-00058d20: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00058d30: 4244 422e 6269 6273 2e75 7064 6174 6552  BDB.bibs.updateR
-00058d40: 6563 6f72 6428 0a20 2020 2020 2020 2020  ecord(.         
-00058d50: 2020 2020 2020 2020 2020 2065 2e63 6f70             e.cop
-00058d60: 7928 292c 207b 2262 223a 2022 6122 7d2c  y(), {"b": "a"},
-00058d70: 2066 6f72 6365 3d54 7275 652c 2072 656c   force=True, rel
-00058d80: 6f61 6441 6c6c 3d54 7275 650a 2020 2020  oadAll=True.    
-00058d90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00058da0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00058db0: 2020 2020 2020 2020 5f75 692e 6173 7365          _ui.asse
-00058dc0: 7274 5f63 616c 6c65 645f 6f6e 6365 5f77  rt_called_once_w
-00058dd0: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
-00058de0: 2020 2020 2022 3132 3322 2c0a 2020 2020       "123",.    
-00058df0: 2020 2020 2020 2020 2020 2020 6269 6274              bibt
-00058e00: 6578 3d22 6269 6222 2c0a 2020 2020 2020  ex="bib",.      
-00058e10: 2020 2020 2020 2020 2020 7265 6164 436f            readCo
-00058e20: 6e66 6572 656e 6365 5469 746c 653d 5472  nferenceTitle=Tr
-00058e30: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00058e40: 2020 2020 7265 6c6f 6164 416c 6c3d 5472      reloadAll=Tr
-00058e50: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00058e60: 2020 2020 6f72 6967 696e 616c 4b65 793d      originalKey=
-00058e70: 2261 6263 222c 0a20 2020 2020 2020 2020  "abc",.         
-00058e80: 2020 2020 2020 2075 7365 5265 636f 7264         useRecord
-00058e90: 3d7b 2262 223a 2022 6122 7d2c 0a20 2020  ={"b": "a"},.   
-00058ea0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00058eb0: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00058ec0: 732e 6e65 774b 6579 203d 2022 6465 6622  s.newKey = "def"
-00058ed0: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-00058ee0: 7463 6828 0a20 2020 2020 2020 2020 2020  tch(.           
-00058ef0: 2022 7068 7973 6269 626c 696f 2e64 6174   "physbiblio.dat
-00058f00: 6162 6173 652e 456e 7472 6965 732e 7570  abase.Entries.up
-00058f10: 6461 7465 496e 666f 4672 6f6d 4f41 4922  dateInfoFromOAI"
-00058f20: 2c20 7265 7475 726e 5f76 616c 7565 3d54  , return_value=T
-00058f30: 7275 650a 2020 2020 2020 2020 2920 6173  rue.        ) as
-00058f40: 205f 7569 2c20 7061 7463 6828 0a20 2020   _ui, patch(.   
-00058f50: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
-00058f60: 626c 696f 2e64 6174 6162 6173 652e 456e  blio.database.En
-00058f70: 7472 6965 732e 6765 7442 794b 6579 222c  tries.getByKey",
-00058f80: 2073 6964 655f 6566 6665 6374 3d5b 5b5d   side_effect=[[]
-00058f90: 2c20 5b6e 5d2c 205b 5d2c 205b 5d5d 0a20  , [n], [], []]. 
-00058fa0: 2020 2020 2020 2029 2061 7320 5f67 6b3a         ) as _gk:
-00058fb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00058fc0: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-00058fd0: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
-00058fe0: 7465 5265 636f 7264 2865 2e63 6f70 7928  teRecord(e.copy(
-00058ff0: 292c 207b 2262 223a 2022 6122 7d29 290a  ), {"b": "a"})).
-00059000: 2020 2020 2020 2020 2020 2020 5f75 692e              _ui.
-00059010: 6173 7365 7274 5f63 616c 6c65 645f 7769  assert_called_wi
-00059020: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
-00059030: 2020 2020 2231 3233 222c 0a20 2020 2020      "123",.     
-00059040: 2020 2020 2020 2020 2020 2062 6962 7465             bibte
-00059050: 783d 2262 6962 222c 0a20 2020 2020 2020  x="bib",.       
-00059060: 2020 2020 2020 2020 2072 6561 6443 6f6e           readCon
-00059070: 6665 7265 6e63 6554 6974 6c65 3d46 616c  ferenceTitle=Fal
-00059080: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00059090: 2020 2020 7265 6c6f 6164 416c 6c3d 4661      reloadAll=Fa
-000590a0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-000590b0: 2020 2020 206f 7269 6769 6e61 6c4b 6579       originalKey
-000590c0: 3d22 6162 6322 2c0a 2020 2020 2020 2020  ="abc",.        
-000590d0: 2020 2020 2020 2020 7573 6552 6563 6f72          useRecor
-000590e0: 643d 7b22 6222 3a20 2261 227d 2c0a 2020  d={"b": "a"},.  
-000590f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00059100: 2020 2020 2020 2020 5f67 6b2e 6173 7365          _gk.asse
-00059110: 7274 5f61 6e79 5f63 616c 6c28 2261 6263  rt_any_call("abc
-00059120: 222c 2073 6176 6551 7565 7279 3d46 616c  ", saveQuery=Fal
-00059130: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-00059140: 5f67 6b2e 6173 7365 7274 5f61 6e79 5f63  _gk.assert_any_c
-00059150: 616c 6c28 2264 6566 222c 2073 6176 6551  all("def", saveQ
-00059160: 7565 7279 3d46 616c 7365 290a 2020 2020  uery=False).    
-00059170: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00059180: 6572 7446 616c 7365 2868 6173 6174 7472  ertFalse(hasattr
-00059190: 2873 656c 662e 7042 4442 2e62 6962 732c  (self.pBDB.bibs,
-000591a0: 2022 6e65 774b 6579 2229 290a 2020 2020   "newKey")).    
-000591b0: 2020 2020 2020 2020 5f67 6b2e 7265 7365          _gk.rese
-000591c0: 745f 6d6f 636b 2829 0a20 2020 2020 2020  t_mock().       
-000591d0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
-000591e0: 6962 732e 6e65 774b 6579 203d 2022 6465  ibs.newKey = "de
-000591f0: 6622 0a20 2020 2020 2020 2020 2020 2073  f".            s
-00059200: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
-00059210: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-00059220: 7064 6174 6552 6563 6f72 6428 652e 636f  pdateRecord(e.co
-00059230: 7079 2829 2c20 7b22 6222 3a20 2261 227d  py(), {"b": "a"}
-00059240: 2929 0a20 2020 2020 2020 2020 2020 205f  )).            _
-00059250: 676b 2e61 7373 6572 745f 616e 795f 6361  gk.assert_any_ca
-00059260: 6c6c 2822 6162 6322 2c20 7361 7665 5175  ll("abc", saveQu
-00059270: 6572 793d 4661 6c73 6529 0a20 2020 2020  ery=False).     
-00059280: 2020 2020 2020 205f 676b 2e61 7373 6572         _gk.asser
-00059290: 745f 616e 795f 6361 6c6c 2822 6465 6622  t_any_call("def"
-000592a0: 2c20 7361 7665 5175 6572 793d 4661 6c73  , saveQuery=Fals
-000592b0: 6529 0a0a 2020 2020 6465 6620 7465 7374  e)..    def test
-000592c0: 5f75 7064 6174 6552 6563 6f72 6446 726f  _updateRecordFro
-000592d0: 6d49 4e53 5049 5245 2873 656c 662c 202a  mINSPIRE(self, *
-000592e0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-000592f0: 2222 7465 7374 2075 7064 6174 6552 6563  ""test updateRec
-00059300: 6f72 6446 726f 6d49 4e53 5049 5245 2222  ordFromINSPIRE""
-00059310: 220a 2020 2020 2020 2020 7365 6c66 2e69  ".        self.i
-00059320: 6e73 6572 745f 7468 7265 6528 290a 2020  nsert_three().  
-00059330: 2020 2020 2020 7769 7468 2070 6174 6368        with patch
-00059340: 280a 2020 2020 2020 2020 2020 2020 2270  (.            "p
-00059350: 6879 7362 6962 6c69 6f2e 6461 7461 6261  hysbiblio.databa
-00059360: 7365 2e45 6e74 7269 6573 2e67 6574 4279  se.Entries.getBy
-00059370: 4964 4672 6f6d 496e 7370 6972 6552 6563  IdFromInspireRec
-00059380: 6f72 6422 2c20 7265 7475 726e 5f76 616c  ord", return_val
-00059390: 7565 3d5b 5d0a 2020 2020 2020 2020 2920  ue=[].        ) 
-000593a0: 6173 205f 6769 722c 2070 6174 6368 2822  as _gir, patch("
-000593b0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-000593c0: 6173 652e 456e 7472 6965 732e 7570 6461  ase.Entries.upda
-000593d0: 7465 4669 656c 6422 2920 6173 205f 7566  teField") as _uf
-000593e0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000593f0: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-00059400: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
-00059410: 6461 7465 5265 636f 7264 4672 6f6d 494e  dateRecordFromIN
-00059420: 5350 4952 4528 2261 6263 2229 2c20 4661  SPIRE("abc"), Fa
-00059430: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-00059440: 205f 6769 722e 6173 7365 7274 5f63 616c   _gir.assert_cal
-00059450: 6c65 645f 6f6e 6365 5f77 6974 6828 2261  led_once_with("a
-00059460: 6263 2229 0a20 2020 2020 2020 2020 2020  bc").           
-00059470: 205f 7566 2e61 7373 6572 745f 6e6f 745f   _uf.assert_not_
-00059480: 6361 6c6c 6564 2829 0a20 2020 2020 2020  called().       
-00059490: 2077 6974 6820 7061 7463 6828 0a20 2020   with patch(.   
-000594a0: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
-000594b0: 626c 696f 2e64 6174 6162 6173 652e 456e  blio.database.En
-000594c0: 7472 6965 732e 6765 7442 7949 6446 726f  tries.getByIdFro
-000594d0: 6d49 6e73 7069 7265 5265 636f 7264 222c  mInspireRecord",
-000594e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000594f0: 7572 6e5f 7661 6c75 653d 5b7b 226e 6f55  urn_value=[{"noU
-00059500: 7064 6174 6522 3a20 317d 5d2c 0a20 2020  pdate": 1}],.   
-00059510: 2020 2020 2029 2061 7320 5f67 6972 2c20       ) as _gir, 
-00059520: 7061 7463 6828 2270 6879 7362 6962 6c69  patch("physbibli
-00059530: 6f2e 6461 7461 6261 7365 2e45 6e74 7269  o.database.Entri
-00059540: 6573 2e75 7064 6174 6546 6965 6c64 2229  es.updateField")
-00059550: 2061 7320 5f75 663a 0a20 2020 2020 2020   as _uf:.       
-00059560: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00059570: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-00059580: 6269 6273 2e75 7064 6174 6552 6563 6f72  bibs.updateRecor
-00059590: 6446 726f 6d49 4e53 5049 5245 2822 6162  dFromINSPIRE("ab
-000595a0: 6322 292c 2046 616c 7365 290a 2020 2020  c"), False).    
-000595b0: 2020 2020 2020 2020 5f67 6972 2e61 7373          _gir.ass
-000595c0: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-000595d0: 7769 7468 2822 6162 6322 290a 2020 2020  with("abc").    
-000595e0: 2020 2020 2020 2020 5f75 662e 6173 7365          _uf.asse
-000595f0: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
-00059600: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-00059610: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-00059620: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
-00059630: 6261 7365 2e45 6e74 7269 6573 2e67 6574  base.Entries.get
-00059640: 4279 4964 4672 6f6d 496e 7370 6972 6552  ByIdFromInspireR
-00059650: 6563 6f72 6422 2c0a 2020 2020 2020 2020  ecord",.        
-00059660: 2020 2020 7265 7475 726e 5f76 616c 7565      return_value
-00059670: 3d5b 7b22 6e6f 5570 6461 7465 223a 2030  =[{"noUpdate": 0
-00059680: 2c20 2262 6962 6b65 7922 3a20 2261 6263  , "bibkey": "abc
-00059690: 222c 2022 6269 6274 6578 223a 2022 6269  ", "bibtex": "bi
-000596a0: 6222 7d5d 2c0a 2020 2020 2020 2020 2920  b"}],.        ) 
-000596b0: 6173 205f 6769 722c 2070 6174 6368 2822  as _gir, patch("
-000596c0: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
-000596d0: 6173 652e 456e 7472 6965 732e 7570 6461  ase.Entries.upda
-000596e0: 7465 4669 656c 6422 2920 6173 205f 7566  teField") as _uf
-000596f0: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
-00059700: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
-00059710: 2e77 6562 696d 706f 7274 2e69 6e73 7069  .webimport.inspi
-00059720: 7265 2e57 6562 5365 6172 6368 2e75 7064  re.WebSearch.upd
-00059730: 6174 6542 6962 7465 7822 2c0a 2020 2020  ateBibtex",.    
-00059740: 2020 2020 2020 2020 7265 7475 726e 5f76          return_v
-00059750: 616c 7565 3d28 4661 6c73 652c 2022 6269  alue=(False, "bi
-00059760: 6274 6578 2229 2c0a 2020 2020 2020 2020  btex"),.        
-00059770: 2920 6173 205f 7562 3a0a 2020 2020 2020  ) as _ub:.      
-00059780: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00059790: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-000597a0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-000597b0: 422e 6269 6273 2e75 7064 6174 6552 6563  B.bibs.updateRec
-000597c0: 6f72 6446 726f 6d49 4e53 5049 5245 287b  ordFromINSPIRE({
-000597d0: 2269 6422 3a20 2261 6263 227d 292c 2046  "id": "abc"}), F
-000597e0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-000597f0: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-00059800: 6769 722e 6173 7365 7274 5f63 616c 6c65  gir.assert_calle
-00059810: 645f 6f6e 6365 5f77 6974 6828 7b22 6964  d_once_with({"id
-00059820: 223a 2022 6162 6322 7d29 0a20 2020 2020  ": "abc"}).     
-00059830: 2020 2020 2020 205f 7566 2e61 7373 6572         _uf.asser
-00059840: 745f 6e6f 745f 6361 6c6c 6564 2829 0a20  t_not_called(). 
-00059850: 2020 2020 2020 2020 2020 205f 7562 2e61             _ub.a
-00059860: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00059870: 655f 7769 7468 287b 2269 6422 3a20 2261  e_with({"id": "a
-00059880: 6263 227d 2c20 2262 6962 222c 2066 6f72  bc"}, "bib", for
-00059890: 6365 3d46 616c 7365 290a 2020 2020 2020  ce=False).      
-000598a0: 2020 7769 7468 2070 6174 6368 280a 2020    with patch(.  
-000598b0: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
-000598c0: 6962 6c69 6f2e 6461 7461 6261 7365 2e45  iblio.database.E
-000598d0: 6e74 7269 6573 2e67 6574 4279 4964 4672  ntries.getByIdFr
-000598e0: 6f6d 496e 7370 6972 6552 6563 6f72 6422  omInspireRecord"
-000598f0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-00059900: 7475 726e 5f76 616c 7565 3d5b 0a20 2020  turn_value=[.   
-00059910: 2020 2020 2020 2020 2020 2020 207b 226e               {"n
-00059920: 6f55 7064 6174 6522 3a20 302c 2022 6269  oUpdate": 0, "bi
-00059930: 626b 6579 223a 2022 6162 6322 2c20 2262  bkey": "abc", "b
-00059940: 6962 7465 7822 3a20 2262 6962 222c 2022  ibtex": "bib", "
-00059950: 696e 7370 6972 6522 3a20 2231 3233 3522  inspire": "1235"
-00059960: 7d0a 2020 2020 2020 2020 2020 2020 5d2c  }.            ],
-00059970: 0a20 2020 2020 2020 2029 2061 7320 5f67  .        ) as _g
-00059980: 6972 2c20 7061 7463 6828 2270 6879 7362  ir, patch("physb
-00059990: 6962 6c69 6f2e 6461 7461 6261 7365 2e45  iblio.database.E
-000599a0: 6e74 7269 6573 2e75 7064 6174 6546 6965  ntries.updateFie
-000599b0: 6c64 2229 2061 7320 5f75 662c 2070 6174  ld") as _uf, pat
-000599c0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-000599d0: 2270 6879 7362 6962 6c69 6f2e 7765 6269  "physbiblio.webi
-000599e0: 6d70 6f72 742e 696e 7370 6972 652e 5765  mport.inspire.We
-000599f0: 6253 6561 7263 682e 7570 6461 7465 4269  bSearch.updateBi
-00059a00: 6274 6578 222c 0a20 2020 2020 2020 2020  btex",.         
-00059a10: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
-00059a20: 2846 616c 7365 2c20 2262 6962 7465 7822  (False, "bibtex"
-00059a30: 292c 0a20 2020 2020 2020 2029 2061 7320  ),.        ) as 
-00059a40: 5f75 623a 0a20 2020 2020 2020 2020 2020  _ub:.           
-00059a50: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00059a60: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00059a70: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-00059a80: 732e 7570 6461 7465 5265 636f 7264 4672  s.updateRecordFr
-00059a90: 6f6d 494e 5350 4952 4528 7b22 6964 223a  omINSPIRE({"id":
-00059aa0: 2022 3132 3334 227d 292c 2054 7275 650a   "1234"}), True.
-00059ab0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00059ac0: 2020 2020 2020 2020 2020 5f67 6972 2e61            _gir.a
-00059ad0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00059ae0: 655f 7769 7468 287b 2269 6422 3a20 2231  e_with({"id": "1
-00059af0: 3233 3422 7d29 0a20 2020 2020 2020 2020  234"}).         
-00059b00: 2020 205f 7566 2e61 7373 6572 745f 6361     _uf.assert_ca
-00059b10: 6c6c 6564 5f6f 6e63 655f 7769 7468 2822  lled_once_with("
-00059b20: 6162 6322 2c20 2269 6e73 7069 7265 222c  abc", "inspire",
-00059b30: 2022 3132 3334 222c 2076 6572 626f 7365   "1234", verbose
-00059b40: 3d30 290a 2020 2020 2020 2020 2020 2020  =0).            
-00059b50: 5f75 622e 6173 7365 7274 5f63 616c 6c65  _ub.assert_calle
-00059b60: 645f 6f6e 6365 5f77 6974 6828 7b22 6964  d_once_with({"id
-00059b70: 223a 2022 3132 3334 227d 2c20 2262 6962  ": "1234"}, "bib
-00059b80: 222c 2066 6f72 6365 3d46 616c 7365 290a  ", force=False).
-00059b90: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-00059ba0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-00059bb0: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
-00059bc0: 6261 7365 2e45 6e74 7269 6573 2e67 6574  base.Entries.get
-00059bd0: 4279 4964 4672 6f6d 496e 7370 6972 6552  ByIdFromInspireR
-00059be0: 6563 6f72 6422 2c0a 2020 2020 2020 2020  ecord",.        
-00059bf0: 2020 2020 7265 7475 726e 5f76 616c 7565      return_value
-00059c00: 3d5b 0a20 2020 2020 2020 2020 2020 2020  =[.             
-00059c10: 2020 207b 226e 6f55 7064 6174 6522 3a20     {"noUpdate": 
-00059c20: 302c 2022 6269 626b 6579 223a 2022 6162  0, "bibkey": "ab
-00059c30: 6322 2c20 2262 6962 7465 7822 3a20 2262  c", "bibtex": "b
-00059c40: 6962 222c 2022 696e 7370 6972 6522 3a20  ib", "inspire": 
-00059c50: 2231 3233 3522 7d0a 2020 2020 2020 2020  "1235"}.        
-00059c60: 2020 2020 5d2c 0a20 2020 2020 2020 2029      ],.        )
-00059c70: 2061 7320 5f67 6972 2c20 7061 7463 6828   as _gir, patch(
-00059c80: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
-00059c90: 6261 7365 2e45 6e74 7269 6573 2e75 7064  base.Entries.upd
-00059ca0: 6174 6546 6965 6c64 2229 2061 7320 5f75  ateField") as _u
-00059cb0: 662c 2070 6174 6368 280a 2020 2020 2020  f, patch(.      
-00059cc0: 2020 2020 2020 2270 6879 7362 6962 6c69        "physbibli
-00059cd0: 6f2e 7765 6269 6d70 6f72 742e 696e 7370  o.webimport.insp
-00059ce0: 6972 652e 5765 6253 6561 7263 682e 7570  ire.WebSearch.up
-00059cf0: 6461 7465 4269 6274 6578 222c 0a20 2020  dateBibtex",.   
-00059d00: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-00059d10: 7661 6c75 653d 2854 7275 652c 2027 4061  value=(True, '@a
-00059d20: 7274 6963 6c65 7b61 6263 2c5c 6e61 7574  rticle{abc,\naut
-00059d30: 686f 7220 3d20 226d 6522 2c5c 6e74 6974  hor = "me",\ntit
-00059d40: 6c65 203d 2022 6162 6322 2c7d 2729 2c0a  le = "abc",}'),.
-00059d50: 2020 2020 2020 2020 2920 6173 205f 7562          ) as _ub
-00059d60: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00059d70: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00059d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059d90: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
-00059da0: 7064 6174 6552 6563 6f72 6446 726f 6d49  pdateRecordFromI
-00059db0: 4e53 5049 5245 280a 2020 2020 2020 2020  NSPIRE(.        
-00059dc0: 2020 2020 2020 2020 2020 2020 7b22 6964              {"id
-00059dd0: 223a 204e 6f6e 652c 2022 636f 6c6c 6162  ": None, "collab
-00059de0: 6f72 6174 696f 6e22 3a20 4e6f 6e65 7d0a  oration": None}.
-00059df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059e00: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00059e10: 2020 2054 7275 652c 0a20 2020 2020 2020     True,.       
-00059e20: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00059e30: 2020 205f 6769 722e 6173 7365 7274 5f63     _gir.assert_c
-00059e40: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
-00059e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00059e60: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00059e70: 2020 2020 2020 2022 6964 223a 204e 6f6e         "id": Non
-00059e80: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00059e90: 2020 2020 2020 2022 636f 6c6c 6162 6f72         "collabor
-00059ea0: 6174 696f 6e22 3a20 4e6f 6e65 2c0a 2020  ation": None,.  
-00059eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059ec0: 2020 2262 6962 7465 7822 3a20 2740 4172    "bibtex": '@Ar
-00059ed0: 7469 636c 657b 6162 632c 5c6e 2020 2020  ticle{abc,\n    
-00059ee0: 2020 2020 6175 7468 6f72 203d 2022 6d65      author = "me
-00059ef0: 222c 5c6e 2020 2020 2020 2020 2074 6974  ",\n         tit
-00059f00: 6c65 203d 2022 7b61 6263 7d22 2c5c 6e7d  le = "{abc}",\n}
-00059f10: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00059f20: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-00059f30: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-00059f40: 7566 2e61 7373 6572 745f 6361 6c6c 6564  uf.assert_called
-00059f50: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
-00059f60: 2020 2020 2020 2020 2020 2020 2261 6263              "abc
-00059f70: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00059f80: 2020 2022 6269 6274 6578 222c 0a20 2020     "bibtex",.   
-00059f90: 2020 2020 2020 2020 2020 2020 2027 4041               '@A
-00059fa0: 7274 6963 6c65 7b61 6263 2c5c 6e20 2020  rticle{abc,\n   
-00059fb0: 2020 2020 2061 7574 686f 7220 3d20 226d       author = "m
-00059fc0: 6522 2c5c 6e20 2020 2020 2020 2020 7469  e",\n         ti
-00059fd0: 746c 6520 3d20 227b 6162 637d 222c 5c6e  tle = "{abc}",\n
-00059fe0: 7d27 2c0a 2020 2020 2020 2020 2020 2020  }',.            
-00059ff0: 2020 2020 7665 7262 6f73 653d 302c 0a20      verbose=0,. 
-0005a000: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0005a010: 2020 2020 2020 2020 205f 7562 2e61 7373           _ub.ass
-0005a020: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-0005a030: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
-0005a040: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-0005a050: 2020 2020 2020 2020 2020 2020 2269 6422              "id"
-0005a060: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0005a070: 2020 2020 2020 2020 2020 2020 2263 6f6c              "col
-0005a080: 6c61 626f 7261 7469 6f6e 223a 204e 6f6e  laboration": Non
-0005a090: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0005a0a0: 2020 2020 2020 2022 6269 6274 6578 223a         "bibtex":
-0005a0b0: 2027 4041 7274 6963 6c65 7b61 6263 2c5c   '@Article{abc,\
-0005a0c0: 6e20 2020 2020 2020 2061 7574 686f 7220  n        author 
-0005a0d0: 3d20 226d 6522 2c5c 6e20 2020 2020 2020  = "me",\n       
-0005a0e0: 2020 7469 746c 6520 3d20 227b 6162 637d    title = "{abc}
-0005a0f0: 222c 5c6e 7d27 2c0a 2020 2020 2020 2020  ",\n}',.        
-0005a100: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-0005a110: 2020 2020 2020 2020 2020 2022 6269 6222             "bib"
-0005a120: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0005a130: 2020 666f 7263 653d 4661 6c73 652c 0a20    force=False,. 
-0005a140: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0005a150: 2020 2020 2023 2074 6573 7420 7573 654f       # test useO
-0005a160: 6c64 0a20 2020 2020 2020 2077 6974 6820  ld.        with 
-0005a170: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-0005a180: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
-0005a190: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
-0005a1a0: 6765 7442 7949 6446 726f 6d49 6e73 7069  getByIdFromInspi
-0005a1b0: 7265 5265 636f 7264 222c 0a20 2020 2020  reRecord",.     
-0005a1c0: 2020 2020 2020 2072 6574 7572 6e5f 7661         return_va
-0005a1d0: 6c75 653d 5b0a 2020 2020 2020 2020 2020  lue=[.          
-0005a1e0: 2020 2020 2020 7b22 6e6f 5570 6461 7465        {"noUpdate
-0005a1f0: 223a 2030 2c20 2262 6962 6b65 7922 3a20  ": 0, "bibkey": 
-0005a200: 2261 6263 222c 2022 6269 6274 6578 223a  "abc", "bibtex":
-0005a210: 2022 6269 6222 2c20 2269 6e73 7069 7265   "bib", "inspire
-0005a220: 223a 2022 3132 3335 227d 0a20 2020 2020  ": "1235"}.     
-0005a230: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-0005a240: 2020 2920 6173 205f 6769 722c 2070 6174    ) as _gir, pat
-0005a250: 6368 2822 7068 7973 6269 626c 696f 2e64  ch("physbiblio.d
-0005a260: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
-0005a270: 7570 6461 7465 4669 656c 6422 2920 6173  updateField") as
-0005a280: 205f 7566 2c20 7061 7463 6828 0a20 2020   _uf, patch(.   
-0005a290: 2020 2020 2020 2020 2022 7068 7973 6269           "physbi
-0005a2a0: 626c 696f 2e77 6562 696d 706f 7274 2e69  blio.webimport.i
-0005a2b0: 6e73 7069 7265 2e57 6562 5365 6172 6368  nspire.WebSearch
-0005a2c0: 2e75 7064 6174 6542 6962 7465 7822 2c0a  .updateBibtex",.
-0005a2d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0005a2e0: 726e 5f76 616c 7565 3d28 5472 7565 2c20  rn_value=(True, 
-0005a2f0: 2740 6172 7469 636c 657b 6162 632c 5c6e  '@article{abc,\n
-0005a300: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
-0005a310: 7469 746c 6520 3d20 2261 6263 222c 7d27  title = "abc",}'
-0005a320: 292c 0a20 2020 2020 2020 2029 2061 7320  ),.        ) as 
-0005a330: 5f75 623a 0a20 2020 2020 2020 2020 2020  _ub:.           
-0005a340: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0005a350: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-0005a360: 2020 2073 656c 662e 7042 4442 2e62 6962     self.pBDB.bib
-0005a370: 732e 7570 6461 7465 5265 636f 7264 4672  s.updateRecordFr
-0005a380: 6f6d 494e 5350 4952 4528 0a20 2020 2020  omINSPIRE(.     
-0005a390: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0005a3a0: 2269 6422 3a20 4e6f 6e65 7d2c 0a20 2020  "id": None},.   
-0005a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a3c0: 2075 7365 4f6c 643d 5b0a 2020 2020 2020   useOld=[.      
-0005a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a3e0: 2020 7b0a 2020 2020 2020 2020 2020 2020    {.            
-0005a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a400: 226e 6f55 7064 6174 6522 3a20 312c 0a20  "noUpdate": 1,. 
-0005a410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a420: 2020 2020 2020 2020 2020 2022 6269 626b             "bibk
-0005a430: 6579 223a 2022 6162 6322 2c0a 2020 2020  ey": "abc",.    
-0005a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a450: 2020 2020 2020 2020 2262 6962 7465 7822          "bibtex"
-0005a460: 3a20 226d 7962 6962 222c 0a20 2020 2020  : "mybib",.     
-0005a470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a480: 2020 2020 2020 2022 696e 7370 6972 6522         "inspire"
-0005a490: 3a20 2234 3435 3522 2c0a 2020 2020 2020  : "4455",.      
-0005a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a4b0: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-0005a4c0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-0005a4d0: 2020 2020 2020 2020 2020 2029 2c0a 2020             ),.  
-0005a4e0: 2020 2020 2020 2020 2020 2020 2020 4661                Fa
-0005a4f0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-0005a500: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0005a510: 6769 722e 6173 7365 7274 5f6e 6f74 5f63  gir.assert_not_c
-0005a520: 616c 6c65 6428 290a 2020 2020 2020 2020  alled().        
-0005a530: 2320 7465 7374 2066 6f72 6365 0a20 2020  # test force.   
-0005a540: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0005a550: 0a20 2020 2020 2020 2020 2020 2022 7068  .            "ph
-0005a560: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-0005a570: 652e 456e 7472 6965 732e 6765 7442 7949  e.Entries.getByI
-0005a580: 6446 726f 6d49 6e73 7069 7265 5265 636f  dFromInspireReco
-0005a590: 7264 222c 0a20 2020 2020 2020 2020 2020  rd",.           
-0005a5a0: 2072 6574 7572 6e5f 7661 6c75 653d 5b0a   return_value=[.
-0005a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a5c0: 7b22 6e6f 5570 6461 7465 223a 2031 2c20  {"noUpdate": 1, 
-0005a5d0: 2262 6962 6b65 7922 3a20 2261 6263 222c  "bibkey": "abc",
-0005a5e0: 2022 6269 6274 6578 223a 2022 6269 6222   "bibtex": "bib"
-0005a5f0: 2c20 2269 6e73 7069 7265 223a 2022 3132  , "inspire": "12
-0005a600: 3335 227d 0a20 2020 2020 2020 2020 2020  35"}.           
-0005a610: 205d 2c0a 2020 2020 2020 2020 2920 6173   ],.        ) as
-0005a620: 205f 6769 722c 2070 6174 6368 2822 7068   _gir, patch("ph
-0005a630: 7973 6269 626c 696f 2e64 6174 6162 6173  ysbiblio.databas
-0005a640: 652e 456e 7472 6965 732e 7570 6461 7465  e.Entries.update
-0005a650: 4669 656c 6422 2920 6173 205f 7566 2c20  Field") as _uf, 
-0005a660: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
-0005a670: 2020 2022 7068 7973 6269 626c 696f 2e77     "physbiblio.w
-0005a680: 6562 696d 706f 7274 2e69 6e73 7069 7265  ebimport.inspire
-0005a690: 2e57 6562 5365 6172 6368 2e75 7064 6174  .WebSearch.updat
-0005a6a0: 6542 6962 7465 7822 2c0a 2020 2020 2020  eBibtex",.      
-0005a6b0: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
-0005a6c0: 7565 3d28 5472 7565 2c20 2740 6172 7469  ue=(True, '@arti
-0005a6d0: 636c 657b 6162 632c 5c6e 6175 7468 6f72  cle{abc,\nauthor
-0005a6e0: 203d 2022 6d65 222c 5c6e 7469 746c 6520   = "me",\ntitle 
-0005a6f0: 3d20 2261 6263 222c 7d27 292c 0a20 2020  = "abc",}'),.   
-0005a700: 2020 2020 2029 2061 7320 5f75 623a 0a20       ) as _ub:. 
-0005a710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0005a720: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0005a730: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0005a740: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
-0005a750: 7465 5265 636f 7264 4672 6f6d 494e 5350  teRecordFromINSP
-0005a760: 4952 4528 7b22 6964 223a 204e 6f6e 657d  IRE({"id": None}
-0005a770: 2c20 666f 7263 653d 5472 7565 292c 2054  , force=True), T
-0005a780: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0005a790: 290a 2020 2020 2020 2020 2020 2020 5f67  ).            _g
-0005a7a0: 6972 2e61 7373 6572 745f 6361 6c6c 6564  ir.assert_called
-0005a7b0: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
-0005a7c0: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
-0005a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a7e0: 2020 2269 6422 3a20 4e6f 6e65 2c0a 2020    "id": None,.  
-0005a7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005a800: 2020 2262 6962 7465 7822 3a20 2740 4172    "bibtex": '@Ar
-0005a810: 7469 636c 657b 6162 632c 5c6e 2020 2020  ticle{abc,\n    
-0005a820: 2020 2020 6175 7468 6f72 203d 2022 6d65      author = "me
-0005a830: 222c 5c6e 2020 2020 2020 2020 2074 6974  ",\n         tit
-0005a840: 6c65 203d 2022 7b61 6263 7d22 2c5c 6e7d  le = "{abc}",\n}
-0005a850: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0005a860: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
-0005a870: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0005a880: 7566 2e61 7373 6572 745f 6361 6c6c 6564  uf.assert_called
-0005a890: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
-0005a8a0: 2020 2020 2020 2020 2020 2020 2261 6263              "abc
-0005a8b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0005a8c0: 2020 2022 6269 6274 6578 222c 0a20 2020     "bibtex",.   
-0005a8d0: 2020 2020 2020 2020 2020 2020 2027 4041               '@A
-0005a8e0: 7274 6963 6c65 7b61 6263 2c5c 6e20 2020  rticle{abc,\n   
-0005a8f0: 2020 2020 2061 7574 686f 7220 3d20 226d       author = "m
-0005a900: 6522 2c5c 6e20 2020 2020 2020 2020 7469  e",\n         ti
-0005a910: 746c 6520 3d20 227b 6162 637d 222c 5c6e  tle = "{abc}",\n
-0005a920: 7d27 2c0a 2020 2020 2020 2020 2020 2020  }',.            
-0005a930: 2020 2020 7665 7262 6f73 653d 302c 0a20      verbose=0,. 
-0005a940: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0005a950: 2020 2020 2020 2020 205f 7562 2e61 7373           _ub.ass
-0005a960: 6572 745f 6361 6c6c 6564 5f6f 6e63 655f  ert_called_once_
-0005a970: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
-0005a980: 2020 2020 2020 7b0a 2020 2020 2020 2020        {.        
-0005a990: 2020 2020 2020 2020 2020 2020 2269 6422              "id"
-0005a9a0: 3a20 4e6f 6e65 2c0a 2020 2020 2020 2020  : None,.        
-0005a9b0: 2020 2020 2020 2020 2020 2020 2262 6962              "bib
-0005a9c0: 7465 7822 3a20 2740 4172 7469 636c 657b  tex": '@Article{
-0005a9d0: 6162 632c 5c6e 2020 2020 2020 2020 6175  abc,\n        au
-0005a9e0: 7468 6f72 203d 2022 6d65 222c 5c6e 2020  thor = "me",\n  
-0005a9f0: 2020 2020 2020 2074 6974 6c65 203d 2022         title = "
-0005aa00: 7b61 6263 7d22 2c5c 6e7d 272c 0a20 2020  {abc}",\n}',.   
-0005aa10: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
-0005aa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005aa30: 2262 6962 222c 0a20 2020 2020 2020 2020  "bib",.         
-0005aa40: 2020 2020 2020 2066 6f72 6365 3d54 7275         force=Tru
-0005aa50: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-0005aa60: 0a0a 0a40 756e 6974 7465 7374 2e73 6b69  ...@unittest.ski
-0005aa70: 7049 6628 736b 6970 5465 7374 7353 6574  pIf(skipTestsSet
-0005aa80: 7469 6e67 732e 6462 2c20 2244 6174 6162  tings.db, "Datab
-0005aa90: 6173 6520 7465 7374 7322 290a 4070 6174  ase tests").@pat
-0005aaa0: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
-0005aab0: 6572 2e64 6562 7567 2229 0a40 7061 7463  er.debug").@patc
-0005aac0: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
-0005aad0: 722e 696e 666f 2229 0a40 7061 7463 6828  r.info").@patch(
-0005aae0: 226c 6f67 6769 6e67 2e4c 6f67 6765 722e  "logging.Logger.
-0005aaf0: 7761 726e 696e 6722 290a 4070 6174 6368  warning").@patch
-0005ab00: 2822 6c6f 6767 696e 672e 4c6f 6767 6572  ("logging.Logger
-0005ab10: 2e65 7863 6570 7469 6f6e 2229 0a63 6c61  .exception").cla
-0005ab20: 7373 2054 6573 7444 6174 6162 6173 6555  ss TestDatabaseU
-0005ab30: 7469 6c69 7469 6573 2844 4254 6573 7443  tilities(DBTestC
-0005ab40: 6173 6529 3a0a 2020 2020 2222 2254 6573  ase):.    """Tes
-0005ab50: 7473 2066 6f72 2074 6865 206d 6574 686f  ts for the metho
-0005ab60: 6473 2069 6e20 7468 6520 7574 696c 6974  ds in the utilit
-0005ab70: 6965 7320 7375 6263 6c61 7373 2222 220a  ies subclass""".
-0005ab80: 0a20 2020 2064 6566 2074 6573 745f 7370  .    def test_sp
-0005ab90: 6172 6528 7365 6c66 2c20 2a61 7267 7329  are(self, *args)
-0005aba0: 3a0a 2020 2020 2020 2020 2222 2263 7265  :.        """cre
-0005abb0: 6174 6520 7370 6172 6520 636f 6e6e 6563  ate spare connec
-0005abc0: 7469 6f6e 7320 6a75 7374 2074 6f20 6465  tions just to de
-0005abd0: 6c65 7465 2074 6865 6d0a 2020 2020 2020  lete them.      
-0005abe0: 2020 7769 7468 2063 6c65 616e 5370 6172    with cleanSpar
-0005abf0: 6545 6e74 7269 6573 0a20 2020 2020 2020  eEntries.       
-0005ac00: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-0005ac10: 662e 7042 4442 2e75 7469 6c73 2e63 6c65  f.pBDB.utils.cle
-0005ac20: 616e 5370 6172 6545 6e74 7269 6573 2829  anSpareEntries()
-0005ac30: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0005ac40: 7365 7274 5472 7565 2873 656c 662e 7042  sertTrue(self.pB
-0005ac50: 4442 2e63 6174 4269 622e 696e 7365 7274  DB.catBib.insert
-0005ac60: 2831 2c20 2274 6573 7422 2929 0a20 2020  (1, "test")).   
-0005ac70: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0005ac80: 4571 7561 6c28 7365 6c66 2e70 4244 422e  Equal(self.pBDB.
-0005ac90: 6361 7445 7870 2e69 6e73 6572 7428 312c  catExp.insert(1,
-0005aca0: 205b 302c 2031 5d29 2c20 4e6f 6e65 290a   [0, 1]), None).
-0005acb0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
-0005acc0: 422e 6578 7073 2e69 6e73 6572 7428 0a20  B.exps.insert(. 
-0005acd0: 2020 2020 2020 2020 2020 207b 226e 616d             {"nam
-0005ace0: 6522 3a20 2274 6573 7445 7870 222c 2022  e": "testExp", "
-0005acf0: 636f 6d6d 656e 7473 223a 2022 222c 2022  comments": "", "
-0005ad00: 686f 6d65 7061 6765 223a 2022 222c 2022  homepage": "", "
-0005ad10: 696e 7370 6972 6522 3a20 2231 227d 0a20  inspire": "1"}. 
-0005ad20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0005ad30: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
-0005ad40: 2873 656c 662e 7042 4442 2e62 6962 4578  (self.pBDB.bibEx
-0005ad50: 702e 696e 7365 7274 2822 7465 7374 222c  p.insert("test",
-0005ad60: 2031 2929 0a20 2020 2020 2020 2064 6253   1)).        dbS
-0005ad70: 7461 7473 2873 656c 662e 7042 4442 290a  tats(self.pBDB).
-0005ad80: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0005ad90: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-0005ada0: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
-0005adb0: 7374 6174 732c 0a20 2020 2020 2020 2020  stats,.         
-0005adc0: 2020 207b 2262 6962 7322 3a20 302c 2022     {"bibs": 0, "
-0005add0: 6361 7473 223a 2032 2c20 2265 7870 7322  cats": 2, "exps"
-0005ade0: 3a20 312c 2022 6361 7442 6962 223a 2031  : 1, "catBib": 1
-0005adf0: 2c20 2263 6174 4578 7022 3a20 322c 2022  , "catExp": 2, "
-0005ae00: 6269 6245 7870 223a 2031 7d2c 0a20 2020  bibExp": 1},.   
-0005ae10: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
-0005ae20: 6974 6820 7061 7463 6828 226c 6f67 6769  ith patch("loggi
-0005ae30: 6e67 2e4c 6f67 6765 722e 696e 666f 2229  ng.Logger.info")
-0005ae40: 2061 7320 5f69 3a0a 2020 2020 2020 2020   as _i:.        
-0005ae50: 2020 2020 7365 6c66 2e70 4244 422e 7574      self.pBDB.ut
-0005ae60: 696c 732e 636c 6561 6e53 7061 7265 456e  ils.cleanSpareEn
-0005ae70: 7472 6965 7328 290a 2020 2020 2020 2020  tries().        
-0005ae80: 2020 2020 5f69 2e61 7373 6572 745f 6861      _i.assert_ha
-0005ae90: 735f 6361 6c6c 7328 0a20 2020 2020 2020  s_calls(.       
-0005aea0: 2020 2020 2020 2020 205b 0a20 2020 2020           [.     
-0005aeb0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0005aec0: 616c 6c28 2243 6c65 616e 696e 6720 2874  all("Cleaning (t
-0005aed0: 6573 742c 2031 2922 292c 0a20 2020 2020  est, 1)"),.     
-0005aee0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0005aef0: 616c 6c28 2243 6c65 616e 696e 6720 2831  all("Cleaning (1
-0005af00: 2c20 7465 7374 2922 292c 0a20 2020 2020  , test)"),.     
-0005af10: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0005af20: 616c 6c28 2243 6c65 616e 696e 6720 2831  all("Cleaning (1
-0005af30: 2c20 3029 2229 2c0a 2020 2020 2020 2020  , 0)"),.        
-0005af40: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-0005af50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0005af60: 6462 5374 6174 7328 7365 6c66 2e70 4244  dbStats(self.pBD
-0005af70: 4229 0a20 2020 2020 2020 2073 656c 662e  B).        self.
-0005af80: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
-0005af90: 2020 2020 2020 2020 2073 656c 662e 7042           self.pB
-0005afa0: 4442 2e73 7461 7473 2c0a 2020 2020 2020  DB.stats,.      
-0005afb0: 2020 2020 2020 7b22 6269 6273 223a 2030        {"bibs": 0
-0005afc0: 2c20 2263 6174 7322 3a20 322c 2022 6578  , "cats": 2, "ex
-0005afd0: 7073 223a 2031 2c20 2263 6174 4269 6222  ps": 1, "catBib"
-0005afe0: 3a20 302c 2022 6361 7445 7870 223a 2031  : 0, "catExp": 1
-0005aff0: 2c20 2262 6962 4578 7022 3a20 307d 2c0a  , "bibExp": 0},.
-0005b000: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-0005b010: 6566 2074 6573 745f 6269 6274 6578 7328  ef test_bibtexs(
-0005b020: 7365 6c66 2c20 2a61 7267 7329 3a0a 2020  self, *args):.  
-0005b030: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
-0005b040: 616e 6420 636c 6561 6e20 6120 6269 6274  and clean a bibt
-0005b050: 6578 2065 6e74 7279 2222 220a 2020 2020  ex entry""".    
-0005b060: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
-0005b070: 7042 4442 2e62 6962 732e 7072 6570 6172  pBDB.bibs.prepar
-0005b080: 6549 6e73 6572 7428 0a20 2020 2020 2020  eInsert(.       
-0005b090: 2020 2020 2027 5c6e 5c6e 2563 6f6d 6d65       '\n\n%comme
-0005b0a0: 6e74 5c6e 4061 7274 6963 6c65 7b61 6263  nt\n@article{abc
-0005b0b0: 2c5c 6e61 7574 686f 7220 3d20 226d 6522  ,\nauthor = "me"
-0005b0c0: 2c5c 6e27 0a20 2020 2020 2020 2020 2020  ,\n'.           
-0005b0d0: 202b 2027 7469 746c 6520 3d20 225c 7530   + 'title = "\u0
-0005b0e0: 3045 385c 6e5c 7530 3046 3122 2c7d 272c  0E8\n\u00F1",}',
-0005b0f0: 0a20 2020 2020 2020 2020 2020 2062 6962  .            bib
-0005b100: 6b65 793d 2261 6263 222c 0a20 2020 2020  key="abc",.     
-0005b110: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-0005b120: 662e 6173 7365 7274 5472 7565 2873 656c  f.assertTrue(sel
-0005b130: 662e 7042 4442 2e62 6962 732e 696e 7365  f.pBDB.bibs.inse
-0005b140: 7274 2864 6174 6129 290a 2020 2020 2020  rt(data)).      
-0005b150: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0005b160: 616c 2873 656c 662e 7042 4442 2e75 7469  al(self.pBDB.uti
-0005b170: 6c73 2e63 6c65 616e 416c 6c42 6962 7465  ls.cleanAllBibte
-0005b180: 7873 2829 2c20 4e6f 6e65 290a 2020 2020  xs(), None).    
-0005b190: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0005b1a0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
-0005b1b0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
-0005b1c0: 2e67 6574 4669 656c 6428 2261 6263 222c  .getField("abc",
-0005b1d0: 2022 6269 6274 6578 2229 2c0a 2020 2020   "bibtex"),.    
-0005b1e0: 2020 2020 2020 2020 2740 4172 7469 636c          '@Articl
-0005b1f0: 657b 6162 632c 5c6e 2020 2020 2020 2020  e{abc,\n        
-0005b200: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
-0005b210: 2020 2020 2020 2020 2027 0a20 2020 2020           '.     
-0005b220: 2020 2020 2020 202b 2027 7469 746c 6520         + 'title 
-0005b230: 3d20 227b 7b5c 6065 7d20 7b5c 7e6e 7d7d  = "{{\`e} {\~n}}
-0005b240: 222c 5c6e 7d5c 6e5c 6e27 2c0a 2020 2020  ",\n}\n\n',.    
-0005b250: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-0005b260: 6c66 2e70 4244 422e 6269 6273 2e64 656c  lf.pBDB.bibs.del
-0005b270: 6574 6528 2261 6263 2229 0a0a 0a64 6566  ete("abc")...def
-0005b280: 2074 6561 7244 6f77 6e4d 6f64 756c 6528   tearDownModule(
-0005b290: 293a 0a20 2020 2069 6620 6f73 2e70 6174  ):.    if os.pat
-0005b2a0: 682e 6578 6973 7473 2874 656d 7044 424e  h.exists(tempDBN
-0005b2b0: 616d 6529 3a0a 2020 2020 2020 2020 6f73  ame):.        os
-0005b2c0: 2e72 656d 6f76 6528 7465 6d70 4442 4e61  .remove(tempDBNa
-0005b2d0: 6d65 290a 0a0a 6966 205f 5f6e 616d 655f  me)...if __name_
-0005b2e0: 5f20 3d3d 2022 5f5f 6d61 696e 5f5f 223a  _ == "__main__":
-0005b2f0: 0a20 2020 2075 6e69 7474 6573 742e 6d61  .    unittest.ma
-0005b300: 696e 2829 0a                             in().
+00057740: 2020 2020 2279 6561 7222 3a20 2232 3031      "year": "201
+00057750: 3622 2c0a 2020 2020 2020 2020 2020 2020  6",.            
+00057760: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+00057770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057780: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
+00057790: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000577a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000577b0: 6572 7446 616c 7365 2873 656c 662e 7042  ertFalse(self.pB
+000577c0: 4442 2e62 6962 732e 7570 6461 7465 496e  DB.bibs.updateIn
+000577d0: 666f 4672 6f6d 4f41 4928 2231 3233 3435  foFromOAI("12345
+000577e0: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
+000577f0: 2020 2020 7769 7468 2070 6174 6368 2822      with patch("
+00057800: 6c6f 6767 696e 672e 4c6f 6767 6572 2e65  logging.Logger.e
+00057810: 7863 6570 7469 6f6e 2229 2061 7320 5f69  xception") as _i
+00057820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00057830: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00057840: 6269 6273 2e75 7064 6174 6549 6e66 6f46  bibs.updateInfoF
+00057850: 726f 6d4f 4149 2822 3132 3334 3522 290a  romOAI("12345").
+00057860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057870: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+00057880: 6e28 224b 6579 2065 7272 6f72 3a20 2862  n("Key error: (b
+00057890: 6962 6b65 7922 2c20 5f69 2e63 616c 6c5f  ibkey", _i.call_
+000578a0: 6172 6773 5b30 5d5b 305d 290a 2020 2020  args[0][0]).    
+000578b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000578c0: 2e61 7373 6572 7454 7275 6528 7365 6c66  .assertTrue(self
+000578d0: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+000578e0: 6549 6e66 6f46 726f 6d4f 4149 2822 3132  eInfoFromOAI("12
+000578f0: 3334 3522 2929 0a0a 2020 2020 4075 6e69  345"))..    @uni
+00057900: 7474 6573 742e 736b 6970 4966 2873 6b69  ttest.skipIf(ski
+00057910: 7054 6573 7473 5365 7474 696e 6773 2e6f  pTestsSettings.o
+00057920: 6e6c 696e 652c 2022 4f6e 6c69 6e65 2074  nline, "Online t
+00057930: 6573 7473 2229 0a20 2020 2064 6566 2074  ests").    def t
+00057940: 6573 745f 7570 6461 7465 496e 7370 6972  est_updateInspir
+00057950: 6549 4428 7365 6c66 2c20 2a61 7267 7329  eID(self, *args)
+00057960: 3a0a 2020 2020 2020 2020 2222 2274 6573  :.        """tes
+00057970: 7473 2066 6f72 2075 7064 6174 6549 6e73  ts for updateIns
+00057980: 7069 7265 4944 2028 6f6e 6c69 6e65 2922  pireID (online)"
+00057990: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+000579a0: 7042 4442 2e62 6962 732e 696e 7365 7274  pBDB.bibs.insert
+000579b0: 4672 6f6d 4269 6274 6578 280a 2020 2020  FromBibtex(.    
+000579c0: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
+000579d0: 657b 4761 7269 617a 7a6f 3a32 3031 3572  e{Gariazzo:2015r
+000579e0: 7261 2c5c 6e61 7278 6976 3d22 3135 3037  ra,\narxiv="1507
+000579f0: 2e30 3832 3034 225c 6e7d 270a 2020 2020  .08204"\n}'.    
+00057a00: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00057a10: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00057a20: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
+00057a30: 6461 7465 496e 7370 6972 6549 4428 2247  dateInspireID("G
+00057a40: 6172 6961 7a7a 6f3a 3230 3135 7272 6122  ariazzo:2015rra"
+00057a50: 292c 2022 3133 3835 3538 3322 290a 2020  ), "1385583").  
+00057a60: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00057a70: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00057a80: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00057a90: 6273 2e75 7064 6174 6549 6e73 7069 7265  bs.updateInspire
+00057aa0: 4944 280a 2020 2020 2020 2020 2020 2020  ID(.            
+00057ab0: 2020 2020 2261 2047 6172 6961 7a7a 6f20      "a Gariazzo 
+00057ac0: 616e 6420 6420 3230 3135 222c 2022 4761  and d 2015", "Ga
+00057ad0: 7269 617a 7a6f 3a32 3031 3572 7261 222c  riazzo:2015rra",
+00057ae0: 206e 756d 6265 723d 330a 2020 2020 2020   number=3.      
+00057af0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+00057b00: 2020 2020 2022 3133 3835 3538 3322 2c0a       "1385583",.
+00057b10: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00057b20: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00057b30: 2e64 656c 6574 6528 2247 6172 6961 7a7a  .delete("Gariazz
+00057b40: 6f3a 3230 3135 7272 6122 290a 2020 2020  o:2015rra").    
+00057b50: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+00057b60: 6273 2e69 6e73 6572 7446 726f 6d42 6962  bs.insertFromBib
+00057b70: 7465 7828 0a20 2020 2020 2020 2020 2020  tex(.           
+00057b80: 2027 4061 7274 6963 6c65 7b47 6172 6961   '@article{Garia
+00057b90: 7a7a 6f3a 3230 3135 2c5c 6e61 7278 6976  zzo:2015,\narxiv
+00057ba0: 3d22 3135 3037 2e30 3832 3034 225c 6e7d  ="1507.08204"\n}
+00057bb0: 270a 2020 2020 2020 2020 290a 2020 2020  '.        ).    
+00057bc0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00057bd0: 7175 616c 2873 656c 662e 7042 4442 2e62  qual(self.pBDB.b
+00057be0: 6962 732e 7570 6461 7465 496e 7370 6972  ibs.updateInspir
+00057bf0: 6549 4428 2247 6172 6961 7a7a 6f3a 3230  eID("Gariazzo:20
+00057c00: 3135 7272 6122 292c 2022 3133 3835 3538  15rra"), "138558
+00057c10: 3322 290a 2020 2020 2020 2020 7365 6c66  3").        self
+00057c20: 2e70 4244 422e 6269 6273 2e64 656c 6574  .pBDB.bibs.delet
+00057c30: 6528 2247 6172 6961 7a7a 6f3a 3230 3135  e("Gariazzo:2015
+00057c40: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00057c50: 7042 4442 2e62 6962 732e 696e 7365 7274  pBDB.bibs.insert
+00057c60: 4672 6f6d 4269 6274 6578 280a 2020 2020  FromBibtex(.    
+00057c70: 2020 2020 2020 2020 2740 6172 7469 636c          '@articl
+00057c80: 657b 4761 7269 617a 7a6f 3a32 3031 352c  e{Gariazzo:2015,
+00057c90: 5c6e 646f 693d 2231 302e 3130 3838 2f30  \ndoi="10.1088/0
+00057ca0: 3935 342d 3338 3939 2f34 332f 332f 3033  954-3899/43/3/03
+00057cb0: 3330 3031 2227 0a20 2020 2020 2020 2020  3001"'.         
+00057cc0: 2020 202b 2027 5c6e 6172 7869 763d 2231     + '\narxiv="1
+00057cd0: 3530 3730 3832 3034 225c 6e7d 270a 2020  50708204"\n}'.  
+00057ce0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00057cf0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00057d00: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00057d10: 7570 6461 7465 496e 7370 6972 6549 4428  updateInspireID(
+00057d20: 2247 6172 6961 7a7a 6f3a 3230 3135 7272  "Gariazzo:2015rr
+00057d30: 6122 292c 2022 3133 3835 3538 3322 290a  a"), "1385583").
+00057d40: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+00057d50: 422e 6269 6273 2e64 656c 6574 6528 2247  B.bibs.delete("G
+00057d60: 6172 6961 7a7a 6f3a 3230 3135 2229 0a20  ariazzo:2015"). 
+00057d70: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00057d80: 2e62 6962 732e 696e 7365 7274 4672 6f6d  .bibs.insertFrom
+00057d90: 4269 6274 6578 280a 2020 2020 2020 2020  Bibtex(.        
+00057da0: 2020 2020 2740 6172 7469 636c 657b 4761      '@article{Ga
+00057db0: 7269 617a 7a6f 3a32 3031 352c 5c6e 646f  riazzo:2015,\ndo
+00057dc0: 693d 2231 302e 3130 3838 3039 3534 2d33  i="10.10880954-3
+00057dd0: 3839 3934 3333 3033 3330 3031 2227 0a20  899433033001"'. 
+00057de0: 2020 2020 2020 2020 2020 202b 2027 5c6e             + '\n
+00057df0: 6172 7869 763d 2231 3530 372e 3038 3230  arxiv="1507.0820
+00057e00: 3422 5c6e 7d27 0a20 2020 2020 2020 2029  4"\n}'.        )
+00057e10: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00057e20: 7365 7274 4571 7561 6c28 7365 6c66 2e70  sertEqual(self.p
+00057e30: 4244 422e 6269 6273 2e75 7064 6174 6549  BDB.bibs.updateI
+00057e40: 6e73 7069 7265 4944 2822 4761 7269 617a  nspireID("Gariaz
+00057e50: 7a6f 3a32 3031 3572 7261 2229 2c20 2231  zo:2015rra"), "1
+00057e60: 3338 3535 3833 2229 0a20 2020 2020 2020  385583").       
+00057e70: 2073 656c 662e 7042 4442 2e62 6962 732e   self.pBDB.bibs.
+00057e80: 6465 6c65 7465 2822 4761 7269 617a 7a6f  delete("Gariazzo
+00057e90: 3a32 3031 3522 290a 2020 2020 2020 2020  :2015").        
+00057ea0: 7365 6c66 2e70 4244 422e 6269 6273 2e69  self.pBDB.bibs.i
+00057eb0: 6e73 6572 7446 726f 6d42 6962 7465 7828  nsertFromBibtex(
+00057ec0: 0a20 2020 2020 2020 2020 2020 2027 4061  .            '@a
+00057ed0: 7274 6963 6c65 7b47 6172 6961 7a7a 6f3a  rticle{Gariazzo:
+00057ee0: 3230 3135 2c5c 6e74 6974 6c65 3d22 4c69  2015,\ntitle="Li
+00057ef0: 6768 7420 5374 6572 696c 6520 4e65 7574  ght Sterile Neut
+00057f00: 7269 6e6f 225c 6e7d 270a 2020 2020 2020  rino"\n}'.      
+00057f10: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+00057f20: 2e61 7373 6572 7446 616c 7365 280a 2020  .assertFalse(.  
+00057f30: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+00057f40: 4244 422e 6269 6273 2e75 7064 6174 6549  BDB.bibs.updateI
+00057f50: 6e73 7069 7265 4944 2822 4761 7269 617a  nspireID("Gariaz
+00057f60: 7a6f 3a32 3031 3572 222c 2022 4761 7269  zo:2015r", "Gari
+00057f70: 617a 7a6f 3a32 3031 3572 7261 2229 0a20  azzo:2015rra"). 
+00057f80: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00057f90: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
+00057fa0: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
+00057fb0: 2e75 7064 6174 6549 6e73 7069 7265 4944  .updateInspireID
+00057fc0: 2822 6162 6364 6566 6768 6922 2929 0a20  ("abcdefghi")). 
+00057fd0: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00057fe0: 2e62 6962 732e 6465 6c65 7465 2822 4761  .bibs.delete("Ga
+00057ff0: 7269 617a 7a6f 3a32 3031 3522 290a 2020  riazzo:2015").  
+00058000: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+00058010: 6269 6273 2e69 6e73 6572 7446 726f 6d42  bibs.insertFromB
+00058020: 6962 7465 7828 0a20 2020 2020 2020 2020  ibtex(.         
+00058030: 2020 2027 4061 7274 6963 6c65 7b47 6172     '@article{Gar
+00058040: 6961 7a7a 6f3a 3230 3135 2c5c 6e64 6f69  iazzo:2015,\ndoi
+00058050: 3d22 3130 2e31 3038 382f 3039 3534 2d33  ="10.1088/0954-3
+00058060: 3839 392f 3433 2f33 2f30 3333 3030 3122  899/43/3/033001"
+00058070: 270a 2020 2020 2020 2020 2020 2020 2b20  '.            + 
+00058080: 275c 6e61 7278 6976 3d22 3135 3037 3038  '\narxiv="150708
+00058090: 3230 3422 5c6e 7d27 0a20 2020 2020 2020  204"\n}'.       
+000580a0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
+000580b0: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
+000580c0: 4669 656c 6428 2247 6172 6961 7a7a 6f3a  Field("Gariazzo:
+000580d0: 3230 3135 222c 2022 696e 7370 6972 6549  2015", "inspireI
+000580e0: 4422 2c20 4e6f 6e65 290a 2020 2020 2020  D", None).      
+000580f0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00058100: 616c 2873 656c 662e 7042 4442 2e62 6962  al(self.pBDB.bib
+00058110: 732e 7570 6461 7465 496e 7370 6972 6549  s.updateInspireI
+00058120: 4428 2247 6172 6961 7a7a 6f3a 3230 3135  D("Gariazzo:2015
+00058130: 7272 6122 292c 2022 3133 3835 3538 3322  rra"), "1385583"
+00058140: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
+00058150: 4244 422e 6269 6273 2e64 656c 6574 6528  BDB.bibs.delete(
+00058160: 2247 6172 6961 7a7a 6f3a 3230 3135 2229  "Gariazzo:2015")
+00058170: 0a20 2020 2020 2020 2073 656c 662e 7042  .        self.pB
+00058180: 4442 2e62 6962 732e 696e 7365 7274 4672  DB.bibs.insertFr
+00058190: 6f6d 4269 6274 6578 280a 2020 2020 2020  omBibtex(.      
+000581a0: 2020 2020 2020 2740 6172 7469 636c 657b        '@article{
+000581b0: 4761 7269 617a 7a6f 3a32 3031 352c 5c6e  Gariazzo:2015,\n
+000581c0: 7469 746c 653d 224c 6967 6874 2053 7465  title="Light Ste
+000581d0: 7269 6c65 204e 6575 7472 696e 6f22 5c6e  rile Neutrino"\n
+000581e0: 7d27 0a20 2020 2020 2020 2029 0a20 2020  }'.        ).   
+000581f0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00058200: 6962 732e 7570 6461 7465 4669 656c 6428  ibs.updateField(
+00058210: 2247 6172 6961 7a7a 6f3a 3230 3135 222c  "Gariazzo:2015",
+00058220: 2022 696e 7370 6972 6549 4422 2c20 4e6f   "inspireID", No
+00058230: 6e65 290a 2020 2020 2020 2020 7365 6c66  ne).        self
+00058240: 2e61 7373 6572 7446 616c 7365 2873 656c  .assertFalse(sel
+00058250: 662e 7042 4442 2e62 6962 732e 7570 6461  f.pBDB.bibs.upda
+00058260: 7465 496e 7370 6972 6549 4428 2247 6172  teInspireID("Gar
+00058270: 6961 7a7a 6f3a 3230 3135 6162 6364 2229  iazzo:2015abcd")
+00058280: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00058290: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
+000582a0: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+000582b0: 6549 6e73 7069 7265 4944 2822 6162 6364  eInspireID("abcd
+000582c0: 6566 6768 6922 2929 0a0a 2020 2020 6465  efghi"))..    de
+000582d0: 6620 7465 7374 5f74 6f44 6174 6144 6963  f test_toDataDic
+000582e0: 7428 7365 6c66 2c20 2a61 7267 7329 3a0a  t(self, *args):.
+000582f0: 2020 2020 2020 2020 2222 2274 6573 7420          """test 
+00058300: 746f 4461 7461 4469 6374 2222 220a 2020  toDataDict""".  
+00058310: 2020 2020 2020 7365 6c66 2e69 6e73 6572        self.inser
+00058320: 745f 7468 7265 6528 290a 2020 2020 2020  t_three().      
+00058330: 2020 6120 3d20 7365 6c66 2e70 4244 422e    a = self.pBDB.
+00058340: 6269 6273 2e74 6f44 6174 6144 6963 7428  bibs.toDataDict(
+00058350: 2261 6263 2229 0a20 2020 2020 2020 2073  "abc").        s
+00058360: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00058370: 615b 2262 6962 6b65 7922 5d2c 2022 6162  a["bibkey"], "ab
+00058380: 6322 290a 2020 2020 2020 2020 7365 6c66  c").        self
+00058390: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+000583a0: 2020 2020 2020 2020 2020 615b 2262 6962            a["bib
+000583b0: 7465 7822 5d2c 0a20 2020 2020 2020 2020  tex"],.         
+000583c0: 2020 2027 4041 7274 6963 6c65 7b61 6263     '@Article{abc
+000583d0: 2c5c 6e20 2020 2020 2020 2061 7574 686f  ,\n        autho
+000583e0: 7220 3d20 226d 6522 2c5c 6e20 2020 2020  r = "me",\n     
+000583f0: 2020 2020 2720 2b20 2774 6974 6c65 203d      ' + 'title =
+00058400: 2022 7b61 6263 7d22 2c5c 6e7d 272c 0a20   "{abc}",\n}',. 
+00058410: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00058420: 6620 7465 7374 5f75 7064 6174 6552 6563  f test_updateRec
+00058430: 6f72 6428 7365 6c66 2c20 2a61 7267 7329  ord(self, *args)
+00058440: 3a0a 2020 2020 2020 2020 2222 2274 6573  :.        """tes
+00058450: 7420 7570 6461 7465 5265 636f 7264 2222  t updateRecord""
+00058460: 220a 2020 2020 2020 2020 6520 3d20 7b22  ".        e = {"
+00058470: 6269 626b 6579 223a 2022 6162 6322 2c20  bibkey": "abc", 
+00058480: 2262 6962 7465 7822 3a20 2262 6962 222c  "bibtex": "bib",
+00058490: 2022 696e 7370 6972 6522 3a20 2231 3233   "inspire": "123
+000584a0: 222c 2022 7072 6f63 6565 6469 6e67 223a  ", "proceeding":
+000584b0: 2030 7d0a 2020 2020 2020 2020 6e20 3d20   0}.        n = 
+000584c0: 7b22 6269 626b 6579 223a 2022 6162 6364  {"bibkey": "abcd
+000584d0: 222c 2022 6269 6274 6578 223a 2022 6269  ", "bibtex": "bi
+000584e0: 6274 6578 222c 2022 696e 7370 6972 6522  btex", "inspire"
+000584f0: 3a20 2231 3233 222c 2022 7072 6f63 6565  : "123", "procee
+00058500: 6469 6e67 223a 2030 7d0a 2020 2020 2020  ding": 0}.      
+00058510: 2020 7769 7468 2070 6174 6368 280a 2020    with patch(.  
+00058520: 2020 2020 2020 2020 2020 2270 6879 7362            "physb
+00058530: 6962 6c69 6f2e 6461 7461 6261 7365 2e45  iblio.database.E
+00058540: 6e74 7269 6573 2e75 7064 6174 6549 6e66  ntries.updateInf
+00058550: 6f46 726f 6d4f 4149 222c 0a20 2020 2020  oFromOAI",.     
+00058560: 2020 2020 2020 2073 6964 655f 6566 6665         side_effe
+00058570: 6374 3d5b 4661 6c73 652c 2054 7275 652c  ct=[False, True,
+00058580: 2054 7275 652c 2054 7275 655d 2c0a 2020   True, True],.  
+00058590: 2020 2020 2020 2920 6173 205f 7569 2c20        ) as _ui, 
+000585a0: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
+000585b0: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
+000585c0: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
+000585d0: 6765 7442 794b 6579 222c 2072 6574 7572  getByKey", retur
+000585e0: 6e5f 7661 6c75 653d 5b65 5d0a 2020 2020  n_value=[e].    
+000585f0: 2020 2020 2920 6173 205f 676b 3a0a 2020      ) as _gk:.  
+00058600: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00058610: 7373 6572 7446 616c 7365 2873 656c 662e  ssertFalse(self.
+00058620: 7042 4442 2e62 6962 732e 7570 6461 7465  pBDB.bibs.update
+00058630: 5265 636f 7264 2865 2e63 6f70 7928 292c  Record(e.copy(),
+00058640: 207b 2262 223a 2022 6122 7d29 290a 2020   {"b": "a"})).  
+00058650: 2020 2020 2020 2020 2020 5f75 692e 6173            _ui.as
+00058660: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+00058670: 5f77 6974 6828 0a20 2020 2020 2020 2020  _with(.         
+00058680: 2020 2020 2020 2022 3132 3322 2c0a 2020         "123",.  
+00058690: 2020 2020 2020 2020 2020 2020 2020 6269                bi
+000586a0: 6274 6578 3d22 6269 6222 2c0a 2020 2020  btex="bib",.    
+000586b0: 2020 2020 2020 2020 2020 2020 7265 6164              read
+000586c0: 436f 6e66 6572 656e 6365 5469 746c 653d  ConferenceTitle=
+000586d0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+000586e0: 2020 2020 2020 2072 656c 6f61 6441 6c6c         reloadAll
+000586f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00058700: 2020 2020 2020 2020 6f72 6967 696e 616c          original
+00058710: 4b65 793d 2261 6263 222c 0a20 2020 2020  Key="abc",.     
+00058720: 2020 2020 2020 2020 2020 2075 7365 5265             useRe
+00058730: 636f 7264 3d7b 2262 223a 2022 6122 7d2c  cord={"b": "a"},
+00058740: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00058750: 2020 2020 2020 2020 2020 205f 676b 2e61             _gk.a
+00058760: 7373 6572 745f 6e6f 745f 6361 6c6c 6564  ssert_not_called
+00058770: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00058780: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+00058790: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
+000587a0: 7064 6174 6552 6563 6f72 6428 652e 636f  pdateRecord(e.co
+000587b0: 7079 2829 2c20 7b22 6222 3a20 2261 227d  py(), {"b": "a"}
+000587c0: 2929 0a20 2020 2020 2020 2020 2020 205f  )).            _
+000587d0: 676b 2e61 7373 6572 745f 6361 6c6c 6564  gk.assert_called
+000587e0: 5f6f 6e63 655f 7769 7468 2822 6162 6322  _once_with("abc"
+000587f0: 2c20 7361 7665 5175 6572 793d 4661 6c73  , saveQuery=Fals
+00058800: 6529 0a20 2020 2020 2020 2020 2020 205f  e).            _
+00058810: 676b 2e72 6574 7572 6e5f 7661 6c75 6520  gk.return_value 
+00058820: 3d20 5b6e 5d0a 2020 2020 2020 2020 2020  = [n].          
+00058830: 2020 5f75 692e 7265 7365 745f 6d6f 636b    _ui.reset_mock
+00058840: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00058850: 656c 662e 6173 7365 7274 5472 7565 280a  elf.assertTrue(.
+00058860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058870: 7365 6c66 2e70 4244 422e 6269 6273 2e75  self.pBDB.bibs.u
+00058880: 7064 6174 6552 6563 6f72 6428 0a20 2020  pdateRecord(.   
+00058890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000588a0: 2065 2e63 6f70 7928 292c 207b 2262 223a   e.copy(), {"b":
+000588b0: 2022 6122 7d2c 2066 6f72 6365 3d54 7275   "a"}, force=Tru
+000588c0: 652c 2072 656c 6f61 6441 6c6c 3d54 7275  e, reloadAll=Tru
+000588d0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000588e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000588f0: 290a 2020 2020 2020 2020 2020 2020 5f75  ).            _u
+00058900: 692e 6173 7365 7274 5f63 616c 6c65 645f  i.assert_called_
+00058910: 6f6e 6365 5f77 6974 6828 0a20 2020 2020  once_with(.     
+00058920: 2020 2020 2020 2020 2020 2022 3132 3322             "123"
+00058930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00058940: 2020 6269 6274 6578 3d22 6269 6222 2c0a    bibtex="bib",.
+00058950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058960: 7265 6164 436f 6e66 6572 656e 6365 5469  readConferenceTi
+00058970: 746c 653d 4661 6c73 652c 0a20 2020 2020  tle=False,.     
+00058980: 2020 2020 2020 2020 2020 2072 656c 6f61             reloa
+00058990: 6441 6c6c 3d54 7275 652c 0a20 2020 2020  dAll=True,.     
+000589a0: 2020 2020 2020 2020 2020 206f 7269 6769             origi
+000589b0: 6e61 6c4b 6579 3d22 6162 6322 2c0a 2020  nalKey="abc",.  
+000589c0: 2020 2020 2020 2020 2020 2020 2020 7573                us
+000589d0: 6552 6563 6f72 643d 7b22 6222 3a20 2261  eRecord={"b": "a
+000589e0: 227d 2c0a 2020 2020 2020 2020 2020 2020  "},.            
+000589f0: 290a 2020 2020 2020 2020 2020 2020 655b  ).            e[
+00058a00: 2270 726f 6365 6564 696e 6722 5d20 3d20  "proceeding"] = 
+00058a10: 310a 2020 2020 2020 2020 2020 2020 5f75  1.            _u
+00058a20: 692e 7265 7365 745f 6d6f 636b 2829 0a20  i.reset_mock(). 
+00058a30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00058a40: 6173 7365 7274 5472 7565 280a 2020 2020  assertTrue(.    
+00058a50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00058a60: 2e70 4244 422e 6269 6273 2e75 7064 6174  .pBDB.bibs.updat
+00058a70: 6552 6563 6f72 6428 0a20 2020 2020 2020  eRecord(.       
+00058a80: 2020 2020 2020 2020 2020 2020 2065 2e63               e.c
+00058a90: 6f70 7928 292c 207b 2262 223a 2022 6122  opy(), {"b": "a"
+00058aa0: 7d2c 2066 6f72 6365 3d54 7275 652c 2072  }, force=True, r
+00058ab0: 656c 6f61 6441 6c6c 3d54 7275 650a 2020  eloadAll=True.  
+00058ac0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00058ad0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00058ae0: 2020 2020 2020 2020 2020 5f75 692e 6173            _ui.as
+00058af0: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+00058b00: 5f77 6974 6828 0a20 2020 2020 2020 2020  _with(.         
+00058b10: 2020 2020 2020 2022 3132 3322 2c0a 2020         "123",.  
+00058b20: 2020 2020 2020 2020 2020 2020 2020 6269                bi
+00058b30: 6274 6578 3d22 6269 6222 2c0a 2020 2020  btex="bib",.    
+00058b40: 2020 2020 2020 2020 2020 2020 7265 6164              read
+00058b50: 436f 6e66 6572 656e 6365 5469 746c 653d  ConferenceTitle=
+00058b60: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00058b70: 2020 2020 2020 7265 6c6f 6164 416c 6c3d        reloadAll=
+00058b80: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00058b90: 2020 2020 2020 6f72 6967 696e 616c 4b65        originalKe
+00058ba0: 793d 2261 6263 222c 0a20 2020 2020 2020  y="abc",.       
+00058bb0: 2020 2020 2020 2020 2075 7365 5265 636f           useReco
+00058bc0: 7264 3d7b 2262 223a 2022 6122 7d2c 0a20  rd={"b": "a"},. 
+00058bd0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00058be0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+00058bf0: 6962 732e 6e65 774b 6579 203d 2022 6465  ibs.newKey = "de
+00058c00: 6622 0a20 2020 2020 2020 2077 6974 6820  f".        with 
+00058c10: 7061 7463 6828 0a20 2020 2020 2020 2020  patch(.         
+00058c20: 2020 2022 7068 7973 6269 626c 696f 2e64     "physbiblio.d
+00058c30: 6174 6162 6173 652e 456e 7472 6965 732e  atabase.Entries.
+00058c40: 7570 6461 7465 496e 666f 4672 6f6d 4f41  updateInfoFromOA
+00058c50: 4922 2c20 7265 7475 726e 5f76 616c 7565  I", return_value
+00058c60: 3d54 7275 650a 2020 2020 2020 2020 2920  =True.        ) 
+00058c70: 6173 205f 7569 2c20 7061 7463 6828 0a20  as _ui, patch(. 
+00058c80: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+00058c90: 6269 626c 696f 2e64 6174 6162 6173 652e  biblio.database.
+00058ca0: 456e 7472 6965 732e 6765 7442 794b 6579  Entries.getByKey
+00058cb0: 222c 2073 6964 655f 6566 6665 6374 3d5b  ", side_effect=[
+00058cc0: 5b5d 2c20 5b6e 5d2c 205b 5d2c 205b 5d5d  [], [n], [], []]
+00058cd0: 0a20 2020 2020 2020 2029 2061 7320 5f67  .        ) as _g
+00058ce0: 6b3a 0a20 2020 2020 2020 2020 2020 2073  k:.            s
+00058cf0: 656c 662e 6173 7365 7274 5472 7565 2873  elf.assertTrue(s
+00058d00: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
+00058d10: 6461 7465 5265 636f 7264 2865 2e63 6f70  dateRecord(e.cop
+00058d20: 7928 292c 207b 2262 223a 2022 6122 7d29  y(), {"b": "a"})
+00058d30: 290a 2020 2020 2020 2020 2020 2020 5f75  ).            _u
+00058d40: 692e 6173 7365 7274 5f63 616c 6c65 645f  i.assert_called_
+00058d50: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
+00058d60: 2020 2020 2020 2231 3233 222c 0a20 2020        "123",.   
+00058d70: 2020 2020 2020 2020 2020 2020 2062 6962               bib
+00058d80: 7465 783d 2262 6962 222c 0a20 2020 2020  tex="bib",.     
+00058d90: 2020 2020 2020 2020 2020 2072 6561 6443             readC
+00058da0: 6f6e 6665 7265 6e63 6554 6974 6c65 3d46  onferenceTitle=F
+00058db0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00058dc0: 2020 2020 2020 7265 6c6f 6164 416c 6c3d        reloadAll=
+00058dd0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00058de0: 2020 2020 2020 206f 7269 6769 6e61 6c4b         originalK
+00058df0: 6579 3d22 6162 6322 2c0a 2020 2020 2020  ey="abc",.      
+00058e00: 2020 2020 2020 2020 2020 7573 6552 6563            useRec
+00058e10: 6f72 643d 7b22 6222 3a20 2261 227d 2c0a  ord={"b": "a"},.
+00058e20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00058e30: 2020 2020 2020 2020 2020 5f67 6b2e 6173            _gk.as
+00058e40: 7365 7274 5f61 6e79 5f63 616c 6c28 2261  sert_any_call("a
+00058e50: 6263 222c 2073 6176 6551 7565 7279 3d46  bc", saveQuery=F
+00058e60: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
+00058e70: 2020 5f67 6b2e 6173 7365 7274 5f61 6e79    _gk.assert_any
+00058e80: 5f63 616c 6c28 2264 6566 222c 2073 6176  _call("def", sav
+00058e90: 6551 7565 7279 3d46 616c 7365 290a 2020  eQuery=False).  
+00058ea0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00058eb0: 7373 6572 7446 616c 7365 2868 6173 6174  ssertFalse(hasat
+00058ec0: 7472 2873 656c 662e 7042 4442 2e62 6962  tr(self.pBDB.bib
+00058ed0: 732c 2022 6e65 774b 6579 2229 290a 2020  s, "newKey")).  
+00058ee0: 2020 2020 2020 2020 2020 5f67 6b2e 7265            _gk.re
+00058ef0: 7365 745f 6d6f 636b 2829 0a20 2020 2020  set_mock().     
+00058f00: 2020 2020 2020 2073 656c 662e 7042 4442         self.pBDB
+00058f10: 2e62 6962 732e 6e65 774b 6579 203d 2022  .bibs.newKey = "
+00058f20: 6465 6622 0a20 2020 2020 2020 2020 2020  def".           
+00058f30: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
+00058f40: 6528 7365 6c66 2e70 4244 422e 6269 6273  e(self.pBDB.bibs
+00058f50: 2e75 7064 6174 6552 6563 6f72 6428 652e  .updateRecord(e.
+00058f60: 636f 7079 2829 2c20 7b22 6222 3a20 2261  copy(), {"b": "a
+00058f70: 227d 2929 0a20 2020 2020 2020 2020 2020  "})).           
+00058f80: 205f 676b 2e61 7373 6572 745f 616e 795f   _gk.assert_any_
+00058f90: 6361 6c6c 2822 6162 6322 2c20 7361 7665  call("abc", save
+00058fa0: 5175 6572 793d 4661 6c73 6529 0a20 2020  Query=False).   
+00058fb0: 2020 2020 2020 2020 205f 676b 2e61 7373           _gk.ass
+00058fc0: 6572 745f 616e 795f 6361 6c6c 2822 6465  ert_any_call("de
+00058fd0: 6622 2c20 7361 7665 5175 6572 793d 4661  f", saveQuery=Fa
+00058fe0: 6c73 6529 0a0a 2020 2020 6465 6620 7465  lse)..    def te
+00058ff0: 7374 5f75 7064 6174 6552 6563 6f72 6446  st_updateRecordF
+00059000: 726f 6d49 4e53 5049 5245 2873 656c 662c  romINSPIRE(self,
+00059010: 202a 6172 6773 293a 0a20 2020 2020 2020   *args):.       
+00059020: 2022 2222 7465 7374 2075 7064 6174 6552   """test updateR
+00059030: 6563 6f72 6446 726f 6d49 4e53 5049 5245  ecordFromINSPIRE
+00059040: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+00059050: 2e69 6e73 6572 745f 7468 7265 6528 290a  .insert_three().
+00059060: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+00059070: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+00059080: 2270 6879 7362 6962 6c69 6f2e 6461 7461  "physbiblio.data
+00059090: 6261 7365 2e45 6e74 7269 6573 2e67 6574  base.Entries.get
+000590a0: 4279 4964 4672 6f6d 496e 7370 6972 6552  ByIdFromInspireR
+000590b0: 6563 6f72 6422 2c20 7265 7475 726e 5f76  ecord", return_v
+000590c0: 616c 7565 3d5b 5d0a 2020 2020 2020 2020  alue=[].        
+000590d0: 2920 6173 205f 6769 722c 2070 6174 6368  ) as _gir, patch
+000590e0: 2822 7068 7973 6269 626c 696f 2e64 6174  ("physbiblio.dat
+000590f0: 6162 6173 652e 456e 7472 6965 732e 7570  abase.Entries.up
+00059100: 6461 7465 4669 656c 6422 2920 6173 205f  dateField") as _
+00059110: 7566 3a0a 2020 2020 2020 2020 2020 2020  uf:.            
+00059120: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00059130: 2873 656c 662e 7042 4442 2e62 6962 732e  (self.pBDB.bibs.
+00059140: 7570 6461 7465 5265 636f 7264 4672 6f6d  updateRecordFrom
+00059150: 494e 5350 4952 4528 2261 6263 2229 2c20  INSPIRE("abc"), 
+00059160: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+00059170: 2020 205f 6769 722e 6173 7365 7274 5f63     _gir.assert_c
+00059180: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+00059190: 2261 6263 2229 0a20 2020 2020 2020 2020  "abc").         
+000591a0: 2020 205f 7566 2e61 7373 6572 745f 6e6f     _uf.assert_no
+000591b0: 745f 6361 6c6c 6564 2829 0a20 2020 2020  t_called().     
+000591c0: 2020 2077 6974 6820 7061 7463 6828 0a20     with patch(. 
+000591d0: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+000591e0: 6269 626c 696f 2e64 6174 6162 6173 652e  biblio.database.
+000591f0: 456e 7472 6965 732e 6765 7442 7949 6446  Entries.getByIdF
+00059200: 726f 6d49 6e73 7069 7265 5265 636f 7264  romInspireRecord
+00059210: 222c 0a20 2020 2020 2020 2020 2020 2072  ",.            r
+00059220: 6574 7572 6e5f 7661 6c75 653d 5b7b 226e  eturn_value=[{"n
+00059230: 6f55 7064 6174 6522 3a20 317d 5d2c 0a20  oUpdate": 1}],. 
+00059240: 2020 2020 2020 2029 2061 7320 5f67 6972         ) as _gir
+00059250: 2c20 7061 7463 6828 2270 6879 7362 6962  , patch("physbib
+00059260: 6c69 6f2e 6461 7461 6261 7365 2e45 6e74  lio.database.Ent
+00059270: 7269 6573 2e75 7064 6174 6546 6965 6c64  ries.updateField
+00059280: 2229 2061 7320 5f75 663a 0a20 2020 2020  ") as _uf:.     
+00059290: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000592a0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+000592b0: 422e 6269 6273 2e75 7064 6174 6552 6563  B.bibs.updateRec
+000592c0: 6f72 6446 726f 6d49 4e53 5049 5245 2822  ordFromINSPIRE("
+000592d0: 6162 6322 292c 2046 616c 7365 290a 2020  abc"), False).  
+000592e0: 2020 2020 2020 2020 2020 5f67 6972 2e61            _gir.a
+000592f0: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00059300: 655f 7769 7468 2822 6162 6322 290a 2020  e_with("abc").  
+00059310: 2020 2020 2020 2020 2020 5f75 662e 6173            _uf.as
+00059320: 7365 7274 5f6e 6f74 5f63 616c 6c65 6428  sert_not_called(
+00059330: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+00059340: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+00059350: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
+00059360: 7461 6261 7365 2e45 6e74 7269 6573 2e67  tabase.Entries.g
+00059370: 6574 4279 4964 4672 6f6d 496e 7370 6972  etByIdFromInspir
+00059380: 6552 6563 6f72 6422 2c0a 2020 2020 2020  eRecord",.      
+00059390: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
+000593a0: 7565 3d5b 7b22 6e6f 5570 6461 7465 223a  ue=[{"noUpdate":
+000593b0: 2030 2c20 2262 6962 6b65 7922 3a20 2261   0, "bibkey": "a
+000593c0: 6263 222c 2022 6269 6274 6578 223a 2022  bc", "bibtex": "
+000593d0: 6269 6222 7d5d 2c0a 2020 2020 2020 2020  bib"}],.        
+000593e0: 2920 6173 205f 6769 722c 2070 6174 6368  ) as _gir, patch
+000593f0: 2822 7068 7973 6269 626c 696f 2e64 6174  ("physbiblio.dat
+00059400: 6162 6173 652e 456e 7472 6965 732e 7570  abase.Entries.up
+00059410: 6461 7465 4669 656c 6422 2920 6173 205f  dateField") as _
+00059420: 7566 2c20 7061 7463 6828 0a20 2020 2020  uf, patch(.     
+00059430: 2020 2020 2020 2022 7068 7973 6269 626c         "physbibl
+00059440: 696f 2e77 6562 696d 706f 7274 2e69 6e73  io.webimport.ins
+00059450: 7069 7265 2e57 6562 5365 6172 6368 2e75  pire.WebSearch.u
+00059460: 7064 6174 6542 6962 7465 7822 2c0a 2020  pdateBibtex",.  
+00059470: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00059480: 5f76 616c 7565 3d28 4661 6c73 652c 2022  _value=(False, "
+00059490: 6269 6274 6578 2229 2c0a 2020 2020 2020  bibtex"),.      
+000594a0: 2020 2920 6173 205f 7562 3a0a 2020 2020    ) as _ub:.    
+000594b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000594c0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+000594d0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+000594e0: 4244 422e 6269 6273 2e75 7064 6174 6552  BDB.bibs.updateR
+000594f0: 6563 6f72 6446 726f 6d49 4e53 5049 5245  ecordFromINSPIRE
+00059500: 287b 2269 6422 3a20 2261 6263 227d 292c  ({"id": "abc"}),
+00059510: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+00059520: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00059530: 205f 6769 722e 6173 7365 7274 5f63 616c   _gir.assert_cal
+00059540: 6c65 645f 6f6e 6365 5f77 6974 6828 7b22  led_once_with({"
+00059550: 6964 223a 2022 6162 6322 7d29 0a20 2020  id": "abc"}).   
+00059560: 2020 2020 2020 2020 205f 7566 2e61 7373           _uf.ass
+00059570: 6572 745f 6e6f 745f 6361 6c6c 6564 2829  ert_not_called()
+00059580: 0a20 2020 2020 2020 2020 2020 205f 7562  .            _ub
+00059590: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+000595a0: 6e63 655f 7769 7468 287b 2269 6422 3a20  nce_with({"id": 
+000595b0: 2261 6263 227d 2c20 2262 6962 222c 2066  "abc"}, "bib", f
+000595c0: 6f72 6365 3d46 616c 7365 290a 2020 2020  orce=False).    
+000595d0: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
+000595e0: 2020 2020 2020 2020 2020 2020 2270 6879              "phy
+000595f0: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+00059600: 2e45 6e74 7269 6573 2e67 6574 4279 4964  .Entries.getById
+00059610: 4672 6f6d 496e 7370 6972 6552 6563 6f72  FromInspireRecor
+00059620: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+00059630: 7265 7475 726e 5f76 616c 7565 3d5b 0a20  return_value=[. 
+00059640: 2020 2020 2020 2020 2020 2020 2020 207b                 {
+00059650: 226e 6f55 7064 6174 6522 3a20 302c 2022  "noUpdate": 0, "
+00059660: 6269 626b 6579 223a 2022 6162 6322 2c20  bibkey": "abc", 
+00059670: 2262 6962 7465 7822 3a20 2262 6962 222c  "bibtex": "bib",
+00059680: 2022 696e 7370 6972 6522 3a20 2231 3233   "inspire": "123
+00059690: 3522 7d0a 2020 2020 2020 2020 2020 2020  5"}.            
+000596a0: 5d2c 0a20 2020 2020 2020 2029 2061 7320  ],.        ) as 
+000596b0: 5f67 6972 2c20 7061 7463 6828 2270 6879  _gir, patch("phy
+000596c0: 7362 6962 6c69 6f2e 6461 7461 6261 7365  sbiblio.database
+000596d0: 2e45 6e74 7269 6573 2e75 7064 6174 6546  .Entries.updateF
+000596e0: 6965 6c64 2229 2061 7320 5f75 662c 2070  ield") as _uf, p
+000596f0: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+00059700: 2020 2270 6879 7362 6962 6c69 6f2e 7765    "physbiblio.we
+00059710: 6269 6d70 6f72 742e 696e 7370 6972 652e  bimport.inspire.
+00059720: 5765 6253 6561 7263 682e 7570 6461 7465  WebSearch.update
+00059730: 4269 6274 6578 222c 0a20 2020 2020 2020  Bibtex",.       
+00059740: 2020 2020 2072 6574 7572 6e5f 7661 6c75       return_valu
+00059750: 653d 2846 616c 7365 2c20 2262 6962 7465  e=(False, "bibte
+00059760: 7822 292c 0a20 2020 2020 2020 2029 2061  x"),.        ) a
+00059770: 7320 5f75 623a 0a20 2020 2020 2020 2020  s _ub:.         
+00059780: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00059790: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+000597a0: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+000597b0: 6962 732e 7570 6461 7465 5265 636f 7264  ibs.updateRecord
+000597c0: 4672 6f6d 494e 5350 4952 4528 7b22 6964  FromINSPIRE({"id
+000597d0: 223a 2022 3132 3334 227d 292c 2054 7275  ": "1234"}), Tru
+000597e0: 650a 2020 2020 2020 2020 2020 2020 290a  e.            ).
+000597f0: 2020 2020 2020 2020 2020 2020 5f67 6972              _gir
+00059800: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
+00059810: 6e63 655f 7769 7468 287b 2269 6422 3a20  nce_with({"id": 
+00059820: 2231 3233 3422 7d29 0a20 2020 2020 2020  "1234"}).       
+00059830: 2020 2020 205f 7566 2e61 7373 6572 745f       _uf.assert_
+00059840: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+00059850: 2822 6162 6322 2c20 2269 6e73 7069 7265  ("abc", "inspire
+00059860: 222c 2022 3132 3334 222c 2076 6572 626f  ", "1234", verbo
+00059870: 7365 3d30 290a 2020 2020 2020 2020 2020  se=0).          
+00059880: 2020 5f75 622e 6173 7365 7274 5f63 616c    _ub.assert_cal
+00059890: 6c65 645f 6f6e 6365 5f77 6974 6828 7b22  led_once_with({"
+000598a0: 6964 223a 2022 3132 3334 227d 2c20 2262  id": "1234"}, "b
+000598b0: 6962 222c 2066 6f72 6365 3d46 616c 7365  ib", force=False
+000598c0: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+000598d0: 6174 6368 280a 2020 2020 2020 2020 2020  atch(.          
+000598e0: 2020 2270 6879 7362 6962 6c69 6f2e 6461    "physbiblio.da
+000598f0: 7461 6261 7365 2e45 6e74 7269 6573 2e67  tabase.Entries.g
+00059900: 6574 4279 4964 4672 6f6d 496e 7370 6972  etByIdFromInspir
+00059910: 6552 6563 6f72 6422 2c0a 2020 2020 2020  eRecord",.      
+00059920: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
+00059930: 7565 3d5b 0a20 2020 2020 2020 2020 2020  ue=[.           
+00059940: 2020 2020 207b 226e 6f55 7064 6174 6522       {"noUpdate"
+00059950: 3a20 302c 2022 6269 626b 6579 223a 2022  : 0, "bibkey": "
+00059960: 6162 6322 2c20 2262 6962 7465 7822 3a20  abc", "bibtex": 
+00059970: 2262 6962 222c 2022 696e 7370 6972 6522  "bib", "inspire"
+00059980: 3a20 2231 3233 3522 7d0a 2020 2020 2020  : "1235"}.      
+00059990: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+000599a0: 2029 2061 7320 5f67 6972 2c20 7061 7463   ) as _gir, patc
+000599b0: 6828 2270 6879 7362 6962 6c69 6f2e 6461  h("physbiblio.da
+000599c0: 7461 6261 7365 2e45 6e74 7269 6573 2e75  tabase.Entries.u
+000599d0: 7064 6174 6546 6965 6c64 2229 2061 7320  pdateField") as 
+000599e0: 5f75 662c 2070 6174 6368 280a 2020 2020  _uf, patch(.    
+000599f0: 2020 2020 2020 2020 2270 6879 7362 6962          "physbib
+00059a00: 6c69 6f2e 7765 6269 6d70 6f72 742e 696e  lio.webimport.in
+00059a10: 7370 6972 652e 5765 6253 6561 7263 682e  spire.WebSearch.
+00059a20: 7570 6461 7465 4269 6274 6578 222c 0a20  updateBibtex",. 
+00059a30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00059a40: 6e5f 7661 6c75 653d 2854 7275 652c 2027  n_value=(True, '
+00059a50: 4061 7274 6963 6c65 7b61 6263 2c5c 6e61  @article{abc,\na
+00059a60: 7574 686f 7220 3d20 226d 6522 2c5c 6e74  uthor = "me",\nt
+00059a70: 6974 6c65 203d 2022 6162 6322 2c7d 2729  itle = "abc",}')
+00059a80: 2c0a 2020 2020 2020 2020 2920 6173 205f  ,.        ) as _
+00059a90: 7562 3a0a 2020 2020 2020 2020 2020 2020  ub:.            
+00059aa0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00059ab0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00059ac0: 2020 7365 6c66 2e70 4244 422e 6269 6273    self.pBDB.bibs
+00059ad0: 2e75 7064 6174 6552 6563 6f72 6446 726f  .updateRecordFro
+00059ae0: 6d49 4e53 5049 5245 280a 2020 2020 2020  mINSPIRE(.      
+00059af0: 2020 2020 2020 2020 2020 2020 2020 7b22                {"
+00059b00: 6964 223a 204e 6f6e 652c 2022 636f 6c6c  id": None, "coll
+00059b10: 6162 6f72 6174 696f 6e22 3a20 4e6f 6e65  aboration": None
+00059b20: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00059b30: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00059b40: 2020 2020 2054 7275 652c 0a20 2020 2020       True,.     
+00059b50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00059b60: 2020 2020 205f 6769 722e 6173 7365 7274       _gir.assert
+00059b70: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+00059b80: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
+00059b90: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+00059ba0: 2020 2020 2020 2020 2022 6964 223a 204e           "id": N
+00059bb0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00059bc0: 2020 2020 2020 2020 2022 636f 6c6c 6162           "collab
+00059bd0: 6f72 6174 696f 6e22 3a20 4e6f 6e65 2c0a  oration": None,.
+00059be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059bf0: 2020 2020 2262 6962 7465 7822 3a20 2740      "bibtex": '@
+00059c00: 4172 7469 636c 657b 6162 632c 5c6e 2020  Article{abc,\n  
+00059c10: 2020 2020 2020 6175 7468 6f72 203d 2022        author = "
+00059c20: 6d65 222c 5c6e 2020 2020 2020 2020 2074  me",\n         t
+00059c30: 6974 6c65 203d 2022 7b61 6263 7d22 2c5c  itle = "{abc}",\
+00059c40: 6e7d 272c 0a20 2020 2020 2020 2020 2020  n}',.           
+00059c50: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+00059c60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00059c70: 205f 7566 2e61 7373 6572 745f 6361 6c6c   _uf.assert_call
+00059c80: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
+00059c90: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+00059ca0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+00059cb0: 2020 2020 2022 6269 6274 6578 222c 0a20       "bibtex",. 
+00059cc0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00059cd0: 4041 7274 6963 6c65 7b61 6263 2c5c 6e20  @Article{abc,\n 
+00059ce0: 2020 2020 2020 2061 7574 686f 7220 3d20         author = 
+00059cf0: 226d 6522 2c5c 6e20 2020 2020 2020 2020  "me",\n         
+00059d00: 7469 746c 6520 3d20 227b 6162 637d 222c  title = "{abc}",
+00059d10: 5c6e 7d27 2c0a 2020 2020 2020 2020 2020  \n}',.          
+00059d20: 2020 2020 2020 7665 7262 6f73 653d 302c        verbose=0,
+00059d30: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00059d40: 2020 2020 2020 2020 2020 205f 7562 2e61             _ub.a
+00059d50: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00059d60: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
+00059d70: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+00059d80: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+00059d90: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
+00059da0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00059db0: 6f6c 6c61 626f 7261 7469 6f6e 223a 204e  ollaboration": N
+00059dc0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00059dd0: 2020 2020 2020 2020 2022 6269 6274 6578           "bibtex
+00059de0: 223a 2027 4041 7274 6963 6c65 7b61 6263  ": '@Article{abc
+00059df0: 2c5c 6e20 2020 2020 2020 2061 7574 686f  ,\n        autho
+00059e00: 7220 3d20 226d 6522 2c5c 6e20 2020 2020  r = "me",\n     
+00059e10: 2020 2020 7469 746c 6520 3d20 227b 6162      title = "{ab
+00059e20: 637d 222c 5c6e 7d27 2c0a 2020 2020 2020  c}",\n}',.      
+00059e30: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00059e40: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+00059e50: 6222 2c0a 2020 2020 2020 2020 2020 2020  b",.            
+00059e60: 2020 2020 666f 7263 653d 4661 6c73 652c      force=False,
+00059e70: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00059e80: 2020 2020 2020 2023 2074 6573 7420 7573         # test us
+00059e90: 654f 6c64 0a20 2020 2020 2020 2077 6974  eOld.        wit
+00059ea0: 6820 7061 7463 6828 0a20 2020 2020 2020  h patch(.       
+00059eb0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+00059ec0: 2e64 6174 6162 6173 652e 456e 7472 6965  .database.Entrie
+00059ed0: 732e 6765 7442 7949 6446 726f 6d49 6e73  s.getByIdFromIns
+00059ee0: 7069 7265 5265 636f 7264 222c 0a20 2020  pireRecord",.   
+00059ef0: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+00059f00: 7661 6c75 653d 5b0a 2020 2020 2020 2020  value=[.        
+00059f10: 2020 2020 2020 2020 7b22 6e6f 5570 6461          {"noUpda
+00059f20: 7465 223a 2030 2c20 2262 6962 6b65 7922  te": 0, "bibkey"
+00059f30: 3a20 2261 6263 222c 2022 6269 6274 6578  : "abc", "bibtex
+00059f40: 223a 2022 6269 6222 2c20 2269 6e73 7069  ": "bib", "inspi
+00059f50: 7265 223a 2022 3132 3335 227d 0a20 2020  re": "1235"}.   
+00059f60: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00059f70: 2020 2020 2920 6173 205f 6769 722c 2070      ) as _gir, p
+00059f80: 6174 6368 2822 7068 7973 6269 626c 696f  atch("physbiblio
+00059f90: 2e64 6174 6162 6173 652e 456e 7472 6965  .database.Entrie
+00059fa0: 732e 7570 6461 7465 4669 656c 6422 2920  s.updateField") 
+00059fb0: 6173 205f 7566 2c20 7061 7463 6828 0a20  as _uf, patch(. 
+00059fc0: 2020 2020 2020 2020 2020 2022 7068 7973             "phys
+00059fd0: 6269 626c 696f 2e77 6562 696d 706f 7274  biblio.webimport
+00059fe0: 2e69 6e73 7069 7265 2e57 6562 5365 6172  .inspire.WebSear
+00059ff0: 6368 2e75 7064 6174 6542 6962 7465 7822  ch.updateBibtex"
+0005a000: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
+0005a010: 7475 726e 5f76 616c 7565 3d28 5472 7565  turn_value=(True
+0005a020: 2c20 2740 6172 7469 636c 657b 6162 632c  , '@article{abc,
+0005a030: 5c6e 6175 7468 6f72 203d 2022 6d65 222c  \nauthor = "me",
+0005a040: 5c6e 7469 746c 6520 3d20 2261 6263 222c  \ntitle = "abc",
+0005a050: 7d27 292c 0a20 2020 2020 2020 2029 2061  }'),.        ) a
+0005a060: 7320 5f75 623a 0a20 2020 2020 2020 2020  s _ub:.         
+0005a070: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0005a080: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+0005a090: 2020 2020 2073 656c 662e 7042 4442 2e62       self.pBDB.b
+0005a0a0: 6962 732e 7570 6461 7465 5265 636f 7264  ibs.updateRecord
+0005a0b0: 4672 6f6d 494e 5350 4952 4528 0a20 2020  FromINSPIRE(.   
+0005a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a0d0: 207b 2269 6422 3a20 4e6f 6e65 7d2c 0a20   {"id": None},. 
+0005a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a0f0: 2020 2075 7365 4f6c 643d 5b0a 2020 2020     useOld=[.    
+0005a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a110: 2020 2020 7b0a 2020 2020 2020 2020 2020      {.          
+0005a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a130: 2020 226e 6f55 7064 6174 6522 3a20 312c    "noUpdate": 1,
+0005a140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005a150: 2020 2020 2020 2020 2020 2020 2022 6269               "bi
+0005a160: 626b 6579 223a 2022 6162 6322 2c0a 2020  bkey": "abc",.  
+0005a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a180: 2020 2020 2020 2020 2020 2262 6962 7465            "bibte
+0005a190: 7822 3a20 226d 7962 6962 222c 0a20 2020  x": "mybib",.   
+0005a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a1b0: 2020 2020 2020 2020 2022 696e 7370 6972           "inspir
+0005a1c0: 6522 3a20 2234 3435 3522 2c0a 2020 2020  e": "4455",.    
+0005a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a1e0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+0005a1f0: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+0005a200: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
+0005a210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a220: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+0005a230: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0005a240: 205f 6769 722e 6173 7365 7274 5f6e 6f74   _gir.assert_not
+0005a250: 5f63 616c 6c65 6428 290a 2020 2020 2020  _called().      
+0005a260: 2020 2320 7465 7374 2066 6f72 6365 0a20    # test force. 
+0005a270: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+0005a280: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+0005a290: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
+0005a2a0: 6173 652e 456e 7472 6965 732e 6765 7442  ase.Entries.getB
+0005a2b0: 7949 6446 726f 6d49 6e73 7069 7265 5265  yIdFromInspireRe
+0005a2c0: 636f 7264 222c 0a20 2020 2020 2020 2020  cord",.         
+0005a2d0: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
+0005a2e0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0005a2f0: 2020 7b22 6e6f 5570 6461 7465 223a 2031    {"noUpdate": 1
+0005a300: 2c20 2262 6962 6b65 7922 3a20 2261 6263  , "bibkey": "abc
+0005a310: 222c 2022 6269 6274 6578 223a 2022 6269  ", "bibtex": "bi
+0005a320: 6222 2c20 2269 6e73 7069 7265 223a 2022  b", "inspire": "
+0005a330: 3132 3335 227d 0a20 2020 2020 2020 2020  1235"}.         
+0005a340: 2020 205d 2c0a 2020 2020 2020 2020 2920     ],.        ) 
+0005a350: 6173 205f 6769 722c 2070 6174 6368 2822  as _gir, patch("
+0005a360: 7068 7973 6269 626c 696f 2e64 6174 6162  physbiblio.datab
+0005a370: 6173 652e 456e 7472 6965 732e 7570 6461  ase.Entries.upda
+0005a380: 7465 4669 656c 6422 2920 6173 205f 7566  teField") as _uf
+0005a390: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
+0005a3a0: 2020 2020 2022 7068 7973 6269 626c 696f       "physbiblio
+0005a3b0: 2e77 6562 696d 706f 7274 2e69 6e73 7069  .webimport.inspi
+0005a3c0: 7265 2e57 6562 5365 6172 6368 2e75 7064  re.WebSearch.upd
+0005a3d0: 6174 6542 6962 7465 7822 2c0a 2020 2020  ateBibtex",.    
+0005a3e0: 2020 2020 2020 2020 7265 7475 726e 5f76          return_v
+0005a3f0: 616c 7565 3d28 5472 7565 2c20 2740 6172  alue=(True, '@ar
+0005a400: 7469 636c 657b 6162 632c 5c6e 6175 7468  ticle{abc,\nauth
+0005a410: 6f72 203d 2022 6d65 222c 5c6e 7469 746c  or = "me",\ntitl
+0005a420: 6520 3d20 2261 6263 222c 7d27 292c 0a20  e = "abc",}'),. 
+0005a430: 2020 2020 2020 2029 2061 7320 5f75 623a         ) as _ub:
+0005a440: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0005a450: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0005a460: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0005a470: 656c 662e 7042 4442 2e62 6962 732e 7570  elf.pBDB.bibs.up
+0005a480: 6461 7465 5265 636f 7264 4672 6f6d 494e  dateRecordFromIN
+0005a490: 5350 4952 4528 7b22 6964 223a 204e 6f6e  SPIRE({"id": Non
+0005a4a0: 657d 2c20 666f 7263 653d 5472 7565 292c  e}, force=True),
+0005a4b0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0005a4c0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0005a4d0: 5f67 6972 2e61 7373 6572 745f 6361 6c6c  _gir.assert_call
+0005a4e0: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
+0005a4f0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
+0005a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a510: 2020 2020 2269 6422 3a20 4e6f 6e65 2c0a      "id": None,.
+0005a520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005a530: 2020 2020 2262 6962 7465 7822 3a20 2740      "bibtex": '@
+0005a540: 4172 7469 636c 657b 6162 632c 5c6e 2020  Article{abc,\n  
+0005a550: 2020 2020 2020 6175 7468 6f72 203d 2022        author = "
+0005a560: 6d65 222c 5c6e 2020 2020 2020 2020 2074  me",\n         t
+0005a570: 6974 6c65 203d 2022 7b61 6263 7d22 2c5c  itle = "{abc}",\
+0005a580: 6e7d 272c 0a20 2020 2020 2020 2020 2020  n}',.           
+0005a590: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+0005a5a0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0005a5b0: 205f 7566 2e61 7373 6572 745f 6361 6c6c   _uf.assert_call
+0005a5c0: 6564 5f6f 6e63 655f 7769 7468 280a 2020  ed_once_with(.  
+0005a5d0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0005a5e0: 6263 222c 0a20 2020 2020 2020 2020 2020  bc",.           
+0005a5f0: 2020 2020 2022 6269 6274 6578 222c 0a20       "bibtex",. 
+0005a600: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0005a610: 4041 7274 6963 6c65 7b61 6263 2c5c 6e20  @Article{abc,\n 
+0005a620: 2020 2020 2020 2061 7574 686f 7220 3d20         author = 
+0005a630: 226d 6522 2c5c 6e20 2020 2020 2020 2020  "me",\n         
+0005a640: 7469 746c 6520 3d20 227b 6162 637d 222c  title = "{abc}",
+0005a650: 5c6e 7d27 2c0a 2020 2020 2020 2020 2020  \n}',.          
+0005a660: 2020 2020 2020 7665 7262 6f73 653d 302c        verbose=0,
+0005a670: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0005a680: 2020 2020 2020 2020 2020 205f 7562 2e61             _ub.a
+0005a690: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+0005a6a0: 655f 7769 7468 280a 2020 2020 2020 2020  e_with(.        
+0005a6b0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+0005a6c0: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+0005a6d0: 6422 3a20 4e6f 6e65 2c0a 2020 2020 2020  d": None,.      
+0005a6e0: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+0005a6f0: 6962 7465 7822 3a20 2740 4172 7469 636c  ibtex": '@Articl
+0005a700: 657b 6162 632c 5c6e 2020 2020 2020 2020  e{abc,\n        
+0005a710: 6175 7468 6f72 203d 2022 6d65 222c 5c6e  author = "me",\n
+0005a720: 2020 2020 2020 2020 2074 6974 6c65 203d           title =
+0005a730: 2022 7b61 6263 7d22 2c5c 6e7d 272c 0a20   "{abc}",\n}',. 
+0005a740: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+0005a750: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0005a760: 2020 2262 6962 222c 0a20 2020 2020 2020    "bib",.       
+0005a770: 2020 2020 2020 2020 2066 6f72 6365 3d54           force=T
+0005a780: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0005a790: 2029 0a0a 0a40 756e 6974 7465 7374 2e73   )...@unittest.s
+0005a7a0: 6b69 7049 6628 736b 6970 5465 7374 7353  kipIf(skipTestsS
+0005a7b0: 6574 7469 6e67 732e 6462 2c20 2244 6174  ettings.db, "Dat
+0005a7c0: 6162 6173 6520 7465 7374 7322 290a 4070  abase tests").@p
+0005a7d0: 6174 6368 2822 6c6f 6767 696e 672e 4c6f  atch("logging.Lo
+0005a7e0: 6767 6572 2e64 6562 7567 2229 0a40 7061  gger.debug").@pa
+0005a7f0: 7463 6828 226c 6f67 6769 6e67 2e4c 6f67  tch("logging.Log
+0005a800: 6765 722e 696e 666f 2229 0a40 7061 7463  ger.info").@patc
+0005a810: 6828 226c 6f67 6769 6e67 2e4c 6f67 6765  h("logging.Logge
+0005a820: 722e 7761 726e 696e 6722 290a 4070 6174  r.warning").@pat
+0005a830: 6368 2822 6c6f 6767 696e 672e 4c6f 6767  ch("logging.Logg
+0005a840: 6572 2e65 7863 6570 7469 6f6e 2229 0a63  er.exception").c
+0005a850: 6c61 7373 2054 6573 7444 6174 6162 6173  lass TestDatabas
+0005a860: 6555 7469 6c69 7469 6573 2844 4254 6573  eUtilities(DBTes
+0005a870: 7443 6173 6529 3a0a 2020 2020 2222 2254  tCase):.    """T
+0005a880: 6573 7473 2066 6f72 2074 6865 206d 6574  ests for the met
+0005a890: 686f 6473 2069 6e20 7468 6520 7574 696c  hods in the util
+0005a8a0: 6974 6965 7320 7375 6263 6c61 7373 2222  ities subclass""
+0005a8b0: 220a 0a20 2020 2064 6566 2074 6573 745f  "..    def test_
+0005a8c0: 7370 6172 6528 7365 6c66 2c20 2a61 7267  spare(self, *arg
+0005a8d0: 7329 3a0a 2020 2020 2020 2020 2222 2263  s):.        """c
+0005a8e0: 7265 6174 6520 7370 6172 6520 636f 6e6e  reate spare conn
+0005a8f0: 6563 7469 6f6e 7320 6a75 7374 2074 6f20  ections just to 
+0005a900: 6465 6c65 7465 2074 6865 6d0a 2020 2020  delete them.    
+0005a910: 2020 2020 7769 7468 2063 6c65 616e 5370      with cleanSp
+0005a920: 6172 6545 6e74 7269 6573 0a20 2020 2020  areEntries.     
+0005a930: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
+0005a940: 656c 662e 7042 4442 2e75 7469 6c73 2e63  elf.pBDB.utils.c
+0005a950: 6c65 616e 5370 6172 6545 6e74 7269 6573  leanSpareEntries
+0005a960: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+0005a970: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+0005a980: 7042 4442 2e63 6174 4269 622e 696e 7365  pBDB.catBib.inse
+0005a990: 7274 2831 2c20 2274 6573 7422 2929 0a20  rt(1, "test")). 
+0005a9a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0005a9b0: 7274 4571 7561 6c28 7365 6c66 2e70 4244  rtEqual(self.pBD
+0005a9c0: 422e 6361 7445 7870 2e69 6e73 6572 7428  B.catExp.insert(
+0005a9d0: 312c 205b 302c 2031 5d29 2c20 4e6f 6e65  1, [0, 1]), None
+0005a9e0: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
+0005a9f0: 4244 422e 6578 7073 2e69 6e73 6572 7428  BDB.exps.insert(
+0005aa00: 0a20 2020 2020 2020 2020 2020 207b 226e  .            {"n
+0005aa10: 616d 6522 3a20 2274 6573 7445 7870 222c  ame": "testExp",
+0005aa20: 2022 636f 6d6d 656e 7473 223a 2022 222c   "comments": "",
+0005aa30: 2022 686f 6d65 7061 6765 223a 2022 222c   "homepage": "",
+0005aa40: 2022 696e 7370 6972 6522 3a20 2231 227d   "inspire": "1"}
+0005aa50: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0005aa60: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
+0005aa70: 7565 2873 656c 662e 7042 4442 2e62 6962  ue(self.pBDB.bib
+0005aa80: 4578 702e 696e 7365 7274 2822 7465 7374  Exp.insert("test
+0005aa90: 222c 2031 2929 0a20 2020 2020 2020 2064  ", 1)).        d
+0005aaa0: 6253 7461 7473 2873 656c 662e 7042 4442  bStats(self.pBDB
+0005aab0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0005aac0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+0005aad0: 2020 2020 2020 2020 7365 6c66 2e70 4244          self.pBD
+0005aae0: 422e 7374 6174 732c 0a20 2020 2020 2020  B.stats,.       
+0005aaf0: 2020 2020 207b 2262 6962 7322 3a20 302c       {"bibs": 0,
+0005ab00: 2022 6361 7473 223a 2032 2c20 2265 7870   "cats": 2, "exp
+0005ab10: 7322 3a20 312c 2022 6361 7442 6962 223a  s": 1, "catBib":
+0005ab20: 2031 2c20 2263 6174 4578 7022 3a20 322c   1, "catExp": 2,
+0005ab30: 2022 6269 6245 7870 223a 2031 7d2c 0a20   "bibExp": 1},. 
+0005ab40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0005ab50: 2077 6974 6820 7061 7463 6828 226c 6f67   with patch("log
+0005ab60: 6769 6e67 2e4c 6f67 6765 722e 696e 666f  ging.Logger.info
+0005ab70: 2229 2061 7320 5f69 3a0a 2020 2020 2020  ") as _i:.      
+0005ab80: 2020 2020 2020 7365 6c66 2e70 4244 422e        self.pBDB.
+0005ab90: 7574 696c 732e 636c 6561 6e53 7061 7265  utils.cleanSpare
+0005aba0: 456e 7472 6965 7328 290a 2020 2020 2020  Entries().      
+0005abb0: 2020 2020 2020 5f69 2e61 7373 6572 745f        _i.assert_
+0005abc0: 6861 735f 6361 6c6c 7328 0a20 2020 2020  has_calls(.     
+0005abd0: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+0005abe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005abf0: 2063 616c 6c28 2243 6c65 616e 696e 6720   call("Cleaning 
+0005ac00: 2874 6573 742c 2031 2922 292c 0a20 2020  (test, 1)"),.   
+0005ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005ac20: 2063 616c 6c28 2243 6c65 616e 696e 6720   call("Cleaning 
+0005ac30: 2831 2c20 7465 7374 2922 292c 0a20 2020  (1, test)"),.   
+0005ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005ac50: 2063 616c 6c28 2243 6c65 616e 696e 6720   call("Cleaning 
+0005ac60: 2831 2c20 3029 2229 2c0a 2020 2020 2020  (1, 0)"),.      
+0005ac70: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+0005ac80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0005ac90: 2020 6462 5374 6174 7328 7365 6c66 2e70    dbStats(self.p
+0005aca0: 4244 4229 0a20 2020 2020 2020 2073 656c  BDB).        sel
+0005acb0: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+0005acc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0005acd0: 7042 4442 2e73 7461 7473 2c0a 2020 2020  pBDB.stats,.    
+0005ace0: 2020 2020 2020 2020 7b22 6269 6273 223a          {"bibs":
+0005acf0: 2030 2c20 2263 6174 7322 3a20 322c 2022   0, "cats": 2, "
+0005ad00: 6578 7073 223a 2031 2c20 2263 6174 4269  exps": 1, "catBi
+0005ad10: 6222 3a20 302c 2022 6361 7445 7870 223a  b": 0, "catExp":
+0005ad20: 2031 2c20 2262 6962 4578 7022 3a20 307d   1, "bibExp": 0}
+0005ad30: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0005ad40: 2064 6566 2074 6573 745f 6269 6274 6578   def test_bibtex
+0005ad50: 7328 7365 6c66 2c20 2a61 7267 7329 3a0a  s(self, *args):.
+0005ad60: 2020 2020 2020 2020 2222 2243 7265 6174          """Creat
+0005ad70: 6520 616e 6420 636c 6561 6e20 6120 6269  e and clean a bi
+0005ad80: 6274 6578 2065 6e74 7279 2222 220a 2020  btex entry""".  
+0005ad90: 2020 2020 2020 6461 7461 203d 2073 656c        data = sel
+0005ada0: 662e 7042 4442 2e62 6962 732e 7072 6570  f.pBDB.bibs.prep
+0005adb0: 6172 6549 6e73 6572 7428 0a20 2020 2020  areInsert(.     
+0005adc0: 2020 2020 2020 2027 5c6e 5c6e 2563 6f6d         '\n\n%com
+0005add0: 6d65 6e74 5c6e 4061 7274 6963 6c65 7b61  ment\n@article{a
+0005ade0: 6263 2c5c 6e61 7574 686f 7220 3d20 226d  bc,\nauthor = "m
+0005adf0: 6522 2c5c 6e27 0a20 2020 2020 2020 2020  e",\n'.         
+0005ae00: 2020 202b 2027 7469 746c 6520 3d20 225c     + 'title = "\
+0005ae10: 7530 3045 385c 6e5c 7530 3046 3122 2c7d  u00E8\n\u00F1",}
+0005ae20: 272c 0a20 2020 2020 2020 2020 2020 2062  ',.            b
+0005ae30: 6962 6b65 793d 2261 6263 222c 0a20 2020  ibkey="abc",.   
+0005ae40: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+0005ae50: 656c 662e 6173 7365 7274 5472 7565 2873  elf.assertTrue(s
+0005ae60: 656c 662e 7042 4442 2e62 6962 732e 696e  elf.pBDB.bibs.in
+0005ae70: 7365 7274 2864 6174 6129 290a 2020 2020  sert(data)).    
+0005ae80: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0005ae90: 7175 616c 2873 656c 662e 7042 4442 2e75  qual(self.pBDB.u
+0005aea0: 7469 6c73 2e63 6c65 616e 416c 6c42 6962  tils.cleanAllBib
+0005aeb0: 7465 7873 2829 2c20 4e6f 6e65 290a 2020  texs(), None).  
+0005aec0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0005aed0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+0005aee0: 2020 2020 7365 6c66 2e70 4244 422e 6269      self.pBDB.bi
+0005aef0: 6273 2e67 6574 4669 656c 6428 2261 6263  bs.getField("abc
+0005af00: 222c 2022 6269 6274 6578 2229 2c0a 2020  ", "bibtex"),.  
+0005af10: 2020 2020 2020 2020 2020 2740 4172 7469            '@Arti
+0005af20: 636c 657b 6162 632c 5c6e 2020 2020 2020  cle{abc,\n      
+0005af30: 2020 6175 7468 6f72 203d 2022 6d65 222c    author = "me",
+0005af40: 5c6e 2020 2020 2020 2020 2027 0a20 2020  \n         '.   
+0005af50: 2020 2020 2020 2020 202b 2027 7469 746c           + 'titl
+0005af60: 6520 3d20 227b 7b5c 6065 7d20 7b5c 7e6e  e = "{{\`e} {\~n
+0005af70: 7d7d 222c 5c6e 7d5c 6e5c 6e27 2c0a 2020  }}",\n}\n\n',.  
+0005af80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0005af90: 7365 6c66 2e70 4244 422e 6269 6273 2e64  self.pBDB.bibs.d
+0005afa0: 656c 6574 6528 2261 6263 2229 0a0a 0a64  elete("abc")...d
+0005afb0: 6566 2074 6561 7244 6f77 6e4d 6f64 756c  ef tearDownModul
+0005afc0: 6528 293a 0a20 2020 2069 6620 6f73 2e70  e():.    if os.p
+0005afd0: 6174 682e 6578 6973 7473 2874 656d 7044  ath.exists(tempD
+0005afe0: 424e 616d 6529 3a0a 2020 2020 2020 2020  BName):.        
+0005aff0: 6f73 2e72 656d 6f76 6528 7465 6d70 4442  os.remove(tempDB
+0005b000: 4e61 6d65 290a 0a0a 6966 205f 5f6e 616d  Name)...if __nam
+0005b010: 655f 5f20 3d3d 2022 5f5f 6d61 696e 5f5f  e__ == "__main__
+0005b020: 223a 0a20 2020 2075 6e69 7474 6573 742e  ":.    unittest.
+0005b030: 6d61 696e 2829 0a                        main().
```

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_errors.py` & `physbiblio-2.0.5/physbiblio/tests/test_errors.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_export.py` & `physbiblio-2.0.5/physbiblio/tests/test_export.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_inspireStats.py` & `physbiblio-2.0.5/physbiblio/tests/test_inspireStats.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_package.py` & `physbiblio-2.0.5/physbiblio/tests/test_package.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_pdf.py` & `physbiblio-2.0.5/physbiblio/tests/test_pdf.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/tests/test_view.py` & `physbiblio-2.0.5/physbiblio/tests/test_view.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/view.py` & `physbiblio-2.0.5/physbiblio/view.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/webimport/adsnasa.py` & `physbiblio-2.0.5/physbiblio/webimport/adsnasa.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/webimport/arxiv.py` & `physbiblio-2.0.5/physbiblio/webimport/arxiv.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/webimport/doi.py` & `physbiblio-2.0.5/physbiblio/webimport/doi.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/webimport/inspire.py` & `physbiblio-2.0.5/physbiblio/webimport/inspire.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/webimport/tests/test_adsnasa.py` & `physbiblio-2.0.5/physbiblio/webimport/tests/test_adsnasa.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/webimport/tests/test_arxiv.py` & `physbiblio-2.0.5/physbiblio/webimport/tests/test_arxiv.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/webimport/tests/test_inspire.py` & `physbiblio-2.0.5/physbiblio/webimport/tests/test_inspire.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio/webimport/tests/test_webimport.py` & `physbiblio-2.0.5/physbiblio/webimport/tests/test_webimport.py`

 * *Files 2% similar despite different names*

```diff
@@ -86,28 +86,14 @@
     doi = "10.1088/0954-3899/43/3/033001",
     journal = "J. Phys. G",
     volume = "43",
     pages = "033001",
     year = "2016"
 }""",
             ],
-            "isbn": [
-                "9781107013957",
-                """@book{9781107013957,
-  Author = {Julien Lesgourgues, Gianpiero Mangano, Gennaro Miele},
-  Title = {Neutrino Cosmology},
-  Publisher = {Cambridge University Press},
-  Year = {2014},
-  Date = {2014-02-28},
-  PageTotal = {392},
-  EAN = {9781107013957},
-  ISBN = {110701395X},
-  URL = {https://www.ebook.de/de/product/19797496/julien_lesgourgues_gianpiero_mangano_gennaro_miele_neutrino_cosmology.html}
-}""",
-            ],
         }
         for method, strings in tests.items():
             print(method)
             if method == "arxiv":
                 self.assertEqual(
                     physBiblioWeb.webSearch[method]
                     .retrieveUrlFirst(strings[0], searchType="id")
@@ -136,15 +122,14 @@
         """Test webimport using missing and/or invalid identifiers"""
         print(physBiblioWeb.webSearch.keys())
         self.maxDiff = None
         tests = {
             "arxiv": ["1801.15000", ""],
             "doi": ["10.1088/9999-3899/43/a/033001", ""],
             "inspire": ["Gariazzo:2014rra", ""],
-            "isbn": ["978019850871a", ""],
         }
         self.assertFalse(physBiblioWeb.webSearch["inspire"].retrieveOAIData("9999999"))
         for method, strings in tests.items():
             print(method)
             res = physBiblioWeb.webSearch[method].retrieveUrlFirst(strings[0])
             print(res)
             self.assertEqual(res.strip(), strings[1].strip())
```

### Comparing `physbiblio-2.0.4/physbiblio/webimport/webInterf.py` & `physbiblio-2.0.5/physbiblio/webimport/webInterf.py`

 * *Files identical despite different names*

### Comparing `physbiblio-2.0.4/physbiblio.egg-info/PKG-INFO` & `physbiblio-2.0.5/physbiblio.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,17 +1,16 @@
 Metadata-Version: 2.1
 Name: physbiblio
-Version: 2.0.4
+Version: 2.0.5
 Summary: A bibliography manager in Python (using Sqlite and PySide6)
 Home-page: https://github.com/steog88/PhysBiblio
 Author: Stefano Gariazzo
 Author-email: stefano.gariazzo@gmail.com
 License: GPL-3.0
 Keywords: bibliography,hep-ph,high-energy-physics,bibtex
-Platform: UNKNOWN
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: End Users/Desktop
 Classifier: Intended Audience :: Science/Research
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
 Classifier: Natural Language :: English
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python
@@ -168,15 +167,15 @@
 
 ### Profiles
 You may manage different profiles, each with different settings and independent databases.
 It may be useful if you want to maintain separate activities or collections independently one of the other.
 
 ### Import
 The default import interface can fetch and download information from [INSPIRE-HEP](http://inspirehep.net/).
-The advanced import can also work with [ADS](https://ui.adsabs.harvard.edu/), [arXiv](www.arxiv.org), [dx.doi.org](dx.doi.org), [ISBN2bibtex](http://www.ebook.de/de/tools/isbn2bibtex).  
+The advanced import can also work with [ADS](https://ui.adsabs.harvard.edu/), [arXiv](www.arxiv.org), [dx.doi.org](dx.doi.org).  
 If an arXiv identifier is present, you can download the paper abstract from arXiv (there is an option to do this by default).
 
 ### Export
 It is very easy to export some entries into a `.bib` file.
 You can export the entire bibtex database, a selection or let the program export only the entries that you need to compile a given `.tex` file.
 All the functions are available in the `File` menu.
 
@@ -318,9 +317,7 @@
 Please note that changing the configuration **will not move** the existing files into the new locations.
 
 
 ## 5. Acknowledgments
 This software is part of a project that has received funding from the European Union's Horizon 2020 research and innovation programme, under the Marie SkÅ‚odowska-Curie grant agreement No 796941.
 
 Icons adopted in the GUI are mainly from the [Breeze-icons](https://github.com/KDE/breeze-icons) theme, from [KDE](https://www.kde.org/).
-
-
```

### Comparing `physbiblio-2.0.4/physbiblio.egg-info/SOURCES.txt` & `physbiblio-2.0.5/physbiblio.egg-info/SOURCES.txt`

 * *Files 0% similar despite different names*

```diff
@@ -108,14 +108,13 @@
 physbiblio/tests/test_pdf.py
 physbiblio/tests/test_view.py
 physbiblio/webimport/__init__.py
 physbiblio/webimport/adsnasa.py
 physbiblio/webimport/arxiv.py
 physbiblio/webimport/doi.py
 physbiblio/webimport/inspire.py
-physbiblio/webimport/isbn.py
 physbiblio/webimport/webInterf.py
 physbiblio/webimport/tests/__init__.py
 physbiblio/webimport/tests/test_adsnasa.py
 physbiblio/webimport/tests/test_arxiv.py
 physbiblio/webimport/tests/test_inspire.py
 physbiblio/webimport/tests/test_webimport.py
```

### Comparing `physbiblio-2.0.4/setup.py` & `physbiblio-2.0.5/setup.py`

 * *Files identical despite different names*

